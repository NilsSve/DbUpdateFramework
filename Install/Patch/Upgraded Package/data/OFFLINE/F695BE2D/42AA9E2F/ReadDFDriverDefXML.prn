Compiling Program: C:\Projects\DF18\DbUpdateFramework\AppSrc\ReadDFDriverDefXML.src
Memory Available: 2147483646
1>Use cApplication.pkg
Including file: cApplication.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cApplication.pkg)
1>>>// cApplication.pkg
1>>>// Author: SWB
1>>>
1>>>// Mar  1, 2002 SWB changed the order of the DoOpenWorkspace method to try to load the file from the path before looking in the Registered list
1>>>// Mar 13, 2000 SWB changed the GetApplicationFileName method to use a safer method of retrieving the filename from the OS
1>>>// Mar 13, 2000 SWB changed the default of psProgram to use Module_Name, as this works across chained-to programs
1>>>
1>>>Use Windows.pkg
Using pre-compiled package WINDOWS.PKG
Including file: windows.pkd    (C:\Program Files (x86)\DataFlex 19.0\Pkg\windows.pkd)
7456>>>Use LanguageText.pkg
7456>>>Use WinUser.pkg
7456>>>Use WinShell.pkg
Including file: WinShell.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\WinShell.pkg)
7456>>>>>// Shell API functions
7456>>>>>Use Windows.pkg
7456>>>>>Use DLL.pkg
7456>>>>>
7456>>>>>External_Function PathFileExists "PathFileExistsA" shlwapi.dll ;    String sPath ;Returns Integer // Boolean
7457>>>>>
7457>>>>>External_Function PathIsRelative "PathIsRelativeA" shlwapi.dll ;    String sPath ;Returns Integer // Boolean
7458>>>>>
7458>>>>>External_Function PathRemoveExtension "PathRemoveExtensionA" shlwapi.dll ;    Address aPath ;Returns Integer // void
7459>>>>>
7459>>>>>External_Function PathRemoveFileSpec "PathRemoveFileSpecA" shlwapi.dll ;    Address aPath ;Returns Integer
7460>>>>>
7460>>>>>
7460>>>>>Define URL_UNESCAPE_INPLACE                    for |CI$00100000
7460>>>>>Define URL_ESCAPE_SEGMENT_ONLY                 for |CI$00002000
7460>>>>>
7460>>>>>External_Function UrlUnescape "UrlUnescapeA" shlwapi.dll;    Pointer pszURL;    Pointer pszUnescaped;    Pointer pcchUnescaped;    DWord dwFlags;Returns Integer // S_OK if succesfull
7461>>>>>
7461>>>>>External_Function UrlEscape "UrlEscapeA" shlwapi.dll;    Pointer pszUrl;    Pointer pszEscaped;    Pointer pcchEscaped;    DWord dwFlags;Returns Integer
7462>>>Use cWorkspace.pkg
Including file: cWorkspace.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cWorkspace.pkg)
7462>>>>>// cWorkspace.pkg
7462>>>>>// Author: SWB
7462>>>>>Use Windows.pkg
7462>>>>>Use LanguageText.pkg
7462>>>>>Use WinShell.pkg // Shell API functions
7462>>>>>Use seq_chnl.pkg
Including file: seq_chnl.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\seq_chnl.pkg)
7462>>>>>>>//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
7462>>>>>>>// Confidential Trade Secret.
7462>>>>>>>// Copyright 1987-1994 Data Access Corporation, Miami FL, USA
7462>>>>>>>// All Rights reserved
7462>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
7462>>>>>>>//
7462>>>>>>>// Module:
7462>>>>>>>//      seq_chnl.pkg
7462>>>>>>>//
7462>>>>>>>// Purpose:
7462>>>>>>>//      Defines global sequential device management operations.
7462>>>>>>>//
7462>>>>>>>// Author:
7462>>>>>>>//      Lee Smith
7462>>>>>>>//
7462>>>>>>>// Date:
7462>>>>>>>//      11/2/94
7462>>>>>>>//
7462>>>>>>>//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
7462>>>>>>>// 12/13/2001 JJT: If channel not open, don't declare error during close
7462>>>>>>>//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
7462>>>>>>>Use LanguageText.pkg
7462>>>>>>>use VDFBase.pkg
Including file: errornum.inc    (C:\Program Files (x86)\DataFlex 19.0\Pkg\errornum.inc)
7462>>>>>>>>// DataFlex Source Code
7462>>>>>>>>// Copyright 1987-1992 Data Access Corporation, Miami FL, USA
7462>>>>>>>>// All Rights reserved
7462>>>>>>>>//
7462>>>>>>>>// JR 2/7/92
7462>>>>>>>>
7462>>>>>>>>
7462>>>>>>>>
7462>>>>>>>>//
7462>>>>>>>>// these will get defined in fmac
7462>>>>>>>>//
7462>>>>>>>>// already defined
7462>>>>>>>>//    #REPLACE DFERR_COMP_BAD_IMAGE_NAME                 |CI4293
7462>>>>>>>>//    #REPLACE DFERR_COMP_CONSTANT_EXPECTED              |CI4299
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_RETURN_TYPE            |CI4310
7462>>>>>>>>//    #REPLACE DFERR_COMP_IMAGE_NOT_FOUND                |CI4311
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_DATATYPE               |CI4315
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_TYPE                   |CI4317
7462>>>>>>>>//    #REPLACE DFERR_COMP_MISSING_ARGUMENT               |CI4320
7462>>>>>>>>//    #REPLACE DFERR_COMP_MISSING_END_OBJECT             |CI4323
7462>>>>>>>>//    #REPLACE DFERR_COMP_UNDEFINED_SYMBOL_IN_ARGUMENT   |CI4328
7462>>>>>>>>//    #REPLACE DFERR_COMP_SYMBOL_ALREADY_DEFINED         |CI4332
7462>>>>>>>>//    #REPLACE DFERR_COMP_TOO_MANY_MESSAGES              |CI4339
7462>>>>>>>>//    #REPLACE DFERR_COMP_UNRESOVLED_CONTROL_BLOCK       |CI4348
7462>>>>>>>>// new compiler errors used by fmac
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_OBJECT_DEFINTION       |CI4388 // object name used is not valid
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_PROPERTY_DEFINTION     |CI4389 // property name cannot be used
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_METHOD_DEFINTION       |CI4390 // method name cannot be used
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_CODE_PLACEMENT         |CI4391 // Location of code, nesting, is wrong
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_METHOD_SYNTAX          |CI4392 // syntax is incorrect for method definition
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_MESSAGE_SYNTAX         |CI4393 // sysntax is incorrect for sending message
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_OBJECT_REFERENCE       |CI4394 // object named in message is invalid
7462>>>>>>>>//    #REPLACE DFERR_COMP_OBSOLETE_UNSUPPORTED_FEATURE   |CI4395 // Obsolete - was 101 (Moveused by fmac)
7462>>>>>>>>//    #REPLACE DFERR_COMP_INVALID_ARGUMENT               |CI4396 // Agument in line is incorrect
7462>>>>>>>>//    #REPLACE DFERR_COMP_ILLEGAL_EXTERNAL_FUNCTION_DEFINITION |CI4397 // name cannot be used
7462>>>>>>>>//    #REPLACE DFERR_COMP_MISSING_DEBUG_INFORMATION      |CI4500 // debug information is not provided
7462>>>>>>>>//    #REPLACE DFERR_COMP_INCOMPATIBLE_DEBUG_INFORMATION |CI4501 // debug inforamtion is is not correct
7462>>>>>>>>//    #REPLACE DFERR_COMP_RECURSIVE_STRUCT_DECLARATION   |CI4513 // recursive struct definition
7462>>>>>>>>//    #REPLACE DFERR_COMP_AMBIGUOUS_SYNTAX               |CI4514 // either Left of "'[' is not array, use '(' if indicator" or "Left of '.' is not of type struct or table" 
7462>>>>>>>>
7462>>>>>>>>
7462>>>>>>>
7462>>>>>>>define DF_SEQ_CHANNEL_NOT_AVAILABLE for -2
7462>>>>>>>define DF_SEQ_CHANNEL_ERROR         for -1
7462>>>>>>>define DF_SEQ_CHANNEL_MIN           for 0
7462>>>>>>>define DF_SEQ_CHANNEL_MAX           for 9
7462>>>>>>>define DF_SEQ_START_CHANNEL         for 2 // leave 0 and 1 til last
7462>>>>>>>                            // so that programs that use direct_input/output
7462>>>>>>>                            // w/o specifying a channel will work.
7462>>>>>>>enum_list
7462>>>>>>>    define DF_SEQ_CHANNEL_MODE_CLOSED
7462>>>>>>>    define DF_SEQ_CHANNEL_MODE_OPEN
7462>>>>>>>    define DF_SEQ_CHANNEL_MODE_OUTPUT
7462>>>>>>>    define DF_SEQ_CHANNEL_MODE_INPUT
7462>>>>>>>end_enum_list
7462>>>>>>>
7462>>>>>>>enum_list
7462>>>>>>>    define DF_SEQ_CHANNEL_ERROR_MODE_NONE
7462>>>>>>>    define DF_SEQ_CHANNEL_ERROR_MODE_ALL
7462>>>>>>>end_enum_list
7462>>>>>>>
7462>>>>>>>integer Seq$Channel$Error$Mode
7462>>>>>>>
7462>>>>>>>procedure set Seq_Channel_Error_Mode GLOBAL integer Mode
7464>>>>>>>    move Mode to Seq$Channel$Error$Mode
7465>>>>>>>end_procedure
7466>>>>>>>
7466>>>>>>>function Seq_Channel_Error_Mode GLOBAL returns integer
7468>>>>>>>    function_return Seq$Channel$Error$Mode
7469>>>>>>>end_procedure
7470>>>>>>>
7470>>>>>>>object Seq_Channel_List is an Array
7472>>>>>>>    procedure Initialize
7475>>>>>>>        integer Itm
7475>>>>>>>
7475>>>>>>>        move DF_SEQ_CHANNEL_MIN to Itm
7476>>>>>>>
7476>>>>>>>        while Itm LE DF_SEQ_CHANNEL_MAX
7480>>>>>>>            set Array_Value item Itm to DF_SEQ_CHANNEL_MODE_CLOSED
7481>>>>>>>            increment Itm
7482>>>>>>>        end
7483>>>>>>>>
7483>>>>>>>    end_procedure
7484>>>>>>>
7484>>>>>>>    send Initialize
7485>>>>>>>end_object
7486>>>>>>>
7486>>>>>>>set Seq_Channel_Error_Mode to DF_SEQ_CHANNEL_ERROR_MODE_ALL
7487>>>>>>>
7487>>>>>>>function Seq_Channel_Mode GLOBAL integer Chnl returns integer
7489>>>>>>>    function_return (Integer_Value(Seq_Channel_List(self), Chnl))
7490>>>>>>>end_function
7491>>>>>>>
7491>>>>>>>procedure set Seq_Channel_Mode GLOBAL integer Chnl integer Mode
7493>>>>>>>    set Array_Value of (Seq_Channel_List(self)) item Chnl to Mode
7494>>>>>>>end_procedure
7495>>>>>>>
7495>>>>>>>function Seq_New_Channel GLOBAL returns integer
7497>>>>>>>    integer Obj Chnl
7497>>>>>>>
7497>>>>>>>    move DF_SEQ_START_CHANNEL to Chnl
7498>>>>>>>
7498>>>>>>>    while Chnl LE DF_SEQ_CHANNEL_MAX
7502>>>>>>>        if (Seq_Channel_Mode(Chnl)) EQ DF_SEQ_CHANNEL_MODE_CLOSED begin
7504>>>>>>>            set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_OPEN
7505>>>>>>>            function_return Chnl
7506>>>>>>>        end
7506>>>>>>>>
7506>>>>>>>
7506>>>>>>>        increment Chnl
7507>>>>>>>    end
7508>>>>>>>>
7508>>>>>>>
7508>>>>>>>    // wrap back to beginning
7508>>>>>>>    move 0 to Chnl
7509>>>>>>>
7509>>>>>>>    while Chnl LT DF_SEQ_START_CHANNEL
7513>>>>>>>        if (Seq_Channel_Mode(Chnl)) EQ DF_SEQ_CHANNEL_MODE_CLOSED begin
7515>>>>>>>            set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_OPEN
7516>>>>>>>            function_return Chnl
7517>>>>>>>        end
7517>>>>>>>>
7517>>>>>>>
7517>>>>>>>        increment Chnl
7518>>>>>>>    end
7519>>>>>>>>
7519>>>>>>>
7519>>>>>>>    function_return DF_SEQ_CHANNEL_NOT_AVAILABLE
7520>>>>>>>end_procedure
7521>>>>>>>
7521>>>>>>>procedure Seq_Release_Channel GLOBAL integer Chnl
7523>>>>>>>    if ((Chnl >= DF_SEQ_CHANNEL_MIN) and (Chnl <= DF_SEQ_CHANNEL_MAX)) ;        set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_CLOSED
7526>>>>>>>end_procedure
7527>>>>>>>
7527>>>>>>>function Seq_Open_Input_Channel GLOBAL string Dvc returns integer
7529>>>>>>>    integer Chnl
7529>>>>>>>
7529>>>>>>>    get Seq_New_Channel to Chnl
7530>>>>>>>
7530>>>>>>>    if Chnl LE DF_SEQ_CHANNEL_ERROR begin
7532>>>>>>>        if (Seq_Channel_Error_Mode()) EQ DF_SEQ_CHANNEL_ERROR_MODE_ALL ;            error DFERR_CANT_OPEN_INPUT_FILE (Dvc + ":" *C_$NoOpenChannels)
7535>>>>>>>        function_return Chnl
7536>>>>>>>    end
7536>>>>>>>>
7536>>>>>>>
7536>>>>>>>    indicate Err FALSE
7537>>>>>>>    direct_input channel Chnl Dvc
7539>>>>>>>
7539>>>>>>>    [Err] begin
7541>>>>>>>>
7541>>>>>>>        send Seq_Release_Channel Chnl
7542>>>>>>>        function_return DF_SEQ_CHANNEL_ERROR
7543>>>>>>>    end
7543>>>>>>>>
7543>>>>>>>
7543>>>>>>>    set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_INPUT
7544>>>>>>>
7544>>>>>>>    function_return Chnl
7545>>>>>>>end_function
7546>>>>>>>
7546>>>>>>>function Seq_Open_Output_Channel GLOBAL string Dvc returns integer
7548>>>>>>>    integer Chnl
7548>>>>>>>
7548>>>>>>>    get Seq_New_Channel to Chnl
7549>>>>>>>
7549>>>>>>>    if Chnl LE DF_SEQ_CHANNEL_ERROR begin
7551>>>>>>>        if (Seq_Channel_Error_Mode()) EQ DF_SEQ_CHANNEL_ERROR_MODE_ALL begin
7553>>>>>>>            error DFERR_CANT_OPEN_OUTPUT_FILE (Dvc + ":" *C_$ChannelNotAvailable)
7554>>>>>>>>
7554>>>>>>>            move DF_SEQ_CHANNEL_ERROR to Chnl
7555>>>>>>>        end
7555>>>>>>>>
7555>>>>>>>
7555>>>>>>>        function_return Chnl
7556>>>>>>>    end
7556>>>>>>>>
7556>>>>>>>
7556>>>>>>>    indicate Err FALSE
7557>>>>>>>    direct_output channel Chnl Dvc
7559>>>>>>>
7559>>>>>>>    [Err] begin
7561>>>>>>>>
7561>>>>>>>        send Seq_Release_Channel Chnl
7562>>>>>>>        function_return DF_SEQ_CHANNEL_ERROR
7563>>>>>>>    end
7563>>>>>>>>
7563>>>>>>>
7563>>>>>>>    set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_OUTPUT
7564>>>>>>>
7564>>>>>>>    function_return Chnl
7565>>>>>>>end_function
7566>>>>>>>
7566>>>>>>>function Seq_Append_Output_Channel GLOBAL string Dvc returns integer
7568>>>>>>>    integer Chnl
7568>>>>>>>
7568>>>>>>>    get Seq_New_Channel to Chnl
7569>>>>>>>
7569>>>>>>>    if Chnl LE DF_SEQ_CHANNEL_ERROR begin
7571>>>>>>>        if (Seq_Channel_Error_Mode()) EQ DF_SEQ_CHANNEL_ERROR_MODE_ALL begin
7573>>>>>>>            error DFERR_CANT_OPEN_OUTPUT_FILE (Dvc + ":" *C_$ChannelNotAvailable)
7574>>>>>>>>
7574>>>>>>>            move DF_SEQ_CHANNEL_ERROR to Chnl
7575>>>>>>>        end
7575>>>>>>>>
7575>>>>>>>
7575>>>>>>>        function_return Chnl
7576>>>>>>>    end
7576>>>>>>>>
7576>>>>>>>
7576>>>>>>>    indicate Err FALSE
7577>>>>>>>    append_output channel Chnl Dvc
7579>>>>>>>
7579>>>>>>>    [Err] begin
7581>>>>>>>>
7581>>>>>>>        send Seq_Release_Channel Chnl
7582>>>>>>>        function_return DF_SEQ_CHANNEL_ERROR
7583>>>>>>>    end
7583>>>>>>>>
7583>>>>>>>
7583>>>>>>>    set Seq_Channel_Mode Chnl to DF_SEQ_CHANNEL_MODE_OUTPUT
7584>>>>>>>
7584>>>>>>>    function_return Chnl
7585>>>>>>>end_function
7586>>>>>>>
7586>>>>>>>procedure Seq_Close_Channel GLOBAL integer Chnl
7588>>>>>>>    integer Mode
7588>>>>>>>
7588>>>>>>>    if ((Chnl >= DF_SEQ_CHANNEL_MIN) and (Chnl <= DF_SEQ_CHANNEL_MAX)) begin
7590>>>>>>>        get Seq_Channel_Mode Chnl to Mode
7591>>>>>>>
7591>>>>>>>        if Mode EQ DF_SEQ_CHANNEL_MODE_OUTPUT ;            close_output channel Chnl
7595>>>>>>>        else if Mode EQ DF_SEQ_CHANNEL_MODE_INPUT ;            close_input channel Chnl
7600>>>>>>>        // 12/13/2001 - If channel not open, release it! No (fatal) Error.
7600>>>>>>>        //else begin
7600>>>>>>>        //    Error DFERR_FILE_NOT_OPEN ("Channel: " + string(Chnl))
7600>>>>>>>        //    procedure_return
7600>>>>>>>        //end
7600>>>>>>>
7600>>>>>>>        send Seq_Release_Channel Chnl
7601>>>>>>>    end
7601>>>>>>>>
7601>>>>>>>end_procedure
7602>>>>>
7602>>>>>Register_Function IsRegistered String sWorkspace Returns Boolean
7602>>>>>Register_Function VdfSystemDfPath   Returns String
7602>>>>>Register_Function VdfSystemMakePath Returns String
7602>>>>>
7602>>>>>Enum_List
7602>>>>>    Define wsWorkspaceOpened       // WS opened ok
7602>>>>>    Define wsWorkspaceNotFound     // the named WS was not found in the global list
7602>>>>>    Define wsWorkspaceFileNotFound // the WS file was not found
7602>>>>>    Define wsDataPathEmpty         // the DataPath entry was empty
7602>>>>>    Define wsFileListEmpty         // The FileList entry was empty
7602>>>>>    Define wsFileListNotExist      // The FileList.cfg file could not be found
7602>>>>>End_Enum_List
7602>>>>>
7602>>>>>
7602>>>>>Define INVALID_HANDLE_VALUE for -1
7602>>>>>DEFINE MAX_PATH For 260   // Symbol for maximum length of a path
7602>>>>>
7602>>>>>Type tWin32FindData
7602>>>>>    Field tWin32FindData.dwFileAttributes                as Dword
7602>>>>>    Field tWin32FindData.ftCreationTime.dwLowDateTime    as Dword
7602>>>>>    Field tWin32FindData.ftCreationTime.dwHighDateTime   as Dword
7602>>>>>    Field tWin32FindData.ftLastAccessTime.dwLowDateTime  as Dword
7602>>>>>    Field tWin32FindData.ftLastAccessTime.dwHighDateTime as Dword
7602>>>>>    Field tWin32FindData.ftLastWriteTime.dwLowDateTime   as Dword
7602>>>>>    Field tWin32FindData.ftLastWriteTime.dwHighDateTime  as Dword
7602>>>>>    Field tWin32FindData.nFileSizeHigh                   as Dword
7602>>>>>    Field tWin32FindData.nFileSizeLow                    as Dword
7602>>>>>    Field tWin32FindData.dwReserved0                     as Dword
7602>>>>>    Field tWin32FindData.dwReserved1                     as Dword
7602>>>>>    Field tWin32FindData.cFileName                       as Char MAX_PATH
7602>>>>>    Field tWin32FindData.cAlternateFileName              as Char 14
7602>>>>>End_Type
7602>>>>>
7602>>>>>External_Function winFindFirstFile "FindFirstFileA" Kernel32.dll ;    String sFileSpec Pointer lpsWin32FindData Returns Handle
7603>>>>>
7603>>>>>External_Function winFindNextFile "FindNextFileA" Kernel32.dll ;    Handle hFindFile Pointer lpsWin32FindData Returns Handle
7604>>>>>
7604>>>>>External_Function winFindClose "FindClose" Kernel32.dll ;    Handle hOpenFile Returns Integer
7605>>>>>
7605>>>>>Function DoesFileExist GLOBAL String sFilename Returns Boolean
7607>>>>>        String sWin32FindData sMask
7607>>>>>        Pointer lpsWin32FindData
7607>>>>>        Integer iVoid
7607>>>>>        Handle hFileFind
7607>>>>>
7607>>>>>        ZeroType tWin32FindData To sWin32FindData
7608>>>>>        GetAddress of sWin32FindData To lpsWin32FindData
7609>>>>>        Move (winFindFirstFile(ToAnsi(sFilename), lpsWin32FindData)) To hFileFind   // JVH 8.3.8.0 must pass Ansi filename
7610>>>>>        If (hFileFind <> INVALID_HANDLE_VALUE) Begin
7612>>>>>            Move (winFindClose(hFileFind)) To iVoid
7613>>>>>        End
7613>>>>>>
7613>>>>>
7613>>>>>    Function_Return (hFileFind <> INVALID_HANDLE_VALUE)
7614>>>>>End_Function
7615>>>>>
7615>>>>>
7615>>>>>Use cIniFile.pkg
Including file: cIniFile.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cIniFile.pkg)
7615>>>>>>>// cIniFile.pkg
7615>>>>>>>// Author: SWB
7615>>>>>>>Use LanguageText.pkg
7615>>>>>>>Use windows.pkg
7615>>>>>>>
7615>>>>>>>// it is important that psFileName is defined. If blank, the registry may be accessed. We will check all WritePrivateProfileString
7615>>>>>>>// and GetPrivateProfileString to make sure that a file is defined.
7615>>>>>>>External_Function WritePrivateProfileString "WritePrivateProfileStringA" Kernel32.dll ;    String sSection String sKeyName String sValue String sFileName Returns Integer
7616>>>>>>>
7616>>>>>>>External_Function GetPrivateProfileString "GetPrivateProfileStringA" Kernel32.dll ;    Address aSection Address aKeyName Address aDefault Pointer lpsValue Integer nSize String sFileName Returns Integer
7617>>>>>>>
7617>>>>>>>Class cIniFile is a cObject
7618>>>>>>>    Procedure Construct_Object
7620>>>>>>>        Forward Send Construct_Object
7622>>>>>>>
7622>>>>>>>        Property String psFileName
7623>>>>>>>    End_Procedure
7624>>>>>>>
7624>>>>>>>    Procedure WriteString String sSection String sKey String sValue
7626>>>>>>>        Boolean bSuccess
7626>>>>>>>
7626>>>>>>>        //Showln "WriteString "
7626>>>>>>>        //Showln sSection ' - ' sKey ' - ' (psFileName(self))
7626>>>>>>>        //Showln sSection ' - ' sKey ' - ' (ToAnsi(psFileName(self)))
7626>>>>>>>        If (trim(psFileName(self))="") Begin
7628>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7629>>>>>>>>
7629>>>>>>>            Procedure_return
7630>>>>>>>        end
7630>>>>>>>>
7630>>>>>>>        Move (WritePrivateProfileString(ToAnsi(sSection), ToAnsi(sKey), ToAnsi(sValue), ToAnsi(psFilename(self)))) To bSuccess
7631>>>>>>>        If (bSuccess = False) Error DFERR_INI_FILE C_$CannotWriteToTheIniFile
7634>>>>>>>    End_Procedure
7635>>>>>>>
7635>>>>>>>    Function ReadString String sSection String sKey String sDefault Returns String
7637>>>>>>>        Integer iNumChars iSizeValue
7637>>>>>>>        Pointer lpsValue
7637>>>>>>>        String sValue
7637>>>>>>>
7637>>>>>>>        Move (ToAnsi(sSection)) To sSection
7638>>>>>>>        Move (ToAnsi(sKey))     To sKey
7639>>>>>>>        Move (ToAnsi(sDefault)) To sDefault
7640>>>>>>>
7640>>>>>>>        Move 2047 to iSizeValue
7641>>>>>>>
7641>>>>>>>        Pad " " To sValue iSizeValue
7643>>>>>>>>
7643>>>>>>>        GetAddress of sValue to lpsValue
7644>>>>>>>
7644>>>>>>>        If (trim(psFileName(self))="") Begin
7646>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7647>>>>>>>>
7647>>>>>>>            Function_return ''
7648>>>>>>>        end
7648>>>>>>>>
7648>>>>>>>        Move (GetPrivateProfileString(AddressOf(sSection), AddressOf(sKey), AddressOf(sDefault), lpsValue, iSizeValue, ToAnsi(psFilename(self)))) To iNumChars
7649>>>>>>>        Function_Return  (ToOem(CString(sValue)))
7650>>>>>>>    End_Function
7651>>>>>>>
7651>>>>>>>    Function SectionExists String sSection Returns Boolean
7653>>>>>>>        // A section exists only if it has at least one Key. A section with no keys is said not to exist
7653>>>>>>>        Handle hoKeys
7653>>>>>>>        Integer icKey iKey
7653>>>>>>>
7653>>>>>>>        Get Create U_ARRAY To hoKeys
7654>>>>>>>        Send ReadSection sSection hoKeys
7655>>>>>>>        Get Item_Count of hoKeys To icKey
7656>>>>>>>        Send Destroy of hoKeys
7657>>>>>>>
7657>>>>>>>        Function_Return (icKey >0)
7658>>>>>>>    End_Function
7659>>>>>>>
7659>>>>>>>    Procedure ReadSection String sSection Handle hoArray
7661>>>>>>>        Integer iNumChars iSizeValue iPos
7661>>>>>>>        Pointer lpsKeys
7661>>>>>>>        String sKeys sKey
7661>>>>>>>
7661>>>>>>>        Move 16384 to iSizeValue
7662>>>>>>>        Move (Repeat(character(0),  iSizeValue)) To sKeys
7663>>>>>>>
7663>>>>>>>        GetAddress of sKeys to lpsKeys
7664>>>>>>>
7664>>>>>>>        Move (ToAnsi(sSection)) To sSection
7665>>>>>>>
7665>>>>>>>        If (trim(psFileName(self))="") Begin
7667>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7668>>>>>>>>
7668>>>>>>>            Procedure_return
7669>>>>>>>        end
7669>>>>>>>>
7669>>>>>>>        Move (GetPrivateProfileString(AddressOf(sSection), 0, 0, lpsKeys, Length(sKeys), ToAnsi(psFilename(self)))) To iNumChars
7670>>>>>>>        If (iNumChars >0) Begin
7672>>>>>>>            Repeat
7672>>>>>>>>
7672>>>>>>>                Pos (Character(0)) in sKeys To iPos
7674>>>>>>>>
7674>>>>>>>                If (iPos >1) Begin
7676>>>>>>>                    Left sKeys To sKey (iPos -1)
7678>>>>>>>>
7678>>>>>>>                    Right sKeys To sKeys (Length(sKeys) - iPos)
7680>>>>>>>>
7680>>>>>>>                    Set Value of hoArray (Item_Count(hoArray)) To (ToOem(sKey))
7681>>>>>>>                End
7681>>>>>>>>
7681>>>>>>>            Until (iPos <=1)
7683>>>>>>>        End
7683>>>>>>>>
7683>>>>>>>    End_Procedure
7684>>>>>>>
7684>>>>>>>    Procedure ReadSections Handle hoArray
7686>>>>>>>        Integer iNumChars iSizeValue iPos
7686>>>>>>>        Pointer lpsSections
7686>>>>>>>        String sSections sSection
7686>>>>>>>
7686>>>>>>>        Move 16384 to iSizeValue
7687>>>>>>>
7687>>>>>>>        Move (Repeat(character(0),  iSizeValue)) To sSections
7688>>>>>>>        GetAddress of sSections to lpsSections
7689>>>>>>>
7689>>>>>>>        If (trim(psFileName(self))="") Begin
7691>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7692>>>>>>>>
7692>>>>>>>            Procedure_return
7693>>>>>>>        end
7693>>>>>>>>
7693>>>>>>>        Move (GetPrivateProfileString(0, 0, 0, lpsSections, Length(sSections), ToAnsi(psFilename(self)))) To iNumChars
7694>>>>>>>        If (iNumChars >0) Begin
7696>>>>>>>            Repeat
7696>>>>>>>>
7696>>>>>>>                Pos (Character(0)) in sSections To iPos
7698>>>>>>>>
7698>>>>>>>                If (iPos >1) Begin
7700>>>>>>>                    Left sSections To sSection (iPos -1)
7702>>>>>>>>
7702>>>>>>>                    Right sSections To sSections (Length(sSections) - iPos)
7704>>>>>>>>
7704>>>>>>>                    Set Value of hoArray (Item_Count(hoArray)) To (ToOem(sSection))
7705>>>>>>>                End
7705>>>>>>>>
7705>>>>>>>            Until (iPos <=1)
7707>>>>>>>        End
7707>>>>>>>>
7707>>>>>>>
7707>>>>>>>    End_Procedure
7708>>>>>>>
7708>>>>>>>    Procedure DeleteSection String sSection
7710>>>>>>>        //Showln "delete section:"
7710>>>>>>>        //Showln sSection ' - ' (psFileName(self))
7710>>>>>>>        //Showln sSection ' - ' (ToAnsi(psFileName(self)))
7710>>>>>>>
7710>>>>>>>        If (trim(psFileName(self))="") Begin
7712>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7713>>>>>>>>
7713>>>>>>>            Procedure_return
7714>>>>>>>        end
7714>>>>>>>>
7714>>>>>>>        If (WritePrivateProfileString(ToAnsi(sSection), "", "", ToAnsi(psFilename(self))) = 0) Error DFERR_INI_FILE C_$CanNotDeleteSection
7717>>>>>>>    End_Procedure
7718>>>>>>>
7718>>>>>>>    Procedure DeleteKey String sSection String sKey
7720>>>>>>>        Integer iVoid
7720>>>>>>>        //Showln "delete key:"
7720>>>>>>>        //Showln sSection ' - ' sKey ' - ' (psFileName(self))
7720>>>>>>>        //Showln sSection ' - ' skey ' - ' (ToAnsi(psFileName(self)))
7720>>>>>>>        If (trim(psFileName(self))="") Begin
7722>>>>>>>            Error DFERR_INI_FILE "Ini file name not defined"
7723>>>>>>>>
7723>>>>>>>            Procedure_return
7724>>>>>>>        end
7724>>>>>>>>
7724>>>>>>>        Move (WritePrivateProfileString(ToAnsi(sSection), ToAnsi(sKey), "", ToAnsi(psFilename(self)))) To iVoid
7725>>>>>>>        //Move (WritePrivateProfileString(ToAnsi(sSection), ToAnsi(sKey), "", psFilename(self))) To iVoid
7725>>>>>>>    End_Procedure
7726>>>>>>>
7726>>>>>>>    Function KeyExists String sSection String sKey Returns Boolean
7728>>>>>>>        Handle hoKeys
7728>>>>>>>        Integer iKey
7728>>>>>>>        Boolean bExists
7728>>>>>>>
7728>>>>>>>        Move (False) To bExists
7729>>>>>>>
7729>>>>>>>        Move (ToAnsi(Uppercase(sKey))) To sKey
7730>>>>>>>
7730>>>>>>>        Get Create U_ARRAY To hoKeys
7731>>>>>>>
7731>>>>>>>        Send ReadSection sSection hoKeys
7732>>>>>>>        For iKey from 0 To (Item_Count(hoKeys) -1)
7738>>>>>>>>
7738>>>>>>>            If (sKey = Uppercase(Value(hoKeys, iKey))) Begin
7740>>>>>>>                Move (True) To bExists
7741>>>>>>>            End
7741>>>>>>>>
7741>>>>>>>        Loop
7742>>>>>>>>
7742>>>>>>>
7742>>>>>>>        Send Destroy of hoKeys
7743>>>>>>>
7743>>>>>>>        Function_Return bExists
7744>>>>>>>    End_Function
7745>>>>>>>
7745>>>>>>>End_Class
7746>>>>>
7746>>>>>Class cWorkspace is a cObject
7747>>>>>
7747>>>>>    Procedure Construct_Object
7749>>>>>        Forward Send Construct_Object
7751>>>>>
7751>>>>>
7751>>>>>        Property String psAppSrcPath
7752>>>>>        Property String psBitmapPath
7753>>>>>        Property String psDataPath
7754>>>>>        Property String psDdSrcPath
7755>>>>>        Property String psDescription
7756>>>>>        Property String psFileList
7757>>>>>        Property String psHelpPath
7758>>>>>        Property String psHome
7759>>>>>        Property String psIdeSrcPath
7760>>>>>        Property String psProgramPath
7761>>>>>        Property String psAppHtmlPath
7762>>>>>        Property String psWorkspaceName
7763>>>>>        Property String psWorkspaceWSFile
7764>>>>>        Property String psConnectionIni
7765>>>>>
7765>>>>>        Property String psSystemDfPath // took from the Registry!
7766>>>>>        Property String psSystemMakePath // took from the Registry!
7767>>>>>        Property String psDfPath        // Calculated
7768>>>>>
7768>>>>>        Property Boolean pbWorkspaceOpened False // used internally to tell if we are switching workspaces
7769>>>>>
7769>>>>>    End_Procedure
7770>>>>>
7770>>>>>    Function FullPathNames String sShortPathNames Returns String
7772>>>>>        String sFileName
7772>>>>>        String sFullPathNames sFullPathName sShortPathName
7772>>>>>        Pointer lpsFullPathName
7772>>>>>        Pointer lpsFilePart
7772>>>>>        Integer icChar // the number of characters returned
7772>>>>>        Integer iPos
7772>>>>>
7772>>>>>        Move (Pos(";", sShortPathNames)) To iPos
7773>>>>>        While (length(sShortPathNames) >0)
7777>>>>>            If (iPos =0) Begin
7779>>>>>                Move sShortPathNames To sShortPathName
7780>>>>>                Move "" To sShortPathNames
7781>>>>>            End
7781>>>>>>
7781>>>>>            Else Begin // multiple paths
7782>>>>>                Move (Left(sShortPathNames, iPos -1)) To sShortPathName
7783>>>>>                Move (Right(sShortPathNames, length(sShortPathNames) -iPos)) To sShortPathNames // remove this path from the paths
7784>>>>>            End
7784>>>>>>
7784>>>>>            Move (Repeat(character(0), 4096)) To sFullPathName
7785>>>>>            GetAddress of sFullPathName to lpsFullPathName
7786>>>>>            move -1 to lpsFilePart
7787>>>>>            Move (GetFullPathName(sShortPathName, 4096, lpsFullPathName, AddressOf(lpsFilePart))) To icChar
7788>>>>>            Append sFullPathNames (CString(sFullPathName))
7789>>>>>            If (sShortPathNames <>"") Append sFullPathNames ";"
7792>>>>>            Move (Pos(";", sShortPathNames)) To iPos
7793>>>>>        Loop
7794>>>>>>
7794>>>>>
7794>>>>>        Function_Return sFullPathNames
7795>>>>>    End_Function
7796>>>>>
7796>>>>>    Function GetApplicationPath Returns String
7798>>>>>        // Returns the path of the Application (no trailing "\")
7798>>>>>        String sApplicationFileName sPath
7798>>>>>        Boolean bRemoved
7798>>>>>        Integer iNumChars
7798>>>>>        String sFilename
7798>>>>>
7798>>>>>        Move (Repeat(Character(0), 1024)) to sApplicationFileName
7799>>>>>        Move (GetModuleFileName(0, AddressOf(sApplicationFileName), 1024)) to iNumChars
7800>>>>>        Move (CString(sApplicationFileName)) to sApplicationFileName
7801>>>>>
7801>>>>>        Move (PathRemoveFileSpec(AddressOf(sApplicationFileName))) to bRemoved
7802>>>>>        Move (CString(sApplicationFileName)) to sPath
7803>>>>>
7803>>>>>        If (Right(sPath, 1) ="\") Move (Left(sPath, Length(sPath) -1)) to sPath
7806>>>>>        Function_Return sPath
7807>>>>>    End_Function
7808>>>>>
7808>>>>>    Procedure DoClearPaths
7810>>>>>        // Call this prior to changing from one WorkspAce to another
7810>>>>>        // if you don't, OpenWorkspaceFile will ignore the new paths.
7810>>>>>        Set psHome           To ""
7811>>>>>        Set psAppSrcPath     To ""
7812>>>>>        Set psBitmapPath     To ""
7813>>>>>        Set psDataPath       To ""
7814>>>>>        Set psDdSrcPath      To ""
7815>>>>>        Set psDescription    To ""
7816>>>>>        Set psFileList       To ""
7817>>>>>        Set psHelpPath       To ""
7818>>>>>        Set psIdeSrcPath     To ""
7819>>>>>        Set psAppHtmlPath    To ""
7820>>>>>        Set psProgramPath    To ""
7821>>>>>        Set psWorkspaceName  To ""
7822>>>>>        Set psSystemDfPath   To ""
7823>>>>>        Set psSystemMakePath To ""
7824>>>>>        Set psWorkspaceWSFile to ""
7825>>>>>        Set psConnectionIni to ""
7826>>>>>    End_Procedure
7827>>>>>
7827>>>>>    Function OpenWorkspaceFile String sWorkspaceFile Returns Integer
7829>>>>>        String sApplicationStartPath
7829>>>>>        String sWsName // name of Workspace is inferred from the Workspacefile name
7829>>>>>        Pointer lpsApplicationStartPath
7829>>>>>        Boolean bRemoved
7829>>>>>        Handle hoIniFile
7829>>>>>        Boolean bSuccess // call succeeded?
7829>>>>>        String sOldDirectory
7829>>>>>        String sSystemDfPath sSystemMakePath
7829>>>>>        Boolean bExist // does the WS file exist?
7829>>>>>        Boolean bChangingWorkspace
7829>>>>>
7829>>>>>        String sHome sAppSrcPath sBitmapPath sDataPath sDdSrcPath sDescription sAppHtmlPath
7829>>>>>        String sFileList sHelpPath sIdeSrcPath sProgramPath sWorkspaceName sConnectionIni
7829>>>>>        
7829>>>>>        Set psWorkspaceWSFile to ""
7830>>>>>        If (sWorkspaceFile ="") Function_Return wsWorkspaceFileNotFound
7833>>>>>
7833>>>>>        // Append extension if not supplied...
7833>>>>>        If (Uppercase(Right(Trim(sWorkspaceFile),3)) <> ".WS") Begin
7835>>>>>            Move (sWorkspaceFile-".ws") To sWorkspaceFile
7836>>>>>        End
7836>>>>>>
7836>>>>>
7836>>>>>        Get pbWorkspaceOpened To bChangingWorkspace // if we had an existing workspace. We are changing
7837>>>>>
7837>>>>>        If (IsFilenameQualified(sWorkspaceFile) = False) Begin
7839>>>>>            // Set the properties to the paths of the Workspace
7839>>>>>            // Find the WS file (with program)...
7839>>>>>            Get GetApplicationPath to sApplicationStartPath
7840>>>>>
7840>>>>>            Move sWorkspaceFile To sWsName
7841>>>>>            Move (sApplicationStartPath +"\" +sWorkspaceFile) To sWorkspaceFile
7842>>>>>        End
7842>>>>>>
7842>>>>>        Else Begin
7843>>>>>            Move (ExtractFileName(sWorkspaceFile)) To sWsName
7844>>>>>
7844>>>>>            Move sWorkspaceFile To sApplicationStartPath
7845>>>>>            GetAddress of sApplicationStartPath To lpsApplicationStartPath
7846>>>>>            Move (PathRemoveFileSpec(lpsApplicationStartPath)) To bRemoved
7847>>>>>        End
7847>>>>>>
7847>>>>>
7847>>>>>        // Ensure that the file can be found...
7847>>>>>        //File_Exist (ToAnsi(sWorkspaceFile)) bExist        // [JVH] 8.3.8.0 Convert filename to Ansi
7847>>>>>        // [JVH] 8.3.8.0 - Temporarily turn off support for
7847>>>>>        // Ansi extended characters in workspace until we can
7847>>>>>        // resolve all open issues..........................
7847>>>>>        Set psWorkspaceWSFile to sWorkspaceFile
7848>>>>>        File_Exist sWorkspaceFile bExist
7849>>>>>        If (bExist = False) Function_Return wsWorkspaceFileNotFound
7852>>>>>
7852>>>>>        Get psHome           To sHome
7853>>>>>        Get psAppSrcPath     To sAppSrcPath
7854>>>>>        Get psAppHtmlPath    To sAppHtmlPath
7855>>>>>        Get psBitmapPath     To sBitmapPath
7856>>>>>        Get psDataPath       To sDataPath
7857>>>>>        Get psDdSrcPath      To sDdSrcPath
7858>>>>>        Get psDescription    To sDescription
7859>>>>>        Get psFileList       To sFileList
7860>>>>>        Get psHelpPath       To sHelpPath
7861>>>>>        Get psIdeSrcPath     To sIdeSrcPath
7862>>>>>        Get psProgramPath    To sProgramPath
7863>>>>>        Get psSystemDfPath   To sSystemDfPath
7864>>>>>        Get psSystemMakePath To sSystemMakePath
7865>>>>>        Get psWorkspaceName  to sWorkspaceName
7866>>>>>        Get psConnectionIni to sConnectionIni
7867>>>>>
7867>>>>>        Get_Current_Directory To sOldDirectory
7868>>>>>        // Note- this conversion is temporarily rolled back
7868>>>>>        //Move (SetCurrentDirectory(ToAnsi(CString(sApplicationStartPath)))) To bSuccess    // [JVH] 8.3.8.0 Convert AppStartPath to ANSI
7868>>>>>        Move (SetCurrentDirectory(CString(sApplicationStartPath))) To bSuccess
7869>>>>>
7869>>>>>        Get Create U_cIniFile To hoIniFile
7870>>>>>        Set psFilename of hoIniFile To sWorkspaceFile
7871>>>>>
7871>>>>>        If (sHome ="")          Get ReadString of hoIniFile "Workspace" "Home" ""          To sHome
7874>>>>>        If (sAppSrcPath ="")    Get ReadString of hoIniFile "Workspace" "AppSrcPath" ""    To sAppSrcPath
7877>>>>>        If (sAppHtmlPath ="")   Get ReadString of hoIniFile "Workspace" "AppHtmlPath" ""   To sAppHtmlPath
7880>>>>>        If (sBitmapPath ="")    Get ReadString of hoIniFile "Workspace" "BitmapPath" ""    To sBitmapPath
7883>>>>>        If (sDataPath ="")      Get ReadString of hoIniFile "Workspace" "DataPath" ""      To sDataPath
7886>>>>>        If (sDdSrcPath ="")     Get ReadString of hoIniFile "Workspace" "DdSrcPath" ""     To sDdSrcPath
7889>>>>>        If (sDescription ="")   Get ReadString of hoIniFile "Workspace" "Description" ""   To sDescription
7892>>>>>        If (sFileList ="")      Get ReadString of hoIniFile "Workspace" "FileList" ""      To sFileList
7895>>>>>        If (sHelpPath ="")      Get ReadString of hoIniFile "Workspace" "HelpPath" ""      To sHelpPath
7898>>>>>        If (sIdeSrcPath ="")    Get ReadString of hoIniFile "Workspace" "IdeSrcPath" ""    To sIdeSrcPath
7901>>>>>        If (sProgramPath ="")   Get ReadString of hoIniFile "Workspace" "ProgramPath" ""   To sProgramPath
7904>>>>>        If (sWorkspaceName ="") Move (Left(sWsName, Length(sWsName) -3))                   To sWorkspaceName
7907>>>>>        If (sConnectionIni ="") Get ReadString of hoIniFile "Workspace" "ConnectionIni" ""   to sConnectionIni
7910>>>>>
7910>>>>>        If (sSystemDfPath ="")   Set psSystemDfPath   To (VdfSystemDfPath(self))
7913>>>>>        If (sSystemMakePath ="") Set psSystemMakePath To (VdfSystemMakePath(self))
7916>>>>>
7916>>>>>        Set psHome          To (FullPathNames(self, sHome))
7917>>>>>
7917>>>>>        // Set CWD to Home...
7917>>>>>        Move (SetCurrentDirectory(sHome)) To bSuccess
7918>>>>>        Set psAppSrcPath    To (FullPathNames(self, sAppSrcPath))
7919>>>>>        Set psAppHtmlPath   To (FullPathNames(self, sAppHtmlPath))
7920>>>>>        Set psBitmapPath    To (FullPathNames(self, sBitmapPath))
7921>>>>>        Set psDataPath      To (FullPathNames(self, sDataPath))
7922>>>>>        Set psDdSrcPath     To (FullPathNames(self, sDdSrcPath))
7923>>>>>        Set psFileList      To (FullPathNames(self, sFileList))
7924>>>>>        Set psHelpPath      To (FullPathNames(self, sHelpPath))
7925>>>>>        Set psIdeSrcPath    To (FullPathNames(self, sIdeSrcPath))
7926>>>>>        Set psProgramPath   to (FullPathNames(Self, sProgramPath))
7927>>>>>        Set psConnectionIni to (FullPathNames(Self, sConnectionIni))
7928>>>>>
7928>>>>>        Set psWorkspaceName To sWorkspaceName
7929>>>>>        Set psDescription   To sDescription
7930>>>>>
7930>>>>>        Send Destroy of hoIniFile // destroy dynaically created inifile object
7931>>>>>
7931>>>>>        // Restore CWD...
7931>>>>>        Move (SetCurrentDirectory(sOldDirectory)) To sOldDirectory
7932>>>>>
7932>>>>>        // Check for error conditions:
7932>>>>>        // DataPath and FileList must be defined; the FileList entry must point to a valid FileList.cfg
7932>>>>>        If (psDataPath(self) = "") Function_Return wsDataPathEmpty
7935>>>>>        If (psFileList(self) = "") Function_Return wsFileListEmpty
7938>>>>>
7938>>>>>        //File_Exist (psFileList(self)) bExist
7938>>>>>        Move (DoesFileExist(psFileList(self))) To bExist
7939>>>>>        If (bExist = False) Function_Return wsFileListNotExist
7942>>>>>
7942>>>>>        If bChangingWorkspace Close DF_ALL // if there is a WS open, we must close all the files
7945>>>>>
7945>>>>>        Send DoAssignPaths // set psDfPath
7946>>>>>        Send DoSetPaths    // Set the application's Attributes of Filelist_Name and Open_Path
7947>>>>>        Set pbWorkspaceOpened To True
7948>>>>>
7948>>>>>        Function_Return wsWorkspaceOpened
7949>>>>>    End_Function
7950>>>>>
7950>>>>>    Function OpenWorkspace String sWorkspace Returns Integer
7952>>>>>        // Look in the Workspaces.ini file for the name, then open it by path
7952>>>>>
7952>>>>>        Handle hoSections hoIniFile
7952>>>>>        Integer iWorkspace eOpened
7952>>>>>        String sWorkspaceName sPath
7952>>>>>        String sVdfRootDir
7952>>>>>
7952>>>>>        Get Create U_Array    To hoSections
7953>>>>>        Get Create U_cIniFile To hoIniFile
7954>>>>>
7954>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
7957>>>>>        If (Right(sVdfRootDir,1) <>"\") Move (sVdfRootDir +"\") To sVdfRootDir
7960>>>>>
7960>>>>>        Set psFilename of hoIniFile To (sVdfRootDir +"bin\Workspaces.ini")
7961>>>>>
7961>>>>>        Send ReadSections of hoIniFile hoSections
7962>>>>>
7962>>>>>        For iWorkspace from 0 to (Item_Count(hoSections) -1)
7968>>>>>>
7968>>>>>            Get Value of hoSections iWorkspace To sWorkspaceName
7969>>>>>            If (Uppercase(sWorkspaceName) = Uppercase(sWorkspace)) Begin
7971>>>>>                Get ReadString of hoIniFile sWorkspace "Path" "" To sPath
7972>>>>>                If (Right(sPath,1) <>"\") Move (sPath +"\") To sPath
7975>>>>>
7975>>>>>                Get OpenWorkspaceFile (sPath + sWorkspace) To eOpened
7976>>>>>                Send Destroy of hoSections
7977>>>>>                Send Destroy of hoIniFile
7978>>>>>                Function_Return eOpened
7979>>>>>            End
7979>>>>>>
7979>>>>>        Loop
7980>>>>>>
7980>>>>>
7980>>>>>        Send Destroy of hoSections
7981>>>>>        Send Destroy of hoIniFile
7982>>>>>        Function_Return wsWorkspaceNotFound
7983>>>>>    End_Function
7984>>>>>
7984>>>>>    Function IsRegistered String sWorkspace Returns Boolean
7986>>>>>        Boolean bRegistered
7986>>>>>        Handle hoIniFile
7986>>>>>        String sVdfRootDir
7986>>>>>
7986>>>>>        Get Create U_cIniFile To hoIniFile
7987>>>>>
7987>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
7990>>>>>        If (Right(sVdfRootDir,1) <>"\") Move (sVdfRootDir +"\") To sVdfRootDir
7993>>>>>        Set psFilename of hoIniFile To (sVdfRootDir +"bin\Workspaces.ini")
7994>>>>>        Move (SectionExists(hoIniFile, sWorkspace)) To bRegistered
7995>>>>>
7995>>>>>        Send Destroy of hoIniFile
7996>>>>>
7996>>>>>        Function_Return bRegistered
7997>>>>>    End_Function
7998>>>>>
7998>>>>>    Function VdfSystemDfPath Returns String
8000>>>>>        String sSystemDfPath
8000>>>>>        Get_Profile_String "Workspaces" "SystemDfPath" To sSystemDfPath
8003>>>>>
8003>>>>>        Function_Return sSystemDfPath
8004>>>>>    End_Function
8005>>>>>
8005>>>>>    Function VdfSystemMakePath Returns String
8007>>>>>        String sSystemMakePath
8007>>>>>        Get_Profile_String "Workspaces" "SystemMakePath" To sSystemMakePath
8010>>>>>
8010>>>>>        Function_Return sSystemMakePath
8011>>>>>    End_Function
8012>>>>>
8012>>>>>    Procedure DoAssignPaths
8014>>>>>        String sDataPath sBitmapPath sHelpPath sProgramPath sSystemDfPath
8014>>>>>
8014>>>>>        Get psDataPath     To sDataPath
8015>>>>>        Get psBitmapPath   To sBitmapPath
8016>>>>>        Get psHelpPath     To sHelpPath
8017>>>>>        Get psProgramPath  To sProgramPath
8018>>>>>        Get psSystemDfPath To sSystemDfPath
8019>>>>>
8019>>>>>        Set psDfPath To (sDataPath +';' + sBitmapPath +';' + sHelpPath +';' + sProgramPath +';' + sSystemDfPath)
8020>>>>>
8020>>>>>    End_Procedure
8021>>>>>
8021>>>>>    Procedure DoSetPaths
8023>>>>>        // [JVH] 8.3.8.0 - must convert paths to Ansi before setting these values
8023>>>>>        // Note- this conversion is temporarily rolled back
8023>>>>>        //Set_Attribute DF_FILELIST_NAME To (ToAnsi(psFileList(self)))
8023>>>>>        //Set_Attribute DF_OPEN_PATH     To (ToAnsi(psDfPath(self)))
8023>>>>>        Set_Attribute DF_FILELIST_NAME To (psFileList(self))
8026>>>>>        Set_Attribute DF_OPEN_PATH     To (psDfPath(self))
8029>>>>>    End_Procedure
8030>>>>>
8030>>>>>    Procedure EnumerateWorkspaceData Handle hoCallBack Handle hmGeneric
8032>>>>>         String sPath
8032>>>>>
8032>>>>>         If (psWorkspaceName(self)="") Send hmGeneric to hoCallBack C_$WorkspaceNotUsed
8035>>>>>         Else Begin
8036>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$WorkspaceDesc, psDescription(self)))
8037>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$WorkspaceName, psWorkspaceName(self)))
8038>>>>>            Send hmGeneric to hoCallBack ""
8039>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$Filelist, psFileList(self)))
8040>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$DataPath, psDataPath(self)))
8041>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$ProgramPath, psProgramPath(self)))
8042>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$HelpPath, psHelpPath(self)))
8043>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$BitmapsPath, psBitmapPath(self)))
8044>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$SystemPaths, psSystemDfPath(self)))
8045>>>>>            Send hmGeneric to hoCallBack (SFormat(C_$FullDFPath, psDfPath(self)))
8046>>>>>         End
8046>>>>>>
8046>>>>>    End_Procedure
8047>>>>>
8047>>>>>    Function OpenWorkspaceErrorMessage Integer eErrorCode Returns String
8049>>>>>        // Decodes the enumerated integer returned by OpenWorkspace and
8049>>>>>        // returns a corresponding message string.
8049>>>>>        String sError
8049>>>>>
8049>>>>>        Case Begin
8049>>>>>            Case (eErrorCode = wsWorkspaceOpened)
8051>>>>>                Move C_$NoErrors To sError
8052>>>>>                Case Break
8053>>>>>            Case (eErrorCode = wsWorkspaceNotFound)
8056>>>>>                Move C_$NoWsName To sError
8057>>>>>                Case Break
8058>>>>>            Case (eErrorCode = wsWorkspaceFileNotFound)
8061>>>>>                Move C_$NoWsFileFound To sError
8062>>>>>                Case Break
8063>>>>>            Case (eErrorCode = wsDataPathEmpty)
8066>>>>>                Move C_$NoWsDataPath To sError
8067>>>>>                Case Break
8068>>>>>            Case (eErrorCode = wsFileListEmpty)
8071>>>>>                Move C_$NoWsFileList To sError
8072>>>>>                Case Break
8073>>>>>            Case (eErrorCode = wsFileListNotExist)
8076>>>>>                Move C_$NoFileListCfg To sError
8077>>>>>                Case Break
8078>>>>>            Case Else
8078>>>>>                Move C_$UnknownError To sError
8079>>>>>                Case Break
8080>>>>>        Case End
8080>>>>>
8080>>>>>        Function_Return (sError-".")
8081>>>>>    End_Function    // OpenWorkspaceErrorMessage
8082>>>>>
8082>>>>>    Function GetWorkspaceFileName String sWorkspace Returns String
8084>>>>>        // Returns the name of the physical Workspace file for the passed Workspace name.
8084>>>>>        String sVdfRootDir
8084>>>>>        Handle hoIniFile
8084>>>>>        String sPath
8084>>>>>        String sFileName
8084>>>>>        String sWorkspacePath
8084>>>>>
8084>>>>>        Move "" To sFileName
8085>>>>>
8085>>>>>        Get_Profile_String "Defaults" "VdfRootDir" To sVdfRootDir
8088>>>>>        If (Right(sVdfRootDir,1) <>"\") Move (sVdfRootDir +"\") To sVdfRootDir
8091>>>>>
8091>>>>>        Get Create U_cIniFile To hoIniFile
8092>>>>>        Set psFilename of hoIniFile To (sVdfRootDir +"bin\Workspaces.ini")
8093>>>>>        Get ReadString of hoIniFile sWorkspace "Path" "" To sWorkspacePath
8094>>>>>        If (sWorkspacePath <>"") Begin
8096>>>>>            If (Right(sWorkspacePath,1) <>"\") Move (sWorkspacePath +"\") To sWorkspacePath
8099>>>>>            Move (sWorkspacePath +sWorkspace +".ws") To sFileName
8100>>>>>        End
8100>>>>>>
8100>>>>>        Send Destroy of hoIniFile
8101>>>>>
8101>>>>>        Function_Return sFileName
8102>>>>>    End_Function
8103>>>>>
8103>>>>>    Function CountOfPaths String sPaths Returns Integer
8105>>>>>        // Returns the number of paths defined in a string of paths
8105>>>>>        Integer iChar icChar icPath
8105>>>>>
8105>>>>>        If (sPaths ="") Function_Return 0
8108>>>>>
8108>>>>>        Move (Length(sPaths) -1) To icChar
8109>>>>>        For iChar from 1 To icChar
8115>>>>>>
8115>>>>>            If (Mid(sPaths, 1, iChar) =";") Increment icPath
8118>>>>>        Loop
8119>>>>>>
8119>>>>>
8119>>>>>        Function_Return (icPath +1)
8120>>>>>    End_Function
8121>>>>>
8121>>>>>    Function PathAtIndex String sPaths Integer iIndex Returns String
8123>>>>>        // Returns the path at the 1-based index of passed paths.
8123>>>>>        // If the path contains a trailing "\", it will be removed
8123>>>>>        Integer iChar icPath iPath iPos
8123>>>>>        String sPath
8123>>>>>
8123>>>>>        Move (sPaths +";") To sPaths
8124>>>>>        For iPath From 1 To iIndex
8130>>>>>>
8130>>>>>            Move (Pos(";", sPaths)) To iPos
8131>>>>>            If iPos Begin
8133>>>>>                Move (Left(sPaths, iPos -1)) To sPath
8134>>>>>                If (Right(sPath,1) = '\') Move (Left(sPath, Length(sPath) -1)) To sPath
8137>>>>>                Move (Right(sPaths, Length(sPaths) -iPos)) To sPaths
8138>>>>>            End
8138>>>>>>
8138>>>>>            Else Function_Return "" // index past number of paths
8140>>>>>        Loop
8141>>>>>>
8141>>>>>
8141>>>>>        Function_Return sPath
8142>>>>>    End_Function
8143>>>>>
8143>>>>>End_Class
8144>>>>>
8144>>>Use cCommandLine.pkg
Including file: cCommandLine.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCommandLine.pkg)
8144>>>>>// CLASS: cCommandLine
8144>>>>>// Author: SWB
8144>>>>>
8144>>>>>use VDFBase.pkg
8144>>>>>
8144>>>>>Class cCommandLine is a cObject
8145>>>>>
8145>>>>>    Procedure Construct_Object
8147>>>>>        Forward Send Construct_Object
8149>>>>>
8149>>>>>        Property Handle phoArgs // private object-handle of internal array of arguments
8150>>>>>    End_Procedure
8151>>>>>
8151>>>>>    Procedure Private_DoCreateArgsArray
8153>>>>>        // creates the array for holding the arguments. Created upon demand only!
8153>>>>>        Integer icArg
8153>>>>>        String sArg
8153>>>>>
8153>>>>>        Object oArgs is an Array
8155>>>>>            Delegate Set phoArgs To self
8157>>>>>            Repeat
8157>>>>>>
8157>>>>>                CmdLine sArg
8158>>>>>>
8158>>>>>                If (sArg <> "") Begin
8160>>>>>                    Increment icArg
8161>>>>>                    Set Value  (icArg -1) To sArg
8162>>>>>                End
8162>>>>>>
8162>>>>>            Until (sArg = "")
8164>>>>>        End_Object
8165>>>>>    End_Procedure
8166>>>>>
8166>>>>>    Function CountOfArgs Returns Integer
8168>>>>>        //Returns the number of arguments passed
8168>>>>>        If (phoArgs(self) =0) Send Private_DoCreateArgsArray
8171>>>>>        Function_Return (Item_Count(phoArgs(self)))
8172>>>>>    End_Function
8173>>>>>
8173>>>>>    Function Argument Integer iIndex Returns String
8175>>>>>        //Returns the one-based argument string
8175>>>>>        If (phoArgs(self) =0) Send Private_DoCreateArgsArray
8178>>>>>        Function_Return (Value(phoArgs(self), iIndex -1))
8179>>>>>    End_Function
8180>>>>>
8180>>>>>End_Class
8181>>>Use cRegistry.pkg
Including file: cRegistry.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cRegistry.pkg)
8181>>>>>// cRegistry.pkg
8181>>>>>// Author: SWB
8181>>>>>
8181>>>>>//  Registry Access Package
8181>>>>>
8181>>>>>Use Windows.pkg
8181>>>>>Use RegistryAPI.pkg
8181>>>>>
8181>>>>>Enum_List // Registry Data types
8181>>>>>    Define rdString
8181>>>>>    Define rdDword
8181>>>>>    Define rdBinary
8181>>>>>    Define rdUnknown
8181>>>>>End_Enum_List
8181>>>>>
8181>>>>>//Prototypes
8181>>>>>Register_Function phRootKey      Returns Handle // HKEY_CURRENT_USER
8181>>>>>Register_Function pfAccessRights Returns Integer // KEY_ALL_ACCESS - what access level should be used to open a Key?
8181>>>>>Register_Function phCurrentKey   Returns Handle // low-level key
8181>>>>>Register_Function pbLazyWrite    Returns Boolean // True
8181>>>>>
8181>>>>>Register_Function CountOfSubkeys      Returns Integer
8181>>>>>Register_Function CountOfValues       Returns Integer
8181>>>>>Register_Function CreateKey           String sKeyName Returns Integer   // return=error code
8181>>>>>Register_Function DeleteKey           String sKeyName Returns Boolean       // Deleted successfully?
8181>>>>>Register_Function DeleteValue         String sValueName Returns Boolean // Deleted successfully?
8181>>>>>Register_Function GetSubkeys          Handle hoArray Returns Integer    // count of Subkeys
8181>>>>>Register_Function GetValues           Handle hoArray Returns Integer    // count of Values
8181>>>>>Register_Function KeyExists           String sKeyName Returns Boolean   // does the key exist?
8181>>>>>Register_Function LongestDataLength   Returns Integer
8181>>>>>Register_Function LongestSubkeyLength Returns Integer
8181>>>>>Register_Function LongestValueLength  Returns Integer
8181>>>>>Register_Function OpenKey             string sKeyName Returns Integer
8181>>>>>Register_Function ReadBinary          String sValueName Address aValueData Integer iDataLength Returns Boolean
8181>>>>>Register_Function ReadDword           String sValueName Returns DWord
8181>>>>>Register_Function ReadString          String sValueName Returns String
8181>>>>>Register_Function ValueExists         String sValueName Returns Integer // does the Value exist?
8181>>>>>Register_Function ValueLength         String sValueName Returns Integer
8181>>>>>Register_Function ValueType           String sValueName Returns Integer // what is the datatype of the Value?
8181>>>>>Register_Procedure CloseKey
8181>>>>>Register_Procedure WriteBinary        String sValueName Address aValueData Integer iDataLength
8181>>>>>Register_Procedure WriteDword         String sValue DWord dwValueData
8181>>>>>Register_Procedure WriteString        String sValue String sValueData
8181>>>>>
8181>>>>>
8181>>>>>Class cRegistry is a cObject
8182>>>>>    Procedure Construct_Object
8184>>>>>        Forward Send Construct_Object
8186>>>>>
8186>>>>>        Property Handle phRootKey HKEY_CURRENT_USER
8187>>>>>        Property UInteger pfAccessRights  KEY_ALL_ACCESS // what access level should be used to open a Key?
8188>>>>>        Property Handle phCurrentKey
8189>>>>>        Property Boolean pbLazyWrite True
8190>>>>>    End_Procedure
8191>>>>>
8191>>>>>    Function CountOfSubkeys Returns Integer
8193>>>>>        DWord dwCountOfSubkeys
8193>>>>>        Integer iError
8193>>>>>        String sError
8193>>>>>
8193>>>>>        Move 0 To dwCountOfSubkeys
8194>>>>>        Move (RegQueryInfoKey(phCurrentKey(self), 0, 0, 0, AddressOf(dwCountOfSubkeys), 0, 0, 0, 0, 0, 0, 0)) To iError
8195>>>>>        If iError Begin
8197>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8198>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8199>>>>>>
8199>>>>>        End
8199>>>>>>
8199>>>>>        Function_Return dwCountOfSubkeys
8200>>>>>    End_Function
8201>>>>>
8201>>>>>    Function CountOfValues Returns Integer
8203>>>>>        DWord dwCountOfValues
8203>>>>>        Integer iError
8203>>>>>        String sError
8203>>>>>
8203>>>>>        Move 0 To dwCountOfValues
8204>>>>>        Move (RegQueryInfoKey(phCurrentKey(self), 0, 0, 0, 0, 0, 0, AddressOf(dwCountOfValues), 0, 0, 0, 0)) To iError
8205>>>>>        If iError Begin
8207>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8208>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8209>>>>>>
8209>>>>>        End
8209>>>>>>
8209>>>>>
8209>>>>>        Function_Return dwCountOfValues
8210>>>>>    End_Function
8211>>>>>
8211>>>>>    Function LongestSubkeyLength Returns Integer
8213>>>>>        DWord dwLongestSubkeyLength
8213>>>>>        Integer iError
8213>>>>>        String sError
8213>>>>>
8213>>>>>        Move 0 To dwLongestSubkeyLength
8214>>>>>        Move (RegQueryInfoKey(phCurrentKey(self), 0, 0, 0, 0, AddressOf(dwLongestSubkeyLength), 0, 0, 0, 0, 0, 0)) To iError
8215>>>>>        If iError Begin
8217>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8218>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8219>>>>>>
8219>>>>>        End
8219>>>>>>
8219>>>>>
8219>>>>>        Function_Return dwLongestSubkeyLength
8220>>>>>    End_Function
8221>>>>>
8221>>>>>    Function LongestValueLength Returns Integer
8223>>>>>        DWord dwLongestValueLength
8223>>>>>        Integer iError
8223>>>>>        String sError
8223>>>>>
8223>>>>>        Move 0 To dwLongestValueLength
8224>>>>>        Move (RegQueryInfoKey(phCurrentKey(self), 0, 0, 0, 0, 0, 0, 0, AddressOf(dwLongestValueLength), 0, 0, 0)) To iError
8225>>>>>        If iError Begin
8227>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8228>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8229>>>>>>
8229>>>>>        End
8229>>>>>>
8229>>>>>
8229>>>>>        Function_Return dwLongestValueLength
8230>>>>>    End_Function
8231>>>>>
8231>>>>>    Function LongestDataLength Returns Integer
8233>>>>>        DWord dwLongestDataLength
8233>>>>>        Integer iError
8233>>>>>        String sError
8233>>>>>
8233>>>>>        Move 0 To dwLongestDataLength
8234>>>>>        Move (RegQueryInfoKey(phCurrentKey(self), 0, 0, 0, 0, 0, 0, 0, 0, AddressOf(dwLongestDataLength), 0, 0)) To iError
8235>>>>>        If iError Begin
8237>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8238>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8239>>>>>>
8239>>>>>        End
8239>>>>>>
8239>>>>>
8239>>>>>        Function_Return dwLongestDataLength
8240>>>>>    End_Function
8241>>>>>
8241>>>>>    Function ValueType String sValueName Returns Integer
8243>>>>>        DWord dwType
8243>>>>>        Integer iError eType
8243>>>>>        String sError
8243>>>>>
8243>>>>>        Move 0 To dwType
8244>>>>>        Move (RegQueryValueEx(phCurrentKey(self), ToAnsi(sValueName), 0, AddressOf(dwType), 0, 0)) To iError
8245>>>>>        If iError Begin
8247>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8248>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8249>>>>>>
8249>>>>>        End
8249>>>>>>
8249>>>>>
8249>>>>>        If (dwType = REG_SZ)          Move rdString To eType
8252>>>>>        Else If (dwType = REG_DWORD)  Move rdDword To eType
8256>>>>>        Else If (dwType = REG_BINARY) Move rdBinary To eType
8260>>>>>        Else                          Move rdUnknown To eType
8262>>>>>
8262>>>>>        Function_Return eType
8263>>>>>    End_Function
8264>>>>>
8264>>>>>    Function ValueLength String sValueName Returns Integer
8266>>>>>        DWord dwSize
8266>>>>>        Integer iError
8266>>>>>        String sError
8266>>>>>
8266>>>>>        Move 0 To dwSize
8267>>>>>        Move (RegQueryValueEx(phCurrentKey(self), ToAnsi(sValueName), 0, 0, 0, AddressOf(dwSize))) To iError
8268>>>>>        If iError Begin
8270>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8271>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8272>>>>>>
8272>>>>>        End
8272>>>>>>
8272>>>>>
8272>>>>>        Function_Return dwSize
8273>>>>>    End_Function
8274>>>>>
8274>>>>>    Function CreateKey string sKeyName Returns Integer // return=error code
8276>>>>>        // Calling CreateKey for an existing Key, merely opens it without error.
8276>>>>>        Handle hKey hKeyOpened
8276>>>>>        Integer iError
8276>>>>>        String sError
8276>>>>>
8276>>>>>        Move 0 To hKeyOpened // initialize it so we can get its address
8277>>>>>
8277>>>>>        Get phRootKey To hKey
8278>>>>>
8278>>>>>        Move (RegCreateKeyEx(hKey, ToAnsi(sKeyName), 0, 0, REG_OPTION_NON_VOLATILE, pfAccessRights(self), 0, AddressOf(hKeyOpened), 0)) To iError
8279>>>>>        If (iError =0) Set phCurrentKey To hKeyOpened
8282>>>>>        Else Begin
8283>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8284>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8285>>>>>>
8285>>>>>        End
8285>>>>>>
8285>>>>>        Function_Return iError
8286>>>>>    End_Function
8287>>>>>
8287>>>>>    Procedure CloseKey
8289>>>>>        Integer iError
8289>>>>>        Handle hKey
8289>>>>>
8289>>>>>        Get phCurrentKey To hKey
8290>>>>>
8290>>>>>        If (hKey <>0) Begin
8292>>>>>            If (pbLazyWrite(self)) Move (RegCloseKey(hKey)) To iError
8295>>>>>            Else Move (RegFlushKey(hKey)) To iError
8297>>>>>
8297>>>>>            Set phCurrentKey To 0
8298>>>>>        End
8298>>>>>>
8298>>>>>    End_Procedure
8299>>>>>
8299>>>>>    Function OpenKey string sKeyName Returns Boolean
8301>>>>>        Handle hKey hKeyOpened
8301>>>>>        Integer iError
8301>>>>>
8301>>>>>        Move 0 To hKeyOpened // initialize it so we can get its address
8302>>>>>
8302>>>>>        Get phRootKey To hKey
8303>>>>>        Move (RegOpenKeyEx(hKey, ToAnsi(sKeyName), 0, pfAccessRights(self), AddressOf(hKeyOpened))) To iError
8304>>>>>        If (iError =0) Set phCurrentKey To hKeyOpened
8307>>>>>
8307>>>>>        Function_Return (iError=0)
8308>>>>>    End_Function
8309>>>>>
8309>>>>>    Procedure WriteDword String sValue DWord dwValueData
8311>>>>>        Handle hKey
8311>>>>>        Integer iError
8311>>>>>        Pointer lpsDWord
8311>>>>>        String sDWord
8311>>>>>        String sError
8311>>>>>
8311>>>>>        ZeroType tDWord To sDWord
8312>>>>>        Put dwValueData To sDWord At tDWord.dword
8313>>>>>        GetAddress of sDWord To lpsDWord
8314>>>>>
8314>>>>>        Get phCurrentKey To hKey
8315>>>>>        Move (RegSetValueEx(hKey, ToAnsi(sValue), 0, REG_DWORD, lpsDWord, 4)) To iError
8316>>>>>        If iError Begin
8318>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8319>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8320>>>>>>
8320>>>>>        End
8320>>>>>>
8320>>>>>    End_Procedure
8321>>>>>
8321>>>>>    Procedure WriteString String sValue String sValueData
8323>>>>>        Handle hKey
8323>>>>>        Integer iError cbData
8323>>>>>        Pointer lpsValueData
8323>>>>>        String sError
8323>>>>>
8323>>>>>        If (sValueData = "") Begin
8325>>>>>             Move (Character(0)) To sValueData
8326>>>>>             Move 1 To cbData
8327>>>>>        End
8327>>>>>>
8327>>>>>        Else Begin
8328>>>>>             Move (Length(sValueData) +1) To cbData
8329>>>>>        End
8329>>>>>>
8329>>>>>        Move (ToAnsi(sValueData)) To sValueData
8330>>>>>        GetAddress of sValueData To lpsValueData
8331>>>>>
8331>>>>>        Get phCurrentKey To hKey
8332>>>>>        Move (RegSetValueEx(hKey, ToAnsi(sValue), 0, REG_SZ, lpsValueData, cbData)) To iError
8333>>>>>        If iError Begin
8335>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8336>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8337>>>>>>
8337>>>>>        End
8337>>>>>>
8337>>>>>    End_Procedure
8338>>>>>
8338>>>>>    Procedure WriteBinary String sValueName Address aValueData Integer iDataLength
8340>>>>>        Handle hKey
8340>>>>>        Integer iError
8340>>>>>        String sError
8340>>>>>
8340>>>>>        Get phCurrentKey To hKey
8341>>>>>        Move (RegSetValueEx(hKey, ToAnsi(sValueName), 0, REG_BINARY, aValueData, iDataLength)) To iError
8342>>>>>        If iError Begin
8344>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8345>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8346>>>>>>
8346>>>>>        End
8346>>>>>>
8346>>>>>    End_Procedure
8347>>>>>
8347>>>>>    Function ReadDword String sValueName Returns DWord
8349>>>>>        Handle hKey
8349>>>>>        Integer iError
8349>>>>>        DWord dwValueData dwValueDataLength
8349>>>>>        String sError
8349>>>>>
8349>>>>>        Move 0           To dwValueData
8350>>>>>        Move tDWord_Size To dwValueDataLength
8351>>>>>
8351>>>>>        Get phCurrentKey To hKey
8352>>>>>        Move (RegQueryValueEx(hKey, ToAnsi(sValueName), 0, 0, AddressOf(dwValueData), AddressOf(dwValueDataLength))) To iError
8353>>>>>        If iError Begin
8355>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8356>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8357>>>>>>
8357>>>>>        End
8357>>>>>>
8357>>>>>
8357>>>>>        Function_Return dwValueData
8358>>>>>    End_Function
8359>>>>>
8359>>>>>    Function ReadString String sValueName Returns String
8361>>>>>        Handle hKey
8361>>>>>        Integer iError
8361>>>>>        String sValueData
8361>>>>>        DWord dwValueDataLength
8361>>>>>        Pointer lpsValueData
8361>>>>>        String sError
8361>>>>>
8361>>>>>        Move (Repeat(character(0), ValueLength(self, sValueName))) To sValueData
8362>>>>>        GetAddress of sValueData To lpsValueData
8363>>>>>
8363>>>>>        Move (Length(sValueData)) To dwValueDataLength
8364>>>>>
8364>>>>>        Get phCurrentKey To hKey
8365>>>>>        Move (RegQueryValueEx(hKey, ToAnsi(sValueName), 0, 0, lpsValueData, AddressOf(dwValueDataLength))) To iError
8366>>>>>        If iError Begin
8368>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8369>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8370>>>>>>
8370>>>>>        End
8370>>>>>>
8370>>>>>
8370>>>>>        Function_Return (ToOem(CString(sValueData)))
8371>>>>>    End_Function
8372>>>>>
8372>>>>>    Function ReadBinary String sValueName Address aValueData Integer iDataLength Returns Boolean
8374>>>>>        Handle hKey
8374>>>>>        Integer iError
8374>>>>>        String sError
8374>>>>>
8374>>>>>        Get phCurrentKey To hKey
8375>>>>>        Move (RegQueryValueEx(hKey, ToAnsi(sValueName), 0, 0, aValueData, AddressOf(iDataLength))) To iError
8376>>>>>        If iError Begin
8378>>>>>            Move (FormatWinError(iError)) To sError // raise an error if the Query failed
8379>>>>>            Error DFERR_REGISTRY sError // Generic Windows Error
8380>>>>>>
8380>>>>>        End
8380>>>>>>
8380>>>>>
8380>>>>>        Function_Return (iDataLength >0)
8381>>>>>    End_Function
8382>>>>>
8382>>>>>
8382>>>>>    // Private....
8382>>>>>    Function GetBaseKey Returns Handle
8384>>>>>        Handle hBaseKey
8384>>>>>        If (phCurrentKey(self) = 0)  Get phRootKey To hBaseKey
8387>>>>>        Else Get phCurrentKey To hBaseKey
8389>>>>>
8389>>>>>        Function_Return hBaseKey
8390>>>>>    End_Function
8391>>>>>
8391>>>>>    Function GetKey String sKeyName Returns Handle
8393>>>>>        Handle hKeyOpened
8393>>>>>        Integer iError
8393>>>>>
8393>>>>>        MOve 0 To hKeyOpened // initialize so we can get its address
8394>>>>>
8394>>>>>        Move (RegOpenKeyEx(GetBaseKey(self), ToAnsi(sKeyName), 0, pfAccessRights(self), AddressOf(hKeyOpened))) To iError
8395>>>>>
8395>>>>>        If (iError =0) Function_Return hKeyOpened
8398>>>>>        Else           Function_Return 0
8400>>>>>    End_Function
8401>>>>>
8401>>>>>    // Public
8401>>>>>    Function KeyExists String sKeyName Returns Boolean
8403>>>>>        Handle hKey
8403>>>>>        Integer iVoid
8403>>>>>
8403>>>>>        Get GetKey sKeyName To hKey
8404>>>>>        If hKey Move (RegCloseKey(hKey)) To iVoid
8407>>>>>        Function_Return (hKey <>0)
8408>>>>>    End_Function
8409>>>>>
8409>>>>>    Function ValueExists String sValueName Returns Boolean
8411>>>>>        // Determines whether a Value exists for the currently-opened Key.
8411>>>>>        Integer iError
8411>>>>>        Dword dwDataType
8411>>>>>        Move 0 To dwDataType // must initialize the variable to get its address
8412>>>>>
8412>>>>>        Move (RegQueryValueEx(phCurrentKey(self), ToAnsi(sValueName), 0, AddressOf(dwDataType), 0, 0)) To iError
8413>>>>>
8413>>>>>        Function_Return (iError=0)
8414>>>>>    End_Function
8415>>>>>
8415>>>>>    Function DeleteKey String sKeyName Returns Boolean // Deleted successfully?
8417>>>>>        Function_Return (ShDeleteKey(phRootKey(self), ToAnsi(sKeyName)) =0)
8418>>>>>    End_Function
8419>>>>>
8419>>>>>    Function DeleteValue String sValueName Returns Boolean // Deleted successfully?
8421>>>>>        Function_Return (RegDeleteValue(phCurrentKey(self), ToAnsi(sValueName)) =0)
8422>>>>>    End_Function
8423>>>>>
8423>>>>>    Function GetSubkeys Handle hoArray Returns Integer // count of Values
8425>>>>>        Integer iError
8425>>>>>        Integer icValue iLongestSubkey
8425>>>>>        Handle hKey
8425>>>>>        DWord dwSubkeyNameLength
8425>>>>>        String sSubkeyName sFileTime
8425>>>>>        Pointer lpsSubkeyName lpsFileTime
8425>>>>>
8425>>>>>        Get LongestSubkeyLength To iLongestSubkey
8426>>>>>        Move (Repeat(character(0), iLongestSubkey +1)) To sSubkeyName
8427>>>>>        GetAddress of sSubkeyName To lpsSubkeyName
8428>>>>>
8428>>>>>        ZeroType tFileTime To sFileTime
8429>>>>>        GetAddress of sFileTime To lpsFileTime
8430>>>>>
8430>>>>>        Get phCurrentKey To hKey
8431>>>>>        Repeat
8431>>>>>>
8431>>>>>            Move (iLongestSubkey +1) To dwSubkeyNameLength
8432>>>>>
8432>>>>>            Move (RegEnumKeyEx(hKey, icValue, lpsSubkeyName, AddressOf(dwSubkeyNameLength), 0, 0, 0, lpsFileTime)) To iError
8433>>>>>            If (iError =0) Begin
8435>>>>>                Increment icValue
8436>>>>>                Set Value of hoArray (Item_Count(hoArray)) To (ToOem(CString(sSubkeyName)))
8437>>>>>            End
8437>>>>>>
8437>>>>>        Until (iError)
8439>>>>>        Function_Return icValue
8440>>>>>
8440>>>>>    End_Function
8441>>>>>
8441>>>>>    Function GetValues Handle hoArray Returns Integer // count of Values
8443>>>>>        Integer iError
8443>>>>>        Integer icValue iLongestValue
8443>>>>>        Handle hKey
8443>>>>>        DWord dwValueNameLength
8443>>>>>        String sValueName sValueNameSize
8443>>>>>        Pointer lpsValueName
8443>>>>>
8443>>>>>        Get LongestValueLength To iLongestValue
8444>>>>>        Move (Repeat(character(0), iLongestValue +1)) To sValueName
8445>>>>>        GetAddress of sValueName To lpsValueName
8446>>>>>
8446>>>>>        Get phCurrentKey To hKey
8447>>>>>        Repeat
8447>>>>>>
8447>>>>>            Move (iLongestValue +1) To dwValueNameLength
8448>>>>>            Move (RegEnumValue(hKey, icValue, lpsValueName, AddressOf(dwValueNameLength), 0, 0, 0, 0)) To iError
8449>>>>>            If (iError =0) Begin
8451>>>>>                Increment icValue
8452>>>>>                Set Value of hoArray (Item_Count(hoArray)) To (ToOem(CString(sValueName)))
8453>>>>>            End
8453>>>>>>
8453>>>>>        Until (iError)
8455>>>>>        Function_Return icValue
8456>>>>>
8456>>>>>    End_Function
8457>>>>>
8457>>>>>End_Class
8458>>>Use cVersionInfo.pkg
Including file: cVersionInfo.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cVersionInfo.pkg)
8458>>>>>// Class cVersionInfo
8458>>>>>//
8458>>>>>// Stores version information about the EXE
8458>>>>>// Designed to be instantiated as a child of the Application object
8458>>>>>//
8458>>>>>// Created: Mar 12, 2002   SWB
8458>>>>>
8458>>>>>
8458>>>>>Use Windows.pkg
8458>>>>>Use DLL.pkg
8458>>>>>Use WinKern.pkg
8458>>>>>
8458>>>>>Define VS_FF_DEBUG         for |CI$00000001
8458>>>>>Define VS_FF_PRERELEASE    for |CI$00000002
8458>>>>>Define VS_FF_PATCHED       for |CI$00000004
8458>>>>>Define VS_FF_PRIVATEBUILD  for |CI$00000008
8458>>>>>Define VS_FF_INFOINFERRED  for |CI$00000010
8458>>>>>Define VS_FF_SPECIALBUILD  for |CI$00000020
8458>>>>>
8458>>>>>External_Function GetFileVersionInfoSize "GetFileVersionInfoSizeA" version.dll ;    Pointer aFilename ;    Pointer lpdwHandle ;Returns Dword
8459>>>>>
8459>>>>>External_Function GetFileVersionInfo "GetFileVersionInfoA" version.dll ;    Pointer sFilename ;    Dword dwHandle ;    Dword dwLen ;    Address aData ;Returns Integer
8460>>>>>
8460>>>>>External_Function VerQueryValue "VerQueryValueA" version.dll ;    Address aBlock ;    Address aSubBlock ;    Address aaBuffer ;    Address puLen ;Returns Integer
8461>>>>>
8461>>>>>Type tVsFixedFileInfo
8461>>>>>    Field tVsFixedFileInfo.dwSignature        as Dword
8461>>>>>    Field tVsFixedFileInfo.dwStrucVersion     as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileVersionMS    as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileVersionLS    as Dword
8461>>>>>    Field tVsFixedFileInfo.dwProductVersionMS as Dword
8461>>>>>    Field tVsFixedFileInfo.dwProductVersionLS as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileFlagsMask    as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileFlags        as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileOS           as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileType         as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileSubtype      as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileDateMS       as Dword
8461>>>>>    Field tVsFixedFileInfo.dwFileDateLS       as Dword
8461>>>>>End_Type
8461>>>>>
8461>>>>>Class cVersionInfo is a cObject
8462>>>>>    Procedure Construct_Object
8464>>>>>        Forward Send Construct_Object
8466>>>>>
8466>>>>>
8466>>>>>        Property Integer piVersionMajor
8467>>>>>        Property Integer piVersionMinor
8468>>>>>        Property Integer piVersionRelease
8469>>>>>        Property Integer piVersionBuild
8470>>>>>
8470>>>>>        Property Boolean pbIncluded
8471>>>>>        Property Boolean pbSpecialBuild
8472>>>>>        Property Boolean pbPrivateBuild
8473>>>>>
8473>>>>>    End_Procedure
8474>>>>>
8474>>>>>    Procedure DoCreate String sFileName
8476>>>>>        Dword dwHandle
8476>>>>>        Integer iInfoSize iVerSize iSuccess iVersion iVoid iFlags
8476>>>>>        String sData
8476>>>>>        String sVersionBuffer
8476>>>>>        String sVsFixedFileInfo
8476>>>>>        String sSubBlock
8476>>>>>        Address aVsFixedFileInfo
8476>>>>>
8476>>>>>        move 0 To aVsFixedFileInfo
8477>>>>>        Move 0 To dwHandle
8478>>>>>        Move 0 To iVerSize
8479>>>>>
8479>>>>>        Move (GetFileVersionInfoSize(AddressOf(sFilename), AddressOf(dwHandle))) To iInfoSize
8480>>>>>        Set pbIncluded To (iInfoSize <>0)
8481>>>>>
8481>>>>>        If (pbIncluded(self)) Begin
8483>>>>>            Move (Repeat(Character(0), iInfoSize)) To sData
8484>>>>>            Move (GetFileVersionInfo(AddressOf(sFilename), 0, iInfoSize, AddressOf(sData))) To iSuccess
8485>>>>>
8485>>>>>            If (iSuccess <>0) Begin
8487>>>>>                Move "\" To sSubBlock
8488>>>>>                If (VerQueryValue(AddressOf(sData), AddressOf(sSubBlock), AddressOf(aVsFixedFileInfo), AddressOf(iVerSize))) Begin
8490>>>>>                    ZeroType tVsFixedFileInfo To sVsFixedFileInfo
8491>>>>>                    Move (memcopy(AddressOf(sVsFixedFileInfo), aVsFixedFileInfo, iVerSize)) to iVoid // copy the structure
8492>>>>>
8492>>>>>                    GetBuff from sVsFixedFileInfo at tVsFixedFileInfo.dwFileVersionMS To iVersion
8493>>>>>                    Set piVersionMajor To (Hi(iVersion))
8494>>>>>                    Set piVersionMinor To (Low(iVersion))
8495>>>>>
8495>>>>>                    GetBuff from sVsFixedFileInfo at tVsFixedFileInfo.dwFileVersionLS To iVersion
8496>>>>>                    Set piVersionRelease To (Hi(iVersion))
8497>>>>>                    Set piVersionBuild   To (Low(iVersion))
8498>>>>>
8498>>>>>                    GetBuff from sVsFixedFileInfo at tVsFixedFileInfo.dwFileFlags To iFlags
8499>>>>>                    Set pbSpecialBuild    To (iFlags IAND VS_FF_SPECIALBUILD)
8500>>>>>                    Set pbPrivateBuild    To (iFlags IAND VS_FF_PRIVATEBUILD)
8501>>>>>                End
8501>>>>>>
8501>>>>>            End
8501>>>>>>
8501>>>>>
8501>>>>>        End
8501>>>>>>
8501>>>>>    End_Procedure
8502>>>>>
8502>>>>>End_Class
8503>>>>>
8503>>>>>
8503>>>Use GlobalFunctionsProcedures.pkg
8503>>>Use Dferror.pkg
Including file: Dferror.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dferror.pkg)
8503>>>>>//************************************************************************
8503>>>>> //
8503>>>>> //* Copyright (c) 1997 Data Access Corporation, Miami Florida,
8503>>>>> //* All rights reserved.
8503>>>>> //* DataFlex is a registered trademark of Data Access Corporation.
8503>>>>> //*
8503>>>>> //*  Module Name:
8503>>>>> //*      DFERROR.PKG
8503>>>>>//************************************************************************
8503>>>>>
8503>>>>>
8503>>>>>
8503>>>>>Use LanguageText.pkg
8503>>>>>
8503>>>>>
8503>>>>>Use Windows.pkg
8503>>>>>Use msgbox.pkg
8503>>>>>Use GlobalFunctionsProcedures.pkg
8503>>>>>
8503>>>>>//integer ghoErrorSource
8503>>>>>//Move 0 to ghoErrorSource
8503>>>>>//// ghoErrorSource object is expected to support this message
8503>>>>>//Register_Function Extended_Error_Message returns string
8503>>>>>
8503>>>>>// Include or define all useful symbols.
8503>>>>>Use ERRORNUM.INC
8503>>>>>// these are kept for compatibility. Don't use them
8503>>>>>
8503>>>>>// used by error handler and UserError to pull a caption out of the error string
8503>>>>>Define C_ErrorCaption for "*CAPTION*="
8503>>>>>
8503>>>>>// This array stores the set of trapped errors as toggled ranges starting
8503>>>>>// with the errors that are trapped. The array should always contain 0 and
8503>>>>>// MAX_ERROR_NUMBER + 1, which are the limits. If an array contained the
8503>>>>>// following items...
8503>>>>>//
8503>>>>>// { 0, 5, 10, MAX_ERROR_NUMBER + 1 }.
8503>>>>>//
8503>>>>>// This would mean that errors 1 - 4 are trapped, 5 - 9 are ignored, and
8503>>>>>// 10 through the rest are trapped.
8503>>>>>//
8503>>>>>Class Trapped_Errors_Array is an array
8504>>>>>
8504>>>>>    // Find largest error LE targetError. Assumes array is sorted.
8504>>>>>    Function findErrorLE Integer targetError Returns Integer
8506>>>>>
8506>>>>>        Integer lowIndex hiIndex midIndex currError
8506>>>>>
8506>>>>>        // If error is outside of boudary conditions, use
8506>>>>>        // value of closest valid error# instead.
8506>>>>>        If targetError le 0;            Move 1 to targetError
8509>>>>>        Else If targetError ge MAX_ERROR_NUMBER ;            Move ( MAX_ERROR_NUMBER - 1 ) to targetError
8513>>>>>
8513>>>>>        Move 0 to lowIndex
8514>>>>>        Move ( item_count( Self ) - 1 ) to hiIndex
8515>>>>>
8515>>>>>        // midIndex will contain the closest error LE to target upon exit.
8515>>>>>        Repeat
8515>>>>>>
8515>>>>>
8515>>>>>            Move ( ( lowIndex + hiIndex ) / 2 ) to midIndex
8516>>>>>            Move ( integer_value( Self, midIndex ) )  to currError
8517>>>>>
8517>>>>>            // midIndex is targetIndex if a match occurs
8517>>>>>            If currError eq targetError ;                Function_Return midIndex
8520>>>>>
8520>>>>>            // We are either on it or just below it.
8520>>>>>            If ( lowIndex eq midIndex ) Begin
8522>>>>>
8522>>>>>                If ( integer_value( Self, hiIndex ) le targetError ) ;                    Move hiIndex to midIndex
8525>>>>>
8525>>>>>                Function_Return midIndex
8526>>>>>
8526>>>>>            End
8526>>>>>>
8526>>>>>
8526>>>>>            // No match, so move the boundaries.
8526>>>>>            If currError gt targetError ;                Move ( midIndex - 1 ) to hiIndex
8529>>>>>            Else ;                Move midIndex to lowIndex
8531>>>>>
8531>>>>>        Until lowIndex gt hiIndex
8533>>>>>
8533>>>>>        Function_Return midIndex
8534>>>>>
8534>>>>>    End_Function
8535>>>>>
8535>>>>>    // Boundaries of the table are assumed to hold error limits.
8535>>>>>    Procedure initArray
8537>>>>>        Send delete_data
8538>>>>>        Set array_value item 0 to 0
8539>>>>>        Set array_value item 1 to ( MAX_ERROR_NUMBER + 1 )
8540>>>>>    End_Procedure
8541>>>>>
8541>>>>>    // Return 1 if Error is trapped, 0 otherwise.
8541>>>>>    Function IsTrapped Integer Error# Returns Integer
8543>>>>>        Function_Return ( not ( mod( findErrorLE( Self, Error# ), 2 ) ) )
8544>>>>>    End_Function
8545>>>>>
8545>>>>>    // Add the error as long as it doesn't violate boundary conditions.
8545>>>>>    // This routine leaves the array unsorted.
8545>>>>>    Procedure addError Integer Error#
8547>>>>>        If ( ( Error# lt MAX_ERROR_NUMBER ) and ( Error# gt 0 ) ) ;            Set array_value item ( item_count( Self ) ) to ( Integer( Error# ) )
8550>>>>>    End_Procedure
8551>>>>>
8551>>>>>    // Set error to flagged state.
8551>>>>>    Procedure handleError Integer Error# Integer trapFlag
8553>>>>>
8553>>>>>        Integer prevErrIndex prevErrFlag prevErrValue nextErrValue
8553>>>>>
8553>>>>>        If ( ( Error# gt MAX_ERROR_NUMBER ) or ( Error# lt 0 ) ) Begin
8555>>>>>            Error DFERR_ERROR_NUMBER_OUT_OF_RANGE
8556>>>>>>
8556>>>>>            Procedure_Return
8557>>>>>        End
8557>>>>>>
8557>>>>>
8557>>>>>        Get findErrorLE Error# to prevErrIndex
8558>>>>>        Get isTrapped   Error# to prevErrFlag
8559>>>>>
8559>>>>>        // if eq, Error already handled in some range.
8559>>>>>        If PrevErrFlag NE trapFlag Begin
8561>>>>>
8561>>>>>          // This is kind of complicated. If we are adding an error,
8561>>>>>          // we have to account for the error already being in the
8561>>>>>          // array as well as rejoining ranges that have been previously
8561>>>>>          // split and splitting ranges when adding a new flag.
8561>>>>>
8561>>>>>          Get integer_value item ( prevErrIndex + 1 ) to nextErrValue
8562>>>>>          Get integer_value item prevErrIndex         to prevErrValue
8563>>>>>
8563>>>>>          // Do this first so prevErrIndex stays valid.
8563>>>>>          If nextErrValue eq ( Error# + 1 ) ;              Send delete_item ( prevErrIndex + 1 )
8566>>>>>          Else ;              Send addError ( Error# + 1 )
8568>>>>>
8568>>>>>          If ( prevErrValue lt Error# ) ;              Send addError Error#
8571>>>>>          Else ;              Send delete_item prevErrIndex
8573>>>>>        End
8573>>>>>>
8573>>>>>        Send sort_items UPWARD_DIRECTION
8574>>>>>
8574>>>>>    End_Procedure
8575>>>>>
8575>>>>>    //*** Flag error as trappable
8575>>>>>    Procedure Trap_Error Integer Error#
8577>>>>>        Send handleError Error# 1
8578>>>>>    End_Procedure
8579>>>>>
8579>>>>>    //*** Flag error as non-trappable
8579>>>>>    Procedure Ignore_Error Integer Error#
8581>>>>>        Send handleError Error# 0
8582>>>>>    End_Procedure
8583>>>>>
8583>>>>>    //*** Flag all errors as trappable
8583>>>>>    Procedure Trap_All
8585>>>>>        Send initArray
8586>>>>>    End_Procedure
8587>>>>>
8587>>>>>    //*** Flag all errors as non-trappable
8587>>>>>    Procedure Ignore_All
8589>>>>>        Send delete_data
8590>>>>>        Set array_value item 0 to 0
8591>>>>>        Set array_value item 1 to 1
8592>>>>>        Set array_value item 2 to ( MAX_ERROR_NUMBER + 1 )
8593>>>>>    End_Procedure
8594>>>>>
8594>>>>>End_Class
8595>>>>>
8595>>>>>
8595>>>>>Class ErrorSystem is a cObject
8596>>>>>
8596>>>>>    Procedure construct_object
8598>>>>>        Forward Send construct_object
8600>>>>>
8600>>>>>        Set delegation_mode to no_delegate_or_error
8601>>>>>
8601>>>>>        Property Integer Verbose_State            True
8602>>>>>        Property Integer Current_Error_Number     0
8603>>>>>        Property Integer Error_Line_Number        0
8604>>>>>        
8604>>>>>        // If set false, this makes the error handler work the old way which
8604>>>>>        // does not use the new unhandled dialog. Only exists for compatibility reasons
8604>>>>>        Property Boolean pbUnhandledErrorSupport       True
8605>>>>>
8605>>>>>        // shows error numbers with user errors. Only set this true if your
8605>>>>>        // application has meaningful numbers that helps the end user. Note that
8605>>>>>        // unhandled errors always show numbers.
8605>>>>>        // this is ignored if pbUnhandledErrorSupport is false
8605>>>>>        Property Boolean pbShowErrorNumber        False
8606>>>>>        
8606>>>>>        
8606>>>>>        // This is the caption that appears for unhandled errors dialog box
8606>>>>>        Property String psUnhandledErrorCaption C_$UnhandledProgramError
8607>>>>>
8607>>>>>        // This is the caption that appears for standard user errors
8607>>>>>        Property String psUserErrorCaption C_$Error
8608>>>>>
8608>>>>>        // Flag which is sent when error is being processed. This
8608>>>>>        // stops error recursion.
8608>>>>>        Property Integer Error_Processing_State  False
8609>>>>>
8609>>>>>        // array of errors that we consider User Errors
8609>>>>>        Property Integer[] pUserErrorsArray
8610>>>>>
8610>>>>>        //  This allows us to skip find errors (GT & LT) and to only
8610>>>>>        //  ring a bell when these occur.
8610>>>>>        //
8610>>>>>        Property Integer Bell_on_Find_Error_State True
8611>>>>>        
8611>>>>>        Object TrappedErrors is a Trapped_Errors_Array
8613>>>>>            Send initArray
8614>>>>>        End_Object
8615>>>>>
8615>>>>>        Send Trap_All
8616>>>>>
8616>>>>>        // define the standard user error numbers
8616>>>>>        Send AddUserError 0
8617>>>>>        Send AddUserError DFERR_NUMBER_TOO_LARGE             
8618>>>>>        Send AddUserError DFERR_WINDOW_RANGE                 
8619>>>>>        Send AddUserError DFERR_ENTRY_REQUIRED               
8620>>>>>        Send AddUserError DFERR_ENTER_A_NUMBER               
8621>>>>>        Send AddUserError DFERR_BAD_ENTRY                    
8622>>>>>        Send AddUserError DFERR_ENTER_VALID_DATE             
8623>>>>>        Send AddUserError DFERR_NUMERIC_RANGE                
8624>>>>>        Send AddUserError DFERR_DUPLICATE_REC
8625>>>>>        Send AddUserError DFERR_TEXT_FIELD_TOO_LONG          
8626>>>>>        Send AddUserError DFERR_FIND_PRIOR_BEG_OF_FILE       
8627>>>>>        Send AddUserError DFERR_FIND_PAST_END_OF_FILE        
8628>>>>>        Send AddUserError DFERR_NO_REC_TO_DELETE
8629>>>>>        Send AddUserError DFERR_FIELD_NOT_INDEXED // can be invoked w/ find keys       
8630>>>>>        Send AddUserError DFERR_REC_NUMBER_RANGE             
8631>>>>>        Send AddUserError DFERR_ENTER_VALID_REC_ID           
8632>>>>>        Send AddUserError DFERR_OPERATOR_ERROR               
8633>>>>>        Send AddUserError DFERR_CANT_CHANGE_KEY_FIELD        
8634>>>>>        Send AddUserError DFERR_NO_DELETE_RELATED_RECORDS_EXIST
8635>>>>>        Send AddUserError DFERR_OPERATION_NOT_ALLOWED        
8636>>>>>        Send AddUserError DFERR_OPERATOR                     
8637>>>>>        Send AddUserError DFERR_XML_HTTP              
8638>>>>>        Send AddUserError DFERR_CLIENT_SOAP_TRANSFER  
8639>>>>>        Send AddUserError DFERR_CLIENT_SOAP_FAULT     
8640>>>>>        Send AddUserError DFERR_TEXT_TOO_LARGE_FOR_FIELD     
8641>>>>>        Send AddUserError DFERR_WINPRINT
8642>>>>>        Send AddUserError DFERR_CRYSTAL_REPORT
8643>>>>>        Send AddUserError DFERR_MAPI
8644>>>>>        Send AddUserError DFERR_FILE_ACCESS_VIOLATION
8645>>>>>        Send AddUserError DFERR_DATAFLEX_REPORTS
8646>>>>>        Send AddUserError DFERR_CANT_REFIND_RECORD
8647>>>>>        Send AddUserError 999 // This is defined as DD_DEFAULT_ERROR_NUMBER in DataDict.pkg and is the default Field_error
8648>>>>>                              // number of DDs. 
8648>>>>>        Move Self to Error_Object_Id
8649>>>>>    End_Procedure
8650>>>>>
8650>>>>>    Function Help_Context Integer Context_Type Returns String
8652>>>>>       Function_Return (Current_Error_Number(Self))
8653>>>>>    End_Function
8654>>>>>
8654>>>>>    //*** Catch and display error Error#.
8654>>>>>    Procedure Trap_Error Integer Error#
8656>>>>>        Send Trap_Error to ( trappedErrors( Self ) ) Error#
8657>>>>>    End_Procedure
8658>>>>>
8658>>>>>    //*** Pass error Error# on to the regular DataFlex error handler.
8658>>>>>    Procedure Ignore_Error Integer Error#
8660>>>>>        Send Ignore_Error to ( trappedErrors( Self ) ) Error#
8661>>>>>    End_Procedure
8662>>>>>
8662>>>>>    //*** Catch and display all errors.
8662>>>>>    Procedure Trap_All
8664>>>>>        Send Trap_All to ( trappedErrors( Self ) )
8665>>>>>    End_Procedure
8666>>>>>
8666>>>>>    //*** Forward all error to regular DataFlex error handler.
8666>>>>>    Procedure Ignore_All
8668>>>>>        Send Ignore_All to ( trappedErrors( Self ) )
8669>>>>>    End_Procedure
8670>>>>>
8670>>>>>    //*** Build complete error description from Flexerrs and user error message.
8670>>>>>    Function Error_Description Integer Error# String ErrMsg Returns String
8672>>>>>       String Full_Error_Text
8672>>>>>
8672>>>>>       trim ErrMsg to ErrMsg
8673>>>>>>
8673>>>>>       Move (trim(error_text(DESKTOP,Error#))) to Full_Error_Text
8674>>>>>
8674>>>>>       If (ErrMsg<>"") Begin
8676>>>>>
8676>>>>>         If ( ( Full_Error_Text<>"" ) and ;                 error_text_available( DESKTOP, Error# ) ) Begin
8678>>>>>             // Make sure last character of error text is a separating symbol.
8678>>>>>             // if not, add a "." So we have format of "error-text. error-detail"
8678>>>>>             If ( pos(right(Full_error_text,1),".,:;")=0 ) ;                 Move (Full_Error_Text - ".") to Full_Error_Text
8681>>>>>             Move (Full_Error_Text * ErrMsg) to Full_Error_Text
8682>>>>>        End
8682>>>>>>
8682>>>>>            Else ;             Move ErrMsg to Full_Error_Text
8684>>>>>
8684>>>>>          End
8684>>>>>>
8684>>>>>
8684>>>>>       Function_Return Full_Error_Text
8685>>>>>    End_Function
8686>>>>>
8686>>>>>    //** return true if an error number is critical
8686>>>>>    Function Is_Critical Integer Error# Returns Integer
8688>>>>>       Function_Return (".3.10.18.19.20.21.22.43.70.72.74.75.78.80.97.";             contains ("."+String(Error#)+"."))
8689>>>>>    End_Function
8690>>>>>    
8690>>>>>    // adds a user error to the array
8690>>>>>    Procedure AddUserError Integer iError
8692>>>>>        Integer[] UserErrors
8693>>>>>        Get pUserErrorsArray to UserErrors
8694>>>>>        // We assume that there are few enough user errors to worry about speed of finding
8694>>>>>        // the an array item. It always does a linear seach, which should be plenty fast.
8694>>>>>        If (SearchArray(iError,UserErrors)=-1) Begin
8696>>>>>            Move iError to UserErrors[SizeOfArray(UserErrors)]
8697>>>>>            Set pUserErrorsArray to UserErrors
8698>>>>>        End
8698>>>>>>
8698>>>>>    End_Procedure
8699>>>>>    
8699>>>>>    // removes an error from the user array
8699>>>>>    Procedure RemoveUserError Integer iError
8701>>>>>        Integer[] UserErrors
8702>>>>>        Integer iIndex iSize
8702>>>>>        Get pUserErrorsArray to UserErrors
8703>>>>>        Move (SearchArray(iError,UserErrors)) to iIndex
8704>>>>>        If (iIndex<>-1) Begin
8706>>>>>            // replace the removed error with the last error and resize the array
8706>>>>>            Move (SizeOfArray(UserErrors)) to iSize
8707>>>>>            Move UserErrors[iSize-1] to UserErrors[iIndex]
8708>>>>>            Set pUserErrorsArray to (ResizeArray(UserErrors,iSize-1))
8709>>>>>        End
8709>>>>>>
8709>>>>>    End_Procedure
8710>>>>>
8710>>>>>    // removes all user errors
8710>>>>>    Procedure RemoveAllUserErrors
8712>>>>>        Integer[] UserErrors
8713>>>>>        Set pUserErrorsArray to UserErrors
8714>>>>>    End_Procedure
8715>>>>>
8715>>>>>    // returns true if this is an unhandled error (i.e., not a user error
8715>>>>>    Function IsUnhandledError Integer iError Returns Boolean
8717>>>>>        Integer[] UserErrors
8718>>>>>        Get pUserErrorsArray to UserErrors
8719>>>>>        Function_Return (SearchArray(iError,UserErrors)=-1)
8720>>>>>    End_Function
8721>>>>>    
8721>>>>>    Procedure UnhandledErrorDisplay Integer iErrorLine String sMessage 
8723>>>>>        String sCaption sCRLF
8723>>>>>        Move (Character(13)+Character(10)) to sCRLF
8724>>>>>        Get psUnhandledErrorCaption to sCaption
8725>>>>>        Move (Replaces("\n",sMessage,sCRLF)) to sMessage
8726>>>>>        Move (Replaces("\"+sCRLF, sMessage, "\n")) to sMessage
8727>>>>>        ErrorDisplay iErrorLine sMessage sCaption C_$OK C_$Copy
8728>>>>>    End_Procedure
8729>>>>>
8729>>>>>    //*** Handle error event, displaying error info to user.
8729>>>>>    Procedure Error_Report Integer ErrNum Integer Err_Line String ErrMsg
8731>>>>>       Integer iReply iIcon
8731>>>>>       String  sErrorText sMess
8731>>>>>       String  sSource sCaption
8731>>>>>       Integer iSrcPos iSrc iTxtLen
8731>>>>>       Boolean bIsUnhandled bUnhandledSupport bCritical bVerbose
8731>>>>>       
8731>>>>>       If (Error_processing_State(Self)) Begin // don't allow error
8733>>>>>          Procedure_Return                     // recursion
8734>>>>>       End
8734>>>>>>
8734>>>>>
8734>>>>>       Set Error_Processing_State to True // we are now in an error reporting state
8735>>>>>
8735>>>>>       Set Current_Error_Number to ErrNum
8736>>>>>       Set Error_Line_Number    to Err_Line
8737>>>>>
8737>>>>>       // if this is false, this will work old-style -- all errors go through message box
8737>>>>>       Get pbUnhandledErrorSupport to bUnhandledSupport
8738>>>>>       
8738>>>>>       Get Is_Critical errnum to bCritical
8739>>>>>       Get IsUnhandledError ErrNum to bIsUnhandled
8740>>>>>
8740>>>>>       
8740>>>>>       //
8740>>>>>       //   Changes made so find errors don't report - just beep
8740>>>>>       //
8740>>>>>
8740>>>>>       If ( Bell_On_find_Error_State(Self) and ;            ErrNum=DFERR_FIND_PRIOR_BEG_OF_FILE or ErrNum=DFERR_FIND_PAST_END_OF_FILE) Begin
8742>>>>>          Send Bell
8743>>>>>       End
8743>>>>>>
8743>>>>>       Else If not ( isTrapped( TrappedErrors( Self ), ErrNum ) ) Begin
8746>>>>>          // if trapped do nothing
8746>>>>>
8746>>>>>          // We used to forward send. Since this is based on array, it does not understand this message, the forward was
8746>>>>>          // not understood. Since arrays don't delegate or error, nothing happened.
8746>>>>>          // An easier way to do nothing, is to do nothing, hence this line if removed
8746>>>>>          //forward send Error_Report ErrNum Err_Line ErrMsg
8746>>>>>       End
8746>>>>>>
8746>>>>>       Else Begin
8747>>>>>
8747>>>>>         // See if source information is provided (Source = module.function). If so remove
8747>>>>>         // as detail. Must find last instance of this in string
8747>>>>>         Move (pos(C_ErrorContextSourceText,ErrMsg)) to iSrc
8748>>>>>         If iSrc Begin
8750>>>>>            Move (iSrc-1) to iSrcPos
8751>>>>>            Move (length(C_ErrorContextSourceText)) to  iTxtLen
8752>>>>>            Move ErrMsg to sSource
8753>>>>>            Repeat // this makes sure we find last instance of this
8753>>>>>>
8753>>>>>                Move (remove(sSource, 1, iSrc-1 + iTxtLen )) to sSource // right part of string
8754>>>>>                Move (pos(C_ErrorContextSourceText,sSource)) to iSrc           // see if it was the last
8755>>>>>                If iSrc ;                                               // if not, track length                   Move (iSrcPos + iTxtLen + iSrc-1) to iSrcPos
8758>>>>>            Until (iSrc=0)
8760>>>>>            Move (trim(left(ErrMsg,iSrcPos))) to ErrMsg
8761>>>>>            If (right(ErrMsg,1)=',') ;               Move (left(ErrMsg,length(ErrMsg)-1)) to ErrMsg
8764>>>>>         End
8764>>>>>>
8764>>>>>         
8764>>>>>         // the caption normally used for handled user errors
8764>>>>>         Get psUserErrorCaption to sCaption
8765>>>>>         // if an operator error this may be a Procedure UserError situation where the
8765>>>>>         // caption is passed in the error text. If so, get the caption
8765>>>>>         If (ErrNum=DFERR_OPERATOR) Begin
8767>>>>>             Move (pos(C_ErrorCaption,ErrMsg)) to iSrc
8768>>>>>             If iSrc Begin
8770>>>>>                Move (length(C_ErrorCaption)) to  iTxtLen
8771>>>>>                Move (remove(ErrMsg, 1, iSrc-1 + iTxtLen )) to sCaption
8772>>>>>                Move (Left(ErrMsg,iSrc-1)) to ErrMsg
8773>>>>>             End
8773>>>>>>
8773>>>>>         End
8773>>>>>>
8773>>>>>
8773>>>>>         Get Error_Description ErrNum ErrMsg to sErrorText
8774>>>>>
8774>>>>>         // if the error source is identified we can get extended error
8774>>>>>         // text for our error message
8774>>>>>         If ghoErrorSource Begin
8776>>>>>            Get extended_error_Message of ghoErrorSource to sMess
8777>>>>>            If sMess ne '' ;               Move (sErrorText + "\n\n" + sMess ) to sErrorText
8780>>>>>         End
8780>>>>>>
8780>>>>>         
8780>>>>>         If (bUnhandledSupport) Begin
8782>>>>>             // as of 14.1, this is the preferred way to do errors
8782>>>>>             If ( bCritical or bIsUnhandled) Begin
8784>>>>>                 Move ( sErrorText + "\n\n" + C_$Error + ":" * String(ErrNum) ) to sErrorText
8785>>>>>                 If (sSource<>"") Begin
8787>>>>>                    Move (sErrorText + "\n" + C_$ErrorSource +" =" * sSource) to sErrorText
8788>>>>>                 End
8788>>>>>>
8788>>>>>             End
8788>>>>>>
8788>>>>>             Else If (pbShowErrorNumber(Self)) Begin
8791>>>>>                  // if a user error, we provide a way to see error numbers.
8791>>>>>                  Move ( sErrorText + "\n\n" + C_$Error + ":" * String(ErrNum) ) to sErrorText
8792>>>>>             End
8792>>>>>>
8792>>>>>         End
8792>>>>>>
8792>>>>>         Else Begin
8793>>>>>             // we get here if we want it to work the old (less good) way. This is provided
8793>>>>>             // only for backwards compatibility. All errors go through the message box
8793>>>>>             Get Verbose_State to bVerbose
8794>>>>>             If (bVerbose)  Begin
8796>>>>>                 Move ( sErrorText + "\n\n" + SFormat(C_$TechnicalDetails, ErrNum, Err_Line) ) to sErrorText
8797>>>>>                 If (sSource<>"") Begin
8799>>>>>                    Move (sErrorText + "\n" + C_$ErrorSource +" =" * sSource) to sErrorText
8800>>>>>                 End
8800>>>>>>
8800>>>>>             End
8800>>>>>>
8800>>>>>         End
8800>>>>>>
8800>>>>>         
8800>>>>>         If ( (bCritical or bIsUnhandled) and bUnhandledSupport) Begin
8802>>>>>             Send UnhandledErrorDisplay Err_Line sErrorText
8803>>>>>         End
8803>>>>>>
8803>>>>>         Else Begin
8804>>>>>             Move (If(bCritical,MB_IconHand,MB_IconExclamation)) to iIcon
8805>>>>>             Get Message_Box sErrorText sCaption MB_Ok iIcon to iReply
8806>>>>>         End
8806>>>>>>
8806>>>>>
8806>>>>>         // abort on critical errors
8806>>>>>         If bCritical Abort
8809>>>>>
8809>>>>>       End
8809>>>>>>
8809>>>>>       Move 0 to ghoErrorSource
8810>>>>>       Set Error_Processing_State to False // no longer reporting an error
8811>>>>>    End_Procedure
8812>>>>>
8812>>>>>
8812>>>>>    // JJT- Note if you are using the WINDAF windows help system
8812>>>>>    //      the following functions are not used.
8812>>>>>
8812>>>>>    // The functions below are used to construct a general help
8812>>>>>    // name for errors that are generated by the system.  If processing
8812>>>>>    // comes here, then there was no module specific help found.  These
8812>>>>>    // functions will provide a more general help name that appears in
8812>>>>>    // the form of SYSTEM..ERROR:#.  All global errors should be
8812>>>>>    // places in the help file under this application and module name.
8812>>>>>
8812>>>>>    //*** Returns "ERROR:errornum" to supply error help.
8812>>>>>    Function Help_Name Returns String
8814>>>>>       Function_Return (Append("ERROR:",lastErr))
8815>>>>>    End_Function
8816>>>>>
8816>>>>>    Function Application_Name Returns String
8818>>>>>       Function_Return 'SYSTEM'
8819>>>>>    End_Function
8820>>>>>
8820>>>>>    Function Module_Name Returns String
8822>>>>>       Function_Return ''
8823>>>>>    End_Function
8824>>>>>End_Class
8825>>>>>
8825>>>>>Object Error_Info_Object is a ErrorSystem
8827>>>>>End_Object
8828>>>>>
8828>>>>>
8828>>>>>Procedure UserError Global String sMessage String sCaption
8830>>>>>    String sCapt
8830>>>>>    If (Error_Object_Id=0) Begin
8832>>>>>        Error DFERR_PROGRAM "No Error Handler"
8833>>>>>>
8833>>>>>        Procedure_Return
8834>>>>>    End
8834>>>>>>
8834>>>>>    
8834>>>>>    // Accept not passing a caption in which case the error handler's
8834>>>>>    // default caption. It had been the intention to require a caption ("" if none)
8834>>>>>    // but having no caption kind of worked where the caption would be "0". Since it
8834>>>>>    // kind of worked, I don't want to remove this which might generate runtime errors.
8834>>>>>    If (num_arguments>1) Begin
8836>>>>>        Move sCaption to sCapt
8837>>>>>    End
8837>>>>>>
8837>>>>>    
8837>>>>>    Error DFERR_OPERATOR (sMessage + If(sCapt<>"",C_ErrorCaption + sCapt,""))
8838>>>>>>
8838>>>>>    
8838>>>>>End_Procedure
8839>>>Use tWinStructs.pkg
8839>>>
8839>>>Register_Function phoWorkspace Returns Handle
8839>>>Register_Function phoCommandLine Returns Handle
8839>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
8839>>>Register_Function GetApplicationName Returns String
8839>>>Register_Function GetApplicationFileName Returns String
8839>>>
8839>>>Register_Function Statusbar_State Returns Integer
8839>>>Register_Function Toolbar_State Returns Integer
8839>>>Register_Procedure Set Statusbar_State
8839>>>Register_Procedure Set Toolbar_State
8839>>>
8839>>>Class cApplication is a cObject
8840>>>    Procedure Construct_Object
8842>>>        Forward Send Construct_Object
8844>>>
8844>>>        Move self To ghoApplication
8845>>>
8845>>>        Property Handle phoVersionInfo
8846>>>        Property Handle phoWorkspace
8847>>>        Property Handle phoCommandLine
8848>>>        Property Handle phoMainPanel       // main panel will set this for us.
8849>>>        Property String psHelpFile         // type of file is determined by peHelpType
8850>>>        Property Integer peHelpType htWinHelp // htNoHelp htHtmlHelp htWinHelp
8851>>>
8851>>>        Property String psCompany "Data Access Worldwide"
8852>>>        Property String psProduct "DataFlex Applications"
8853>>>        Property String psVersion C_DFVersion
8854>>>        Property String psProgram (Module_Name(desktop))
8855>>>        
8855>>>        // set to '' to stop the auto open workspace behavior
8855>>>        Property String psAutoOpenWorkspace 'Config.ws' 
8856>>>
8856>>>
8856>>>        Property Boolean pbPreserveEnvironment True
8857>>>
8857>>>        Object oCommandLine is a cCommandLine
8859>>>            delegate Set phoCommandLine To self
8861>>>        End_Object
8862>>>
8862>>>        Object oWorkspace is a cWorkspace
8864>>>            delegate Set phoWorkspace To self
8866>>>        End_Object
8867>>>
8867>>>        Object oVersionInfo is a cVersionInfo
8869>>>            delegate Set phoVersionInfo To self
8871>>>            Send DoCreate (GetApplicationFileName(parent(self)))
8872>>>        End_Object
8873>>>        
8873>>>        Set pbUseWindowsFont to True
8874>>>
8874>>>    End_Procedure
8875>>>    
8875>>>    Procedure Destroy_Object
8877>>>        If (ghoApplication=Self) Begin
8879>>>            Move 0 to ghoApplication
8880>>>        End
8880>>>>
8880>>>        Forward Send Destroy_Object
8882>>>    End_Procedure
8883>>>
8883>>>    //************************************************************************************
8883>>>    // Get/Set pbEnterKeyAsTabKey
8883>>>    // Determines if the Enter key should act like the Tab key (and send msg_Next)
8883>>>    // The use of a global variable, gbKEnterNext, makes this an application-wide property
8883>>>    //************************************************************************************
8883>>>    Procedure Set pbEnterKeyAsTabKey Boolean bNext
8885>>>        Move bNext to gbKEnterNext
8886>>>    End_Procedure
8887>>>
8887>>>    Function pbEnterKeyAsTabKey Returns Boolean
8889>>>        Function_Return gbKEnterNext
8890>>>    End_Function
8891>>>
8891>>>    Procedure DoLoadEnvironment Handle hoContainer Boolean bProgram
8893>>>// not used with webapp
8893>>>        Handle hoRegistry hoCommandBars
8893>>>        Handle hMonitor
8893>>>        Integer iError cxy
8893>>>        tWinWindowPlacement WindowPlacement
8893>>>        tWinWindowPlacement WindowPlacement
8893>>>        String sKey
8893>>>        Boolean bSuccess
8893>>>        String sObjectName
8893>>>
8893>>>        If (pbPreserveEnvironment(self)) Begin
8895>>>            Get Create U_cRegistry To hoRegistry
8896>>>            Set pfAccessRights of hoRegistry To KEY_READ
8897>>>
8897>>>            Get RegistryKeyString To sKey
8898>>>
8898>>>            If (bProgram = False) Begin
8900>>>                Move (sKey +"\WINDOWS") To sKey
8901>>>                Get Object_Label of hoContainer To sObjectName  // just get the local name
8902>>>                Move (sKey +"\" +sObjectName) To sKey
8903>>>            End
8903>>>>
8903>>>            Else ;                Move (sKey + "\Preferences") To sKey
8905>>>
8905>>>            Get OpenKey of hoRegistry sKey To bSuccess
8906>>>
8906>>>            If bSuccess Begin
8908>>>                If (ValueExists(hoRegistry, 'Placement')) Begin
8910>>>                    Get ReadBinary of hoRegistry "Placement" (AddressOf(WindowPlacement)) (SizeOfType(tWinWindowPlacement)) to bSuccess
8911>>>                    If bSuccess Begin
8913>>>                        // Do not restore size if the window is not resizable
8913>>>                        If (Border_Style(hoContainer) <> BORDER_THICK) Begin
8915>>>                            // restore always works with outer size
8915>>>                            Get GuiWindowSize     of hoContainer to cxy
8916>>>                            Move (WindowPlacement.NormalPosition.left + Low(cxy)) to WindowPlacement.NormalPosition.right 
8917>>>                            Move (WindowPlacement.NormalPosition.top + Hi(cxy)) to WindowPlacement.NormalPosition.bottom
8918>>>                        End
8918>>>>
8918>>>                        
8918>>>                        // Test that the main window's placement location will appear on some connected monitor. If none
8918>>>                        // of the main window is visible then set the location to 0,0 and adjust the size....
8918>>>                        If (bProgram) Begin
8920>>>                            // Test the top left point
8920>>>                            Move (MonitorFromPoint(WindowPlacement.NormalPosition.left, WindowPlacement.NormalPosition.top, MONITOR_DEFAULTONNULL)) to hMonitor
8921>>>                            
8921>>>                            If (hMonitor = 0) Begin
8923>>>                                // test the bottom right point
8923>>>                                Move (MonitorFromPoint(WindowPlacement.NormalPosition.right, WindowPlacement.NormalPosition.bottom, MONITOR_DEFAULTONNULL)) to hMonitor
8924>>>                            End
8924>>>>
8924>>>                            
8924>>>                            // hMonitor = 0 means that the window location is not in any current monitor (probably the monitor layout has changed)
8924>>>                            // or that the window begins and ends outside all monitors (even though it may span across some monitor). We will adjust!
8924>>>                            If (hMonitor = 0) Begin   
8926>>>                                Send ResetWindowPos (&WindowPlacement.NormalPosition)
8927>>>                            End
8927>>>>
8927>>>                        End
8927>>>>
8927>>>
8927>>>                        // Set the placement
8927>>>                        Move (SetWindowPlacement(Window_Handle(hoContainer), AddressOf(WindowPlacement))) to bSuccess
8928>>>                    End
8928>>>>
8928>>>                End
8928>>>>
8928>>>                If bProgram Begin
8930>>>                    Get phoCommandBars of hoContainer to hoCommandBars
8931>>>                    If not hoCommandBars Begin
8933>>>                        If (ValueExists(hoRegistry, 'IsStatusBarVisible')) ;                            Set Statusbar_State of hoContainer to (ReadDword(hoRegistry, 'IsStatusBarVisible'))
8936>>>                        If (ValueExists(hoRegistry, 'IsToolBarVisible'))   ;                            Set Toolbar_State   of hoContainer to (ReadDword(hoRegistry, 'IsToolBarVisible'))
8939>>>                    End
8939>>>>
8939>>>                End
8939>>>>
8939>>>
8939>>>                Send CloseKey of hoRegistry
8940>>>            End
8940>>>>
8940>>>
8940>>>            Send Destroy of hoRegistry
8941>>>        End
8941>>>>
8941>>>    End_Procedure
8942>>>
8942>>>    Procedure DoSaveEnvironment Handle hoContainer Boolean bProgram
8944>>>// not used with webapp
8944>>>        Handle hoRegistry 
8944>>>        Integer iError
8944>>>        tWinWindowPlacement WindowPlacement
8944>>>        tWinWindowPlacement WindowPlacement
8944>>>        String sKey
8944>>>        Boolean bSuccess
8944>>>        Integer eShowCmd
8944>>>        String sObjectName
8944>>>
8944>>>        If (pbPreserveEnvironment(self)) Begin
8946>>>            Get Create U_cRegistry To hoRegistry
8947>>>            Get RegistryKeyString To sKey
8948>>>
8948>>>            If (bProgram = False) Begin
8950>>>                Move (sKey +"\WINDOWS") To sKey
8951>>>                Get Object_Label of hoContainer To sObjectName  // just get the local name
8952>>>                Move (sKey +"\" +sObjectName) To sKey
8953>>>            End
8953>>>>
8953>>>            Else ;                Move (sKey +"\Preferences") To sKey
8955>>>
8955>>>            Get CreateKey of hoRegistry sKey To iError
8956>>>            If (iError = 0) Begin
8958>>>                Move (SizeOfType(tWinWindowPlacement)) to WindowPlacement.length
8959>>>                Move (GetWindowPlacement(Window_Handle(hoContainer), AddressOf(WindowPlacement))) to bSuccess
8960>>>                If bSuccess Begin
8962>>>                    // if minimized, assume restored, as we don't want to restart minimized!
8962>>>                    If (WindowPlacement.showCmd = SW_SHOWMINIMIZED) Begin
8964>>>                        Move SW_SHOWNORMAL to WindowPlacement.showCmd
8965>>>                    End
8965>>>>
8965>>>                    Send WriteBinary of hoRegistry "Placement" (AddressOf(WindowPlacement)) WindowPlacement.length
8966>>>                End
8966>>>>
8966>>>
8966>>>                If bProgram Begin
8968>>>                    Send WriteDword of hoRegistry 'IsStatusBarVisible' (Statusbar_State(hoContainer))
8969>>>                    Send WriteDword of hoRegistry 'IsToolBarVisible'   (Toolbar_State(hoContainer))
8970>>>                End
8970>>>>
8970>>>
8970>>>
8970>>>                Send CloseKey of hoRegistry
8971>>>            End
8971>>>>
8971>>>
8971>>>            Send Destroy of hoRegistry
8972>>>        End
8972>>>>
8972>>>    End_Procedure
8973>>>    
8973>>>
8973>>>    Procedure ResetWindowPos tWinRect ByRef WindowPos
8975>>>        Integer ixySize ixSize iySize
8975>>>        Integer ixOffset iyOffset
8975>>>        
8975>>>        // first calculate the offset needed to move onto the main monitor at 0,0
8975>>>        Move (0 - WindowPos.left) to ixOffset
8976>>>        Move (0 - WindowPos.top) to iyOffset
8977>>>         
8977>>>        Move 0 to WindowPos.left
8978>>>        Move 0 to WindowPos.top
8979>>>        
8979>>>        Move (WindowPos.right + ixOffset) to WindowPos.right
8980>>>        Move (WindowPos.bottom + iyOffset) to WindowPos.bottom
8981>>>    
8981>>>        // also make sure that the size of the window is <= the size of the main monitor
8981>>>        Move (GUIScreen_Size(1)) to ixySize    // parameter of 1 means return "available" screen size
8982>>>        Move (low(ixySize))      to ixSize
8983>>>        Move (hi(ixySize))       to iySize
8984>>>        
8984>>>        Move (ixSize min WindowPos.right) to WindowPos.right
8985>>>        Move (iySize min WindowPos.bottom) to WindowPos.bottom
8986>>>    End_Procedure
8987>>>
8987>>>
8987>>>    Function RegistryKeyString Returns String
8989>>>        String sCompany sProduct sVersion sProgram
8989>>>
8989>>>        Get psCompany To sCompany
8990>>>        Get psProduct To sProduct
8991>>>        Get psVersion To sVersion
8992>>>        Get psProgram To sProgram
8993>>>
8993>>>        If (sCompany = "") Move "Data Access Worldwide" to sCompany
8996>>>        If (sProduct = "") Move "DataFlex Applications" to sProduct
8999>>>        If (sVersion = "") Move C_DFVersion             to sVersion
9002>>>        If (sProgram ="") Move (Module_Name(desktop))   to sProgram
9005>>>
9005>>>        Function_Return ("SOFTWARE\" +sCompany +"\" +sProduct +"\" +sVersion +"\" +sProgram)
9006>>>    End_Function
9007>>>
9007>>>    Procedure WriteString String sSubKey String sValueName String sValueData
9009>>>        String sKey
9009>>>        Handle hoRegistry
9009>>>        Integer iError
9009>>>
9009>>>        Get Create U_cRegistry To hoRegistry
9010>>>        Get RegistryKeyString To sKey
9011>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9014>>>        Get CreateKey of hoRegistry sKey To iError
9015>>>        If (iError = 0) Begin
9017>>>            Send WriteString of hoRegistry sValueName sValueData
9018>>>            Send CloseKey of hoRegistry
9019>>>        End
9019>>>>
9019>>>
9019>>>        Send Destroy of hoRegistry
9020>>>    End_Procedure
9021>>>    Procedure WriteDword String sSubKey String sValueName Dword dwValueData
9023>>>        String sKey
9023>>>        Handle hoRegistry
9023>>>        Integer iError
9023>>>
9023>>>        Get Create U_cRegistry To hoRegistry
9024>>>        Get RegistryKeyString To sKey
9025>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9028>>>        Get CreateKey of hoRegistry sKey To iError
9029>>>        If (iError = 0) Begin
9031>>>            Send WriteDword of hoRegistry sValueName dwValueData
9032>>>            Send CloseKey of hoRegistry
9033>>>        End
9033>>>>
9033>>>
9033>>>        Send Destroy of hoRegistry
9034>>>    End_Procedure
9035>>>    Procedure WriteBinary String sSubKey String sValueName Address aValueData Integer iDataLength
9037>>>        String sKey
9037>>>        Handle hoRegistry
9037>>>        Integer iError
9037>>>
9037>>>        Get Create U_cRegistry To hoRegistry
9038>>>        Get RegistryKeyString To sKey
9039>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9042>>>        Get CreateKey of hoRegistry sKey To iError
9043>>>        If (iError = 0) Begin
9045>>>            Send WriteBinary of hoRegistry sValueName aValueData iDataLength
9046>>>            Send CloseKey of hoRegistry
9047>>>        End
9047>>>>
9047>>>
9047>>>        Send Destroy of hoRegistry
9048>>>    End_Procedure
9049>>>
9049>>>    // returns true if both sub-key and value exists.
9049>>>    Function ValueExists string sSubKey string sValueName returns Boolean
9051>>>        String sKey
9051>>>        Handle hoRegistry
9051>>>        Boolean bOK
9051>>>        Get Create U_cRegistry To hoRegistry
9052>>>        Get RegistryKeyString To sKey
9053>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9056>>>        Get OpenKey of hoRegistry sKey To bOk
9057>>>        If (bOK) Begin
9059>>>           Move (ValueExists(hoRegistry, sValueName)) TO bOk
9060>>>           Send CloseKey of hoRegistry
9061>>>        End
9061>>>>
9061>>>        Send Destroy of hoRegistry
9062>>>        Function_Return bOk
9063>>>    End_Function
9064>>>
9064>>>    Function ReadString String sSubKey String sValueName string sDefault Returns String
9066>>>        String sKey sData
9066>>>        Handle hoRegistry
9066>>>        Boolean bOK
9066>>>
9066>>>        Move sDefault to sData
9067>>>        Get Create U_cRegistry To hoRegistry
9068>>>        Get RegistryKeyString To sKey
9069>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9072>>>        Get OpenKey of hoRegistry sKey To bOk
9073>>>        If (bOK) Begin
9075>>>            If (ValueExists(hoRegistry, sValueName)) ;                Get ReadString of hoRegistry sValueName To sData
9078>>>            Send CloseKey of hoRegistry
9079>>>        End
9079>>>>
9079>>>
9079>>>        Send Destroy of hoRegistry
9080>>>        Function_Return sData
9081>>>    End_Function
9082>>>
9082>>>    Function ReadDword String sSubKey String sValueName dword dwDefault Returns DWord
9084>>>        String sKey
9084>>>        DWord dwData
9084>>>        Handle hoRegistry
9084>>>        Boolean bOK
9084>>>
9084>>>        Move dwDefault to dwData
9085>>>        Get Create U_cRegistry To hoRegistry
9086>>>        Get RegistryKeyString To sKey
9087>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9090>>>        Get OpenKey of hoRegistry sKey To bOk
9091>>>        If bOK Begin
9093>>>            If (ValueExists(hoRegistry, sValueName)) ;                Get ReadDword of hoRegistry sValueName To dwData
9096>>>            Send CloseKey of hoRegistry
9097>>>        End
9097>>>>
9097>>>
9097>>>        Send Destroy of hoRegistry
9098>>>        Function_Return dwData
9099>>>    End_Function
9100>>>
9100>>>    Function ReadBinary String sSubKey String sValueName Address aValueData Integer iDataLength Returns Boolean
9102>>>        String sKey
9102>>>        Handle hoRegistry
9102>>>        Boolean bOK bSuccess
9102>>>
9102>>>        Get Create U_cRegistry To hoRegistry
9103>>>        Get RegistryKeyString To sKey
9104>>>        If (sSubKey <>"") Move (sKey +'\' +sSubKey) To sKey
9107>>>        Get OpenKey of hoRegistry sKey To bOk
9108>>>        If bOK Begin
9110>>>            Get ReadBinary of hoRegistry sValueName aValueData iDataLength To bSuccess
9111>>>            Send CloseKey of hoRegistry
9112>>>        End
9112>>>>
9112>>>
9112>>>        Send Destroy of hoRegistry
9113>>>        Function_Return bSuccess
9114>>>    End_Function
9115>>>
9115>>>    Procedure DoOpenWorkspace String sWorkspace
9117>>>        // Tries to open in this order:
9117>>>        // 1) if absolute path, use that; otherwise
9117>>>        // 2) try to open in the path of the EXE; otherwise
9117>>>        // 3) load it via the Registered list
9117>>>
9117>>>        Integer eOpened
9117>>>        String sError sWSFile
9117>>>        Handle hoWorkspace
9117>>>        Boolean bChangingWorkspace
9117>>>
9117>>>        // As soon as an open is attempted, the application's object psAutoOpenWorkspace property
9117>>>        // is cleared. This way any attempt to manually open a workspace during its construction,
9117>>>        // which includes OnCreate, will stop the object from attempting to automatically open the
9117>>>        // workspace. This was added to make psAutoOpenWorkspace compatible with older applications.
9117>>>        // Typically these application will open a workspace in OnCreate. If this happens we assume
9117>>>        // that there should be no automatic opening of a worskpace.  
9117>>>        Set psAutoOpenWorkspace to ""
9118>>>        
9118>>>        Get phoWorkspace to hoWorkspace
9119>>>        
9119>>>        Get pbWorkspaceOpened of hoWorkspace to bChangingWorkspace
9120>>>        If (bChangingWorkspace and ghoConnection) Begin
9122>>>            Send AutoDisconnect
9123>>>        End
9123>>>>
9123>>>
9123>>>        Get OpenWorkspaceFile of hoWorkspace sWorkspace To eOpened
9124>>>        If (eOpened = wsWorkspaceFileNotFound) Begin
9126>>>            If (IsRegistered(hoWorkspace, sWorkspace) =True) Begin
9128>>>                Get OpenWorkspace of hoWorkspace sWorkspace To eOpened
9129>>>            End
9129>>>>
9129>>>        End
9129>>>>
9129>>>        If (eOpened <> wsWorkspaceOpened) Begin
9131>>>            Get OpenWorkspaceErrorMessage of hoWorkspace eOpened To sError
9132>>>            Get psWorkspaceWSFile of hoWorkspace to sWSFile
9133>>>            Error DFERR_CAPPLICATION (SFormat(C_$TheProgramCannotRun, sWorkspace) + ":\n\n" + if(sWSFile<>"",sWSfile+"\n\n","") +sError)
9134>>>>
9134>>>            Abort
9135>>>>
9135>>>        End
9135>>>>
9135>>>        Else Begin
9136>>>            Send AutoConnect
9137>>>            Send OnWorkspaceOpened
9138>>>        End
9138>>>>
9138>>>    End_Procedure
9139>>>    
9139>>>    Procedure AutoConnect
9141>>>        If (ghoConnection) Begin
9143>>>            Send AutoConnect of ghoConnection
9144>>>        End
9144>>>>
9144>>>    End_Procedure
9145>>>
9145>>>    Procedure AutoDisconnect
9147>>>        If (ghoConnection) Begin
9149>>>            Send AutoDisconnect of ghoConnection
9150>>>        End
9150>>>>
9150>>>    End_Procedure
9151>>>    
9151>>>    // send after a workspace is successfully opened and connected
9151>>>    Procedure OnWorkspaceOpened
9153>>>    End_Procedure
9154>>>
9154>>>    Procedure OnCreate
9156>>>        // Event called when the Application object is ready to be used
9156>>>        // to open a Workspace, etc.
9156>>>    End_Procedure
9157>>>
9157>>>    Procedure End_Construct_Object
9159>>>        String sName
9159>>>        Forward Send End_Construct_Object
9161>>>        Send OnCreate
9162>>>        // note that psAutoOpenWorkspace will get cleared of OnCreate attempts to open a workspace
9162>>>        Get psAutoOpenWorkspace to sName
9163>>>        If (sName<>"") Begin
9165>>>            Send DoOpenWorkspace sName
9166>>>        end
9166>>>>
9166>>>    End_Procedure
9167>>>
9167>>>    Function GetApplicationFileName Returns String
9169>>>        // Returns the filename from Windows
9169>>>        Integer iNumChars
9169>>>        String sFilename
9169>>>
9169>>>        Move (Repeat(Character(0), 1024)) To sFileName
9170>>>        Move (GetModuleFileName(0, AddressOf(sFilename), 1024)) To iNumChars
9171>>>
9171>>>        Function_Return (CString(sFilename))
9172>>>    End_Function
9173>>>
9173>>>    Function GetApplicationPath Returns String
9175>>>        // Returns the path of the Application (no trailing "\")
9175>>>        String sApplicationFileName sPath
9175>>>        Boolean bRemoved
9175>>>
9175>>>        Get GetApplicationFileName  To sApplicationFileName
9176>>>        Move (PathRemoveFileSpec(AddressOf(sApplicationFileName))) To bRemoved
9177>>>        Move (CString(sApplicationFileName)) To sPath
9178>>>
9178>>>        If (Right(sPath, 1) ="\") Move (Left(sPath, Length(sPath) -1)) To sPath
9181>>>        Function_Return sPath
9182>>>    End_Function
9183>>>
9183>>>    Function GetApplicationName Returns String
9185>>>        // Returns the name of the Application (without its Path or Extension)
9185>>>        String sApplicationFileName sApplicationName
9185>>>        Boolean bRemoved
9185>>>        Integer iVoid
9185>>>
9185>>>        Get GetApplicationFileName To sApplicationFileName
9186>>>        Move (ExtractFileName(sApplicationFileName)) To sApplicationName
9187>>>        Move (PathRemoveExtension(AddressOf(sApplicationName))) To iVoid
9188>>>        Function_Return (CString(sApplicationName))
9189>>>    End_Function
9190>>>    
9190>>>    Function DFRootPath Returns String
9192>>>        String sRoot
9192>>>        Get_Profile_String "Defaults" "VDFRootDir" to sRoot
9195>>>        // Ensure it does not contain a trailing "\"
9195>>>        If (Right(sRoot,1) = "\") Begin
9197>>>            Move (Left(sRoot, Length(sRoot)-1)) to sRoot
9198>>>        End
9198>>>>
9198>>>        Function_Return sRoot  
9199>>>    End_Function
9200>>>    
9200>>>    Function DFBinPath Returns String
9202>>>        String sRoot
9202>>>        Get DFRootPath to sRoot
9203>>>        If (sRoot<>"") Begin
9205>>>            Move (sRoot+"\bin") to sRoot
9206>>>        End
9206>>>>
9206>>>        Else Begin
9207>>>            // if the root from the registry (vdfrootdir) is empty, we will assume that the
9207>>>            // bin path must be the same as the application path.
9207>>>            Get GetApplicationPath to sRoot
9208>>>        End
9208>>>>
9208>>>        Function_Return sRoot
9209>>>    End_Function
9210>>>    
9210>>>    // this just directs to the desktop property. If you are using an application object you are
9210>>>    // encouraged to set this here.
9210>>>    Procedure Set pbUseWindowsFont Boolean bUseWindowsFont
9212>>>        Set pbUseWindowsFont of Desktop to bUseWindowsFont
9213>>>    End_Procedure
9214>>>    
9214>>>    Function pbUseWindowsFont Returns Boolean
9216>>>        Boolean bUseWindowsFont
9216>>>        Get pbUseWindowsFont of Desktop to bUseWindowsFont
9217>>>        Function_Return bUseWindowsFont
9218>>>    End_Function
9219>>>
9219>>>End_Class
9220>>>
9220>Use Windows.pkg
9220>Use Help_ids.inc // Developer should provide this file of help context links.
Including file: Help_ids.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\Help_ids.inc)
9220>>>// Help_ids.inc
9220>>>//
9220>>>// Context ids. This uses help file Developer5.chm.
9220>>>//
9220>>>// This is a sample version. YOU must supply
9220>>>// the ID values
9220>>>
9220>>>//  Generic Context Ids
9220>>>//
9220>>>Define SQLConnectionsProgram for 0
9220>>>
9220>>>// It is expected that file-names ids will be the same as their
9220>>>// filenumber.
9220>>>
9220>>>
9220>>>//  View and selection-list specific context ids
9220>>>//
9220>>>//..........add view, object, selection-list ids here....
9220>//Use Std_Help.Pkg
9220>Use Dferror.pkg                 // Error handling class and object
9220>Use seq_chnl.pkg                // Sequential channel management
9220>Use Statpnl.pkg                 // StatusPanel class
Including file: Statpnl.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Statpnl.pkg)
9220>>>// StatPnl.pkg - creates the standard status_panel object.
9220>>>//
9220>>>//
9220>>>// This is the default Status Panel object used by any of the DataFlex classes that
9220>>>// invoke the standard status panel. The standard has always been that the package name
9220>>>// is StatPnl.pkg and the name of the object is Status_Panel. As of 12.0, there are major 
9220>>>// changes in the way the status panel operates The Sentinel based external status panel used in
9220>>>// prior revisions has been replace with status panel that is part of the application.
9220>>>// This should work much better and faster than the old sentinel based solution.
9220>>>// While the way this operates has changed, the interface has not and therefore this should work
9220>>>// with most applications.
9220>>>//
9220>>>// As of 12.0, we have added a global handle that contains the object ID of this status panel.
9220>>>// This variable ghoStatusPanel can be used in place of the object name Status_Panel. This provides
9220>>>// a cleaner more robust interface.
9220>>>//
9220>>>//
9220>>>// Compatibility Note:
9220>>>//
9220>>>// When used in the standard way, this change will require no changes. A developer will only need to
9220>>>// change their code if they've modified the sentinel program, which was a difficult thing to do.
9220>>>//
9220>>>// If for some reason you application will not work using this as a replacement for the old status
9220>>>// panel, you've probably done something special with the old status-panel. If you don't want to 
9220>>>// figure out how to use the new one and you want to continue using the old one you are going to need
9220>>>// to add some code to include the old status panel in your application. Add the following to your project (your src).
9220>>>// 
9220>>>// Use StatPnl.pkg    // Make sure you load the new status panel object first. this is not optional!
9220>>>// Use OldStatPnl.pkg // load the old status panel. Status_Panel is now this old object
9220>>>//
9220>>>// If you do this, you will lose access to the new status-panel via Status_Panel. However, you 
9220>>>// can still access the new object via the ghoStatusPanel handle. 
9220>>>//
9220>>>//
9220>>>// Creating your own Status Panel objects
9220>>>//
9220>>>// If a developer wishes to create a custom panel, they should use this package as their template.
9220>>>// This panel can be visually modeled and changed any way you wish. Just save your new custom panel
9220>>>// with a different file and object name and direct your status panel request to the new object.
9220>>>//
9220>>>// If the new panel changes the interface and updates objects that are not currently defined, you
9220>>>// want to make sure you send the message ProcessEvents after you've updated the object. This allows
9220>>>// the object to paint when inside of a tight loop. For example, if you wanted to add a progress
9220>>>// bar (cProgressBar) you would want to Send ProcessEvents after you update the progress bar.
9220>>>// e.g.
9220>>>//       Procedure UpdateStatusBar
9220>>>//           Send DoAdvance of oProgressBar
9220>>>//           Send ProcessEvents
9220>>>//       End_Procedure
9220>>>//
9220>>>// Of course, if you use the standard interfaces in status bar and your forward send these
9220>>>// messages this will be done for you.
9220>>>//
9220>>>// the standard Interface for status panels are:
9220>>>//
9220>>>// Send Initialize_StatusPanel - initializes values for caption, title & message
9220>>>// Send Start_StatusPanel      - start the status panel
9220>>>// Send Stop_StatusPanel       - stop the status panel
9220>>>// Send Update_StatusPanel     - update the status panel's action area
9220>>>// Get  Check_StatusPanel      - check for cancel (if cancel or pbCancel is set, close the panel)
9220>>>//
9220>>>// Get/Set Caption_Text - updates the caption bar
9220>>>// Get/Set Title_Text   - updates the title area
9220>>>// Get/Set Message_Text - updates the Message area
9220>>>// Get/Set Action_Text  - updates the action area
9220>>>// Get/Set Button_Text  - updates the button area
9220>>>//
9220>>>// Get/Set Allow_cancel_state - determines if panel can be canceled
9220>>>// Send EnableCancelButton - code you should provide to enable/disable cancel button
9220>>>//
9220>>>// ghoStatusPanel - global handle that points to the standard status panel.
9220>>>
9220>>>Use cProcessStatusPanel.pkg
Including file: cProcessStatusPanel.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cProcessStatusPanel.pkg)
9220>>>>>// cProcessStatusPanel.pkg
9220>>>>>//
9220>>>>>// Class used to create StatusPanels.
9220>>>>>//
9220>>>>>// This class does not provide any of the inner objects that make up a status panel. Instead an
9220>>>>>// interface is provided that is used to update the various areas of status panel. At this level,
9220>>>>>// those areas (title area, message area, action area, button area) are logical. You create the
9220>>>>>// physical objects at the object level and then bind these objects to the interface.
9220>>>>>// Take a look at StatPnl.pkg to see how this is used.
9220>>>>>//
9220>>>>>// the standard Interface for status panels are:
9220>>>>>//
9220>>>>>// Send Initialize_StatusPanel - initializes values for caption, title & message
9220>>>>>// Send Start_StatusPanel      - start the status panel
9220>>>>>// Send Stop_StatusPanel       - stop the status panel
9220>>>>>// Send Update_StatusPanel     - update the status panel's action area
9220>>>>>// Get  Check_StatusPanel      - check for cancel (if cancel or pbCancel is set, close the panel)
9220>>>>>//
9220>>>>>// Get/Set Caption_Text - updates the caption bar
9220>>>>>// Get/Set Title_Text   - updates the title area
9220>>>>>// Get/Set Message_Text - updates the Message area
9220>>>>>// Get/Set Action_Text  - updates the action area
9220>>>>>// Get/Set Button_Text  - updates the button area
9220>>>>>//
9220>>>>>// Get/Set Allow_cancel_state - determines if panel can be canceled
9220>>>>>// Send EnableCancelButton - code must be provided in the cancel button object to enable/disable cancel button
9220>>>>>//
9220>>>>>
9220>>>>>Use cStatusPanel.pkg
Including file: cStatusPanel.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cStatusPanel.pkg)
9220>>>>>>>// cStausPanel.pkg
9220>>>>>>>
9220>>>>>>>// This is an abstract class that can be used to create status panels. The interface at this level
9220>>>>>>>// is very simple. You can start, stop, request a cancel and allow the object to paint.
9220>>>>>>>//
9220>>>>>>>// Interface:
9220>>>>>>>//
9220>>>>>>>//    Get/Set pbCancel - set true if you want to request a cancel.
9220>>>>>>>//    Send Activate - activate the panel
9220>>>>>>>//    Send Deactivate - deactivate the panel
9220>>>>>>>//    Send ProcessEvents - allows panel to paint in a tight loop
9220>>>>>>>//    Send Close_panel - sets pbCancel, indicating that you'd like to cancel the panel.
9220>>>>>>>//
9220>>>>>>>// Look at cProcessStatusPanel.pkg to see how this is used.  
9220>>>>>>>
9220>>>>>>>use Windows.pkg
9220>>>>>>>
9220>>>>>>>
9220>>>>>>>
9220>>>>>>>
9220>>>>>>>Class cStatusPanel is a FloatingPanel
9221>>>>>>>
9221>>>>>>>    Procedure Construct_Object
9223>>>>>>>        Forward Send Construct_object
9225>>>>>>>
9225>>>>>>>        Property boolean pbCancel False
9226>>>>>>>
9226>>>>>>>        Set Extended_Window_Style To WS_EX_DLGMODALFRAME True // kills sysmenu as long as there is no icon
9227>>>>>>>        Set Icon to '' // this must be cleared so there will be no icon
9228>>>>>>>        Set locate_mode to CENTER_ON_PANEL
9229>>>>>>>        Set Border_Style  to Border_Dialog
9230>>>>>>>        // should be scoped so it will not try to change the focus if there is no focusable button inside
9230>>>>>>>        Set Scope_State to True
9231>>>>>>>
9231>>>>>>>        On_key KEXIT_APPLICATION Send Close_Panel
9232>>>>>>>    end_procedure
9233>>>>>>>
9233>>>>>>>   // this is private and required. Never send this. 
9233>>>>>>>   Procedure Deactivate_Group
9235>>>>>>>       If (Active_State(self)) begin
9237>>>>>>>           Send SuspendGUI of Desktop False
9238>>>>>>>       end
9238>>>>>>>>
9238>>>>>>>       Forward Send Deactivate_Group
9240>>>>>>>   End_procedure
9241>>>>>>>
9241>>>>>>>    // Send this message to stop the panel
9241>>>>>>>    Procedure Deactivate
9243>>>>>>>       If (Active_State(self)) begin
9245>>>>>>>           Send SuspendGUI of Desktop False
9246>>>>>>>       end
9246>>>>>>>>
9246>>>>>>>       Forward Send Deactivate
9248>>>>>>>    End_procedure
9249>>>>>>>
9249>>>>>>>    // Send this message to start the panel
9249>>>>>>>    Procedure Activate
9251>>>>>>>       If not (Active_State(self)) begin
9253>>>>>>>          Set pbCancel to False
9254>>>>>>>          Send SuspendGUI of Desktop True
9255>>>>>>>       end
9255>>>>>>>>
9255>>>>>>>       Forward send Activate
9257>>>>>>>    End_procedure
9258>>>>>>>
9258>>>>>>>    // This allows the panel to paint when used in a tight loop, which is what status panels are
9258>>>>>>>    // used for. Any time you update the panel or wish to check for a cancel, you should call this.
9258>>>>>>>    Procedure ProcessEvents
9260>>>>>>>       If (Active_State(self)) begin
9262>>>>>>>           Send PumpMsgQueue of Desktop
9263>>>>>>>       end
9263>>>>>>>>
9263>>>>>>>    End_Procedure
9264>>>>>>>
9264>>>>>>>    // note close panel does not actually close the panel. It just sets pbCancel to True, informing the
9264>>>>>>>    // process using this that it wants to close. It is then up the process close the panel. 
9264>>>>>>>    Procedure Close_Panel
9266>>>>>>>        set pbCancel to True
9267>>>>>>>    End_procedure
9268>>>>>>>
9268>>>>>>>End_Class
9269>>>>>
9269>>>>>
9269>>>>>
9269>>>>>Class cProcessStatusPanel is a cStatusPanel
9270>>>>>
9270>>>>>    Procedure Construct_Object
9272>>>>>        Forward Send Construct_object
9274>>>>>        // determines if panel can be canceled
9274>>>>>        Property boolean Allow_Cancel_State True
9275>>>>>    End_procedure
9276>>>>>
9276>>>>>    // Any of the properties that change the text of a status panel must also send
9276>>>>>    // ProcessEvents which allows the panel to process painting messages. The ProcessEvents
9276>>>>>    // is essential when using status panels within a tight loop
9276>>>>>
9276>>>>>    Procedure Set Caption_text string sText
9278>>>>>        Set Label to sText
9279>>>>>        Send ProcessEvents
9280>>>>>    End_Procedure
9281>>>>>
9281>>>>>    Function Caption_Text returns string
9283>>>>>        Function_Return (Label(self))
9284>>>>>    End_Function
9285>>>>>
9285>>>>>    Procedure Set Message_Text String sText
9287>>>>>        Send ProcessEvents
9288>>>>>    End_Procedure
9289>>>>>
9289>>>>>    Function Message_Text returns string
9291>>>>>    End_Function
9292>>>>>
9292>>>>>    Procedure Set Action_Text String sText
9294>>>>>        Send ProcessEvents
9295>>>>>    End_Procedure
9296>>>>>
9296>>>>>    Function Action_Text returns string
9298>>>>>    End_Function
9299>>>>>
9299>>>>>    Procedure Set Button_Text String sText
9301>>>>>        Send ProcessEvents
9302>>>>>    End_Procedure
9303>>>>>
9303>>>>>    Function Button_Text returns string
9305>>>>>    End_Function
9306>>>>>
9306>>>>>    Procedure Set Title_Text String sText
9308>>>>>        Send ProcessEvents
9309>>>>>    End_Procedure
9310>>>>>
9310>>>>>    Function Title_Text returns string
9312>>>>>    End_Function
9313>>>>>
9313>>>>>    // initializes values for caption, title & message
9313>>>>>    Procedure Initialize_StatusPanel String sCaption String sTitle string sMessage
9315>>>>>        Set Caption_text to sCaption
9316>>>>>        Set Title_Text   to sTitle
9317>>>>>        Set Message_Text to sMessage
9318>>>>>    End_Procedure
9319>>>>>
9319>>>>>    // update the status panel's action area
9319>>>>>    Procedure Update_StatusPanel String sAction
9321>>>>>        Set Action_Text to sAction
9322>>>>>    End_Procedure
9323>>>>>
9323>>>>>    // stop the status panel
9323>>>>>    Procedure Close_Panel
9325>>>>>        If (Allow_cancel_state(self)) begin
9327>>>>>            Forward Send Close_Panel
9329>>>>>        end
9329>>>>>>
9329>>>>>    End_procedure
9330>>>>>
9330>>>>>    // Code must be provided in the cancel button object to enable/disable cancel button
9330>>>>>    Procedure EnableCancelButton boolean bEnable
9332>>>>>    End_procedure
9333>>>>>
9333>>>>>    // check for cancel (if cancel or pbCancel is set, close the panel)
9333>>>>>    Function Check_StatusPanel returns integer
9335>>>>>        Boolean bCancel
9335>>>>>        If (Active_state(self)) Begin
9337>>>>>            Send ProcessEvents
9338>>>>>            Get pbCancel to bCancel
9339>>>>>            If bCancel begin
9341>>>>>                Send Stop_StatusPanel // the old status panel removed this when canceled.
9342>>>>>            end
9342>>>>>>
9342>>>>>        end
9342>>>>>>
9342>>>>>        Function_Return (If(bCancel, MSG_CANCEL, 0)) // the old check status panel returns msg_cancel
9343>>>>>    End_Function
9344>>>>>
9344>>>>>    // start the status panel
9344>>>>>    Procedure Start_StatusPanel
9346>>>>>        If Not (Active_state(self)) Begin
9348>>>>>            Send EnableCancelButton (Allow_cancel_state(self))
9349>>>>>            Send Activate
9350>>>>>        End
9350>>>>>>
9350>>>>>    End_Procedure
9351>>>>>
9351>>>>>    // stop the status panel
9351>>>>>    Procedure Stop_StatusPanel
9353>>>>>        If (Active_state(self)) Begin
9355>>>>>            Send Deactivate
9356>>>>>        End
9356>>>>>>
9356>>>>>    End_Procedure
9357>>>>>
9357>>>>>End_Class
9358>>>>>
9358>>>
9358>>>
9358>>>Global_Variable Handle ghoStatusPanel // will contain the ID of the global StatusPanel object
9358>>>
9358>>>
9358>>>Object Status_Panel is a cProcessStatusPanel
9360>>>
9360>>>    Move Self to ghoStatusPanel // this can be used throughout your applicaton to access this object
9361>>>    
9361>>>    Set Size to 80 166
9362>>>
9362>>>    object oTitleTxt is a TextBox
9364>>>        set location to 10 10
9365>>>        Set Auto_Size_State to False
9366>>>        Set size to 20 150
9367>>>        Set Justification_Mode to JMode_Center
9368>>>    end_object
9369>>>
9369>>>    object oMessageTxt is a TextBox
9371>>>        set location to 25 10
9372>>>        Set Auto_Size_State to False
9373>>>        Set size to 20 150
9374>>>    end_object
9375>>>
9375>>>    object oActionTxt is a TextBox
9377>>>        set location to 45 10
9378>>>    end_object
9379>>>
9379>>>    object oStopButton is a Button
9381>>>        Set Location to 60 58
9382>>>        Set Label to C_$Cancel
9383>>>        
9383>>>        procedure OnClick
9386>>>            send Close_panel
9387>>>        end_procedure
9388>>>    
9388>>>    end_object
9389>>>
9389>>>    // These messages bind the standard cProcessStatusPanel interface to the actual
9389>>>    // objects defined within this instance of the status panel.
9389>>>    
9389>>>    // note: all of the messages that change text should be forwarded
9389>>>    // as the forwarded messages allows the panel to paint when in a tight loop
9389>>>
9389>>>    Procedure Set Message_Text string sText
9392>>>        Set Label of oMessageTxt to sText
9393>>>        Forward Set Message_Text to sText
9395>>>    End_Procedure
9396>>>    
9396>>>    Function Message_Text returns string
9399>>>        Function_Return (Label(oMessageTxt))
9400>>>    End_Function
9401>>>    
9401>>>    Procedure Set Action_Text string sText
9404>>>        Set Label of oActionTxt to sText
9405>>>        Forward Set Action_Text to sText
9407>>>    End_Procedure
9408>>>    
9408>>>    Function Action_Text returns string
9411>>>        Function_Return (Label(oActionTxt))
9412>>>    End_Function
9413>>>    
9413>>>    Procedure Set Button_Text string sText
9416>>>        Set Label of oStopButton to sText
9417>>>        Forward Set Button_Text to sText
9419>>>    End_Procedure
9420>>>    
9420>>>    Function Button_Text returns string
9423>>>        Function_Return (Label(oStopButton))
9424>>>    End_Function
9425>>>    
9425>>>    Procedure Set Title_Text string sText
9428>>>        Set Label of oTitleTxt to sText
9429>>>        Forward Set Title_Text to sText
9431>>>    End_Procedure
9432>>>    
9432>>>    Function Title_Text returns string
9435>>>        Function_Return (Label(oTitleTxt))
9436>>>    End_Function
9437>>>
9437>>>    // gets called when status panel is activated passing whether a button
9437>>>    // should appear
9437>>>    Procedure EnableCancelButton boolean bEnable
9440>>>        Set Enabled_State of oStopButton to bEnable
9441>>>    end_procedure
9442>>>   
9442>>>End_Object
9443>Use File_dlg.pkg                // SaveAsDialog & OpenDialog class
Including file: File_dlg.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\File_dlg.pkg)
9443>>>//************************************************************************
9443>>>//
9443>>>// Confidential Trade Secret.
9443>>>// Copyright 1987-1997 Data Access Corporation, Miami FL, USA
9443>>>// All Rights reserved
9443>>>// DataFlex is a registered trademark of Data Access Corporation.
9443>>>//
9443>>>//****************************************************************************
9443>>>//                                          
9443>>>// $File name  : File_dlg.pkg               
9443>>>// $File title : Common file dialog classes 
9443>>>// Notice      :                            
9443>>>// $Author(s)  : Stuart Booth               
9443>>>//                                          
9443>>>// $Rev History                             
9443>>>//
9443>>>// JvH - 28 Jan 08 - Modified to support multi-file selection in the open file dialog.                                          
9443>>>// JT 10/22/97   Added OEM/ANSI changes.    
9443>>>// SB ??/??/??   File created               
9443>>>//****************************************************************************
9443>>>
9443>>>use Windows.pkg
9443>>>Use GlobalFunctionsProcedures.pkg
9443>>>
9443>>>External_Function GetOpenFileName "GetOpenFileNameA" Comdlg32.DLL Pointer OpenStruct Returns Integer
9444>>>External_Function GetSaveFileName "GetSaveFileNameA" Comdlg32.DLL Pointer OpenStruct Returns Integer
9445>>>
9445>>>Struct TOpenFileName
9445>>>    DWord    lStructSize          // length, in bytes, of the structure.       
9445>>>    Handle   hwndOwner            // Handle to the window that owns the dialog box. 
9445>>>    Handle   hInstance            // handle to a memory object containing a dialog box template.
9445>>>    Pointer  lpstrFilter          // pointer to a buffer containing pairs of null-terminated filter strings.
9445>>>    Pointer  lpstrCustomFilter    // Pointer to a static buffer that contains a pair of null-terminated filter strings for preserving the filter pattern chosen by the user.
9445>>>    DWord    nMaxCustFilter       // size, in chars, of the buffer identified by lpstrCustomFilter. 
9445>>>    DWord    nFilterIndex         // index of the currently selected filter
9445>>>    Pointer  lpstrFile            // Pointer to a buffer that contains the file name(s)
9445>>>    DWord    nMaxFile             // Size, in CHARs, of the buffer pointed to by lpstrFile.
9445>>>    Pointer  lpstrFileTitle       // Pointer to a buffer that receives the file name and extension
9445>>>    DWord    nMaxFileTitle        // size, in CHARs, of the buffer pointed to by lpstrFileTitle
9445>>>    Pointer  lpstrInitialDir      // Pointer to a NULL terminated string that can specify the initial directory.
9445>>>    Pointer  lpstrTitle           // Pointer to a string to be placed in the title bar of the dialog box.
9445>>>    DWord    ofnFlags             // set of bit flags you can use to initialize the dialog box. 
9445>>>    Short    nFileOffset          // Specifies the zero-based offset, in TCHARs, from the beginning of the path to the file name in the string pointed to by lpstrFile.          
9445>>>    Short    nFileExtension       // Specifies the zero-based offset, in TCHARs, from the beginning of the path to the file name extension in the string pointed to by lpstrFile.
9445>>>    Pointer  lpstrDefExt          // Pointer to a buffer that contains the default extension.
9445>>>    DWord    lCustData            // Specifies application-defined data that the system passes to the hook procedure identified by the lpfnHook member.
9445>>>    Pointer  lpfnHook             // Pointer to a hook procedure.
9445>>>    Pointer  lpTemplateName       // Pointer to a null-terminated string that names a dialog template resource in the module identified by the hInstance member.
9445>>>End_Struct
9445>>>
9445>>>
9445>>>Class AbstractFileDialog is a cObject
9446>>>
9446>>>    Procedure Construct_Object
9448>>>        Forward Send Construct_Object
9450>>>
9450>>>        Property string  Filter_String
9451>>>        Property string  Initial_Folder
9452>>>        Property string  File_Name
9453>>>        Property string  File_Title
9454>>>        Property String  Dialog_Caption
9455>>>        Property Integer Filter_Index          1
9456>>>        Property Integer HideReadOnly_State    False
9457>>>        Property Integer TickReadOnly_State    False
9458>>>        Property Integer AllowReadOnly_State   True
9459>>>        Property Integer FileMustExist_State   True
9460>>>        Property Integer PathMustExist_State   True
9461>>>        Property Integer CreatePrompt_State    True
9462>>>        Property Integer ShowFileTitle_State   False
9463>>>        Property Integer OverwritePrompt_State False
9464>>>        Property Integer NoChangeDir_State     False
9465>>>
9465>>>        Property Boolean Private_MultiSelect_State False
9466>>>
9466>>>        Property String[] Private_Selected_Files
9467>>>
9467>>>        Property Integer PrivateExternal_msg
9468>>>
9468>>>        //Set Focus_Mode To No_Activate
9468>>>    End_Procedure
9469>>>
9469>>>    Function OwnerHandle returns handle
9471>>>        Handle hWnd
9471>>>        Handle hoObj
9471>>>        Get Focus of desktop to hoObj // start with the focus
9472>>>        Move (gOwnerWindowHandle(hoObj)) to hWnd // global function finds the right handle for us
9473>>>        function_return hWnd
9474>>>    End_Function
9475>>>
9475>>>
9475>>>    Function Show_Dialog Returns Integer // bool
9477>>>        Handle hWnd
9477>>>        Integer bOK iFilter iFlags bHideRO bTickRO bFileExist bPathExist iMsg
9477>>>        Integer icInitDir bCreatePrompt bOverwritePrompt bAllowReadOnly
9477>>>        Integer iPos iCount
9477>>>        Integer bNoChangeDir
9477>>>        Pointer lpsFileTitle lpsFileName lpsFilter lpsInitDir
9477>>>        Pointer lpsTitle lpsDefExt
9477>>>        String sFileName sFileTitle sFilter sInitDir sTitle sDefExt
9477>>>        Pointer pVoid lpOpenFileData
9477>>>        Boolean bMultiSelect
9477>>>        String[] sFiles
9478>>>        TOpenFileName OpenFileData
9478>>>        TOpenFileName OpenFileData
9478>>>
9478>>>        //Delegate Get Container_Handle To hWnd
9478>>>        Get OwnerHandle to hWnd
9479>>>
9479>>>        If (ShowFileTitle_State(Self)) Begin
9481>>>            Get File_Title to sFileName
9482>>>        End
9482>>>>
9482>>>        
9482>>>        Get private_MultiSelect_State to bMultiSelect
9483>>>            
9483>>>        Get Initial_Folder        to sInitDir
9484>>>        Get Dialog_Caption        to sTitle
9485>>>        Get Filter_String         to sFilter
9486>>>        Get HideReadOnly_State    to bHideRO
9487>>>        Get TickReadOnly_State    to bTickRO
9488>>>        Get FileMustExist_State   to bFileExist
9489>>>        Get PathMustExist_State   to bPathExist
9490>>>        Get CreatePrompt_State    to bCreatePrompt
9491>>>        Get OverwritePrompt_State to bOverwritePrompt
9492>>>        Get AllowReadOnly_State   to bAllowReadOnly
9493>>>        Get NoChangeDir_State     to bNoChangeDir
9494>>>        Get Filter_Index          to iFilter
9495>>>        
9495>>>        Move (sFilter + Character(0) + Character(0)) to sFilter
9496>>>        Move (AddressOf(sFilter)) to lpsFilter
9497>>>        Move (OemToAnsi(lpsFilter, lpsFilter)) to pVoid
9498>>>        Move (Replaces('|', sFilter, Character(0))) to sFilter
9499>>>
9499>>>        Append sInitDir   (character(0))
9500>>>        Append sFileTitle (Repeat(character(0),32000))
9501>>>        Append sFileName  (Repeat(character(0),32000))
9502>>>        Append sTitle     (Repeat(character(0),255))
9503>>>        Append sDefExt    (character(0))
9504>>>
9504>>>        Move (AddressOf(sInitDir))   to lpsInitDir
9505>>>        Move (AddressOf(sFileName))  to lpsFileName
9506>>>        Move (AddressOf(sFileTitle)) to lpsFileTitle
9507>>>        Move (AddressOf(sTitle))     to lpsTitle
9508>>>        Move (AddressOf(sDefExt))    to lpsDefExt
9509>>>        Move (AddressOf(sFilter))    to lpsFilter
9510>>>
9510>>>        Move (OemToAnsi(lpsInitDir, lpsInitDir)) to pVoid
9511>>>        Move (OemToAnsi(lpsFileName, lpsFileName)) to pVoid
9512>>>        Move (OemToAnsi(lpsTitle, lpsTitle)) to pVoid
9513>>>
9513>>>        If (bMultiSelect) Begin
9515>>>            Move (OFN_EXPLORER + OFN_ALLOWMULTISELECT) to iFlags  // Multi-select!
9516>>>        End
9516>>>>
9516>>>        
9516>>>        If bFileExist           Move (iFlags + OFN_FILEMUSTEXIST)    to iFlags
9519>>>        If bPathExist           Move (iFlags + OFN_PATHMUSTEXIST)    to iFlags
9522>>>        If bHideRO              Move (iFlags + OFN_HIDEREADONLY)     to iFlags
9525>>>        If bTickRO              Move (iFlags + OFN_READONLY)         to iFlags
9528>>>        If bCreatePrompt        Move (iFlags + OFN_CREATEPROMPT)     to iFlags
9531>>>        If bOverwritePrompt     Move (iFlags + OFN_OVERWRITEPROMPT)  to iFlags
9534>>>        If not bAllowReadOnly   Move (iFlags + OFN_NOREADONLYRETURN) to iFlags
9537>>>        If bNoChangeDir         Move (iFlags + OFN_NOCHANGEDIR)      to iFlags
9540>>>
9540>>>        Move (SizeOfType(TOpenFileName)) to OpenFileData.lStructSize
9541>>>        Move hWnd         to OpenFileData.hWndOwner
9542>>>        Move iFilter      to OpenFileData.nFilterIndex
9543>>>        Move lpsFileName  to OpenFileData.lpstrFile
9544>>>
9544>>>        If (sInitDir <> '') Begin
9546>>>            Move lpsInitDir    to OpenFileData.lpstrInitialDir
9547>>>        End
9547>>>>
9547>>>
9547>>>        If (sTitle <> '') Begin
9549>>>            Move lpsTitle      to OpenFileData.lpstrTitle
9550>>>        End
9550>>>>
9550>>>
9550>>>        Move 32000             to OpenFileData.nMaxFileTitle
9551>>>        Move 32000             to OpenFileData.nMaxFile
9552>>>        Move lpsFileTitle      to OpenFileData.lpstrFileTitle
9553>>>        Move iFlags            to OpenFileData.ofnFlags
9554>>>        Move lpsFilter         to OpenFileData.lpstrFilter
9555>>>        Move lpsDefExt         to OpenFileData.lpstrDefExt
9556>>>
9556>>>        Move (AddressOf(OpenFileData)) to lpOpenFileData
9557>>>
9557>>>        Get PrivateExternal_msg to iMsg
9558>>>        If (iMsg = Get_GetOpenFileName) Move (GetOpenFileName(lpOpenFileData)) to bOK
9561>>>        If (iMsg = Get_GetSaveFileName) Move (GetSaveFileName(lpOpenFileData)) to bOK
9564>>>
9564>>>        If bOK Begin
9566>>>            Move OpenFileData.ofnFlags     to iFlags
9567>>>            Move OpenFileData.nFilterIndex to iFilter
9568>>>            Move OpenFileData.nFileOffset  to icInitDir
9569>>>
9569>>>            Move (CString(Left(sFileName, icInitDir))) to sInitDir    // Trim trailing null
9570>>>            Set Initial_Folder     to (ToOEM(sInitDir))
9571>>>
9571>>>            Set TickReadOnly_State to (iFlags iand OFN_READONLY)
9572>>>            Set Filter_Index       to iFilter
9573>>>            // Note that ToOEM only converts up to first null
9573>>>            Set File_Name          to (CString(ToOEM( sFileName )))
9574>>>            Set File_Title         to (CString(ToOEM( sFileTitle )))
9575>>>
9575>>>            If (bMultiSelect) Begin
9577>>>                // If this is a multi-files dialog then parse out the array of selected files....
9577>>>                If (Right(sInitDir, 1) = "\") Move (Left(sInitDir, Length(sInitDir)-1)) to sInitDir     // Trim trailing :\". This is only there if 1 file was selected!
9580>>>            
9580>>>                // Get the null delimited string of file names into the sFiles array....
9580>>>                Move 0 to iCount
9581>>>                Move (Right(sFileName, Length(sFileName) - icInitDir)) to sFileName    // Strip the path info (we already have it)
9582>>>                
9582>>>                Repeat
9582>>>>
9582>>>                    // Get the next filename....
9582>>>                    Move (Pos(Character(0), sFileName)) to iPos   // Filenames are null delimeted
9583>>>                    
9583>>>                    If (iPos > 1) Begin
9585>>>                        Move (sInitDir + "\" + CString(Left(sFileName, iPos))) to sFiles[iCount]
9586>>>                        Move (ToOEM(sFiles[iCount])) to sFiles[iCount] 
9587>>>                        Move (Right(sFileName, Length(sFileName) - iPos)) to sFileName
9588>>>                        Increment iCount
9589>>>                    End
9589>>>>
9589>>>                Until (iPos <= 1)
9591>>>            End
9591>>>>
9591>>>            Else Begin
9592>>>                Move (CString(ToOEM( sFileName ))) to sFiles[0]
9593>>>            End
9593>>>>
9593>>>            
9593>>>            Set private_Selected_Files to sFiles
9594>>>        End
9594>>>>
9594>>>        Function_Return (bOK)
9595>>>    End_Function
9596>>>End_Class
9597>>>
9597>>>Class OpenDialog is an AbstractFileDialog
9598>>>    Procedure Construct_Object
9600>>>        Forward Send Construct_Object
9602>>>        Set PrivateExternal_msg To get_GetOpenFileName
9603>>>    End_Procedure
9604>>>
9604>>>    Procedure Set MultiSelect_State Boolean bState
9606>>>        Set private_MultiSelect_State to bState
9607>>>    End_Procedure
9608>>>    
9608>>>    Function MultiSelect_State Returns Boolean
9610>>>        Boolean bState
9610>>>        Get private_MultiSelect_State to bState
9611>>>        Function_Return bState
9612>>>    End_Function
9613>>>    
9613>>>    Function Selected_Files Returns String[]
9615>>>        String[] sFiles
9616>>>        Get private_Selected_Files to sFiles
9617>>>        Function_Return sFiles
9618>>>    End_Function
9619>>>End_Class
9620>>>
9620>>>Class SaveAsDialog is an AbstractFileDialog
9621>>>    Procedure Construct_Object
9623>>>        Forward Send Construct_Object
9625>>>        Set FileMustExist_State   To FALSE
9626>>>        Set CreatePrompt_State    To FALSE
9627>>>        Set ShowFileTitle_State   To TRUE
9628>>>        Set OverwritePrompt_State To TRUE
9629>>>        Set HideReadOnly_State    To TRUE
9630>>>        Set PrivateExternal_msg To get_GetSaveFileName
9631>>>    End_Procedure
9632>>>End_Class
9633>Use parsefn.pkg
Including file: parsefn.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\parsefn.pkg)
9633>>>//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
9633>>>// Confidential Trade Secret.
9633>>>// Copyright 1987-1994 Data Access Corporation, Miami FL, USA
9633>>>// All Rights reserved
9633>>>// DataFlex is a registered trademark of Data Access Corporation.
9633>>>//
9633>>>// Module:
9633>>>//      parsefn.pkg
9633>>>//
9633>>>// Purpose:
9633>>>//      Functions for parsing filename specifications.
9633>>>//
9633>>>// Author:
9633>>>//      Lee Smith
9633>>>//
9633>>>// Date:
9633>>>//      11/9/94
9633>>>//
9633>>>//=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
9633>>>
9633>>>use seq_chnl.pkg
9633>>>
9633>>>function Parse_Drive GLOBAL string Val returns string
9635>>>    string Pth
9635>>>
9635>>>    move Val to Pth
9636>>>
9636>>>    while ":" in Pth
9640>>>        right Pth to Pth (length(Pth) - pos(":", Pth))
9642>>>>
9642>>>    end
9643>>>>
9643>>>
9643>>>    function_return (left(Val, (length(Val) - length(Pth))))
9644>>>end_function
9645>>>
9645>>>function Parse_Path GLOBAL string Spec returns string
9647>>>    string DSpec FSpec Sep_List Sep_Char Val Dir_Sep Input_Spec
9647>>>    string Pth First_Path_Char Drv
9647>>>    integer Sep_Len Sep_Pos Chnl Obj Fnd
9647>>>
9647>>>    move (sysconf(SYSCONF_DIR_SEPARATOR)) to Dir_Sep
9648>>>
9648>>>    move Spec to Pth
9649>>>
9649>>>    while ":" in Pth
9653>>>        right Pth to Pth (length(Pth) - pos(":", Pth))
9655>>>>
9655>>>    end
9656>>>>
9656>>>
9656>>>    left Spec to Drv (length(Spec) - length(Pth))
9658>>>>
9658>>>
9658>>>    //
9658>>>    // Remove file name from Pth
9658>>>    //
9658>>>    move Pth to FSpec
9659>>>    move "\/" to Sep_List
9660>>>    length Sep_List to Sep_Len
9661>>>>
9661>>>    move 1 to Sep_Pos
9662>>>
9662>>>    while Sep_Pos LE Sep_Len
9666>>>        mid Sep_List to Sep_Char 1 Sep_Pos
9669>>>>
9669>>>
9669>>>        while (FSpec contains Sep_Char)
9673>>>            right Pth to FSpec (length(FSpec) - pos(Sep_Char, FSpec))
9675>>>>
9675>>>        end
9676>>>>
9676>>>
9676>>>        increment Sep_Pos
9677>>>    end
9678>>>>
9678>>>
9678>>>    //
9678>>>    // if FSpec is "." or "", transform to current file
9678>>>    // type (typically "*.*" or "*")
9678>>>    //
9678>>>    if ((FSpec = ".") or (FSpec <= "")) begin
9680>>>        left Pth to Pth (length(Pth) - length(FSpec))
9682>>>>
9682>>>        move (sysconf(SYSCONF_FILE_MASK)) to FSpec
9683>>>
9683>>>        if (("/\" contains right(Pth, 1)) and ;                (right(Pth, 2) <> ":\") and (right(Pth, 2) <> ":/")) ;            move (Pth + FSpec) to Pth
9686>>>        else ;            move (Pth + Dir_Sep + FSpec) to Pth
9688>>>    end
9688>>>>
9688>>>
9688>>>    //
9688>>>    // trim off file spec to get dir spec
9688>>>    //
9688>>>    left Pth to DSpec (length(Pth) - length(FSpec))
9690>>>>
9690>>>
9690>>>    //
9690>>>    // trim off dir separator from DSpec and
9690>>>    // create string for direct_input to check to see if fspec is a dir
9690>>>    //
9690>>>    if (right(DSpec, 1)) in "/\" begin
9692>>>        move (Drv + DSpec + FSpec) to Input_Spec
9693>>>
9693>>>        if ((Dspec <> "\") and (Dspec <> "/")) ;            left DSpec to DSpec (length(DSpec) - 1)
9697>>>    end
9697>>>>
9697>>>    else ;        move (Drv + DSpec + Dir_Sep + FSpec) to Input_Spec
9699>>>
9699>>>    //
9699>>>    // determine if FSpec is really a directory
9699>>>    //
9699>>>    get Seq_Open_Input_Channel ;        ("DIR:" + Input_Spec + Dir_Sep + sysconf(SYSCONF_FILE_MASK)) to Chnl
9700>>>
9700>>>    if Chnl EQ DF_SEQ_CHANNEL_ERROR ;        function_return DSpec
9703>>>
9703>>>    move (not(Seqeof)) to Fnd
9704>>>
9704>>>//    move ("[" + uppercase(FSpec) + "]") to Pth
9704>>>//
9704>>>//    move (FALSE) to Fnd
9704>>>//    while (not(Seqeof) and not(Fnd))
9704>>>//        readln Val
9704>>>//        move (uppercase(Val) = Pth) to Fnd
9704>>>//    end
9704>>>
9704>>>    send Seq_Close_Channel Chnl
9705>>>
9705>>>    if Fnd begin
9707>>>        if ("/\" contains right(DSpec, 1)) ;            move (DSpec + FSpec) to DSpec
9710>>>        else ;            move (DSpec + Dir_Sep + FSpec) to DSpec
9712>>>    end
9712>>>>
9712>>>
9712>>>    function_return DSpec
9713>>>end_function
9714>>>
9714>>>function Parse_File GLOBAL string Val returns string
9716>>>    integer Len
9716>>>    string Drv Pth
9716>>>
9716>>>    get Parse_Drive Val to Drv
9717>>>    get Parse_Path Val to Pth
9718>>>
9718>>>    move (length(Drv) + length(Pth)) to Len
9719>>>
9719>>>    if Len GT 0 ;        if not (right(Pth, 1)) in "\/" ;            increment Len
9724>>>
9724>>>    if Len GE (length(Val)) ;        function_return ""
9727>>>    else ;        function_return (right(Val, (length(Val) - Len)))
9729>>>end_function
9730>>>
9730>Use Flexml.pkg
Including file: Flexml.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Flexml.pkg)
9730>>>//****************************************************************************************
9730>>>//                                                                                       *
9730>>>//  FLEXML.PKG                                                                            *
9730>>>//                                                                                       *
9730>>>//  Interface package for FLEXML.DLL - extension system for Extensible Markup Language.  *
9730>>>//                                                                                       *
9730>>>//  Written by Michael Gouker, 7/31/99                                                   *
9730>>>// 12/19/2000 JJT - Major revision changes for VDF7/SP2.                                 *
9730>>>//                                                                                       *
9730>>>//****************************************************************************************
9730>>>Use LanguageText.pkg
9730>>>Use Windows.pkg
9730>>>Use GlobalFunctionsProcedures.pkg
9730>>>
9730>>>
9730>>>// Used to designate that a handle is a handle to an Xml Dom object. This
9730>>>// is used/required by server web-services but could be used elsewhere .
9730>>>
9730>>>
9730>>>// Types of Nodes
9730>>>
9730>>>
9730>>>// classes and methods defined in fmac
9730>>>
9730>>>
9730>>>Register_Function transformNode Integer infcXSLNode Returns String
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>
9730>>>// XML function & procedure registration
9730>>>
9730>>>Register_Procedure Set XmlInterface Integer iHandle
9730>>>Register_Function XmlInterface Returns Integer
9730>>>
9730>>>// NODE Properties
9730>>>Register_Function phAttributes Returns Integer
9730>>>Register_Function psBaseName Returns String
9730>>>Register_Function phChildNodes Returns Integer
9730>>>Register_Function phDefinition Returns Integer
9730>>>Register_Function phFirstChild Returns Integer
9730>>>Register_Function phLastChild Returns Integer
9730>>>Register_Function phNextSibling Returns Integer
9730>>>Register_Function psNameSpaceURI Returns String
9730>>>Register_Function psNodeName Returns String
9730>>>Register_Function piNodeType Returns Integer
9730>>>Register_Function psNodeTypeString Returns String
9730>>>Register_Function phOwnerDocument Returns Integer
9730>>>Register_Function phParentNode Returns Integer
9730>>>Register_Function pbParsed Returns Integer
9730>>>Register_Function psPrefix Returns String
9730>>>Register_Function phPreviousSibling Returns Integer
9730>>>Register_Function pbSpecified Returns Integer
9730>>>Register_Function psText Returns String
9730>>>Register_Procedure Set psText String sText
9730>>>Register_Function psXML Returns String
9730>>>
9730>>>// Node Read write properties
9730>>>
9730>>>Register_Procedure Set psDataType String sTypeName
9730>>>Register_Function psDataType Returns String
9730>>>Register_Procedure Set pvNodeTypedValue Integer iType Integer iAddress
9730>>>Register_Function pvNodeTypedValue Integer iType Returns Integer  // address of data
9730>>>Register_Procedure Set psNodeValue String sValue
9730>>>Register_Function psNodeValue Returns String
9730>>>
9730>>>// Node Methods
9730>>>
9730>>>Register_Function AppendChild Integer iChildInfc Returns Integer
9730>>>Register_Function CloneInfcNode Integer bRecurse Returns Integer
9730>>>Register_Function HasChildNodes Returns Integer
9730>>>Register_Function InsertBefore Integer infcNodeToInsert Integer iWhere Returns Integer
9730>>>Register_Function RemoveChild Integer iChildToRemove Returns Integer
9730>>>Register_Function ReplaceChild Integer iNewChild Integer iChildToReplace Returns Integer
9730>>>Register_Function SelectNodes String selectstring Returns Integer
9730>>>Register_Function SelectSingleNode String selectstring Returns Integer
9730>>>
9730>>>// Node Collections
9730>>>// READONLY PROPERTIES
9730>>>
9730>>>Register_Function phItem Integer iItem Returns Integer
9730>>>Register_Function phElementItem Integer iItem Returns Integer
9730>>>
9730>>>Register_Function piLength Returns Integer
9730>>>
9730>>>//*     GET_ENUMNODELIST                  */  typ_p1_int | qt_int | out_two,
9730>>>//*     GET_RESET                         */  qt_int | out_one,
9730>>>
9730>>>// Named Node Map
9730>>>
9730>>>//*     GET_NAMEDITEM                     */  typ_p1_str | qt_int | out_two,
9730>>>
9730>>>Register_Function NamedItem String sName Returns Integer
9730>>>Register_Function QualifiedItem String sBaseName String sNameSpace Returns Integer
9730>>>Register_Function RemoveNamedItem String sName Returns Integer
9730>>>Register_Function RemoveQualifiedItem String sBaseName String sNameSpace Returns Integer
9730>>>Register_Function SetNamedItem Integer iInterface Returns Integer
9730>>>
9730>>>// XML DOM Document
9730>>>// Read only properties
9730>>>
9730>>>Register_Function phDocType Returns Integer
9730>>>Register_Function phImplementation Returns Integer
9730>>>Register_Function phParseError Returns Integer
9730>>>Register_Function piReadyState Returns Integer
9730>>>Register_Function psURL Returns String
9730>>>
9730>>>// Read Write Properties
9730>>>
9730>>>Register_Procedure Set pbAsync Integer bValue
9730>>>Register_Function pbAsync Returns Integer
9730>>>Register_Procedure Set phDocumentElement Integer iElement
9730>>>Register_Function phDocumentElement Returns Integer
9730>>>Register_Procedure Set pbPreserveWhiteSpace Integer bValue
9730>>>Register_Function pbPreserveWhiteSpace Returns Integer
9730>>>Register_Procedure Set pbResolveExternals Integer bValue
9730>>>Register_Function pbResolveExternals Returns Integer
9730>>>Register_Procedure Set pbValidateOnParse Integer bValue
9730>>>Register_Function pbValidateOnParse Returns Integer
9730>>>
9730>>>// Events
9730>>>
9730>>>// Methods
9730>>>
9730>>>Register_Function Abort Returns Integer
9730>>>Register_Function ElementsByTagName String sTagName Returns Integer
9730>>>Register_Function LoadDocument String sURLName Returns Integer
9730>>>Register_Function LoadXML String sXMLText Returns Integer
9730>>>Register_Function NodeFromID String sNodeName Returns Integer
9730>>>Register_Function SaveDocument String sURLName Returns Integer
9730>>>
9730>>>// Parse Error
9730>>>// Read Only Properties
9730>>>
9730>>>Register_Function piErrorCode Returns Integer
9730>>>Register_Function piFilePos Returns Integer
9730>>>Register_Function piLine Returns Integer
9730>>>Register_Function piLinePos Returns Integer
9730>>>Register_Function psReason Returns String
9730>>>Register_Function psSrcText Returns String
9730>>>Register_Function psURL Returns String
9730>>>
9730>>>// DOM Implementation
9730>>>// Method
9730>>>
9730>>>Register_Function HasFeature String sSystem String sFeature Returns Integer
9730>>>
9730>>>// Methods
9730>>>
9730>>>Register_Function substringData Integer iOffset Integer iCount Returns String
9730>>>Register_Function appendData String sData Returns Integer
9730>>>Register_Function insertData Integer iOffset String sData Returns Integer
9730>>>Register_Function deleteData Integer iOffset Integer iCount Returns Integer
9730>>>Register_Function replaceData Integer iOffset Integer iCount String sData Returns Integer
9730>>>
9730>>>// Attributes
9730>>>
9730>>>Register_Function psName Returns String
9730>>>
9730>>>// Elements
9730>>>// Read Only properties
9730>>>
9730>>>Register_Function psTagName Returns String
9730>>>
9730>>>// Methods
9730>>>
9730>>>Register_Procedure Set attributeValue String sName String sValue
9730>>>Register_Function attributeValue String sName Returns String
9730>>>Register_Function removeAttribute String sName Returns Integer
9730>>>Register_Function attributeNode String sName Returns Integer
9730>>>Register_Procedure Set attributeNode Integer iNode Returns Integer
9730>>>Register_Function removeAttributeNode Integer iNode Returns Integer
9730>>>
9730>>>// DOM Text
9730>>>// Methods
9730>>>
9730>>>Register_Function splitText Integer iOffset Returns Integer
9730>>>
9730>>>// DOM Processing Instruction
9730>>>// Read Only Properties
9730>>>Register_Function psTarget Returns String
9730>>>
9730>>>// DOM Document Type
9730>>>
9730>>>Register_Function phEntities Returns Integer
9730>>>Register_Function phNotations Returns Integer
9730>>>
9730>>>// DOM Notations
9730>>>
9730>>>Register_Function psPublicID Returns String
9730>>>Register_Function psSystemID Returns String
9730>>>Register_Function psNotationName Returns String
9730>>>
9730>>>// create nodes
9730>>>
9730>>>Register_Function createAttribute String sName Returns Integer
9730>>>Register_Function createCDataSection String sValue Returns Integer
9730>>>Register_Function createComment String sValue Returns Integer
9730>>>Register_Function createDocumentFragment Returns Integer
9730>>>Register_Function createElement String sTagName Returns Integer
9730>>>Register_Function createEntityReference String sEntityName Returns Integer
9730>>>Register_Function createNode Integer iNodeType String sName String sNameSpace Returns Integer
9730>>>Register_Function createProcessingInstruction String sTarget String sData Returns Integer
9730>>>Register_Function createTextNode String sData Returns Integer
9730>>>
9730>>>Register_Function ChangeNodeType Integer iTypeOfNode Integer bSetInterface Returns Integer
9730>>>
9730>>>
9730>>>// ******************************************************************************
9730>>>//
9730>>>//          Part 1:  Base Document Logic Specialized For Templates
9730>>>//
9730>>>// ******************************************************************************
9730>>>
9730>>>//
9730>>>//  XML Collections
9730>>>//
9730>>>//  Collection mixin has common functions to both node lists and named node maps
9730>>>//
9730>>>
9730>>>// This provides functions required of all XMLDOM objects.
9730>>>//
9730>>>Class cXMLDOMMixin is a Mixin
9731>>>
9731>>>    // Create an XML object of passed class Id and bind passed interface. returns
9731>>>    // the object handle. All dynamic XML object can be created using this syntax
9731>>>
9731>>>    Function CreateXMLObject Integer iClassId Integer hinfXMLInterface Returns Handle
9733>>>        Handle hoId hoDocument
9733>>>        // We will always create objects at the DOMDocument level.
9733>>>        Get DocumentObject to hoDocument
9734>>>        If (hoDocument=0) Begin  // this should never happen.
9736>>>            Error DFERR_XML_INTERNAL_ERROR C_$XmlFailedNoDocObject
9737>>>>
9737>>>            Function_Return 0
9738>>>        End
9738>>>>
9738>>>        If hinfXMLInterface Begin
9740>>>            Get Create of hoDocument iClassId to hoID
9741>>>            Set XMLInterface of hoID to hinfXMLInterface
9742>>>        End
9742>>>>
9742>>>        Function_Return hoID
9743>>>    End_Function
9744>>>
9744>>>    // create an XML Node object based on the interface type.
9744>>>    // this will convert the interface to the proper type and will create
9744>>>    // an appropriate DF object.
9744>>>    // This requires that a DocumentObject exists
9744>>>
9744>>>    Function CreateXMLNode Handle hinfc Returns Handle
9746>>>        Integer hoNode iType iClassId
9746>>>        Handle  hoDocument
9746>>>        // Get the node type of the infc handle w/o creating a DF object
9746>>>        Move (invokexml(DF_IXMLDOMNODE, GET_piNodeType, hinfc, 0, 0, 0, 0)) to iType
9747>>>        Move (invokexml(DF_IXMLDOMNODE, GET_ChangeNodeType, hinfc, iType, 1, 0, 0)) to hInfc
9748>>>        If (hinfc=0) Begin
9750>>>            // this should not happen and we would need to know about this.
9750>>>            Error DFERR_XML_INTERNAL_ERROR (C_$XmlFailedNoDocObject + String(iType))
9751>>>>
9751>>>            Function_Return 0
9752>>>        End
9752>>>>
9752>>>        Get DocumentObject to hoDocument
9753>>>        // you can augment your class IDs in a single place.
9753>>>        Get NodeClassId of hoDocument iType to iClassId
9754>>>        // MG: 12/6/00 Changed to create nodes inside of the document object.
9754>>>        Get CreateXMLObject of hoDocument iClassId hinfc to hoNode
9755>>>
9755>>>        Function_Return hoNode
9756>>>    End_Function
9757>>>
9757>>>
9757>>>    // Change object's class. This let's you change the class id of an object
9757>>>    // on an object by object basis. This would let you create nodes (e.g. elements)
9757>>>    // that have a custom interface for each node type. Normally, this would be sent
9757>>>    // after a node has been created using one of the default classes
9757>>>    Function ChangeNodeClass Integer hoNode Integer iClassID Returns Handle
9759>>>        Integer iType
9759>>>        Handle  hinfcNew
9759>>>        Get piNodeType of hoNode to iType
9760>>>        Get ChangeNodeType of hoNode iType False to hInfcNew
9761>>>        Send Destroy to hoNode // destroy object and old infc handle.
9762>>>        Get CreateXMLObject iClassId hinfcNew to hoNode
9763>>>        Function_Return hoNode
9764>>>    End_Function
9765>>>
9765>>>End_Class
9766>>>
9766>>>
9766>>>Class cXMLDOMCollectionMixin is a Mixin
9767>>>
9767>>>    Import_Class_Protocol cXMLDOMMixin
9768>>>
9768>>>    //  Returns number of items in the collection
9768>>>    //
9768>>>    Function NodeListLength Returns Integer
9770>>>        Integer iLength
9770>>>        Get piLength to iLength
9771>>>        Function_Return iLength
9772>>>    End_Function
9773>>>
9773>>>    // Returns an XML node object for pass item
9773>>>    //
9773>>>    Function CollectionNode Integer I Returns Handle
9775>>>        Integer hoNewNode
9775>>>        Integer infcItem
9775>>>        Get phItem i to infcItem
9776>>>        If (infcItem) ;            Get CreateXMLNode infcItem to hoNewNode
9779>>>        Function_Return hoNewNode
9780>>>    End_Function
9781>>>
9781>>>
9781>>>End_Class
9782>>>
9782>>>// Simple declarations of collections.
9782>>>
9782>>>Class cXMLDOMNodeList is a BaseXmlDomNodeList
9783>>>    Import_Class_Protocol cXMLDOMCollectionMixin
9784>>>End_Class
9785>>>
9785>>>Class cXMLDOMNamedNodeMap is a BaseXmlDomNamedNodeMap
9786>>>
9786>>>    Import_Class_Protocol cXMLDOMCollectionMixin
9787>>>
9787>>>    // returns a node attribute that matches passed name, zero if none
9787>>>    Function NamedNode String sName Returns Handle
9789>>>        Integer hoNewNode
9789>>>        Integer infcItem
9789>>>        Get NamedItem sName to infcItem
9790>>>        If infcItem ;            Get CreateXMLNode infcItem to hoNewNode
9793>>>        Function_Return hoNewNode
9794>>>    End_Function
9795>>>
9795>>>    // Adds or changes a node attribute
9795>>>    // This should return the passed object Id which is now bound to the attribute. If an error, returns 0
9795>>>    Function SetNamedNode Handle hoNode Returns Handle
9797>>>        Integer hinfcNode hinfcItem
9797>>>        Get XMLInterface of hoNode to hinfcNode // node of passed attribute
9798>>>        Get SetNamedItem hinfcNode to hinfcItem
9799>>>        If hinfcItem ;            Set XMLInterface of hoNode to hinfcItem
9802>>>        Else ;            Move 0 to hoNode // zero indicates error
9804>>>        Function_Return hoNode
9805>>>    End_Function
9806>>>
9806>>>    // removes named attribute, Returns handle of removed node or zero if not found.
9806>>>    // Note that returned object must be disposed of or moved somewhere else.
9806>>>    Function RemoveNamedNode String sName Returns Handle
9808>>>        Integer hoNewNode
9808>>>        Integer infcItem
9808>>>        Get RemoveNamedItem sName to infcItem
9809>>>        If infcItem ;            Get CreateXMLNode infcItem to hoNewNode
9812>>>        Function_Return hoNewNode
9813>>>    End_Function
9814>>>
9814>>>    Function QualifiedNode String sNameSpace String sBaseName Returns Handle
9816>>>        Integer hoNewNode
9816>>>        Integer infcItem
9816>>>        Get QualifiedItem  sBaseName sNameSpace  to infcItem
9817>>>        If infcItem ;            Get CreateXMLNode infcItem to hoNewNode
9820>>>        Function_Return hoNewNode
9821>>>    End_Function
9822>>>
9822>>>    Function RemoveQualifiedNode String sNameSpace String sBaseName Returns Handle
9824>>>        Integer hoNewNode
9824>>>        Integer infcItem
9824>>>        Get RemoveQualifiedItem sBaseName sNameSpace to infcItem
9825>>>        If infcItem ;            Get CreateXMLNode infcItem to hoNewNode
9828>>>        Function_Return hoNewNode
9829>>>    End_Function
9830>>>
9830>>>End_Class
9831>>>
9831>>>
9831>>>
9831>>>// Mixin for nodes.
9831>>>//
9831>>>//  First the declaration of functions that have no object references.
9831>>>//
9831>>>
9831>>>
9831>>>Class cXMLDOMNodeMixin is a Mixin
9832>>>
9832>>>    Import_Class_Protocol cXMLDOMMixin
9833>>>
9833>>>    //  Append Node to the end of list. Returns passed Object handle if Ok, 0 if error
9833>>>
9833>>>    Function AppendNode Handle hoNode Returns Handle
9835>>>        Integer hoNewTextNode
9835>>>        Integer hinfcNode
9835>>>        Integer infcReturned
9835>>>        // Get COM Interface to call Append child.
9835>>>        Get XMLInterface of hoNode to hinfcNode
9836>>>        If (hinfcNode=0) Function_Return 0
9839>>>        Get AppendChild hinfcNode to infcReturned
9840>>>        // Interface returned is stored in DataFlex object.
9840>>>        If (infcReturned=0) Function_Return 0
9843>>>        Set XMLInterface of hoNode to infcReturned
9844>>>        Function_Return hoNode
9845>>>    End_Function
9846>>>
9846>>>    //  Insert NewNode before Node. Returns passed newnode Object handle if Ok, 0 if error
9846>>>
9846>>>    Function InsertBeforeNode Integer hoNewNode Integer hoNode Returns Handle
9848>>>        Integer hinfcNewNode hinfcNode iType hoRefNode
9848>>>        Integer infcReturned
9848>>>        // DOM says if no refnode argument passed or it is 0, append to end
9848>>>        If (Num_Arguments=1) ;            Move 0 to hoRefNode
9851>>>        Else ;            Move hoNode to hoRefNode
9853>>>        Get XMLInterface of hoNewNode to hinfcNewNode
9854>>>        If (hinfcNewNode=0) Function_Return 0
9857>>>        If hoRefNode Begin
9859>>>            Get XMLInterface of hoRefNode to hinfcNode
9860>>>            If (hinfcNode=0) Function_Return 0
9863>>>        End
9863>>>>
9863>>>        Get InsertBefore hinfcNewNode hinfcNode to infcReturned
9864>>>        If (infcReturned=0) Function_Return 0
9867>>>        // Interface returned is stored in DataFlex object.
9867>>>        Set XMLInterface of hoNewNode to infcReturned
9868>>>        Function_Return hoNewNode
9869>>>    End_Function
9870>>>
9870>>>    //  Remove Node. Returns object Id of removed node, zero if error
9870>>>    //  Important: The node is not destroyed! This lets you move it elsewhere if you want
9870>>>
9870>>>    Function RemoveNode Integer hoNode Returns Handle
9872>>>        Integer hInfcNode
9872>>>        Get XMLInterface of hoNode to hInfcNode
9873>>>        If (hinfcNode=0) Function_Return 0
9876>>>        Get RemoveChild hInfcNode to hinfcNode
9877>>>        If (hinfcNode=0) Function_Return 0
9880>>>        Set XMLInterface of hoNode to hinfcNode
9881>>>        Function_Return hoNode
9882>>>    End_Function
9883>>>
9883>>>    //  Replace Node. Returns object Id of replaced node, zero if error
9883>>>    //  Important: The replaced node is not destroyed! This lets you move it elsewhere if you want
9883>>>
9883>>>    Function ReplaceNode Integer hoNewNode Integer hoNodeToReplace Returns Handle
9885>>>        Integer hInfcNewNode hinfcNodetoReplace hinfcNode
9885>>>        Get XMLInterface of hoNewNode       to hInfcNewNode
9886>>>        Get XMLInterface of hoNodetoReplace to hInfcNodetoreplace
9887>>>        If (hinfcNewNode=0 or hInfcNodeToReplace=0) Function_Return 0
9890>>>        Get ReplaceChild hInfcNewNode hinfcNodeToReplace to hinfcNode
9891>>>        If (hinfcNode=0) Function_Return 0
9894>>>        Set XMLInterface of hoNodetoReplace to hinfcNode
9895>>>        Function_Return hoNodetoReplace
9896>>>    End_Function
9897>>>
9897>>>    // Remove the named node. Returns handle to removed node. You must destroy
9897>>>    // or move this removed object as needed
9897>>>
9897>>>    Function RemoveNamedNode String sQueryString Returns Handle
9899>>>        Integer hoNode
9899>>>        Integer hInfcTemplate hinfcNode iRet
9899>>>        Get SelectSingleNode sQueryString to hinfcTemplate
9900>>>        If (hinfcTemplate) Begin
9902>>>            // Remove child returns an interface to the disassociated node.
9902>>>            // It should be disposed by setting it to an object and then calling destroy
9902>>>            Get RemoveChild hInfcTemplate to hInfcNode
9903>>>            // Even if hInfcTemplate and hInfcNode are the same their reference count will be incremented.
9903>>>            // Therefore we must destroy one the interfaces which will decrement the reference count thus
9903>>>            // avoding a memory leak
9903>>>            Move (invokexml(DF_IXMLDOMNODE, DESTROY_XML_INTERFACE, hInfcTemplate, 0, 0, 0, 0)) to iRet
9904>>>            If hInfcNode Get CreateXMLNode hinfcNode to hoNode
9907>>>        End
9907>>>>
9907>>>        Function_Return hoNode
9908>>>    End_Function
9909>>>
9909>>>    // This function creates a clone of the passed Node. if bRecurse all child nodes are also
9909>>>    // cloned. The object Id of the new clone object is returned.
9909>>>    // The interface of the object returned can be used in AppendChild to add
9909>>>    // the node to the XML Document.
9909>>>
9909>>>    Function CloneNode Integer bRecurse Returns Handle
9911>>>        Handle hoNewNode
9911>>>        Handle hinfcNewNode
9911>>>        Get CloneInfcNode (If(bRecurse,-1,0)) to hinfcNewNode
9912>>>        If hinfcNewNode ;            Get CreateXMLNode hinfcNewNode to hoNewNode
9915>>>        Function_Return hoNewNode
9916>>>    End_Function
9917>>>
9917>>>    //  Create a collection of all nodes. returns handle of a cXMLDomNodeList
9917>>>
9917>>>    Function ChildNodes Returns Handle
9919>>>        Integer infcNodeList
9919>>>        Integer hoNodeList
9919>>>        Get phChildNodes to infcNodeList
9920>>>        If (infcNodeList) ;            Get CreateXMLObject U_cXMLDOMNodeList infcNodeList to hoNodeList
9923>>>        Function_Return hoNodeList
9924>>>    End_Function
9925>>>
9925>>>    //  Create a collection of all attributes. returns handle of a cXMLDomNodeMapList
9925>>>
9925>>>    Function AttributeNodes Returns Handle
9927>>>        Integer hoCollectionId   // Object to hold collection
9927>>>        Integer hinfcAttributes  // XML Interface for collection
9927>>>        Get phAttributes to hinfcAttributes
9928>>>        If (hinfcAttributes) ;            Get CreateXMLObject U_cXMLDOMNamedNodeMap hinfcAttributes to hoCollectionId
9931>>>        Function_Return hoCollectionId
9932>>>    End_Function
9933>>>    
9933>>>    //  Create a collection of all attributes for the temporary attribute node object.
9933>>>    //  Using this saves a small amount of time creating and destroying this object but
9933>>>    //  it must be used with care. This binding is temporary!
9933>>>    Function TempAttributeNodes Returns Handle
9935>>>        Handle hoCollectionId hoDocument
9935>>>        Handle hinfcAttributes  // XML Interface for collection
9935>>>        Get phAttributes to hinfcAttributes
9936>>>        If (hinfcAttributes) Begin
9938>>>            Get DocumentObject to hoDocument
9939>>>            Get phoTempDomNodeMap of hoDocument to hoCollectionId
9940>>>            Set XMLInterface of hoCollectionId to hinfcAttributes
9941>>>        End
9941>>>>
9941>>>        Function_Return hoCollectionId
9942>>>    End_Function
9943>>>    
9943>>>
9943>>>    // Returns a collection of just elements
9943>>>
9943>>>    Function ElementNodes String sQueryString Returns Handle
9945>>>        Integer hoNodeList
9945>>>        Integer hinfcNodeList
9945>>>        Get ElementsByTagName sQueryString to hinfcNodeList
9946>>>        If (hinfcNodeList <> 0) ;            Get CreateXMLObject U_cXMLDOMNodeList hinfcNodeList to hoNodeList
9949>>>        Function_Return hoNodeList
9950>>>    End_Function
9951>>>
9951>>>
9951>>>
9951>>>    // Return object handle for query.
9951>>>
9951>>>    Function FindNode String sQueryString Returns Handle
9953>>>        Integer hoNode
9953>>>        Integer hinfcNode
9953>>>        Get SelectSingleNode sQueryString to hinfcNode
9954>>>        //inkey windowindex
9954>>>        If (hinfcNode <> 0) ;            Get CreateXMLNode hInfcNode to hoNode
9957>>>        Function_Return hoNode
9958>>>    End_Function
9959>>>
9959>>>    // Return object handle for a collection node.
9959>>>
9959>>>
9959>>>    Function FindNodeList String sQueryString Returns Handle
9961>>>        Integer hoNodeList
9961>>>        Integer hinfcNodeList
9961>>>        Get SelectNodes sQueryString to hinfcNodeList
9962>>>        If (hinfcNodeList <> 0) ;            Get CreateXMLObject U_cXMLDOMNodeList hinfcNodeList to hoNodeList
9965>>>        Function_Return hoNodeList
9966>>>    End_Function
9967>>>
9967>>>    // The CreatexxxxxNode messages creates an node object for the type specified. Both
9967>>>    // the interface and the object or of the correct type (i.e. element, comment)
9967>>>    // These all return an object handle which can be used to place the object via
9967>>>    // appendNode or InsertBeforeNode
9967>>>
9967>>>    // This function creates a child element, returning a dataflex object.
9967>>>    // The interface of the object returned can be used in AppendChild to add
9967>>>    // the element to the XML Document.
9967>>>
9967>>>    Function CreateElementNode String sTagName String sValue Returns Handle
9969>>>        Integer hoNewElement
9969>>>        Integer hoDocumentObject
9969>>>        Integer infcNewElement
9969>>>        Integer iClassId
9969>>>        // The DataFlex objects are created inside the nodes (elements).
9969>>>        // Create an element in the document and assign its interface to the new DF object.
9969>>>        Get DocumentObject to hoDocumentObject
9970>>>        Get createElement of hoDocumentObject sTagName to infcNewElement
9971>>>        If infcNewElement Begin // if there was an error, no infc handle would be returned
9973>>>            Get NodeClassId of hoDocumentObject NODE_ELEMENT to iClassId
9974>>>            Get CreateXMLObject iClassId infcNewElement to hoNewElement
9975>>>            If hoNewElement ; // very unlikely this will be zero                Set psText of hoNewElement to sValue
9978>>>        End
9978>>>>
9978>>>        Function_Return hoNewElement
9979>>>    End_Function
9980>>>
9980>>>    // This function creates an attribute in a document. Attributes are _NOT_ children of an element.
9980>>>    // A DataFlex object is returned. An attribute can be added to an xml document using
9980>>>    // get AddAttributeNode.
9980>>>
9980>>>    Function CreateAttributeNode String sName String sValue Returns Handle
9982>>>        Integer hoNewAttribute
9982>>>        Integer hoDocumentObject
9982>>>        Integer infcNewAttribute
9982>>>        Integer iClassId
9982>>>        Get DocumentObject to hoDocumentObject
9983>>>        // Create an Attribute in the document and assign its interface to the new DF object.
9983>>>        Get createAttribute of hoDocumentObject sName to infcNewAttribute
9984>>>        If infcNewAttribute Begin // if there was an error, no infc handle would be returned
9986>>>            Get NodeClassId of hoDocumentObject NODE_ATTRIBUTE to iClassId
9987>>>            Get CreateXMLObject iClassId infcNewAttribute to hoNewAttribute
9988>>>            // Set the value of the attribute.
9988>>>            If hoNewAttribute ; // very unlikely this will be 0                Set psText of hoNewAttribute to sValue
9991>>>        End
9991>>>>
9991>>>        Function_Return hoNewAttribute
9992>>>    End_Function
9993>>>
9993>>>    // This function creates a child comment, returning a dataflex object.
9993>>>    // The interface of the object returned can be used in AppendChild to add
9993>>>    // the comment to the XML Document.
9993>>>
9993>>>    Function CreateChildComment String sValue Returns Handle
9995>>>        Integer hoNewComment
9995>>>        Integer hoDocumentObject
9995>>>        Integer infcNewComment
9995>>>        Integer iClassID
9995>>>        Get DocumentObject to hoDocumentObject
9996>>>        // Create an Comment in the document and assign its interface to the new DF object.
9996>>>        Get createComment of hoDocumentObject sValue to infcNewComment
9997>>>        If infcNewComment Begin // if there was an error, no infc handle would be returned
9999>>>            Get NodeClassId of hoDocumentObject NODE_COMMENT to iClassId
10000>>>            Get CreateXMLObject iClassId infcNewComment to hoNewComment
10001>>>            If hoNewComment ; // very unlikely this will be 0                Set psText of hoNewComment to sValue
10004>>>        End
10004>>>>
10004>>>        Function_Return hoNewComment
10005>>>    End_Function
10006>>>
10006>>>    // This function creates a child processing instruction, returning a dataflex object.
10006>>>    // The interface of the object returned can be used in AppendChild to add
10006>>>    // the processing instruction to the XML Document.
10006>>>
10006>>>    Function CreateChildProcessingInstruction String sTarget String sValue Returns Handle
10008>>>        Integer hoNewProcessingInstruction
10008>>>        Integer hoDocumentObject
10008>>>        Integer infcNewProcessingInstruction
10008>>>        Integer iClassID
10008>>>        Get DocumentObject to hoDocumentObject
10009>>>        // Create an ProcessingInstruction in the document and assign its interface to the new DF object.
10009>>>        Get createProcessingInstruction of hoDocumentObject sTarget sValue to infcNewProcessingInstruction
10010>>>        If infcNewProcessingInstruction  Begin // if there was an error, no infc handle would be returned
10012>>>            Get NodeClassId of hoDocumentObject NODE_PROCESSING_INSTRUCTION to iClassId
10013>>>            Get CreateXMLObject iClassID infcNewProcessingInstruction to hoNewProcessingInstruction
10014>>>        End
10014>>>>
10014>>>        Function_Return hoNewProcessingInstruction
10015>>>    End_Function
10016>>>
10016>>>    // This function creates a child text node, returning a dataflex object.
10016>>>    // The interface of the object returned can be used in AppendChild to add
10016>>>    // the text node to the XML Document.
10016>>>
10016>>>    Function CreateChildTextNode String sValue Returns Handle
10018>>>        Integer hoNewTextNode
10018>>>        Integer hoDocumentObject
10018>>>        Integer infcNewTextNode
10018>>>        Integer iClassID
10018>>>        Get DocumentObject to hoDocumentObject
10019>>>        // Create an TextNode in the document and assign its interface to the new DF object.
10019>>>        Get createTextNode of hoDocumentObject sValue to infcNewTextNode
10020>>>        If infcNewTextNode Begin // if there was an error, no infc handle would be returned
10022>>>            Get NodeClassId of hoDocumentObject NODE_TEXT to iClassId
10023>>>            Get CreateXMLObject iClassId infcNewTextNode to hoNewTextNode
10024>>>        End
10024>>>>
10024>>>        Function_Return hoNewTextNode
10025>>>    End_Function
10026>>>
10026>>>    // This function creates a cdata text node, returning a dataflex object.
10026>>>    // The interface of the object returned can be used in AppendChild to add
10026>>>    // the cdata node to the XML Document.
10026>>>
10026>>>    Function CreateCDATASectionNode String sValue Returns Handle
10028>>>        Integer hoNewNode
10028>>>        Integer hoDocumentObject
10028>>>        Integer infcNewNode
10028>>>        Integer iClassId
10028>>>        // The DataFlex objects are created inside the nodes (elements).
10028>>>        // Create an element in the document and assign its interface to the new DF object.
10028>>>        Get DocumentObject to hoDocumentObject
10029>>>        Get createCDATASection of hoDocumentObject sValue to infcNewNode
10030>>>        If infcNewNode Begin
10032>>>            Get NodeClassId of hoDocumentObject NODE_CDATA_SECTION to iClassId
10033>>>            Get CreateXMLObject iClassId infcNewNode to hoNewNode
10034>>>        End
10034>>>>
10034>>>        Function_Return hoNewNode
10035>>>    End_Function
10036>>>
10036>>>    // Create a document fragment.  Document fragments can be used to house nodes temporarily. When
10036>>>    // You append or insert a document fragment (appendNode InsertBeforeNode) child nodes are appended
10036>>>    // to the destination object and not the fragment node itself. This is useful!
10036>>>
10036>>>    Function CreateDocumentFragmentNode Returns Handle
10038>>>        Integer hoNew
10038>>>        Integer hoDocumentObject
10038>>>        Integer infcNew
10038>>>        Integer iClassID
10038>>>        Get DocumentObject to hoDocumentObject
10039>>>        // Create an Comment in the document and assign its interface to the new DF object.
10039>>>        Get createDocumentFragment of hoDocumentObject to infcNew
10040>>>        If infcNew Begin // if there was an error, no infc handle would be returned
10042>>>            Get NodeClassId of hoDocumentObject NODE_DOCUMENT_FRAGMENT to iClassId
10043>>>            Get CreateXMLObject iClassId infcNew to hoNew
10044>>>        End
10044>>>>
10044>>>        Function_Return hoNew
10045>>>    End_Function
10046>>>
10046>>>    //  Create a Node of any passed Type (e.g. Node_element). Normally you don't need this as there are
10046>>>    //  specific messages to do this for each node type. Node that this lets you pass namespaces as a separate
10046>>>    //  parameter. With all of the other messages (e.g. createElementNode) you pass namespaces as prefixed to
10046>>>    // the tagname (e.g. Get CreateElementNode "MyNameSpace:MyTag" "MyValue" to hoEle)
10046>>>
10046>>>    Function CreateChildNode Integer iNodeType String sTagName String sNameSpace Returns Handle
10048>>>        Integer hoNewNode hoDocumentObject
10048>>>        Integer infcNewNode
10048>>>        Integer iClassid iType
10048>>>        Get DocumentObject to hoDocumentObject
10049>>>        Get NodeClassId iNodeType to iClassId
10050>>>        If (iClassId<>0) Begin
10052>>>            // Create a node in the document and assign its interface to the new DF object.
10052>>>            Get createNode of hoDocumentObject iNodeType sTagName sNameSpace to infcNewNode
10053>>>            // this is required to force the interface type to be correct.
10053>>>            Move (invokexml(DF_IXMLDOMNODE, GET_piNodeType, infcNewNode, 0, 0, 0, 0)) to iType
10054>>>            Move (invokexml(DF_IXMLDOMNODE, GET_ChangeNodeType, infcNewNode, iType, 1, 0, 0)) to infcNewNode
10055>>>
10055>>>            If infcNewNode ;                Get CreateXMLObject iClassId infcNewNode to hoNewNode
10058>>>        End
10058>>>>
10058>>>        Function_Return hoNewNode
10059>>>    End_Function
10060>>>
10060>>>
10060>>>
10060>>>    // The Addxxxxx messages create a new node and appends it to the list. When used as a function,
10060>>>    // the object handle is returned and must be disposed of later by the programmer.
10060>>>    // When used as a procedure, the object is destroyed--it just does it and is done.
10060>>>
10060>>>    Function AddElement String sTagName String sValue Returns Handle
10062>>>        Integer hoNewElement
10062>>>        Get CreateElementNode sTagName sValue to hoNewElement
10063>>>        If hoNewElement Get AppendNode hoNewElement to hoNewElement
10066>>>        Function_Return hoNewElement
10067>>>    End_Function
10068>>>
10068>>>    Procedure AddElement String sTagName String sValue
10070>>>        Integer hoNewElement
10070>>>        Get AddElement sTagName sValue to hoNewElement
10071>>>        If hoNewElement ;            Send Destroy to hoNewElement
10074>>>        Else ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddElement"))
10076>>>    End_Procedure
10077>>>
10077>>>    // this returns the object, This is often needed
10077>>>    Function CreateElementNodeNS String sNameSpace String sTagName String sValue Returns Handle
10079>>>        Integer hoNewElement
10079>>>        Get CreateChildNode NODE_ELEMENT sTagName sNameSpace to hoNewElement
10080>>>        If (hoNewElement and sValue<>"") ;            Set psText of hoNewElement to sValue
10083>>>        Function_Return hoNewElement
10084>>>    End_Procedure
10085>>>
10085>>>
10085>>>    // this returns the object, This is often needed
10085>>>    Function AddElementNS String sNameSpace String sTagName String sValue Returns Handle
10087>>>        Integer hoNewElement
10087>>>        Get CreateElementNodeNS sNameSpace sTagName sValue to hoNewElement
10088>>>        If hoNewElement Begin
10090>>>            Get AppendNode hoNewElement to hoNewElement
10091>>>        End
10091>>>>
10091>>>        Function_Return hoNewElement
10092>>>    End_Function
10093>>>
10093>>>    Procedure AddElementNS String sNameSpace String sTagName String sValue
10095>>>        Integer hoNewElement
10095>>>        Get AddElementNS sNameSpace sTagName sValue to hoNewElement
10096>>>        If hoNewElement ;            Send Destroy to hoNewElement
10099>>>        Else ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddElementNS"))
10101>>>    End_Procedure
10102>>>
10102>>>    Function AddAttributeNode Handle hoNode Returns Handle
10104>>>        Handle hInfc
10104>>>        Get Set_AttributeNode (XmlInterface(hoNode)) to hInfc
10105>>>        If hInfc ; // if ret value we have a replacement            Set XmlInterface of hoNode to hInfc
10108>>>        Function_Return hoNode
10109>>>    End_Function
10110>>>
10110>>>//    // is this needed
10110>>>//    Function AddAttributeNodeNS handle hoNode returns Handle
10110>>>//        Get AddAttributeNode hoNode to hoNode
10110>>>//        function_return hoNode
10110>>>//    End_Function
10110>>>
10110>>>    Function AttributeValueNode String sName Returns Handle
10112>>>        Handle hInfc
10112>>>        Handle hoNode
10112>>>        Get AttributeNode sName to hInfc
10113>>>        If hInfc ; // if ret value we have a replacement           Get CreateXMLNode hInfc to hoNode
10116>>>        Function_Return hoNode
10117>>>    End_Function
10118>>>
10118>>>    Function AttributeValueNodeNS String sNameSpace String sBaseName Returns Handle
10120>>>        Handle hoAttrs hoAttr
10120>>>        String sValue
10120>>>        Get TempAttributeNodes to hoAttrs
10121>>>        If hoAttrs Begin
10123>>>            Get QualifiedNode of hoAttrs sNamespace sBaseName to hoAttr
10124>>>            Set XMLInterface of hoAttrs to 0
10125>>>        End
10125>>>>
10125>>>        Function_Return hoAttr
10126>>>    End_Function
10127>>>
10127>>>
10127>>>    Function CreateAttributeNodeNS String sNameSpace String sName String sValue Returns Handle
10129>>>        Integer hoNewAttribute
10129>>>        Get CreateChildNode NODE_ATTRIBUTE sName sNameSpace to hoNewAttribute
10130>>>        If hoNewAttribute ;            Set psText of hoNewAttribute to sValue
10133>>>        Function_Return hoNewAttribute
10134>>>    End_Function
10135>>>
10135>>>    Procedure AddAttributeNS String sNameSpace String sName String sValue
10137>>>       Handle hoNode
10137>>>       Get CreateAttributeNodeNS sNameSpace sName sValue to hoNode
10138>>>       If hoNode Begin
10140>>>          Get AddAttributeNode hoNode to hoNode
10141>>>          If hoNode Send Destroy of hoNode
10144>>>       End
10144>>>>
10144>>>       Else ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddAttributeNS"))
10146>>>    End_Procedure
10147>>>
10147>>>
10147>>>    // This function encapsulates creation and addition of attributes to a node.
10147>>>    // should only work with element class
10147>>>    Procedure AddAttribute String sName String sValue
10149>>>        Set AttributeValue sName to sValue
10150>>>    End_Procedure
10151>>>
10151>>>    // This function encapsulates creation and addition of comments to a node.
10151>>>    // The return value is a Boolean that is currently unused.
10151>>>
10151>>>    Procedure AddChildComment String sValue
10153>>>        Integer hoNewNode
10153>>>        Get createChildComment sValue to hoNewNode
10154>>>        If not hoNewNode ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddChildComment"))
10157>>>        Else Begin
10158>>>            Get AppendNode hoNewNode to hoNewNode
10159>>>            Send Destroy to hoNewNode
10160>>>        End
10160>>>>
10160>>>    End_Procedure
10161>>>
10161>>>    // This function encapsulates creation and addition of processing instructions to a node.
10161>>>    // The return value is a Boolean that is currently unused.
10161>>>
10161>>>    Procedure AddChildProcessingInstruction String sTarget String sValue
10163>>>        Integer hoNewNode
10163>>>        Get createChildProcessingInstruction sTarget sValue to hoNewNode
10164>>>        If not hoNewNode ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddChildProcessingInstruction"))
10167>>>        Else Begin
10168>>>            Get AppendNode hoNewNode to hoNewNode
10169>>>            Send Destroy to hoNewNode
10170>>>        End
10170>>>>
10170>>>    End_Procedure
10171>>>
10171>>>
10171>>>    // This function encapsulates creation and addition of text nodes to a node.
10171>>>    // The return value is a Boolean that is currently unused.
10171>>>
10171>>>    Procedure AddChildTextNode String sValue
10173>>>        Integer hoNewNode
10173>>>        Get createChildTextNode sValue to hoNewNode
10174>>>        If not hoNewNode ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddChildTextNode"))
10177>>>        Else Begin
10178>>>            Get AppendNode hoNewNode to hoNewNode
10179>>>            Send Destroy to hoNewNode
10180>>>        End
10180>>>>
10180>>>    End_Procedure
10181>>>
10181>>>    // This procedure encapsulates creation and addition of cdata text nodes to a node.
10181>>>    Procedure AddCDataSection String sValue
10183>>>        Handle hoNewNode
10183>>>        Get CreateCDATASectionNode sValue to hoNewNode
10184>>>        If not hoNewNode ;            Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_AddCDataSection"))
10187>>>        Else Begin
10188>>>            Get AppendNode hoNewNode to hoNewNode
10189>>>            Send Destroy to hoNewNode
10190>>>        End
10190>>>>
10190>>>    End_Procedure
10191>>>
10191>>>
10191>>>    Function AddChildNode Integer iNodeType String sTagName String sNameSpace Returns Handle
10193>>>        Integer hoNewNode
10193>>>        Integer hoDocumentObject
10193>>>        Get DocumentObject to hoDocumentObject
10194>>>        Get createChildNode of hoDocumentObject iNodeType sTagName sNamespace to hoNewNode
10195>>>        If hoNewNode ;            Get AppendNode hoNewNode to hoNewNode
10198>>>        Function_Return hoNewNode
10199>>>    End_Function
10200>>>    
10200>>>    // don't use the runtime/msxml version of this. Instead just return the
10200>>>    // first text from the first child node. This is much faster
10200>>>    Function psText Returns String
10202>>>        Handle hText
10202>>>        String sValue
10202>>>        Get phFirstChild to hText
10203>>>        Get InfcNodeValue hText to sValue
10204>>>        Function_Return sValue        
10205>>>    End_Function
10206>>>     
10206>>>    // Use this to call the internal Text property. This returns all text for all child
10206>>>    // node. You rarely would want to do this. The is uses the msxml psText which can 
10206>>>    // get slow with very large files. If for some reason you need all of the child node's
10206>>>    // text and the file is large, you might want to consider doing this process manually.
10206>>>    Function AllChildNodesText Returns String
10208>>>        String sValue
10208>>>        Forward Get psText to sValue
10210>>>        Function_Return sValue        
10211>>>    End_Function
10212>>>    
10212>>>    // return the interface NodeValue without having to create a
10212>>>    // new object. This also disposes the hInfc interface
10212>>>    Function InfcNodeValue Handle hInfc Returns String
10214>>>        Integer hoDocument hoTempNode
10214>>>        String sValue
10214>>>        If (hinfc) Begin
10216>>>            Get DocumentObject to hoDocument
10217>>>            Get phoTempDomNode of hoDocument to hoTempNode
10218>>>            Set XMLInterface of hoTempNode to hInfc
10219>>>            Get psNodeValue of hoTempNode to sValue
10220>>>            // This disposes of hInfc which was passed in. After
10220>>>            // calling this you can no longer use it (which is good).
10220>>>            Set XMLInterface of hoTempNode to 0
10221>>>        End
10221>>>>
10221>>>        Function_Return sValue
10222>>>    End_Function
10223>>>    
10223>>>    // ChildNodeValue is used to get the "value" of an element. This is useful when the element
10223>>>    // only has a single value (similar to an attribute).
10223>>>    
10223>>>    Function ChildNodeValue String sTagName Returns String
10225>>>        Integer hoTempNode hoDocument
10225>>>        Integer hinfcTempNode 
10225>>>        String sRetVal
10225>>>        Get SelectSingleNode sTagName to hinfcTempNode
10226>>>        If (hinfcTempNode <> 0) Begin
10228>>>            Get DocumentObject to hoDocument
10229>>>            Get phoTempDomNode of hoDocument to hoTempNode
10230>>>            Set XMLInterface of hoTempNode to hinfcTempNode
10231>>>            Get phFirstChild of hoTempNode to hinfcTempNode
10232>>>            Set XMLInterface of hoTempNode to 0
10233>>>            If hinfcTempNode Begin
10235>>>                Get InfcNodeValue hinfcTempNode to sRetVal
10236>>>            End
10236>>>>
10236>>>        End
10236>>>>
10236>>>        Function_Return sRetVal
10237>>>    End_Function
10238>>>
10238>>>    // This simple function allows a parent to change the text of one of its elements.
10238>>>    // This actually occurs quite a bit, because (as stated above) lowest level
10238>>>    // elements are frequently used as properties.
10238>>>    //
10238>>>    Procedure SetChildNodeValue String sTagName String sValue
10240>>>        Integer hoTempNode
10240>>>        Integer hinfcTempNode
10240>>>        // Search for the node that matches.
10240>>>        Get SelectSingleNode sTagName to hinfcTempNode
10241>>>        // If no match is found, add a new element with the tag.
10241>>>        If (hinfcTempNode = 0) ;            Send AddElement sTagName sValue
10244>>>        Else Begin
10245>>>            Get CreateXMLObject U_BaseXMLDOMNode hinfcTempNode to hoTempNode
10246>>>            If hoTempNode Begin
10248>>>                // Set the text of the element.
10248>>>                Set psText of hoTempNode to sValue
10249>>>                Send Destroy to hoTempNode
10250>>>            End
10250>>>>
10250>>>            Else ;                Error DFERR_XML_INTERNAL_ERROR (SFormat(C_$XmlMethodFailure, "msg_SetChildNodeValue"))
10252>>>        End
10252>>>>
10252>>>    End_Procedure
10253>>>
10253>>>    // These messages are used to allow you to travese through a nodes.
10253>>>
10253>>>    Function FirstChild Returns Handle
10255>>>        Handle hoChild
10255>>>        Integer hinfcChild
10255>>>        Get phFirstChild  to hinfcChild
10256>>>        If (hinfcChild) ;            Get CreateXMLNode hinfcChild to hoChild
10259>>>        Function_Return hoChild
10260>>>    End_Function
10261>>>
10261>>>    Function NextSibling Returns Handle
10263>>>        Handle hoChild
10263>>>        Integer hinfcChild
10263>>>        Get phNextSibling  to hinfcChild
10264>>>        If (hinfcChild) ;            Get CreateXMLNode hinfcChild to hoChild
10267>>>        Function_Return hoChild
10268>>>    End_Function
10269>>>
10269>>>    Function PreviousSibling Returns Handle
10271>>>        Handle hoChild
10271>>>        Integer hinfcChild
10271>>>        Get phPreviousSibling  to hinfcChild
10272>>>        If (hinfcChild) ;            Get CreateXMLNode hinfcChild to hoChild
10275>>>        Function_Return hoChild
10276>>>    End_Function
10277>>>
10277>>>    Function LastChild Returns Handle
10279>>>        Handle hoChild
10279>>>        Integer hinfcChild
10279>>>        Get phLastChild  to hinfcChild
10280>>>        If (hinfcChild) ;            Get CreateXMLNode hinfcChild to hoChild
10283>>>        Function_Return hoChild
10284>>>    End_Function
10285>>>
10285>>>    // return an object that is the parent of the current node
10285>>>    Function ParentNode Returns Handle
10287>>>        Handle hoId
10287>>>        Handle hinfcXMLInterface
10287>>>        Get phParentNode to hinfcXMLInterface
10288>>>        If (hinfcXMLInterface) ;            Get CreateXmlNode hinfcXMLInterface to hoID
10291>>>        Function_Return hoID
10292>>>    End_Function
10293>>>
10293>>>    // Same as NextSibling except it uses or destroys the current node
10293>>>    //
10293>>>    // optimized version does not destroy/create object unless it needs to.  
10293>>>    // if the next node is the same node type we will resuse this object
10293>>>    // else this object is destroyed 
10293>>>    Function NextNode Returns Handle
10295>>>        Handle hoNode hoDocument
10295>>>        Handle hInfc
10295>>>        Get phNextSibling to hInfc
10296>>>        If hInfc Begin
10298>>>            Get DocumentObject to hoDocument
10299>>>            Move Self to hoNode
10300>>>            Send BindXMLInfc of hoDocument hInfc (&hoNode)
10301>>>        End
10301>>>>
10301>>>        Else Begin
10302>>>            Send Destroy
10303>>>            Move 0 to hoNode
10304>>>        End
10304>>>>
10304>>>        Function_Return hoNode
10305>>>    End_Function
10306>>>        
10306>>>        
10306>>>    // Enumerate through all nodes.
10306>>>
10306>>>    Procedure EnumerateNodes Integer iMsg Integer hoReceiver String sVal1 String sVal2
10308>>>        Integer i iLen
10308>>>        Integer hoNode
10308>>>        Integer hoNodeCollection
10308>>>        Get ChildNodes to hoNodeCollection
10309>>>        If (hoNodeCollection <> 0) Begin
10311>>>            Get NodeListLength of hoNodeCollection to iLen
10312>>>            Decrement iLen
10313>>>            For i from 0 to iLen
10319>>>>
10319>>>                // For each record, process its fields.
10319>>>                Get CollectionNode of hoNodeCollection i to hoNode
10320>>>                Send iMsg of hoReceiver hoNode sVal1 sVal2
10321>>>                Send Destroy of hoNode
10322>>>            Loop
10323>>>>
10323>>>            Send Destroy of hoNodeCollection
10324>>>        End
10324>>>>
10324>>>    End_Procedure
10325>>>
10325>>>    // Enumerate through all elements.
10325>>>
10325>>>    Procedure EnumerateElements Integer iMsg Integer hoReceiver String sVal1 String sVal2
10327>>>        Integer i iLen
10327>>>        Integer hoNode
10327>>>        Integer hoNodeCollection
10327>>>        Get ChildNodes to hoNodeCollection
10328>>>        If (hoNodeCollection <> 0) Begin
10330>>>            Get NodeListLength of hoNodeCollection to iLen
10331>>>            Decrement iLen
10332>>>            For i from 0 to iLen
10338>>>>
10338>>>                // For each record, process its fields.
10338>>>                Get CollectionNode of hoNodeCollection i to hoNode
10339>>>                If (piNodeType(hoNode)=NODE_ELEMENT) ;                    Send iMsg of hoReceiver hoNode sVal1 sVal2
10342>>>                Send Destroy of hoNode
10343>>>            Loop
10344>>>>
10344>>>            Send Destroy of hoNodeCollection
10345>>>        End
10345>>>>
10345>>>    End_Procedure
10346>>>
10346>>>
10346>>>    // enumerate through all attributes. There is no recurse here because attributes will not
10346>>>    // contain attributes.
10346>>>
10346>>>    Procedure EnumerateAttributes Integer iMsg Integer hoReceiver String sSomeValue
10348>>>        Integer i iLen
10348>>>        Integer hoNode
10348>>>        Integer hoNodeMapCollection
10348>>>        // we don't use tempattributenodes because we don't know what the enum message will do.
10348>>>        Get AttributeNodes to hoNodeMapCollection
10349>>>        If (hoNodeMapCollection <> 0) Begin
10351>>>            Get NodeListLength of hoNodeMapCollection to iLen
10352>>>            Decrement iLen
10353>>>            For i from 0 to iLen
10359>>>>
10359>>>                // For each record, process its fields.
10359>>>                Get CollectionNode of hoNodeMapCollection i to hoNode
10360>>>                Send iMsg of hoReceiver hoNode sSomeValue
10361>>>                Send Destroy of hoNode
10362>>>            Loop
10363>>>>
10363>>>            Send Destroy of hoNodeMapCollection
10364>>>        End
10364>>>>
10364>>>    End_Procedure
10365>>>
10365>>>
10365>>>    Function XSLTransformation Integer hoXSLDocument Returns String
10367>>>        Integer infcXSLStartAt
10367>>>        String sBuffer
10367>>>        // Transformation is of current object using passed XSLDocument.
10367>>>        Get XMLInterface of hoXSLDocument to infcXSLStartAt
10368>>>        Get TransformNode infcXSLStartAt to sBuffer
10369>>>        Function_Return sBuffer
10370>>>    End_Function
10371>>>
10371>>>    // This allows for transformations not limited to the size of the string buffer
10371>>>    //
10371>>>    // Note that it is up to the programmer to dispose of the memory allocated at pBuffer
10371>>>    // by using the free(pBuffer) function
10371>>>    //
10371>>>    Function XSLTransformationToAddress Integer hoXSLDocument Returns Address
10373>>>        Integer infcXSLStartAt
10373>>>        Address pBuffer
10373>>>        // Transformation is of current object using passed XSLDocument.
10373>>>        Get XMLInterface of hoXSLDocument to infcXSLStartAt
10374>>>        Get TransformNodeToAddress infcXSLStartAt to pBuffer
10375>>>        Function_Return pBuffer
10376>>>    End_Function
10377>>>
10377>>>
10377>>>    // extract base name from string. e.g.: ns:name --> name
10377>>>    //
10377>>>    Function BaseNameFromQName String sName Returns String
10379>>>        Integer iPos
10379>>>        Move (Pos(":",sName)) to iPos
10380>>>        If iPos Begin
10382>>>            Move (remove(sName,1,iPos)) to sName
10383>>>        End
10383>>>>
10383>>>        Function_Return sName
10384>>>    End_Function
10385>>>
10385>>>    // extract prefix name from string. e.g.: ns:name --> ns
10385>>>    //
10385>>>    Function PrefixNameFromQName String sName Returns String
10387>>>        String sPreFix
10387>>>        Integer iPos
10387>>>        Move (Pos(":",sName)) to iPos
10388>>>        If iPos Begin
10390>>>            Move (Left(sName,iPos-1)) to sPreFix
10391>>>        End
10391>>>>
10391>>>        Function_Return sPreFix
10392>>>    End_Function
10393>>>
10393>>>
10393>>>    // Returns true if node is element and namespace and base name match
10393>>>    //
10393>>>    Function IsElementNS String sNamespaceURI String sBaseName Returns Boolean
10395>>>         Function_Return (piNodeType(Self)=NODE_ELEMENT and ;                          psNameSpaceURI(Self)=sNamespaceURI and ;                          psBaseName(Self)=sBaseName )
10396>>>    End_Function
10397>>>
10397>>>    // Returns node of first occurence of child node matching namespace and base name
10397>>>    //
10397>>>    Function ChildElementNS String sNameSpaceURI String sBaseName Returns Handle
10399>>>        Handle hoNode
10399>>>        Get FirstChild to hoNode
10400>>>        While (hoNode and not(IsElementNS(hoNode, sNameSpaceURI, sBaseName)))
10404>>>            Get NextNode of hoNode to hoNode
10405>>>        End
10406>>>>
10406>>>        Function_Return hoNode
10407>>>    End_Function
10408>>>
10408>>>    // Returns node of next occurence of sibling node matching namespace and base name
10408>>>    // and destroys the current node.
10408>>>//    Function NextElementNS String sNameSpaceURI String sBaseName Returns Handle
10408>>>//        handle hoNode
10408>>>//        Get NextSibling to hoNode
10408>>>//        While (hoNode and not(IsElementNS(hoNode, sNameSpaceURI, sBaseName)))
10408>>>//            Get NextNode of hoNode to hoNode
10408>>>//        end
10408>>>//        Send Destroy
10408>>>//        function_return hoNode
10408>>>//    end_function
10408>>>
10408>>>    Function NextElementNS String sNameSpaceURI String sBaseName Returns Handle
10410>>>        Handle hoNode
10410>>>        // NextNode may return the same object or it may destroy the object and
10410>>>        // return nothing or a different object
10410>>>        Get NextNode to hoNode
10411>>>        While (hoNode and not(IsElementNS(hoNode, sNameSpaceURI, sBaseName)))
10415>>>            // use of hoNode is required. This can be different than self
10415>>>            Get NextNode of hoNode to hoNode
10416>>>        End
10417>>>>
10417>>>         
10417>>>        Function_Return hoNode
10418>>>    End_Function
10419>>>
10419>>>
10419>>>    // Returns value (string) first occurence of child node matching namespace and base name
10419>>>    //
10419>>>    Function ChildElementValueNS String sNameSpaceURI String sBaseName Returns String
10421>>>        Handle hoNext
10421>>>        String sText
10421>>>        Get ChildElementNS sNameSpaceURI sBaseName to hoNext
10422>>>        If hoNext Begin
10424>>>            Get psText of hoNext to sText
10425>>>            Send destroy of hoNext
10426>>>        End
10426>>>>
10426>>>        Function_Return sText
10427>>>    End_Function
10428>>>
10428>>>    Procedure SetChildElementValueNS String sNameSpaceURI String sBaseName String sValue
10430>>>        Integer hoNode
10430>>>        Integer hinfcTempNode
10430>>>        Get ChildElementNS sNameSpaceURI sBaseName to hoNode
10431>>>        If (hoNode=0) Begin
10433>>>            Send AddElementNS sNameSpaceURI sBaseName sValue
10434>>>        End
10434>>>>
10434>>>        Else Begin
10435>>>            Set psText of hoNode to sValue
10436>>>            Send destroy of hoNode
10437>>>        End
10437>>>>
10437>>>    End_Procedure
10438>>>
10438>>>
10438>>>//    // Returns node of first occurence of child node matching namespace and base name
10438>>>//    // that has an attrib value that contains a specified value
10438>>>//    //
10438>>>//    //Doc/ Visibility=Public
10438>>>//    Function FindElementNodeWithAttribNS string sNamespace string sBaseName string sAttribName string sAttribValue returns handle
10438>>>//        handle hoNext hoNode
10438>>>//        string sName
10438>>>//        Get FirstChild to hoNode
10438>>>//        While (hoNode)
10438>>>//            If (IsElementNS(hoNode, sNameSpace, sBaseName)) begin
10438>>>//                Get AttributeValue of hoNode sAttribName to sName
10438>>>//                If (sName=sAttribValue) Begin
10438>>>//                    Function_return hoNode
10438>>>//                end
10438>>>//            end
10438>>>//            Get NextSibling of hoNode to hoNext
10438>>>//            Send Destroy of hoNode
10438>>>//            Move hoNext to hoNode
10438>>>//        end
10438>>>//        function_return 0
10438>>>//    end_function
10438>>>
10438>>>    // pass a prefix and try to finds its NameSpaceURI. Start at current node and work up to parent.
10438>>>    // This can be useful when a qualified name is found in an attribute value
10438>>>    //
10438>>>    Function PrefixToNamespaceURI String sPrefix Returns String
10440>>>        Handle hoNode
10440>>>        Integer i iNodes
10440>>>        Integer hoNodes hoParentNode hoAttNode
10440>>>        Boolean bDone bParent
10440>>>        String sAttPrefix sName sNameSpace
10440>>>
10440>>>        Move Self to hoNode
10441>>>        While not bDone
10445>>>            Get TempAttributeNodes of hoNode to hoNodes
10446>>>            If (hoNodes <> 0) Begin
10448>>>                Get NodeListLength of hoNodes to iNodes
10449>>>                For i from 0 to (iNodes-1)
10455>>>>
10455>>>                    // For each record, process its fields.
10455>>>                    Get CollectionNode of hoNodes i to hoAttNode
10456>>>                    Get psPrefix of hoAttNode to sAttPrefix
10457>>>                    Get psBaseName of hoAttNode to sName
10458>>>                    // with legacy msxml, xmlns="foo" returns psPrefix="xmlns" and pbBaseName=""
10458>>>                    // with newer msxml, xmlns="foo" returns psPrefix="" and pbBaseName="xmlns"
10458>>>                    // We handle both cases here. 
10458>>>                    
10458>>>                    If ( (sAttPrefix="xmlns" and sName=sPrefix) or ; // if a normal xmlns:xx="foo" match (sPrefix="xx") or a legacy xmlns="foo" match (sPrefix="")                         (sPrefix="" and sAttPrefix="" and sName="xmlns") ) Begin // special test for newer msxml xmlns="foo" match (sPrefix="")
10460>>>
10460>>>                        Get Value of hoAttNode to sNameSpace
10461>>>                        Move True to bDone
10462>>>                        Move (iNodes-1) to i
10463>>>
10463>>>                    End
10463>>>>
10463>>>
10463>>>                    Send Destroy of hoAttNode
10464>>>                Loop
10465>>>>
10465>>>                Set XMLInterface of hoNodes to 0
10466>>>            End
10466>>>>
10466>>>            
10466>>>            Get ParentNode of hoNode to hoParentNode
10467>>>            If bParent Send destroy of hoNode
10470>>>            If not bDone Begin
10472>>>                If not hoParentNode Move True to bDone
10475>>>                Else Begin
10476>>>                    Move True to bParent
10477>>>                    Move hoParentNode to hoNode
10478>>>                End
10478>>>>
10478>>>            End
10478>>>>
10478>>>        End
10479>>>>
10479>>>        Function_Return sNameSpace
10480>>>    End_Function
10481>>>
10481>>>
10481>>>
10481>>>End_Class
10482>>>
10482>>>// Set up basic inheritance for specialized forms of XML classes.
10482>>>// This needs to be done so we can make objects of these types.
10482>>>
10482>>>Class cXMLDOMElement is a BaseXmlDomElement
10483>>>    Import_Class_Protocol cXMLDOMNodeMixin
10484>>>
10484>>>// Send AddAttribute
10484>>>// Get  AddAttributeNode
10484>>>// Send RemoveAttribute
10484>>>// Get  AttributeValue
10484>>>// Get  AttributeValueNode
10484>>>
10484>>>// Send AddAttributeNS
10484>>>// Get  AddAttributeNodeNS
10484>>>// Send RemoveAttributeNs
10484>>>// Get  AttributeValueNS
10484>>>// Get  AttributeValueNodeNS
10484>>>
10484>>>    // Should use AddAttributeValue...does same thing
10484>>>    Procedure SetAttributeValue String sName String sValue
10486>>>        Send AddAttribute sName sValue
10487>>>    End_Procedure
10488>>>
10488>>>    // Note: Get_AttributeValue already there
10488>>>
10488>>>    Procedure RemoveAttribute String sName
10490>>>        Integer iVal
10490>>>        Get RemoveAttribute sName to iVal
10491>>>    End_Procedure
10492>>>
10492>>>    Function AttributeValueNS String sNameSpace String sBaseName Returns String
10494>>>        String sValue
10494>>>        Handle hinfcItem
10494>>>        Handle hoDoc hoTempAttributeNodes hoNode
10494>>>        Integer hinfcAttributes
10494>>>        
10494>>>//        // test if the basename attribute exists at all. This is an opimization as this
10494>>>//        // message is much faster allowing for quicker false matches (good for client web-services).
10494>>>//        Get AttributeValue sBaseName to sValue // doesn't work as expected
10494>>>//        If (sValue<>"") Begin 
10494>>>            Get TempAttributeNodes to hoTempAttributeNodes
10495>>>            Get QualifiedItem of hoTempAttributeNodes sBaseName sNameSpace  to hinfcItem
10496>>>            Set XMLInterface of hoTempAttributeNodes to 0
10497>>>            If hinfcItem Begin
10499>>>                Get DocumentObject to hoDoc
10500>>>                Get phoTempDomNode of hoDoc to hoNode
10501>>>                Set XMLInterface of hoNode to hinfcItem
10502>>>                Get psNodeValue of hoNode to sValue
10503>>>                Set XMLInterface of hoNode to 0
10504>>>            End
10504>>>>
10504>>>//        End
10504>>>        Function_Return sValue
10505>>>    End_Function
10506>>>
10506>>>// replaced with optimized version above
10506>>>//    Function AttributeValueNS String sNameSpace String sBaseName Returns String
10506>>>//        Handle hoAttr
10506>>>//        String sValue
10506>>>//
10506>>>//        Get AttributeValueNodeNS sNameSpace sBaseName to hoAttr
10506>>>//        If hoAttr Begin
10506>>>//            Get Value of hoAttr to sValue
10506>>>//            Send destroy of hoAttr
10506>>>//        End
10506>>>//        function_return sValue
10506>>>//    end_function
10506>>>
10506>>>    Procedure RemoveAttributeNS String sNameSpace String sBaseName
10508>>>        Handle hoAttrs hoAttr
10508>>>        String sValue
10508>>>        Get TempAttributeNodes to hoAttrs
10509>>>        If hoAttrs Begin
10511>>>            Get RemoveQualifiedNode of hoAttrs sNamespace sBaseName to hoAttr
10512>>>            Set XMLInterface of hoAttrs to 0
10513>>>            If hoAttr ;                Send destroy of hoAttr
10516>>>        End
10516>>>>
10516>>>    End_Procedure
10517>>>
10517>>>End_Class
10518>>>
10518>>>Class cXMLDOMNode is a BaseXmlDomNode
10519>>>    Import_Class_Protocol cXMLDOMNodeMixin
10520>>>End_Class
10521>>>
10521>>>Class cXMLDOMAttribute is a BaseXmlDomAttribute
10522>>>    Import_Class_Protocol cXMLDOMNodeMixin
10523>>>End_Class
10524>>>
10524>>>Class cXMLDOMComment is a BaseXmlDomComment
10525>>>    Import_Class_Protocol cXMLDOMNodeMixin
10526>>>End_Class
10527>>>
10527>>>Class cXMLDOMProcessingInstruction is a BaseXmlDomProcessingInstruction
10528>>>    Import_Class_Protocol cXMLDOMNodeMixin
10529>>>End_Class
10530>>>
10530>>>Class cXMLDOMTextNode is a BaseXmlDomTextNode
10531>>>    Import_Class_Protocol cXMLDOMNodeMixin
10532>>>End_Class
10533>>>
10533>>>Class cXMLDOMCDATASection is a BaseXmlDomCDATASection
10534>>>    Import_Class_Protocol cXMLDOMNodeMixin
10535>>>End_Class
10536>>>
10536>>>Class cXMLDOMDocumentType is a BaseXmlDomDocumentType
10537>>>    Import_Class_Protocol cXMLDOMNodeMixin
10538>>>    
10538>>>
10538>>>//        Function EnumerateEntities Integer iMsg Integer hoReceiver Integer bEnumerate Integer iSomeValue Returns Handle
10538>>>//            Integer i
10538>>>//            Integer hoNode
10538>>>//            Integer hoNamedNodeMap
10538>>>//            Integer hinfcNamedNodeMap
10538>>>//            Integer iLength
10538>>>
10538>>>//            Get phEntities To hinfcNamedNodeMap
10538>>>
10538>>>//            showln "The interface of the named node map is " hinfcNamedNodeMap
10538>>>
10538>>>//            If (hinfcNamedNodeMap <> 0) Begin
10538>>>//                Get CreateXMLObject U_cXMLDOMNamedNodeMap hinfcNamedNodeMap to hoNamedNodeMap
10538>>>//                Get piLength Of hoNamedNodeMap To iLength
10538>>>//                Showln "There are " iLength " items in map"
10538>>>
10538>>>//                ///                For i From 0 To (NodeListLength(hoNamedNodeMap)-1)
10538>>>//                ///                    // For each record, process its fields.
10538>>>//                //                    Get CollectionNode Of hoNamedNodeMap i To hoNode
10538>>>//                //                    Send iMsg Of hoReceiver hoNode bEnumerate iSomeValue
10538>>>//                //                    Send Destroy_Object Of hoNode
10538>>>//                //                Loop
10538>>>//            End
10538>>>//            Send Destroy To hoNamedNodeMap
10538>>>//            Function_Return 0
10538>>>//        End_Function
10538>>>
10538>>>//        Function EnumerateNotations Integer iMsg Integer hoReceiver Integer bEnumerate Integer iSomeValue Returns Handle
10538>>>//            Integer i
10538>>>//            Integer hoNode
10538>>>//            Integer hoNamedNodeMap
10538>>>//            Integer hinfcNamedNodeMap
10538>>>//            Integer iLength
10538>>>
10538>>>//            Object oNamedNodeMap Is A cXMLDOMNamedNodeMap
10538>>>//                Move Self To hoNamedNodeMap
10538>>>//            End_Object
10538>>>
10538>>>//            Get phNotations To hinfcNamedNodeMap
10538>>>
10538>>>//            showln "The interface of the named node map is " hinfcNamedNodeMap
10538>>>
10538>>>//            If (hinfcNamedNodeMap <> 0) Begin
10538>>>//                Set XMLInterface Of hoNamedNodeMap To hinfcNamedNodeMap
10538>>>//                Get piLength Of hoNamedNodeMap To iLength
10538>>>//                Showln "There are " iLength " items in map"
10538>>>
10538>>>/////                For i From 0 To (NodeListLength(hoNamedNodeMap)-1)
10538>>>/////                    // For each record, process its fields.
10538>>>////                    Get CollectionNode Of hoNamedNodeMap i To hoNode
10538>>>////                    Send iMsg Of hoReceiver hoNode bEnumerate iSomeValue
10538>>>////                    Send Destroy_Object Of hoNode
10538>>>////                Loop
10538>>>//            End
10538>>>//            Send Destroy_Object To hoNamedNodeMap
10538>>>//            Function_Return 0
10538>>>//        End_Function
10538>>>
10538>>>End_Class
10539>>>
10539>>>Class cXMLDOMNotation is a BaseXmlDomNotation
10540>>>    Import_Class_Protocol cXMLDOMNodeMixin
10541>>>End_Class
10542>>>
10542>>>Class cXMLDOMEntity is a BaseXmlDomEntity
10543>>>    Import_Class_Protocol cXMLDOMNodeMixin
10544>>>End_Class
10545>>>
10545>>>Class cXMLDOMEntityReference is a BaseXmlDomEntityReference
10546>>>    Import_Class_Protocol cXMLDOMNodeMixin
10547>>>End_Class
10548>>>
10548>>>Class cXMLDOMDocumentFragment is a BaseXmlDomDocumentFragment
10549>>>    Import_Class_Protocol cXMLDOMNodeMixin
10550>>>End_Class
10551>>>
10551>>>
10551>>>Class cXMLDOMParseError is a BaseXMLDomParseError
10552>>>    // returns an error sub-object as a sibling of this error object
10552>>>    Function ErrorItemNode Integer iItem Returns Handle
10554>>>        Handle hoParseErrorNode hoParent
10554>>>        Handle hParseErrorIntf
10554>>>        Get ErrorItem iItem to hParseErrorIntf
10555>>>        If (hParseErrorIntf) Begin
10557>>>            // add to parent in case developer destroys the current object
10557>>>            Get Parent to hoParent
10558>>>            Get Create of hoParent U_cXMLDOMParseError to hoParseErrorNode
10559>>>            Set XmlInterface of hoParseErrorNode to hParseErrorIntf
10560>>>        End
10560>>>>
10560>>>        Function_Return hoParseErrorNode
10561>>>    End_Function         
10562>>>End_Class
10563>>>
10563>>>// Base document class with Base functions.
10563>>>
10563>>>Class cXMLDOMDocument is an BaseXmlDomDocument
10564>>>
10564>>>    Import_Class_Protocol cXMLDOMNodeMixin
10565>>>
10565>>>    Procedure Construct_Object
10567>>>        Handle hInfc
10567>>>        Forward Send Construct_Object
10569>>>        Property String psDocumentName ""
10570>>>        Property Integer phPrivateDocumentElement 0
10571>>>        Property Handle phoTempDomNode (Create(Self,U_cXMLDomNode))
10572>>>        Property Handle phoTempDomNodeMap (Create(Self,U_cXMLDOMNamedNodeMap))
10573>>>        
10573>>>        // added in 15.1. If no COM pointer, msxml6 is most likely not installed. This will
10573>>>        // raise an unhandled error, which could be augmented to do something else.
10573>>>        Get XmlInterface to hInfc
10574>>>        If (hInfc=0) Begin
10576>>>            Send ErrorCreatingXMLObject
10577>>>        End
10577>>>>
10577>>>        
10577>>>        // as of 18.0 pbAsync now defaults to False. In most cases, this is what you want
10577>>>        Set pbAsync to False
10578>>>    End_Procedure
10579>>>
10579>>>    // returns the classId for the passed NodeType. This is a good augmentation point. All nodes
10579>>>    // within an xml document come here to get a class. So, if you want to augment and return a
10579>>>    // different class, just check the node type and return whatever -- else forward
10579>>>
10579>>>    Function NodeClassId Integer iType Returns Integer
10581>>>        Integer iClassId
10581>>>        Case Begin
10581>>>            Case (iType=NODE_ELEMENT)                   Move U_cXMLDOMElement      to iClassId
10584>>>            Case (iType=NODE_ATTRIBUTE)                 Move U_cXMLDOMAttribute    to iClassId
10588>>>            Case (iType=NODE_TEXT)                      Move U_cXMLDOMTextNode     to iClassId
10592>>>            Case (iType=NODE_CDATA_SECTION)             Move U_cXMLDOMCDATASection to iClassId
10596>>>            Case (iType=NODE_ENTITY_REFERENCE)          Move U_cXMLDOMEntityReference to iClassId
10600>>>            Case (iType=NODE_ENTITY)                    Move U_cXMLDOMEntity       to iClassId
10604>>>            Case (iType=NODE_PROCESSING_INSTRUCTION)    Move U_cXMLDOMProcessingInstruction to iClassId
10608>>>            Case (iType=NODE_COMMENT)                   Move U_cXMLDOMComment      to iClassId
10612>>>            Case (iType=NODE_DOCUMENT)                  Move U_cXMLDOMDocument     to iClassId
10616>>>            Case (iType=NODE_DOCUMENT_TYPE)             Move U_cXMLDOMDocumentType to iClassId
10620>>>            Case (iType=NODE_DOCUMENT_FRAGMENT)         Move U_cXMLDOMDocumentFragment to iClassId
10624>>>            Case (iType=NODE_NOTATION)                  Move U_cXMLDOMNotation     to iClassId
10628>>>            Case (iType=0)                              Move 0                     to iClassId // this is an error!!
10632>>>            Case Else                                   Move U_cXMLDOMNode         to iClassId
10634>>>        Case End
10634>>>        Function_Return iClassId
10635>>>    End_Function
10636>>>
10636>>>    // Load an XML Document. The name of the document is stored in a property
10636>>>    // that must be set for this function to work correctly.
10636>>>
10636>>>    Function LoadXMLDocument Returns Integer
10638>>>        String sDocumentName
10638>>>        Integer bRetVal
10638>>>        Get psDocumentName to sDocumentName
10639>>>        Get LoadDocument sDocumentName to bRetVal
10640>>>        If (bRetVal = 0);            Function_Return True
10643>>>        Else;            Function_Return False
10645>>>    End_Function
10646>>>
10646>>>    Function SaveXMLDocument Returns Integer
10648>>>        String sDocumentName
10648>>>        Integer bRetVal
10648>>>        Get psDocumentName to sDocumentName
10649>>>        Get SaveDocument sDocumentName to bRetVal
10650>>>        Function_Return bRetVal
10651>>>    End_Function
10652>>>
10652>>>    // Load an XML from a string. This aguments the C message to ret 1 if Ok and 0 if error.
10652>>>    //
10652>>>    Function LoadXML String sXML Returns Integer
10654>>>        Integer bRetVal
10654>>>        // for some reason the parser will not work properly with embedded double quotes.
10654>>>        // Change all " to ' in document.
10654>>>        //Move (replaces('"',sXML,"'")) to sXML  // removed this. Bad Idea.
10654>>>        Forward Get LoadXml sXML to bRetVal
10656>>>        If (bRetVal = 0) ;            Function_Return True
10659>>>        Else;            Function_Return False
10661>>>    End_Function
10662>>>
10662>>>    // Load an XML string from an address. This aguments the C message to ret 1 if Ok and 0 if error.
10662>>>    //
10662>>>    Function LoadXMLFromAddress Address pXML Returns Integer
10664>>>        Integer bRetVal
10664>>>        Forward Get LoadXmlFromAddress pXML to bRetVal
10666>>>        If (bRetVal = 0) ;            Function_Return True
10669>>>        Else;            Function_Return False
10671>>>    End_Function
10672>>>
10672>>>
10672>>>    // Allow Nodes and Node node lists to get the parent document.
10672>>>
10672>>>    Function DocumentObject Returns Handle
10674>>>        Function_Return Self
10675>>>    End_Function
10676>>>
10676>>>    // Access to the root node allows for searches and iterations.
10676>>>    // The root node is a cNode.
10676>>>
10676>>>    Function DocumentElement Returns Handle
10678>>>        Integer hNewNode       // Object ID of Root Node
10678>>>        Integer infcNode   // XML Element Interface
10678>>>// we used to buffer this so we'd always return the same object. This is dangerous. If the devloper
10678>>>// deletes the root and then creates some other object with this name, we will have problems. Now we
10678>>>// always create a new root now - which means you can create multiple roots (which is probably ok).
10678>>>
10678>>>//        Get phPrivateDocumentElement to hNewNode
10678>>>//        // if for some reason the developer sends destroy to the root element then
10678>>>//        // we must check that acutally exists. If not, create the root all over again
10678>>>//        Get Object_Id of hNewNode to hNewNode // if Object no longer exists, 0 is returned
10678>>>//        If not (hNewNode) Begin
10678>>>//            // Call XML to get the document root element.
10678>>>//            Get phDocumentElement To infcNode
10678>>>//            If infcNode Begin
10678>>>//                Get CreateXMLObject U_cXMLDOMElement infcNode to hNewNode
10678>>>//                Set phPrivateDocumentElement to hNewNode
10678>>>//            end
10678>>>//        End
10678>>>
10678>>>        Get phDocumentElement to infcNode
10679>>>        If infcNode Begin
10681>>>            Get CreateXMLObject U_cXMLDOMElement infcNode to hNewNode
10682>>>            Set phPrivateDocumentElement to hNewNode // we no longer use this at all
10683>>>        End
10683>>>>
10683>>>        Function_Return hNewNode
10684>>>    End_Function
10685>>>
10685>>>    //  CreateRootNode is used to set up the first element in a document.
10685>>>    //  It should only be used when creating new files.
10685>>>
10685>>>    Function CreateDocumentElement String sTagName Returns Handle
10687>>>        Integer hNewNode       // Object ID of Root Node
10687>>>        Integer infcNode   // XML Element Interface
10687>>>        // Call XML to create an element in the document.
10687>>>        Get CreateElement sTagName to infcNode
10688>>>        // Tie the element interface to the DataFlex object.
10688>>>        If infcNode ;            Get CreateXMLObject U_cXMLDOMElement infcNode to hNewNode
10691>>>        // Call XML to set the root element of the document.
10691>>>        Set phDocumentElement to infcNode
10692>>>        Set phPrivateDocumentElement to hNewNode
10693>>>        Function_Return hNewNode
10694>>>    End_Function
10695>>>
10695>>>    Function CreateDocumentElementNS String sNamespace String sTagName Returns Handle
10697>>>        Integer hNewNode       // Object ID of Root Node
10697>>>        Integer infcNode iType  // XML Element Interface
10697>>>        Get CreateElementNodeNS sNameSpace sTagName "" to hNewNode
10698>>>        Get XmlInterface of hNewNode to infcNode
10699>>>        Set phDocumentElement to infcNode
10700>>>        Set phPrivateDocumentElement to hNewNode
10701>>>        Function_Return hNewNode
10702>>>    End_Function
10703>>>
10703>>>
10703>>>
10703>>>    // return the DocType as a document-type object. Returns 0 if no dtd
10703>>>    // Access to information from the doc type object is limited. Use get psXML
10703>>>    Function DocTypeNode Returns Handle
10705>>>        Handle hinfcDocType hoDocType
10705>>>        Get phDocType to hinfcDocType
10706>>>        If hinfcDocType ;            Get CreateXMLObject U_cXMLDOMDocumentType hinfcDocType to hoDocType
10709>>>        Function_Return hoDocType
10710>>>    End_Function
10711>>>
10711>>>    Function phXMLErrorObject Returns Handle
10713>>>        Integer hoParseErrorObject
10713>>>        Integer hInfcParseError
10713>>>        Get phParseError to hInfcParseError
10714>>>        If hInfcParseError ;            Get CreateXMLObject U_cXMLDOMParseError hinfcParseError to hoParseErrorObject
10717>>>        Function_Return hoParseErrorObject
10718>>>    End_Function
10719>>>
10719>>>    //  The following procedure is meant to be overridden by one provided by the developer.
10719>>>
10719>>>    Procedure BasicParseErrorReport
10721>>>        String sProblem
10721>>>        String sLinePosition
10721>>>        String sDescr
10721>>>        String sReason
10721>>>        String sSource
10721>>>        Integer hoParseErrorObject
10721>>>        Get phXMLErrorObject to hoParseErrorObject
10722>>>        If hoParseErrorObject Begin
10724>>>            Move (SFormat(C_$CannotLoad, psDocumentName(Self)) + "."+character(13)+character(10)) to sProblem
10725>>>            Move (SFormat(C_$ParsingError, piLine(hoParseErrorObject), piLinePos(hoParseErrorObject))) to sLinePosition
10726>>>            Move (sLinePosition +character(13)+character(10)) to sLinePosition
10727>>>
10727>>>            Move (C_$Reason + ":" * (psReason(hoParseErrorObject))  +character(13)+character(10)) to sReason
10728>>>            Move (C_$Source + ":" * (psSrcText(hoParseErrorObject))) to sSource
10729>>>            Move (sProblem + sLinePosition + sReason + sSource) to sDescr
10730>>>            Error DFERR_XML_INTERNAL_ERROR sDescr
10731>>>>
10731>>>            Send Destroy of hoParseErrorObject
10732>>>        End
10732>>>>
10732>>>        Else ;            Error DFERR_XML_INTERNAL_ERROR C_$NotCreatedParseObject
10734>>>    End_Procedure
10735>>>
10735>>>    // bind an xml interface node to the passed XML object. If the
10735>>>    // object type is of the wrong type, we will destroy it and recreate it
10735>>>    // which is why hoNode is passed byRef.
10735>>>    // to use this you'd have to use the lower level private messages to get the
10735>>>    // xml interface handles and then bind them to an object. Just like in COM you could
10735>>>    // bind these to the same object, which might save some parsing time. This is made private
10735>>>    // because the time savings would probably be small and would not justify the extra
10735>>>    // complexity.
10735>>>    // It is a programming error to pass this a zero handle.
10735>>>    Procedure BindXMLInfc Handle hInfc Handle ByRef hoNode
10737>>>        Integer iType iClassId iType2
10737>>>        Get piNodeType of hoNode to iType2 // type of the DF XML object
10738>>>        
10738>>>        // Get the node type of the infc handle w/o creating a DF object
10738>>>        Move (invokexml(DF_IXMLDOMNODE, GET_piNodeType, hinfc, 0, 0, 0, 0)) to iType
10739>>>        Move (invokexml(DF_IXMLDOMNODE, GET_ChangeNodeType, hinfc, iType, 1, 0, 0)) to hInfc
10740>>>        If (hinfc=0) Begin
10742>>>            // this should not happen and we would need to know about this.
10742>>>            Error DFERR_XML_INTERNAL_ERROR (C_$XmlFailedNoDocObject + String(iType))
10743>>>>
10743>>>            Function_Return 0
10744>>>        End
10744>>>>
10744>>>        // if the type is the same we can reuse the current object and binding it to the interface pointer
10744>>>        If (iType=iType2) Begin
10746>>>            // resuse Self and return
10746>>>            Set XMLInterface of hoNode to hInfc
10747>>>        End
10747>>>>
10747>>>        // if diffrent type, destroy the existing object and recreate it
10747>>>        Else Begin
10748>>>            Send Destroy of hoNode
10749>>>            Get NodeClassId iType to iClassId
10750>>>            Get CreateXMLObject iClassId hInfc to hoNode
10751>>>        End
10751>>>>
10751>>>    End_Procedure
10752>>>    
10752>>>    Function ValidateDocument Returns Handle
10754>>>        Handle hParseErrorIntf hoParseError
10754>>>        Forward Get ValidateDocument to hParseErrorIntf
10756>>>        If hParseErrorIntf Begin
10758>>>            Get CreateXMLObject U_cXMLDOMParseError hParseErrorIntf to hoParseError
10759>>>        End
10759>>>>
10759>>>        Function_Return hoParseError
10760>>>    End_Function
10761>>>    
10761>>>    Function AddExternalSchemaDocument String sSchema Handle hoSchema Returns Boolean
10763>>>        Handle hInfc
10763>>>        Boolean bOk
10763>>>        Get XmlInterface of hoSchema to hInfc
10764>>>        Forward Get AddExternalSchemaDocument sSchema hInfc to bOk
10766>>>        Function_Return (not(bOk))
10767>>>    End_Function
10768>>>        
10768>>>    Function AddExternalSchemaFile String sSchema String sFile Returns Boolean
10770>>>        Boolean bOk
10770>>>        Forward Get AddExternalSchemaFile sSchema sFile to bOk
10772>>>        Function_Return (not(bOk))
10773>>>    End_Function
10774>>>
10774>>>    Procedure Set psSelectionNamespaces String sNamespaces
10776>>>        Set psDomSecondLevelProperty "SelectionNamespaces" to sNamespaces
10777>>>    End_Procedure
10778>>>
10778>>>    Function psSelectionNamespaces Returns String
10780>>>        String  sNamespaces
10780>>>        Get psDomSecondLevelProperty "SelectionNamespaces" to sNamespaces
10781>>>        Function_Return sNamespaces
10782>>>    End_Function
10783>>>    
10783>>>    Procedure Set pbMultipleErrorMessages Boolean bMultipleErrors
10785>>>        Set pbDomSecondLevelProperty "MultipleErrorMessages" to bMultipleErrors
10786>>>    End_Procedure
10787>>>
10787>>>    Function pbMultipleErrorMessages Returns Boolean
10789>>>        Boolean bMultipleErrors
10789>>>        Get pbDomSecondLevelProperty "MultipleErrorMessages" to bMultipleErrors
10790>>>        Function_Return bMultipleErrors
10791>>>    End_Function
10792>>>    
10792>>>    Procedure ErrorCreatingXMLObject
10794>>>        Error DFERR_XML_INTERNAL_ERROR "Could not create XML COM object. MSXML6 may not be properly installed and registered."
10795>>>>
10795>>>    End_Procedure
10796>>>    
10796>>>    // returns the last parse error. If 0, you know everything parsed. This can be
10796>>>    // used along wit pbReadyState to load XML documents in async mode. 
10796>>>    Function LastParseError Returns Integer
10798>>>        Integer iErr
10798>>>        Handle hoParseErrorReport
10798>>>        Get phXMLErrorObject to hoParseErrorReport
10799>>>        Get piErrorCode of hoParseErrorReport to iErr
10800>>>        Send Destroy of hoParseErrorReport 
10801>>>        Function_Return iErr
10802>>>    End_Function
10803>>>    
10803>>>
10803>>>End_Class
10804>>>
10804>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cli.pkg)
10804>>>//*****************************************************************************
10804>>>//*** CLI.PKG                                                               ***
10804>>>//***                                                                       ***
10804>>>//*** Author: Ben Weijers                                                   ***
10804>>>//***         Data Access Nederland                                         ***
10804>>>//***         10 September 1998                                             ***
10804>>>//***                                                                       ***
10804>>>//*** Purpose:                                                              ***
10804>>>//***   CLI specific functionality. There are several connectivity kits     ***
10804>>>//***   based on  SQL/92 CLI. Those are:                                    ***
10804>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
10804>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
10804>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
10804>>>//***                                                                       ***
10804>>>//***   This package defines the common functionality for all CLI based     ***
10804>>>//***   drivers.                                                            ***
10804>>>//***                                                                       ***
10804>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
10804>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
10804>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
10804>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
10804>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
10804>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
10804>>>//***             Added SQLSERVER2012CLIENT return value for                ***
10804>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
10804>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
10804>>>//***             Moved SQL Server client constants from cli.pkg to         ***
10804>>>//***             mssqldrv.pkg                                              ***
10804>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
10804>>>//***             Added type mappings attributes                            ***
10804>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
10804>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
10804>>>//***   Updated:  april 29, 2016 (Current CK build: 6.2.0.4)                ***
10804>>>//***             Added DF_INDEX_SQL_TYPE attribute                         ***
10804>>>//***   Updated:  May 4, 2016 (Current CK build: 6.2.0.5)                   ***
10804>>>//***             Added DF_FILE_RESTRUCTURE_INT_ONLY attribute              ***
10804>>>//***   Updated:  May 20, 2016 (Current CK build: 6.2.0.6)                  ***
10804>>>//***             Added DF_INDEX_NUMBER attribute                           ***
10804>>>//***   Updated:  June 17, 2016 (Current CK build: 6.2.0.9)                 ***
10804>>>//***             Added DF_INDEX_TEMPORARY as possible value for            ***
10804>>>//**              DF_INDEX_SQL_TYPE attribute                               ***
10804>>>//***   Updated:  August 16, 2016 (Current CK build: 6.2.0.16)              ***
10804>>>//***             Added DF_DATABASE_DEFAULT_DATABASE attribute              ***
10804>>>//***             Added RedirectIdConnectString function                    ***  
10804>>>//***   Updated:  September 1, 2016 (Current CK build: 6.2.0.19)            ***
10804>>>//***             Added DF_FILE_ALLOWED_STRUCTURE_CHANGES attribute         ***
10804>>>//***   Updated:  November 25, 2016 (Current CK build: 6.2.0.24)            ***
10804>>>//***             Removed double ifdef                                      ***
10804>>>//***   Updated:  Januari, 2017 (Current CK build: 6.2.0.26)                ***
10804>>>//***             Function TableComment: changed max length to 1024         ***
10804>>>//***   Updated:  July, 2017 (Current CK build: 6.2.0.39)                   ***
10804>>>//***             DF_INDEX_TEMPORARY had wrong value                        ***
10804>>>//*****************************************************************************
10804>>>
10804>>>//*** We are not using ifndef below because that is not supported in Character Mode
10804>>>//*** Driver attributes
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>//------------------------------------------------------------
10804>>>
10804>>>
10804>>>//-------------------------------------
10804>>>
10804>>>
10804>>>
10804>>>//*** Replacement for logical column number that indicates all columns
10804>>>
10804>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
10804>>>
10804>>>//*** Possible DF_FIELD_READ_ONLY values
10804>>>
10804>>>
10804>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
10804>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
10804>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
10804>>>
10804>>>
10804>>>// Moved to Mssqldrv.pkg
10804>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
10804>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
10804>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
10804>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
10804>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
10804>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
10804>>>
10804>>>//*** Possible SQL Column type values
10804>>>Define SQL_UNKNOWN_TYPE   For    0
10804>>>Define SQL_CHAR           For    1
10804>>>Define SQL_NUMERIC        For    2
10804>>>Define SQL_DECIMAL        For    3
10804>>>Define SQL_INTEGER        For    4
10804>>>Define SQL_SMALLINT       For    5
10804>>>Define SQL_FLOAT          For    6
10804>>>Define SQL_REAL           For    7
10804>>>Define SQL_DOUBLE         For    8
10804>>>Define SQL_DATETIME       For    9
10804>>>Define SQL_VARCHAR        For   12
10804>>>Define SQL_TYPE_DATE      For   91
10804>>>Define SQL_TYPE_TIME      For   92
10804>>>Define SQL_TYPE_TIMESTAMP for   93
10804>>>// Moved to mssqldrv.pkg
10804>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
10804>>>
10804>>>
10804>>>Define SQL_DATE           For    9
10804>>>Define SQL_INTERVAL       For   10
10804>>>Define SQL_TIME           For   10
10804>>>Define SQL_TIMESTAMP      For   11
10804>>>Define SQL_LONGVARCHAR    For  (-1)
10804>>>Define SQL_BINARY         For  (-2)
10804>>>Define SQL_VARBINARY      For  (-3)
10804>>>Define SQL_LONGVARBINARY  For  (-4)
10804>>>Define SQL_BIGINT         For  (-5)
10804>>>Define SQL_TINYINT        For  (-6)
10804>>>Define SQL_BIT            For  (-7)
10804>>>Define SQL_WCHAR          For  (-8)
10804>>>Define SQL_WVARCHAR       For  (-9)
10804>>>Define SQL_WLONGVARCHAR   For (-10)
10804>>>Define SQL_GUID           For (-11)
10804>>>
10804>>>//*** Possible DF_INDEX_SQL_TYPE values
10804>>>Define DF_INDEX_CLIENT      for  1
10804>>>Define DF_INDEX_SERVER      for  2
10804>>>Define DF_INDEX_SERVER_ONLY for  3
10804>>>Define DF_INDEX_TEMPORARY   for  4
10804>>>
10804>>>//*** Possible DF_FILE_ALLOWED_STRUCTURE_CHANGES values
10804>>>Define ALL_TABLE_CHANGES_ALLOWED            for  0
10804>>>Define ONLY_TABLE_INT_FILE_CHANGES_ALLOWED  for  1
10804>>>Define NO_TABLE_CHANGES_ALLOWED             for  2
10804>>>
10804>>>//*** Driver level attributes
10804>>>
10804>>>
10804>>>//*** Error number constants
10804>>>
10804>>>
10804>>>//*** Call driver function identifiers
10804>>>
10804>>>
10804>>>//*** Init data source types
10804>>>
10804>>>
10804>>>//*** Dummy strings used in the commands
10804>>>    String  CLI$StrDummy 255
10804>>>    Integer CLI$IntDummy
10804>>>
10804>>>
10804>>>//*****************************************************************************
10804>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
10804>>>//***                                                                       ***
10804>>>//***   Setup a constraint for a file.                                      ***
10804>>>//*****************************************************************************
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>//*****************************************************************************
10804>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
10804>>>//***                                                                       ***
10804>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
10804>>>//*** will be set for the remainder of the session or until set again. To   ***
10804>>>//*** permanently set driver level attributes change the driver             ***
10804>>>//*** configuration file.                                                   ***
10804>>>//*****************************************************************************
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>
10804>>>//*****************************************************************************
10804>>>//*** Class  : cCLIHandler                                                  ***
10804>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
10804>>>//***          call several CLI releated methods.                           ***
10804>>>//*****************************************************************************
10804>>>
10804>>>Class cCLIHandler Is An Array
10805>>>
10805>>>    Procedure Construct_Object Integer iImage
10807>>>        Forward Send Construct_object iImage
10809>>>
10809>>>        Property String  psDriverID       Public ""
10810>>>    End_Procedure // Construct_Object
10811>>>
10811>>>
10811>>>
10811>>>    //***
10811>>>    //*** Fucntion: CKRevsion
10811>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
10811>>>    //***
10811>>>
10811>>>    Function CKRevision Returns String
10813>>>        Local String  sDriverID
10813>>>        Local String  sRevision
10813>>>        Local String  sVoid
10813>>>        Local Integer iRetval
10813>>>
10813>>>        Get psDriverID To sDriverID
10814>>>        If (sDRiverID <> "") Begin
10816>>>            Move (Repeat(" ", 255)) To sRevision
10817>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
10822>>>        End
10822>>>>
10822>>>
10822>>>        Function_Return sRevision
10823>>>    End_Function // CKRevision
10824>>>
10824>>>
10824>>>
10824>>>    //***
10824>>>    //*** Function: ExtractPartFromRevision
10824>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
10824>>>    //***
10824>>>    //*** Returns : The part version number or -1 if there is no such part number.
10824>>>    //***
10824>>>
10824>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
10826>>>        Local Integer iPartRev
10826>>>        Local Integer iCurrentPart
10826>>>        Local Integer iSeparatorPos
10826>>>
10826>>>        If (iPartNum > 4) ;            Function_Return -1
10829>>>
10829>>>        Move 0 To iCurrentPart
10830>>>        Repeat
10830>>>>
10830>>>            Move (Pos(".", sRevision)) To iSeparatorPos
10831>>>            If (iSeparatorPos > 0) Begin
10833>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
10834>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
10835>>>                Increment iCurrentPart
10836>>>            End
10836>>>>
10836>>>            Else If (sRevision <> "") Begin
10839>>>                Move sRevision To iPartRev
10840>>>                Move "" To sRevision
10841>>>                Increment iCurrentPart
10842>>>            End
10842>>>>
10842>>>            Else ;                Move -1 To iPartRev
10844>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
10846>>>
10846>>>        Function_Return iPartRev
10847>>>    End_Function // EcxtractPartFromRevision
10848>>>
10848>>>
10848>>>
10848>>>    //***
10848>>>    //*** Function: CKMajorRevision
10848>>>    //*** Purpose : Returns the major revision of the CK
10848>>>    //***
10848>>>
10848>>>    Function CKMajorRevision Returns Integer
10850>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
10851>>>    End_Function // CKMajorRevision
10852>>>
10852>>>
10852>>>
10852>>>    //***
10852>>>    //*** Function: CKMinorRevision
10852>>>    //*** Purpose : Returns the minor revision of the CK
10852>>>    //***
10852>>>
10852>>>    Function CKMinorRevision Returns Integer
10854>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
10855>>>    End_Function // CKMinorRevision
10856>>>
10856>>>
10856>>>
10856>>>    //***
10856>>>    //*** Function: CKReleaseRevision
10856>>>    //*** Purpose : Returns the release revision of the CK
10856>>>    //***
10856>>>
10856>>>    Function CKReleaseRevision Returns Integer
10858>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
10859>>>    End_Function // CKReleaseRevision
10860>>>
10860>>>
10860>>>
10860>>>    //***
10860>>>    //*** Function: CKBuildRevision
10860>>>    //*** Purpose : Returns the major revision of the CK
10860>>>    //***
10860>>>
10860>>>    Function CKBuildRevision Returns Integer
10862>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
10863>>>    End_Function // CKBuildRevision
10864>>>
10864>>>
10864>>>
10864>>>    //***
10864>>>    //*** Function: IsMinimalRevision
10864>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
10864>>>    //***
10864>>>
10864>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
10866>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
10869>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
10872>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
10875>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
10878>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
10881>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
10885>>>            End
10885>>>>
10885>>>        End
10885>>>>
10885>>>
10885>>>        Function_Return (FALSE)
10886>>>    End_Function // IsMinimalRevision
10887>>>
10887>>>
10887>>>
10887>>>    //***
10887>>>    //*** Function: RegistrationName
10887>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
10887>>>    //***
10887>>>
10887>>>    Function RegistrationName Returns String
10889>>>        Local String  sRegistration
10889>>>        Local String  sDRiverId
10889>>>        Local String  sVoid
10889>>>        Local Integer iRetval
10889>>>
10889>>>        Get psDriverID To sDriverID
10890>>>        If (sDRiverID <> "") Begin
10892>>>            Move (Repeat(" ", 255)) To sRegistration
10893>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
10898>>>        End
10898>>>>
10898>>>
10898>>>        Function_Return sRegistration
10899>>>    End_Function // RegistrationName
10900>>>
10900>>>
10900>>>
10900>>>    //***
10900>>>    //*** Function: SerialNumber
10900>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
10900>>>    //***
10900>>>
10900>>>    Function SerialNumber Returns Integer
10902>>>        Local String  sDRiverId
10902>>>        Local String  sVoid
10902>>>        Local Integer iRetval
10902>>>
10902>>>        Get psDriverID To sDriverID
10903>>>        If (sDRiverID <> "") Begin
10905>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
10910>>>        End
10910>>>>
10910>>>
10910>>>        Function_Return iRetval
10911>>>    End_Function // SerialNumber
10912>>>
10912>>>
10912>>>
10912>>>    //***
10912>>>    //*** Function: MaxUsers
10912>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
10912>>>    //***
10912>>>
10912>>>    Function MaxUsers Returns Integer
10914>>>        Local String  sDRiverId
10914>>>        Local String  sVoid
10914>>>        Local Integer iRetval
10914>>>
10914>>>        Get psDriverID To sDriverID
10915>>>        If (sDRiverID <> "") Begin
10917>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
10922>>>        End
10922>>>>
10922>>>
10922>>>        Function_Return iRetval
10923>>>    End_Function // MaxUsers
10924>>>
10924>>>
10924>>>
10924>>>    //***
10924>>>    //*** Procedure: DumpStatus
10924>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
10924>>>    //***
10924>>>
10924>>>    Procedure DumpStatus String sFileName
10926>>>        Local String  sVoid
10926>>>        Local String  sDriverID
10926>>>        Local Integer iVoid
10926>>>
10926>>>        Get psDriverID To sDriverID
10927>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
10934>>>    End_Procedure // DumpStatus
10935>>>
10935>>>
10935>>>
10935>>>    //***
10935>>>    //*** Procedure: ReadConfiguration
10935>>>    //*** Purpose  : Reset all driver level configurable attributes to the
10935>>>    //***            default value and then reread the configuration.
10935>>>    //***
10935>>>
10935>>>    Procedure ReadConfiguration
10937>>>        Local String  sVoid
10937>>>        Local String  sDriverID
10937>>>        Local Integer iVoid
10937>>>
10937>>>        Get psDriverID To sDriverID
10938>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
10945>>>    End_Procedure // ReadConfiguration
10946>>>
10946>>>
10946>>>
10946>>>    //***
10946>>>    //*** Function: TextToRIMValue
10946>>>    //*** Purpose : Convert a text to the corresponding
10946>>>    //***           Generate_Record_ID_Method attribute value
10946>>>    //***
10946>>>
10946>>>    Function TextToRIMValue String sText Returns Integer
10948>>>        If (sText = "None") ;            Function_return RIM_NONE
10951>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
10955>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
10959>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
10963>>>    End_Function // TextToRIMValue
10964>>>
10964>>>
10964>>>
10964>>>    //***
10964>>>    //*** Function: RIMValueTotext
10964>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
10964>>>    //***           corresponding text.
10964>>>    //***
10964>>>
10964>>>    Function RIMValueToText Integer iAttrValue Returns String
10966>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
10969>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
10973>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
10977>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
10981>>>    End_Function // RIMValueToText
10982>>>
10982>>>
10982>>>
10982>>>    //***
10982>>>    //*** Function: TextToROValue
10982>>>    //*** Purpose : Convert a text to the corresponding
10982>>>    //***           Generate_Record_ID_Method attribute value
10982>>>    //***
10982>>>
10982>>>    Function TextToROValue String sText Returns Integer
10984>>>        If (sText = "No") ;            Function_return RO_NO
10987>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
10991>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
10995>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
10999>>>    End_Function // TextToRIMValue
11000>>>
11000>>>
11000>>>
11000>>>    //***
11000>>>    //*** Function: ROValueTotext
11000>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
11000>>>    //***           corresponding text.
11000>>>    //***
11000>>>
11000>>>    Function ROValueToText Integer iAttrValue Returns String
11002>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
11005>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
11009>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
11013>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
11017>>>    End_Function // RIMValueToText
11018>>>
11018>>>
11018>>>
11018>>>    //***
11018>>>    //*** Function: LastDriverError
11018>>>    //*** Purpose : Return the text f the last error geneated by the driver.
11018>>>    //***
11018>>>
11018>>>    Function LastDriverError Returns String
11020>>>        Local String  sDriverID
11020>>>        Local String  sLastError
11020>>>        Local String  sLastErrorLength
11020>>>        Local Integer iLastErrorLength
11020>>>        Local Integer iVoid
11020>>>
11020>>>        //*** Initialize
11020>>>        Move "" To sLastError
11021>>>
11021>>>        Get psDriverID To sDriverID
11022>>>        If (sDriverID <> "") Begin
11024>>>            //*** Get the text of the last error
11024>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
11025>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
11030>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
11031>>>
11031>>>            If (iLastErrorLength > 0) Begin
11033>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
11034>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
11039>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
11040>>>            End
11040>>>>
11040>>>        End
11040>>>>
11040>>>
11040>>>        Function_Return sLastError
11041>>>    End_Function // LastDriverError
11042>>>
11042>>>
11042>>>
11042>>>    //***
11042>>>    //*** Function: EnumerateTables
11042>>>    //*** Purpose : Enumerate the tables in a database
11042>>>    //***
11042>>>
11042>>>    Function EnumerateTables String sLogin Returns Integer
11044>>>        Local String  sDriver
11044>>>        Local String  sVoid
11044>>>        Local Integer iNumTables
11044>>>        Local Integer iVoid
11044>>>
11044>>>        Get psDriverID To sDriver
11045>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
11052>>>
11052>>>        Function_Return iNumTables
11053>>>    End_Function // EnumerateTables
11054>>>
11054>>>
11054>>>
11054>>>    //***
11054>>>    //*** Function: TableName
11054>>>    //*** Purpose : Returns the name of the table enumerated at the given position
11054>>>    //***
11054>>>
11054>>>    Function TableName Integer iIndex Returns String
11056>>>        Local String  sDriver
11056>>>        Local String  sTableName
11056>>>        Local String  sVoid
11056>>>        Local Integer iVoid
11056>>>
11056>>>        Get psDriverID To sDriver
11057>>>        If (sDriver <> "") Begin
11059>>>            Move (Repeat(" ", 255)) To sTableName
11060>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
11065>>>        End
11065>>>>
11065>>>
11065>>>        Function_Return sTableName
11066>>>    End_Function // TableName
11067>>>
11067>>>
11067>>>
11067>>>    //***
11067>>>    //*** Function: SchemaName
11067>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
11067>>>    //***
11067>>>
11067>>>    Function SchemaName Integer iIndex Returns String
11069>>>        Local String  sDriver
11069>>>        Local String  sSchemaName
11069>>>        Local String  sVoid
11069>>>        Local Integer iVoid
11069>>>
11069>>>        Get psDriverID To sDriver
11070>>>        If (sDriver <> "") Begin
11072>>>            Move (Repeat(" ", 255)) To sSchemaName
11073>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
11078>>>        End
11078>>>>
11078>>>
11078>>>        Function_Return sSchemaName
11079>>>    End_Function // SchemaName
11080>>>
11080>>>
11080>>>
11080>>>    //***
11080>>>    //*** Function: TableType
11080>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
11080>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
11080>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
11080>>>    //***
11080>>>
11080>>>    Function TableType Integer iIndex Returns String
11082>>>        Local String  sDriver
11082>>>        Local String  sTableType
11082>>>        Local String  sVoid
11082>>>        Local Integer iVoid
11082>>>
11082>>>        Get psDriverID To sDriver
11083>>>        If (sDriver <> "") Begin
11085>>>            Move (Repeat(" ", 25)) To sTableType
11086>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
11091>>>        End
11091>>>>
11091>>>
11091>>>        Function_Return sTableType
11092>>>    End_Function // TableType
11093>>>
11093>>>
11093>>>
11093>>>    //***
11093>>>    //*** Function: TableComment
11093>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
11093>>>    //***
11093>>>
11093>>>    Function TableComment Integer iIndex Returns String
11095>>>        Local String  sDriver
11095>>>        Local String  sTableComment
11095>>>        Local String  sVoid
11095>>>        Local Integer iVoid
11095>>>
11095>>>        Get psDriverID To sDriver
11096>>>        If (sDriver <> "") Begin
11098>>>            Move (Repeat(" ", 1024)) to sTableComment
11099>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
11104>>>        End
11104>>>>
11104>>>
11104>>>        Function_Return sTableComment
11105>>>    End_Function // TableComment
11106>>>
11106>>>
11106>>>
11106>>>    //***
11106>>>    //*** Function: EnumerateColumns
11106>>>    //*** Purpose : Enumerate the columns in a table
11106>>>    //***
11106>>>
11106>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
11108>>>        Local String  sDriver
11108>>>        Local Integer iNumColumns
11108>>>        Local Integer iVoid
11108>>>
11108>>>        Get psDriverID To sDriver
11109>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
11116>>>
11116>>>        Function_Return iNumColumns
11117>>>    End_Function // EnumerateColumns
11118>>>
11118>>>
11118>>>
11118>>>    //***
11118>>>    //*** Function: ColumnName
11118>>>    //*** Purpose : Returns the name of the column enumerated at the given position
11118>>>    //***
11118>>>
11118>>>    Function ColumnName Integer iIndex Returns String
11120>>>        Local String  sDriver
11120>>>        Local String  sColumnName
11120>>>        Local String  sVoid
11120>>>        Local Integer iVoid
11120>>>
11120>>>        Get psDriverID To sDriver
11121>>>        If (sDriver <> "") Begin
11123>>>            Move (Repeat(" ", 255)) To sColumnName
11124>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
11129>>>        End
11129>>>>
11129>>>
11129>>>        Function_Return sColumnName
11130>>>    End_Function // ColumnName
11131>>>
11131>>>
11131>>>
11131>>>    //***
11131>>>    //*** Function: CLIDFDateToSQLDate
11131>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
11131>>>    //***
11131>>>
11131>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
11133>>>        Local String sSQLDate
11133>>>        Local Integer iOrgDateFmt
11133>>>        Local Integer iOrgDateSep
11133>>>
11133>>>        //*** Change date format to military, SQL dates are military dates
11133>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
11136>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
11139>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
11142>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
11145>>>
11145>>>        //*** We only need to convert if the date is 0
11145>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
11154>>>        Else ;            Move dDFDate To sSQLDate
11156>>>
11156>>>        //*** Change date format back to original
11156>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
11159>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
11162>>>
11162>>>        Function_Return sSQLDate
11163>>>    End_Function // CLIDFDateToSQLDate
11164>>>
11164>>>
11164>>>
11164>>>    //***
11164>>>    //*** Function: CLISQLDateToDFDate
11164>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
11164>>>    //***
11164>>>
11164>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
11166>>>        Local Date dDFDate
11166>>>        Local String sDummyDateValue
11166>>>        Local Integer iOrgDateFmt
11166>>>        Local Integer iOrgDateSep
11166>>>
11166>>>        //*** Change date format to military, SQL dates are military dates
11166>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
11169>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
11172>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
11175>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
11178>>>
11178>>>        //*** We only need to convert if the date is the dummy zero date value
11178>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
11185>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
11188>>>        Else ;            Move sSQLDate To dDFDate
11190>>>
11190>>>        //*** Change date format back to original
11190>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
11193>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
11196>>>
11196>>>        Function_Return dDFDate
11197>>>    End_Function // CLISQLDateToDFDate
11198>>>
11198>>>
11198>>>
11198>>>    //***
11198>>>    //*** Function: RedirectConnection
11198>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
11198>>>    //***           will point to another database but all tables will stay
11198>>>    //***           open!
11198>>>    //***
11198>>>
11198>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
11200>>>        Local String  sDriver
11200>>>        Local String  sVoid
11200>>>        Local Integer iResult
11200>>>        Local Integer iVoid
11200>>>
11200>>>        Get psDriverID To sDriver
11201>>>        If (sDriver <> "") Begin
11203>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
11208>>>        End
11208>>>>
11208>>>        Function_Return iResult
11209>>>    End_Function // RedirectConnect
11210>>>
11210>>>
11210>>>    //***
11210>>>    //*** Function: RedirectIDConnectString
11210>>>    //*** Purpose : Redirect a connection of a connection ID 
11210>>>    //***           sConnectionId must contain a valid ConnectionId ("DFCONNID=MyID")
11210>>>    //***           sConnectString must contain a valid connectstring ("SERVER=MyServer;DATABASE=MyDatabase;UID=MyName;PWD=MyPassword")
11210>>>    //*** 
11210>>>    //***           RedirectIDConnectString will redirect from the old connection (Server/Database the connectionId currently points to)
11210>>>    //***           to the new connection (Server/Database specified in sConnectString) 
11210>>>    //***           All opened tables will be moved from old connection to new connection. (Tables must have identical structure in both connections)
11210>>>    //*** 
11210>>>    //***           If bKeepLoggedIn = false, the new connection will be logged in, the old connection will be logged out
11210>>>    //***           If bKeepLoggedIn = true, connections will remain open and re-used on next redirectIdConnection
11210>>>    //*** 
11210>>>    //***           Returns:
11210>>>    //***               0 when the redirection was successful. 
11210>>>    //***               1 if the connection ID does not exist or can not be found.
11210>>>    //***               2 login into the new connection failed.
11210>>>    //*** 
11210>>>    Function RedirectIdConnectString String sConnectionId String sConnectString Boolean bKeepLoggedIn Returns Integer
11212>>>        Local String  sDriver
11212>>>        Local String  sVoid
11212>>>        Local Integer iResult
11212>>>        
11212>>>        Local Integer iOption
11212>>>
11212>>>        // iOption
11212>>>        // 0 = RedirectConnection
11212>>>        // 1 = RedirectIdConnectString
11212>>>        // 2 = RedirectIdConnectStringKeepLoggedIn
11212>>>        If (bKeepLoggedIn) Begin
11214>>>            Move 2 to iOption
11215>>>        End
11215>>>>
11215>>>        Else Begin
11216>>>           Move 1 to iOption 
11217>>>        End
11217>>>>
11217>>>
11217>>>        Get psDriverID to sDriver
11218>>>        If (sDriver <> "") Begin
11220>>>            Call_Driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sConnectionId sConnectString iOption Result iResult
11225>>>        End
11225>>>>
11225>>>        Function_Return iResult
11226>>>    End_Function 
11227>>>
11227>>>
11227>>>    //***
11227>>>    //*** Function: CreateConnectionID
11227>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
11227>>>    //***
11227>>>
11227>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
11229>>>        Local String  sDriver
11229>>>        Local Integer iResult
11229>>>        Local Integer iOptions
11229>>>
11229>>>        Get psDriverID to sDriver
11230>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
11233>>>        Else ;            Move iOpt to iOptions
11235>>>        If (sDriver <> "") Begin
11237>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
11242>>>        End
11242>>>>
11242>>>        Function_Return iResult
11243>>>    End_Function // CreateConnectionID
11244>>>
11244>>>
11244>>>
11244>>>    //***
11244>>>    //*** Function: DeleteConnectionID
11244>>>    //*** Purpose : Delete a DataFlex side connection id.
11244>>>    //***
11244>>>
11244>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
11246>>>        Local String  sDriver
11246>>>        Local Integer iResult
11246>>>        Local String sVoid
11246>>>
11246>>>        Get psDriverID To sDriver
11247>>>        If (sDriver <> "") Begin
11249>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
11254>>>        End
11254>>>>
11254>>>        Function_Return iResult
11255>>>    End_Function // DeleteConnectionID
11256>>>
11256>>>End_Class // cCLIHandler
11257>Use vWin32fh.pkg
Including file: vWin32fh.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\vWin32fh.pkg)
11257>>>// This code is part of VDF GUIdance
11257>>>// Visit us @ http://www.vdf-guidance.com
11257>>>// e-Mail us @ info@vdf-guidance.com
11257>>>// VDF GUIdance is a mutual project of
11257>>>// Frank Vandervelpen - Vandervelpen Systems and
11257>>>// Wil van Antwerpen  - Antwise Solutions
11257>>>// All software source code should be used <<AS IS>> without any warranty.
11257>>>//
11257>>>//
11257>>>// *** Windows 32bit file handling wrapper class ***
11257>>>//
11257>>>
11257>>>// 05-09-2000 **WvA: Changed namingconvention of all classes and methods to new standard
11257>>>//                   This may be painfull for some of you, but it was really needed as it was
11257>>>//                   getting messy. The "vs" -prefix we used before was confusing and could
11257>>>//                   unintentionally have been interpreted as "Vdf-GUIdance String".
11257>>>//
11257>>>// The used naming-convention is:
11257>>>//     - a prefix of "vWin32_" for every external function declaration
11257>>>//     - a prefix of the letter "v" for the full API name for the vdf-wrapper function.
11257>>>//
11257>>>// By using this we are guarding ourselves for conflicts with variable declarations
11257>>>// of DataAccess in the future.
11257>>>// Or at least almost as the letter "v" is now also synonym for variant (duh~!)
11257>>>//
11257>>>// mm-dd-yyyy Author Description
11257>>>//
11257>>>//                   vSHGetFolderPath added to retrieve the new shell folders
11257>>>//                   vGetWindowsDirectory
11257>>>//
11257>>>//                   vGetTempFileName
11257>>>//                   vGetTempPath
11257>>>// 11-17-2001 **WvA: Removed User Interface Error popups such as Error handling.
11257>>>//                   This is an absolute need for WebApp. We expect you to handle the
11257>>>//                   error in your application anyways. Changed this for:
11257>>>//                   vDeleteFile, vCopyFile, vMoveFile and vRenameFile
11257>>>// 03-02-2002 **WvA: vRemoveDirectory added
11257>>>// 03-11-2002 **WvA: The parameter lpdword in the external function declaration for
11257>>>//                   vWin32_SHBrowsForFolder can cause compiler errors.
11257>>>//                   It is renamed too avoid this.
11257>>>// 11-11-2002 **WvA: Codecleanup, vcSelectFile_Dialog is now cvSelectFile_Dialog, its
11257>>>//                   function vSelectedFileName is now just SelectedFileName
11257>>>//                   Removed the local keyword in the variable declarations
11257>>>// 10-17-2003 **WvA: Cleaned up function vSelect_File and added code to destroy the dynamically
11257>>>//                   created file-open dialog
11257>>>// 02-12-2004 **WvA: Allan Ankerstjeme pointed me into a bug for the vCreateTempFileInPath
11257>>>//                   in that it didn't exactly return the correct filename of the file created.
11257>>>//                   This has now been taken care of.
11257>>>// 02-19-2004 **WvA: Removed all API declarations from the package itself to improve readability
11257>>>//                   These declarations are now included from the vWin32fh header file.
11257>>>// 02-19-2004 **WvA: Changed the default way in which the standard file handling works
11257>>>//                   Before today one could always undo the operation, as of now you cannot as
11257>>>//                   the default was a silly one using unnecessary resources (mainly diskspace)
11257>>>//                   Since i don't really expect someone to use that feature it has been removed.
11257>>>//                   One can however restore to the old way of handling by simply calling the
11257>>>//                   vWin32fhCompatibilityMode procedure ONE time before accessing any of the
11257>>>//                   filehandling operations
11257>>>// 02-19-2004 **WvA: The functions ParseFolderName, ParseFileName and ParseFileExtenstion added
11257>>>//                   as well as the StringFromRightOfChar function.
11257>>>// 02-19-2004 **WvA: sfoFormatDisk function added which can use to format a floppydisk
11257>>>//                   DISABLED now as testing shows that it does not work as advertised...
11257>>>// 02-20-2004 **WvA: The function vDDE_Error_Handler didn't pass the errornumber on to the DDE_Error_To_String function
11257>>>//                   Moved the hardcoded strings from vDDE_Error_Handler to define declarations for easier translation later on.
11257>>>// 09-10-2004 **WvA: Added the ToAnsi function to the fileoperations method so that
11257>>>//                   extended characters are treated ok too.
11257>>>//                   Reported by Flemming from
11257>>>// 12-17-2004 **WvA: Changed vFilePathExists to be global, reported by Peter van Mil
11257>>>// 12-28-2004 **WvA: WebApp compatibility added by introducing compiler directives
11257>>>// 03-10-2006 **WvA: Added more CSIDL types to our header file for use with the vSHGetFolderPath function
11257>>>// 01-02-2007 **WvA: Set NoChangeDir_State on vSelect_File and vSelectSaveFile to True but changed it back due to side effects.
11257>>>//                   Added vSelectSavefile function to create a file save dialog
11257>>>//                   Fixed ParseFolderName which was horribly broken (thanks for the reports)
11257>>>//                   Added vParentPath function to retrieve the parent "node" of a path
11257>>>// 01-04-2008 **WvA: Fixed vCreateTempFileInPath as the function wasn't working
11257>>>// 10-04-2009 **WvA: Added vshCreateDirectoryEx from Micheal Mullan, moved filedialogs to cvFileDialogs.pkg
11257>>>// 01-11-2010 **WvA: Added vWin32_APIFilesize as supplied by Renato Villa, to get the filesize of the specified file. See http://support.dataaccess.com/forums/showthread.php?t=41982
11257>>>// 10-02-2011 **WvA: Added vCSIDL_SYSTEMX86, courtesy of Ola Eldoy for pointing this out and providing the define statement.
11257>>>// 20-12-2012 **WvA: Default behavior on copy/move is now to autocreate subfolders, tip by Frank Cheng
11257>>>// 29-09-2014 **WvA: Added function vFolderFileCount to count the number of files in a folder, add vCSIDL_PROGRAM_FILESx86
11257>>>// 04-10-2014 **WvA: Added extra checks on vFilePathExists and vFolderExists courtesy of Nils Svedmyr
11257>>>
11257>>>//Use Case.mac
11257>>>Use File_Dlg.pkg      // Contains OpenDialog class definition
11257>>>Use cvFileDialogs.pkg
Including file: cvFileDialogs.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cvFileDialogs.pkg)
11257>>>>>//***************************************************************************
11257>>>>>//*
11257>>>>>//* Class:        cvSaveAsDialog
11257>>>>>//* Package Name: cvFileDialogs.pkg
11257>>>>>//*
11257>>>>>//***************************************************************************
11257>>>>>
11257>>>>>Use File_dlg.pkg
11257>>>>>
11257>>>>>// *WvA: 13-01-1999 Created
11257>>>>>// The Class cSelectFile_Dialog is created to support the function Select_File
11257>>>>>// This function opens the Windows standard file open dialog and returns the selected
11257>>>>>// file_name.
11257>>>>>Class cvSelectFile_Dialog Is An OpenDialog
11258>>>>>
11258>>>>>  Procedure Construct_Object Integer iImage_Id
11260>>>>>    Forward Send Construct_Object iImage_Id
11262>>>>>    Set HideReadOnly_State To True
11263>>>>>  End_Procedure // Construct_Object
11264>>>>>
11264>>>>>  Function SelectedFileName Returns String
11266>>>>>    String sFileName
11266>>>>>    Move "" To sFileName
11267>>>>>    If (Show_Dialog(Self)) Begin
11269>>>>>      Move (RTrim(File_Name(Self))) To sFileName
11270>>>>>    End
11270>>>>>>
11270>>>>>    Function_Return sFileName
11271>>>>>  End_Function // SelectedFileName
11272>>>>>End_Class // cvSelectFile_Dialog
11273>>>>>
11273>>>>>
11273>>>>>// *WvA: 13-01-1999 Created
11273>>>>>// This function opens the Windows standard file open dialog and returns the selected
11273>>>>>// file_name. Returns '' if the user didn't make a selection.
11273>>>>>// **WvA: 17-10-2003 Cleaned up and added code to destroy the dynamically created
11273>>>>>//                   file-open dialog
11273>>>>>Function vSelect_File Global String sSupportedFileTypes String sCaptionText String sInitialFolder Returns String
11275>>>>>  String sSelectedFile
11275>>>>>  Integer hoOpenFileDialog
11275>>>>>
11275>>>>>  Object oOpenFileDialog Is A cvSelectFile_Dialog
11277>>>>>
11277>>>>>    Set Dialog_Caption    To sCaptionText
11278>>>>>    Set Filter_String     To sSupportedFileTypes
11279>>>>>    Set Initial_Folder    To sInitialFolder
11280>>>>>
11280>>>>>    Move Self       To hoOpenFileDialog
11281>>>>>  End_Object // oOpenFileDialog
11282>>>>>
11282>>>>>  Get SelectedFileName Of hoOpenFileDialog To sSelectedFile
11283>>>>>  Send Destroy_Object To hoOpenFileDialog
11284>>>>>  Function_Return sSelectedFile
11285>>>>>End_Function // vSelect_File
11286>>>>>
11286>>>>>
11286>>>>>Class cvSaveAsDialog is a SaveAsDialog
11287>>>>>
11287>>>>>  Procedure Construct_Object
11289>>>>>    Forward Send Construct_Object
11291>>>>>    Set HideReadOnly_State To True
11292>>>>>  End_Procedure // Construct_Object
11293>>>>>
11293>>>>>  Function SelectedFileName Returns String
11295>>>>>    String sFileName
11295>>>>>    Move "" To sFileName
11296>>>>>    If (Show_Dialog(Self)) Begin
11298>>>>>      Move (RTrim(File_Name(Self))) To sFileName
11299>>>>>    End
11299>>>>>>
11299>>>>>    Function_Return sFileName
11300>>>>>  End_Function // SelectedFileName
11301>>>>>
11301>>>>>End_Class // cvSaveAsDialog
11302>>>>>
11302>>>>>// Added optional default filename as suggested by Nils
11302>>>>>Function vSelectSaveFile Global String sSupportedFileTypes String sCaptionText String sInitialFolder String sDefaultFileName Returns String
11304>>>>>  String sSelectedFile
11304>>>>>  Integer hoDialog
11304>>>>>
11304>>>>>  Move "" To sSelectedFile
11305>>>>>  Get Create U_cvSaveAsDialog To hoDialog
11306>>>>>  If (hoDialog) Begin
11308>>>>>    //Set NoChangeDir_State Of hoDialog To True
11308>>>>>    Set Dialog_Caption    Of hoDialog To sCaptionText
11309>>>>>    Set Filter_String     Of hoDialog To sSupportedFileTypes
11310>>>>>    Set Initial_Folder    Of hoDialog To sInitialFolder
11311>>>>>    If (Num_Arguments = 4) Begin
11313>>>>>      Set File_Title        of hoDialog to sDefaultFileName
11314>>>>>    End
11314>>>>>>
11314>>>>>    Get SelectedFileName  Of hoDialog To sSelectedFile
11315>>>>>    Send Destroy Of hoDialog
11316>>>>>  End
11316>>>>>>
11316>>>>>  Function_Return sSelectedFile
11317>>>>>End_Function // vSelectSaveFile
11318>>>Use Seq_chnl.pkg
11318>>>
11318>>>Use Windows.pkg
11318>>>//Use Dferror
11318>>>Use Dll.pkg
11318>>>Use vWin32fh.h       // Header file with WinAPI declarations
Including file: vwin32fh.h    (C:\Projects\DF18\DbUpdateFramework\AppSrc\vwin32fh.h)
11318>>>>>//TH-Header
11318>>>>>//*****************************************************************************************
11318>>>>>// Copyright (c)  2004 KURANT Project
11318>>>>>// All rights reserved.
11318>>>>>//
11318>>>>>// $FileName    : G:\Projects\vWin32fh\vWin32fh.h
11318>>>>>// $ProjectName : Windows 32 bits file handling
11318>>>>>// $Authors     : Wil van Antwerpen
11318>>>>>// $Created     : 19.02.2004  19:25
11318>>>>>// $Type        : BSD (as in do with it whatever you like)
11318>>>>>//
11318>>>>>// Contents:
11318>>>>>//  This file contains the Windows API external function call definitions and
11318>>>>>//  constants as they are used in the vWin32fh package.
11318>>>>>//*****************************************************************************************
11318>>>>>//TH-RevisionStart
11318>>>>>//TH-RevisionEnd
11318>>>>>
11318>>>>>Define CS_DDE_ERR_FILE_NOT_FOUND  For "The specified file was not found.\n"
11318>>>>>Define CS_DDE_ERR_PATH_NOT_FOUND  For "The specified path was not found.\n"
11318>>>>>Define CS_DDE_ERR_BAD_FORMAT      For "The .EXE file is invalid.\n"
11318>>>>>Define CS_DDE_ERR_ACCESSDENIED    For "The operating system denied access to the specified file.\n"
11318>>>>>Define CS_DDE_ERR_ASSOCINCOMPLETE For "The filename association is incomplete or invalid.\n"
11318>>>>>Define CS_DDE_ERR_DDEBUSY         For "The DDE transaction could not be completed because other DDE\ntransactions were being processed.\n"
11318>>>>>Define CS_DDE_ERR_DDEFAIL         For "The DDE transaction failed.\n"
11318>>>>>Define CS_DDE_ERR_DDETIMEOUT      For "The DDE transaction could not be completed,\nbecause the request timed out.\n"
11318>>>>>Define CS_DDE_ERR_DLLNOTFOUND     For "The specified dynamic-link library was not found.\n"
11318>>>>>Define CS_DDE_ERR_NOASSOC         For "There is no application associated with the given filename extension.\n"
11318>>>>>Define CS_DDE_ERR_OOM             For "There is not enough free memory available to complete the operation.\n"
11318>>>>>Define CS_DDE_ERR_PNF             For "The specified path was not found.\n"
11318>>>>>Define CS_DDE_ERR_SHARE           For "A sharing violation occurred.\n"
11318>>>>>Define CS_DDE_ERR_UNKNOWN_LINE1   For "Unknown DDE-error occurred.\nErrornumber"
11318>>>>>Define CS_DDE_ERR_UNKNOWN_LINE2   For ".\n"
11318>>>>>Define CS_DDE_ERR_HANDL_PAKTC     For "\nPress a key to continue...\n\n"
11318>>>>>Define CS_DDE_ERR_HANDL_CAPTION   For "a DDE-error occurred"
11318>>>>>
11318>>>>>
11318>>>>>Define vMax_Path     For |CI260
11318>>>>>Define vMinChar      For |CI$80
11318>>>>>Define vMaxChar      For |CI$7F
11318>>>>>Define vMinShort     For |CI$8000
11318>>>>>Define vMaxShort     For |CI$7FFF
11318>>>>>Define vMinLong      For |CI$80000000
11318>>>>>Define vMaxLong      For |CI$7FFFFFFF
11318>>>>>Define vMaxByte      For |CI$FF
11318>>>>>Define vMaxWord      For |CI$FFFF
11318>>>>>Define vMaxDword     For |CI$FFFFFFFF
11318>>>>>
11318>>>>>
11318>>>>>
11318>>>>>// For FindFirstFile
11318>>>>>Define vINVALID_HANDLE_VALUE   For |CI-1
11318>>>>>Define vINVALID_FILE_SIZE      For |CI$FFFFFFFF
11318>>>>>Define vERROR_NO_MORE_FILES    For |CI18
11318>>>>>
11318>>>>>// The defines below can be used to find out what kind of error has occurred if
11318>>>>>// the API-call ShellExecute is used.
11318>>>>>Define vERROR_FILE_NOT_FOUND   For |CI0002
11318>>>>>Define vERROR_PATH_NOT_FOUND   For |CI0003
11318>>>>>Define vERROR_BAD_FORMAT       For |CI0011
11318>>>>>Define vSE_ERR_ACCESSDENIED    For |CI0005
11318>>>>>Define vSE_ERR_ASSOCINCOMPLETE For |CI0027
11318>>>>>Define vSE_ERR_DDEBUSY         For |CI0030
11318>>>>>Define vSE_ERR_DDEFAIL         For |CI0029
11318>>>>>Define vSE_ERR_DDETIMEOUT      For |CI0028
11318>>>>>Define vSE_ERR_DLLNOTFOUND     For |CI0032
11318>>>>>Define vSE_ERR_FNF             For |CI0002
11318>>>>>Define vSE_ERR_NOASSOC         For |CI0031
11318>>>>>Define vSE_ERR_OOM             For |CI0008
11318>>>>>Define vSE_ERR_PNF             For |CI0003
11318>>>>>Define vSE_ERR_SHARE           For |CI0026
11318>>>>>
11318>>>>>
11318>>>>>// C-Structure
11318>>>>>//typedef struct _browseinfo {
11318>>>>>//    HWND hwndOwner;
11318>>>>>//    LPCITEMIDLIST pidlRoot;
11318>>>>>//    LPSTR pszDisplayName;
11318>>>>>//    LPCSTR lpszTitle;
11318>>>>>//    UINT ulFlags;
11318>>>>>//    BFFCALLBACK lpfn;
11318>>>>>//    LPARAM lParam;
11318>>>>>//    int iImage;
11318>>>>>//} BROWSEINFO, *PBROWSEINFO, *LPBROWSEINFO;
11318>>>>>
11318>>>>>//declare C structure struct_browseinfo
11318>>>>>//as documented in MSDN under Windows Shell API
11318>>>>>Type vtBrowseInfo
11318>>>>>  Field vtBrowseInfo.hWndOwner      as Handle
11318>>>>>  Field vtBrowseInfo.pIDLRoot       as Pointer
11318>>>>>  Field vtBrowseInfo.pszDisplayName as Pointer
11318>>>>>  Field vtBrowseInfo.lpszTitle      as Pointer
11318>>>>>  Field vtBrowseInfo.ulFlags        as dWord
11318>>>>>  Field vtBrowseInfo.lpfnCallback   as Pointer
11318>>>>>  Field vtBrowseInfo.lParam         as dWord
11318>>>>>  Field vtBrowseInfo.iImage         as dWord
11318>>>>>End_Type // tBrowseInfo
11318>>>>>
11318>>>>>// Browsing for directory.
11318>>>>>Define vBIF_RETURNONLYFSDIRS   For |CI$0001  // For finding a folder to start document searching
11318>>>>>Define vBIF_DONTGOBELOWDOMAIN  For |CI$0002  // For starting the Find Computer
11318>>>>>Define vBIF_STATUSTEXT         For |CI$0004  // Includes a status area in the dialog box.
11318>>>>>                                            // The callback function can set the status text by
11318>>>>>                                            // sending messages to the dialog box.
11318>>>>>Define vBIF_RETURNFSANCESTORS  For |CI$0008  // Only returns file system ancestors.
11318>>>>>
11318>>>>>Define vBIF_BROWSEFORCOMPUTER  For |CI$1000  // Browsing for Computers.
11318>>>>>Define vBIF_BROWSEFORPRINTER   For |CI$2000  // Browsing for Printers
11318>>>>>
11318>>>>>// message from browser
11318>>>>>//Define BFFM_INITIALIZED        1
11318>>>>>//Define BFFM_SELCHANGED         2
11318>>>>>
11318>>>>>// messages to browser
11318>>>>>//Define BFFM_SETSTATUSTEXT      (WM_USER + 100)
11318>>>>>//Define BFFM_ENABLEOK           (WM_USER + 101)
11318>>>>>//Define BFFM_SETSELECTION       (WM_USER + 102)
11318>>>>>
11318>>>>>
11318>>>>>External_function vWin32_SHBrowseForFolder "SHBrowseForFolder" shell32.dll ;  Pointer lpsBrowseInfo Returns dWord
11319>>>>>
11319>>>>>External_function vWin32_SHGetPathFromIDList "SHGetPathFromIDList" shell32.dll ;  Pointer pidList Pointer lpBuffer Returns dWord
11320>>>>>
11320>>>>>External_function vWin32_CoTaskMemFree "CoTaskMemFree" ole32.dll Pointer pV Returns Integer
11321>>>>>
11321>>>>>
11321>>>>>
11321>>>>>
11321>>>>>Type vtSecurity_attributes
11321>>>>>  Field vtSecurity_attributes.nLength        as dWord
11321>>>>>  Field vtSecurity_attributes.lpDescriptor   as Pointer
11321>>>>>  Field vtSecurity_attributes.bInheritHandle as Integer
11321>>>>>End_Type // vtSecurity_attributes
11321>>>>>
11321>>>>>//nLength:
11321>>>>>// Specifies the size, in bytes, of this structure. Set this value to the size of the
11321>>>>>// SECURITY_ATTRIBUTES structure.
11321>>>>>// Windows NT: Some functions that use the SECURITY_ATTRIBUTES structure do not verify the
11321>>>>>// value of the nLength member. However, an application should still set it properly.
11321>>>>>// That ensures current, future, and cross-platform compatibility.
11321>>>>>//
11321>>>>>//lpSecurityDescriptor:
11321>>>>>// Points to a security descriptor for the object that controls the sharing of it.
11321>>>>>// If NULL is specified for this member, the object may be assigned the default security
11321>>>>>// descriptor of the calling process.
11321>>>>>//
11321>>>>>//bInheritHandle:
11321>>>>>// Specifies whether the returned handle is inherited when a new process is created.
11321>>>>>// If this member is TRUE, the new process inherits the handle.
11321>>>>>
11321>>>>>
11321>>>>>// BOOL CreateDirectory(
11321>>>>>//    LPCTSTR lpPathName,
11321>>>>>//    LPSECURITY_ATTRIBUTES lpSecurityAttributes  // pointer to a security descriptor
11321>>>>>//   );
11321>>>>>//
11321>>>>>// lpPathName
11321>>>>>//  Points to a null-terminated string that specifies the path of the directory
11321>>>>>//  to be created.
11321>>>>>//  There is a default string size limit for paths of MAX_PATH characters.
11321>>>>>//  This limit is related to how the CreateDirectory function parses paths.
11321>>>>>// lpSecurityAttributes
11321>>>>>//  Pointer to a SECURITY_ATTRIBUTES structure als called a security descriptor that
11321>>>>>//  determines whether the returned handle can be inherited by child processes.
11321>>>>>//  If lpSecurityAttributes is NULL, the handle cannot be inherited.
11321>>>>>// Returns:
11321>>>>>//  If the function succeeds, the return value is nonzero.
11321>>>>>//  If the function fails, the return value is zero. To get extended error information, call GetLastError.
11321>>>>>External_function vWin32_CreateDirectory "CreateDirectoryA" kernel32.dll ;  Pointer lpPathName Pointer lpSecurity_Attributes Returns Integer
11322>>>>>
11322>>>>>
11322>>>>>// lpPathName
11322>>>>>//  Points to a null-terminated string that specifies the path of the directory
11322>>>>>//  to be removed.
11322>>>>>//  There is a default string size limit for paths of MAX_PATH characters.
11322>>>>>// Returns:
11322>>>>>//  If the function succeeds, the return value is nonzero.
11322>>>>>//  If the function fails, the return value is zero. To get extended error information, call GetLastError.
11322>>>>>External_function vWin32_RemoveDirectory "RemoveDirectoryA" kernel32.dll ;  Pointer lpPathName Returns Integer
11323>>>>>
11323>>>>>
11323>>>>>
11323>>>>>// The ShellExecute function opens or prints a specified file. The file can be an
11323>>>>>// executable file or a document file.
11323>>>>>//
11323>>>>>// Operation can be one of the following:
11323>>>>>//    "OPEN"  The function opens the file specified by lpFile.
11323>>>>>//            The file can be an executable file or a document file.
11323>>>>>//            The file can be a folder to open.
11323>>>>>//    "PRINT" The function prints the file specified by lpFile.
11323>>>>>//            The file should be a document file. If the file is an executable file,
11323>>>>>//            the function opens the file, as if "open" had been specified.
11323>>>>>//  "EXPLORE" The function explores the folder specified by lpFile.
11323>>>>>//
11323>>>>>// Return Values:
11323>>>>>//
11323>>>>>// If the function succeeds, the return value is the instance handle of the application that
11323>>>>>// was run, or the handle of a dynamic data exchange (DDE) server application.
11323>>>>>// If the function fails, the return value is an error value that is less than or equal to 32.
11323>>>>>//
11323>>>>>// The following table lists these error values:
11323>>>>>// Public Const ERROR_FILE_NOT_FOUND = 2&
11323>>>>>// Public Const ERROR_PATH_NOT_FOUND = 3&
11323>>>>>// Public Const ERROR_BAD_FORMAT = 11&
11323>>>>>// Public Const SE_ERR_ACCESSDENIED = 5
11323>>>>>// Public Const SE_ERR_ASSOCINCOMPLETE = 27
11323>>>>>// Public Const SE_ERR_DDEBUSY = 30
11323>>>>>// Public Const SE_ERR_DDEFAIL = 29
11323>>>>>// Public Const SE_ERR_DDETIMEOUT = 28
11323>>>>>// Public Const SE_ERR_DLLNOTFOUND = 32
11323>>>>>// Public Const SE_ERR_FNF = 2
11323>>>>>// Public Const SE_ERR_NOASSOC = 31
11323>>>>>// Public Const SE_ERR_OOM = 8
11323>>>>>// Public Const SE_ERR_PNF = 3
11323>>>>>// Public Const SE_ERR_SHARE = 26
11323>>>>>
11323>>>>>
11323>>>>>
11323>>>>>// Code to open the program that is associated with the selected file.
11323>>>>>//
11323>>>>>// External function call used in Procedure DoStartDocument
11323>>>>>External_function vWin32_ShellExecute "ShellExecuteA" shell32.dll ;  Handle hWnd ;  Pointer lpOperation ;  Pointer lpFile ;  Pointer lpParameters ;  Pointer lpDirectory ;  Dword iShowCmd Returns Handle
11324>>>>>
11324>>>>>
11324>>>>>
11324>>>>>
11324>>>>>
11324>>>>>                                          // Must be freed using SHFreeNameMappings
11324>>>>>
11324>>>>>Type vtShFileOpStruct
11324>>>>>  Field vtShFileOpStruct.hWnd                   as Handle
11324>>>>>  Field vtShFileOpStruct.wFunc                  as Integer
11324>>>>>  Field vtShFileOpStruct.pFrom                  as Pointer
11324>>>>>  Field vtShFileOpStruct.pTo                    as Pointer
11324>>>>>  Field vtShFileOpStruct.fFlags                 as Short
11324>>>>>  Field vtShFileOpStruct.fAnyOperationsAborted  as Short
11324>>>>>  Field vtShFileOpStruct.hNameMappings          as Pointer
11324>>>>>  Field vtShFileOpStruct.lpszProgressTitle      as Pointer // only used if FOF_SIMPLEPROGRESS
11324>>>>>End_Type // tShFileOpStruct
11324>>>>>
11324>>>>>// hwnd
11324>>>>>//   Handle of the dialog box to use to display information about the status of the operation.
11324>>>>>
11324>>>>>// wFunc
11324>>>>>//   Operation to perform. This member can be one of the following values:
11324>>>>>//     FO_COPY     Copies the files specified by pFrom to the location specified by pTo.
11324>>>>>//     FO_DELETE   Deletes the files specified by pFrom (pTo is ignored).
11324>>>>>//     FO_MOVE     Moves the files specified by pFrom to the location specified by pTo.
11324>>>>>//     FO_RENAME   Renames the files specified by pFrom.
11324>>>>>
11324>>>>>// pFrom
11324>>>>>//   Pointer to a buffer that specifies one or more source file names. Multiple names must
11324>>>>>//   be null-separated. The list of names must be double null-terminated.
11324>>>>>
11324>>>>>// pTo
11324>>>>>//   Pointer to a buffer that contains the name of the destination file or directory. The
11324>>>>>//   buffer can contain mutiple destination file names if the fFlags member specifies
11324>>>>>//   FOF_MULTIDESTFILES. Multiple names must be null-separated. The list of names must be
11324>>>>>//   double null-terminated.
11324>>>>>
11324>>>>>// fAnyOperationsAborted
11324>>>>>//   Value that receives TRUE if the user aborted any file operations before they
11324>>>>>//   were completed or FALSE otherwise.
11324>>>>>
11324>>>>>
11324>>>>>// Performs a copy, move, rename, or delete operation on a file system object.
11324>>>>>// This can be a file or a folder.
11324>>>>>// With thanks to Andrew S Kaplan
11324>>>>>External_function vWin32_SHFileOperation "SHFileOperationA" Shell32.dll ;        Pointer lpFileOp Returns Integer
11325>>>>>
11325>>>>>
11325>>>>>// Thanks To Oliver Nelson for posting this code on the newsgroups
11325>>>>>External_function vWin32_GetWindowsDirectory "GetWindowsDirectoryA" kernel32.dll ;                           Pointer lpBuffer Integer nSize Returns Integer
11326>>>>>
11326>>>>>
11326>>>>>
11326>>>>>// Courtesy Of Vincent Oorsprong
11326>>>>>//External_Function vWin32_GetTempFileName "GetTempFileNameA" Kernel32.Dll ;
11326>>>>>//   Pointer lpPathName ;
11326>>>>>//   Pointer lpPrefixString ;
11326>>>>>//   Integer uUnique ;
11326>>>>>//   Pointer lpTempFileName ;
11326>>>>>//   Returns Integer
11326>>>>>// **WvA: 28-04-2005 Changed string parameter type into pointers
11326>>>>>External_function vWin32_GetTempFileName "GetTempFileNameA" kernel32.dll Pointer lpsPath ;        Pointer lpsPrefix Integer iUnique Pointer pLoad Returns Integer
11327>>>>>
11327>>>>>External_function vWin32_GetTempPath "GetTempPathA" Kernel32.Dll ;   Dword nBufferLength ;   Pointer lpBuffer ;   Returns Integer
11328>>>>>
11328>>>>>External_function vWin32_DeleteFile "DeleteFileA" Kernel32.Dll ;   Pointer lpFileName ;   Returns Integer
11329>>>>>                  
11329>>>>>// from:
11329>>>>>// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/enums/csidl.asp
11329>>>>>//
11329>>>>>Define vCSIDL_FLAG_CREATE       For |CI$8000 // IE5+, use this to create a special folder
11329>>>>>Define vCSIDL_ADMIN_TOOLS       For |CI$0030 // IE5+, The file system directory that is used to store administrative tools for an individual user
11329>>>>>Define vCSIDL_ALT_STARTUP       For |CI$001D // The file system directory that corresponds to the user's nonlocalized Startup program group
11329>>>>>Define vCSIDL_APPDATA           For |CI$001A // Version 4.71. The file system directory that serves as a common repository for application-specific data. A typical path is C:\Documents and Settings\<username>\Application Data
11329>>>>>Define vCSIDL_BITBUCKET         For |CI$000A // The virtual folder containing the objects in the user's Recycle Bin
11329>>>>>Define vCSIDL_CDBURN_AREA       For |CI$003B // IE6+ The file system directory acting as a staging area for files waiting to be written to CD. A typical path is C:\Documents and Settings\<username>\Local Settings\Application Data\Microsoft\CD Burning
11329>>>>>Define vCSIDL_COMMON_ADMINTOOLS For |CI$002F // IE5+ The file system directory containing administrative tools for all users of the computer
11329>>>>>Define vCSIDL_COMMON_ALTSTARTUP For |CI$001E // The file system directory that corresponds to the nonlocalized Startup program group for all users
11329>>>>>Define vCSIDL_COMMON_APPDATA    For |CI$0023 // IE5+ The file system directory containing application data for all users. A typical path is C:\Documents and Settings\All Users\Application Data
11329>>>>>Define vCSIDL_COMMON_DESKTOPDIRECTORY for |CI$0019 // WinNT+ Only, The file system directory that contains files and folders that appear on the desktop for all users. A typical path is C:\Documents and Settings\All Users\Desktop
11329>>>>>Define vCSIDL_COMMON_DOCUMENTS  For |CI$002E // IE5+ The file system directory that contains documents that are common to all users. A typical paths is C:\Documents and Settings\All Users\Documents
11329>>>>>Define vCSIDL_COMMON_FAVORITES  For |CI$001F // The file system directory that serves as a common repository for favorite items common to all users
11329>>>>>Define vCSIDL_COMMON_MUSIC      For |CI$0035 // IE6+ The file system directory that serves as a repository for music files common to all users. A typical path is C:\Documents and Settings\All Users\Documents\My Music
11329>>>>>Define vCSIDL_COMMON_PICTURES   For |CI$0036 // The file system directory that serves as a repository for image files common to all users. A typical path is C:\Documents and Settings\All Users\Documents\My Pictures
11329>>>>>Define vCSIDL_COMMON_PROGRAMS   For |CI$0017 // WinNT+ The file system directory that contains the directories for the common program groups that appear on the Start menu for all users. A typical path is C:\Documents and Settings\All Users\Start Menu\Programs
11329>>>>>Define vCSIDL_COMMON_STARTMENU  For |CI$0016 // WinNT+ The file system directory that contains the programs and folders that appear on the Start menu for all users. A typical path is C:\Documents and Settings\All Users\Start Menu
11329>>>>>Define vCSIDL_COMMON_STARTUP    For |CI$0018 // WinNT+ The file system directory that contains the programs that appear in the Startup folder for all users. A typical path is C:\Documents and Settings\All Users\Start Menu\Programs\Startup
11329>>>>>Define vCSIDL_COMMON_TEMPLATES  For |CI$002D // WinNT+ The file system directory that contains the templates that are available to all users. A typical path is C:\Documents and Settings\All Users\Templates
11329>>>>>Define vCSIDL_COMMON_VIDEO      For |CI$0037 // IE6+ The file system directory that serves as a repository for video files common to all users. A typical path is C:\Documents and Settings\All Users\Documents\My Videos
11329>>>>>Define vCSIDL_COMPUTERSNEARME   For |CI$003D // The folder representing other machines in your workgroup
11329>>>>>Define vCSIDL_CONNECTIONS       For |CI$0031 // The virtual folder representing Network Connections, containing network and dial-up connections
11329>>>>>Define vCSIDL_CONTROLS          For |CI$0003 // The virtual folder containing icons for the Control Panel applications
11329>>>>>Define vCSIDL_COOKIES           For |CI$0021 // The file system directory that serves as a common repository for Internet cookies. A typical path is C:\Documents and Settings\username\Cookies
11329>>>>>Define vCSIDL_DESKTOP           For |CI$0000 // The virtual folder representing the Windows desktop, the root of the namespace
11329>>>>>Define vCSIDL_DESKTOPDIRECTORY  For |CI$0010 // The file system directory used to physically store file objects on the desktop (not to be confused with the desktop folder itself). A typical path is C:\Documents and Settings\username\Desktop
11329>>>>>Define vCSIDL_DRIVES            For |CI$0011 // The virtual folder representing My Computer, containing everything on the local computer: storage devices, printers, and Control Panel. The folder may also contain mapped network drives
11329>>>>>Define vCSIDL_FAVORITES         For |CI$0006 // The file system directory that serves as a common repository for the user's favorite items. A typical path is C:\Documents and Settings\username\Favorites
11329>>>>>Define vCSIDL_FONTS             For |CI$0014 // A virtual folder containing fonts. A typical path is C:\Windows\Fonts
11329>>>>>Define vCSIDL_HISTORY           For |CI$0022 // The file system directory that serves as a common repository for Internet history items
11329>>>>>Define vCSIDL_INTERNET          For |CI$0001 // A virtual folder representing the Internet
11329>>>>>Define vCSIDL_INTERNET_CACHE    For |CI$0020 // Comctl4.72+, The file system directory that serves as a common repository for temporary Internet files. A typical path is C:\Documents and Settings\username\Local Settings\Temporary Internet Files
11329>>>>>Define vCSIDL_LOCAL_APPDATA     For |CI$001C // IE5+ The file system directory that serves as a data repository for local (nonroaming) applications. A typical path is C:\Documents and Settings\username\Local Settings\Application Data
11329>>>>>Define vCSIDL_MYDOCUMENTS       For |CI$000C // IE6+ The virtual folder representing the My Documents desktop item
11329>>>>>Define vCSIDL_MYMUSIC           For |CI$000D // The file system directory that serves as a common repository for music files. A typical path is C:\Documents and Settings\User\My Documents\My Music
11329>>>>>Define vCSIDL_MYPICTURES        For |CI$0027 // IE5+ The file system directory that serves as a common repository for image files. A typical path is C:\Documents and Settings\username\My Documents\My Pictures
11329>>>>>Define vCSIDL_MYVIDEO           For |CI$000E // IE6+ The file system directory that serves as a common repository for video files. A typical path is C:\Documents and Settings\username\My Documents\My Videos
11329>>>>>Define vCSIDL_NETHOOD           For |CI$0013 // A file system directory containing the link objects that may exist in the My Network Places virtual folder. It is not the same as CSIDL_NETWORK, which represents the network namespace root. A typical path is C:\Documents and Settings\username\NetHood
11329>>>>>Define vCSIDL_NETWORK           For |CI$0012 // A virtual folder representing Network Neighborhood, the root of the network namespace hierarchy
11329>>>>>Define vCSIDL_PERSONAL          For |CI$0005 // (Documents folder) IE6 The virtual folder representing the My Documents desktop item.
11329>>>>>                                             // This is equivalent to CSIDL_MYDOCUMENTS. Previous to Version 6.0. The file system directory used to physically store a user's common repository of documents. A typical path is C:\Documents and Settings\username\My Documents
11329>>>>>Define vCSIDL_PHOTOALBUMS       For |CI$0045 // Vista+ The virtual folder used to store photo albums, typically username\My Pictures\Photo Albums
11329>>>>>Define vCSIDL_PLAYLISTS         For |CI$003F // Vista+ The virtual folder used to store play albums, typically username\My Music\Playlists
11329>>>>>Define vCSIDL_PRINTERS          For |CI$0004 // The virtual folder containing installed printers
11329>>>>>Define vCSIDL_PRINTHOOD         For |CI$001B // The file system directory that contains the link objects that can exist in the Printers virtual folder. A typical path is C:\Documents and Settings\username\PrintHood
11329>>>>>Define vCSIDL_PROFILE           For |CI$0028 // IE5+ The user's profile folder. A typical path is C:\Documents and Settings\username
11329>>>>>Define vCSIDL_PROGRAM_FILES     For |CI$0026 // IE5+ The Program Files folder. A typical path is C:\Program Files
11329>>>>>Define vCSIDL_PROGRAM_FILESx86  for |CI$002A // The Program Files folder for x86 programs. A typical path is C:\Program Files (x86)
11329>>>>>Define vCSIDL_PROGRAM_FILES_COMMON For |CI$002B // IE5+, WinNT+ A folder for components that are shared across applications. A typical path is C:\Program Files\Common
11329>>>>>Define vCSIDL_PROGRAMS          For |CI$0002 // The file system directory that contains the user's program groups (which are themselves file system directories). A typical path is C:\Documents and Settings\username\Start Menu\Programs
11329>>>>>Define vCSIDL_RECENT            For |CI$0008 // The file system directory that contains shortcuts to the user's most recently used documents. A typical path is C:\Documents and Settings\username\My Recent Documents
11329>>>>>Define vCSIDL_RESOURCES         For |CI$0038 // undocumented
11329>>>>>Define vCSIDL_SAMPLE_MUSIC      For |CI$0040 // Vista+, The file system directory that contains sample music. A typical path is C:\Documents and Settings\username\My Documents\My Music\Sample Music
11329>>>>>Define vCSIDL_SAMPLE_PLAYLISTS  For |CI$0041 // Vista+, The file system directory that contains sample playlists. A typical path is C:\Documents and Settings\username\My Documents\My Music\Sample Playlists
11329>>>>>Define vCSIDL_SAMPLE_PICTURES   For |CI$0042 // Vista+, The file system directory that contains sample pictures. A typical path is C:\Documents and Settings\username\My Documents\My Pictures\Sample Pictures
11329>>>>>Define vCSIDL_SAMPLE_VIDEOS     For |CI$0043 // Vista+, The file system directory that contains sample videos. A typical path is C:\Documents and Settings\username\My Documents\My Videos\Sample Videos
11329>>>>>Define vCSIDL_SENDTO            For |CI$0009 // The file system directory that contains Send To menu items. A typical path is C:\Documents and Settings\username\SendTo
11329>>>>>Define vCSIDL_STARTMENU         For |CI$000B // The file system directory containing Start menu items. A typical path is C:\Documents and Settings\username\Start Menu
11329>>>>>Define vCSIDL_STARTUP           For |CI$0007 // The file system directory that corresponds to the user's Startup program group. The system starts these programs whenever any user logs onto Windows NT or starts Windows 95. A typical path is C:\Documents and Settings\username\Start Menu\Programs\Startup
11329>>>>>Define vCSIDL_SYSTEM            For |CI$0025 // The Windows System folder. A typical path is C:\Windows\System32
11329>>>>>Define vCSIDL_SYSTEMX86         For |CI$0029 //
11329>>>>>Define vCSIDL_TEMPLATES         For |CI$0015 // The file system directory that serves as a common repository for document templates. A typical path is C:\Documents and Settings\username\Templates
11329>>>>>Define vCSIDL_WINDOWS           For |CI$0024 // The Windows directory or SYSROOT. This corresponds to the %windir% or %SYSTEMROOT% environment variables. A typical path is C:\Windows
11329>>>>>
11329>>>>>
11329>>>>>//HRESULT SHGetFolderPath(
11329>>>>>//    HWND hwndOwner,
11329>>>>>//    int nFolder,
11329>>>>>//    HANDLE hToken,
11329>>>>>//    DWORD dwFlags,
11329>>>>>//    LPTSTR pszPath
11329>>>>>//);
11329>>>>>// This function is a superset of SHGetSpecialFolderPath, included with earlier versions of
11329>>>>>// the shell. It is implemented in a redistributable DLL, SHFolder.dll, that also simulates
11329>>>>>// many of the new shell folders on older platforms such as Windows 95, Windows 98, and
11329>>>>>// Windows NT 4.0. This DLL always calls the current platform's version of this function.
11329>>>>>// If that fails, it will try to simulate the appropriate behavior.
11329>>>>>//
11329>>>>>External_function vWin32_SHGetFolderPath "SHGetFolderPathA" SHFolder.Dll ;   Pointer hWnd ;   Integer nFolder ;   Pointer hToken ;   DWord   dwFlags ;   Pointer lpszPath ;   Returns Integer
11330>>>>>
11330>>>>>
11330>>>>>
11330>>>>>Type vWin32_Find_Data
11330>>>>>  Field vWin32_Find_Data.dwFileAttributes As Dword
11330>>>>>  Field vWin32_Find_Data.ftCreationLowDateTime As Dword
11330>>>>>  Field vWin32_Find_Data.ftCreationHighDateTime As Dword
11330>>>>>  Field vWin32_Find_Data.ftLastAccessLowDateTime As dword
11330>>>>>  Field vWin32_Find_Data.ftLastAccessHighDateTime As Dword
11330>>>>>  Field vWin32_Find_Data.ftLastWriteLowDateTime As Dword
11330>>>>>  Field vWin32_Find_Data.ftLastWriteHighDateTime As Dword
11330>>>>>  Field vWin32_Find_Data.nFileSizeHigh As Dword
11330>>>>>  Field vWin32_Find_Data.nFileSizeLow As Dword
11330>>>>>  Field vWin32_Find_Data.dwReserved0 As Dword
11330>>>>>  Field vWin32_Find_Data.dwReserved1 As Dword
11330>>>>>  Field vWin32_Find_Data.cFileName As Char vMax_Path
11330>>>>>  Field vWin32_Find_Data.cAlternateFileName As Char 14
11330>>>>>End_Type // vWin32_Find_Data
11330>>>>>
11330>>>>>// Courtesy Of Vincent Oorsprong
11330>>>>>// lpFileName      : address of name of file to search for
11330>>>>>// lpFindFileData  : address of returned information
11330>>>>>External_function vWin32_FindFirstFile "FindFirstFileA"  Kernel32.dll Pointer lpFileName ;          Pointer lpFindFileData Returns Handle
11331>>>>>
11331>>>>>// Courtesy Of Vincent Oorsprong
11331>>>>>// hFindFile       : handle of search
11331>>>>>// lpFindFileData  : address of structure for data on found file
11331>>>>>External_function vWin32_FindNextFile "FindNextFileA" Kernel32.dll Handle hFindFile ;          Pointer lpFindFileData Returns Integer
11332>>>>>
11332>>>>>// Courtesy Of Vincent Oorsprong
11332>>>>>//  hFindFile      : file search handle
11332>>>>>External_function vWin32_FindClose "FindClose" Kernel32.dll Handle hFindFile Returns Integer
11333>>>>>
11333>>>>>
11333>>>>>
11333>>>>>Type vFileTime
11333>>>>>  Field vFileTime.dwLowDateTime As Dword
11333>>>>>  Field vFileTime.dwHighDateTime As Dword
11333>>>>>End_Type // vFileTime
11333>>>>>
11333>>>>>
11333>>>>>Type vSystemTime
11333>>>>>  Field vSystemTime.wYear As Word
11333>>>>>  Field vSystemTime.wMonth As Word
11333>>>>>  Field vSystemTime.wDayOfWeek As Word
11333>>>>>  Field vSystemTime.wDay As Word
11333>>>>>  Field vSystemTime.wHour As Word
11333>>>>>  Field vSystemTime.wMinute As Word
11333>>>>>  Field vSystemTime.wSecond As Word
11333>>>>>  Field vSystemTime.wMilliSeconds As Word
11333>>>>>End_Type // vSystemTime
11333>>>>>
11333>>>>>
11333>>>>>// Courtesy Of Vincent Oorsprong
11333>>>>>//  lpFileTime     : pointer to file time to convert
11333>>>>>//  lpSystemTime   : pointer to structure to receive system time
11333>>>>>External_function vWin32_FileTimeToSystemTime "FileTimeToSystemTime" Kernel32.Dll ;          Pointer lpFileTime Pointer lpsystemTime Returns Integer
11334>>>>>
11334>>>>>// Courtesy Of Vincent Oorsprong
11334>>>>>// This function formats the time in a picture-string passed
11334>>>>>//
11334>>>>>// Picture      Meaning
11334>>>>>//    h         Hours with no leading zero for single-digit hours; 12-hour clock
11334>>>>>//    hh        Hours with leading zero for single-digit hours; 12-hour clock
11334>>>>>//    H         Hours with no leading zero for single-digit hours; 24-hour clock
11334>>>>>//    HH        Hours with leading zero for single-digit hours; 24-hour clock
11334>>>>>//    m         Minutes with no leading zero for single-digit minutes
11334>>>>>//    mm        Minutes with leading zero for single-digit minutes
11334>>>>>//    s         Seconds with no leading zero for single-digit seconds
11334>>>>>//    ss        Seconds with leading zero for single-digit seconds
11334>>>>>//    t         One character time marker string, such as A or P
11334>>>>>//    tt        Multicharacter time marker string, such as AM or PM
11334>>>>>//
11334>>>>>// For example, to get the time string  "11:29:40 PM"
11334>>>>>//    use the following picture string: "hh" : "mm" : "ss tt"
11334>>>>>
11334>>>>>External_function vWin32_GetTimeFormat "GetTimeFormatA" Kernel32.Dll ;  Dword LCID Dword dwFlags Pointer lpsSystemTime Pointer lpFormat Pointer lpTimeStr ;  Integer cchTime Returns Integer
11335>>>>>
11335>>>>>
11335>>>>>// Courtesy Of Vincent Oorsprong
11335>>>>>// This function formats the date in a picture-string passed
11335>>>>>//
11335>>>>>// Picture      Meaning
11335>>>>>//    d         Day of month as digits with no leading zero for single-digit days.
11335>>>>>//    dd        Day of month as digits with leading zero for single-digit days.
11335>>>>>//    ddd       Day of week as a three-letter abbreviation. The function uses the
11335>>>>>//              LOCALE_SABBREVOAYMAME value associated with the specified locale.
11335>>>>>//    dddd      Day of week as its full name. The function uses the LOCALE_SDAYNAME
11335>>>>>//              value associated with the specified locale.
11335>>>>>//    M         Month as digits with no leading zero for single-digit months.
11335>>>>>//    MM        Month as digits with leading zero for single-digit months.
11335>>>>>//    MMM       Month as a three-letter abbreviation. The function uses the
11335>>>>>//              LOCALE_SABBREVMONTHNAME value associated with the specified locale.
11335>>>>>//    MMMM      Month as its full name. The function uses the LOCALE_SMONTHNAME value
11335>>>>>//              associated with the specified locale.
11335>>>>>//    y         Year as last two digits, but with no leading zero for years less than 10.
11335>>>>>//    yy        Year as last two digits, but with leading zero for years less than 10.
11335>>>>>//    yyyy      Year represented hy full four digits.
11335>>>>>//    gg        Period/era string. The function uses the CAL_SERASTRING value associated
11335>>>>>//              with the specified locale. This element is ignored if the date to be formatted
11335>>>>>//              does not have an associated era or period string.
11335>>>>>// For example, to get the date string  "Wed, Aug 31 94"
11335>>>>>// use the following picture string:    "ddd","MMM dd yy"
11335>>>>>
11335>>>>>External_function vWin32_GetDateFormat "GetDateFormatA" Kernel32.Dll ;  Dword LCID Dword dwFlags Pointer lpsSystemTime Pointer lpFormat Pointer lpDateStr ;  Integer cchDate Returns Integer
11336>>>>>
11336>>>>>Define LOCALE_NOUSEROVERRIDE    For |CI$80000000  //  do not use user overrides
11336>>>>>Define TIME_NOMIHUTESORSECONDS  For |CI$0000000l  //  do not use minutes or seconds
11336>>>>>Define TIME_NOSECONDS           For |CI$00000002  //  do not use seconds
11336>>>>>Define TIME_NOTIMEMARKER        For |CI$00000004  //  do not use time marker
11336>>>>>Define TIME_FORCE24HOURFORMAT   For |CI$00000008  //  always use 24 hour format
11336>>>>>
11336>>>>>//  Date Flags for GetDateFormatW.
11336>>>>>//
11336>>>>>Define DATE_SHORTDATE           For |CI$0000000l  //  use short date picture
11336>>>>>Define DATE_LONGDATE            For |CI$00000002  //  use long date picture
11336>>>>>Define DATE_USE_ALT_CALENDAR    For |CI$00000004  //  use alternate calendar (if any)
11336>>>>>
11336>>>>>
11336>>>>>External_function vWin32_SetLastError "SetLastError" Kernel32.Dll Dword dwLastError Returns Integer
11337>>>>>
11337>>>>>
11337>>>>>// **WvA: 20-02-2004
11337>>>>>// While i was testing the format capabilities i stumbled over a very
11337>>>>>// weird problem where it looks like that the integer value gets somehow translated
11337>>>>>// incorrectly into an unsigned integer.
11337>>>>>// I don't have the time to dive into this.. so added a workaround (and removed it again)
11337>>>>>// It does smell a bit fishy though
11337>>>>>// Tested it with the same results on both VDF7 and VDF9.1
11337>>>>>
11337>>>>>Define SHFMT_ID_DEFAULT        For |CI$0000FFFF // The default format ID
11337>>>>>Define SHFMT_OPT_DEFAULT       For |CI$00000000 // The default "Quick Format" option.
11337>>>>>Define SHFMT_OPT_FULL          For |CI$00000001 // Deselects the "Quick Format" option, providing a full format instead. This is useful when an unformatted disk is detected.
11337>>>>>Define SHFMT_OPT_SYSONLY       For |CI$00000002 // Selects the "Create an MS-DOS startup disk" option, creating a system boot disk.
11337>>>>>
11337>>>>>// Possible errors that can be returned by the shellformat function
11337>>>>>Define SHFMT_ERROR             For (|CI$FFFFFFFF+1) // An error occurred during the last format or no drive parameter passed. This does not indicate that the disk is unformatable.
11337>>>>>Define SHFMT_CANCEL            For (|CI$FFFFFFFE+1) // The last format was canceled.
11337>>>>>Define SHFMT_NOFORMAT          For (|CI$FFFFFFFD+1) // The drive cannot be formatted.
11337>>>>>                                                
11337>>>>>
11337>>>>> // Courtesy Of Steve Walter,
11337>>>>> // USA Software, Inc
11337>>>>> // Format a disk
11337>>>>> // Called By:  Move (vWin32_ShFormatDrive(hWnd,0,$FFFF,1)) To dwReturn
11337>>>>>External_function vWin32_ShFormatDrive "SHFormatDrive" shell32.dll Handle hWnd ;         Integer iDrive Integer iFormatID Integer iOptions Returns DWORD
11338>>>>>
11338>>>>>// Michael Mullan.  I Wanted to create all the folders in one statement...
11338>>>>>
11338>>>>>// SHCreateDirectoryEx
11338>>>>>
11338>>>>>//    Note  This function is available through Microsoft Windows XP Service Pack 2 (SP2) and Windows Server 2003.
11338>>>>>//    It might be altered or unavailable in subsequent versions of Windows.
11338>>>>>//
11338>>>>>//    This function creates a file system folder whose fully qualified path is given by pszPath. If one or more
11338>>>>>//    of the intermediate folders do not exist, they are created as well. SHCreateDirectoryEx also verifies that
11338>>>>>//    the files are visible. If they are not visible, expect one of the following:
11338>>>>>//
11338>>>>>//        * If hwnd is set to a valid window handle, a message box is displayed warning the user that he or she
11338>>>>>//        might not be able to access the files. If the user chooses not to proceed, the function returns
11338>>>>>//        ERROR_CANCELLED.
11338>>>>>//        * If hwnd is set to NULL, no user interface is displayed and the function returns ERROR_CANCELLED.
11338>>>>>
11338>>>>>//        Returns ERROR_SUCCESS if successful. If the operation fails, other error codes can be returned,
11338>>>>>//        including those listed here. For values not specifically listed, see System Error Codes.
11338>>>>>//      161  ERROR_BAD_PATHNAME                The pszPath parameter was set to a relative path.
11338>>>>>//      206  ERROR_FILENAME_EXCED_RANGE     The path pointed to by pszPath is too long.
11338>>>>>//      3    ERROR_PATH_NOT_FOUND            The system cannot find the path pointed to by pszPath. The path may contain an invalid entry.
11338>>>>>//      80   ERROR_FILE_EXISTS                The directory exists.
11338>>>>>//      183  ERROR_ALREADY_EXISTS            The directory exists.
11338>>>>>//      1223 ERROR_CANCELLED                The user canceled the operation.
11338>>>>>
11338>>>>>//        int SHCreateDirectoryEx(
11338>>>>>//            HWND hwnd,
11338>>>>>//            LPCTSTR pszPath,
11338>>>>>//            const SECURITY_ATTRIBUTES *psa
11338>>>>>//        );
11338>>>>>
11338>>>>>External_function vWin32_SHCreateDirectoryEx "SHCreateDirectoryExA" shell32.dll Handle hWnd;                  pointer pszPath  Pointer lpSecurity_Attributes Returns Integer
11339>>>
11339>>>
11339>>>
11339>>>
11339>>>
11339>>>//
11339>>>// Gets the string from the right of the last sStopChar in sFrom
11339>>>// If sStopChar has no occurences in the string an empty string is
11339>>>// returned.
11339>>>Function StringFromRightOfChar Global String sFrom String sStopChar Returns String
11341>>>  String  sRetVal
11341>>>  String  sChar
11341>>>  Integer iLength
11341>>>  Integer iPos
11341>>>  Boolean bStopChar
11341>>>  Move "" To sRetval
11342>>>  Move (Length(sFrom)) To iLength
11343>>>  If ((iLength>0) And (Pos(sStopChar,sFrom) <> 0)) Begin
11345>>>    Move iLength   To iPos
11346>>>    Move (False)   To bStopChar
11347>>>    While Not bStopChar
11351>>>      Move (Mid(sFrom,1,iPos)) To sChar
11352>>>      Decrement iPos
11353>>>      If ((sChar=sStopChar) Or (iPos<1)) Begin
11355>>>        Move (True) To bStopChar
11356>>>      End
11356>>>>
11356>>>      Else Begin
11357>>>        Move (sChar+sRetVal) To sRetVal
11358>>>      End
11358>>>>
11358>>>    Loop
11359>>>>
11359>>>  End
11359>>>>
11359>>>  Function_Return sRetVal
11360>>>End_Function // StringFromRightOfChar
11361>>>
11361>>>
11361>>>// Pre:  sFileName contains the complete path of the file.
11361>>>// Post: returns the complete path of the file.
11361>>>// This function is inspired on function SEQ_ExtractPathFromFileName of Sture Andersen.
11361>>>Function ParseFolderName Global String sFileName Returns String
11363>>>  String sFile
11363>>>  String sFolderName
11363>>>  String sDirSep // this is "\" for windows, or "/" for unix
11363>>>  MOve "" To sFolderName
11364>>>  Move (sysconf(SYSCONF_DIR_SEPARATOR)) To sDirSep
11365>>>  If sDirSep In sFileName Begin
11367>>>    Move (StringFromRightOfChar(sFileName,sDirSep)) To sFile
11368>>>    Move (Replace(sFile,sFileName,"")) To sFolderName
11369>>>  End
11369>>>>
11369>>>  Else If ":" In sFileName Begin
11372>>>    Move (StringFromRightOfChar(sFileName,":")) To sFile
11373>>>    Move (Replace(sFile,sFileName,"")) To sFolderName
11374>>>  End
11374>>>>
11374>>>  Function_Return sFolderName
11375>>>End_Function // ParseFolderName
11376>>>
11376>>>
11376>>>// Pre:  sFileName contains the complete path of the file.
11376>>>// post: The returned filename has it's path removed, but will have a extension
11376>>>Function ParseFileName Global String sFileName Returns String
11378>>>  String sFolderName
11378>>>  String sDirSep // this is "\" for windows, or "/" for unix
11378>>>  Move (sysconf(SYSCONF_DIR_SEPARATOR)) To sDirSep
11379>>>  Get ParseFolderName sFileName To sFolderName
11380>>>  If (sFolderName <> "") Begin
11382>>>    Move (Replace(sFolderName,sFileName,"")) to sFileName
11383>>>  End
11383>>>>
11383>>>  Move (Replace(sDirSep,sFileName,"")) To sFileName
11384>>>  Function_Return sFilename
11385>>>End_Function // ParseFileName
11386>>>
11386>>>
11386>>>// Pre:  sFileName may contain the complete path of the file.
11386>>>//       or contain multiple dots in the filename, so temp.gif.bak will
11386>>>//       return "bak" as the extension and not "gif"
11386>>>// Post: returns the extension only, this extension can be a valid unixlike extension
11386>>>//       such as "html" or "java"
11386>>>Function ParseFileExtension Global String sFileName Returns String
11388>>>  String  sFileExtension
11388>>>  Get StringFromRightOfChar sFileName "." To sFileExtension
11389>>>  Function_Return sFileExtension
11390>>>End_Function // ParseFileExtension
11391>>>
11391>>>
11391>>>Define CS_DDE_ERR_UNKNOWN_LINE2   For ".\n"
11391>>>
11391>>>
11391>>>Function DDE_Error_To_String Integer iErrorID Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11393>>>  String sMessage
11393>>>  Case Begin
11393>>>    Case (iErrorID = vERROR_FILE_NOT_FOUND)
11395>>>      Move CS_DDE_ERR_FILE_NOT_FOUND To sMessage
11396>>>      Case Break
11397>>>    Case (iErrorID = vERROR_PATH_NOT_FOUND)
11400>>>      Move CS_DDE_ERR_PATH_NOT_FOUND To sMessage
11401>>>      Case Break
11402>>>    Case (iErrorID = vERROR_BAD_FORMAT)
11405>>>      Move CS_DDE_ERR_BAD_FORMAT To sMessage
11406>>>      Case Break
11407>>>    Case (iErrorID = vSE_ERR_ACCESSDENIED)
11410>>>      Move CS_DDE_ERR_ACCESSDENIED To sMessage
11411>>>      Case Break
11412>>>    Case (iErrorID = vSE_ERR_ASSOCINCOMPLETE)
11415>>>      Move CS_DDE_ERR_ASSOCINCOMPLETE To sMessage
11416>>>      Case Break
11417>>>    Case (iErrorID = vSE_ERR_DDEBUSY)
11420>>>      Move CS_DDE_ERR_DDEBUSY To sMessage
11421>>>      Case Break
11422>>>    Case (iErrorID = vSE_ERR_DDEFAIL)
11425>>>      Move CS_DDE_ERR_DDEFAIL To sMessage
11426>>>      Case Break
11427>>>    Case (iErrorID = vSE_ERR_DDETIMEOUT)
11430>>>      Move CS_DDE_ERR_DDETIMEOUT To sMessage
11431>>>      Case Break
11432>>>    Case (iErrorID = vSE_ERR_DLLNOTFOUND)
11435>>>      Move CS_DDE_ERR_DLLNOTFOUND To sMessage
11436>>>      Case Break
11437>>>    Case (iErrorID = vSE_ERR_NOASSOC)
11440>>>      Move CS_DDE_ERR_NOASSOC To sMessage
11441>>>      Case Break
11442>>>    Case ((iErrorID = vSE_ERR_OOM) Or (iErrorID = 0))
11445>>>      Move CS_DDE_ERR_OOM To sMessage
11446>>>      Case Break
11447>>>    Case (iErrorID = vSE_ERR_PNF)
11450>>>      Move CS_DDE_ERR_PNF To sMessage
11451>>>      Case Break
11452>>>    Case (iErrorID = vSE_ERR_SHARE)
11455>>>      Move CS_DDE_ERR_SHARE To sMessage
11456>>>      Case Break
11457>>>    Case Else
11457>>>      Move CS_DDE_ERR_UNKNOWN_LINE1 To sMessage
11458>>>      Move (sMessage*Trim(iErrorID)*CS_DDE_ERR_UNKNOWN_LINE2) To sMessage
11459>>>      Case Break
11460>>>  Case End
11460>>>  Function_Return sMessage
11461>>>End_Function // DDE_Error_To_String
11462>>>
11462>>>
11462>>>Procedure vDDE_Error_Handler Integer iErrorID
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11464>>>  String sMessage
11464>>>  Get DDE_Error_To_String iErrorID To sMessage
11465>>>  Append sMessage CS_DDE_ERR_HANDL_PAKTC //  "Press a key to continue..."
11466>>>  Send Stop_Box sMessage CS_DDE_ERR_HANDL_CAPTION
11467>>>End_Procedure // vDDE_Error_Handler hInstance
11468>>>
11468>>>
11468>>>// Does the directory exist? - No = 0, Yes = 1
11468>>>// This also works with UNC path encoding and wildcards
11468>>>Function vFolderExists Global String sFolderName Returns Integer
11470>>>  String  sFolder sTmp
11470>>>  Integer bFolderExists iCh
11470>>>
11470>>>  // 2013-09-29 NGS Check for empty folder name and convert to ANSI
11470>>>  Move (ToANSI(Trim(sFolderName))) to sFolderName
11471>>>  If (sFolderName = "") Begin
11473>>>    Function_Return False
11474>>>  End
11474>>>>
11474>>>
11474>>>  Move dfTrue To bFolderExists
11475>>>  Move "dir:" To sFolder
11476>>>  Append sFolder sFolderName
11477>>>  Get Seq_New_Channel To iCh  // get free channel for input
11478>>>  Direct_Input Channel iCh sFolder
11480>>>    Repeat
11480>>>>
11480>>>      Readln Channel iCh sTmp
11482>>>      If (Trim(sTmp)="") Begin
11484>>>        Move False to bFolderExists
11485>>>      End
11485>>>>
11485>>>      Else Begin
11486>>>        Move True to bFolderExists
11487>>>        Move True to SeqEof // end loop
11488>>>        End
11488>>>>
11488>>>    Until (seqeof)
11490>>>  Close_Input Channel iCh
11492>>>  Send Seq_Release_Channel iCh
11493>>>  Function_Return bFolderExists
11494>>>End_Function  // vFolderExists
11495>>>
11495>>>
11495>>>// returns folder name if a folder was selected, otherwise returns ""
11495>>>Function vSHBrowseForFolder Global String sDialogTitle Returns String
11497>>>  String sFolder sBrowseInfo sTitle
11497>>>  Pointer lpItemIdList lpsFolder lpsBrowseInfo lpsTitle
11497>>>  Integer iFolderSelected iRetval
11497>>>
11497>>>  // fill string variable with null characters
11497>>>  ZeroType vtBrowseInfo To sBrowseInfo
11498>>>
11498>>>  If (sDialogTitle<>"") Begin
11500>>>    Move sDialogTitle To sTitle
11501>>>    // Torben Lund suggested converting the string with toansi. Doing it like that
11501>>>    // disables showing some commonly used ascii characters like ascii 137 ()
11501>>>    // These chars are correctly shown if no toansi is used.
11501>>>    // I can imagine that he wanted to path to be ANSI, but as long as it isa just
11501>>>    // selected it will always be valid.
11501>>>    Move (AddressOf(sTitle)) to lpsTitle
11502>>>    Put lpsTitle To sBrowseInfo At vtBrowseInfo.lpszTitle
11503>>>  End
11503>>>>
11503>>>
11503>>>  Put vBIF_RETURNONLYFSDIRS To sBrowseInfo At vtBrowseInfo.ulFlags
11504>>>
11504>>>  // Torben Lund added line below. Move handle of focus object to structure before
11504>>>  // calling function. Otherwise, the folderdialog will be started as a seperate task.
11504>>>  Put (window_handle(focus(desktop))) To sBrowseInfo At vtBrowseInfo.hWndOwner
11505>>>
11505>>>  Move (AddressOf(sBrowseInfo)) to lpsBrowseInfo
11506>>>
11506>>>  // null 128 chars into var (make space)
11506>>>  Move (Repeat(Character(0), vMAX_PATH)) To sFolder
11507>>>  Move (AddressOf(sFolder)) to lpsFolder
11508>>>
11508>>>  // select folder
11508>>>  Move (vWin32_SHBrowseForFolder(lpsBrowseInfo)) To lpItemIdList
11509>>>  // get selected folder name
11509>>>  Move (vWin32_SHGetPathFromIDList(lpItemIdList, lpsFolder)) To iFolderSelected
11510>>>
11510>>>  // release memory resources that are used by the ItemIdList
11510>>>  Move (vWin32_CoTaskMemFree(lpItemIdList)) To iRetval
11511>>>
11511>>>  If (iFolderSelected<>0) Begin
11513>>>    Function_Return (CString(sFolder))
11514>>>  End
11514>>>>
11514>>>  Else Begin
11515>>>    Function_Return ""
11516>>>  End
11516>>>>
11516>>>End_Function // vSHBrowseForFolder
11517>>>
11517>>>
11517>>>// returns 0 if the folder is created.
11517>>>//         1 if the API-call returned an error.
11517>>>Function vCreateDirectory Global String sNewFolder Returns Integer
11519>>>  String  sFolder sSA
11519>>>  Pointer lpsFolder lpsSecurity_Attributes lpDescriptor
11519>>>  Integer iRetval bFolderCreated bInheritHandle
11519>>>
11519>>>  Move (False) To bFolderCreated
11520>>>  // fill string variable with null characters
11520>>>  ZeroType vtSecurity_attributes To sSA
11521>>>
11521>>>  // null MAX_PATH chars into var (make space)
11521>>>  Move (Repeat(Character(0), vMAX_PATH)) To sFolder
11522>>>
11522>>>  If (sNewFolder <> "") Begin
11524>>>
11524>>>    Move dfTrue To  bInheritHandle
11525>>>    // Setting this to NULL is already done by the zerotype command
11525>>>    // Move NULL   To  lpDescriptor
11525>>>    Put (length(sSA))   To sSA At vtSecurity_attributes.nLength
11526>>>    //Put lpDescriptor To sSA at vtSecurity_attributes.lpDescriptor
11526>>>    Put bInheritHandle To sSA At vtSecurity_attributes.bInheritHandle
11527>>>
11527>>>    Move (AddressOf(sSA)) to lpsSecurity_Attributes
11528>>>
11528>>>    //
11528>>>    Move sNewFolder To sFolder
11529>>>    Move (AddressOf(sFolder)) to lpsFolder
11530>>>    Move (vWin32_CreateDirectory(lpsFolder, lpsSecurity_Attributes)) To bFolderCreated
11531>>>  End
11531>>>>
11531>>>
11531>>>  If (not(bFolderCreated)) Begin
11533>>>    Move 1 to iRetVal
11534>>>  End
11534>>>>
11534>>>  Function_Return iRetVal
11535>>>End_Function // vCreateDirectory
11536>>>
11536>>>
11536>>>// **WvA: 03-02-2002 Function created.
11536>>>// With this function one can remove a directory.
11536>>>// returns 0 if the folder is removed.
11536>>>//         1 if the API-call returned an error (Use GetLastError API to get the details)
11536>>>//         2 if the folder did not exist
11536>>>//         3 if the sFolder parameter passed is equal to ""
11536>>>Function vRemoveDirectory Global String sFolder Returns Integer
11538>>>  String  sPath
11538>>>  Pointer lpsPath
11538>>>  Integer iRetval bRemoved
11538>>>
11538>>>  Move (False) To bRemoved
11539>>>  Move 0 To iRetVal
11540>>>  Move (Trim(sFolder)) To sFolder
11541>>>  If (sFolder="") Begin
11543>>>    Move 3 To iRetVal
11544>>>  End
11544>>>>
11544>>>  If (vFolderExists(sFolder)=False) Begin
11546>>>    Move 2 To iRetVal
11547>>>  End
11547>>>>
11547>>>  If (iRetVal=0) Begin
11549>>>    // null MAX_PATH chars into var (make space)
11549>>>    Move (Repeat(Character(0), vMAX_PATH)) To sPath
11550>>>    //
11550>>>    Move (Insert(sFolder,sPath,1)) To sPath
11551>>>    Move (AddressOf(sPath)) to lpsPath
11552>>>    Move (vWin32_RemoveDirectory(lpsPath)) To bRemoved
11553>>>  End
11553>>>>
11553>>>
11553>>>  If ((iRetVal=0) And (bRemoved=False)) Begin
11555>>>    Move 1 To iRetVal
11556>>>  End
11556>>>>
11556>>>  Function_Return iRetVal
11557>>>End_Function // vRemoveDirectory
11558>>>
11558>>>
11558>>>
11558>>>// This function informs the user that he entered a yet unknown folder and
11558>>>// asks if he/she wants to create the folder (Yes/No)
11558>>>// Choice: "Yes" - this creates the folder
11558>>>//                 if successful, the function returns false
11558>>>//                 else it will be true.
11558>>>// Choice: "No"  - returns TRUE, This allows the programmer to take action
11558>>>//                 For example: to stop a save
11558>>>// Precondition: A foldername must be entered. We do not check for empty paths
11558>>>// This function returns a non-zero value if the folder isn't created afterwards
11558>>>Function vVerifyNewFolder Global String sFolderName Returns Integer
11560>>>  Integer bIsNotValid
11560>>>  Integer iUsers_Choice
11560>>>  String  sMessage
11560>>>
11560>>>  If (vFolderExists(sFolderName) Eq 0) Begin
11562>>>    Move "The folder '" To sMessage
11563>>>    Append sMessage sFolderName
11564>>>    Append sMessage "' does not yet exist,\n"
11565>>>    Append sMessage "Do you want to create it now?"
11566>>>    Get YesNo_Box sMessage "Confirm" MB_DefButton1 To iUsers_Choice
11567>>>    Case Begin
11567>>>      Case (iUsers_Choice = MBR_Yes)
11569>>>        Move (vCreateDirectory(sFolderName)) To bIsNotValid
11570>>>        If bIsNotValid Begin
11572>>>          Move "An error occurred while trying to create folder '" To sMessage
11573>>>          Append sMessage sFolderName "'.\n\n"
11575>>>          Send Info_Box sMessage "Info"
11576>>>          End
11576>>>>
11576>>>        Case Break
11577>>>      Case (iUsers_Choice = MBR_No)
11580>>>        Move dfTrue To bIsNotValid // Cancel the save
11581>>>        Case Break
11582>>>    Case End
11582>>>  End
11582>>>>
11582>>>  Function_Return bIsNotValid
11583>>>End_Function // vVerifyNewFolder
11584>>>
11584>>>
11584>>>// This will perform an operation on a file (e.g. open) with the application
11584>>>// registered in the Windows Registry to open that type of file (via its extension)
11584>>>// sOperation would be "OPEN" (it could also be "PRINT" etc).
11584>>>Procedure vShellExecute global String sOperation String sDocument String sParameters String sPath
11586>>>  Handle  hInstance hWnd
11586>>>  Pointer lpsOperation
11586>>>  Pointer lpsDocument
11586>>>  Pointer lpsParameters
11586>>>  Pointer lpsPath
11586>>>  // remove any leading/trailing spaces in the string
11586>>>  Move (Trim(sDocument)) To sDocument
11587>>>  Move (Trim(sPath))     To sPath
11588>>>  // Make the strings readable for windows API, by converting them to null-terminated
11588>>>  Append sOperation   (Character(0))
11589>>>  Append sDocument    (Character(0))
11590>>>  Append sParameters  (Character(0))
11591>>>  Append sPath        (Character(0))
11592>>>  // Connect the corresponding pointers to the strings
11592>>>  Move (AddressOf(sOperation))  to lpsOperation
11593>>>  Move (AddressOf(sDocument))   to lpsDocument
11594>>>  Move (AddressOf(sParameters)) To lpsParameters
11595>>>  Move (AddressOf(sPath))       to lpsPath
11596>>>
11596>>>  Get Window_Handle To hWnd
11597>>>  Move (vWin32_ShellExecute (hWnd, lpsOperation, lpsDocument, lpsParameters, lpsPath, 1)) To hInstance
11598>>>  If (hInstance <= 32) Begin
11600>>>    Send vDDE_Error_Handler hInstance
11601>>>  End
11601>>>>
11601>>>End_Procedure // vShellExecute
11602>>>
11602>>>
11602>>>Class cShellFileOperations Is a Array
11603>>>
11603>>>  Procedure Construct_Object
11605>>>    Forward Send Construct_Object
11607>>>    Property Integer piDeleteFlags 0
11608>>>    Property Integer piCopyFlags   0
11609>>>    Property Integer piMoveFlags   0
11610>>>    Property Integer piRenameFlags 0
11611>>>
11611>>>    Set piDeleteFlags To (vFOF_SILENT Ior vFOF_NOCONFIRMATION)
11612>>>    Set piCopyFlags   To (vFOF_SILENT iOr vFOF_NOCONFIRMMKDIR Ior vFOF_NOCONFIRMATION)
11613>>>    Set piMoveFlags   To (vFOF_SILENT iOr vFOF_NOCONFIRMMKDIR iOr vFOF_NOCONFIRMATION)
11614>>>    Set piRenameFlags To (vFOF_SILENT Ior vFOF_NOCONFIRMATION)
11615>>>  End_Procedure // Construct_Object
11616>>>
11616>>>
11616>>>  // This function uses the shell API to perform a file operation on the
11616>>>  // files supplied.
11616>>>  //
11616>>>  Function FileOperation String sSource String sDestination Integer iOperation Integer iFlags Returns Integer
11618>>>    String   sShFileOp
11618>>>    Pointer  lpShFileOp
11618>>>    Pointer  lpsSource
11618>>>    Pointer  lpsDestination
11618>>>    Integer  iRetVal
11618>>>    Integer  bUserAbort
11618>>>
11618>>>    ZeroType vtShFileOpStruct To sShFileOp
11619>>>    Move (ToAnsi(sSource)+Character(0)+Character(0))      To sSource
11620>>>    Move (ToAnsi(sDestination)+Character(0)+Character(0)) To sDestination
11621>>>    Move (AddressOf(sSource))    To lpsSource
11622>>>    If iOperation Ne vFO_DELETE Begin
11624>>>      Move (AddressOf(sDestination))      To lpsDestination
11625>>>      Put lpsDestination To sShFileOp At vtShFileOpStruct.pTo
11626>>>    End
11626>>>>
11626>>>
11626>>>    Put iOperation     To sShFileOp At vtShFileOpStruct.wFunc
11627>>>    Put lpsSource      To sShFileOp At vtShFileOpStruct.pFrom
11628>>>    Put iFlags         To sShFileOp At vtShFileOpStruct.fFlags
11629>>>
11629>>>    Move (AddressOf(sShFileOp)) to lpShFileOp
11630>>>
11630>>>    Move (vWin32_SHFileOperation(lpShFileOp)) To iRetVal
11631>>>    GetBuff From sShFileOp At vtShFileOpStruct.fAnyOperationsAborted To bUserAbort
11632>>>    If (bUserAbort <> 0) Begin
11634>>>      Move 80 To iRetVal  // file Operation Aborted by USER
11635>>>    End
11635>>>>
11635>>>    Function_Return (iRetVal)
11636>>>  End_Function // FileOperation
11637>>>
11637>>>
11637>>>  Function sfoDeleteFile String sFileName Returns Integer
11639>>>    Integer  iRetVal
11639>>>    Integer  iFlags
11639>>>
11639>>>    Get piDeleteFlags To iFlags
11640>>>    Get FileOperation sFileName "" vFO_DELETE iFlags To iRetVal
11641>>>    Function_Return iRetVal
11642>>>  End_Function // sfoDeleteFile
11643>>>
11643>>>
11643>>>  Function sfoCopyFile String sSource String sDestination Returns Integer
11645>>>    Integer  iRetVal
11645>>>    Integer  iFlags
11645>>>
11645>>>    Get piCopyFlags To iFlags
11646>>>    Get FileOperation sSource sDestination vFO_COPY iFlags To iRetVal
11647>>>    Function_Return iRetVal
11648>>>  End_Function // sfoCopyFile
11649>>>
11649>>>
11649>>>  Function sfoMoveFile String sSource String sDestination Returns Integer
11651>>>    Integer  iRetVal
11651>>>    Integer  iFlags
11651>>>
11651>>>    Get piMoveFlags To iFlags
11652>>>    Get FileOperation sSource sDestination vFO_MOVE iFlags To iRetVal
11653>>>    Function_Return iRetVal
11654>>>  End_Function // sfoMoveFile
11655>>>
11655>>>
11655>>>  // Rename a file or folder
11655>>>  // Returns a nonzero value if the operation failed.
11655>>>  Function sfoRenameFile String sSource String sDestination Returns Integer
11657>>>    Integer  iRetVal
11657>>>    Integer  iFlags
11657>>>
11657>>>    Get piRenameFlags To iFlags
11658>>>    Get FileOperation sSource sDestination vFO_RENAME iFlags To iRetVal
11659>>>    Function_Return iRetVal
11660>>>  End_Function // sfoRenameFile
11661>>>
11661>>>  // Courtesy Of Steve Walter
11661>>>  // Requires Windows 2000 and up according to msdn but it was
11661>>>  //  in fact available before that as an unpublished API call
11661>>>  //  a little google search shows that this was already available
11661>>>  //  in windows 95 and NT
11661>>>  //
11661>>>  // The format is controlled by the dialog interface.
11661>>>  // That is, the user must click the OK button To actually Begin the format
11661>>>  // the format cannot be started programmatically.
11661>>>  // An alternative to this functionality would be to use a controlpanel
11661>>>  //  http://www.vdf-guidance.com/ContribPage.asp?Page=PKGCLSDFCPLAPP&ContribRecId=93
11661>>>  //
11661>>>  // hWnd = The windows handle of the object from which the format Function
11661>>>  //        is called.
11661>>>  // To Get this,
11661>>>  //          use:  Get Window_Handle Of <object>
11661>>>  //          For instance, in this app, we're going to use the Report_Panel:
11661>>>  //                  Get Window_Handle Of (Report_Panel(Main(Self))) To hWind
11661>>>  //
11661>>>  // sDrive = The drive letter. At this moment only A and B are valid
11661>>>  //
11661>>>  // iOptions = Format options.
11661>>>  //  SHFMT_OPT_DEFAULT = Quick format
11661>>>  //  SHFMT_OPT_FULL    = Full Format
11661>>>  //  SHFMT_OPT_SYSONLY = System only
11661>>>  //  3                 = Full format with system. (unsupported)
11661>>>  //
11661>>>  // Return Values:
11661>>>  //  SHFMT_ERROR    = Error on format or no drive specified.
11661>>>  //  SHFMT_CANCEL   = Format cancelled by user.
11661>>>  //  SHFMT_NOFORMAT = Drive is not formatable.
11661>>>  //
11661>>>  //
11661>>>  // *** ATTENTION: This function has been disabled as it doesn't
11661>>>  //                seem to work, i must have made a silly mistake
11661>>>  //                somewhere.
11661>>>  //
11661>>>  Function sfoFormatDisk String sDrive Integer iOptions Returns DWORD
11663>>>    Handle   hWnd
11663>>>    Integer  iObj
11663>>>    DWORD    dwReturnVal
11663>>>    Integer iDrive
11663>>>
11663>>>    Function_Return (1) // STOP HERE
11664>>>
11664>>>    Move (Trim(sDrive)) To sDrive
11665>>>    If ( sDrive <> '' ) Begin
11667>>>      If ( sDrive contains ':' ) Begin
11669>>>        Move (Replace(':',sDrive,'')) to sDrive
11670>>>      End
11670>>>>
11670>>>      If (not( 'AB' contains sDrive )) Begin
11672>>>         Function_Return (SHFMT_NOFORMAT)
11673>>>      End
11673>>>>
11673>>>      If ( sDrive = 'A') Begin
11675>>>        Move 0 to iDrive
11676>>>      End
11676>>>>
11676>>>      Else If ( sDrive = 'B') Begin
11679>>>        Move 1 to iDrive
11680>>>      End
11680>>>>
11680>>>      // Window_Handle Of Desktop equals to 0
11680>>>
11680>>>      Get focus Of desktop To iObj
11681>>>      If (iObj>desktop) ;          Get Container_Handle Of iObj To hWnd
11684>>>      While (hWnd=0 And iObj<>Desktop)
11688>>>          Get Parent Of iObj To iObj
11689>>>          Get Container_Handle Of iObj To hWnd
11690>>>      End
11691>>>>
11691>>>
11691>>>      //Showln "hWnd = " hWnd " iDrive " iDrive " iOptions " iOptions
11691>>>      Move (vWin32_ShFormatDrive(hWnd, iDrive, SHFMT_ID_DEFAULT, iOptions)) To dwReturnVal
11692>>>    End
11692>>>>
11692>>>    Else Begin
11693>>>      Move (SHFMT_ERROR) To dwReturnVal
11694>>>    End
11694>>>>
11694>>>    Function_Return dwReturnVal
11695>>>  End_Function // sfoFormatDisk
11696>>>
11696>>>  //Example:
11696>>>  // Get sfoFormatDisk 'A' 0 To dReturnVal    // Formats drive A in QuickFormat
11696>>>  //                                          mode.
11696>>>
11696>>>End_Class // cShellFileOperations
11697>>>
11697>>>
11697>>>Object oShellFileOperations Is a cShellFileOperations
11699>>>End_Object // oShellFileOperations
11700>>>
11700>>>
11700>>>// Restore to the old way of working with the shell file operations.
11700>>>// or.. to put lay man terms, allow any of the operations vDeleteFile
11700>>>// vCopyFile/vMoveFile/vRenameFile to have an UNDO
11700>>>Procedure vWin32fhCompatibilityMode
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11702>>>  Integer hoSFO
11702>>>  Integer iFlags
11702>>>
11702>>>  Move (vFOF_SILENT Ior vFOF_NOCONFIRMATION Ior vFOF_ALLOWUNDO) To iFlags
11703>>>  Move (oShellFileOperations(Self)) To hoSFO
11704>>>
11704>>>  Set piDeleteFlags Of hoSFO To iFlags
11705>>>  Set piCopyFlags   Of hoSFO To iFlags
11706>>>  Set piMoveFlags   Of hoSFO To iFlags
11707>>>  Set piRenameFlags Of hoSFO To iFlags
11708>>>End_Procedure // vWin32fhCompatibilityMode
11709>>>
11709>>>
11709>>>Function vDeleteFile Global String sFileName Returns Integer
11711>>>  Integer  iRetVal
11711>>>
11711>>>  Get sfoDeleteFile Of (oShellFileOperations(Self)) sFileName To iRetVal
11712>>>  Function_Return iRetVal
11713>>>End_Function // vDeleteFile
11714>>>
11714>>>
11714>>>Function vCopyFile Global String sSource String sDestination Returns Integer
11716>>>  Integer  iRetVal
11716>>>
11716>>>  Get sfoCopyFile Of (oShellFileOperations(Self)) sSource sDestination To iRetVal
11717>>>  Function_Return iRetVal
11718>>>End_Function // vCopyFile
11719>>>
11719>>>
11719>>>Function vMoveFile Global String sSource String sDestination Returns Integer
11721>>>  Integer  iRetVal
11721>>>
11721>>>  Get sfoMoveFile Of (oShellFileOperations(Self)) sSource sDestination To iRetVal
11722>>>  Function_Return iRetVal
11723>>>End_Function // vMoveFile
11724>>>
11724>>>
11724>>>// Rename a file or folder
11724>>>// Returns a nonzero value if the operation failed.
11724>>>Function vRenameFile Global String sSource String sDestination Returns Integer
11726>>>  Integer  iRetVal
11726>>>
11726>>>  Get sfoRenameFile Of (oShellFileOperations(Self)) sSource sDestination To iRetVal
11727>>>  Function_Return iRetVal
11728>>>End_Function // vRenameFile
11729>>>
11729>>>
11729>>>
11729>>>Function vGetWindowsDirectory Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11731>>>  String  sDirectory
11731>>>  Pointer lpDirectory
11731>>>  Integer iVoid
11731>>>
11731>>>  ZeroString vMAX_PATH To sDirectory
11732>>>  Move (AddressOf(sDirectory)) to lpDirectory
11733>>>
11733>>>  Move (vWin32_GetWindowsDirectory(lpDirectory, vMAX_PATH)) To iVoid
11734>>>  Function_Return (CString(sDirectory))  // **WvA: Changed to CString()
11735>>>End_Function // vGetWindowsDirectory
11736>>>
11736>>>
11736>>>
11736>>>
11736>>>// Courtesy of Marco Kuipers
11736>>>Function vMakeTempFile Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11738>>>    Integer iRetval
11738>>>    String  sTempPath sTempFileName sPrefixString
11738>>>    Pointer lpTempPath lpTempFileName lpPrefixString
11738>>>
11738>>>    Move (Repeat (Character (0), 255)) To sTempPath
11739>>>    Move (AddressOf(sTempPath)) to lpTempPath
11740>>>    Move (vWin32_GetTempPath (255, lpTempPath)) To iRetVal
11741>>>
11741>>>    If (sTempPath = "") Begin
11743>>>       Get_Current_Directory To sTempPath
11744>>>    End
11744>>>>
11744>>>    Move (pad(sTempPath,vMax_Path-14)) To sTempPath // *WvA: 28-04-2005 Quote from msdn: The string cannot be longer than MAX_PATH-14 characters.
11745>>>    Move (Repeat (Character (0), 255)) To sTempFileName
11746>>>    Move (AddressOf(sTempFileName)) To lpTempFileName
11747>>>    Move ("tmp"+character(0)) To sPrefixString // **WvA: 28-04-2005 Added a null
11748>>>    Move (AddressOf(sPrefixString)) To lpPrefixString
11749>>>    Move (AddressOf(sTempPath)) to lpTempPath
11750>>>    Move (vWin32_GetTempFileName (lpTempPath, lpPrefixString, 0, lpTempFileName)) To iRetval
11751>>>    If (iRetval = 0) Begin  // **WvA: 28-04-2005 Changed condition, the api call returns 0 if an error occurs
11753>>>        Move "" To sTempFileName
11754>>>    End
11754>>>>
11754>>>
11754>>>    Function_Return (Cstring(sTempFileName)) // **WvA: 28-04-2005 Cstring added
11755>>>End_Function // vMakeTempFile
11756>>>
11756>>>
11756>>>// This function creates a uniquely named temporary file in folder sPath
11756>>>// The file created will have a prefix based on the first 3 characters in sPrefix
11756>>>// Note that you will have to cleanup the tempfile yourself as the function
11756>>>// does not take care of that.
11756>>>Function vCreateTempFileInPath String sPath String sPrefix Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11758>>>    String sTempFileName
11758>>>    Integer iRetVal
11758>>>    Pointer lpTempFileName
11758>>>    Pointer lpPath
11758>>>    Pointer lpPrefix
11758>>>
11758>>>    Move (ToAnsi(sPath)+Character(0))   To sPath
11759>>>    Move (ToAnsi(sPrefix)+Character(0)) To sPrefix
11760>>>    Move (pad("", vMAX_PATH)) To sTempFileName
11761>>>    Move (AddressOf(sTempFileName)) To lpTempFileName
11762>>>    Move (AddressOf(sPath))         To lpPath
11763>>>    Move (AddressOf(sPrefix))       to lpPrefix
11764>>>
11764>>>    Move (vWin32_GetTempFileName(lpPath, lpPrefix, 0, lpTempFileName)) To iRetVal
11765>>>    Move (Trim(Cstring(sTempFileName))) To sTempFileName
11766>>>    Function_Return sTempFileName
11767>>>End_Function // vCreateTempFileInPath
11768>>>
11768>>>//
11768>>>// Get a specific shell folder for example to get the desktop folder
11768>>>// simply call this function and pass it vCSIDL_DESKTOP
11768>>>//
11768>>>Function vSHGetFolderPath Integer eFolder Returns String
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
11770>>>  String  sFolder
11770>>>  Integer iVoid
11770>>>  Pointer lpsFolder
11770>>>  Handle  hWnd
11770>>>  Move (Window_Handle(focus(desktop))) To hWnd
11771>>>
11771>>>  Move (Repeat(Character(0), vMAX_PATH)) To sFolder
11772>>>  Move (AddressOf(sFolder)) To lpsFolder
11773>>>
11773>>>  Move (vWin32_SHGetFolderPath(hWnd,eFolder, 0, 0,lpsFolder)) To iVoid
11774>>>  Function_Return (CString(sFolder))
11775>>>End_Function // vSHGetFolderPath
11776>>>
11776>>>
11776>>>
11776>>>// Courtesy Of Vincent Oorsprong
11776>>>Function vConvertFileDateTime Global Dword dwLowDateTime Dword dwHighDateTime Returns String
11778>>>  String  sftTime sSystemTime sFormattedTime sFormattedDate
11778>>>  Pointer lpsftTime lpsSystemTime lpsFormattedTime lpsFormattedDate
11778>>>  Integer iSuccess iLenCcTime iDataLength iLenCcDate
11778>>>
11778>>>  ZeroType vFileTime  To sftTime
11779>>>  Put dwLowDateTime  To sftTime At vFileTime.dwLowDateTime
11780>>>  Put dwHighDateTime To sftTime At vFileTime.dwHighDateTime
11781>>>  Move (AddressOf(sftTime)) to lpsftTime
11782>>>
11782>>>  ZeroType vSystemTime To sSystemTime
11783>>>  Move (AddressOf(sSystemTime)) To lpsSystemTime
11784>>>
11784>>>  Move (vWin32_FileTimeToSystemTime (lpsftTime, lpsSystemTime)) To iSuccess
11785>>>  If iSuccess Eq DfTrue Begin
11787>>>    ZeroString 255 To sFormattedTime
11788>>>    Move (AddressOf(sFormattedTime)) To lpsFormattedTime
11789>>>    Length sFormattedTime To iLenCcTime
11790>>>>
11790>>>    Move (vWin32_GetTimeFormat (LOCALE_USER_DEFAULT, 0, lpsSystemTime, 0, ;                             lpsFormattedTime, iLenCcTime)) To iDataLength
11791>>>    ZeroString 255 To sFormattedDate
11792>>>    Move (AddressOf(sFormattedDate)) to lpsFormattedDate
11793>>>    Move (Length(sFormattedDate)) to iLenCcDate
11794>>>    Move (vWin32_GetDateFormat (LOCALE_USER_DEFAULT, 0, lpsSystemTime, 0, ;                             lpsFormattedDate, iLenCcDate)) To iDataLength
11795>>>    Function_Return (Cstring (sFormattedDate)  * Cstring (sFormattedTime))
11796>>>  End // iSuccess
11796>>>>
11796>>>End_Function // vConvertFileDateTime
11797>>>
11797>>>
11797>>>// **WvA Removed, See the cFileSet class for an alternative
11797>>>//Procedure DoBrowseDir String sFilePath
11797>>>//End_Procedure // DoBrowseDir
11797>>>
11797>>>// **WvA:
11797>>>// A windows replacement for the standard function FileExists.
11797>>>// This version will also return (true) for a file when it is open by an application.
11797>>>// Note that you can apply normal windows mask-signs in the filename such as * and ?
11797>>>// Example: Get vFilePathExists "C:\config.sy?"
11797>>>// This will return true if you have a file matching these conditions. (aka config.sys)
11797>>>Function vFilePathExists Global String sFilePathMask Returns Integer
11799>>>  String  sWin32FindData
11799>>>  String  sDirSep
11799>>>  Pointer lpsFilePathMask lpsWin32FindData
11799>>>  Handle  hFindFile
11799>>>  Integer iVoid
11799>>>
11799>>>  Move vINVALID_HANDLE_VALUE To hFindFile
11800>>>  Move (ToANSI(trim(sFilePathMask))) To sFilePathMask
11801>>>
11801>>>  If (length(sFilePathMask)>0) Begin
11803>>>    // 2014-09-29 NGS Remove any trailing dir separators, as they make the function fail.
11803>>>    Move (sysconf(SYSCONF_DIR_SEPARATOR)) to sDirSep
11804>>>    While (Right(sFilePathMask, 1) = sDirSep)
11808>>>      Move (Left(sFilePathMask, Length(sFilePathMask) -1)) to sFilePathMask
11809>>>    Loop
11810>>>>
11810>>>
11810>>>    Move (AddressOf(sFilePathMask)) To lpsFilePathMask
11811>>>    ZeroType vWin32_Find_Data To sWin32FindData
11812>>>    Move (AddressOf(sWin32FindData)) to lpswin32FindData
11813>>>    Move (vWin32_FindFirstFile (lpsFilePathMask, lpsWin32FindData)) To hFindFile
11814>>>    Move (vWin32_FindClose (hFindFile)) To iVoid
11815>>>  End
11815>>>>
11815>>>  Function_Return (hFindFile <> vINVALID_HANDLE_VALUE)
11816>>>End_Function // vFilePathExists
11817>>>
11817>>>
11817>>>// **WvA
11817>>>// Formats a foldername by first trimming it and after that by sticking a
11817>>>// directory separator (/\) to the end if it doesn't have one there already.
11817>>>// The folder may contain a drive letter or UNC encoding.
11817>>>Function vFolderFormat Global String sFolderName Returns String
11819>>>  String sDirSep
11819>>>  Move (sysconf(SYSCONF_DIR_SEPARATOR)) To sDirSep  // normally \ (backslash)
11820>>>  Move (Trim(sFolderName)) To sFolderName
11821>>>  If (Right(sFolderName,1)<>sDirSep) Begin
11823>>>    Move (sFolderName+sDirSep) To sFolderName
11824>>>  End
11824>>>>
11824>>>  Function_Return sFolderName
11825>>>End_Function // vFolderFormat
11826>>>//
11826>>>// Returns the amount of files in the folder (if it exists)
11826>>>// Returns -1 if folder doesn't exist.
11826>>>// The files "." and ".." are not counted.
11826>>>//
11826>>>Function vFolderFileCount Global String sFolderName Returns Integer
11828>>>  Boolean bFound
11828>>>  Handle  hFindFile
11828>>>  Integer iCount  iVoid
11828>>>  Integer iSuccess
11828>>>  Pointer lpsFolderName lpsWin32FindData
11828>>>  String  sWin32FindData
11828>>>  String  sFileName
11828>>>
11828>>>  Move -1 To iCount
11829>>>  Get vFolderFormat sFolderName To sFolderName
11830>>>  Move (sFolderName+"*") To sFolderName // match any filename in the folder
11831>>>  Move (AddressOf(sFolderName)) To lpsFolderName
11832>>>  ZeroType vWin32_Find_Data To sWin32FindData
11833>>>  Move (AddressOf(sWin32FindData)) to lpswin32FindData
11834>>>  Move (vWin32_FindFirstFile (lpsFolderName, lpsWin32FindData)) To hFindFile
11835>>>  Move (hFindFile<>vINVALID_HANDLE_VALUE) To bFound
11836>>>  If (bFound) Begin
11838>>>    Move 0 to iCount
11839>>>  End
11839>>>>
11839>>>  While (bFound)
11843>>>    Increment iCount
11844>>>    GetBuff_String From sWin32FindData At vWin32_Find_Data.cFileName To sFileName
11845>>>    If (sFileName="." or sFileName="..") Begin
11847>>>        Decrement iCount
11848>>>    End
11848>>>>
11848>>>    Move (vWin32_FindNextFile(hFindFile, lpsWin32FindData)) To iSuccess
11849>>>    Move (iSuccess<>0) To bFound
11850>>>  Loop
11851>>>>
11851>>>  Move (vWin32_FindClose (hFindFile)) To iVoid
11852>>>  Function_Return iCount
11853>>>End_Function // vFolderFileCount
11854>>>
11854>>>
11854>>>//
11854>>>// Gets the parent path of the currently supplied path
11854>>>// Returns "" when we are at the root folder.
11854>>>//
11854>>>Function vParentPath Global String sPath Returns String
11856>>>  String sStrip
11856>>>  Integer iLength
11856>>>
11856>>>  If (Right(sPath,1)="\") Begin
11858>>>    Move (Left(sPath,Length(sPath)-1)) To sPath
11859>>>  End
11859>>>>
11859>>>  If (Pos("\",sPath)) Begin
11861>>>    Move (StringFromRightOfChar(sPath,"\")) to sStrip
11862>>>    Move (Length(sStrip)) to iLength
11863>>>    Move (Left(sPath, (Length(sPath) - iLength -1))) to sPath
11864>>>//    Move (Replace(sStrip,sPath,"")) To sPath
11864>>>  End
11864>>>>
11864>>>  Else Begin
11865>>>    Move "" To sPath
11866>>>  End
11866>>>>
11866>>>  Function_Return sPath
11867>>>End_Function // vParentPath
11868>>>
11868>>>// Create the folder, including intermediate directories.
11868>>>// Don't panic if the folder already exists.
11868>>>// Michael Mullan June 2009.
11868>>>Function vshCreateDirectoryEX Global String sNewFolder Returns Integer
11870>>>  String  sFolder sSA
11870>>>  Pointer lpsFolder lpsSecurity_Attributes
11870>>>  Integer iRetval bFolderCreated bInheritHandle
11870>>>  Move (False) to bFolderCreated
11871>>>  // fill string variable with null characters
11871>>>  ZeroType vtSecurity_attributes to sSA
11872>>>  // null MAX_PATH chars into var (make space)
11872>>>  Move (Repeat(Character(0), vMAX_PATH)) to sFolder
11873>>>  If (sNewFolder <> "") Begin
11875>>>    Move dfTrue to  bInheritHandle
11876>>>    // Setting this to NULL is already done by the zerotype command
11876>>>    // Move NULL   To  lpDescriptor
11876>>>    Put (length(sSA))   to sSA At vtSecurity_attributes.nLength
11877>>>    //Put lpDescriptor To sSA at vtSecurity_attributes.lpDescriptor
11877>>>    Put bInheritHandle to sSA At vtSecurity_attributes.bInheritHandle
11878>>>    Move (AddressOf(sSA)) to lpsSecurity_Attributes
11879>>>    //
11879>>>    Move sNewFolder to sFolder
11880>>>    Move (AddressOf(sFolder)) to lpsFolder
11881>>>    Move (vWin32_SHCreateDirectoryEx(0,lpsFolder, lpsSecurity_Attributes)) to bFolderCreated
11882>>>  End
11882>>>>
11882>>>
11882>>>  If (bFolderCreated <> 0) Begin
11884>>>    Move 1 to iRetVal
11885>>>
11885>>>    If (bFolderCreated = 161 ) Begin
11887>>>        Error DFERR_OPERATOR ("Path " + sNewFolder + " is Not Valid (ERROR_BAD_PATHNAME)")
11888>>>>
11888>>>    End
11888>>>>
11888>>>    Else If (bFolderCreated = 206 ) Begin
11891>>>        Error DFERR_OPERATOR ("Path " + sNewFolder + " is Not Valid (ERROR_FILENAME_EXCED_RANGE)")
11892>>>>
11892>>>    End
11892>>>>
11892>>>    Else If (bFolderCreated = 3   ) Begin
11895>>>        Error DFERR_OPERATOR ("Path " + sNewFolder + " is Not Valid (ERROR_PATH_NOT_FOUND)")
11896>>>>
11896>>>    End
11896>>>>
11896>>>    Else If (bFolderCreated = 80  ) Begin
11899>>>        Move 0 to iRetval // "ERROR_FILE_EXISTS"     not really an error
11900>>>    End
11900>>>>
11900>>>    Else If (bFolderCreated = 183 ) Begin
11903>>>        Move 0 to iRetval //  "ERROR_ALREADY_EXISTS"     not really an error
11904>>>    End
11904>>>>
11904>>>    Else If (bFolderCreated = 1223) Begin
11907>>>        Error DFERR_OPERATOR ("Path " + sNewFolder + " is Not Valid (ERROR_CANCELLED)")
11908>>>>
11908>>>    End
11908>>>>
11908>>>    Else Begin
11909>>>        Error DFERR_OPERATOR ("Folder Creation Error # " + String(bfoldercreated) + "\n" + sNewFolder + "(FILE_CREATION_ERROR)")
11910>>>>
11910>>>    End
11910>>>>
11910>>>  End
11910>>>>
11910>>>  Function_Return iRetVal
11911>>>End_Function // vshCreateDirectoryEX
11912>>>
11912>>>
11912>>>Function vWin32_APIFileSize Global string sFileName returns integer
11914>>>     dWord dwFileSizeHigh dwFileSizeLow
11914>>>     integer iFileSize iVoid
11914>>>     handle hFindFile
11914>>>     pointer lpsFilePath lpsWin32FindData
11914>>>     string sWin32FindData
11914>>>
11914>>>     Move (AddressOf(sFileName)) to lpsFilePath
11915>>>
11915>>>     ZeroType vWin32_Find_Data to sWin32FindData
11916>>>     Move (AddressOf(sWin32FindData)) to lpsWin32FindData
11917>>>
11917>>>     move (vWin32_FindFirstFile (lpsFilePath, lpsWin32FindData)) to hFindFile
11918>>>     if (hFindFile<>vINVALID_HANDLE_VALUE) begin
11920>>>         GetBuff From sWin32FindData At vWin32_Find_Data.nFileSizeHigh To dwFileSizeHigh
11921>>>         GetBuff From sWin32FindData At vWin32_Find_Data.nFileSizeLow To dwFileSizeLow
11922>>>     end
11922>>>>
11922>>>     move (vWin32_FindClose (hFindFile)) to iVoid
11923>>>
11923>>>     Move ((dwFileSizeHigh * vMaxDword) + dwFileSizeLow) to iFileSize
11924>>>
11924>>>     function_return iFileSize
11925>>>End_Function  // vWin32_APIFileSize
11926>>>
11926>>>
11926>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\oEditContextMenu.pkg)
11926>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJStandardMenuItemClasses.pkg)
11926>>>>>Use Dfpanel.pkg
Including file: Dfpanel.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfpanel.pkg)
11926>>>>>>>//*************************************************************************
11926>>>>>>>//*
11926>>>>>>>//*  Copyright (c) 1997-2001 Data Access Corporation, Miami Florida,
11926>>>>>>>//*  All rights reserved.
11926>>>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
11926>>>>>>>//*
11926>>>>>>>//************************************************************************/
11926>>>>>>>
11926>>>>>>>// Dfpanel.Pkg
11926>>>>>>>//  09-01-1994 : Created
11926>>>>>>>//
11926>>>>>>>// Author: John J. Tuohy
11926>>>>>>>//
11926>>>>>>>// 11/12/94  Added Save_Environment
11926>>>>>>>// 01/23/95  Added windows help support
11926>>>>>>>// 02/14/95 JJT - Added DFGSINI for 3.01/3.05 dual support of .ini name.
11926>>>>>>>//                and section name
11926>>>>>>>// 02/21/95 JJT - Added Make_dialog_proportional message so compiler is
11926>>>>>>>//                happy
11926>>>>>>>//************************************************************************
11926>>>>>>>// 3.1 Changes  - Added Make_panel_normal
11926>>>>>>>//************************************************************************
11926>>>>>>>// 07/23/96 JJT - New Class names
11926>>>>>>>// 08/10/96 SWB - Changed class colors
11926>>>>>>>// 10/04/96 SWB - Added support for Restored-window position & size
11926>>>>>>>// 10/14/97 JJT - Changed add_components to send message to client. Otherwise when
11926>>>>>>>//                starting maximized w/ no tool or status bar, the client was 0,0 size
11926>>>>>>>// 10/14/97 JJT - added support for saving toolbar and status bar visible status to regsitry
11926>>>>>>>//                (now saved as part of normal shutdown)
11926>>>>>>>//************************************************************************
11926>>>>>>>// VDF8 changes
11926>>>>>>>// 10/23/2001 JJT/SWB - Added Application object support, removed workspace and KEY support.
11926>>>>>>>//                      Removed internal messages Get Restoredxx (X,Y,CX,CY), Parse_complex, Complex_to_String
11926>>>>>>>//                      Removed ghoWorkspace support
11926>>>>>>>
11926>>>>>>>Use Windows.pkg
11926>>>>>>>Use dfcolor.pkg
11926>>>>>>>
11926>>>>>>>
11926>>>>>>>
11926>>>>>>>//
11926>>>>>>>//  Used when help object makes a request to the object requesting help.
11926>>>>>>>//
11926>>>>>>>Use HelpSystemConstants.pkg
11926>>>>>>>
11926>>>>>>>Enumeration_List
11926>>>>>>>  DEFINE amTop
11926>>>>>>>  DEFINE amBottom
11926>>>>>>>  DEFINE amLeft
11926>>>>>>>  DEFINE amRight
11926>>>>>>>End_Enumeration_List
11926>>>>>>>
11926>>>>>>>// Use DFGSINI // access to profile strings-----removed for VDF8
11926>>>>>>>
11926>>>>>>>Use DFAStBar.pkg  // df application status bar
Including file: Dfastbar.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfastbar.pkg)
11926>>>>>>>>>// DfAStbar.pkg - DF Application Status bar
11926>>>>>>>>>//
11926>>>>>>>>>// This expects its parent to understand: (DfPanel.pkg provides this)
11926>>>>>>>>>//    Set Statusbar_id
11926>>>>>>>>>//    Get Client_Id
11926>>>>>>>>>//    Send Add_Border_object to client_id
11926>>>>>>>>>//    Send Remove_Border_object to client_id
11926>>>>>>>>>//
11926>>>>>>>>>//
11926>>>>>>>>>// 07/23/96 JJT - New Class names
11926>>>>>>>>>
11926>>>>>>>>>Register_Procedure Add_Border_Object
11926>>>>>>>>>Register_Procedure Remove_Border_Object
11926>>>>>>>>>
11926>>>>>>>>>
11926>>>>>>>>>Use DFStatBr.pkg
Including file: Dfstatbr.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfstatbr.pkg)
11926>>>>>>>>>>>// DFStatBr.pkg  DFStatusBar
11926>>>>>>>>>>>// 07/23/96 JJT - New Class names
11926>>>>>>>>>>>// 08/14/96 SWB - Added a new interface, as the old one was clumsy and inelegant
11926>>>>>>>>>>>use windows.pkg
11926>>>>>>>>>>>Use CommCtrl.pkg
11926>>>>>>>>>>>Use WinGDI.pkg
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>// PUBLIC INTERFACE
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    METHODS
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    Add_Item            integer iWidth string  sCaptionValue               // obsolete
11926>>>>>>>>>>>//    Item_Display_Style  integer iItem  integer sbLOWERED|sbRAISED|sbNORMAL // obsolete
11926>>>>>>>>>>>
11926>>>>>>>>>>>//    AddPane             Integer cxPane String sText Integer iStyle // append a new pane, create with all three params
11926>>>>>>>>>>>//    DoRestructure                                                  // re-build Status-bar after a change
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    PROCEDURE SET
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    PaneStyle    Integer iPane Integer iStyle                  // style of a pane: sbLOWERED | sbRAISED | sbNORMAL
11926>>>>>>>>>>>//    PaneText     Integer iPane String  sText                   // text within a pane
11926>>>>>>>>>>>//    PaneWidth    Integer iPane Integer cxPane                  // pixel-width of a pane
11926>>>>>>>>>>>//    Simple_State Boolean                                       // switch StatusBar mode
11926>>>>>>>>>>>//    Simple_Value String  sText                                 // text to be displayed in Simple mode
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    FUNCTIONS
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//    PaneCount                                Returns Integer   // how many panes defined, including separators
11926>>>>>>>>>>>//    PaneStyle     Integer iPane              Returns Integer   // style of a pane
11926>>>>>>>>>>>//    PaneText      Integer iPane              Returns String    // text within a pane
11926>>>>>>>>>>>//    PaneTextWidth Integer iPane String sText Returns Integer   // pixel-width of text to be put in a pane
11926>>>>>>>>>>>//    PaneWidth     Integer iPane              Returns Integer   // pixel-width of a pane
11926>>>>>>>>>>>//    Simple_State                             Returns Boolean   // is StatusBar in Simple mode?
11926>>>>>>>>>>>//    Simple_Value                             Returns String    // text to be displayed in Simple mode
11926>>>>>>>>>>>//
11926>>>>>>>>>>>//
11926>>>>>>>>>>>// END INTERFACE
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>
11926>>>>>>>>>>>Class BasicStatusBar is a dfBaseList
11927>>>>>>>>>>>    Procedure Construct_Object
11929>>>>>>>>>>>        Forward Send Construct_Object
11931>>>>>>>>>>>        Property Integer Private.Simple_State False
11932>>>>>>>>>>>
11932>>>>>>>>>>>        Property String  Private.Simple_Value ''
11933>>>>>>>>>>>
11933>>>>>>>>>>>        Property Integer Tooltips_State False // this does nothing
11934>>>>>>>>>>>        Set Scroll_Bar_Visible_State To False
11935>>>>>>>>>>>        Set Border_Style             To Border_None
11936>>>>>>>>>>>        Set External_class_Name "cObsoleteBasicStatusBar" To "msctls_statusbar32"
11937>>>>>>>>>>>        Set Color To clDefault
11938>>>>>>>>>>>    End_procedure
11939>>>>>>>>>>>
11939>>>>>>>>>>>    Procedure End_Construct_Object
11941>>>>>>>>>>>      //If (Tooltips_State(self)) Set Window_Style To SBT_TOOLTIPS True
11941>>>>>>>>>>>      Forward Send End_Construct_Object
11943>>>>>>>>>>>    End_Procedure
11944>>>>>>>>>>>
11944>>>>>>>>>>>    Procedure Set Simple_State integer bState
11946>>>>>>>>>>>        Handle hWnd
11946>>>>>>>>>>>        Set Private.Simple_state to bState
11947>>>>>>>>>>>        Get Window_Handle To hWnd
11948>>>>>>>>>>>        If hWnd Send Windows_Message SB_SIMPLE bState 0
11951>>>>>>>>>>>    end_Procedure
11952>>>>>>>>>>>
11952>>>>>>>>>>>    Function Simple_State returns integer
11954>>>>>>>>>>>       function_return (Private.Simple_state(self))
11955>>>>>>>>>>>    End_Function // Simple_State
11956>>>>>>>>>>>
11956>>>>>>>>>>>    Procedure SET Simple_Value String sValue
11958>>>>>>>>>>>        Pointer lpsValue
11958>>>>>>>>>>>        Integer iVoid
11958>>>>>>>>>>>        Handle hWnd
11958>>>>>>>>>>>
11958>>>>>>>>>>>        Set Private.Simple_Value to sValue
11959>>>>>>>>>>>
11959>>>>>>>>>>>        Get Window_Handle To hWnd
11960>>>>>>>>>>>        If hWnd Begin
11962>>>>>>>>>>>            Append sValue ( Character(0) )
11963>>>>>>>>>>>            GetAddress of sValue To lpsValue
11964>>>>>>>>>>>            Move (OemToAnsi(lpsValue,lpsValue)) To iVoid
11965>>>>>>>>>>>            Send Windows_Message SB_SETTEXT (255 + sbNORMAL) lpsValue
11966>>>>>>>>>>>        End
11966>>>>>>>>>>>>
11966>>>>>>>>>>>        Set Simple_State To TRUE
11967>>>>>>>>>>>    End_Procedure
11968>>>>>>>>>>>
11968>>>>>>>>>>>    Function Simple_Value Returns String
11970>>>>>>>>>>>       function_return (private.Simple_value(self))
11971>>>>>>>>>>>    End_Function // Simple_Value
11972>>>>>>>>>>>
11972>>>>>>>>>>>    Procedure Activate
11974>>>>>>>>>>>    End_Procedure
11975>>>>>>>>>>>
11975>>>>>>>>>>>    Procedure Page_Object Integer iState
11977>>>>>>>>>>>        Integer hWnd
11977>>>>>>>>>>>        Get Window_handle To hWnd
11978>>>>>>>>>>>        Forward Send Page_Object iState
11980>>>>>>>>>>>        IF iState IF hWnd EQ 0 Send DoRestructure
11985>>>>>>>>>>>    End_Procedure
11986>>>>>>>>>>>
11986>>>>>>>>>>>    Procedure Page Integer iState
11988>>>>>>>>>>>      Forward Send Page iState
11990>>>>>>>>>>>      If (iState=1) Begin
11992>>>>>>>>>>>         Send Windows_Message SB_SETBKCOLOR 0 (Color(self))
11993>>>>>>>>>>>      End
11993>>>>>>>>>>>>
11993>>>>>>>>>>>    End_Procedure
11994>>>>>>>>>>>
11994>>>>>>>>>>>    Procedure DoRestructure
11996>>>>>>>>>>>        integer iLoop icItems iWidth icWidth iRetVal
11996>>>>>>>>>>>        Handle hWnd
11996>>>>>>>>>>>        string szPad sItems
11996>>>>>>>>>>>        Pointer lpItems
11996>>>>>>>>>>>
11996>>>>>>>>>>>        Move ( character(0) +character(0) ) To szPad
11997>>>>>>>>>>>
11997>>>>>>>>>>>        Get Window_Handle To hWnd
11998>>>>>>>>>>>        If hWnd Begin
12000>>>>>>>>>>>
12000>>>>>>>>>>>            Send Windows_Message SB_SIMPLE (Simple_State(self)) 0
12001>>>>>>>>>>>
12001>>>>>>>>>>>            Set Simple_Value to (Simple_Value(self))
12002>>>>>>>>>>>
12002>>>>>>>>>>>            Get Item_Count To icItems
12003>>>>>>>>>>>
12003>>>>>>>>>>>            For iLoop from 1 To (icItems -1)
12009>>>>>>>>>>>>
12009>>>>>>>>>>>                Get Message item (iLoop -1) To iWidth
12010>>>>>>>>>>>                Move (icWidth + iWidth) To icWidth
12011>>>>>>>>>>>                Move (sItems +SHORTtoBytes(icWidth) +szPad) To sItems
12012>>>>>>>>>>>                Set Value item (iLoop -1) To (Value(self, iLoop -1))
12013>>>>>>>>>>>            Loop
12014>>>>>>>>>>>>
12014>>>>>>>>>>>            // Now make the last item 'spring' to the end
12014>>>>>>>>>>>            Move (sItems +SHORTtoBytes(9999) +szPad) To sItems
12015>>>>>>>>>>>            GetAddress of sItems to lpItems
12016>>>>>>>>>>>            Move (SendMessage(hWnd, SB_SETPARTS, icItems, lpItems)) To iRetVal
12017>>>>>>>>>>>            For iLoop from 0 To (icItems -1)
12023>>>>>>>>>>>>
12023>>>>>>>>>>>                Set Value item iLoop To (Value(self, iLoop))
12024>>>>>>>>>>>            Loop
12025>>>>>>>>>>>>
12025>>>>>>>>>>>
12025>>>>>>>>>>>        End
12025>>>>>>>>>>>>
12025>>>>>>>>>>>    End_Procedure
12026>>>>>>>>>>>
12026>>>>>>>>>>>    Procedure Add_Item integer iItemWidth string sValue // this is obsolete
12028>>>>>>>>>>>        Integer iRetVal icItems
12028>>>>>>>>>>>        Handle hWnd
12028>>>>>>>>>>>
12028>>>>>>>>>>>        Forward Send Add_Item iItemWidth sValue
12030>>>>>>>>>>>        Get Item_Count To icItems
12031>>>>>>>>>>>        Set Value item (icItems -1) To sValue
12032>>>>>>>>>>>        If (Window_Handle(self)) Send DoRestructure
12035>>>>>>>>>>>        Set Current_item to (icItems -1)
12036>>>>>>>>>>>    End_procedure
12037>>>>>>>>>>>
12037>>>>>>>>>>>    Procedure AddPane integer iItemWidth string sValue Integer iStyle
12039>>>>>>>>>>>        Integer iRetVal icItem
12039>>>>>>>>>>>        Handle hWnd
12039>>>>>>>>>>>
12039>>>>>>>>>>>        Send Add_Item iItemWidth sValue
12040>>>>>>>>>>>        Get Item_Count To icItem
12041>>>>>>>>>>>        Set Value item (icItem -1) To sValue
12042>>>>>>>>>>>        Set Aux_Value item (icItem -1) To iStyle
12043>>>>>>>>>>>        If (Window_Handle(self)) Send DoRestructure
12046>>>>>>>>>>>    End_procedure
12047>>>>>>>>>>>
12047>>>>>>>>>>>    Procedure AutoSizeLocate
12049>>>>>>>>>>>        integer iSize iRetVal
12049>>>>>>>>>>>        Handle hWnd
12049>>>>>>>>>>>        Get Window_Handle To hWnd
12050>>>>>>>>>>>        Delegate Get GuiSize To iSize
12052>>>>>>>>>>>        If hWnd Move (SendMessage(hWnd, WM_SIZE, 0, iSize)) To iRetVal
12055>>>>>>>>>>>    End_Procedure
12056>>>>>>>>>>>
12056>>>>>>>>>>>    Procedure SET Item_Display_Style integer iItem integer iStyle  // this is obsolete, Use PaneStyle
12058>>>>>>>>>>>        If num_arguments eq 2 Set Aux_Value item iItem To iStyle
12061>>>>>>>>>>>        Else Set Aux_Value item (current_item(self)) To iItem //iStyle passed as arg1
12063>>>>>>>>>>>    End_Procedure
12064>>>>>>>>>>>
12064>>>>>>>>>>>    Function Item_Display_Style integer iItem Returns integer // this is obsolete, use PaneStyle
12066>>>>>>>>>>>        Function_Return (Aux_value(self, iItem))
12067>>>>>>>>>>>    End_Function
12068>>>>>>>>>>>
12068>>>>>>>>>>>    Procedure SET Value integer iItem string sValue
12070>>>>>>>>>>>        handle hWnd
12070>>>>>>>>>>>        integer iRetVal iTextStyle iVoid
12070>>>>>>>>>>>        pointer lpszValue
12070>>>>>>>>>>>        String sNull
12070>>>>>>>>>>>        Forward SET Value item iItem To sValue
12072>>>>>>>>>>>        Get Window_Handle To hWnd
12073>>>>>>>>>>>        If hWnd Begin
12075>>>>>>>>>>>            Get Item_Display_Style item iItem To iTextStyle
12076>>>>>>>>>>>            Append sValue ( Character(0) )
12077>>>>>>>>>>>            GetAddress of sValue To lpszValue
12078>>>>>>>>>>>            Move (OemToAnsi(lpszValue,lpszValue)) To iVoid
12079>>>>>>>>>>>            Move (SendMessage(hWnd, SB_SETTEXT, iItem + iTextStyle, lpszValue)) To iRetVal
12080>>>>>>>>>>>        End
12080>>>>>>>>>>>>
12080>>>>>>>>>>>        Set Simple_State To False
12081>>>>>>>>>>>    End_Procedure
12082>>>>>>>>>>>
12082>>>>>>>>>>>   Function IsSimpleMode Returns Integer
12084>>>>>>>>>>>      Function_Return (WindowsMessage(SB_ISSIMPLE, 0, 0))
12085>>>>>>>>>>>   End_Function
12086>>>>>>>>>>>
12086>>>>>>>>>>>    Procedure Notify Integer wParam Integer lParam
12088>>>>>>>>>>>         Integer iVoid iCode
12088>>>>>>>>>>>         Integer iPane
12088>>>>>>>>>>>         String sNmMouse
12088>>>>>>>>>>>         Pointer lpsNmMouse
12088>>>>>>>>>>>
12088>>>>>>>>>>>        ZeroType tNmMouse To sNmMouse
12089>>>>>>>>>>>        GetAddress of sNmMouse To lpsNmMouse
12090>>>>>>>>>>>        Move (CopyMemory(lpsNmMouse, lParam, tNmMouse_size)) To iVoid
12091>>>>>>>>>>>
12091>>>>>>>>>>>        GetBuff from sNmMouse at tNmMouse.hdr.code   To iCode
12092>>>>>>>>>>>        GetBuff from sNmMouse at tNmMouse.dwItemSpec To iPane
12093>>>>>>>>>>>
12093>>>>>>>>>>>        If      (iCode = SBN_SIMPLEMODECHANGE) Send OnSimpleModeChange
12096>>>>>>>>>>>        Else If (iCode = NM_CLICK)             Send OnClick            iPane
12100>>>>>>>>>>>        Else If (iCode = NM_DBLCLK)            Send OnDoubleClick      iPane
12104>>>>>>>>>>>        Else If (iCode = NM_RCLICK)            Send OnRightClick       iPane
12108>>>>>>>>>>>        Else If (iCode = NM_RDBLCLK)           Send OnDoubleRightClick iPane
12112>>>>>>>>>>>    End_Procedure
12113>>>>>>>>>>>
12113>>>>>>>>>>>    //  This needs to be chagned to return the real GUISize of the status bar
12113>>>>>>>>>>>    //  by making API calls.
12113>>>>>>>>>>>    //
12113>>>>>>>>>>>    Function GuiSize Returns Integer
12115>>>>>>>>>>>        Handle hWnd
12115>>>>>>>>>>>        Integer x y x1 y1 cy cx iVoid
12115>>>>>>>>>>>        Pointer lpsRect
12115>>>>>>>>>>>        String sRect
12115>>>>>>>>>>>        Get Window_Handle To hWnd
12116>>>>>>>>>>>        If hWnd Begin
12118>>>>>>>>>>>            ZeroType tRECT To sRect
12119>>>>>>>>>>>            GetAddress of sRect To lpsRect
12120>>>>>>>>>>>            Move (GetWindowRect(hWnd, lpsRect)) To iVoid
12121>>>>>>>>>>>
12121>>>>>>>>>>>            GetBuff From sRect At tRECT.left   To x
12122>>>>>>>>>>>            GetBuff From sRect At tRECT.top    To y
12123>>>>>>>>>>>            GetBuff From sRect At tRECT.right  To x1
12124>>>>>>>>>>>            GetBuff From sRect At tRECT.bottom To y1
12125>>>>>>>>>>>
12125>>>>>>>>>>>            Move (x1-x) To cx
12126>>>>>>>>>>>            Move (y1-y) To cy
12127>>>>>>>>>>>        End
12127>>>>>>>>>>>>
12127>>>>>>>>>>>        Else Begin
12128>>>>>>>>>>>            Move 25 to cy
12129>>>>>>>>>>>            Move 19 to cx
12130>>>>>>>>>>>        End
12130>>>>>>>>>>>>
12130>>>>>>>>>>>        Function_Return ( cy*65536 + cx )
12131>>>>>>>>>>>    End_Function
12132>>>>>>>>>>>
12132>>>>>>>>>>>    Function PaneTextWidth String sText Returns Integer
12134>>>>>>>>>>>        Handle hWnd hDC
12134>>>>>>>>>>>        Integer cx bOK
12134>>>>>>>>>>>        Pointer lpsText lpsPoint
12134>>>>>>>>>>>        String sPoint
12134>>>>>>>>>>>
12134>>>>>>>>>>>        Get Window_Handle To hWnd
12135>>>>>>>>>>>        Move (GetDC(hWnd)) To hDC
12136>>>>>>>>>>>
12136>>>>>>>>>>>        ZeroType tPoint To sPoint
12137>>>>>>>>>>>        GetAddress of sPoint To lpsPoint
12138>>>>>>>>>>>        GetAddress of sText  To lpsText
12139>>>>>>>>>>>
12139>>>>>>>>>>>        Move (GetTextExtent(hDC, lpsText, length(sText), lpsPoint)) To bOk
12140>>>>>>>>>>>
12140>>>>>>>>>>>        Move (ReleaseDC(hWnd, hDC)) To hDC
12141>>>>>>>>>>>
12141>>>>>>>>>>>        GetBuff From sPoint At tPoint.x To cx
12142>>>>>>>>>>>
12142>>>>>>>>>>>        Function_Return cx
12143>>>>>>>>>>>    End_Function
12144>>>>>>>>>>>
12144>>>>>>>>>>>    Procedure Set PaneWidth Integer iPane Integer cxPane
12146>>>>>>>>>>>        Set Message item iPane To cxPane
12147>>>>>>>>>>>    End_Procedure
12148>>>>>>>>>>>
12148>>>>>>>>>>>    Function PaneWidth Integer iPane Returns Integer
12150>>>>>>>>>>>        Function_Return (Message(self,iPane))
12151>>>>>>>>>>>    End_Function
12152>>>>>>>>>>>
12152>>>>>>>>>>>    Procedure Set PaneStyle Integer iPane Integer iStyle
12154>>>>>>>>>>>        Set Aux_Value item iPane To iStyle
12155>>>>>>>>>>>    End_Procedure
12156>>>>>>>>>>>
12156>>>>>>>>>>>    Function PaneStyle Integer iPane Returns Integer
12158>>>>>>>>>>>        Function_Return (Aux_Value(self,iPane))
12159>>>>>>>>>>>    End_Function
12160>>>>>>>>>>>
12160>>>>>>>>>>>    Procedure Set PaneText Integer iPane String sText
12162>>>>>>>>>>>        Set Value item iPane To sText
12163>>>>>>>>>>>    End_Procedure
12164>>>>>>>>>>>
12164>>>>>>>>>>>    Function PaneText Integer iPane Returns String
12166>>>>>>>>>>>        Function_Return (Value(self,iPane))
12167>>>>>>>>>>>    End_Function
12168>>>>>>>>>>>
12168>>>>>>>>>>>    Function PaneCount Returns Integer
12170>>>>>>>>>>>        Function_Return (Item_Count(self))
12171>>>>>>>>>>>    End_Function
12172>>>>>>>>>>>
12172>>>>>>>>>>>    Procedure OnClick Integer iPane
12174>>>>>>>>>>>    End_Procedure
12175>>>>>>>>>>>
12175>>>>>>>>>>>    Procedure OnDoubleClick Integer iPane
12177>>>>>>>>>>>    End_Procedure
12178>>>>>>>>>>>
12178>>>>>>>>>>>    Procedure OnRightClick Integer iPane
12180>>>>>>>>>>>    End_Procedure
12181>>>>>>>>>>>
12181>>>>>>>>>>>    Procedure OnDoubleRightClick Integer iPane
12183>>>>>>>>>>>    End_Procedure
12184>>>>>>>>>>>
12184>>>>>>>>>>>    Procedure OnSimpleModeChange
12186>>>>>>>>>>>    End_Procedure
12187>>>>>>>>>>>End_Class
12188>>>>>>>>>
12188>>>>>>>>>Class AppStatusBar is a BasicStatusBar
12189>>>>>>>>>
12189>>>>>>>>>    Procedure Construct_Object
12191>>>>>>>>>        Forward Send Construct_Object
12193>>>>>>>>>        Property Integer Status_Help_Item 0
12194>>>>>>>>>        Property Integer Menu_Simple_State TRUE
12195>>>>>>>>>
12195>>>>>>>>>        // SET s/b private, Get is public
12195>>>>>>>>>        Property Integer Menu_status_State False // MUST start false
12196>>>>>>>>>
12196>>>>>>>>>        Property Integer Old_Simple_State  false
12197>>>>>>>>>
12197>>>>>>>>>        Property String  Old_Status_Value  ''
12198>>>>>>>>>
12198>>>>>>>>>        Set Popup_State         To TRUE
12199>>>>>>>>>        Set Attach_Parent_State To TRUE
12200>>>>>>>>>         // register status-bar with container
12200>>>>>>>>>        Delegate Set StatusBar_id To self
12202>>>>>>>>>    End_Procedure
12203>>>>>>>>>
12203>>>>>>>>>    Procedure Set Status_Help_Value String sHelp
12205>>>>>>>>>        Integer iPart
12205>>>>>>>>>        Get Status_Help_Item To iPart
12206>>>>>>>>>        Set Value item iPart To sHelp
12207>>>>>>>>>    End_Procedure
12208>>>>>>>>>
12208>>>>>>>>>    Function Status_Help_Value Returns String
12210>>>>>>>>>        Integer iPart
12210>>>>>>>>>        String sHelp
12210>>>>>>>>>        Get Status_Help_Item To iPart
12211>>>>>>>>>        Get Value item iPart To sHelp
12212>>>>>>>>>        Function_Return sHelp
12213>>>>>>>>>    End_Procedure
12214>>>>>>>>>
12214>>>>>>>>>    Procedure Initialize_Menu
12216>>>>>>>>>       Integer iState OldState
12216>>>>>>>>>       If Not (Menu_Status_state(self)) Begin
12218>>>>>>>>>          Get Simple_State to OldState
12219>>>>>>>>>          Set Old_Simple_State to OldState
12220>>>>>>>>>          If OldState ;             Set Old_Status_Value to (Simple_Value(self))
12223>>>>>>>>>          Else ;             Set Old_Status_Value to (Status_Help_Value(self))
12225>>>>>>>>>          Set Simple_State to (Menu_Simple_State(self))
12226>>>>>>>>>          Set Menu_Status_State to TRUE
12227>>>>>>>>>       End
12227>>>>>>>>>>
12227>>>>>>>>>    End_Procedure
12228>>>>>>>>>
12228>>>>>>>>>    Procedure Exit_Menu
12230>>>>>>>>>       Integer OldState
12230>>>>>>>>>       String OldVal
12230>>>>>>>>>       If (Menu_Status_state(self)) Begin
12232>>>>>>>>>          Get Old_Simple_State to OldState
12233>>>>>>>>>          Set Simple_State     to OldState
12234>>>>>>>>>          Get old_status_Value to oldVal
12235>>>>>>>>>          If OldState ;             Set Simple_Value to OldVal
12238>>>>>>>>>          Else ;             Set Status_Help_Value to OldVal
12240>>>>>>>>>          Set Menu_Status_State to FALSE
12241>>>>>>>>>       End
12241>>>>>>>>>>
12241>>>>>>>>>    End_Procedure // Exit_Menu
12242>>>>>>>>>
12242>>>>>>>>>    Procedure Show_Status_Help String sHelp
12244>>>>>>>>>        Integer iState
12244>>>>>>>>>        Get Simple_State to iState
12245>>>>>>>>>        If NOT iState Set Status_Help_Value To sHelp
12248>>>>>>>>>        Else          Set Simple_Value      To sHelp
12250>>>>>>>>>    End_Procedure
12251>>>>>>>>>
12251>>>>>>>>>    Function Current_Status_Help Returns String
12253>>>>>>>>>        Integer iState
12253>>>>>>>>>        String sHelp
12253>>>>>>>>>        Get Simple_State to iState
12254>>>>>>>>>        If NOT iState Get Status_Help_Value To sHelp
12257>>>>>>>>>        Else          Get Simple_Value      To sHelp
12259>>>>>>>>>        Function_Return sHelp
12260>>>>>>>>>    End_Function
12261>>>>>>>>>
12261>>>>>>>>>    Procedure Page_Object Integer bShow
12263>>>>>>>>>        Integer hoClient
12263>>>>>>>>>        Handle hHndl
12263>>>>>>>>>        Get Window_Handle to hHndl
12264>>>>>>>>>        Forward Send Page_Object bShow
12266>>>>>>>>>        If (bShow AND hHndl=0) Begin
12268>>>>>>>>>            Delegate Get Client_Id To hoClient
12270>>>>>>>>>            If hoClient ;               Send Add_Border_Object to hoClient self amBOTTOM
12273>>>>>>>>>        End
12273>>>>>>>>>>
12273>>>>>>>>>    End_Procedure
12274>>>>>>>>>
12274>>>>>>>>>    Procedure Deactivating
12276>>>>>>>>>        Integer hoClient
12276>>>>>>>>>        Delegate Get Client_Id To hoClient
12278>>>>>>>>>        Forward Send DeActivating
12280>>>>>>>>>        If hoClient ;            Send Remove_Border_Object to hoClient self amBOTTOM
12283>>>>>>>>>    End_Procedure
12284>>>>>>>>>
12284>>>>>>>>>End_Class
12285>>>>>>>Use DFABtBar.pkg  // df application button bar
Including file: Dfabtbar.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfabtbar.pkg)
12285>>>>>>>>>// DfAbtbar.pkg - DF Application Button bar
12285>>>>>>>>>//
12285>>>>>>>>>// This expects its parent to understand: (DfPanel.pkg provides this)
12285>>>>>>>>>//    Set Toolbar_id
12285>>>>>>>>>//    Get Client_Id
12285>>>>>>>>>//    Send Add_Border_object to client_id
12285>>>>>>>>>//    Send Remove_Border_object to client_id
12285>>>>>>>>>
12285>>>>>>>>>Register_Procedure Add_Border_Object
12285>>>>>>>>>Register_Procedure Remove_Border_Object
12285>>>>>>>>>
12285>>>>>>>>>Use Windows.pkg
12285>>>>>>>>>
12285>>>>>>>>>Class AppToolBar is a BasicToolBar
12286>>>>>>>>>
12286>>>>>>>>>    Procedure Construct_Object
12288>>>>>>>>>        Forward Send Construct_Object
12290>>>>>>>>>        Set Scope_State         To TRUE
12291>>>>>>>>>        Set Attach_Parent_State To TRUE
12292>>>>>>>>>        Set Popup_State         To TRUE
12293>>>>>>>>>        Set Client_Area_State   To TRUE
12294>>>>>>>>>        Delegate Set ToolBar_Id To self
12296>>>>>>>>>    End_procedure // Construct_object
12297>>>>>>>>>
12297>>>>>>>>>    Procedure Page integer bState
12299>>>>>>>>>        Integer hoClient
12299>>>>>>>>>        Handle  hWnd
12299>>>>>>>>>        Get Window_Handle to hWnd
12300>>>>>>>>>        Forward Send Page bState
12302>>>>>>>>>        If (bState=1 AND hWnd=0) Begin
12304>>>>>>>>>           Delegate Get Client_Id To hoClient
12306>>>>>>>>>           If hoClient ;              Send Add_Border_Object to hoClient self amTOP
12309>>>>>>>>>        End
12309>>>>>>>>>>
12309>>>>>>>>>    End_Procedure
12310>>>>>>>>>
12310>>>>>>>>>    Procedure Deactivating
12312>>>>>>>>>        Integer hoClient
12312>>>>>>>>>        Forward Send DeActivating
12314>>>>>>>>>        Delegate Get Client_Id To hoClient
12316>>>>>>>>>        If hoClient Begin
12318>>>>>>>>>            Send Remove_Border_Object to hoClient self amTOP
12319>>>>>>>>>        End
12319>>>>>>>>>>
12319>>>>>>>>>    End_Procedure
12320>>>>>>>>>
12320>>>>>>>>>    Procedure Set GuiSize Integer cy Integer cx
12322>>>>>>>>>        Forward Set GuiSize to cy cx
12324>>>>>>>>>    End_Procedure
12325>>>>>>>>>
12325>>>>>>>>>    // Container_Handle:
12325>>>>>>>>>    // JvH: 11/26/97 - This function was put in to allow support for combo-form & other
12325>>>>>>>>>    // controls in the toolbar.
12325>>>>>>>>>    Function Container_Handle returns integer
12327>>>>>>>>>        function_return (window_handle(self))
12328>>>>>>>>>    End_Function
12329>>>>>>>>>End_class // DFApp_ButtonBar
12330>>>>>>>Use DFAClnt.pkg   // df application Client
Including file: Dfaclnt.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfaclnt.pkg)
12330>>>>>>>>>// DfAClnt.pkg - DF Application Client area
12330>>>>>>>>>//
12330>>>>>>>>>//  Creates an MDI client area. All views and mdi_dialogs
12330>>>>>>>>>//  will reside in this area
12330>>>>>>>>>//
12330>>>>>>>>>// This expects its parent to understand: (DfPanel.pkg provides this)
12330>>>>>>>>>//    Get Client_Id
12330>>>>>>>>>//
12330>>>>>>>>>// 07/23/96 JJT - New Class names
12330>>>>>>>>>
12330>>>>>>>>>Use Windows.pkg
12330>>>>>>>>>Use Set.pkg
Including file: set.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\set.pkg)
12330>>>>>>>>>>>//************************************************************************
12330>>>>>>>>>>>//
12330>>>>>>>>>>>// Confidential Trade Secret.
12330>>>>>>>>>>>// Copyright 1987-1992 Data Access Corporation, Miami FL, USA
12330>>>>>>>>>>>// All Rights reserved
12330>>>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//     $Source: k:\RCS\.\pkg\set.pkg,v $
12330>>>>>>>>>>>//     $Revision: 1 $
12330>>>>>>>>>>>//     $State: Exp $
12330>>>>>>>>>>>//     $Author: james $
12330>>>>>>>>>>>//     $Date: Apr 01 16:09:27 1997 $
12330>>>>>>>>>>>//     $Locker:  $
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//     $Log: set.pkg,v $
12330>>>>>>>>>>>//Revision 2.1  1993/08/25  17:49:41  james
12330>>>>>>>>>>>//Adding new main branch
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.2  1993/04/28  00:20:34  james
12330>>>>>>>>>>>//Initializing 3.04 source code.
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.1  1992/09/08  14:43:09  james
12330>>>>>>>>>>>//Initial revision
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.4  92/05/14  17:15:20  SWM
12330>>>>>>>>>>>//Updated Copyright slug.
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.3  92/03/09  19:04:28  james
12330>>>>>>>>>>>//Added #CHKSUB directive to insure source
12330>>>>>>>>>>>//only compiled with correct revision of
12330>>>>>>>>>>>//compiler.
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.2  91/11/26  17:43:48  elsa
12330>>>>>>>>>>>//Only a test
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//Revision 1.1  91/10/23  10:22:35  elsa
12330>>>>>>>>>>>//Initial revision
12330>>>>>>>>>>>//
12330>>>>>>>>>>>//************************************************************************/
12330>>>>>>>>>>>
12330>>>>>>>>>>>//************************************************************************
12330>>>>>>>>>>>//     File Name: Set.Pkg
12330>>>>>>>>>>>// Creation Date: January 1, 1991
12330>>>>>>>>>>>// Modified Date: May 23, 1991
12330>>>>>>>>>>>//     Author(s): Steven A. Lowe
12330>>>>>>>>>>>//
12330>>>>>>>>>>>// This module contains the Set class definition.
12330>>>>>>>>>>>//************************************************************************/
12330>>>>>>>>>>>
12330>>>>>>>>>>>
12330>>>>>>>>>>>use VDFBase.pkg
12330>>>>>>>>>>>
12330>>>>>>>>>>>
12330>>>>>>>>>>>class Set is an ARRAY
12331>>>>>>>>>>>
12331>>>>>>>>>>>  Function Find_Element string ElemStr returns integer
12333>>>>>>>>>>>    integer ndx retVal ArrMax
12333>>>>>>>>>>>    string ArrVal
12333>>>>>>>>>>>    get item_count to ArrMax
12334>>>>>>>>>>>    move -1 to retVal
12335>>>>>>>>>>>    move 0 to ndx
12336>>>>>>>>>>>    while (ndx < ArrMax AND retVal = -1)
12340>>>>>>>>>>>      get array_value item ndx to ArrVal
12341>>>>>>>>>>>      if ArrVal eq ElemStr move ndx to retVal
12344>>>>>>>>>>>      Move (ndx + 1) to ndx
12345>>>>>>>>>>>    end
12346>>>>>>>>>>>>
12346>>>>>>>>>>>    function_return retVal
12347>>>>>>>>>>>  end_function
12348>>>>>>>>>>>
12348>>>>>>>>>>>  procedure Add_Element string Elem_Str returns integer
12350>>>>>>>>>>>    integer Ret_Val
12350>>>>>>>>>>>
12350>>>>>>>>>>>    get Find_Element Elem_Str to Ret_Val
12351>>>>>>>>>>>
12351>>>>>>>>>>>    if Ret_Val LT 0 ;        get Item_Count to Ret_Val
12354>>>>>>>>>>>
12354>>>>>>>>>>>    set Array_Value item Ret_Val to Elem_Str
12355>>>>>>>>>>>
12355>>>>>>>>>>>    procedure_return Ret_Val
12356>>>>>>>>>>>  end_procedure
12357>>>>>>>>>>>
12357>>>>>>>>>>>  Procedure Remove_Element string sElement
12359>>>>>>>>>>>    Integer iIndex
12359>>>>>>>>>>>    Get Find_Element sElement to iIndex
12360>>>>>>>>>>>    If (iIndex > -1) Send delete_item iIndex
12363>>>>>>>>>>>  end_procedure
12364>>>>>>>>>>>
12364>>>>>>>>>>>
12364>>>>>>>>>>>end_class
12365>>>>>>>>>>>
12365>>>>>>>>>>>//
12365>>>>>>>>>>>// global function to create set instances at random
12365>>>>>>>>>>>//
12365>>>>>>>>>>>function make_set for cDesktop returns integer
12367>>>>>>>>>>>  integer retval
12367>>>>>>>>>>>  object SetTemplate is a Set
12369>>>>>>>>>>>    move self to retval
12370>>>>>>>>>>>  end_object
12371>>>>>>>>>>>  function_return retval
12372>>>>>>>>>>>end_function
12373>>>>>>>>>>>
12373>>>>>>>>>>>
12373>>>>>>>>>
12373>>>>>>>>>Class AppClientArea is a MdiClientArea
12374>>>>>>>>>
12374>>>>>>>>>    Procedure Construct_Object
12376>>>>>>>>>        Forward Send Construct_Object
12378>>>>>>>>>
12378>>>>>>>>>        Property Integer Auto_Arrange_Icons_State TRUE
12379>>>>>>>>>
12379>>>>>>>>>        Property Integer Private.Client_Scrollbar_State   TRUE
12380>>>>>>>>>
12380>>>>>>>>>        Delegate Set Client_Id to self
12382>>>>>>>>>        // keep track of all child dialog objects (views)
12382>>>>>>>>>
12382>>>>>>>>>        Object Mdi_Dialogs is a Set
12384>>>>>>>>>        End_object
12385>>>>>>>>>
12385>>>>>>>>>        Property Integer Private.Last_Dialog_Item -1
12386>>>>>>>>>    End_Procedure
12387>>>>>>>>>
12387>>>>>>>>>    Procedure Set Client_Scrollbar_State integer bState
12389>>>>>>>>>        Set Scroll_bar_Visible_State to bState
12390>>>>>>>>>        Set Private.Client_Scrollbar_State to bState
12391>>>>>>>>>    End_Procedure // Set Client_Scrollbar_state
12392>>>>>>>>>
12392>>>>>>>>>    Function Client_Scrollbar_State returns integer
12394>>>>>>>>>       function_return (Private.Client_Scrollbar_State(Self))
12395>>>>>>>>>    End_Function // Client_Scrollbar_State
12396>>>>>>>>>
12396>>>>>>>>>    Procedure Add_Mdi_Dialog integer Id#
12398>>>>>>>>>       Send Add_element to (mdi_dialogs(Self)) Id#
12399>>>>>>>>>    End_Procedure
12400>>>>>>>>>
12400>>>>>>>>>    Procedure Remove_Mdi_Dialog Integer Id#
12402>>>>>>>>>       integer obj#
12402>>>>>>>>>       Move (mdi_dialogs(self)) to Obj#
12403>>>>>>>>>       if Obj# Send Remove_element to (mdi_dialogs(Obj#)) Id#
12406>>>>>>>>>    End_Procedure
12407>>>>>>>>>
12407>>>>>>>>>    Function Next_Mdi_Dialog Integer FindFirst returns Integer
12409>>>>>>>>>       integer Id# Item# Obj#
12409>>>>>>>>>       Get Private.Last_dialog_item to Item#
12410>>>>>>>>>       If FindFirst Move -1 to Item#
12413>>>>>>>>>       Increment Item#
12414>>>>>>>>>       Set Private.Last_dialog_item to Item#
12415>>>>>>>>>       Move (Mdi_dialogs(Self)) to Obj#
12416>>>>>>>>>       If (Item_count(Obj#)>Item#) ;          Get Value of Obj# item Item# to Id#
12419>>>>>>>>>       Function_Return Id#
12420>>>>>>>>>    End_Function
12421>>>>>>>>>
12421>>>>>>>>>    Procedure Set GuiSize Integer cy Integer cx
12423>>>>>>>>>        Forward SET GuiSize to cy cx
12425>>>>>>>>>        If (active_state(Self) AND Auto_Arrange_Icons_State(Self)) ;            send Arrange_icons
12428>>>>>>>>>    End_Procedure
12429>>>>>>>>>
12429>>>>>>>>>    Procedure Private.Adjust_MDI_Margins Integer cy Integer cx Integer BorderFlag
12431>>>>>>>>>        Integer cMargin
12431>>>>>>>>>        If BorderFlag eq amTOP Begin
12433>>>>>>>>>            Get mdi_top_margin To cMargin
12434>>>>>>>>>            Set mdi_top_margin To (cMargin + cy)
12435>>>>>>>>>        End
12435>>>>>>>>>>
12435>>>>>>>>>        Else If BorderFlag eq amBOTTOM Begin
12438>>>>>>>>>            Get mdi_bottom_margin To cMargin
12439>>>>>>>>>            Set mdi_bottom_margin To (cMargin + cy)
12440>>>>>>>>>        End
12440>>>>>>>>>>
12440>>>>>>>>>        Else If BorderFlag eq amLEFT Begin
12443>>>>>>>>>            Get mdi_left_margin To cMargin
12444>>>>>>>>>            Set mdi_left_margin To (cMargin + cx)
12445>>>>>>>>>        End
12445>>>>>>>>>>
12445>>>>>>>>>        Else If BorderFlag eq amRIGHT Begin
12448>>>>>>>>>            Get mdi_right_margin To cMargin
12449>>>>>>>>>            Set mdi_right_margin To (cMargin + cx)
12450>>>>>>>>>        End
12450>>>>>>>>>>
12450>>>>>>>>>    End_Procedure
12451>>>>>>>>>
12451>>>>>>>>>    Procedure Add_Border_Object Integer hoBorder Integer BorderFlag
12453>>>>>>>>>        Integer cy cx
12453>>>>>>>>>        Move (hi(GuiSize(hoBorder)))  to cy
12454>>>>>>>>>        Move (low(GuiSize(hoBorder))) to cx
12455>>>>>>>>>
12455>>>>>>>>>        Send Private.Adjust_MDI_Margins cy cx BorderFlag
12456>>>>>>>>>    End_Procedure
12457>>>>>>>>>
12457>>>>>>>>>    Procedure Remove_Border_Object Integer hoBorder Integer BorderFlag
12459>>>>>>>>>        Integer cy cx
12459>>>>>>>>>        Move (-(hi(GuiSize(hoBorder))))  to cy
12460>>>>>>>>>        Move (-(low(GuiSize(hoBorder)))) to cx
12461>>>>>>>>>
12461>>>>>>>>>        Send Private.Adjust_MDI_Margins cy cx BorderFlag
12462>>>>>>>>>    End_Procedure
12463>>>>>>>>>
12463>>>>>>>>>    //
12463>>>>>>>>>    // default behavior of mdi client is to passively pass these
12463>>>>>>>>>    // message on to their mdi dialogs (views)
12463>>>>>>>>>    //
12463>>>>>>>>>    Function Verify_Exit_Application Returns Integer
12465>>>>>>>>>       Integer rVal Id#
12465>>>>>>>>>       Get Next_Mdi_Dialog TRUE to Id#
12466>>>>>>>>>       While (Id# AND Rval=0)
12470>>>>>>>>>          Get Verify_Exit_application of Id# to rVal
12471>>>>>>>>>          If not rval Get Next_Mdi_Dialog FALSE to Id#
12474>>>>>>>>>       End
12475>>>>>>>>>>
12475>>>>>>>>>       function_return rval
12476>>>>>>>>>    End_Function
12477>>>>>>>>>
12477>>>>>>>>>    Procedure Notify_Exit_Application
12479>>>>>>>>>       Integer Id#
12479>>>>>>>>>       Get Next_Mdi_Dialog TRUE to Id#
12480>>>>>>>>>       While Id#
12484>>>>>>>>>          Send Notify_Exit_Application to Id#
12485>>>>>>>>>          Get Next_Mdi_Dialog FALSE to Id#
12486>>>>>>>>>       End
12487>>>>>>>>>>
12487>>>>>>>>>    End_Procedure // Notify_Exit_Application
12488>>>>>>>>>
12488>>>>>>>>>    Procedure Make_all_ViewMode integer Mode
12490>>>>>>>>>       Integer Id#
12490>>>>>>>>>       Get Next_Mdi_Dialog TRUE to Id#
12491>>>>>>>>>       While Id#
12495>>>>>>>>>          If (active_State(Id#)) ; // !!!!FIX!!!! AND View_mode(Id#)<>Mode) ;             Set View_Mode of Id# to Mode
12498>>>>>>>>>          Get Next_Mdi_Dialog FALSE to Id#
12499>>>>>>>>>       End
12500>>>>>>>>>>
12500>>>>>>>>>    End_procedure
12501>>>>>>>>>
12501>>>>>>>>>    Procedure Minimize_all_Windows
12503>>>>>>>>>       Send Make_All_ViewMode VIEWMODE_ICONIZE
12504>>>>>>>>>    End_Procedure
12505>>>>>>>>>
12505>>>>>>>>>    Procedure Restore_all_Windows
12507>>>>>>>>>       Send Make_All_ViewMode VIEWMODE_NORMAL
12508>>>>>>>>>    End_Procedure
12509>>>>>>>>>
12509>>>>>>>>>    // The framework has used activate_about for years to activate an about
12509>>>>>>>>>    // dialog. As of 12.1, we have a sub-class for this and providing the
12509>>>>>>>>>    // required message makes things work better. It is expected that a 
12509>>>>>>>>>    // developer will augment this in their clientarea to call the about
12509>>>>>>>>>    // object that they created. 
12509>>>>>>>>>    Procedure Activate_About
12511>>>>>>>>>    End_Procedure
12512>>>>>>>>>
12512>>>>>>>>>
12512>>>>>>>>>End_Class
12513>>>>>>>>>
12513>>>>>>>Use DFADlg.pkg    // df application Dialog
Including file: Dfadlg.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfadlg.pkg)
12513>>>>>>>>>
12513>>>>>>>>>//  1/4/99  JJT - Destroy_object passes obj instead of self
12513>>>>>>>>>// 01/29/97 JJT - Don't pass self in end_construct_object
12513>>>>>>>>>// 07/23/96 JJT - New Class names
12513>>>>>>>>>// 04/28/96 JJT - Added Activate_View message
12513>>>>>>>>>Use LanguageText.pkg
12513>>>>>>>>>Use Windows.pkg
12513>>>>>>>>>Use dfConfrm.pkg
Including file: Dfconfrm.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfconfrm.pkg)
12513>>>>>>>>>>>//************************************************************************
12513>>>>>>>>>>>//************************************************************************/
12513>>>>>>>>>>>
12513>>>>>>>>>>>//************************************************************************
12513>>>>>>>>>>>// DFConfrm.Pkg
12513>>>>>>>>>>>// Version: 1.0
12513>>>>>>>>>>>// Copyright (c) 1993 2E Software
12513>>>>>>>>>>>// Author: John J. Tuohy
12513>>>>>>>>>>>//  09-01-94   : converted from DAF
12513>>>>>>>>>>>//
12513>>>>>>>>>>>//  11/11/94   JJT - Adjusted size of buttons (1 larger)
12513>>>>>>>>>>>//  03/01/95   JJT - Adjusted size of textbox and vcentered it. removed
12513>>>>>>>>>>>//                   the F2 and and Esc from the buttons (although they
12513>>>>>>>>>>>//                   are still supported with the keys).
12513>>>>>>>>>>>//
12513>>>>>>>>>>>//************************************************************************
12513>>>>>>>>>>>Use LanguageText.pkg
12513>>>>>>>>>>>Use msgbox.pkg
12513>>>>>>>>>>>
12513>>>>>>>>>>>// General purpose confirm function. Added to all classes
12513>>>>>>>>>>>//
12513>>>>>>>>>>>Function Confirm for cUIObject String item_name Returns Integer
12515>>>>>>>>>>>   Integer rval
12515>>>>>>>>>>>   Get YesNo_Box item_name C_$Confirm to rval
12516>>>>>>>>>>>   Function_Return (rval<>MBR_YES)
12517>>>>>>>>>>>End_function
12518>>>>>>>>>>>
12518>>>>>>>>>>>Function Save_Confirmation for cUIObject Returns integer
12520>>>>>>>>>>>  Function_return (confirm(self, C_$SaveThisRecord))
12521>>>>>>>>>>>End_function
12522>>>>>>>>>>>
12522>>>>>>>>>>>Function Delete_Confirmation for cUIObject Returns integer
12524>>>>>>>>>>>  Function_return (confirm(self, C_$DeleteThisRecord))
12525>>>>>>>>>>>End_function
12526>>>>>>>>>>>
12526>>>>>>>>>>>Function Line_Save_Confirmation for cUIObject Returns Integer
12528>>>>>>>>>>>  Function_return (confirm(self, C_$SaveThisLine))
12529>>>>>>>>>>>End_function
12530>>>>>>>>>>>
12530>>>>>>>>>>>Function Line_Delete_Confirmation for cUIObject Returns Integer
12532>>>>>>>>>>>  Function_return (confirm(self, C_$DeleteThisLine))
12533>>>>>>>>>>>End_function
12534>>>>>>>>>>>
12534>>>>>>>>>>>Function Data_Loss_Confirmation for cUIObject Returns integer
12536>>>>>>>>>>>  Function_return (confirm(self, C_$AbandonChanges))
12537>>>>>>>>>>>End_function
12538>>>>>>>>>>>
12538>>>>>>>>>>>Function Exit_Loss_Confirmation for cUIObject Returns integer
12540>>>>>>>>>>>  Integer tmp
12540>>>>>>>>>>>  //Get Should_Save to tmp
12540>>>>>>>>>>>  //if tmp eq 0 broadcast get Should_save_recursive to tmp
12540>>>>>>>>>>>  get Should_save_recursive to tmp
12541>>>>>>>>>>>  if tmp ne 0 Function_return (confirm(self, C_$ChangesExistAbandon))
12544>>>>>>>>>>>End_function
12545>>>>>>>>>>>
12545>>>>>>>>>>>Function No_Confirmation for cUIObject Returns integer
12547>>>>>>>>>>>End_function
12548>>>>>>>>>>>
12548>>>>>>>>>>>Function Should_Save for cUIObject returns integer
12550>>>>>>>>>>>end_function
12551>>>>>>>>>>>
12551>>>>>>>>>>>Function Should_Save_Recursive for cUIObject returns integer
12553>>>>>>>>>>>  Integer rVal
12553>>>>>>>>>>>  Get Should_Save to Rval // changes in this object???
12554>>>>>>>>>>>  If rVal eq 0 BroadCast Get Should_Save_Recursive to Rval // check w/ kids
12558>>>>>>>>>>>  Function_return rVal
12559>>>>>>>>>>>End_Function
12560>>>>>>>>>>>
12560>>>>>>>>>Use GlobalFunctionsProcedures.pkg
12560>>>>>>>>>Use tWinStructs.pkg
12560>>>>>>>>>
12560>>>>>>>>>
12560>>>>>>>>>// as of 15.0, moved some of dbViews features up to this level. Load/Save Environment showing view name
12560>>>>>>>>>Class AppDialog is a MdiDialog
12561>>>>>>>>>    
12561>>>>>>>>>    Procedure Construct_Object
12563>>>>>>>>>        Forward Send Construct_Object
12565>>>>>>>>>
12565>>>>>>>>>        // This can be used to stop this view from loading and saving its environment.
12565>>>>>>>>>        Property Boolean pbDisableSaveEnvironment False
12566>>>>>>>>>        
12566>>>>>>>>>        // set true to auto-activate the view. This does not work if the object is deferred.
12566>>>>>>>>>        // this is a design time property which is applied during end_construct_object. This should
12566>>>>>>>>>        Property Boolean pbAutoActivate False
12567>>>>>>>>>        
12567>>>>>>>>>        // used to keep track of window placment when deactivated object is reactivated.
12567>>>>>>>>>        Property tWinWindowPlacement pWindowPlacement
12568>>>>>>>>>    End_Procedure
12569>>>>>>>>>
12569>>>>>>>>>   Procedure End_Construct_Object
12571>>>>>>>>>      Boolean bAutoActivate
12571>>>>>>>>>      Delegate Send Add_Mdi_Dialog Self
12573>>>>>>>>>      Forward Send End_Construct_Object
12575>>>>>>>>>      // if auto-activate, add this to he the panel's array of objects to be acivated.
12575>>>>>>>>>      Get pbAutoActivate to bAutoActivate
12576>>>>>>>>>      If bAutoActivate Begin
12578>>>>>>>>>           Delegate Send AddAutoActivateView Self  
12580>>>>>>>>>      End
12580>>>>>>>>>>
12580>>>>>>>>>   End_Procedure
12581>>>>>>>>>
12581>>>>>>>>>   Procedure Destroy_Object
12583>>>>>>>>>      integer obj
12583>>>>>>>>>      Move Self to obj
12584>>>>>>>>>      Delegate Send Remove_Mdi_Dialog obj
12586>>>>>>>>>      Forward Send Destroy_Object
12588>>>>>>>>>   End_Procedure // Destroy_Object
12589>>>>>>>>>
12589>>>>>>>>>    // Augmented to save view position
12589>>>>>>>>>    Procedure Notify_Exit_Application
12591>>>>>>>>>        Send Save_Environment
12592>>>>>>>>>    End_Procedure
12593>>>>>>>>>
12593>>>>>>>>>   Function View_Changed returns Integer
12595>>>>>>>>>   End_Function
12596>>>>>>>>>
12596>>>>>>>>>   //
12596>>>>>>>>>   // Augment exit_application_check to see if view is changed. If changed,
12596>>>>>>>>>   // display exit message as required
12596>>>>>>>>>
12596>>>>>>>>>   Function Verify_Exit_Application Returns Integer
12598>>>>>>>>>     Integer Fail
12598>>>>>>>>>     Get View_Changed to Fail // Ask for changes in Data-sets
12599>>>>>>>>>     If fail ; // ok a change exist...activate changed view.        Get confirm (SFormat(C_$ChangesExistExit, Label(self)) ) to fail
12602>>>>>>>>>     Function_return fail
12603>>>>>>>>>   End_Function
12604>>>>>>>>>
12604>>>>>>>>>   // Activates the view. If view is minimized it restores it first
12604>>>>>>>>>   // works with both popup_state T and F
12604>>>>>>>>>
12604>>>>>>>>>   Procedure Activate_View returns Integer
12606>>>>>>>>>      Integer rVal
12606>>>>>>>>>      If ( View_mode(self)=VIEWMODE_ICONIZE ) ;         Set view_mode to viewmode_normal
12609>>>>>>>>>      If (Popup_state(self)) ;    // support both popup and         Get Msg_Popup to rVal
12612>>>>>>>>>      else ;         Get Msg_Activate to rVal
12614>>>>>>>>>      Procedure_Return rVal
12615>>>>>>>>>   End_Procedure // Activate_View
12616>>>>>>>>>
12616>>>>>>>>>
12616>>>>>>>>>    // augmented to load last view position
12616>>>>>>>>>    
12616>>>>>>>>>    Procedure Add_Focus Integer hoBase Returns Integer
12618>>>>>>>>>        Integer iRetVal bState
12618>>>>>>>>>        Get Visible_State to bState
12619>>>>>>>>>        Set Visible_State to False
12620>>>>>>>>>        Forward Get Msg_Add_Focus hoBase to iRetVal
12622>>>>>>>>>        If (iRetVal=0) Begin
12624>>>>>>>>>            Send Load_Environment
12625>>>>>>>>>        End
12625>>>>>>>>>>
12625>>>>>>>>>        Set Visible_State to bState
12626>>>>>>>>>        Procedure_Return iRetVal
12627>>>>>>>>>    End_Procedure
12628>>>>>>>>>
12628>>>>>>>>>    // This is augmented to send save_environment during a view close (was in close_panel)
12628>>>>>>>>>    // we set view_mode to normal if it is zoomed. This is needed to make the MDI stuff work
12628>>>>>>>>>    // properly with the save/load environment. The Saved environment data will make it zoom if needed.
12628>>>>>>>>>    //
12628>>>>>>>>>    Procedure Deactivate Integer eDeactivateScope Returns Integer
12630>>>>>>>>>       Integer eArea iFail
12630>>>>>>>>>       Boolean bPreserveEnvironment
12630>>>>>>>>>       Move (If(num_arguments=0, Area_Type, eDeactivateScope)) to eArea // in case no param is passed
12631>>>>>>>>>       If (eArea<>0) Begin
12633>>>>>>>>>           Forward Get msg_deactivate eArea to iFail
12635>>>>>>>>>       End
12635>>>>>>>>>>
12635>>>>>>>>>       Else Begin
12636>>>>>>>>>           Send Save_Environment
12637>>>>>>>>>           Forward Get msg_deactivate eArea to iFail
12639>>>>>>>>>           
12639>>>>>>>>>           // this works around a problem where maximized MDI views get saved but don't come back
12639>>>>>>>>>           // correctly when loaded again without exiting. It turns out the the MDI client restores
12639>>>>>>>>>           // the view sometimes without telling view_mode. If view_mode is normal, it always works.
12639>>>>>>>>>           // This must happen after the view is deactivated!
12639>>>>>>>>>
12639>>>>>>>>>           If ghoApplication Begin
12641>>>>>>>>>               Get pbPreserveEnvironment of ghoApplication to bPreserveEnvironment
12642>>>>>>>>>           End
12642>>>>>>>>>>
12642>>>>>>>>>           // do these checks to have as small of an effect as possible.
12642>>>>>>>>>           If (bPreserveEnvironment and iFail=0 and view_mode(Self)=Viewmode_Zoom) Begin
12644>>>>>>>>>               Set View_Mode to Viewmode_Normal
12645>>>>>>>>>           End
12645>>>>>>>>>>
12645>>>>>>>>>       End
12645>>>>>>>>>>
12645>>>>>>>>>       Function_Return iFail
12646>>>>>>>>>    End_Procedure
12647>>>>>>>>>
12647>>>>>>>>>    // Save the window placement information for this to the application object
12647>>>>>>>>>
12647>>>>>>>>>    Procedure Save_Environment
12649>>>>>>>>>        tWinWindowPlacement WindowPlacement
12649>>>>>>>>>        tWinWindowPlacement WindowPlacement
12649>>>>>>>>>        Boolean bSuccess bCancel
12649>>>>>>>>>        Get pbDisableSaveEnvironment to bCancel
12650>>>>>>>>>        If not bCancel Begin
12652>>>>>>>>>            
12652>>>>>>>>>            // save environment to the object, in case it is reactivated during the same run.
12652>>>>>>>>>            Move (SizeOfType(tWinWindowPlacement)) to WindowPlacement.length
12653>>>>>>>>>            Move (GetWindowPlacement(Window_Handle(Self), addressof(WindowPlacement))) to bSuccess
12654>>>>>>>>>            If bSuccess Begin
12656>>>>>>>>>                // if minimized, assume restored, as we don't want to restart minimized!
12656>>>>>>>>>                If (WindowPlacement.showCmd = SW_SHOWMINIMIZED) Begin
12658>>>>>>>>>                    Move SW_SHOWNORMAL to WindowPlacement.showCmd
12659>>>>>>>>>                End
12659>>>>>>>>>>
12659>>>>>>>>>                Set pWindowPlacement to WindowPlacement
12660>>>>>>>>>            End
12660>>>>>>>>>>
12660>>>>>>>>>            // also save environment to the application object, so it can be used when reloaded
12660>>>>>>>>>            If ghoApplication Send DoSaveEnvironment of ghoApplication Self False
12663>>>>>>>>>        end
12663>>>>>>>>>>
12663>>>>>>>>>    End_Procedure
12664>>>>>>>>>
12664>>>>>>>>>    // Load the window placement information for this from the application object
12664>>>>>>>>>
12664>>>>>>>>>    Procedure Load_Environment
12666>>>>>>>>>        tWinWindowPlacement WindowPlacement
12666>>>>>>>>>        tWinWindowPlacement WindowPlacement
12666>>>>>>>>>        Boolean bSuccess bCancel
12666>>>>>>>>>        Get pbDisableSaveEnvironment to bCancel
12667>>>>>>>>>        If not bCancel Begin
12669>>>>>>>>>            // if view has alrady been activated and deactivated use the setting from windowplacement saved in the object
12669>>>>>>>>>            Get pWindowPlacement to WindowPlacement
12670>>>>>>>>>            //  if length is zero, assume it has never been used before (never deactivated).
12670>>>>>>>>>            If (WindowPlacement.length>0) Begin
12672>>>>>>>>>                Move (SetWindowPlacement(Window_Handle(Self), AddressOf(WindowPlacement))) to bSuccess
12673>>>>>>>>>            End
12673>>>>>>>>>>
12673>>>>>>>>>            Else Begin
12674>>>>>>>>>                If ghoApplication Send DoLoadEnvironment of ghoApplication Self False
12677>>>>>>>>>            End
12677>>>>>>>>>>
12677>>>>>>>>>        end
12677>>>>>>>>>>
12677>>>>>>>>>    End_Procedure
12678>>>>>>>>>
12678>>>>>>>>>    Procedure Entering_Scope Returns Integer
12680>>>>>>>>>        Integer rVal
12680>>>>>>>>>        Forward Get MSG_Entering_Scope to rVal
12682>>>>>>>>>        If not rVal Send Show_View_Name (Label(Self))
12685>>>>>>>>>    End_Procedure
12686>>>>>>>>>
12686>>>>>>>>>    Procedure Exiting_Scope Integer whereto Returns Integer
12688>>>>>>>>>        Integer rVal
12688>>>>>>>>>        Forward Get MSG_Exiting_Scope whereto to rVal
12690>>>>>>>>>        If not rVal Send Show_View_Name ''
12693>>>>>>>>>    End_Procedure
12694>>>>>>>>>
12694>>>>>>>>>    Procedure Show_view_Name String sHelp
12696>>>>>>>>>        Integer rVal Id
12696>>>>>>>>>        Get Statusbar_id to id
12697>>>>>>>>>        If Id Send Show_View_Name to Id sHelp
12700>>>>>>>>>    End_Procedure
12701>>>>>>>>>
12701>>>>>>>>>   // force object to be modal and then pop it up. Upon complettion restore it to a normal view
12701>>>>>>>>>   Procedure Popup_Modal Returns Integer
12703>>>>>>>>>
12703>>>>>>>>>     Integer OldBMS OldAPS OldPS OldRS OldSS OldEALS OldMDIState 
12703>>>>>>>>>     Integer OldLoc OldAutoLoc OldKeyPath OldDisableSaveEnv OldMin OldMax
12703>>>>>>>>>     Integer rVal
12703>>>>>>>>>
12703>>>>>>>>>     // If object is active we can't do anything. -1 means already active
12703>>>>>>>>>     If (Active_State(Self)) Procedure_Return -1
12706>>>>>>>>>
12706>>>>>>>>>     // Remember all important modal property settings.
12706>>>>>>>>>     Get Block_mouse_State to OldBMS
12707>>>>>>>>>     Get Attach_parent_State to OldAPS
12708>>>>>>>>>     Get Popup_State to OldPS
12709>>>>>>>>>     Get Ring_State to OldRS
12710>>>>>>>>>     Get Scope_State to OldSS
12711>>>>>>>>>     Get Exit_Application_Local_State to OldEALS
12712>>>>>>>>>     Get MDI_State to OldMDIState
12713>>>>>>>>>     Get Key_Path to OldKeyPath
12714>>>>>>>>>     Get Location to OldLoc
12715>>>>>>>>>     Get Maximize_Icon to OldMax
12716>>>>>>>>>     Get Minimize_Icon to OldMin
12717>>>>>>>>>     Get Auto_Locate_State to OldAutoLoc
12718>>>>>>>>>     Get pbDisableSaveEnvironment to OldDisableSaveEnv
12719>>>>>>>>>
12719>>>>>>>>>     // set propertie required to make this a modal dialog
12719>>>>>>>>>     Set pbDisableSaveEnvironment to True
12720>>>>>>>>>     Set MDI_State to False
12721>>>>>>>>>     Set Auto_Locate_State to True
12722>>>>>>>>>     Set Key_path to Desktop
12723>>>>>>>>>     Set Block_mouse_state to True
12724>>>>>>>>>     Set Attach_parent_state to False
12725>>>>>>>>>     Set Exit_Application_Local_State to True
12726>>>>>>>>>     Set Popup_State to True
12727>>>>>>>>>     Set Ring_State to True
12728>>>>>>>>>     Set Scope_State to True
12729>>>>>>>>>     Set Minimize_Icon to False
12730>>>>>>>>>     Set Maximize_Icon to False
12731>>>>>>>>>
12731>>>>>>>>>     Get Msg_Popup to rVal
12732>>>>>>>>>     If rval Move -2 to rVal      // did not activate
12735>>>>>>>>>     Else Move StrMark to rVal // StrMark keeps track of UI value
12737>>>>>>>>>                                  // if 0- a stop_ui, if >0, ret value
12737>>>>>>>>>     // restore all expected properties
12737>>>>>>>>>     Set Auto_Locate_State to OldAutoLoc
12738>>>>>>>>>     Set Location to (hi(OldLoc)) (Low(OldLoc))
12739>>>>>>>>>     Set pbDisableSaveEnvironment to OldDisableSaveEnv
12740>>>>>>>>>     Set MDI_State to OldMDIState
12741>>>>>>>>>     Set Maximize_Icon to OldMax
12742>>>>>>>>>     Set Minimize_Icon to OldMin
12743>>>>>>>>>     Set Block_mouse_State   to OldBMS
12744>>>>>>>>>     Set Attach_parent_State to OldAPS
12745>>>>>>>>>     Set Popup_State         to OldPS
12746>>>>>>>>>     Set Ring_State          to OldRS
12747>>>>>>>>>     Set Scope_State         to OldSS
12748>>>>>>>>>     Set Exit_Application_Local_State to OldEALS
12749>>>>>>>>>     Procedure_Return rVal
12750>>>>>>>>>     
12750>>>>>>>>>  End_Procedure
12751>>>>>>>>>
12751>>>>>>>>>End_Class
12752>>>>>>>>>
12752>>>>>>>>>// logically this is required
12752>>>>>>>>>//{ DesignerClass=cDTView }
12752>>>>>>>>>Class View is an AppDialog
12753>>>>>>>>>End_Class
12754>>>>>>>
12754>>>>>>>
12754>>>>>>>Register_Function pbPreserveEnvironment Returns Boolean
12754>>>>>>>Register_Procedure set phoMainPanel handle hoMain
12754>>>>>>>Register_Procedure DoSaveEnvironment Handle hoContainer Boolean bProgram
12754>>>>>>>Register_Procedure DoLoadEnvironment Handle hoContainer Boolean bProgram
12754>>>>>>>Register_Procedure Set pbVisible Boolean bVisible
12754>>>>>>>Register_Function  pbVisible Returns Boolean
12754>>>>>>>
12754>>>>>>>
12754>>>>>>>
12754>>>>>>>Class AppPanel is a BasicPanel
12755>>>>>>>  //
12755>>>>>>>  //  Panel defaults. Use windows MDI color
12755>>>>>>>  //
12755>>>>>>>  //
12755>>>>>>>    Procedure Construct_Object
12757>>>>>>>        Forward Send Construct_Object
12759>>>>>>>
12759>>>>>>>        Property Integer Auto_Activate_State True
12760>>>>>>>
12760>>>>>>>        // Support status for toolbar and status bar. For now we support
12760>>>>>>>        // 0=Hide, 1=Show,
12760>>>>>>>        //
12760>>>>>>>        Property Integer Private.ToolBar_State  1
12761>>>>>>>
12761>>>>>>>        Property Integer Private.StatusBar_State  1
12762>>>>>>>        
12762>>>>>>>        Property Handle[] phoAutoActivateViews
12763>>>>>>>
12763>>>>>>>        Set Scope_State to TRUE
12764>>>>>>>        Set Mdi_State to TRUE
12765>>>>>>>
12765>>>>>>>        Set Size to 274 479
12766>>>>>>>        Set pbSizeToClientArea  to False
12767>>>>>>>    End_Procedure // Construct_Object
12768>>>>>>>
12768>>>>>>>    Procedure Set Auto_Arrange_Icons_State Integer bState
12770>>>>>>>        Integer hoClient
12770>>>>>>>        Get Client_id To hoClient
12771>>>>>>>        If (hoClient AND hoClient<>self ) ;           Set Auto_Arrange_Icons_State of hoClient To bState
12774>>>>>>>    End_Procedure
12775>>>>>>>
12775>>>>>>>    Function Auto_Arrange_Icons_State Returns Integer
12777>>>>>>>        Integer hoClient bState
12777>>>>>>>        Get Client_id To hoClient
12778>>>>>>>        If (hoClient AND hoClient<>self ) ;            Get Auto_Arrange_Icons_State of hoClient To bState
12781>>>>>>>        Function_Return bState
12782>>>>>>>    End_Function
12783>>>>>>>
12783>>>>>>>    Procedure Toggle_Auto_Arrange_Icons
12785>>>>>>>        Set Auto_Arrange_Icons_State ;                to (NOT(Auto_Arrange_Icons_State(self)))
12786>>>>>>>    End_procedure
12787>>>>>>>
12787>>>>>>>    Procedure Set Client_Scrollbar_State Integer bState
12789>>>>>>>        Integer hoClient
12789>>>>>>>        Get Client_id To hoClient
12790>>>>>>>        If (hoClient AND hoClient<>self ) ;           Set Client_Scrollbar_State of hoClient To bState
12793>>>>>>>    End_Procedure
12794>>>>>>>
12794>>>>>>>    Function Client_Scrollbar_State Returns Integer
12796>>>>>>>        Integer hoClient bState
12796>>>>>>>        Get Client_id To hoClient
12797>>>>>>>        If (hoClient AND hoClient<>self ) ;            Get Client_Scrollbar_State of hoClient To bState
12800>>>>>>>        Function_Return bState
12801>>>>>>>    End_Function
12802>>>>>>>
12802>>>>>>>    Procedure Toggle_Client_Scrollbar_State
12804>>>>>>>        Set Client_Scrollbar_State ;                to (NOT(Client_Scrollbar_State(self)))
12805>>>>>>>    End_procedure
12806>>>>>>>
12806>>>>>>>    Function ToolBar_State returns Integer
12808>>>>>>>        function_return (private.Toolbar_State(self))
12809>>>>>>>    End_function
12810>>>>>>>
12810>>>>>>>    Procedure Set Toolbar_State Integer bState
12812>>>>>>>       Integer hoToolBar
12812>>>>>>>       Handle hoCommandBars
12812>>>>>>>       If (bState<>toolbar_State(Self)) Begin
12814>>>>>>>          Set private.toolbar_State to bState
12815>>>>>>>
12815>>>>>>>          Get phoCommandBars to hoCommandbars
12816>>>>>>>          If hoCommandbars Procedure_Return
12819>>>>>>>          
12819>>>>>>>          If (Window_Handle(Self)) Begin
12821>>>>>>>             Get toolBar_ID to hoToolBar
12822>>>>>>>             If hoToolBar Send Activate_Component hoToolBar bState (Focus_Mode(hoToolbar))
12825>>>>>>>          End
12825>>>>>>>>
12825>>>>>>>       end
12825>>>>>>>>
12825>>>>>>>    End_procedure
12826>>>>>>>
12826>>>>>>>    Procedure Toggle_Toolbar
12828>>>>>>>       Set Toolbar_State to (Not(Toolbar_State(self)))
12829>>>>>>>    End_procedure
12830>>>>>>>
12830>>>>>>>    Function StatusBar_State returns Integer
12832>>>>>>>       Handle hoCommandBars hoStatusBar
12832>>>>>>>       Boolean bState
12832>>>>>>>       Get phoCommandBars to hoCommandbars
12833>>>>>>>       If hoCommandbars Begin
12835>>>>>>>          Get Statusbar_ID to hoStatusBar
12836>>>>>>>          If hoStatusBar Begin
12838>>>>>>>             Get pbVisible of hoStatusBar to bState
12839>>>>>>>          End            
12839>>>>>>>>
12839>>>>>>>       End
12839>>>>>>>>
12839>>>>>>>       Else Begin
12840>>>>>>>          Get private.Statusbar_state to bState
12841>>>>>>>       End
12841>>>>>>>>
12841>>>>>>>       Function_Return bState
12842>>>>>>>    End_function
12843>>>>>>>
12843>>>>>>>    Procedure Set Statusbar_State Integer bState
12845>>>>>>>       Handle hoStatusBar hoCommandBars
12845>>>>>>>       If (bState<>Statusbar_State(self)) Begin
12847>>>>>>>          Set private.Statusbar_State to bState
12848>>>>>>>          Get Statusbar_ID to hoStatusBar
12849>>>>>>>
12849>>>>>>>          Get phoCommandBars to hoCommandbars
12850>>>>>>>          If hoCommandbars Begin
12852>>>>>>>             If hoStatusBar Begin
12854>>>>>>>                Set pbVisible of hoStatusBar to bState            
12855>>>>>>>             End
12855>>>>>>>>
12855>>>>>>>          End
12855>>>>>>>>
12855>>>>>>>          Else Begin
12856>>>>>>>              If (Window_Handle(Self)) Begin
12858>>>>>>>                 If hoStatusBar Send Activate_Component hoStatusBar bState  nonfocusable
12861>>>>>>>              End
12861>>>>>>>>
12861>>>>>>>          End
12861>>>>>>>>
12861>>>>>>>       End
12861>>>>>>>>
12861>>>>>>>    End_Procedure
12862>>>>>>>
12862>>>>>>>    Procedure Toggle_Statusbar
12864>>>>>>>       Set Statusbar_State to (not(statusbar_State(Self)))
12865>>>>>>>    end_procedure
12866>>>>>>>
12866>>>>>>>    Procedure AutoSizeLocate
12868>>>>>>>    end_procedure
12869>>>>>>>
12869>>>>>>>    Procedure Size_Components
12871>>>>>>>        Integer iToolBar iStatBar //iClient
12871>>>>>>>        Integer iSizeToolBar
12871>>>>>>>        Handle hoCommandbars 
12871>>>>>>>        
12871>>>>>>>        Get phoCommandBars to hoCommandbars
12872>>>>>>>        If hoCommandbars Procedure_Return
12875>>>>>>>
12875>>>>>>>        If not (Window_Handle(self)) procedure_Return
12878>>>>>>>
12878>>>>>>>        Get ToolBar_id   To iToolBar
12879>>>>>>>        Get StatusBar_id To iStatBar
12880>>>>>>>        //Get Client_id    To iClient
12880>>>>>>>
12880>>>>>>>        If (iToolBar And Window_Handle(iToolbar)) Begin
12882>>>>>>>            //Send AutoSizeLocate To iToolBar
12882>>>>>>>            Get GuiSize of iToolbar to iSizeToolbar
12883>>>>>>>            set GUIsize of iToolbar to (hi(iSizeToolbar)) (low(iSizeToolbar)) // forces auto resize - don't change size
12884>>>>>>>            //set GUIsize of iToolbar to 28 800 // forces auto resize
12884>>>>>>>        End
12884>>>>>>>>
12884>>>>>>>
12884>>>>>>>        If (iStatBar and Window_Handle(iStatBar)) Begin
12886>>>>>>>            Send AutoSizeLocate To iStatBar
12887>>>>>>>        End
12887>>>>>>>>
12887>>>>>>>    End_Procedure
12888>>>>>>>
12888>>>>>>>    Procedure Activate_Component Integer Obj Integer st integer focusmode
12890>>>>>>>       integer act
12890>>>>>>>       If Not Obj Procedure_Return
12893>>>>>>>       Get Active_State of Obj to act
12894>>>>>>>       If (st AND act=0) Begin
12896>>>>>>>          Set Focus_Mode of obj to focusable
12897>>>>>>>          Send Add_focus to obj self
12898>>>>>>>          Set Focus_Mode of obj to focusmode
12899>>>>>>>       End
12899>>>>>>>>
12899>>>>>>>       else if (st=0 and act) ;          Send deactivate to obj
12903>>>>>>>    end_procedure
12904>>>>>>>
12904>>>>>>>    Procedure Add_Components
12906>>>>>>>        Integer hClient
12906>>>>>>>        Handle hoCommandbars 
12906>>>>>>>        Get phoCommandBars to hoCommandbars
12907>>>>>>>        If not hoCommandbars Begin
12909>>>>>>>            Get Client_id to hClient
12910>>>>>>>            If (hClient and hClient<>Self ) ; // this forces the client to start at a               Set mdi_top_margin of hClient to (mdi_top_margin(hClient)) // proper size when maximized w/ no components.
12913>>>>>>>            Send Activate_Component (Toolbar_Id(Self)) ;                                    (Toolbar_State(Self)) nonfocusable
12914>>>>>>>            Send Activate_Component (Statusbar_Id(Self)) ;                                    (Statusbar_State(Self)) nonfocusable
12915>>>>>>>            Send Size_Components
12916>>>>>>>        End
12916>>>>>>>>
12916>>>>>>>    End_procedure
12917>>>>>>>
12917>>>>>>>    Procedure Activate Returns Integer
12919>>>>>>>        Integer bFail
12919>>>>>>>        Forward Get MSG_activate to bFail
12921>>>>>>>        //If NOT bFail Send Add_Components
12921>>>>>>>        Send Add_Components
12922>>>>>>>        Set Main_Window to self
12923>>>>>>>        Procedure_Return bFail
12924>>>>>>>    End_Procedure // activate
12925>>>>>>>
12925>>>>>>>    Procedure Client_Message Integer Msg_Id
12927>>>>>>>        integer hoClient
12927>>>>>>>        Get Client_id to hoClient
12928>>>>>>>        If (hoClient and hoClient <> self) ;            Send Msg_id to hoClient
12931>>>>>>>    End_Procedure
12932>>>>>>>
12932>>>>>>>    Procedure Arrange_Icons
12934>>>>>>>        Send Client_Message Current_Message
12935>>>>>>>    End_Procedure
12936>>>>>>>
12936>>>>>>>    Procedure Cascade_Windows
12938>>>>>>>        Send Client_Message Current_Message
12939>>>>>>>    End_Procedure
12940>>>>>>>
12940>>>>>>>    Procedure Tile_Windows_Horizontal
12942>>>>>>>        Send Client_Message Current_Message
12943>>>>>>>    End_Procedure
12944>>>>>>>
12944>>>>>>>    Procedure Tile_Windows_Vertical
12946>>>>>>>        Send Client_Message Current_Message
12947>>>>>>>    End_Procedure
12948>>>>>>>
12948>>>>>>>    Procedure Set GuiSize Integer sizy Integer sizx
12950>>>>>>>      Forward Set GUISize to sizy sizx
12952>>>>>>>      If BuildingObjectId Procedure_Return
12955>>>>>>>      Send Size_Components
12956>>>>>>>    end_procedure
12957>>>>>>>
12957>>>>>>>    //  Returns false to indicate that this is not a DEO. This is used by
12957>>>>>>>    //  delegation to figure out if you are within a DEO and should therefore
12957>>>>>>>    //  send a DEO message. DEO view clients set this true
12957>>>>>>>    //
12957>>>>>>>    Function Is_Function Integer MsgId Integer ObjId Integer DelegateFg Returns Integer
12959>>>>>>>      Integer DelMode rVal Id
12959>>>>>>>      Move ( If(DelegateFg,self,ObjId) ) to Id
12960>>>>>>>      Get Delegation_mode of Id to DelMode
12961>>>>>>>      Set Delegation_mode of Id to No_Delegate_or_Error
12962>>>>>>>      Get MsgId of ObjId to rVal
12963>>>>>>>      Set Delegation_mode of Id to DelMode
12964>>>>>>>      Function_Return rVal
12965>>>>>>>    End_Function
12966>>>>>>>
12966>>>>>>>    // In this class this should return an id or nothing (no delegation).
12966>>>>>>>    // Note, if no context exists return a 0 or ''.
12966>>>>>>>    //
12966>>>>>>>    Function Help_Context Integer Context_Type Returns String
12968>>>>>>>      Integer ID
12968>>>>>>>      String  rVal
12968>>>>>>>
12968>>>>>>>      If Context_Type eq HELP_CONTEXT_ID ;             Get Help_ID to rVal
12971>>>>>>>      else If Context_Type eq HELP_CONTEXT_KEYWORD ;             Get Help_Keyword to rVal
12975>>>>>>>      else If Context_Type eq HELP_CONTEXT_ID_OR_KEY Begin
12978>>>>>>>             Get Help_ID to ID
12979>>>>>>>             If ID eq 0 Get Help_Keyword to rVal
12982>>>>>>>             Move ID to rVal
12983>>>>>>>             If rval eq '' Move 0 to rVal
12986>>>>>>>      end
12986>>>>>>>>
12986>>>>>>>      else if Context_Type eq HELP_CONTEXT_DATAFILE ;             Move '' to rVal
12990>>>>>>>
12990>>>>>>>      Function_Return rVal
12991>>>>>>>    End_Function // Help_Context
12992>>>>>>>
12992>>>>>>>    // Get context based on eContext. If no content found, Don't delegate with panels --- end the search (added to 11.1. See help_mx.pkg)
12992>>>>>>>    //
12992>>>>>>>    Function HtmlHelpContext Integer eContext String BYREF sContext Returns Integer
12994>>>>>>>        integer eContextFound
12994>>>>>>>        Get HtmlHelpObjectContext eContext (&sContext) to eContextFound // context for this one object
12995>>>>>>>        Function_return eContextFound
12996>>>>>>>    end_function
12997>>>>>>>
12997>>>>>>>
12997>>>>>>>    // When verify_exit_appliction is received by default just
12997>>>>>>>    // send this message to the Mdi-client Id.
12997>>>>>>>    //
12997>>>>>>>    Function Verify_Exit_Application Returns Integer
12999>>>>>>>       Integer Id rVal
12999>>>>>>>       Get Client_Id to id
13000>>>>>>>       If (Id AND Id<>self) ;          Get Verify_Exit_application of Id to rVal
13003>>>>>>>       Function_Return Rval
13004>>>>>>>    End_Function
13005>>>>>>>
13005>>>>>>>    // When exit notifiction is received by default just
13005>>>>>>>    // send this message to the Mdi-client Id.
13005>>>>>>>    //
13005>>>>>>>    Procedure Notify_Exit_Application
13007>>>>>>>       Send Client_Message Current_Message
13008>>>>>>>    End_Procedure // Notify_Exit_Application
13009>>>>>>>
13009>>>>>>>    Procedure Minimize_all_Windows
13011>>>>>>>       Send Client_Message Current_Message
13012>>>>>>>    End_Procedure
13013>>>>>>>
13013>>>>>>>    Procedure Restore_all_Windows
13015>>>>>>>       Send Client_Message Current_Message
13016>>>>>>>    End_Procedure
13017>>>>>>>
13017>>>>>>>    // augmented to  activate if required
13017>>>>>>>    //
13017>>>>>>>    Procedure End_Construct_Object
13019>>>>>>>       Forward Send End_Construct_object
13021>>>>>>>       If (Auto_activate_state(self)) Send Activate
13024>>>>>>>    End_Procedure // End_Construct_object
13025>>>>>>>    
13025>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
13027>>>>>>>        Integer iError i iViews
13027>>>>>>>        Handle[] hoAutoActivateViews
13028>>>>>>>        Forward Get msg_Add_Focus hoParent to iError
13030>>>>>>>        If (iError=0) Begin
13032>>>>>>>            Get phoAutoActivateViews to hoAutoActivateViews
13033>>>>>>>            Move (SizeOfArray(hoAutoActivateViews)) to iViews
13034>>>>>>>            For i from 0 to (iViews-1)
13040>>>>>>>>
13040>>>>>>>                Send Activate_View of hoAutoActivateViews[i]
13041>>>>>>>            Loop
13042>>>>>>>>
13042>>>>>>>        End
13042>>>>>>>>
13042>>>>>>>    End_Procedure
13043>>>>>>>    
13043>>>>>>>    // adds a view to the array of views to be autoactivated
13043>>>>>>>    
13043>>>>>>>    Procedure AddAutoActivateView Handle hoView
13045>>>>>>>        Handle[] hoAutoActivateViews
13046>>>>>>>        Get phoAutoActivateViews to hoAutoActivateViews
13047>>>>>>>        Move hoView to hoAutoActivateViews[SizeOfArray(hoAutoActivateViews)]
13048>>>>>>>        Set phoAutoActivateViews to hoAutoActivateViews
13049>>>>>>>    End_Procedure
13050>>>>>>>    
13050>>>>>>>End_Class
13051>>>>>>>
13051>>>>>>>
13051>>>>>>>Use DFCursor.pkg
Including file: Dfcursor.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Dfcursor.pkg)
13051>>>>>>>>>//
13051>>>>>>>>>//  dfcursr.pkg
13051>>>>>>>>>//
13051>>>>>>>>>//  create a desktop object named Cursor_control that understands
13051>>>>>>>>>//   Send Cursor_Wait to (cursor_Control(self))
13051>>>>>>>>>//            creates hourclass cursor
13051>>>>>>>>>//   Send Cursor_ready to (cursor_Control(self))
13051>>>>>>>>>//            restores regular cursor
13051>>>>>>>>>//
13051>>>>>>>>>Use Cursor.pkg
Including file: Cursor.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Cursor.pkg)
13051>>>>>>>>>>>//*************************************************************************
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>//*  Copyright (c) 1997 Data Access Corporation, Miami Florida,
13051>>>>>>>>>>>//*  All rights reserved.
13051>>>>>>>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>//*************************************************************************
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>//*  Module Name:
13051>>>>>>>>>>>//*      CURSOR.PKG
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>//*  Creator:
13051>>>>>>>>>>>//*      MIKE-Z
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>//*  Purpose:
13051>>>>>>>>>>>//*
13051>>>>>>>>>>>// 07/23/96 JJT - New Class names
13051>>>>>>>>>>>//*************************************************************************
13051>>>>>>>>>>>
13051>>>>>>>>>>>Use Windows.pkg
13051>>>>>>>>>>>Use WinUser.pkg
13051>>>>>>>>>>>
13051>>>>>>>>>>>// Standard Cursor IDs
13051>>>>>>>>>>>
13051>>>>>>>>>>>// not in Windows 3.1
13051>>>>>>>>>>>
13051>>>>>>>>>>>
13051>>>>>>>>>>>
13051>>>>>>>>>>>
13051>>>>>>>>>>>Class CursorShape is a DFBaseToolPanel //BasicPanel
13052>>>>>>>>>>>
13052>>>>>>>>>>>    Procedure Construct_Object
13054>>>>>>>>>>>        Property Integer ClassCursorHandle 0
13055>>>>>>>>>>>        Set Visible_State to False
13056>>>>>>>>>>>        Set Size to 1 1
13057>>>>>>>>>>>    End_Procedure
13058>>>>>>>>>>>
13058>>>>>>>>>>>    Procedure Set Cursor Integer CursorType
13060>>>>>>>>>>>        Integer CursorID retval hWnd
13060>>>>>>>>>>>        Get Window_Handle To hWnd
13061>>>>>>>>>>>        If (CursorType = 0) Begin
13063>>>>>>>>>>>            Send Release_Mouse_Capture
13064>>>>>>>>>>>            Move (SetClassLong(hWnd, GCL_HCURSOR, ClassCursorHandle(self))) to retval
13065>>>>>>>>>>>            Set ClassCursorHandle to 0
13066>>>>>>>>>>>            Send Page_Object False
13067>>>>>>>>>>>        End
13067>>>>>>>>>>>>
13067>>>>>>>>>>>        Else Begin
13068>>>>>>>>>>>            Send Page_Object True
13069>>>>>>>>>>>            Get Window_Handle To hWnd
13070>>>>>>>>>>>            If (ClassCursorHandle(self) = 0) ;                Set ClassCursorHandle to (GetClassLong(hWnd, GCL_HCURSOR))
13073>>>>>>>>>>>            Move (LoadCursor(0,CursorType)) to CursorID
13074>>>>>>>>>>>            Move (SetClassLong(hWnd, GCL_HCURSOR, CursorID )) to retval
13075>>>>>>>>>>>            Move (SetCursor(CursorID)) to retval
13076>>>>>>>>>>>            Send Set_Mouse_Capture
13077>>>>>>>>>>>        End
13077>>>>>>>>>>>>
13077>>>>>>>>>>>    End_Procedure
13078>>>>>>>>>>>
13078>>>>>>>>>>>    Procedure Mouse_Up
13080>>>>>>>>>>>        Integer retval
13080>>>>>>>>>>>        Send Set_Mouse_Capture
13081>>>>>>>>>>>        Move (SetCursor(GetClassLong(Window_Handle(self), GCL_HCURSOR))) to retval
13082>>>>>>>>>>>    End_Procedure
13083>>>>>>>>>>>
13083>>>>>>>>>>>    Procedure Cursor_Wait
13085>>>>>>>>>>>        set cursor to IDC_WAIT
13086>>>>>>>>>>>    End_Procedure  // Cursor_Wait
13087>>>>>>>>>>>
13087>>>>>>>>>>>    Procedure Cursor_Ready
13089>>>>>>>>>>>        set cursor to 0
13090>>>>>>>>>>>    End_Procedure // Cursor_Ready
13091>>>>>>>>>>>
13091>>>>>>>>>>>
13091>>>>>>>>>>>End_Class
13092>>>>>>>>>
13092>>>>>>>>>Object Cursor_Control is a CursorShape
13094>>>>>>>>>End_Object
13095>>>>>>>>>
13095>>>>>>>
13095>>>>>>>//  Main DEO High level main Panel Class
13095>>>>>>>//
13095>>>>>>>Class Panel is a AppPanel
13096>>>>>>>
13096>>>>>>>    Procedure Construct_Object
13098>>>>>>>        String St
13098>>>>>>>        integer iVal
13098>>>>>>>        dWord dwState
13098>>>>>>>        Forward Send Construct_Object
13100>>>>>>>        
13100>>>>>>>        // defaults to hourglass...end_construct will remove
13100>>>>>>>        Send Cursor_wait to (Cursor_Control(self)) // hourglass
13101>>>>>>>
13101>>>>>>>    End_Procedure // Construct_Object
13102>>>>>>>
13102>>>>>>>
13102>>>>>>>    // This sends the message register_active_view to all child objects.
13102>>>>>>>    // It passes the object ID of the object that is requesting this
13102>>>>>>>    // information. The flag BCast_Focus determines if this should
13102>>>>>>>    // broadcast or broadcast_focus
13102>>>>>>>    //
13102>>>>>>>    Procedure Notify_All_Views integer Msg integer obj integer Bcast_Focus
13104>>>>>>>       integer clobj
13104>>>>>>>       Get Client_ID to clObj
13105>>>>>>>       if ClObj eq 0 Move self to ClObj
13108>>>>>>>       If BCast_Focus Broadcast_focus send Msg to Clobj obj
13112>>>>>>>       Else           Broadcast       send Msg to Clobj obj
13115>>>>>>>    End_Procedure // Notify_all_Views
13116>>>>>>>
13116>>>>>>>    //
13116>>>>>>>    // Save any information you wish about this panel.
13116>>>>>>>    //
13116>>>>>>>    //  Rules for saving:
13116>>>>>>>    //  1. only save if SaveEnvironment=TRUE, ON or YES
13116>>>>>>>    //  2. Save current size and location to ApplicationSize, ApplicationLocation
13116>>>>>>>    //
13116>>>>>>>    Procedure Save_Environment
13118>>>>>>>      If ghoApplication Send DoSaveEnvironment of ghoApplication Self True
13121>>>>>>>    End_Procedure
13122>>>>>>>
13122>>>>>>>    // For high level panel support save of environment
13122>>>>>>>    //
13122>>>>>>>    Procedure Notify_Exit_Application
13124>>>>>>>      Send Save_Environment
13125>>>>>>>      Forward Send Notify_Exit_Application
13127>>>>>>>    End_Procedure
13128>>>>>>>
13128>>>>>>>    // augmented to remove hourglass
13128>>>>>>>    //
13128>>>>>>>    Procedure End_Construct_Object
13130>>>>>>>       // if application object exists, we need to tell that object that we are the main panel
13130>>>>>>>       If ghoApplication ;          set phoMainPanel of ghoApplication to self
13133>>>>>>>       Forward Send End_Construct_object
13135>>>>>>>       Send Cursor_ready to (Cursor_Control(self)) // restore
13136>>>>>>>    End_Procedure // End_Construct_object
13137>>>>>>>
13137>>>>>>>    Procedure Page Integer iState
13139>>>>>>>        Forward Send Page iState
13141>>>>>>>        If (iState =1) Begin
13143>>>>>>>            If ghoApplication Send DoLoadEnvironment of ghoApplication self True
13146>>>>>>>        End
13146>>>>>>>>
13146>>>>>>>    End_Procedure
13147>>>>>>>
13147>>>>>>>End_Class
13148>>>>>>>
13148>>>>>>>//  Main DEO High level main MDI Client Class
13148>>>>>>>//
13148>>>>>>>//  Currently there is nothing special about this class but it was
13148>>>>>>>//  created because it is logically correct. Extensions may go here in
13148>>>>>>>//  the futire
13148>>>>>>>Class ClientArea is a AppClientArea
13149>>>>>>>End_Class
13150>>>>>Use cCJCommandBarSystem.pkg
Including file: cCJCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJCommandBarSystem.pkg)
13150>>>>>>>Use Windows.pkg
13150>>>>>>>Use cRegistry.pkg
13150>>>>>>>Use cCJCommandBars.pkg // loads CodeJock class
Including file: cCJCommandBars.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJCommandBars.pkg)
13150>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13150>>>>>>>>>Use FlexCom20.pkg
Including file: FlexCOM20.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\FlexCOM20.pkg)
13150>>>>>>>>>>>
13150>>>>>>>>>>>//
13150>>>>>>>>>>>// Full Flexcom support for automation (cComAutomationObject),
13150>>>>>>>>>>>// activeX (cComActiveXControl and document objects (cComDocumentObject)
13150>>>>>>>>>>>//
13150>>>>>>>>>>>
13150>>>>>>>>>>>Use FlexCOM20_Base.pkg // defines basic flexcom symbols and class cComAutomationObject
Including file: FlexCOM20_Base.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\FlexCOM20_Base.pkg)
13150>>>>>>>>>>>>>//
13150>>>>>>>>>>>>>// Flexcom support for automation (cComAutomationObject).
13150>>>>>>>>>>>>>// If you want activeX and document objects use FlexCom20.pkg
13150>>>>>>>>>>>>>//
13150>>>>>>>>>>>>>
13150>>>>>>>>>>>>>Use Windows.pkg
13150>>>>>>>>>>>>>Use ComTypes.pkg
Including file: ComTypes.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\ComTypes.pkg)
13150>>>>>>>>>>>>>>>Use Variant.pkg
Including file: Variant.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Variant.pkg)
13150>>>>>>>>>>>>>>>>>Use Windows.pkg
13150>>>>>>>>>>>>>>>>>
13150>>>>>>>>>>>>>>>>>
13150>>>>>>>>>>>>>>>>>
13150>>>>>>>>>>>>>>>>>External_Function SysAllocString "SysAllocString" oleaut32.dll Pointer pStr Returns Pointer
13151>>>>>>>>>>>>>>>>>External_Function SysStringLen "SysStringLen" oleaut32.dll Pointer vStr Returns Integer
13152>>>>>>>>>>>>>>>>>
13152>>>>>>>>>>>>>>>>>// Returns the character length of the variant string. 
13152>>>>>>>>>>>>>>>>>Function VariantStringLength Global Variant bStr Returns Integer
13154>>>>>>>>>>>>>>>>>    Address aVariant
13154>>>>>>>>>>>>>>>>>    Integer iLen iType
13154>>>>>>>>>>>>>>>>>
13154>>>>>>>>>>>>>>>>>    Move (AddressOf(bStr)) to aVariant
13155>>>>>>>>>>>>>>>>>    Move (DeRefW(aVariant,0)) to iType
13156>>>>>>>>>>>>>>>>>    If (iType=OLE_VT_Empty) Begin
13158>>>>>>>>>>>>>>>>>        Function_Return 0
13159>>>>>>>>>>>>>>>>>    End
13159>>>>>>>>>>>>>>>>>>
13159>>>>>>>>>>>>>>>>>    If (iType<>OLE_VT_Bstr) Begin
13161>>>>>>>>>>>>>>>>>        Error DFERR_BAD_TYPE_EXPRESSION "In variable is not a variant bstr"
13162>>>>>>>>>>>>>>>>>>
13162>>>>>>>>>>>>>>>>>        Function_Return 0
13163>>>>>>>>>>>>>>>>>    End
13163>>>>>>>>>>>>>>>>>>
13163>>>>>>>>>>>>>>>>>    Move (SysStringLen(DeRefDw(aVariant,8))) to iLen
13164>>>>>>>>>>>>>>>>>    Function_Return iLen
13165>>>>>>>>>>>>>>>>>End_Function
13166>>>>>>>>>>>>>>>>>
13166>>>>>>>>>>>>>>>>>
13166>>>>>>>>>>>>>>>>>// returns true if char string in the buffer can fit into a string
13166>>>>>>>>>>>>>>>>>Function ValidStringBufferLength GLOBAL Address aData Returns Boolean
13168>>>>>>>>>>>>>>>>>    Integer iMax
13168>>>>>>>>>>>>>>>>>    Get_Argument_Size to iMax
13169>>>>>>>>>>>>>>>>>    Function_Return (CStringLength(aData)<=iMax)
13170>>>>>>>>>>>>>>>>>End_Procedure
13171>>>>>>>>>>>>>>>>>    
13171>>>>>>>>>>>>>>>
13171>>>>>>>>>>>>>>>
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>// In fmac
13171>>>>>>>>>>>>>//
13171>>>>>>>>>>>>>//#REPLACE U_DFCOMIDISPATCHDRIVER  |CI107
13171>>>>>>>>>>>>>//#REPLACE U_DFCOMDOCUMENTOBJECT |CI108
13171>>>>>>>>>>>>>//#REPLACE U_DFCOMACTIVEXCONTROL  |CI109
13171>>>>>>>>>>>>>//#REPLACE U_DFCOMDESIGNCONTROL  |CI110
13171>>>>>>>>>>>>>//#REPLACE U_DFCOMAUTOMATIONOBJECT  |CI111
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>//#REPLACE     GET_PSPROGID                |CI$0554
13171>>>>>>>>>>>>>//#REPLACE     SET_PSPROGID                |CI$0555
13171>>>>>>>>>>>>>//#REPLACE     GET_pvComObject             |CI$0556
13171>>>>>>>>>>>>>//#REPLACE     SET_pvComObject             |CI$0557
13171>>>>>>>>>>>>>//#REPLACE     MSG_CREATECOMOBJECT         |CI$0558
13171>>>>>>>>>>>>>//#REPLACE     MSG_RELEASECOMOBJECT        |CI$0559
13171>>>>>>>>>>>>>//#REPLACE     MSG_COMADDREF               |CI$055a
13171>>>>>>>>>>>>>//#REPLACE     GET_COMQUERYINTERFACE       |CI$055b
13171>>>>>>>>>>>>>//#REPLACE     MSG_PREPAREPARAMS           |CI$055c
13171>>>>>>>>>>>>>//#REPLACE     MSG_DEFINEPARAM             |CI$055d
13171>>>>>>>>>>>>>//#REPLACE     GET_INVOKECOMMETHOD         |CI$055e
13171>>>>>>>>>>>>>//#REPLACE     MSG_INVOKECOMMETHOD         |CI$055e
13171>>>>>>>>>>>>>//#REPLACE     GET_COMPROPERTY             |CI$055f
13171>>>>>>>>>>>>>//#REPLACE     SET_COMPROPERTY             |CI$0560
13171>>>>>>>>>>>>>//#REPLACE     MSG_REGISTERCOMEVENT        |CI$0561
13171>>>>>>>>>>>>>//#REPLACE     MSG_DISPLAYPROPERTYSHEET    |CI$0565
13171>>>>>>>>>>>>>//#REPLACE     MSG_CREATECOMOBJECTFROMFILE |CI$0566
13171>>>>>>>>>>>>>//#REPLACE     MSG_SAVETOFILE              |CI$0567
13171>>>>>>>>>>>>>//#REPLACE     MSG_SAVETORESOURCEFILE      |CI$0568
13171>>>>>>>>>>>>>//#REPLACE     GET_PSRESOURCEFILE          |CI$0569
13171>>>>>>>>>>>>>//#REPLACE     SET_PSRESOURCEFILE          |CI$056a
13171>>>>>>>>>>>>>//#REPLACE     GET_PSRESOURCENAME          |CI$056b
13171>>>>>>>>>>>>>//#REPLACE     SET_PSRESOURCENAME          |CI$056c
13171>>>>>>>>>>>>>//#REPLACE     SET_PSRESOURCEDATA          |CI$056d
13171>>>>>>>>>>>>>//#REPLACE     GET_PEAUTOCREATE            |CI$056e
13171>>>>>>>>>>>>>//#REPLACE     SET_PEAUTOCREATE            |CI$056f
13171>>>>>>>>>>>>>//#REPLACE     GET_PSLICENSEKEY            |CI$0570
13171>>>>>>>>>>>>>//#REPLACE     SET_PSLICENSEKEY            |CI$0571
13171>>>>>>>>>>>>>//#REPLACE     MSG_REGISTERPROPERTYCHANGEEVENT |CI$0572
13171>>>>>>>>>>>>>//#REPLACE     GET_PHDISPATCHDRIVER        |CI$0573
13171>>>>>>>>>>>>>//#REPLACE     MSG_ONCREATE                |CI$0575
13171>>>>>>>>>>>>>//#REPLACE     GET_COMLOADPICTURE          |CI$0577
13171>>>>>>>>>>>>>//#REPLACE     GET_COMACTIVEOBJECT         |CI$0578
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>//Enumerations for the peAutoCreate property
13171>>>>>>>>>>>>>//acNoAutoCreate - Do not automatically instantiate the COM object upon VDF object creation.
13171>>>>>>>>>>>>>//You must manually instantiate the COM object using CreateComObject. This is the default
13171>>>>>>>>>>>>>//for cComAutomation.
13171>>>>>>>>>>>>>Define acNoAutoCreate for 0
13171>>>>>>>>>>>>>//acAutoCreate - Automatically instantiate the COM object upon VDF object creation.
13171>>>>>>>>>>>>>//You won't need to manually instantiate the COM object. This is the default
13171>>>>>>>>>>>>>//for cComActiveXControl
13171>>>>>>>>>>>>>Define acAutoCreate for 1
13171>>>>>>>>>>>>>//acDeferredAutoCreate - Automatically instantiate the COM object during Page_Object,
13171>>>>>>>>>>>>>//and automatically destroy the COM object during Page_Delete. Use this setting only
13171>>>>>>>>>>>>>//if acAutoCreate causes problems.
13171>>>>>>>>>>>>>Define acDeferredAutoCreate for 2
13171>>>>>>>>>>>>>
13171>>>>>>>>>>>>>Class cComAutomationObject Is a DFComAutomationObject
13172>>>>>>>>>>>>>    Procedure Construct_Object
13174>>>>>>>>>>>>>        Forward Send Construct_Object
13176>>>>>>>>>>>>>        Send RegisterComEvents
13177>>>>>>>>>>>>>    End_Procedure
13178>>>>>>>>>>>>>
13178>>>>>>>>>>>>>    // It is expected that the Com class will augment this with useful event definitions
13178>>>>>>>>>>>>>    Procedure RegisterComEvents
13180>>>>>>>>>>>>>    End_Procedure
13181>>>>>>>>>>>>>
13181>>>>>>>>>>>>>    // Attach the DF object to com automation object via progId.
13181>>>>>>>>>>>>>    // returns: Boolean bSuccess if Ok, If not ok, pcComObject is set to null
13181>>>>>>>>>>>>>    Function AttachActiveObject Returns Boolean
13183>>>>>>>>>>>>>        String sProgId
13183>>>>>>>>>>>>>        Variant vComObject
13183>>>>>>>>>>>>>        Boolean bSuccess
13183>>>>>>>>>>>>>        Get psProgID to sProgId
13184>>>>>>>>>>>>>        Get ComActiveObject sProgId to vComObject
13185>>>>>>>>>>>>>        Set pvComObject to vComObject
13186>>>>>>>>>>>>>        Move (Not(IsNullComObject(vComObject))) to bSuccess // success of variant is not null
13187>>>>>>>>>>>>>        Function_Return bSuccess
13188>>>>>>>>>>>>>    End_Function
13189>>>>>>>>>>>>>
13189>>>>>>>>>>>>>    // returns true if the control is created.
13189>>>>>>>>>>>>>    Function IsComObjectCreated Returns Boolean
13191>>>>>>>>>>>>>        Variant vComObject
13191>>>>>>>>>>>>>        Get pvComObject to vComObject
13192>>>>>>>>>>>>>        Function_Return (Not(IsNullComObject(vComObject)))
13193>>>>>>>>>>>>>    End_Function
13194>>>>>>>>>>>>>
13194>>>>>>>>>>>>>End_Class
13195>>>>>>>>>>>>>
13195>>>>>>>>>>>
13195>>>>>>>>>>>Class cComDocumentObject Is a DFComDocumentObject
13196>>>>>>>>>>>    Procedure Construct_Object
13198>>>>>>>>>>>        Forward Send Construct_Object
13200>>>>>>>>>>>        Send RegisterComEvents
13201>>>>>>>>>>>        Send Define_Standard_Object_Mixin
13202>>>>>>>>>>>        Send Define_Shadow_Mixin
13203>>>>>>>>>>>    End_Procedure
13204>>>>>>>>>>>    Import_Class_Protocol Standard_Object_Mixin
13205>>>>>>>>>>>    Import_Class_Protocol Shadow_Mixin
13206>>>>>>>>>>>
13206>>>>>>>>>>>    // It is expected that the Com class will augment this with useful event definitions
13206>>>>>>>>>>>    Procedure RegisterComEvents
13208>>>>>>>>>>>    End_Procedure
13209>>>>>>>>>>>
13209>>>>>>>>>>>    // returns true if the control is created.
13209>>>>>>>>>>>    Function IsComObjectCreated Returns Boolean
13211>>>>>>>>>>>        Variant vComObject
13211>>>>>>>>>>>        Get pvComObject to vComObject
13212>>>>>>>>>>>        Function_Return (Not(IsNullComObject(vComObject)))
13213>>>>>>>>>>>    End_Function
13214>>>>>>>>>>>
13214>>>>>>>>>>>End_Class
13215>>>>>>>>>>>
13215>>>>>>>>>>>Class cComActiveXControl Is a DFComActiveXControl
13216>>>>>>>>>>>    Procedure Construct_Object
13218>>>>>>>>>>>        Forward Send Construct_Object
13220>>>>>>>>>>>        Send RegisterComEvents
13221>>>>>>>>>>>        Send Define_Standard_Object_Mixin
13222>>>>>>>>>>>        Send Define_Single_Item_Navigate_Mixin
13223>>>>>>>>>>>        Send Define_Dflabel_Mixin
13224>>>>>>>>>>>
13224>>>>>>>>>>>        // If set true, then the control will attempt to bind the value property in the object to the
13224>>>>>>>>>>>        // comValue in the control. It will try to keep these values in synch at all times. This allows a
13224>>>>>>>>>>>        // control to be used as a Form style value control. the default is true. Even when true if the
13224>>>>>>>>>>>        // get/set ComValue methods are not set up to do anything, this will do nothing.
13224>>>>>>>>>>>        Property boolean pbBindValue True
13225>>>>>>>>>>>
13225>>>>>>>>>>>        // internal: set true object is notified that the OCX value has changed.
13225>>>>>>>>>>>        Property Boolean pbPrivateControlChanging false
13226>>>>>>>>>>>
13226>>>>>>>>>>>        // Class sets this true when making a local (externally triggered) change. This is
13226>>>>>>>>>>>        // set when a Set Value change is made to prevent recursion
13226>>>>>>>>>>>        property Boolean pbPrivateControlRefresh false
13227>>>>>>>>>>>
13227>>>>>>>>>>>        // added to eumlate a single item form support
13227>>>>>>>>>>>        property Boolean pbPrivateItem_Changed_State false
13228>>>>>>>>>>>
13228>>>>>>>>>>>        // This keeps track of value, even when control is not created
13228>>>>>>>>>>>        Property String psPrivateValue ''
13229>>>>>>>>>>>
13229>>>>>>>>>>>    End_Procedure
13230>>>>>>>>>>>
13230>>>>>>>>>>>    Import_Class_Protocol Standard_Object_Mixin
13231>>>>>>>>>>>    Import_Class_Protocol Single_Item_Navigate_Mixin
13232>>>>>>>>>>>    Import_Class_Protocol Dflabel_Mixin
13233>>>>>>>>>>>
13233>>>>>>>>>>>    // It is expected that the Com class will augment this with useful event definitions
13233>>>>>>>>>>>    Procedure RegisterComEvents
13235>>>>>>>>>>>    End_Procedure
13236>>>>>>>>>>>
13236>>>>>>>>>>>    // added to eumlate a single item form support
13236>>>>>>>>>>>    Function Item_Count returns integer
13238>>>>>>>>>>>        function_return 1
13239>>>>>>>>>>>    end_function
13240>>>>>>>>>>>
13240>>>>>>>>>>>    // added to eumlate a single item form support
13240>>>>>>>>>>>    Procedure Set Item_Changed_State integer iItem integer iState
13242>>>>>>>>>>>       Set pbPrivateItem_changed_state to iState
13243>>>>>>>>>>>        If (iState and changed_state(self)=false) set changed_state to true
13246>>>>>>>>>>>    end_procedure
13247>>>>>>>>>>>
13247>>>>>>>>>>>    Function Item_Changed_State integer iItem returns integer
13249>>>>>>>>>>>        function_return (pbPrivateItem_changed_state(self))
13250>>>>>>>>>>>    end_function
13251>>>>>>>>>>>
13251>>>>>>>>>>>
13251>>>>>>>>>>>    // augment to set the label's appearance
13251>>>>>>>>>>>    Procedure Shadow_Display
13253>>>>>>>>>>>        forward send Shadow_display
13255>>>>>>>>>>>        Send Label_Shadow_Display
13256>>>>>>>>>>>    End_Procedure // Shadow_Display
13257>>>>>>>>>>>
13257>>>>>>>>>>>    // Created to simulate get/Set value.
13257>>>>>>>>>>>    Procedure set Value integer iItem string sVal
13259>>>>>>>>>>>        If not (pbPrivateControlChanging(self)) ;            Send OnRefreshControl sVal
13262>>>>>>>>>>>        Set psPrivateValue to sVal
13263>>>>>>>>>>>        Send OnChange
13264>>>>>>>>>>>        //Set changed_state to True
13264>>>>>>>>>>>        set item_changed_state 0 to true
13265>>>>>>>>>>>    End_Procedure
13266>>>>>>>>>>>
13266>>>>>>>>>>>    Function Value integer iItem returns string
13268>>>>>>>>>>>        function_return (psPrivateValue(self))
13269>>>>>>>>>>>        //function_return (Controlvalue(self))
13269>>>>>>>>>>>    end_function
13270>>>>>>>>>>>
13270>>>>>>>>>>>    Procedure OnChange
13272>>>>>>>>>>>    End_Procedure
13273>>>>>>>>>>>
13273>>>>>>>>>>>
13273>>>>>>>>>>>    // It is expected that the sub-class will provide functionality
13273>>>>>>>>>>>    // for these messages. This gets and sets the value of the actual
13273>>>>>>>>>>>    // window control. These should only be used to synchronize the window
13273>>>>>>>>>>>    // control and the DF side. Do not use for any other purpose.
13273>>>>>>>>>>>    Procedure Set ControlValue string sVal
13275>>>>>>>>>>>    End_Procedure
13276>>>>>>>>>>>
13276>>>>>>>>>>>    Function ControlValue Returns String
13278>>>>>>>>>>>    End_Function
13279>>>>>>>>>>>
13279>>>>>>>>>>>   Procedure OnCreate
13281>>>>>>>>>>>       // if we are binding value to comValue, do so upon creation
13281>>>>>>>>>>>       If (pbBindValue(self)) ;           Set ControlValue to (Value(self))
13284>>>>>>>>>>>       Forward Send OnCreate
13286>>>>>>>>>>>   End_Procedure
13287>>>>>>>>>>>
13287>>>>>>>>>>>
13287>>>>>>>>>>>    // returns true if the control is created.
13287>>>>>>>>>>>    Function IsComObjectCreated Returns Boolean
13289>>>>>>>>>>>        Variant vComObject
13289>>>>>>>>>>>        Get pvComObject to vComObject
13290>>>>>>>>>>>        Function_Return (Not(IsNullComObject(vComObject)))
13291>>>>>>>>>>>    End_Function
13292>>>>>>>>>>>
13292>>>>>>>>>>>    // Notification that the control's value has been changed
13292>>>>>>>>>>>    // externally by the program (via set value). Use to synchronize
13292>>>>>>>>>>>    // OCX control value.
13292>>>>>>>>>>>    Procedure OnRefreshControl string sVal
13294>>>>>>>>>>>        Boolean bOld
13294>>>>>>>>>>>        If (pbBindValue(self) and pbPrivateControlChanging(self)=0 And IsComObjectCreated(self)) Begin
13296>>>>>>>>>>>            Get pbPrivateControlRefresh to bOld
13297>>>>>>>>>>>            Set pbPrivateControlRefresh to True
13298>>>>>>>>>>>            set ControlValue to sval
13299>>>>>>>>>>>            Set pbPrivateControlRefresh to bOld
13300>>>>>>>>>>>        end
13300>>>>>>>>>>>>
13300>>>>>>>>>>>    End_Procedure
13301>>>>>>>>>>>
13301>>>>>>>>>>>    // notification that the control has changed its value. Used to
13301>>>>>>>>>>>    // synchronize the object with the change.
13301>>>>>>>>>>>    Procedure OnControlValueChanged
13303>>>>>>>>>>>        String sVal
13303>>>>>>>>>>>        Boolean bOld
13303>>>>>>>>>>>        If (pbBindValue(self) and pbPrivateControlRefresh(self)=0) Begin
13305>>>>>>>>>>>            Get pbPrivateControlChanging to bOld
13306>>>>>>>>>>>            Set pbPrivateControlChanging to True
13307>>>>>>>>>>>            Get ControlValue to sVal
13308>>>>>>>>>>>            Set Value to sVal
13309>>>>>>>>>>>            Set Item_Changed_State 0 to True
13310>>>>>>>>>>>            Set pbPrivateControlChanging to bOld
13311>>>>>>>>>>>        end
13311>>>>>>>>>>>>
13311>>>>>>>>>>>    End_Procedure
13312>>>>>>>>>>>
13312>>>>>>>>>>>    Procedure Delete_Data
13314>>>>>>>>>>>        Forward Send Delete_Data
13316>>>>>>>>>>>        Set Value to ''
13317>>>>>>>>>>>        Set Changed_state to False
13318>>>>>>>>>>>        Set Item_changed_state 0 to false
13319>>>>>>>>>>>    End_Procedure
13320>>>>>>>>>>>
13320>>>>>>>>>>>End_Class
13321>>>>>>>>>>>
13321>>>>>>>>>
13321>>>>>>>>>// Changes to Imported package
13321>>>>>>>>>//     OLEXTPxx to XTPxx
13321>>>>>>>>>//     OLExtpxx to xtpxx
13321>>>>>>>>>//     OLESTDxxx and OLEXPxxxx to STD/XP
13321>>>>>>>>>//     OLEOLE to OLE
13321>>>>>>>>>//     OLESBPS to SBPS
13321>>>>>>>>>//     OLETPM to TPM
13321>>>>>>>>>//     cCom classes to cCJ
13321>>>>>>>>>//     cCJAutomationObject back to cComAutomationObject
13321>>>>>>>>>//     cCJActiveXControl back to cComActiveXControl
13321>>>>>>>>>//     cCJTabToolBar to cCJComTabToolBar
13321>>>>>>>>>//     cCJTabControlItem to cCJComTabControlItem
13321>>>>>>>>>//     cCJStatusBar to cCJComStatusBar
13321>>>>>>>>>//     cCJStatusBarPane to cCJComStatusBarPane
13321>>>>>>>>>//     cCJMenuBar to cCJComMenuBar
13321>>>>>>>>>//     remove OnComUpdate from cCJCommandBars
13321>>>>>>>>>//     Use statements as noted below (classes moved to these files)
13321>>>>>>>>>//     Set classlibrary of all cComAutomation objects to Windows (for class doc)
13321>>>>>>>>>
13321>>>>>>>>>// These have been extracted from this class and moved into seperate packages
13321>>>>>>>>>// because other Codejock classes use these.
13321>>>>>>>>>Use cCJColorManager.pkg     // cCJColorManager
Including file: cCJColorManager.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJColorManager.pkg)
13321>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13321>>>>>>>>>>>Use FlexCom20.pkg
13321>>>>>>>>>>>
13321>>>>>>>>>>>Use FlexCom20.pkg
13321>>>>>>>>>>>
13321>>>>>>>>>>>Define XTPColorManagerColor for Integer
13321>>>>>>>>>>>    Define STDCOLOR_BACKGROUND for 1
13321>>>>>>>>>>>    Define STDCOLOR_ACTIVECAPTION for 2
13321>>>>>>>>>>>    Define STDCOLOR_INACTIVECAPTION for 3
13321>>>>>>>>>>>    Define STDCOLOR_MENU for 4
13321>>>>>>>>>>>    Define STDCOLOR_WINDOW for 5
13321>>>>>>>>>>>    Define STDCOLOR_WINDOWFRAME for 6
13321>>>>>>>>>>>    Define STDCOLOR_MENUTEXT for 7
13321>>>>>>>>>>>    Define STDCOLOR_WINDOWTEXT for 8
13321>>>>>>>>>>>    Define STDCOLOR_CAPTIONTEXT for 9
13321>>>>>>>>>>>    Define STDCOLOR_ACTIVEBORDER for 10
13321>>>>>>>>>>>    Define STDCOLOR_INACTIVEBORDER for 11
13321>>>>>>>>>>>    Define STDCOLOR_APPWORKSPACE for 12
13321>>>>>>>>>>>    Define STDCOLOR_HIGHLIGHT for 13
13321>>>>>>>>>>>    Define STDCOLOR_HIGHLIGHTTEXT for 14
13321>>>>>>>>>>>    Define STDCOLOR_BTNFACE for 15
13321>>>>>>>>>>>    Define STDCOLOR_BTNSHADOW for 16
13321>>>>>>>>>>>    Define STDCOLOR_GRAYTEXT for 17
13321>>>>>>>>>>>    Define STDCOLOR_BTNTEXT for 18
13321>>>>>>>>>>>    Define STDCOLOR_INACTIVECAPTIONTEXT for 19
13321>>>>>>>>>>>    Define STDCOLOR_BTNHIGHLIGHT for 20
13321>>>>>>>>>>>    Define STDCOLOR_3DDKSHADOW for 21
13321>>>>>>>>>>>    Define STDCOLOR_3DLIGHT for 22
13321>>>>>>>>>>>    Define STDCOLOR_INFOTEXT for 23
13321>>>>>>>>>>>    Define STDCOLOR_INFOBK for 24
13321>>>>>>>>>>>    Define STDCOLOR_HOTLIGHT for 26
13321>>>>>>>>>>>    Define STDCOLOR_GRADIENTACTIVECAPTION for 27
13321>>>>>>>>>>>    Define STDCOLOR_GRADIENTINACTIVECAPTION for 28
13321>>>>>>>>>>>    Define XPCOLOR_TOOLBAR_FACE for 30
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT for 31
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_BORDER for 32
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_PUSHED for 33
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_CHECKED for 36
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_CHECKED_BORDER for 37
13321>>>>>>>>>>>    Define XPCOLOR_ICONSHADDOW for 34
13321>>>>>>>>>>>    Define XPCOLOR_GRAYTEXT for 35
13321>>>>>>>>>>>    Define XPCOLOR_TOOLBAR_GRIPPER for 38
13321>>>>>>>>>>>    Define XPCOLOR_SEPARATOR for 39
13321>>>>>>>>>>>    Define XPCOLOR_DISABLED for 40
13321>>>>>>>>>>>    Define XPCOLOR_MENUBAR_FACE for 41
13321>>>>>>>>>>>    Define XPCOLOR_MENUBAR_EXPANDED for 42
13321>>>>>>>>>>>    Define XPCOLOR_MENUBAR_BORDER for 43
13321>>>>>>>>>>>    Define XPCOLOR_MENUBAR_TEXT for 44
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_TEXT for 45
13321>>>>>>>>>>>    Define XPCOLOR_TOOLBAR_TEXT for 46
13321>>>>>>>>>>>    Define XPCOLOR_PUSHED_TEXT for 47
13321>>>>>>>>>>>    Define XPCOLOR_TAB_INACTIVE_BACK for 48
13321>>>>>>>>>>>    Define XPCOLOR_TAB_INACTIVE_TEXT for 49
13321>>>>>>>>>>>    Define XPCOLOR_HIGHLIGHT_PUSHED_BORDER for 50
13321>>>>>>>>>>>    Define XPCOLOR_3DFACE for 51
13321>>>>>>>>>>>    Define XPCOLOR_3DSHADOW for 52
13321>>>>>>>>>>>    Define XPCOLOR_FRAME for 54
13321>>>>>>>>>>>    Define XPCOLOR_SPLITTER_FACE for 55
13321>>>>>>>>>>>    Define XPCOLOR_LABEL for 56
13321>>>>>>>>>>>    Define XPCOLOR_STATICFRAME for 57
13321>>>>>>>>>>>
13321>>>>>>>>>>>Define XTPCurrentSystemTheme for Integer
13321>>>>>>>>>>>    // No known theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeUnknown for 0
13321>>>>>>>>>>>    // Blue theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeBlue for 1
13321>>>>>>>>>>>    // Olive theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeOlive for 2
13321>>>>>>>>>>>    // Silver theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeSilver for 3
13321>>>>>>>>>>>    // Silver theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeRoyale for 4
13321>>>>>>>>>>>    // Silver theme in use
13321>>>>>>>>>>>    Define xtpSystemThemeAero for 5
13321>>>>>>>>>>>    // Use OS theme.
13321>>>>>>>>>>>    Define xtpSystemThemeAuto for 6
13321>>>>>>>>>>>
13321>>>>>>>>>>>// CLSID: {63C40CBE-DE43-4B56-BCEB-E14B825CF245}
13321>>>>>>>>>>>Class cCJIColorManager is a Mixin
13322>>>>>>>>>>>
13322>>>>>>>>>>>    Function ComSystemTheme Returns XTPCurrentSystemTheme
13324>>>>>>>>>>>        XTPCurrentSystemTheme retVal
13324>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
13325>>>>>>>>>>>        Function_Return retVal
13326>>>>>>>>>>>    End_Function
13327>>>>>>>>>>>
13327>>>>>>>>>>>    Procedure Set ComSystemTheme XTPCurrentSystemTheme value
13329>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
13330>>>>>>>>>>>    End_Procedure
13331>>>>>>>>>>>
13331>>>>>>>>>>>    Function ComEnableLunaBlueForRoyaleTheme Returns Boolean
13333>>>>>>>>>>>        Boolean retVal
13333>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
13334>>>>>>>>>>>        Function_Return retVal
13335>>>>>>>>>>>    End_Function
13336>>>>>>>>>>>
13336>>>>>>>>>>>    Procedure Set ComEnableLunaBlueForRoyaleTheme Boolean value
13338>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
13339>>>>>>>>>>>    End_Procedure
13340>>>>>>>>>>>
13340>>>>>>>>>>>    Function ComColor XTPColorManagerColor llIndex Returns OLE_COLOR
13342>>>>>>>>>>>        Handle hDispatchDriver
13342>>>>>>>>>>>        OLE_COLOR retVal
13342>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13343>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13344>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
13345>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_I4 to retVal
13346>>>>>>>>>>>        Function_Return retVal
13347>>>>>>>>>>>    End_Function
13348>>>>>>>>>>>
13348>>>>>>>>>>>    Procedure ComSetColor XTPColorManagerColor llIndex OLE_COLOR llColor
13350>>>>>>>>>>>        Handle hDispatchDriver
13350>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13351>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13352>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
13353>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
13354>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 1 OLE_VT_VOID
13355>>>>>>>>>>>    End_Procedure
13356>>>>>>>>>>>
13356>>>>>>>>>>>    Function ComGetCurrentSystemTheme Returns XTPCurrentSystemTheme
13358>>>>>>>>>>>        Handle hDispatchDriver
13358>>>>>>>>>>>        XTPCurrentSystemTheme retVal
13358>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13359>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_I4 to retVal
13360>>>>>>>>>>>        Function_Return retVal
13361>>>>>>>>>>>    End_Function
13362>>>>>>>>>>>End_Class
13363>>>>>>>>>>>
13363>>>>>>>>>>>// CoClass
13363>>>>>>>>>>>// CLSID: {E232C4DB-8C00-4F05-AF87-9F05BCB55475}
13363>>>>>>>>>>>Class cCJColorManager is a cComAutomationObject
13364>>>>>>>>>>>    Import_Class_Protocol cCJIColorManager
13365>>>>>>>>>>>
13365>>>>>>>>>>>    Procedure Construct_Object
13367>>>>>>>>>>>        Forward Send Construct_Object
13369>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
13370>>>>>>>>>>>    End_Procedure
13371>>>>>>>>>>>End_Class
13372>>>>>>>>>>>
13372>>>>>>>>>Use cCJImageManager.pkg     // cCJImageManagerIcons, cCJImageManagerIcon, cCJImageManager, cCJImageManagerIconSet
Including file: cCJImageManager.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJImageManager.pkg)
13372>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13372>>>>>>>>>>>Use FlexCom20.pkg
13372>>>>>>>>>>>
13372>>>>>>>>>>>// Image State
13372>>>>>>>>>>>Define XTPImageState for Integer
13372>>>>>>>>>>>    Define xtpImageNormal for 0
13372>>>>>>>>>>>    Define xtpImageDisabled for 1
13372>>>>>>>>>>>    Define xtpImageHot for 2
13372>>>>>>>>>>>    Define xtpImageChecked for 3
13372>>>>>>>>>>>    Define xtpImagePressed for 4
13372>>>>>>>>>>>
13372>>>>>>>>>>>// CLSID: {DCDB9842-AE6D-46A8-BC77-CEE7D5CE9ED7}
13372>>>>>>>>>>>Class cCJIImageManagerIcons is a Mixin
13373>>>>>>>>>>>
13373>>>>>>>>>>>    Function ComDrawReverted Returns Boolean
13375>>>>>>>>>>>        Boolean retVal
13375>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
13376>>>>>>>>>>>        Function_Return retVal
13377>>>>>>>>>>>    End_Function
13378>>>>>>>>>>>
13378>>>>>>>>>>>    Procedure Set ComDrawReverted Boolean value
13380>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
13381>>>>>>>>>>>    End_Procedure
13382>>>>>>>>>>>
13382>>>>>>>>>>>    Function ComMaskColor Returns OLE_COLOR
13384>>>>>>>>>>>        OLE_COLOR retVal
13384>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to retVal
13385>>>>>>>>>>>        Function_Return retVal
13386>>>>>>>>>>>    End_Function
13387>>>>>>>>>>>
13387>>>>>>>>>>>    Procedure Set ComMaskColor OLE_COLOR value
13389>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to value
13390>>>>>>>>>>>    End_Procedure
13391>>>>>>>>>>>
13391>>>>>>>>>>>    Function ComCount Returns Integer
13393>>>>>>>>>>>        Handle hDispatchDriver
13393>>>>>>>>>>>        Integer retVal
13393>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13394>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
13395>>>>>>>>>>>        Function_Return retVal
13396>>>>>>>>>>>    End_Function
13397>>>>>>>>>>>
13397>>>>>>>>>>>    Procedure ComAddIcon Integer llHandle Integer llCommand XTPImageState llimageState
13399>>>>>>>>>>>        Handle hDispatchDriver
13399>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13400>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
13401>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llHandle
13402>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
13403>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13404>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
13405>>>>>>>>>>>    End_Procedure
13406>>>>>>>>>>>
13406>>>>>>>>>>>    Procedure ComLoadIcon String llPath Integer llCommand XTPImageState llimageState
13408>>>>>>>>>>>        Handle hDispatchDriver
13408>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13409>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
13410>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
13411>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
13412>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13413>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
13414>>>>>>>>>>>    End_Procedure
13415>>>>>>>>>>>
13415>>>>>>>>>>>    Procedure ComAddBitmap Integer llHandle Variant llCommands XTPImageState llimageState Boolean llAlpha
13417>>>>>>>>>>>        Handle hDispatchDriver
13417>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13418>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
13419>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llHandle
13420>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llCommands
13421>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13422>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llAlpha
13423>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
13424>>>>>>>>>>>    End_Procedure
13425>>>>>>>>>>>
13425>>>>>>>>>>>    Procedure ComLoadBitmap String llPath Variant llCommands XTPImageState llimageState
13427>>>>>>>>>>>        Handle hDispatchDriver
13427>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13428>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
13429>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
13430>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llCommands
13431>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13432>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
13433>>>>>>>>>>>    End_Procedure
13434>>>>>>>>>>>
13434>>>>>>>>>>>    Procedure ComLoadBitmapFromResource OLE_HANDLE llModule Integer llResource Variant llCommands XTPImageState llimageState
13436>>>>>>>>>>>        Handle hDispatchDriver
13436>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13437>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
13438>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llModule
13439>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llResource
13440>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llCommands
13441>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13442>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
13443>>>>>>>>>>>    End_Procedure
13444>>>>>>>>>>>
13444>>>>>>>>>>>    Procedure ComLoadIconFromResource OLE_HANDLE llModule Integer llResource Integer llCommand XTPImageState llimageState
13446>>>>>>>>>>>        Handle hDispatchDriver
13446>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13447>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
13448>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llModule
13449>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llResource
13450>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
13451>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
13452>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
13453>>>>>>>>>>>    End_Procedure
13454>>>>>>>>>>>
13454>>>>>>>>>>>    Procedure ComRemoveAll
13456>>>>>>>>>>>        Handle hDispatchDriver
13456>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13457>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
13458>>>>>>>>>>>    End_Procedure
13459>>>>>>>>>>>
13459>>>>>>>>>>>    Procedure ComAddIcons Variant llIcons
13461>>>>>>>>>>>        Handle hDispatchDriver
13461>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13462>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13463>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llIcons
13464>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
13465>>>>>>>>>>>    End_Procedure
13466>>>>>>>>>>>
13466>>>>>>>>>>>    Procedure ComRemoveIcon Integer llCommand
13468>>>>>>>>>>>        Handle hDispatchDriver
13468>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13469>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13470>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
13471>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 10 OLE_VT_VOID
13472>>>>>>>>>>>    End_Procedure
13473>>>>>>>>>>>
13473>>>>>>>>>>>    Function ComIsAlphaIconsSupported Returns Boolean
13475>>>>>>>>>>>        Handle hDispatchDriver
13475>>>>>>>>>>>        Boolean retVal
13475>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13476>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_BOOL to retVal
13477>>>>>>>>>>>        Function_Return retVal
13478>>>>>>>>>>>    End_Function
13479>>>>>>>>>>>
13479>>>>>>>>>>>    Procedure ComRefreshAll
13481>>>>>>>>>>>        Handle hDispatchDriver
13481>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13482>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 12 OLE_VT_VOID
13483>>>>>>>>>>>    End_Procedure
13484>>>>>>>>>>>
13484>>>>>>>>>>>    Function ComGetImage Integer llCommand Integer llWidth Returns Variant
13486>>>>>>>>>>>        Handle hDispatchDriver
13486>>>>>>>>>>>        Variant retVal
13486>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13487>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13488>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
13489>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
13490>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_DISPATCH to retVal
13491>>>>>>>>>>>        Function_Return retVal
13492>>>>>>>>>>>    End_Function
13493>>>>>>>>>>>
13493>>>>>>>>>>>    Function Com_NewEnum Returns Variant
13495>>>>>>>>>>>        Handle hDispatchDriver
13495>>>>>>>>>>>        Variant retVal
13495>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13496>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
13497>>>>>>>>>>>        Function_Return retVal
13498>>>>>>>>>>>    End_Function
13499>>>>>>>>>>>
13499>>>>>>>>>>>    Procedure ComDoPropExchange Variant llpPX
13501>>>>>>>>>>>        Handle hDispatchDriver
13501>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13502>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13503>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llpPX
13504>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
13505>>>>>>>>>>>    End_Procedure
13506>>>>>>>>>>>End_Class
13507>>>>>>>>>>>
13507>>>>>>>>>>>// CoClass
13507>>>>>>>>>>>// CLSID: {1232C4DB-8C00-4F05-AF87-9F05BCB55475}
13507>>>>>>>>>>>Class cCJImageManagerIcons is a cComAutomationObject
13508>>>>>>>>>>>    Import_Class_Protocol cCJIImageManagerIcons
13509>>>>>>>>>>>
13509>>>>>>>>>>>    Procedure Construct_Object
13511>>>>>>>>>>>        Forward Send Construct_Object
13513>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
13514>>>>>>>>>>>    End_Procedure
13515>>>>>>>>>>>End_Class
13516>>>>>>>>>>>
13516>>>>>>>>>>>// CLSID: {1B4C4444-7540-4926-8D3D-82A953AE7B7B}
13516>>>>>>>>>>>// Dispatch interface for ImageManager Control
13516>>>>>>>>>>>Class cCJ_DImageManager is a Mixin
13517>>>>>>>>>>>
13517>>>>>>>>>>>    Function ComIcons Returns Variant
13519>>>>>>>>>>>        Variant retVal
13519>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_DISPATCH to retVal
13520>>>>>>>>>>>        Function_Return retVal
13521>>>>>>>>>>>    End_Function
13522>>>>>>>>>>>
13522>>>>>>>>>>>    Procedure Set ComIcons Variant value
13524>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_DISPATCH to value
13525>>>>>>>>>>>    End_Procedure
13526>>>>>>>>>>>
13526>>>>>>>>>>>    Function ComIsAlphaIconsSupported Returns Boolean
13528>>>>>>>>>>>        Handle hDispatchDriver
13528>>>>>>>>>>>        Boolean retVal
13528>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13529>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BOOL to retVal
13530>>>>>>>>>>>        Function_Return retVal
13531>>>>>>>>>>>    End_Function
13532>>>>>>>>>>>
13532>>>>>>>>>>>    Procedure ComAboutBox
13534>>>>>>>>>>>        Handle hDispatchDriver
13534>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13535>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
13536>>>>>>>>>>>    End_Procedure
13537>>>>>>>>>>>End_Class
13538>>>>>>>>>>>
13538>>>>>>>>>>>// CLSID: {C3B3E592-E0F3-48CF-BD1D-5305A4F46C99}
13538>>>>>>>>>>>// Event interface for ImageManager Control
13538>>>>>>>>>>>Class cCJ_DImageManagerEvents is a Mixin
13539>>>>>>>>>>>
13539>>>>>>>>>>>    Procedure RegisterComEvents
13541>>>>>>>>>>>    End_Procedure
13542>>>>>>>>>>>End_Class
13543>>>>>>>>>>>
13543>>>>>>>>>>>// CoClass
13543>>>>>>>>>>>// ProgID: Codejock.ImageManager.17.3.0
13543>>>>>>>>>>>// CLSID: {AD0132CD-DC31-4F33-8FFA-7EFDA4CB96F4}
13543>>>>>>>>>>>// Xtreme ImageManager Control
13543>>>>>>>>>>>Class cCJImageManager is a cComActiveXControl
13544>>>>>>>>>>>    Import_Class_Protocol cCJ_DImageManager
13545>>>>>>>>>>>    Import_Class_Protocol cCJ_DImageManagerEvents
13546>>>>>>>>>>>
13546>>>>>>>>>>>    Procedure Construct_Object
13548>>>>>>>>>>>        Forward Send Construct_Object
13550>>>>>>>>>>>        Set psProgID to "{AD0132CD-DC31-4F33-8FFA-7EFDA4CB96F4}"
13551>>>>>>>>>>>        Set psEventId to "{C3B3E592-E0F3-48CF-BD1D-5305A4F46C99}"
13552>>>>>>>>>>>        Set peAutoCreate to acAutoCreate
13553>>>>>>>>>>>    End_Procedure
13554>>>>>>>>>>>End_Class
13555>>>>>>>>>>>
13555>>>>>>>>>>>// CLSID: {1CDB9842-AE6D-46A8-BC77-CEE7D5CE9ED7}
13555>>>>>>>>>>>Class cCJImageManagerIcon is a cComAutomationObject
13556>>>>>>>>>>>
13556>>>>>>>>>>>    Function ComId Returns Integer
13558>>>>>>>>>>>        Handle hDispatchDriver
13558>>>>>>>>>>>        Integer retVal
13558>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13559>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
13560>>>>>>>>>>>        Function_Return retVal
13561>>>>>>>>>>>    End_Function
13562>>>>>>>>>>>
13562>>>>>>>>>>>    Function ComWidth Returns Integer
13564>>>>>>>>>>>        Handle hDispatchDriver
13564>>>>>>>>>>>        Integer retVal
13564>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13565>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_I4 to retVal
13566>>>>>>>>>>>        Function_Return retVal
13567>>>>>>>>>>>    End_Function
13568>>>>>>>>>>>
13568>>>>>>>>>>>    Function ComHeight Returns Integer
13570>>>>>>>>>>>        Handle hDispatchDriver
13570>>>>>>>>>>>        Integer retVal
13570>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13571>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
13572>>>>>>>>>>>        Function_Return retVal
13573>>>>>>>>>>>    End_Function
13574>>>>>>>>>>>
13574>>>>>>>>>>>    Function ComScaled Returns Boolean
13576>>>>>>>>>>>        Handle hDispatchDriver
13576>>>>>>>>>>>        Boolean retVal
13576>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13577>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_BOOL to retVal
13578>>>>>>>>>>>        Function_Return retVal
13579>>>>>>>>>>>    End_Function
13580>>>>>>>>>>>
13580>>>>>>>>>>>    Function ComAlpha Returns Boolean
13582>>>>>>>>>>>        Handle hDispatchDriver
13582>>>>>>>>>>>        Boolean retVal
13582>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13583>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_BOOL to retVal
13584>>>>>>>>>>>        Function_Return retVal
13585>>>>>>>>>>>    End_Function
13586>>>>>>>>>>>
13586>>>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
13588>>>>>>>>>>>        Handle hDispatchDriver
13588>>>>>>>>>>>        OLE_HANDLE retVal
13588>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13589>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_I4 to retVal
13590>>>>>>>>>>>        Function_Return retVal
13591>>>>>>>>>>>    End_Function
13592>>>>>>>>>>>
13592>>>>>>>>>>>    Procedure ComDraw OLE_HANDLE llhDC Integer llx Integer lly Integer llcx Integer llcy XTPImageState llstate
13594>>>>>>>>>>>        Handle hDispatchDriver
13594>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13595>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 6
13596>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhDC
13597>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
13598>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
13599>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
13600>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
13601>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llstate
13602>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
13603>>>>>>>>>>>    End_Procedure
13604>>>>>>>>>>>
13604>>>>>>>>>>>    Function ComCreatePicture XTPImageState llstate Returns Variant
13606>>>>>>>>>>>        Handle hDispatchDriver
13606>>>>>>>>>>>        Variant retVal
13606>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13607>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13608>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llstate
13609>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_DISPATCH to retVal
13610>>>>>>>>>>>        Function_Return retVal
13611>>>>>>>>>>>    End_Function
13612>>>>>>>>>>>
13612>>>>>>>>>>>    Function ComScale Integer llWidth Returns Variant
13614>>>>>>>>>>>        Handle hDispatchDriver
13614>>>>>>>>>>>        Variant retVal
13614>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13615>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13616>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
13617>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_DISPATCH to retVal
13618>>>>>>>>>>>        Function_Return retVal
13619>>>>>>>>>>>    End_Function
13620>>>>>>>>>>>End_Class
13621>>>>>>>>>>>
13621>>>>>>>>>>>// CLSID: {567B9842-AE6D-46A8-BC77-CEE7D5CE9ED7}
13621>>>>>>>>>>>Class cCJImageManagerIconSet is a cComAutomationObject
13622>>>>>>>>>>>
13622>>>>>>>>>>>    Function ComId Returns Integer
13624>>>>>>>>>>>        Handle hDispatchDriver
13624>>>>>>>>>>>        Integer retVal
13624>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13625>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
13626>>>>>>>>>>>        Function_Return retVal
13627>>>>>>>>>>>    End_Function
13628>>>>>>>>>>>
13628>>>>>>>>>>>    Function ComCount Returns Integer
13630>>>>>>>>>>>        Handle hDispatchDriver
13630>>>>>>>>>>>        Integer retVal
13630>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13631>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_I4 to retVal
13632>>>>>>>>>>>        Function_Return retVal
13633>>>>>>>>>>>    End_Function
13634>>>>>>>>>>>
13634>>>>>>>>>>>    Function ComGetImage Integer llWidth Returns Variant
13636>>>>>>>>>>>        Handle hDispatchDriver
13636>>>>>>>>>>>        Variant retVal
13636>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13637>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13638>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
13639>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_DISPATCH to retVal
13640>>>>>>>>>>>        Function_Return retVal
13641>>>>>>>>>>>    End_Function
13642>>>>>>>>>>>
13642>>>>>>>>>>>    Function Com_NewEnum Returns Variant
13644>>>>>>>>>>>        Handle hDispatchDriver
13644>>>>>>>>>>>        Variant retVal
13644>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13645>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
13646>>>>>>>>>>>        Function_Return retVal
13647>>>>>>>>>>>    End_Function
13648>>>>>>>>>>>End_Class
13649>>>>>>>>>>>
13649>>>>>>>>>Use cCJPropExchange.pkg     // cCJPropExchange
Including file: cCJPropExchange.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJPropExchange.pkg)
13649>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13649>>>>>>>>>>>Use FlexCom20.pkg
13649>>>>>>>>>>>
13649>>>>>>>>>>>// CLSID: {A56F6C0F-BCC7-48A0-B69E-6DD726B9B309}
13649>>>>>>>>>>>Class cCJPropExchange is a cComAutomationObject
13650>>>>>>>>>>>
13650>>>>>>>>>>>    Function ComValue Returns Variant
13652>>>>>>>>>>>        Variant retVal
13652>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_VARIANT to retVal
13653>>>>>>>>>>>        Function_Return retVal
13654>>>>>>>>>>>    End_Function
13655>>>>>>>>>>>
13655>>>>>>>>>>>    Procedure Set ComValue Variant value
13657>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_VARIANT to value
13658>>>>>>>>>>>    End_Procedure
13659>>>>>>>>>>>
13659>>>>>>>>>>>    Function ComEncoding Returns String
13661>>>>>>>>>>>        String retVal
13661>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to retVal
13662>>>>>>>>>>>        Function_Return retVal
13663>>>>>>>>>>>    End_Function
13664>>>>>>>>>>>
13664>>>>>>>>>>>    Procedure Set ComEncoding String value
13666>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to value
13667>>>>>>>>>>>    End_Procedure
13668>>>>>>>>>>>
13668>>>>>>>>>>>    Function ComCreateAsXML Boolean llLoading String llSection Returns Boolean
13670>>>>>>>>>>>        Handle hDispatchDriver
13670>>>>>>>>>>>        Boolean retVal
13670>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13671>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13672>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llLoading
13673>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llSection
13674>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_BOOL to retVal
13675>>>>>>>>>>>        Function_Return retVal
13676>>>>>>>>>>>    End_Function
13677>>>>>>>>>>>
13677>>>>>>>>>>>    Function ComCreateAsRegistry Boolean llLoading String llSection Returns Boolean
13679>>>>>>>>>>>        Handle hDispatchDriver
13679>>>>>>>>>>>        Boolean retVal
13679>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13680>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13681>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llLoading
13682>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llSection
13683>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BOOL to retVal
13684>>>>>>>>>>>        Function_Return retVal
13685>>>>>>>>>>>    End_Function
13686>>>>>>>>>>>
13686>>>>>>>>>>>    Function ComCreateAsBinaryFile Boolean llLoading String llPath Returns Boolean
13688>>>>>>>>>>>        Handle hDispatchDriver
13688>>>>>>>>>>>        Boolean retVal
13688>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13689>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13690>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llLoading
13691>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
13692>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BOOL to retVal
13693>>>>>>>>>>>        Function_Return retVal
13694>>>>>>>>>>>    End_Function
13695>>>>>>>>>>>
13695>>>>>>>>>>>    Function ComLoadFromFile String llPath Returns Boolean
13697>>>>>>>>>>>        Handle hDispatchDriver
13697>>>>>>>>>>>        Boolean retVal
13697>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13698>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13699>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
13700>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_BOOL to retVal
13701>>>>>>>>>>>        Function_Return retVal
13702>>>>>>>>>>>    End_Function
13703>>>>>>>>>>>
13703>>>>>>>>>>>    Procedure ComSaveToFile String llPath
13705>>>>>>>>>>>        Handle hDispatchDriver
13705>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13706>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13707>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
13708>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
13709>>>>>>>>>>>    End_Procedure
13710>>>>>>>>>>>
13710>>>>>>>>>>>    Function ComGetSection String llSection Returns Variant
13712>>>>>>>>>>>        Handle hDispatchDriver
13712>>>>>>>>>>>        Variant retVal
13712>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13713>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
13714>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llSection
13715>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_DISPATCH to retVal
13716>>>>>>>>>>>        Function_Return retVal
13717>>>>>>>>>>>    End_Function
13718>>>>>>>>>>>
13718>>>>>>>>>>>    Procedure ComExchangeString String llPropName String ByRef llValue String llDefaultValue
13720>>>>>>>>>>>        Handle hDispatchDriver
13720>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13721>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
13722>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPropName
13723>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_BSTR) llValue
13724>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llDefaultValue
13725>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
13726>>>>>>>>>>>    End_Procedure
13727>>>>>>>>>>>
13727>>>>>>>>>>>    Procedure ComExchangeInt String llPropName Integer ByRef llValue Integer llDefaultValue
13729>>>>>>>>>>>        Handle hDispatchDriver
13729>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13730>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
13731>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPropName
13732>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llValue
13733>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llDefaultValue
13734>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
13735>>>>>>>>>>>    End_Procedure
13736>>>>>>>>>>>
13736>>>>>>>>>>>    Function ComLoading Returns Boolean
13738>>>>>>>>>>>        Handle hDispatchDriver
13738>>>>>>>>>>>        Boolean retVal
13738>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13739>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_BOOL to retVal
13740>>>>>>>>>>>        Function_Return retVal
13741>>>>>>>>>>>    End_Function
13742>>>>>>>>>>>
13742>>>>>>>>>>>    Function ComValid Returns Boolean
13744>>>>>>>>>>>        Handle hDispatchDriver
13744>>>>>>>>>>>        Boolean retVal
13744>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13745>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
13746>>>>>>>>>>>        Function_Return retVal
13747>>>>>>>>>>>    End_Function
13748>>>>>>>>>>>
13748>>>>>>>>>>>    Procedure ComEmptySection
13750>>>>>>>>>>>        Handle hDispatchDriver
13750>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13751>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
13752>>>>>>>>>>>    End_Procedure
13753>>>>>>>>>>>End_Class
13754>>>>>>>>>>>
13754>>>>>>>>>Use cCJTooltipContext.pkg   // cCJToolTipContext
Including file: cCJTooltipContext.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJTooltipContext.pkg)
13754>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13754>>>>>>>>>>>Use FlexCom20.pkg
13754>>>>>>>>>>>
13754>>>>>>>>>>>// ToolTip Style
13754>>>>>>>>>>>Define XTPToolTipStyle for Integer
13754>>>>>>>>>>>    Define xtpToolTipStandard for 0
13754>>>>>>>>>>>    Define xtpToolTipBalloon for 1
13754>>>>>>>>>>>    Define xtpToolTipOffice for 2
13754>>>>>>>>>>>    Define xtpToolTipRTF for 3
13754>>>>>>>>>>>    Define xtpToolTipLuna for 4
13754>>>>>>>>>>>    Define xtpToolTipResource for 5
13754>>>>>>>>>>>    Define xtpToolTipHTML for 6
13754>>>>>>>>>>>    Define xtpToolTipMarkup for 7
13754>>>>>>>>>>>    Define xtpToolTipOffice2013 for 8
13754>>>>>>>>>>>
13754>>>>>>>>>>>// ToolTip Icon
13754>>>>>>>>>>>Define XTPToolTipIcon for Integer
13754>>>>>>>>>>>    Define xtpToolTipIconNone for 0
13754>>>>>>>>>>>    Define xtpToolTipIconInfo for 1
13754>>>>>>>>>>>    Define xtpToolTipIconWarning for 2
13754>>>>>>>>>>>    Define xtpToolTipIconError for 3
13754>>>>>>>>>>>
13754>>>>>>>>>>>// CLSID: {ABBB9842-AE6D-46A8-BC77-CEE7D5CE9ED7}
13754>>>>>>>>>>>Class cCJIToolTipContext is a Mixin
13755>>>>>>>>>>>
13755>>>>>>>>>>>    Function ComStyle Returns XTPToolTipStyle
13757>>>>>>>>>>>        XTPToolTipStyle retVal
13757>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
13758>>>>>>>>>>>        Function_Return retVal
13759>>>>>>>>>>>    End_Function
13760>>>>>>>>>>>
13760>>>>>>>>>>>    Procedure Set ComStyle XTPToolTipStyle value
13762>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
13763>>>>>>>>>>>    End_Procedure
13764>>>>>>>>>>>
13764>>>>>>>>>>>    Function ComMaxTipWidth Returns Integer
13766>>>>>>>>>>>        Integer retVal
13766>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
13767>>>>>>>>>>>        Function_Return retVal
13768>>>>>>>>>>>    End_Function
13769>>>>>>>>>>>
13769>>>>>>>>>>>    Procedure Set ComMaxTipWidth Integer value
13771>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
13772>>>>>>>>>>>    End_Procedure
13773>>>>>>>>>>>
13773>>>>>>>>>>>    Function ComTipBkColor Returns OLE_COLOR
13775>>>>>>>>>>>        OLE_COLOR retVal
13775>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
13776>>>>>>>>>>>        Function_Return retVal
13777>>>>>>>>>>>    End_Function
13778>>>>>>>>>>>
13778>>>>>>>>>>>    Procedure Set ComTipBkColor OLE_COLOR value
13780>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
13781>>>>>>>>>>>    End_Procedure
13782>>>>>>>>>>>
13782>>>>>>>>>>>    Function ComTipTextColor Returns OLE_COLOR
13784>>>>>>>>>>>        OLE_COLOR retVal
13784>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
13785>>>>>>>>>>>        Function_Return retVal
13786>>>>>>>>>>>    End_Function
13787>>>>>>>>>>>
13787>>>>>>>>>>>    Procedure Set ComTipTextColor OLE_COLOR value
13789>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
13790>>>>>>>>>>>    End_Procedure
13791>>>>>>>>>>>
13791>>>>>>>>>>>    Function ComFont Returns Variant
13793>>>>>>>>>>>        Variant retVal
13793>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
13794>>>>>>>>>>>        Function_Return retVal
13795>>>>>>>>>>>    End_Function
13796>>>>>>>>>>>
13796>>>>>>>>>>>    Procedure Set ComFont Variant value
13798>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
13799>>>>>>>>>>>    End_Procedure
13800>>>>>>>>>>>
13800>>>>>>>>>>>    Function ComShowOfficeBorder Returns Boolean
13802>>>>>>>>>>>        Boolean retVal
13802>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
13803>>>>>>>>>>>        Function_Return retVal
13804>>>>>>>>>>>    End_Function
13805>>>>>>>>>>>
13805>>>>>>>>>>>    Procedure Set ComShowOfficeBorder Boolean value
13807>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
13808>>>>>>>>>>>    End_Procedure
13809>>>>>>>>>>>
13809>>>>>>>>>>>    Function ComShowShadow Returns Boolean
13811>>>>>>>>>>>        Boolean retVal
13811>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
13812>>>>>>>>>>>        Function_Return retVal
13813>>>>>>>>>>>    End_Function
13814>>>>>>>>>>>
13814>>>>>>>>>>>    Procedure Set ComShowShadow Boolean value
13816>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
13817>>>>>>>>>>>    End_Procedure
13818>>>>>>>>>>>
13818>>>>>>>>>>>    Procedure ComShowTitleAndDescription Boolean llShowTitleAndDescription XTPToolTipIcon llIconTitle
13820>>>>>>>>>>>        Handle hDispatchDriver
13820>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13821>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13822>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llShowTitleAndDescription
13823>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIconTitle
13824>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
13825>>>>>>>>>>>    End_Procedure
13826>>>>>>>>>>>
13826>>>>>>>>>>>    Function ComIsBalloonStyleSupported Returns Boolean
13828>>>>>>>>>>>        Handle hDispatchDriver
13828>>>>>>>>>>>        Boolean retVal
13828>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13829>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_BOOL to retVal
13830>>>>>>>>>>>        Function_Return retVal
13831>>>>>>>>>>>    End_Function
13832>>>>>>>>>>>
13832>>>>>>>>>>>    Procedure ComSetMargin Integer llLeft Integer llTop Integer llRight Integer llBottom
13834>>>>>>>>>>>        Handle hDispatchDriver
13834>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13835>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
13836>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llLeft
13837>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTop
13838>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRight
13839>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBottom
13840>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
13841>>>>>>>>>>>    End_Procedure
13842>>>>>>>>>>>
13842>>>>>>>>>>>    Procedure ComShowImage Boolean llShowImage Integer llImageBase
13844>>>>>>>>>>>        Handle hDispatchDriver
13844>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13845>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
13846>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llShowImage
13847>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llImageBase
13848>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
13849>>>>>>>>>>>    End_Procedure
13850>>>>>>>>>>>End_Class
13851>>>>>>>>>>>
13851>>>>>>>>>>>// CoClass
13851>>>>>>>>>>>// CLSID: {BDDDB4DB-8C00-4F05-AF87-9F05BCB55475}
13851>>>>>>>>>>>Class cCJToolTipContext is a cComAutomationObject
13852>>>>>>>>>>>    Import_Class_Protocol cCJIToolTipContext
13853>>>>>>>>>>>
13853>>>>>>>>>>>    Procedure Construct_Object
13855>>>>>>>>>>>        Forward Send Construct_Object
13857>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
13858>>>>>>>>>>>    End_Procedure
13859>>>>>>>>>>>End_Class
13860>>>>>>>>>>>
13860>>>>>>>>>>>
13860>>>>>>>>>Use cCJTabControlItem.pkg   // cCJTabManagerMargin, cCJTabManagerColorSet, cCJTabManager, cCJTabControlItem
Including file: cCJTabControlItem.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJTabControlItem.pkg)
13860>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
13860>>>>>>>>>>>Use FlexCom20.pkg
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabAppearanceStyle for Integer
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPage for 0
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPageSelected for 1
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPageFlat for 2
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPage2003 for 3
13860>>>>>>>>>>>    Define xtpTabAppearanceStateButtons for 4
13860>>>>>>>>>>>    Define xtpTabAppearanceFlat for 6
13860>>>>>>>>>>>    Define xtpTabThemeExcel2003 for 7
13860>>>>>>>>>>>    Define xtpTabAppearanceVisio for 8
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPage2007 for 10
13860>>>>>>>>>>>    Define xtpTabAppearancePropertyPageAccess2007 for 11
13860>>>>>>>>>>>    Define xtpTabThemeVisualStudio2003 for 5
13860>>>>>>>>>>>    Define xtpTabThemeVisualStudio2005 for 9
13860>>>>>>>>>>>    Define xtpTabThemeVisualStudio2010 for 12
13860>>>>>>>>>>>    Define xtpTabThemeVisualStudio2012 for 13
13860>>>>>>>>>>>    Define xtpTabThemeVisualStudio2015 for 15
13860>>>>>>>>>>>    Define xtpTabThemeOffice2013 for 14
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio for 5
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio2003 for 5
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio2005 for 9
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio2010 for 12
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio2012 for 13
13860>>>>>>>>>>>    Define xtpTabAppearanceVisualStudio2015 for 15
13860>>>>>>>>>>>    Define xtpTabAppearanceExcel for 7
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabColorStyle for Integer
13860>>>>>>>>>>>    Define xtpTabColorDefault for 1
13860>>>>>>>>>>>    Define xtpTabColorOffice2003 for 4
13860>>>>>>>>>>>    Define xtpTabColorWinNative for 8
13860>>>>>>>>>>>    Define xtpTabColorResource for 32
13860>>>>>>>>>>>    Define xtpTabColorOffice2007Access for 128
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2003 for 2
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2005 for 16
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2008 for 64
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2010 for 256
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2012 for 512
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2012Dark for 1024
13860>>>>>>>>>>>    Define xtpTabColorOffice2013 for 2048
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio2015 for 4096
13860>>>>>>>>>>>    Define xtpTabColorAll for 65535
13860>>>>>>>>>>>    Define xtpTabColorVisualStudio for 2
13860>>>>>>>>>>>    Define xtpTabColorWinXP for 8
13860>>>>>>>>>>>    Define xtpTabColorWhidbey for 16
13860>>>>>>>>>>>    Define xtpTabColorAccess2007 for 128
13860>>>>>>>>>>>    Define xtpTabColorOffice2007 for 32
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabOneNoteColor for Integer
13860>>>>>>>>>>>    Define xtpTabColorBlue for 16777216
13860>>>>>>>>>>>    Define xtpTabColorYellow for 16777217
13860>>>>>>>>>>>    Define xtpTabColorGreen for 16777218
13860>>>>>>>>>>>    Define xtpTabColorRed for 16777219
13860>>>>>>>>>>>    Define xtpTabColorPurple for 16777220
13860>>>>>>>>>>>    Define xtpTabColorCyan for 16777221
13860>>>>>>>>>>>    Define xtpTabColorOrange for 16777222
13860>>>>>>>>>>>    Define xtpTabColorMagenta for 16777223
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabPosition for Integer
13860>>>>>>>>>>>    Define xtpTabPositionTop for 0
13860>>>>>>>>>>>    Define xtpTabPositionLeft for 1
13860>>>>>>>>>>>    Define xtpTabPositionBottom for 2
13860>>>>>>>>>>>    Define xtpTabPositionRight for 3
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabLayoutStyle for Integer
13860>>>>>>>>>>>    Define xtpTabLayoutAutoSize for 0
13860>>>>>>>>>>>    Define xtpTabLayoutSizeToFit for 1
13860>>>>>>>>>>>    Define xtpTabLayoutFixed for 2
13860>>>>>>>>>>>    Define xtpTabLayoutCompressed for 3
13860>>>>>>>>>>>    Define xtpTabLayoutMultiRow for 4
13860>>>>>>>>>>>    Define xtpTabLayoutRotated for 5
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabClientFrame for Integer
13860>>>>>>>>>>>    Define xtpTabFrameBorder for 0
13860>>>>>>>>>>>    Define xtpTabFrameSingleLine for 1
13860>>>>>>>>>>>    Define xtpTabFrameNone for 2
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabToolTipBehaviour for Integer
13860>>>>>>>>>>>    Define xtpTabToolTipNever for 0
13860>>>>>>>>>>>    Define xtpTabToolTipAlways for 1
13860>>>>>>>>>>>    Define xtpTabToolTipShrinkedOnly for 2
13860>>>>>>>>>>>
13860>>>>>>>>>>>Define XTPTabDrawTextFormat for Integer
13860>>>>>>>>>>>    Define xtpTabDrawTextLeft for 0
13860>>>>>>>>>>>    Define xtpTabDrawTextCenter for 1
13860>>>>>>>>>>>    Define xtpTabDrawTextRight for 2
13860>>>>>>>>>>>    Define xtpTabDrawTextVCenter for 4
13860>>>>>>>>>>>
13860>>>>>>>>>>>// CLSID: {1935891D-B4E9-45C7-AAF6-EF340E785590}
13860>>>>>>>>>>>Class cCJITabManagerMargin is a Mixin
13861>>>>>>>>>>>
13861>>>>>>>>>>>    Function ComLeft Returns Integer
13863>>>>>>>>>>>        Integer retVal
13863>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
13864>>>>>>>>>>>        Function_Return retVal
13865>>>>>>>>>>>    End_Function
13866>>>>>>>>>>>
13866>>>>>>>>>>>    Procedure Set ComLeft Integer value
13868>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
13869>>>>>>>>>>>    End_Procedure
13870>>>>>>>>>>>
13870>>>>>>>>>>>    Function ComTop Returns Integer
13872>>>>>>>>>>>        Integer retVal
13872>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
13873>>>>>>>>>>>        Function_Return retVal
13874>>>>>>>>>>>    End_Function
13875>>>>>>>>>>>
13875>>>>>>>>>>>    Procedure Set ComTop Integer value
13877>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
13878>>>>>>>>>>>    End_Procedure
13879>>>>>>>>>>>
13879>>>>>>>>>>>    Function ComRight Returns Integer
13881>>>>>>>>>>>        Integer retVal
13881>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
13882>>>>>>>>>>>        Function_Return retVal
13883>>>>>>>>>>>    End_Function
13884>>>>>>>>>>>
13884>>>>>>>>>>>    Procedure Set ComRight Integer value
13886>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
13887>>>>>>>>>>>    End_Procedure
13888>>>>>>>>>>>
13888>>>>>>>>>>>    Function ComBottom Returns Integer
13890>>>>>>>>>>>        Integer retVal
13890>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
13891>>>>>>>>>>>        Function_Return retVal
13892>>>>>>>>>>>    End_Function
13893>>>>>>>>>>>
13893>>>>>>>>>>>    Procedure Set ComBottom Integer value
13895>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
13896>>>>>>>>>>>    End_Procedure
13897>>>>>>>>>>>
13897>>>>>>>>>>>    Procedure ComSetRect Integer llLeft Integer llTop Integer llRight Integer llBottom
13899>>>>>>>>>>>        Handle hDispatchDriver
13899>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
13900>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
13901>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llLeft
13902>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTop
13903>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRight
13904>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBottom
13905>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
13906>>>>>>>>>>>    End_Procedure
13907>>>>>>>>>>>End_Class
13908>>>>>>>>>>>
13908>>>>>>>>>>>// CoClass
13908>>>>>>>>>>>// CLSID: {E245C475-92F4-4AF7-9231-F158D1A035C3}
13908>>>>>>>>>>>Class cCJTabManagerMargin is a cComAutomationObject
13909>>>>>>>>>>>    Import_Class_Protocol cCJITabManagerMargin
13910>>>>>>>>>>>
13910>>>>>>>>>>>    Procedure Construct_Object
13912>>>>>>>>>>>        Forward Send Construct_Object
13914>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
13915>>>>>>>>>>>    End_Procedure
13916>>>>>>>>>>>End_Class
13917>>>>>>>>>>>
13917>>>>>>>>>>>// CLSID: {EEE5891D-B4E9-45C7-AAF6-EF340E785590}
13917>>>>>>>>>>>Class cCJITabPaintManagerColorSet is a Mixin
13918>>>>>>>>>>>
13918>>>>>>>>>>>    Function ComHeaderFaceLight Returns OLE_COLOR
13920>>>>>>>>>>>        OLE_COLOR retVal
13920>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
13921>>>>>>>>>>>        Function_Return retVal
13922>>>>>>>>>>>    End_Function
13923>>>>>>>>>>>
13923>>>>>>>>>>>    Procedure Set ComHeaderFaceLight OLE_COLOR value
13925>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
13926>>>>>>>>>>>    End_Procedure
13927>>>>>>>>>>>
13927>>>>>>>>>>>    Function ComHeaderFaceDark Returns OLE_COLOR
13929>>>>>>>>>>>        OLE_COLOR retVal
13929>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
13930>>>>>>>>>>>        Function_Return retVal
13931>>>>>>>>>>>    End_Function
13932>>>>>>>>>>>
13932>>>>>>>>>>>    Procedure Set ComHeaderFaceDark OLE_COLOR value
13934>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
13935>>>>>>>>>>>    End_Procedure
13936>>>>>>>>>>>
13936>>>>>>>>>>>    Function ComFrameBorder Returns OLE_COLOR
13938>>>>>>>>>>>        OLE_COLOR retVal
13938>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
13939>>>>>>>>>>>        Function_Return retVal
13940>>>>>>>>>>>    End_Function
13941>>>>>>>>>>>
13941>>>>>>>>>>>    Procedure Set ComFrameBorder OLE_COLOR value
13943>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
13944>>>>>>>>>>>    End_Procedure
13945>>>>>>>>>>>
13945>>>>>>>>>>>    Function ComControlFace Returns OLE_COLOR
13947>>>>>>>>>>>        OLE_COLOR retVal
13947>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
13948>>>>>>>>>>>        Function_Return retVal
13949>>>>>>>>>>>    End_Function
13950>>>>>>>>>>>
13950>>>>>>>>>>>    Procedure Set ComControlFace OLE_COLOR value
13952>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
13953>>>>>>>>>>>    End_Procedure
13954>>>>>>>>>>>
13954>>>>>>>>>>>    Function ComBorderHighlight Returns OLE_COLOR
13956>>>>>>>>>>>        OLE_COLOR retVal
13956>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
13957>>>>>>>>>>>        Function_Return retVal
13958>>>>>>>>>>>    End_Function
13959>>>>>>>>>>>
13959>>>>>>>>>>>    Procedure Set ComBorderHighlight OLE_COLOR value
13961>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
13962>>>>>>>>>>>    End_Procedure
13963>>>>>>>>>>>
13963>>>>>>>>>>>    Function ComButtonSelected Returns OLE_COLOR
13965>>>>>>>>>>>        OLE_COLOR retVal
13965>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
13966>>>>>>>>>>>        Function_Return retVal
13967>>>>>>>>>>>    End_Function
13968>>>>>>>>>>>
13968>>>>>>>>>>>    Procedure Set ComButtonSelected OLE_COLOR value
13970>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
13971>>>>>>>>>>>    End_Procedure
13972>>>>>>>>>>>
13972>>>>>>>>>>>    Function ComButtonNormal Returns OLE_COLOR
13974>>>>>>>>>>>        OLE_COLOR retVal
13974>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to retVal
13975>>>>>>>>>>>        Function_Return retVal
13976>>>>>>>>>>>    End_Function
13977>>>>>>>>>>>
13977>>>>>>>>>>>    Procedure Set ComButtonNormal OLE_COLOR value
13979>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to value
13980>>>>>>>>>>>    End_Procedure
13981>>>>>>>>>>>
13981>>>>>>>>>>>    Function ComNormalText Returns OLE_COLOR
13983>>>>>>>>>>>        OLE_COLOR retVal
13983>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to retVal
13984>>>>>>>>>>>        Function_Return retVal
13985>>>>>>>>>>>    End_Function
13986>>>>>>>>>>>
13986>>>>>>>>>>>    Procedure Set ComNormalText OLE_COLOR value
13988>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to value
13989>>>>>>>>>>>    End_Procedure
13990>>>>>>>>>>>
13990>>>>>>>>>>>    Function ComPressedText Returns OLE_COLOR
13992>>>>>>>>>>>        OLE_COLOR retVal
13992>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to retVal
13993>>>>>>>>>>>        Function_Return retVal
13994>>>>>>>>>>>    End_Function
13995>>>>>>>>>>>
13995>>>>>>>>>>>    Procedure Set ComPressedText OLE_COLOR value
13997>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to value
13998>>>>>>>>>>>    End_Procedure
13999>>>>>>>>>>>
13999>>>>>>>>>>>    Function ComSelectedText Returns OLE_COLOR
14001>>>>>>>>>>>        OLE_COLOR retVal
14001>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
14002>>>>>>>>>>>        Function_Return retVal
14003>>>>>>>>>>>    End_Function
14004>>>>>>>>>>>
14004>>>>>>>>>>>    Procedure Set ComSelectedText OLE_COLOR value
14006>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
14007>>>>>>>>>>>    End_Procedure
14008>>>>>>>>>>>
14008>>>>>>>>>>>    Function ComHighlightText Returns OLE_COLOR
14010>>>>>>>>>>>        OLE_COLOR retVal
14010>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_I4 to retVal
14011>>>>>>>>>>>        Function_Return retVal
14012>>>>>>>>>>>    End_Function
14013>>>>>>>>>>>
14013>>>>>>>>>>>    Procedure Set ComHighlightText OLE_COLOR value
14015>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_I4 to value
14016>>>>>>>>>>>    End_Procedure
14017>>>>>>>>>>>
14017>>>>>>>>>>>    Function ComDisabledText Returns OLE_COLOR
14019>>>>>>>>>>>        OLE_COLOR retVal
14019>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_I4 to retVal
14020>>>>>>>>>>>        Function_Return retVal
14021>>>>>>>>>>>    End_Function
14022>>>>>>>>>>>
14022>>>>>>>>>>>    Procedure Set ComDisabledText OLE_COLOR value
14024>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_I4 to value
14025>>>>>>>>>>>    End_Procedure
14026>>>>>>>>>>>
14026>>>>>>>>>>>    Function ComTabExcelSelectedLeftInnerBorder Returns OLE_COLOR
14028>>>>>>>>>>>        OLE_COLOR retVal
14028>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to retVal
14029>>>>>>>>>>>        Function_Return retVal
14030>>>>>>>>>>>    End_Function
14031>>>>>>>>>>>
14031>>>>>>>>>>>    Procedure Set ComTabExcelSelectedLeftInnerBorder OLE_COLOR value
14033>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to value
14034>>>>>>>>>>>    End_Procedure
14035>>>>>>>>>>>
14035>>>>>>>>>>>    Function ComTabExcelSelectedTopInnerBorder Returns OLE_COLOR
14037>>>>>>>>>>>        OLE_COLOR retVal
14037>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_I4 to retVal
14038>>>>>>>>>>>        Function_Return retVal
14039>>>>>>>>>>>    End_Function
14040>>>>>>>>>>>
14040>>>>>>>>>>>    Procedure Set ComTabExcelSelectedTopInnerBorder OLE_COLOR value
14042>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_I4 to value
14043>>>>>>>>>>>    End_Procedure
14044>>>>>>>>>>>
14044>>>>>>>>>>>    Function ComTabExcelSelectedRightInnerBorder Returns OLE_COLOR
14046>>>>>>>>>>>        OLE_COLOR retVal
14046>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
14047>>>>>>>>>>>        Function_Return retVal
14048>>>>>>>>>>>    End_Function
14049>>>>>>>>>>>
14049>>>>>>>>>>>    Procedure Set ComTabExcelSelectedRightInnerBorder OLE_COLOR value
14051>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
14052>>>>>>>>>>>    End_Procedure
14053>>>>>>>>>>>
14053>>>>>>>>>>>    Function ComTabExcelSelectedLeftOuterBorder Returns OLE_COLOR
14055>>>>>>>>>>>        OLE_COLOR retVal
14055>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_I4 to retVal
14056>>>>>>>>>>>        Function_Return retVal
14057>>>>>>>>>>>    End_Function
14058>>>>>>>>>>>
14058>>>>>>>>>>>    Procedure Set ComTabExcelSelectedLeftOuterBorder OLE_COLOR value
14060>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_I4 to value
14061>>>>>>>>>>>    End_Procedure
14062>>>>>>>>>>>
14062>>>>>>>>>>>    Function ComTabExcelSelectedRightOuterBorder Returns OLE_COLOR
14064>>>>>>>>>>>        OLE_COLOR retVal
14064>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_I4 to retVal
14065>>>>>>>>>>>        Function_Return retVal
14066>>>>>>>>>>>    End_Function
14067>>>>>>>>>>>
14067>>>>>>>>>>>    Procedure Set ComTabExcelSelectedRightOuterBorder OLE_COLOR value
14069>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_I4 to value
14070>>>>>>>>>>>    End_Procedure
14071>>>>>>>>>>>
14071>>>>>>>>>>>    Function ComTabExcelSelectedTopOuterBorder Returns OLE_COLOR
14073>>>>>>>>>>>        OLE_COLOR retVal
14073>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
14074>>>>>>>>>>>        Function_Return retVal
14075>>>>>>>>>>>    End_Function
14076>>>>>>>>>>>
14076>>>>>>>>>>>    Procedure Set ComTabExcelSelectedTopOuterBorder OLE_COLOR value
14078>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
14079>>>>>>>>>>>    End_Procedure
14080>>>>>>>>>>>
14080>>>>>>>>>>>    Function ComTabExcelNormalLeftInnerBorder Returns OLE_COLOR
14082>>>>>>>>>>>        OLE_COLOR retVal
14082>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_I4 to retVal
14083>>>>>>>>>>>        Function_Return retVal
14084>>>>>>>>>>>    End_Function
14085>>>>>>>>>>>
14085>>>>>>>>>>>    Procedure Set ComTabExcelNormalLeftInnerBorder OLE_COLOR value
14087>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_I4 to value
14088>>>>>>>>>>>    End_Procedure
14089>>>>>>>>>>>
14089>>>>>>>>>>>    Function ComTabExcelNormalTopInnerBorder Returns OLE_COLOR
14091>>>>>>>>>>>        OLE_COLOR retVal
14091>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_I4 to retVal
14092>>>>>>>>>>>        Function_Return retVal
14093>>>>>>>>>>>    End_Function
14094>>>>>>>>>>>
14094>>>>>>>>>>>    Procedure Set ComTabExcelNormalTopInnerBorder OLE_COLOR value
14096>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_I4 to value
14097>>>>>>>>>>>    End_Procedure
14098>>>>>>>>>>>
14098>>>>>>>>>>>    Function ComTabExcelNormalRightInnerBorder Returns OLE_COLOR
14100>>>>>>>>>>>        OLE_COLOR retVal
14100>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
14101>>>>>>>>>>>        Function_Return retVal
14102>>>>>>>>>>>    End_Function
14103>>>>>>>>>>>
14103>>>>>>>>>>>    Procedure Set ComTabExcelNormalRightInnerBorder OLE_COLOR value
14105>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
14106>>>>>>>>>>>    End_Procedure
14107>>>>>>>>>>>
14107>>>>>>>>>>>    Function ComTabExcelNormalLeftOuterBorder Returns OLE_COLOR
14109>>>>>>>>>>>        OLE_COLOR retVal
14109>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
14110>>>>>>>>>>>        Function_Return retVal
14111>>>>>>>>>>>    End_Function
14112>>>>>>>>>>>
14112>>>>>>>>>>>    Procedure Set ComTabExcelNormalLeftOuterBorder OLE_COLOR value
14114>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
14115>>>>>>>>>>>    End_Procedure
14116>>>>>>>>>>>
14116>>>>>>>>>>>    Function ComTabExcelNormalRightOuterBorder Returns OLE_COLOR
14118>>>>>>>>>>>        OLE_COLOR retVal
14118>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
14119>>>>>>>>>>>        Function_Return retVal
14120>>>>>>>>>>>    End_Function
14121>>>>>>>>>>>
14121>>>>>>>>>>>    Procedure Set ComTabExcelNormalRightOuterBorder OLE_COLOR value
14123>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
14124>>>>>>>>>>>    End_Procedure
14125>>>>>>>>>>>
14125>>>>>>>>>>>    Function ComTabExcelNormalTopOuterBorder Returns OLE_COLOR
14127>>>>>>>>>>>        OLE_COLOR retVal
14127>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to retVal
14128>>>>>>>>>>>        Function_Return retVal
14129>>>>>>>>>>>    End_Function
14130>>>>>>>>>>>
14130>>>>>>>>>>>    Procedure Set ComTabExcelNormalTopOuterBorder OLE_COLOR value
14132>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to value
14133>>>>>>>>>>>    End_Procedure
14134>>>>>>>>>>>
14134>>>>>>>>>>>    Function ComTabPropertyPageHighlight Returns OLE_COLOR
14136>>>>>>>>>>>        OLE_COLOR retVal
14136>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to retVal
14137>>>>>>>>>>>        Function_Return retVal
14138>>>>>>>>>>>    End_Function
14139>>>>>>>>>>>
14139>>>>>>>>>>>    Procedure Set ComTabPropertyPageHighlight OLE_COLOR value
14141>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to value
14142>>>>>>>>>>>    End_Procedure
14143>>>>>>>>>>>
14143>>>>>>>>>>>    Function ComTabPropertyPageShadow Returns OLE_COLOR
14145>>>>>>>>>>>        OLE_COLOR retVal
14145>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_I4 to retVal
14146>>>>>>>>>>>        Function_Return retVal
14147>>>>>>>>>>>    End_Function
14148>>>>>>>>>>>
14148>>>>>>>>>>>    Procedure Set ComTabPropertyPageShadow OLE_COLOR value
14150>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_I4 to value
14151>>>>>>>>>>>    End_Procedure
14152>>>>>>>>>>>
14152>>>>>>>>>>>    Function ComTabPropertyPageDarkShadow Returns OLE_COLOR
14154>>>>>>>>>>>        OLE_COLOR retVal
14154>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_I4 to retVal
14155>>>>>>>>>>>        Function_Return retVal
14156>>>>>>>>>>>    End_Function
14157>>>>>>>>>>>
14157>>>>>>>>>>>    Procedure Set ComTabPropertyPageDarkShadow OLE_COLOR value
14159>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_I4 to value
14160>>>>>>>>>>>    End_Procedure
14161>>>>>>>>>>>
14161>>>>>>>>>>>    Function ComTabPropertyPage2003DarkShadow Returns OLE_COLOR
14163>>>>>>>>>>>        OLE_COLOR retVal
14163>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
14164>>>>>>>>>>>        Function_Return retVal
14165>>>>>>>>>>>    End_Function
14166>>>>>>>>>>>
14166>>>>>>>>>>>    Procedure Set ComTabPropertyPage2003DarkShadow OLE_COLOR value
14168>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
14169>>>>>>>>>>>    End_Procedure
14170>>>>>>>>>>>
14170>>>>>>>>>>>    Function ComTabPropertyPage2003FrameBorder Returns OLE_COLOR
14172>>>>>>>>>>>        OLE_COLOR retVal
14172>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to retVal
14173>>>>>>>>>>>        Function_Return retVal
14174>>>>>>>>>>>    End_Function
14175>>>>>>>>>>>
14175>>>>>>>>>>>    Procedure Set ComTabPropertyPage2003FrameBorder OLE_COLOR value
14177>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to value
14178>>>>>>>>>>>    End_Procedure
14179>>>>>>>>>>>
14179>>>>>>>>>>>    Function ComTabPropertyPage2003BorderLeftHighlight Returns OLE_COLOR
14181>>>>>>>>>>>        OLE_COLOR retVal
14181>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
14182>>>>>>>>>>>        Function_Return retVal
14183>>>>>>>>>>>    End_Function
14184>>>>>>>>>>>
14184>>>>>>>>>>>    Procedure Set ComTabPropertyPage2003BorderLeftHighlight OLE_COLOR value
14186>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
14187>>>>>>>>>>>    End_Procedure
14188>>>>>>>>>>>
14188>>>>>>>>>>>    Function ComTabPropertyPage2003BorderTopHighlight Returns OLE_COLOR
14190>>>>>>>>>>>        OLE_COLOR retVal
14190>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
14191>>>>>>>>>>>        Function_Return retVal
14192>>>>>>>>>>>    End_Function
14193>>>>>>>>>>>
14193>>>>>>>>>>>    Procedure Set ComTabPropertyPage2003BorderTopHighlight OLE_COLOR value
14195>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
14196>>>>>>>>>>>    End_Procedure
14197>>>>>>>>>>>
14197>>>>>>>>>>>    Function ComTabStateButtonFaceLight Returns OLE_COLOR
14199>>>>>>>>>>>        OLE_COLOR retVal
14199>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
14200>>>>>>>>>>>        Function_Return retVal
14201>>>>>>>>>>>    End_Function
14202>>>>>>>>>>>
14202>>>>>>>>>>>    Procedure Set ComTabStateButtonFaceLight OLE_COLOR value
14204>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
14205>>>>>>>>>>>    End_Procedure
14206>>>>>>>>>>>
14206>>>>>>>>>>>    Function ComTabStateButtonFaceDark Returns OLE_COLOR
14208>>>>>>>>>>>        OLE_COLOR retVal
14208>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_I4 to retVal
14209>>>>>>>>>>>        Function_Return retVal
14210>>>>>>>>>>>    End_Function
14211>>>>>>>>>>>
14211>>>>>>>>>>>    Procedure Set ComTabStateButtonFaceDark OLE_COLOR value
14213>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_I4 to value
14214>>>>>>>>>>>    End_Procedure
14215>>>>>>>>>>>
14215>>>>>>>>>>>    Function ComTabStateButtonBorderTopLeft Returns OLE_COLOR
14217>>>>>>>>>>>        OLE_COLOR retVal
14217>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_I4 to retVal
14218>>>>>>>>>>>        Function_Return retVal
14219>>>>>>>>>>>    End_Function
14220>>>>>>>>>>>
14220>>>>>>>>>>>    Procedure Set ComTabStateButtonBorderTopLeft OLE_COLOR value
14222>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_I4 to value
14223>>>>>>>>>>>    End_Procedure
14224>>>>>>>>>>>
14224>>>>>>>>>>>    Function ComTabStateButtonBorderBottomRight Returns OLE_COLOR
14226>>>>>>>>>>>        OLE_COLOR retVal
14226>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 35 OLE_VT_I4 to retVal
14227>>>>>>>>>>>        Function_Return retVal
14228>>>>>>>>>>>    End_Function
14229>>>>>>>>>>>
14229>>>>>>>>>>>    Procedure Set ComTabStateButtonBorderBottomRight OLE_COLOR value
14231>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 35 OLE_VT_I4 to value
14232>>>>>>>>>>>    End_Procedure
14233>>>>>>>>>>>
14233>>>>>>>>>>>    Function ComPaneFace Returns OLE_COLOR
14235>>>>>>>>>>>        OLE_COLOR retVal
14235>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_I4 to retVal
14236>>>>>>>>>>>        Function_Return retVal
14237>>>>>>>>>>>    End_Function
14238>>>>>>>>>>>
14238>>>>>>>>>>>    Procedure Set ComPaneFace OLE_COLOR value
14240>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_I4 to value
14241>>>>>>>>>>>    End_Procedure
14242>>>>>>>>>>>
14242>>>>>>>>>>>    Function ComButtonHighlighted Returns OLE_COLOR
14244>>>>>>>>>>>        OLE_COLOR retVal
14244>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_I4 to retVal
14245>>>>>>>>>>>        Function_Return retVal
14246>>>>>>>>>>>    End_Function
14247>>>>>>>>>>>
14247>>>>>>>>>>>    Procedure Set ComButtonHighlighted OLE_COLOR value
14249>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_I4 to value
14250>>>>>>>>>>>    End_Procedure
14251>>>>>>>>>>>
14251>>>>>>>>>>>    Function ComPressedButton Returns OLE_COLOR
14253>>>>>>>>>>>        OLE_COLOR retVal
14253>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_I4 to retVal
14254>>>>>>>>>>>        Function_Return retVal
14255>>>>>>>>>>>    End_Function
14256>>>>>>>>>>>
14256>>>>>>>>>>>    Procedure Set ComPressedButton OLE_COLOR value
14258>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_I4 to value
14259>>>>>>>>>>>    End_Procedure
14260>>>>>>>>>>>
14260>>>>>>>>>>>    Function ComHighlightedCloseButton Returns OLE_COLOR
14262>>>>>>>>>>>        OLE_COLOR retVal
14262>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
14263>>>>>>>>>>>        Function_Return retVal
14264>>>>>>>>>>>    End_Function
14265>>>>>>>>>>>
14265>>>>>>>>>>>    Procedure Set ComHighlightedCloseButton OLE_COLOR value
14267>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
14268>>>>>>>>>>>    End_Procedure
14269>>>>>>>>>>>
14269>>>>>>>>>>>    Function ComSelectedPressedButton Returns OLE_COLOR
14271>>>>>>>>>>>        OLE_COLOR retVal
14271>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_I4 to retVal
14272>>>>>>>>>>>        Function_Return retVal
14273>>>>>>>>>>>    End_Function
14274>>>>>>>>>>>
14274>>>>>>>>>>>    Procedure Set ComSelectedPressedButton OLE_COLOR value
14276>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_I4 to value
14277>>>>>>>>>>>    End_Procedure
14278>>>>>>>>>>>
14278>>>>>>>>>>>    Function ComSelectedHighlightedButton Returns OLE_COLOR
14280>>>>>>>>>>>        OLE_COLOR retVal
14280>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 41 OLE_VT_I4 to retVal
14281>>>>>>>>>>>        Function_Return retVal
14282>>>>>>>>>>>    End_Function
14283>>>>>>>>>>>
14283>>>>>>>>>>>    Procedure Set ComSelectedHighlightedButton OLE_COLOR value
14285>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 41 OLE_VT_I4 to value
14286>>>>>>>>>>>    End_Procedure
14287>>>>>>>>>>>
14287>>>>>>>>>>>    Function ComButtonBorder Returns OLE_COLOR
14289>>>>>>>>>>>        OLE_COLOR retVal
14289>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 42 OLE_VT_I4 to retVal
14290>>>>>>>>>>>        Function_Return retVal
14291>>>>>>>>>>>    End_Function
14292>>>>>>>>>>>
14292>>>>>>>>>>>    Procedure Set ComButtonBorder OLE_COLOR value
14294>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 42 OLE_VT_I4 to value
14295>>>>>>>>>>>    End_Procedure
14296>>>>>>>>>>>
14296>>>>>>>>>>>    Function ComButtonBorderHot Returns OLE_COLOR
14298>>>>>>>>>>>        OLE_COLOR retVal
14298>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 43 OLE_VT_I4 to retVal
14299>>>>>>>>>>>        Function_Return retVal
14300>>>>>>>>>>>    End_Function
14301>>>>>>>>>>>
14301>>>>>>>>>>>    Procedure Set ComButtonBorderHot OLE_COLOR value
14303>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 43 OLE_VT_I4 to value
14304>>>>>>>>>>>    End_Procedure
14305>>>>>>>>>>>
14305>>>>>>>>>>>    Function ComHighlightCloseText Returns OLE_COLOR
14307>>>>>>>>>>>        OLE_COLOR retVal
14307>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 44 OLE_VT_I4 to retVal
14308>>>>>>>>>>>        Function_Return retVal
14309>>>>>>>>>>>    End_Function
14310>>>>>>>>>>>
14310>>>>>>>>>>>    Procedure Set ComHighlightCloseText OLE_COLOR value
14312>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 44 OLE_VT_I4 to value
14313>>>>>>>>>>>    End_Procedure
14314>>>>>>>>>>>
14314>>>>>>>>>>>    Function ComSelectedPressedText Returns OLE_COLOR
14316>>>>>>>>>>>        OLE_COLOR retVal
14316>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 45 OLE_VT_I4 to retVal
14317>>>>>>>>>>>        Function_Return retVal
14318>>>>>>>>>>>    End_Function
14319>>>>>>>>>>>
14319>>>>>>>>>>>    Procedure Set ComSelectedPressedText OLE_COLOR value
14321>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 45 OLE_VT_I4 to value
14322>>>>>>>>>>>    End_Procedure
14323>>>>>>>>>>>
14323>>>>>>>>>>>    Function ComSelectedHighlightedText Returns OLE_COLOR
14325>>>>>>>>>>>        OLE_COLOR retVal
14325>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_I4 to retVal
14326>>>>>>>>>>>        Function_Return retVal
14327>>>>>>>>>>>    End_Function
14328>>>>>>>>>>>
14328>>>>>>>>>>>    Procedure Set ComSelectedHighlightedText OLE_COLOR value
14330>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_I4 to value
14331>>>>>>>>>>>    End_Procedure
14332>>>>>>>>>>>
14332>>>>>>>>>>>    Function ComActiveFilesGlyph Returns OLE_COLOR
14334>>>>>>>>>>>        OLE_COLOR retVal
14334>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 47 OLE_VT_I4 to retVal
14335>>>>>>>>>>>        Function_Return retVal
14336>>>>>>>>>>>    End_Function
14337>>>>>>>>>>>
14337>>>>>>>>>>>    Procedure Set ComActiveFilesGlyph OLE_COLOR value
14339>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 47 OLE_VT_I4 to value
14340>>>>>>>>>>>    End_Procedure
14341>>>>>>>>>>>
14341>>>>>>>>>>>    Function ComActiveFilesGlyphHighlighted Returns OLE_COLOR
14343>>>>>>>>>>>        OLE_COLOR retVal
14343>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 48 OLE_VT_I4 to retVal
14344>>>>>>>>>>>        Function_Return retVal
14345>>>>>>>>>>>    End_Function
14346>>>>>>>>>>>
14346>>>>>>>>>>>    Procedure Set ComActiveFilesGlyphHighlighted OLE_COLOR value
14348>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 48 OLE_VT_I4 to value
14349>>>>>>>>>>>    End_Procedure
14350>>>>>>>>>>>
14350>>>>>>>>>>>    Function ComActiveFilesGlyphPressed Returns OLE_COLOR
14352>>>>>>>>>>>        OLE_COLOR retVal
14352>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 49 OLE_VT_I4 to retVal
14353>>>>>>>>>>>        Function_Return retVal
14354>>>>>>>>>>>    End_Function
14355>>>>>>>>>>>
14355>>>>>>>>>>>    Procedure Set ComActiveFilesGlyphPressed OLE_COLOR value
14357>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 49 OLE_VT_I4 to value
14358>>>>>>>>>>>    End_Procedure
14359>>>>>>>>>>>
14359>>>>>>>>>>>    Function ComActiveFilesBack Returns OLE_COLOR
14361>>>>>>>>>>>        OLE_COLOR retVal
14361>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to retVal
14362>>>>>>>>>>>        Function_Return retVal
14363>>>>>>>>>>>    End_Function
14364>>>>>>>>>>>
14364>>>>>>>>>>>    Procedure Set ComActiveFilesBack OLE_COLOR value
14366>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to value
14367>>>>>>>>>>>    End_Procedure
14368>>>>>>>>>>>
14368>>>>>>>>>>>    Function ComActiveFilesBackHighlighted Returns OLE_COLOR
14370>>>>>>>>>>>        OLE_COLOR retVal
14370>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_I4 to retVal
14371>>>>>>>>>>>        Function_Return retVal
14372>>>>>>>>>>>    End_Function
14373>>>>>>>>>>>
14373>>>>>>>>>>>    Procedure Set ComActiveFilesBackHighlighted OLE_COLOR value
14375>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_I4 to value
14376>>>>>>>>>>>    End_Procedure
14377>>>>>>>>>>>
14377>>>>>>>>>>>    Function ComActiveFilesBackPressed Returns OLE_COLOR
14379>>>>>>>>>>>        OLE_COLOR retVal
14379>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to retVal
14380>>>>>>>>>>>        Function_Return retVal
14381>>>>>>>>>>>    End_Function
14382>>>>>>>>>>>
14382>>>>>>>>>>>    Procedure Set ComActiveFilesBackPressed OLE_COLOR value
14384>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to value
14385>>>>>>>>>>>    End_Procedure
14386>>>>>>>>>>>End_Class
14387>>>>>>>>>>>
14387>>>>>>>>>>>// CoClass
14387>>>>>>>>>>>// CLSID: {EEE5C475-92F4-4AF7-9231-F158D1A035C3}
14387>>>>>>>>>>>Class cCJTabPaintManagerColorSet is a cComAutomationObject
14388>>>>>>>>>>>    Import_Class_Protocol cCJITabPaintManagerColorSet
14389>>>>>>>>>>>
14389>>>>>>>>>>>    Procedure Construct_Object
14391>>>>>>>>>>>        Forward Send Construct_Object
14393>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
14394>>>>>>>>>>>    End_Procedure
14395>>>>>>>>>>>End_Class
14396>>>>>>>>>>>
14396>>>>>>>>>>>// CLSID: {0EC716DE-9CE6-4D40-B6C5-3B9425FBB55A}
14396>>>>>>>>>>>Class cCJITabPaintManager is a Mixin
14397>>>>>>>>>>>
14397>>>>>>>>>>>    Function ComAppearance Returns XTPTabAppearanceStyle
14399>>>>>>>>>>>        XTPTabAppearanceStyle retVal
14399>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
14400>>>>>>>>>>>        Function_Return retVal
14401>>>>>>>>>>>    End_Function
14402>>>>>>>>>>>
14402>>>>>>>>>>>    Procedure Set ComAppearance XTPTabAppearanceStyle value
14404>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
14405>>>>>>>>>>>    End_Procedure
14406>>>>>>>>>>>
14406>>>>>>>>>>>    Function ComColor Returns XTPTabColorStyle
14408>>>>>>>>>>>        XTPTabColorStyle retVal
14408>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
14409>>>>>>>>>>>        Function_Return retVal
14410>>>>>>>>>>>    End_Function
14411>>>>>>>>>>>
14411>>>>>>>>>>>    Procedure Set ComColor XTPTabColorStyle value
14413>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
14414>>>>>>>>>>>    End_Procedure
14415>>>>>>>>>>>
14415>>>>>>>>>>>    Function ComLayout Returns XTPTabLayoutStyle
14417>>>>>>>>>>>        XTPTabLayoutStyle retVal
14417>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
14418>>>>>>>>>>>        Function_Return retVal
14419>>>>>>>>>>>    End_Function
14420>>>>>>>>>>>
14420>>>>>>>>>>>    Procedure Set ComLayout XTPTabLayoutStyle value
14422>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
14423>>>>>>>>>>>    End_Procedure
14424>>>>>>>>>>>
14424>>>>>>>>>>>    Function ComPosition Returns XTPTabPosition
14426>>>>>>>>>>>        XTPTabPosition retVal
14426>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
14427>>>>>>>>>>>        Function_Return retVal
14428>>>>>>>>>>>    End_Function
14429>>>>>>>>>>>
14429>>>>>>>>>>>    Procedure Set ComPosition XTPTabPosition value
14431>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
14432>>>>>>>>>>>    End_Procedure
14433>>>>>>>>>>>
14433>>>>>>>>>>>    Function ComBoldSelected Returns Boolean
14435>>>>>>>>>>>        Boolean retVal
14435>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
14436>>>>>>>>>>>        Function_Return retVal
14437>>>>>>>>>>>    End_Function
14438>>>>>>>>>>>
14438>>>>>>>>>>>    Procedure Set ComBoldSelected Boolean value
14440>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
14441>>>>>>>>>>>    End_Procedure
14442>>>>>>>>>>>
14442>>>>>>>>>>>    Function ComHotTracking Returns Boolean
14444>>>>>>>>>>>        Boolean retVal
14444>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
14445>>>>>>>>>>>        Function_Return retVal
14446>>>>>>>>>>>    End_Function
14447>>>>>>>>>>>
14447>>>>>>>>>>>    Procedure Set ComHotTracking Boolean value
14449>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
14450>>>>>>>>>>>    End_Procedure
14451>>>>>>>>>>>
14451>>>>>>>>>>>    Function ComShowIcons Returns Boolean
14453>>>>>>>>>>>        Boolean retVal
14453>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
14454>>>>>>>>>>>        Function_Return retVal
14455>>>>>>>>>>>    End_Function
14456>>>>>>>>>>>
14456>>>>>>>>>>>    Procedure Set ComShowIcons Boolean value
14458>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
14459>>>>>>>>>>>    End_Procedure
14460>>>>>>>>>>>
14460>>>>>>>>>>>    Function ComDisableLunaColors Returns Boolean
14462>>>>>>>>>>>        Boolean retVal
14462>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
14463>>>>>>>>>>>        Function_Return retVal
14464>>>>>>>>>>>    End_Function
14465>>>>>>>>>>>
14465>>>>>>>>>>>    Procedure Set ComDisableLunaColors Boolean value
14467>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
14468>>>>>>>>>>>    End_Procedure
14469>>>>>>>>>>>
14469>>>>>>>>>>>    Function ComOneNoteColors Returns Boolean
14471>>>>>>>>>>>        Boolean retVal
14471>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
14472>>>>>>>>>>>        Function_Return retVal
14473>>>>>>>>>>>    End_Function
14474>>>>>>>>>>>
14474>>>>>>>>>>>    Procedure Set ComOneNoteColors Boolean value
14476>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
14477>>>>>>>>>>>    End_Procedure
14478>>>>>>>>>>>
14478>>>>>>>>>>>    Function ComClientFrame Returns XTPTabClientFrame
14480>>>>>>>>>>>        XTPTabClientFrame retVal
14480>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_I4 to retVal
14481>>>>>>>>>>>        Function_Return retVal
14482>>>>>>>>>>>    End_Function
14483>>>>>>>>>>>
14483>>>>>>>>>>>    Procedure Set ComClientFrame XTPTabClientFrame value
14485>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_I4 to value
14486>>>>>>>>>>>    End_Procedure
14487>>>>>>>>>>>
14487>>>>>>>>>>>    Function ComStaticFrame Returns Boolean
14489>>>>>>>>>>>        Boolean retVal
14489>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
14490>>>>>>>>>>>        Function_Return retVal
14491>>>>>>>>>>>    End_Function
14492>>>>>>>>>>>
14492>>>>>>>>>>>    Procedure Set ComStaticFrame Boolean value
14494>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
14495>>>>>>>>>>>    End_Procedure
14496>>>>>>>>>>>
14496>>>>>>>>>>>    Function ComDrawTextPathEllipsis Returns Boolean
14498>>>>>>>>>>>        Boolean retVal
14498>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
14499>>>>>>>>>>>        Function_Return retVal
14500>>>>>>>>>>>    End_Function
14501>>>>>>>>>>>
14501>>>>>>>>>>>    Procedure Set ComDrawTextPathEllipsis Boolean value
14503>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
14504>>>>>>>>>>>    End_Procedure
14505>>>>>>>>>>>
14505>>>>>>>>>>>    Function ComDrawTextNoPrefix Returns Boolean
14507>>>>>>>>>>>        Boolean retVal
14507>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
14508>>>>>>>>>>>        Function_Return retVal
14509>>>>>>>>>>>    End_Function
14510>>>>>>>>>>>
14510>>>>>>>>>>>    Procedure Set ComDrawTextNoPrefix Boolean value
14512>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
14513>>>>>>>>>>>    End_Procedure
14514>>>>>>>>>>>
14514>>>>>>>>>>>    Function ComFont Returns Variant
14516>>>>>>>>>>>        Variant retVal
14516>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
14517>>>>>>>>>>>        Function_Return retVal
14518>>>>>>>>>>>    End_Function
14519>>>>>>>>>>>
14519>>>>>>>>>>>    Procedure Set ComFont Variant value
14521>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
14522>>>>>>>>>>>    End_Procedure
14523>>>>>>>>>>>
14523>>>>>>>>>>>    Function ComMultiRowFixedSelection Returns Boolean
14525>>>>>>>>>>>        Boolean retVal
14525>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
14526>>>>>>>>>>>        Function_Return retVal
14527>>>>>>>>>>>    End_Function
14528>>>>>>>>>>>
14528>>>>>>>>>>>    Procedure Set ComMultiRowFixedSelection Boolean value
14530>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
14531>>>>>>>>>>>    End_Procedure
14532>>>>>>>>>>>
14532>>>>>>>>>>>    Function ComMultiRowJustified Returns Boolean
14534>>>>>>>>>>>        Boolean retVal
14534>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_BOOL to retVal
14535>>>>>>>>>>>        Function_Return retVal
14536>>>>>>>>>>>    End_Function
14537>>>>>>>>>>>
14537>>>>>>>>>>>    Procedure Set ComMultiRowJustified Boolean value
14539>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_BOOL to value
14540>>>>>>>>>>>    End_Procedure
14541>>>>>>>>>>>
14541>>>>>>>>>>>    Function ComToolTipBehaviour Returns XTPTabToolTipBehaviour
14543>>>>>>>>>>>        XTPTabToolTipBehaviour retVal
14543>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
14544>>>>>>>>>>>        Function_Return retVal
14545>>>>>>>>>>>    End_Function
14546>>>>>>>>>>>
14546>>>>>>>>>>>    Procedure Set ComToolTipBehaviour XTPTabToolTipBehaviour value
14548>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
14549>>>>>>>>>>>    End_Procedure
14550>>>>>>>>>>>
14550>>>>>>>>>>>    Function ComSelectTabOnDragOver Returns Integer
14552>>>>>>>>>>>        Integer retVal
14552>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to retVal
14553>>>>>>>>>>>        Function_Return retVal
14554>>>>>>>>>>>    End_Function
14555>>>>>>>>>>>
14555>>>>>>>>>>>    Procedure Set ComSelectTabOnDragOver Integer value
14557>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to value
14558>>>>>>>>>>>    End_Procedure
14559>>>>>>>>>>>
14559>>>>>>>>>>>    Function ComFillBackground Returns Boolean
14561>>>>>>>>>>>        Boolean retVal
14561>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_BOOL to retVal
14562>>>>>>>>>>>        Function_Return retVal
14563>>>>>>>>>>>    End_Function
14564>>>>>>>>>>>
14564>>>>>>>>>>>    Procedure Set ComFillBackground Boolean value
14566>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_BOOL to value
14567>>>>>>>>>>>    End_Procedure
14568>>>>>>>>>>>
14568>>>>>>>>>>>    Function ComRotateImageOnVerticalDraw Returns Boolean
14570>>>>>>>>>>>        Boolean retVal
14570>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
14571>>>>>>>>>>>        Function_Return retVal
14572>>>>>>>>>>>    End_Function
14573>>>>>>>>>>>
14573>>>>>>>>>>>    Procedure Set ComRotateImageOnVerticalDraw Boolean value
14575>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
14576>>>>>>>>>>>    End_Procedure
14577>>>>>>>>>>>
14577>>>>>>>>>>>    Function ComFixedTabWidth Returns Integer
14579>>>>>>>>>>>        Integer retVal
14579>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_I4 to retVal
14580>>>>>>>>>>>        Function_Return retVal
14581>>>>>>>>>>>    End_Function
14582>>>>>>>>>>>
14582>>>>>>>>>>>    Procedure Set ComFixedTabWidth Integer value
14584>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_I4 to value
14585>>>>>>>>>>>    End_Procedure
14586>>>>>>>>>>>
14586>>>>>>>>>>>    Function ComMinTabWidth Returns Integer
14588>>>>>>>>>>>        Integer retVal
14588>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
14589>>>>>>>>>>>        Function_Return retVal
14590>>>>>>>>>>>    End_Function
14591>>>>>>>>>>>
14591>>>>>>>>>>>    Procedure Set ComMinTabWidth Integer value
14593>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
14594>>>>>>>>>>>    End_Procedure
14595>>>>>>>>>>>
14595>>>>>>>>>>>    Function ComMaxTabWidth Returns Integer
14597>>>>>>>>>>>        Integer retVal
14597>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to retVal
14598>>>>>>>>>>>        Function_Return retVal
14599>>>>>>>>>>>    End_Function
14600>>>>>>>>>>>
14600>>>>>>>>>>>    Procedure Set ComMaxTabWidth Integer value
14602>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to value
14603>>>>>>>>>>>    End_Procedure
14604>>>>>>>>>>>
14604>>>>>>>>>>>    Function ComDrawTextFormat Returns XTPTabDrawTextFormat
14606>>>>>>>>>>>        XTPTabDrawTextFormat retVal
14606>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
14607>>>>>>>>>>>        Function_Return retVal
14608>>>>>>>>>>>    End_Function
14609>>>>>>>>>>>
14609>>>>>>>>>>>    Procedure Set ComDrawTextFormat XTPTabDrawTextFormat value
14611>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
14612>>>>>>>>>>>    End_Procedure
14613>>>>>>>>>>>
14613>>>>>>>>>>>    Function ComShowTabs Returns Boolean
14615>>>>>>>>>>>        Boolean retVal
14615>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to retVal
14616>>>>>>>>>>>        Function_Return retVal
14617>>>>>>>>>>>    End_Function
14618>>>>>>>>>>>
14618>>>>>>>>>>>    Procedure Set ComShowTabs Boolean value
14620>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to value
14621>>>>>>>>>>>    End_Procedure
14622>>>>>>>>>>>
14622>>>>>>>>>>>    Function ComClearTypeTextQuality Returns Boolean
14624>>>>>>>>>>>        Boolean retVal
14624>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_BOOL to retVal
14625>>>>>>>>>>>        Function_Return retVal
14626>>>>>>>>>>>    End_Function
14627>>>>>>>>>>>
14627>>>>>>>>>>>    Procedure Set ComClearTypeTextQuality Boolean value
14629>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_BOOL to value
14630>>>>>>>>>>>    End_Procedure
14631>>>>>>>>>>>
14631>>>>>>>>>>>    Function ComVerticalTextTopToBottom Returns Boolean
14633>>>>>>>>>>>        Boolean retVal
14633>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to retVal
14634>>>>>>>>>>>        Function_Return retVal
14635>>>>>>>>>>>    End_Function
14636>>>>>>>>>>>
14636>>>>>>>>>>>    Procedure Set ComVerticalTextTopToBottom Boolean value
14638>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to value
14639>>>>>>>>>>>    End_Procedure
14640>>>>>>>>>>>
14640>>>>>>>>>>>    Function ComMultiRowTabsOptimization Returns Boolean
14642>>>>>>>>>>>        Boolean retVal
14642>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_BOOL to retVal
14643>>>>>>>>>>>        Function_Return retVal
14644>>>>>>>>>>>    End_Function
14645>>>>>>>>>>>
14645>>>>>>>>>>>    Procedure Set ComMultiRowTabsOptimization Boolean value
14647>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_BOOL to value
14648>>>>>>>>>>>    End_Procedure
14649>>>>>>>>>>>
14649>>>>>>>>>>>    Function ComIsColorSupported XTPTabColorStyle llColor Returns Boolean
14651>>>>>>>>>>>        Handle hDispatchDriver
14651>>>>>>>>>>>        Boolean retVal
14651>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14652>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14653>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
14654>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_BOOL to retVal
14655>>>>>>>>>>>        Function_Return retVal
14656>>>>>>>>>>>    End_Function
14657>>>>>>>>>>>
14657>>>>>>>>>>>    Function ComClientMargin Returns Variant
14659>>>>>>>>>>>        Handle hDispatchDriver
14659>>>>>>>>>>>        Variant retVal
14659>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14660>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_DISPATCH to retVal
14661>>>>>>>>>>>        Function_Return retVal
14662>>>>>>>>>>>    End_Function
14663>>>>>>>>>>>
14663>>>>>>>>>>>    Function ComControlMargin Returns Variant
14665>>>>>>>>>>>        Handle hDispatchDriver
14665>>>>>>>>>>>        Variant retVal
14665>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14666>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_DISPATCH to retVal
14667>>>>>>>>>>>        Function_Return retVal
14668>>>>>>>>>>>    End_Function
14669>>>>>>>>>>>
14669>>>>>>>>>>>    Function ComHeaderMargin Returns Variant
14671>>>>>>>>>>>        Handle hDispatchDriver
14671>>>>>>>>>>>        Variant retVal
14671>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14672>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 15 OLE_VT_DISPATCH to retVal
14673>>>>>>>>>>>        Function_Return retVal
14674>>>>>>>>>>>    End_Function
14675>>>>>>>>>>>
14675>>>>>>>>>>>    Function ComButtonMargin Returns Variant
14677>>>>>>>>>>>        Handle hDispatchDriver
14677>>>>>>>>>>>        Variant retVal
14677>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14678>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
14679>>>>>>>>>>>        Function_Return retVal
14680>>>>>>>>>>>    End_Function
14681>>>>>>>>>>>
14681>>>>>>>>>>>    Function ComColorSet Returns Variant
14683>>>>>>>>>>>        Handle hDispatchDriver
14683>>>>>>>>>>>        Variant retVal
14683>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14684>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 19 OLE_VT_DISPATCH to retVal
14685>>>>>>>>>>>        Function_Return retVal
14686>>>>>>>>>>>    End_Function
14687>>>>>>>>>>>
14687>>>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
14689>>>>>>>>>>>        Handle hDispatchDriver
14689>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14690>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
14691>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
14692>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
14693>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 20 OLE_VT_VOID
14694>>>>>>>>>>>    End_Procedure
14695>>>>>>>>>>>End_Class
14696>>>>>>>>>>>
14696>>>>>>>>>>>// CoClass
14696>>>>>>>>>>>// CLSID: {79EB54C2-BDD4-4257-8CF4-A2AB1674C51E}
14696>>>>>>>>>>>Class cCJTabPaintManager is a cComAutomationObject
14697>>>>>>>>>>>    Import_Class_Protocol cCJITabPaintManager
14698>>>>>>>>>>>
14698>>>>>>>>>>>    Procedure Construct_Object
14700>>>>>>>>>>>        Forward Send Construct_Object
14702>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
14703>>>>>>>>>>>    End_Procedure
14704>>>>>>>>>>>End_Class
14705>>>>>>>>>>>
14705>>>>>>>>>>>// CLSID: {CCC528A8-9479-48D5-A14D-077A9FD5D276}
14705>>>>>>>>>>>Class cCJITabControlItem is a Mixin
14706>>>>>>>>>>>
14706>>>>>>>>>>>    Function ComCaption Returns String
14708>>>>>>>>>>>        String retVal
14708>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
14709>>>>>>>>>>>        Function_Return retVal
14710>>>>>>>>>>>    End_Function
14711>>>>>>>>>>>
14711>>>>>>>>>>>    Procedure Set ComCaption String value
14713>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
14714>>>>>>>>>>>    End_Procedure
14715>>>>>>>>>>>
14715>>>>>>>>>>>    Function ComTag Returns Variant
14717>>>>>>>>>>>        Variant retVal
14717>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_VARIANT to retVal
14718>>>>>>>>>>>        Function_Return retVal
14719>>>>>>>>>>>    End_Function
14720>>>>>>>>>>>
14720>>>>>>>>>>>    Procedure Set ComTag Variant value
14722>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_VARIANT to value
14723>>>>>>>>>>>    End_Procedure
14724>>>>>>>>>>>
14724>>>>>>>>>>>    Function ComSelected Returns Boolean
14726>>>>>>>>>>>        Boolean retVal
14726>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
14727>>>>>>>>>>>        Function_Return retVal
14728>>>>>>>>>>>    End_Function
14729>>>>>>>>>>>
14729>>>>>>>>>>>    Procedure Set ComSelected Boolean value
14731>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
14732>>>>>>>>>>>    End_Procedure
14733>>>>>>>>>>>
14733>>>>>>>>>>>    Function ComImage Returns Integer
14735>>>>>>>>>>>        Integer retVal
14735>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
14736>>>>>>>>>>>        Function_Return retVal
14737>>>>>>>>>>>    End_Function
14738>>>>>>>>>>>
14738>>>>>>>>>>>    Procedure Set ComImage Integer value
14740>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
14741>>>>>>>>>>>    End_Procedure
14742>>>>>>>>>>>
14742>>>>>>>>>>>    Function ComColor Returns OLE_COLOR
14744>>>>>>>>>>>        OLE_COLOR retVal
14744>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
14745>>>>>>>>>>>        Function_Return retVal
14746>>>>>>>>>>>    End_Function
14747>>>>>>>>>>>
14747>>>>>>>>>>>    Procedure Set ComColor OLE_COLOR value
14749>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
14750>>>>>>>>>>>    End_Procedure
14751>>>>>>>>>>>
14751>>>>>>>>>>>    Function ComVisible Returns Boolean
14753>>>>>>>>>>>        Boolean retVal
14753>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
14754>>>>>>>>>>>        Function_Return retVal
14755>>>>>>>>>>>    End_Function
14756>>>>>>>>>>>
14756>>>>>>>>>>>    Procedure Set ComVisible Boolean value
14758>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
14759>>>>>>>>>>>    End_Procedure
14760>>>>>>>>>>>
14760>>>>>>>>>>>    Function ComEnabled Returns Boolean
14762>>>>>>>>>>>        Boolean retVal
14762>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
14763>>>>>>>>>>>        Function_Return retVal
14764>>>>>>>>>>>    End_Function
14765>>>>>>>>>>>
14765>>>>>>>>>>>    Procedure Set ComEnabled Boolean value
14767>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
14768>>>>>>>>>>>    End_Procedure
14769>>>>>>>>>>>
14769>>>>>>>>>>>    Function ComToolTip Returns String
14771>>>>>>>>>>>        String retVal
14771>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
14772>>>>>>>>>>>        Function_Return retVal
14773>>>>>>>>>>>    End_Function
14774>>>>>>>>>>>
14774>>>>>>>>>>>    Procedure Set ComToolTip String value
14776>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
14777>>>>>>>>>>>    End_Procedure
14778>>>>>>>>>>>
14778>>>>>>>>>>>    Function ComClosable Returns Boolean
14780>>>>>>>>>>>        Boolean retVal
14780>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
14781>>>>>>>>>>>        Function_Return retVal
14782>>>>>>>>>>>    End_Function
14783>>>>>>>>>>>
14783>>>>>>>>>>>    Procedure Set ComClosable Boolean value
14785>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
14786>>>>>>>>>>>    End_Procedure
14787>>>>>>>>>>>
14787>>>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
14789>>>>>>>>>>>        OLE_HANDLE retVal
14789>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to retVal
14790>>>>>>>>>>>        Function_Return retVal
14791>>>>>>>>>>>    End_Function
14792>>>>>>>>>>>
14792>>>>>>>>>>>    Procedure Set ComHandle OLE_HANDLE value
14794>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to value
14795>>>>>>>>>>>    End_Procedure
14796>>>>>>>>>>>
14796>>>>>>>>>>>    Function ComIndex Returns Integer
14798>>>>>>>>>>>        Handle hDispatchDriver
14798>>>>>>>>>>>        Integer retVal
14798>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14799>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_I4 to retVal
14800>>>>>>>>>>>        Function_Return retVal
14801>>>>>>>>>>>    End_Function
14802>>>>>>>>>>>
14802>>>>>>>>>>>    Procedure ComMove Integer llIndex
14804>>>>>>>>>>>        Handle hDispatchDriver
14804>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14805>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14806>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
14807>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
14808>>>>>>>>>>>    End_Procedure
14809>>>>>>>>>>>
14809>>>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
14811>>>>>>>>>>>        Handle hDispatchDriver
14811>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14812>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
14813>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
14814>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
14815>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
14816>>>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
14817>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
14818>>>>>>>>>>>    End_Procedure
14819>>>>>>>>>>>
14819>>>>>>>>>>>    Procedure ComEnsureVisible
14821>>>>>>>>>>>        Handle hDispatchDriver
14821>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14822>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
14823>>>>>>>>>>>    End_Procedure
14824>>>>>>>>>>>End_Class
14825>>>>>>>>>>>
14825>>>>>>>>>>>// CoClass
14825>>>>>>>>>>>// CLSID: {1DC3FB95-9808-4CBF-BAC2-F2455C8C8A46}
14825>>>>>>>>>>>Class cCJComTabControlItem is a cComAutomationObject
14826>>>>>>>>>>>    Import_Class_Protocol cCJITabControlItem
14827>>>>>>>>>>>
14827>>>>>>>>>>>    Procedure Construct_Object
14829>>>>>>>>>>>        Forward Send Construct_Object
14831>>>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
14832>>>>>>>>>>>    End_Procedure
14833>>>>>>>>>>>End_Class
14834>>>>>>>>>>>
14834>>>>>>>>>>>
14834>>>>>>>>>Use cCJDataObject.pkg       // cCJDataObjectFile, cCJDataObject
Including file: cCJDataObject.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJDataObject.pkg)
14834>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
14834>>>>>>>>>>>Use FlexCom20.pkg
14834>>>>>>>>>>>
14834>>>>>>>>>>>// CLSID: {1CC3A51E-D748-410E-BCA7-B76271CAD4AC}
14834>>>>>>>>>>>Class cCJDataObjectFiles is a cComAutomationObject
14835>>>>>>>>>>>
14835>>>>>>>>>>>    Function ComItem Integer llIndex Returns String
14837>>>>>>>>>>>        Handle hDispatchDriver
14837>>>>>>>>>>>        String retVal
14837>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14838>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14839>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
14840>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_BSTR to retVal
14841>>>>>>>>>>>        Function_Return retVal
14842>>>>>>>>>>>    End_Function
14843>>>>>>>>>>>
14843>>>>>>>>>>>    Function ComCount Returns Integer
14845>>>>>>>>>>>        Handle hDispatchDriver
14845>>>>>>>>>>>        Integer retVal
14845>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14846>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
14847>>>>>>>>>>>        Function_Return retVal
14848>>>>>>>>>>>    End_Function
14849>>>>>>>>>>>
14849>>>>>>>>>>>    Function Com_NewEnum Returns Variant
14851>>>>>>>>>>>        Handle hDispatchDriver
14851>>>>>>>>>>>        Variant retVal
14851>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14852>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
14853>>>>>>>>>>>        Function_Return retVal
14854>>>>>>>>>>>    End_Function
14855>>>>>>>>>>>End_Class
14856>>>>>>>>>>>
14856>>>>>>>>>>>// CLSID: {20700C3A-C098-4EE7-AAF2-790BA08F3AD2}
14856>>>>>>>>>>>Class cCJDataObject is a cComAutomationObject
14857>>>>>>>>>>>
14857>>>>>>>>>>>    Function ComGetFormat Integer llFormat Returns Boolean
14859>>>>>>>>>>>        Handle hDispatchDriver
14859>>>>>>>>>>>        Boolean retVal
14859>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14860>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14861>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llFormat
14862>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BOOL to retVal
14863>>>>>>>>>>>        Function_Return retVal
14864>>>>>>>>>>>    End_Function
14865>>>>>>>>>>>
14865>>>>>>>>>>>    Function ComFiles Returns Variant
14867>>>>>>>>>>>        Handle hDispatchDriver
14867>>>>>>>>>>>        Variant retVal
14867>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14868>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
14869>>>>>>>>>>>        Function_Return retVal
14870>>>>>>>>>>>    End_Function
14871>>>>>>>>>>>
14871>>>>>>>>>>>    Function ComGetData Integer llFormat Returns Variant
14873>>>>>>>>>>>        Handle hDispatchDriver
14873>>>>>>>>>>>        Variant retVal
14873>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14874>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14875>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llFormat
14876>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_VARIANT to retVal
14877>>>>>>>>>>>        Function_Return retVal
14878>>>>>>>>>>>    End_Function
14879>>>>>>>>>>>
14879>>>>>>>>>>>    Procedure ComSetData Variant llvValue Variant llFormat
14881>>>>>>>>>>>        Handle hDispatchDriver
14881>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14882>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
14883>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llvValue
14884>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFormat
14885>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
14886>>>>>>>>>>>    End_Procedure
14887>>>>>>>>>>>
14887>>>>>>>>>>>    Procedure ComClear
14889>>>>>>>>>>>        Handle hDispatchDriver
14889>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14890>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
14891>>>>>>>>>>>    End_Procedure
14892>>>>>>>>>>>End_Class
14893>>>>>>>>>>>
14893>>>>>>>>>Use cCJResourceImages.pkg   // cCJResourceImages
Including file: cCJResourceImages.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJResourceImages.pkg)
14893>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
14893>>>>>>>>>>>Use FlexCom20.pkg
14893>>>>>>>>>>>
14893>>>>>>>>>>>// CLSID: {9BCA0CBE-DE43-4B56-BCEB-E14B825CF245}
14893>>>>>>>>>>>Class cCJResourceImages is a cComAutomationObject
14894>>>>>>>>>>>
14894>>>>>>>>>>>    Function ComLoadFromFile String llDllFileName String llIniFileName Returns Boolean
14896>>>>>>>>>>>        Handle hDispatchDriver
14896>>>>>>>>>>>        Boolean retVal
14896>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14897>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
14898>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llDllFileName
14899>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llIniFileName
14900>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_BOOL to retVal
14901>>>>>>>>>>>        Function_Return retVal
14902>>>>>>>>>>>    End_Function
14903>>>>>>>>>>>
14903>>>>>>>>>>>    Function ComDllFileName Returns String
14905>>>>>>>>>>>        Handle hDispatchDriver
14905>>>>>>>>>>>        String retVal
14905>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14906>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BSTR to retVal
14907>>>>>>>>>>>        Function_Return retVal
14908>>>>>>>>>>>    End_Function
14909>>>>>>>>>>>
14909>>>>>>>>>>>    Function ComIniFileName Returns String
14911>>>>>>>>>>>        Handle hDispatchDriver
14911>>>>>>>>>>>        String retVal
14911>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14912>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BSTR to retVal
14913>>>>>>>>>>>        Function_Return retVal
14914>>>>>>>>>>>    End_Function
14915>>>>>>>>>>>
14915>>>>>>>>>>>    Function ComGetColor String llSection String llKeyName Returns OLE_COLOR
14917>>>>>>>>>>>        Handle hDispatchDriver
14917>>>>>>>>>>>        OLE_COLOR retVal
14917>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14918>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
14919>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llSection
14920>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llKeyName
14921>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
14922>>>>>>>>>>>        Function_Return retVal
14923>>>>>>>>>>>    End_Function
14924>>>>>>>>>>>End_Class
14925>>>>>>>>>>>
14925>>>>>>>>>Use cCJMarkupContext.pkg    // cCJMarkupContext
Including file: cCJMarkupContext.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJMarkupContext.pkg)
14925>>>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.CommandBars.v17.3.0.ocx
14925>>>>>>>>>>>Use FlexCom20.pkg
14925>>>>>>>>>>>
14925>>>>>>>>>>>// CLSID: {676B9842-AE6D-46A8-BC77-CEE7D5CE9ED7}
14925>>>>>>>>>>>Class cCJMarkupContext is a cComAutomationObject
14926>>>>>>>>>>>
14926>>>>>>>>>>>    Function ComEnableGdiPlus Returns Boolean
14928>>>>>>>>>>>        Boolean retVal
14928>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
14929>>>>>>>>>>>        Function_Return retVal
14930>>>>>>>>>>>    End_Function
14931>>>>>>>>>>>
14931>>>>>>>>>>>    Procedure Set ComEnableGdiPlus Boolean value
14933>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
14934>>>>>>>>>>>    End_Procedure
14935>>>>>>>>>>>
14935>>>>>>>>>>>    Function ComDpiAware Returns Boolean
14937>>>>>>>>>>>        Boolean retVal
14937>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 43 OLE_VT_BOOL to retVal
14938>>>>>>>>>>>        Function_Return retVal
14939>>>>>>>>>>>    End_Function
14940>>>>>>>>>>>
14940>>>>>>>>>>>    Procedure Set ComDpiAware Boolean value
14942>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 43 OLE_VT_BOOL to value
14943>>>>>>>>>>>    End_Procedure
14944>>>>>>>>>>>
14944>>>>>>>>>>>    Function ComIcons Returns Variant
14946>>>>>>>>>>>        Variant retVal
14946>>>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_DISPATCH to retVal
14947>>>>>>>>>>>        Function_Return retVal
14948>>>>>>>>>>>    End_Function
14949>>>>>>>>>>>
14949>>>>>>>>>>>    Procedure Set ComIcons Variant value
14951>>>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_DISPATCH to value
14952>>>>>>>>>>>    End_Procedure
14953>>>>>>>>>>>
14953>>>>>>>>>>>    Procedure ComSetMethod Variant llHandler String llMethod
14955>>>>>>>>>>>        Handle hDispatchDriver
14955>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14956>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
14957>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llHandler
14958>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llMethod
14959>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 1 OLE_VT_VOID
14960>>>>>>>>>>>    End_Procedure
14961>>>>>>>>>>>
14961>>>>>>>>>>>    Procedure ComSetHandler Variant llHandler
14963>>>>>>>>>>>        Handle hDispatchDriver
14963>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14964>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14965>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llHandler
14966>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
14967>>>>>>>>>>>    End_Procedure
14968>>>>>>>>>>>
14968>>>>>>>>>>>    Function ComValidateXML String llText Returns String
14970>>>>>>>>>>>        Handle hDispatchDriver
14970>>>>>>>>>>>        String retVal
14970>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14971>>>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
14972>>>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llText
14973>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_BSTR to retVal
14974>>>>>>>>>>>        Function_Return retVal
14975>>>>>>>>>>>    End_Function
14976>>>>>>>>>>>
14976>>>>>>>>>>>    Function ComToolTipContext Returns Variant
14978>>>>>>>>>>>        Handle hDispatchDriver
14978>>>>>>>>>>>        Variant retVal
14978>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14979>>>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 39 OLE_VT_DISPATCH to retVal
14980>>>>>>>>>>>        Function_Return retVal
14981>>>>>>>>>>>    End_Function
14982>>>>>>>>>>>
14982>>>>>>>>>>>    Procedure ComFreezeUpdates
14984>>>>>>>>>>>        Handle hDispatchDriver
14984>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14985>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 41 OLE_VT_VOID
14986>>>>>>>>>>>    End_Procedure
14987>>>>>>>>>>>
14987>>>>>>>>>>>    Procedure ComUnfreezeUpdates
14989>>>>>>>>>>>        Handle hDispatchDriver
14989>>>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
14990>>>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 42 OLE_VT_VOID
14991>>>>>>>>>>>    End_Procedure
14992>>>>>>>>>>>End_Class
14993>>>>>>>>>>>
14993>>>>>>>>>
14993>>>>>>>>>Define XTPFrameShadowManagerFlags for Integer
14993>>>>>>>>>    Define xtpFrameShadowsDisabled for 1
14993>>>>>>>>>    Define xtpFrameShadowsInvisible for 2
14993>>>>>>>>>    Define xtpFrameShadowsNotResizeable for 4
14993>>>>>>>>>    Define xtpFrameShadowsDisabledInTSS for 8
14993>>>>>>>>>    Define xtpFrameShadowsInvisibleInTSS for 16
14993>>>>>>>>>
14993>>>>>>>>>Define OLEDropConstants for Integer
14993>>>>>>>>>    Define xtpOLEDropNone for 0
14993>>>>>>>>>    Define xtpOLEDropManual for 1
14993>>>>>>>>>
14993>>>>>>>>>Define OLEDragConstants for Integer
14993>>>>>>>>>    Define xtpOLEDragManual for 0
14993>>>>>>>>>    Define xtpOLEDragAutomatic for 1
14993>>>>>>>>>
14993>>>>>>>>>Define XTPWorkspaceCommand for Integer
14993>>>>>>>>>    // Used to move a TabControlItem to the next tab group.
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_MOVEPREVIOUS for 9155
14993>>>>>>>>>    // Used to move a TabControlItem to the previous tab group.
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_MOVENEXT for 9156
14993>>>>>>>>>    // Used to create a new horizontal tab group.
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_NEWHORIZONTAL for 9157
14993>>>>>>>>>    // Used to create a new vertical tab group.
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_NEWVERTICAL for 9158
14993>>>>>>>>>
14993>>>>>>>>>Define XTPCommandBarStyle for Integer
14993>>>>>>>>>    Define XTP_CBRS_GRIPPER for 4194304
14993>>>>>>>>>
14993>>>>>>>>>Define XTPControlNotify for Integer
14993>>>>>>>>>    Define XTP_EN_SPINUP for 4104
14993>>>>>>>>>    Define XTP_EN_SPINDOWN for 4105
14993>>>>>>>>>    Define XTP_EN_BUDDYBUTTONCLICK for 4106
14993>>>>>>>>>    Define XTP_GN_PREVIEWSTART for 4112
14993>>>>>>>>>    Define XTP_GN_PREVIEWCANCEL for 4113
14993>>>>>>>>>    Define XTP_GN_PREVIEWAPPLY for 4114
14993>>>>>>>>>    Define XTP_GN_PREVIEWCHANGE for 4115
14993>>>>>>>>>    Define XTP_GN_STARTDRAG for 4116
14993>>>>>>>>>    Define XTP_GN_SELCHANGE for 4117
14993>>>>>>>>>    Define XTP_EN_CHANGE for 768
14993>>>>>>>>>    Define XTP_EN_SETFOCUS for 256
14993>>>>>>>>>    Define XTP_EN_KILLFOCUS for 512
14993>>>>>>>>>    Define XTP_CBN_EDITCHANGE for 5
14993>>>>>>>>>    Define XTP_CBN_SETFOCUS for 3
14993>>>>>>>>>    Define XTP_CBN_KILLFOCUS for 4
14993>>>>>>>>>    Define XTP_CBN_CLOSEUP for 8
14993>>>>>>>>>    Define XTP_CBN_DROPDOWN for 7
14993>>>>>>>>>    Define XTP_BS_TABCHANGED for 4352
14993>>>>>>>>>
14993>>>>>>>>>// Bar Position
14993>>>>>>>>>Define XTPBarPosition for Integer
14993>>>>>>>>>    // Docked at top.
14993>>>>>>>>>    Define xtpBarTop for 0
14993>>>>>>>>>    // Docked at bottom.
14993>>>>>>>>>    Define xtpBarBottom for 1
14993>>>>>>>>>    // Docked at left.
14993>>>>>>>>>    Define xtpBarLeft for 2
14993>>>>>>>>>    // Docked at right.
14993>>>>>>>>>    Define xtpBarRight for 3
14993>>>>>>>>>    // Floated.
14993>>>>>>>>>    Define xtpBarFloating for 4
14993>>>>>>>>>    // Popuped.
14993>>>>>>>>>    Define xtpBarPopup for 5
14993>>>>>>>>>    // List box.
14993>>>>>>>>>    Define xtpBarListBox for 6
14993>>>>>>>>>    // ComboBoxGalleryPopup.
14993>>>>>>>>>    Define xtpBarComboBoxGalleryPopup for 8
14993>>>>>>>>>
14993>>>>>>>>>// Type of CommandBars
14993>>>>>>>>>Define XTPBarType for Integer
14993>>>>>>>>>    // Command bar is menu bar.
14993>>>>>>>>>    Define xtpBarTypeMenuBar for 0
14993>>>>>>>>>    // Command bar is toolbar.
14993>>>>>>>>>    Define xtpBarTypeNormal for 1
14993>>>>>>>>>    // Command bar is popup.
14993>>>>>>>>>    Define xtpBarTypePopup for 2
14993>>>>>>>>>    // Command bar is ribbon.
14993>>>>>>>>>    Define xtpBarTypeRibbon for 3
14993>>>>>>>>>
14993>>>>>>>>>// Control Type
14993>>>>>>>>>Define XTPControlType for Integer
14993>>>>>>>>>    // Type not defined.
14993>>>>>>>>>    Define xtpControlError for 0
14993>>>>>>>>>    // Button type.
14993>>>>>>>>>    Define xtpControlButton for 1
14993>>>>>>>>>    // Popup type.
14993>>>>>>>>>    Define xtpControlPopup for 2
14993>>>>>>>>>    // Button popup.
14993>>>>>>>>>    Define xtpControlButtonPopup for 3
14993>>>>>>>>>    // Split button popup.
14993>>>>>>>>>    Define xtpControlSplitButtonPopup for 4
14993>>>>>>>>>    // Combo box button.
14993>>>>>>>>>    Define xtpControlComboBox for 5
14993>>>>>>>>>    // Edit control
14993>>>>>>>>>    Define xtpControlEdit for 6
14993>>>>>>>>>    // Custom control
14993>>>>>>>>>    Define xtpControlCustom for 7
14993>>>>>>>>>    // Label control
14993>>>>>>>>>    Define xtpControlLabel for 8
14993>>>>>>>>>    // CheckBox control
14993>>>>>>>>>    Define xtpControlCheckBox for 9
14993>>>>>>>>>    // Gallery control
14993>>>>>>>>>    Define xtpControlGallery for 10
14993>>>>>>>>>    // Radio Button control
14993>>>>>>>>>    Define xtpControlRadioButton for 11
14993>>>>>>>>>
14993>>>>>>>>>// Button Styles
14993>>>>>>>>>Define XTPButtonStyle for Integer
14993>>>>>>>>>    // Automatic style.
14993>>>>>>>>>    Define xtpButtonAutomatic for 0
14993>>>>>>>>>    // Button draw only caption.
14993>>>>>>>>>    Define xtpButtonCaption for 1
14993>>>>>>>>>    // Button draw only icon.
14993>>>>>>>>>    Define xtpButtonIcon for 2
14993>>>>>>>>>    // Button draw icon and caption.
14993>>>>>>>>>    Define xtpButtonIconAndCaption for 3
14993>>>>>>>>>    // Button draw icon and draw caption below icon.
14993>>>>>>>>>    Define xtpButtonIconAndCaptionBelow for 4
14993>>>>>>>>>    // Button draw icon, caption and description for popup bar.
14993>>>>>>>>>    Define xtpButtonCaptionAndDescription for 5
14993>>>>>>>>>
14993>>>>>>>>>// Control Flags
14993>>>>>>>>>Define XTPControlFlags for Integer
14993>>>>>>>>>    // Control is right aligned.
14993>>>>>>>>>    Define xtpFlagRightAlign for 1
14993>>>>>>>>>    // Control does not have focus.  The control will be skipped when performing actions such as tabbing through the controls in the command bar.
14993>>>>>>>>>    Define xtpFlagSkipFocus for 2
14993>>>>>>>>>    // To Pop up child bar left.  The popup will start from the right side of the control that was clicked and be displayed right-to-left. 
14993>>>>>>>>>    Define xtpFlagLeftPopup for 4
14993>>>>>>>>>    // Control is manually updated.
14993>>>>>>>>>    Define xtpFlagManualUpdate for 8
14993>>>>>>>>>    // Used to disable customization.  The user will not be able to move or edit the control.
14993>>>>>>>>>    Define xtpFlagNoMovable for 16
14993>>>>>>>>>    // Used to stretch a control to fill the maximum available width if the control is in the ActiveMenuBar.  This has no effect on controls in the toolbar.
14993>>>>>>>>>    Define xtpFlagControlStretched for 32
14993>>>>>>>>>    // Show tooltip always.
14993>>>>>>>>>    Define xtpFlagShowPopupBarTip for 64
14993>>>>>>>>>    // Wrap row for toolbar or popup bar.
14993>>>>>>>>>    Define xtpFlagWrapRow for 128
14993>>>>>>>>>
14993>>>>>>>>>// Combo Styles
14993>>>>>>>>>Define XTPComboStyle for Integer
14993>>>>>>>>>    // Normal combobox.
14993>>>>>>>>>    Define xtpComboNormal for 0
14993>>>>>>>>>    // Combobox with label.
14993>>>>>>>>>    Define xtpComboLabel for 1
14993>>>>>>>>>
14993>>>>>>>>>// Gallery Resizable style
14993>>>>>>>>>Define XTPGalleryResizable for Integer
14993>>>>>>>>>    // xtpAllowResizeWidth
14993>>>>>>>>>    Define xtpAllowResizeWidth for 1
14993>>>>>>>>>    // xtpAllowResizeHeight
14993>>>>>>>>>    Define xtpAllowResizeHeight for 2
14993>>>>>>>>>
14993>>>>>>>>>// Visual Themes
14993>>>>>>>>>Define XTPVisualTheme for Integer
14993>>>>>>>>>    // Office 2000 theme.
14993>>>>>>>>>    Define xtpThemeOffice2000 for 0
14993>>>>>>>>>    // Office XP theme.
14993>>>>>>>>>    Define xtpThemeOfficeXP for 1
14993>>>>>>>>>    // Office 2003 theme.
14993>>>>>>>>>    Define xtpThemeOffice2003 for 2
14993>>>>>>>>>    // Windows XP themes support.
14993>>>>>>>>>    Define xtpThemeNativeWinXP for 3
14993>>>>>>>>>    // Whidbey theme.
14993>>>>>>>>>    Define xtpThemeWhidbey for 4
14993>>>>>>>>>    // Office 2007 theme.
14993>>>>>>>>>    Define xtpThemeResource for 5
14993>>>>>>>>>    // Ribbon theme.
14993>>>>>>>>>    Define xtpThemeRibbon for 6
14993>>>>>>>>>    // VisualStudio2008 theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2008 for 7
14993>>>>>>>>>    // VisualStudio6 theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio6 for 8
14993>>>>>>>>>    // VisualStudio2010 theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2010 for 9
14993>>>>>>>>>    // Office 2013 theme.
14993>>>>>>>>>    Define xtpThemeOffice2013 for 12
14993>>>>>>>>>    // VisualStudio2012 theme. Uses INI file
14993>>>>>>>>>    Define xtpThemeVisualStudio2012 for 13
14993>>>>>>>>>    // VisualStudio2012 Light theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2012Light for 14
14993>>>>>>>>>    // VisualStudio2012 Dark theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2012Dark for 15
14993>>>>>>>>>    // VisualStudio2015 theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2015 for 16
14993>>>>>>>>>    // VisualStudio2015 Light theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2015Light for 17
14993>>>>>>>>>    // VisualStudio2015 Dark theme.
14993>>>>>>>>>    Define xtpThemeVisualStudio2015Dark for 18
14993>>>>>>>>>
14993>>>>>>>>>// Backstage Separator Visual Themes
14993>>>>>>>>>Define XTPBackstageSeparatorControlAppearanceStyle for Integer
14993>>>>>>>>>    Define xtpSeparatorAppearanceResource for 6
14993>>>>>>>>>    Define xtpSeparatorAppearanceOffice2013 for 12
14993>>>>>>>>>    Define xtpSeparatorAppearanceVisualStudio2015 for 16
14993>>>>>>>>>
14993>>>>>>>>>// Backstage Button Control Visual Themes
14993>>>>>>>>>Define XTPBackstageButtonControlAppearanceStyle for Integer
14993>>>>>>>>>    Define xtpAppearanceStandard for 0
14993>>>>>>>>>    Define xtpAppearanceFlat for 1
14993>>>>>>>>>    Define xtpAppearanceUltraFlat for 2
14993>>>>>>>>>    Define xtpAppearanceOffice2000 for 3
14993>>>>>>>>>    Define xtpAppearanceOfficeXP for 4
14993>>>>>>>>>    Define xtpAppearanceOffice2003 for 5
14993>>>>>>>>>    Define xtpAppearanceOffice2007 for 6
14993>>>>>>>>>    Define xtpAppearanceResource for 7
14993>>>>>>>>>    Define xtpAppearanceNativeWinXP for 8
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2005 for 9
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2008 for 10
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2010 for 11
14993>>>>>>>>>    Define xtpAppearanceOffice2013 for 12
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2012 for 13
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2012Light for 14
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2012Dark for 15
14993>>>>>>>>>    Define xtpAppearanceVisualStudio2015 for 16
14993>>>>>>>>>
14993>>>>>>>>>// ScrollBar Style
14993>>>>>>>>>Define XTPScrollBarStyle for Integer
14993>>>>>>>>>    Define xtpScrollStyleDefault for 0
14993>>>>>>>>>    Define xtpScrollStyleStandard for 1
14993>>>>>>>>>    Define xtpScrollStyleFlat for 2
14993>>>>>>>>>    Define xtpScrollStyleSystem for 3
14993>>>>>>>>>    Define xtpScrollStyleOffice for 4
14993>>>>>>>>>    Define xtpScrollStyleOffice2007Light for 5
14993>>>>>>>>>    Define xtpScrollStyleOffice2007Dark for 6
14993>>>>>>>>>    Define xtpScrollStyleSlider for 7
14993>>>>>>>>>
14993>>>>>>>>>Define XTPControlCustomVerticalOptions for Integer
14993>>>>>>>>>    Define xtpVerticalHide for 0
14993>>>>>>>>>    Define xtpVerticalShow for 1
14993>>>>>>>>>    Define xtpVerticalButton for 2
14993>>>>>>>>>
14993>>>>>>>>>// Text Orientation
14993>>>>>>>>>Define XTPBarTextOrientation for Integer
14993>>>>>>>>>    Define xtpBarTextAuto for 0
14993>>>>>>>>>    Define xtpBarTextVertical for 1
14993>>>>>>>>>    Define xtpBarTextHorizontal for 2
14993>>>>>>>>>
14993>>>>>>>>>// Edit Style
14993>>>>>>>>>Define XTPCommandBarEditStyle for Integer
14993>>>>>>>>>    Define xtpEditStyleLeft for 0
14993>>>>>>>>>    Define xtpEditStyleCenter for 1
14993>>>>>>>>>    Define xtpEditStyleRight for 2
14993>>>>>>>>>    Define xtpEditStyleLowerCase for 16
14993>>>>>>>>>    Define xtpEditStylePassword for 32
14993>>>>>>>>>
14993>>>>>>>>>Define OLETextImageRelationStyle for Integer
14993>>>>>>>>>    Define xtpOverlay for 0
14993>>>>>>>>>    Define xtpImageAboveText for 1
14993>>>>>>>>>    Define xtpTextAboveImage for 2
14993>>>>>>>>>    Define xtpImageBeforeText for 3
14993>>>>>>>>>    Define xtpTextBeforeImage for 4
14993>>>>>>>>>
14993>>>>>>>>>Define OLEPushButtonStyle for Integer
14993>>>>>>>>>    Define xtpButtonNormal for 0
14993>>>>>>>>>    Define xtpButtonDropDown for 1
14993>>>>>>>>>    Define xtpButtonDropDownRight for 2
14993>>>>>>>>>    Define xtpButtonSplitDropDown for 3
14993>>>>>>>>>    Define xtpButtonDropDownNoGlyph for 4
14993>>>>>>>>>
14993>>>>>>>>>Define OLEAlignmentStyle for Integer
14993>>>>>>>>>    Define xtpAlignLeft for 0
14993>>>>>>>>>    Define xtpAlignRight for 1
14993>>>>>>>>>    Define xtpAlignCenter for 2
14993>>>>>>>>>    Define xtpAlignMiddle for 0
14993>>>>>>>>>    Define xtpAlignTop for 4
14993>>>>>>>>>    Define xtpAlignBottom for 8
14993>>>>>>>>>
14993>>>>>>>>>// Docking Flags
14993>>>>>>>>>Define XTPToolBarFlags for Integer
14993>>>>>>>>>    // Allows docking at the top of the client area. 
14993>>>>>>>>>    Define xtpFlagAlignTop for 1
14993>>>>>>>>>    // Allows docking at the bottom of the client area. 
14993>>>>>>>>>    Define xtpFlagAlignBottom for 2
14993>>>>>>>>>    // Allows docking on the left side of the client area. 
14993>>>>>>>>>    Define xtpFlagAlignLeft for 4
14993>>>>>>>>>    // Allows docking on the left side of the client area. 
14993>>>>>>>>>    Define xtpFlagAlignRight for 8
14993>>>>>>>>>    // Allows docking on any side of the client area. 
14993>>>>>>>>>    Define xtpFlagAlignAny for 15
14993>>>>>>>>>    // Allows floating. 
14993>>>>>>>>>    Define xtpFlagFloating for 16
14993>>>>>>>>>    // Allow to hide wrapped controls.
14993>>>>>>>>>    Define xtpFlagHideWrap for 32
14993>>>>>>>>>    // Bar is stretched.
14993>>>>>>>>>    Define xtpFlagStretched for 64
14993>>>>>>>>>    // Bar is stretched, but not fill whole row
14993>>>>>>>>>    Define xtpFlagStretchedShared for 1048576
14993>>>>>>>>>    // Enables smart layout
14993>>>>>>>>>    Define xtpFlagSmartLayout for 2097152
14993>>>>>>>>>
14993>>>>>>>>>// MenuBar flags
14993>>>>>>>>>Define XTPMenuBarFlags for Integer
14993>>>>>>>>>    // To hide minimize box.
14993>>>>>>>>>    Define xtpFlagHideMinimizeBox for 256
14993>>>>>>>>>    // To hide maximize box.
14993>>>>>>>>>    Define xtpFlagHideMaximizeBox for 512
14993>>>>>>>>>    // To hide close button.
14993>>>>>>>>>    Define xtpFlagHideClose for 4096
14993>>>>>>>>>    // To add system MDI popup bar.
14993>>>>>>>>>    Define xtpFlagHideMDIButtons for 4864
14993>>>>>>>>>    Define xtpFlagAddMDISysPopup for 8192
14993>>>>>>>>>
14993>>>>>>>>>// Animation
14993>>>>>>>>>Define XTPAnimationType for Integer
14993>>>>>>>>>    // As defined in the 'Display' settings.
14993>>>>>>>>>    Define xtpAnimateWindowsDefault for 0
14993>>>>>>>>>    // Any of the first three in random selection.
14993>>>>>>>>>    Define xtpAnimateRandom for 1
14993>>>>>>>>>    // Unfold top to bottom.
14993>>>>>>>>>    Define xtpAnimateUnfold for 2
14993>>>>>>>>>    // Slide in from left.
14993>>>>>>>>>    Define xtpAnimateSlide for 3
14993>>>>>>>>>    // Fade-in.
14993>>>>>>>>>    Define xtpAnimateFade for 4
14993>>>>>>>>>    // No animation.
14993>>>>>>>>>    Define xtpAnimateNone for 5
14993>>>>>>>>>
14993>>>>>>>>>// Status Pane Styles
14993>>>>>>>>>Define XTPStatusPaneStyle for Integer
14993>>>>>>>>>    // When this flag is applied, the border will be removed from the indicated statusbar pane.
14993>>>>>>>>>    Define SBPS_NOBORDERS for 256
14993>>>>>>>>>    // When this flag is applied, the indicated statusbar pane will be disabled.
14993>>>>>>>>>    Define SBPS_DISABLED for 67108864
14993>>>>>>>>>    // The pane will stretched, it will not have a static width.
14993>>>>>>>>>    Define SBPS_STRETCH for 134217728
14993>>>>>>>>>
14993>>>>>>>>>// Tracking Falgs
14993>>>>>>>>>Define XTPTrackPopupFlags for Integer
14993>>>>>>>>>    // Returns the Id of the control instead of triggering the execute event.  The execute event will not be triggered.
14993>>>>>>>>>    Define TPM_RETURNCMD for 256
14993>>>>>>>>>    // Allows you to choose a menu item using a right click.
14993>>>>>>>>>    Define TPM_RIGHTBUTTON for 2
14993>>>>>>>>>    // Right aligns the menu starting from the x and y coordinates.
14993>>>>>>>>>    Define TPM_RIGHTALIGN for 8
14993>>>>>>>>>    // Use the TPM_RECURSE flag to display a menu when another menu is already displayed. This is intended to support context menus within a menu.
14993>>>>>>>>>    Define TPM_RECURSE for 1
14993>>>>>>>>>
14993>>>>>>>>>// Tracking Falgs
14993>>>>>>>>>Define XTPControlHideFlags for Integer
14993>>>>>>>>>    // Control is visible.
14993>>>>>>>>>    Define xtpNoHide for 0
14993>>>>>>>>>    // Control is hidden by generic reason.
14993>>>>>>>>>    Define xtpHideGeneric for 1
14993>>>>>>>>>    // Control is hidden by wrap.
14993>>>>>>>>>    Define xtpHideWrap for 2
14993>>>>>>>>>    // Control is hidden by docking position.
14993>>>>>>>>>    Define xtpHideDockingPosition for 4
14993>>>>>>>>>    // Control is hidden by scrolling.
14993>>>>>>>>>    Define xtpHideScroll for 8
14993>>>>>>>>>    // Control is hidden by customize settings.
14993>>>>>>>>>    Define xtpHideCustomize for 16
14993>>>>>>>>>    // If the control is rarely used and it is not visible because the intelligent menus option on and the command is a hidden command.
14993>>>>>>>>>    Define xtpHideExpand for 32
14993>>>>>>>>>
14993>>>>>>>>>Define XTPKeyboardCuesShow for Integer
14993>>>>>>>>>    // Show keyboard cues always
14993>>>>>>>>>    Define xtpKeyboardCuesShowAlways for 0
14993>>>>>>>>>    // Never show keyboard cues
14993>>>>>>>>>    Define xtpKeyboardCuesShowNever for 1
14993>>>>>>>>>    // System defined
14993>>>>>>>>>    Define xtpKeyboardCuesShowWindowsDefault for 2
14993>>>>>>>>>
14993>>>>>>>>>Define XTPKeyboardCuesUse for Integer
14993>>>>>>>>>    // Activate only menu by using underlines
14993>>>>>>>>>    Define xtpKeyboardCuesUseMenuOnly for 0
14993>>>>>>>>>    // Activate menu and toolbars by using underlines
14993>>>>>>>>>    Define xtpKeyboardCuesUseAll for 1
14993>>>>>>>>>    // No using underlines
14993>>>>>>>>>    Define xtpKeyboardCuesUseNone for 2
14993>>>>>>>>>    // Only if Ampersant exists option
14993>>>>>>>>>    Define xtpKeyboardCuesUseAmpersandOnly for 4
14993>>>>>>>>>
14993>>>>>>>>>// Workspace Buttons
14993>>>>>>>>>Define XTPWorkspaceButtons for Integer
14993>>>>>>>>>    // To hide arrow buttons.
14993>>>>>>>>>    Define xtpWorkspaceHideArrows for 1
14993>>>>>>>>>    // To hide close button.
14993>>>>>>>>>    Define xtpWorkspaceHideClose for 2
14993>>>>>>>>>    // To hide arrow and close buttons.
14993>>>>>>>>>    Define xtpWorkspaceHideAll for 3
14993>>>>>>>>>    // To show active file button.
14993>>>>>>>>>    Define xtpWorkspaceShowActiveFiles for 4
14993>>>>>>>>>    // To hide arrow buttons always
14993>>>>>>>>>    Define xtpWorkspaceHideArrowsAlways for 9
14993>>>>>>>>>    // To show close button for all tabs
14993>>>>>>>>>    Define xtpWorkspaceShowCloseTab for 16
14993>>>>>>>>>    // To show close button for selected tabs.
14993>>>>>>>>>    Define xtpWorkspaceShowCloseSelectedTab for 32
14993>>>>>>>>>
14993>>>>>>>>>// Workspace New Tab Position
14993>>>>>>>>>Define XTPWorkspaceNewTabPosition for Integer
14993>>>>>>>>>    // New tab will be created after all tabs
14993>>>>>>>>>    Define xtpWorkspaceNewTabRightMost for 0
14993>>>>>>>>>    // New tab will be created before all tabs
14993>>>>>>>>>    Define xtpWorkspaceNewTabLeftMost for 1
14993>>>>>>>>>    // New tab will be created after active tab
14993>>>>>>>>>    Define xtpWorkspaceNewTabNextToActive for 2
14993>>>>>>>>>
14993>>>>>>>>>// Scale Mode
14993>>>>>>>>>Define XTPScaleMode for Integer
14993>>>>>>>>>    // Auto scale mode
14993>>>>>>>>>    Define xtpScaleAuto for 0
14993>>>>>>>>>    // Pixels scale mode
14993>>>>>>>>>    Define xtpScalePixel for 1
14993>>>>>>>>>    // Twips scale mode
14993>>>>>>>>>    Define xtpScaleTwip for 2
14993>>>>>>>>>
14993>>>>>>>>>Define XTPTextAlignment for Integer
14993>>>>>>>>>    Define xtpAlignmentLeft for 0
14993>>>>>>>>>    Define xtpAlignmentCenter for 1
14993>>>>>>>>>    Define xtpAlignmentRight for 2
14993>>>>>>>>>
14993>>>>>>>>>Define XTPShellAutoCompleteFlags for Integer
14993>>>>>>>>>    Define xtpShellAutoCompleteFileSystem for 1
14993>>>>>>>>>    Define xtpShellAutoCompleteFileSysOnly for 16
14993>>>>>>>>>    Define xtpShellAutoCompleteUrlAll for 6
14993>>>>>>>>>    Define xtpShellAutoCompleteUrlHistory for 2
14993>>>>>>>>>    Define xtpShellAutoCompleteUrlMRU for 4
14993>>>>>>>>>    Define xtpShellAutoCompleteAll for 7
14993>>>>>>>>>
14993>>>>>>>>>Define XTPRibbonTabContextColor for Integer
14993>>>>>>>>>    Define xtpRibbonTabContextColorNone for 0
14993>>>>>>>>>    Define xtpRibbonTabContextColorBlue for 1
14993>>>>>>>>>    Define xtpRibbonTabContextColorYellow for 2
14993>>>>>>>>>    Define xtpRibbonTabContextColorGreen for 3
14993>>>>>>>>>    Define xtpRibbonTabContextColorRed for 4
14993>>>>>>>>>    Define xtpRibbonTabContextColorPurple for 5
14993>>>>>>>>>    Define xtpRibbonTabContextColorCyan for 6
14993>>>>>>>>>    Define xtpRibbonTabContextColorOrange for 7
14993>>>>>>>>>
14993>>>>>>>>>Define XTPCommandBarsSpecialCommands for Integer
14993>>>>>>>>>    Define XTP_ID_RIBBONCONTROLTAB for 9604
14993>>>>>>>>>    Define XTP_ID_RIBBONCUSTOMIZE for 9607
14993>>>>>>>>>    Define XTP_ID_CUSTOMIZE_ADDORREMOVE for 9122
14993>>>>>>>>>    Define XTP_ID_CUSTOMIZE_RESET for 9123
14993>>>>>>>>>    Define XTP_ID_TOOLBAR_EXPAND for 9148
14993>>>>>>>>>    Define XTP_ID_TOOLBAR_HIDE for 9149
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_CANCEL for 9159
14993>>>>>>>>>    Define XTP_ID_WINDOWLIST for 35000
14993>>>>>>>>>    Define XTP_ID_CUSTOMIZE for 35001
14993>>>>>>>>>    Define XTP_ID_WORKSPACE_ACTIONS for 35002
14993>>>>>>>>>    Define XTP_ID_TOOLBARLIST for 59392
14993>>>>>>>>>    Define XTP_ID_FILE_MRU for 35003
14993>>>>>>>>>
14993>>>>>>>>>Define XTPSliderCommand for Integer
14993>>>>>>>>>    Define XTP_SB_LINELEFT for 0
14993>>>>>>>>>    Define XTP_SB_LINERIGHT for 1
14993>>>>>>>>>    Define XTP_SB_PAGELEFT for 2
14993>>>>>>>>>    Define XTP_SB_PAGERIGHT for 3
14993>>>>>>>>>    Define XTP_SB_THUMBTRACK for 5
14993>>>>>>>>>    Define XTP_SB_LEFT for 6
14993>>>>>>>>>    Define XTP_SB_RIGHT for 7
14993>>>>>>>>>    Define XTP_SB_ENDSCROLL for 8
14993>>>>>>>>>
14993>>>>>>>>>Define XTPPrintOrientation for Integer
14993>>>>>>>>>    Define xtpOrientationPortrait for 1
14993>>>>>>>>>    Define xtpOrientationLandscape for 2
14993>>>>>>>>>
14993>>>>>>>>>Define XTPBackImage for Integer
14993>>>>>>>>>    Define XTPNone for 0
14993>>>>>>>>>    Define XTPCalligraphy for 1
14993>>>>>>>>>    Define XTPCirclesAndStripes for 2
14993>>>>>>>>>    Define XTPCircuit for 3
14993>>>>>>>>>    Define XTPClouds for 4
14993>>>>>>>>>    Define XTPDoodleCircles for 5
14993>>>>>>>>>    Define XTPDoodleDiamonds for 6
14993>>>>>>>>>    Define XTPGeometry for 7
14993>>>>>>>>>    Define XTPLunchBox for 8
14993>>>>>>>>>    Define XTPSchoolSupplies for 9
14993>>>>>>>>>    Define XTPSpring for 10
14993>>>>>>>>>    Define XTPStars for 11
14993>>>>>>>>>    Define XTPStraws for 12
14993>>>>>>>>>    Define XTPTreeRings for 13
14993>>>>>>>>>    Define XTPUnderWater for 14
14993>>>>>>>>>
14993>>>>>>>>>// CLSID: {D3A0512A-87E4-460A-8491-32BD8DE3269C}
14993>>>>>>>>>Class cCJIFrameShadow is a Mixin
14994>>>>>>>>>
14994>>>>>>>>>    Function ComOuterSize Returns Integer
14996>>>>>>>>>        Integer retVal
14996>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
14997>>>>>>>>>        Function_Return retVal
14998>>>>>>>>>    End_Function
14999>>>>>>>>>
14999>>>>>>>>>    Procedure Set ComOuterSize Integer value
15001>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
15002>>>>>>>>>    End_Procedure
15003>>>>>>>>>
15003>>>>>>>>>    Function ComInnerSize Returns Integer
15005>>>>>>>>>        Integer retVal
15005>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
15006>>>>>>>>>        Function_Return retVal
15007>>>>>>>>>    End_Function
15008>>>>>>>>>
15008>>>>>>>>>    Procedure Set ComInnerSize Integer value
15010>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
15011>>>>>>>>>    End_Procedure
15012>>>>>>>>>
15012>>>>>>>>>    Function ComOffsetX Returns OLE_XSIZE_PIXELS
15014>>>>>>>>>        OLE_XSIZE_PIXELS retVal
15014>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
15015>>>>>>>>>        Function_Return retVal
15016>>>>>>>>>    End_Function
15017>>>>>>>>>
15017>>>>>>>>>    Procedure Set ComOffsetX OLE_XSIZE_PIXELS value
15019>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
15020>>>>>>>>>    End_Procedure
15021>>>>>>>>>
15021>>>>>>>>>    Function ComOffsetY Returns OLE_YSIZE_PIXELS
15023>>>>>>>>>        OLE_YSIZE_PIXELS retVal
15023>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
15024>>>>>>>>>        Function_Return retVal
15025>>>>>>>>>    End_Function
15026>>>>>>>>>
15026>>>>>>>>>    Procedure Set ComOffsetY OLE_YSIZE_PIXELS value
15028>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
15029>>>>>>>>>    End_Procedure
15030>>>>>>>>>
15030>>>>>>>>>    Function ComColor Returns OLE_COLOR
15032>>>>>>>>>        OLE_COLOR retVal
15032>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
15033>>>>>>>>>        Function_Return retVal
15034>>>>>>>>>    End_Function
15035>>>>>>>>>
15035>>>>>>>>>    Procedure Set ComColor OLE_COLOR value
15037>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
15038>>>>>>>>>    End_Procedure
15039>>>>>>>>>
15039>>>>>>>>>    Function ComTransparency Returns Short
15041>>>>>>>>>        Short retVal
15041>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I2 to retVal
15042>>>>>>>>>        Function_Return retVal
15043>>>>>>>>>    End_Function
15044>>>>>>>>>
15044>>>>>>>>>    Procedure Set ComTransparency Short value
15046>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I2 to value
15047>>>>>>>>>    End_Procedure
15048>>>>>>>>>
15048>>>>>>>>>    Function ComBlendingFactors Returns Variant
15050>>>>>>>>>        Variant retVal
15050>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_VARIANT to retVal
15051>>>>>>>>>        Function_Return retVal
15052>>>>>>>>>    End_Function
15053>>>>>>>>>
15053>>>>>>>>>    Procedure Set ComBlendingFactors Variant value
15055>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_VARIANT to value
15056>>>>>>>>>    End_Procedure
15057>>>>>>>>>
15057>>>>>>>>>    Function ComBlendingPositions Returns Variant
15059>>>>>>>>>        Variant retVal
15059>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_VARIANT to retVal
15060>>>>>>>>>        Function_Return retVal
15061>>>>>>>>>    End_Function
15062>>>>>>>>>
15062>>>>>>>>>    Procedure Set ComBlendingPositions Variant value
15064>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_VARIANT to value
15065>>>>>>>>>    End_Procedure
15066>>>>>>>>>
15066>>>>>>>>>    Function ComOwner Returns OLE_HANDLE
15068>>>>>>>>>        Handle hDispatchDriver
15068>>>>>>>>>        OLE_HANDLE retVal
15068>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15069>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_I4 to retVal
15070>>>>>>>>>        Function_Return retVal
15071>>>>>>>>>    End_Function
15072>>>>>>>>>
15072>>>>>>>>>    Procedure ComFreezeUpdates Boolean llfreeze
15074>>>>>>>>>        Handle hDispatchDriver
15074>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15075>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15076>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llfreeze
15077>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 10 OLE_VT_VOID
15078>>>>>>>>>    End_Procedure
15079>>>>>>>>>
15079>>>>>>>>>    Procedure ComShow
15081>>>>>>>>>        Handle hDispatchDriver
15081>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15082>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
15083>>>>>>>>>    End_Procedure
15084>>>>>>>>>
15084>>>>>>>>>    Procedure ComHide
15086>>>>>>>>>        Handle hDispatchDriver
15086>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15087>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 12 OLE_VT_VOID
15088>>>>>>>>>    End_Procedure
15089>>>>>>>>>
15089>>>>>>>>>    Procedure ComUpdatePosition
15091>>>>>>>>>        Handle hDispatchDriver
15091>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15092>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
15093>>>>>>>>>    End_Procedure
15094>>>>>>>>>
15094>>>>>>>>>    Procedure ComSetBlendingOptions Variant llfactors Variant llpositions
15096>>>>>>>>>        Handle hDispatchDriver
15096>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15097>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15098>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llfactors
15099>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llpositions
15100>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
15101>>>>>>>>>    End_Procedure
15102>>>>>>>>>End_Class
15103>>>>>>>>>
15103>>>>>>>>>// CoClass
15103>>>>>>>>>// CLSID: {09F054F5-5B81-4C3C-A68E-3F0FF3771B6E}
15103>>>>>>>>>Class cCJFrameShadow is a cComAutomationObject
15104>>>>>>>>>    Import_Class_Protocol cCJIFrameShadow
15105>>>>>>>>>
15105>>>>>>>>>    Procedure Construct_Object
15107>>>>>>>>>        Forward Send Construct_Object
15109>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
15110>>>>>>>>>    End_Procedure
15111>>>>>>>>>End_Class
15112>>>>>>>>>
15112>>>>>>>>>// CLSID: {4DDF529C-F2DA-4617-AD07-FE7F08C16C0B}
15112>>>>>>>>>Class cCJIFrameShadows is a Mixin
15113>>>>>>>>>
15113>>>>>>>>>    Function Com_NewEnum Returns Variant
15115>>>>>>>>>        Handle hDispatchDriver
15115>>>>>>>>>        Variant retVal
15115>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15116>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
15117>>>>>>>>>        Function_Return retVal
15118>>>>>>>>>    End_Function
15119>>>>>>>>>End_Class
15120>>>>>>>>>
15120>>>>>>>>>// CoClass
15120>>>>>>>>>// CLSID: {8A6CB848-B4D6-492D-931A-9A39D207DE99}
15120>>>>>>>>>Class cCJFrameShadows is a cComAutomationObject
15121>>>>>>>>>    Import_Class_Protocol cCJIFrameShadows
15122>>>>>>>>>
15122>>>>>>>>>    Procedure Construct_Object
15124>>>>>>>>>        Forward Send Construct_Object
15126>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
15127>>>>>>>>>    End_Procedure
15128>>>>>>>>>End_Class
15129>>>>>>>>>
15129>>>>>>>>>// CLSID: {A933B37E-9BF8-4337-959A-4629C9286C7A}
15129>>>>>>>>>Class cCJIFrameShadowManager is a Mixin
15130>>>>>>>>>
15130>>>>>>>>>    Function ComFlags Returns Integer
15132>>>>>>>>>        Integer retVal
15132>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
15133>>>>>>>>>        Function_Return retVal
15134>>>>>>>>>    End_Function
15135>>>>>>>>>
15135>>>>>>>>>    Procedure Set ComFlags Integer value
15137>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
15138>>>>>>>>>    End_Procedure
15139>>>>>>>>>
15139>>>>>>>>>    Function ComDefaultOuterSize Returns Integer
15141>>>>>>>>>        Integer retVal
15141>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
15142>>>>>>>>>        Function_Return retVal
15143>>>>>>>>>    End_Function
15144>>>>>>>>>
15144>>>>>>>>>    Procedure Set ComDefaultOuterSize Integer value
15146>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
15147>>>>>>>>>    End_Procedure
15148>>>>>>>>>
15148>>>>>>>>>    Function ComDefaultInnerSize Returns Integer
15150>>>>>>>>>        Integer retVal
15150>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
15151>>>>>>>>>        Function_Return retVal
15152>>>>>>>>>    End_Function
15153>>>>>>>>>
15153>>>>>>>>>    Procedure Set ComDefaultInnerSize Integer value
15155>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
15156>>>>>>>>>    End_Procedure
15157>>>>>>>>>
15157>>>>>>>>>    Function ComDefaultOffsetX Returns OLE_XSIZE_PIXELS
15159>>>>>>>>>        OLE_XSIZE_PIXELS retVal
15159>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
15160>>>>>>>>>        Function_Return retVal
15161>>>>>>>>>    End_Function
15162>>>>>>>>>
15162>>>>>>>>>    Procedure Set ComDefaultOffsetX OLE_XSIZE_PIXELS value
15164>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
15165>>>>>>>>>    End_Procedure
15166>>>>>>>>>
15166>>>>>>>>>    Function ComDefaultOffsetY Returns OLE_YSIZE_PIXELS
15168>>>>>>>>>        OLE_YSIZE_PIXELS retVal
15168>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
15169>>>>>>>>>        Function_Return retVal
15170>>>>>>>>>    End_Function
15171>>>>>>>>>
15171>>>>>>>>>    Procedure Set ComDefaultOffsetY OLE_YSIZE_PIXELS value
15173>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
15174>>>>>>>>>    End_Procedure
15175>>>>>>>>>
15175>>>>>>>>>    Function ComDefaultColor Returns OLE_COLOR
15177>>>>>>>>>        OLE_COLOR retVal
15177>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
15178>>>>>>>>>        Function_Return retVal
15179>>>>>>>>>    End_Function
15180>>>>>>>>>
15180>>>>>>>>>    Procedure Set ComDefaultColor OLE_COLOR value
15182>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
15183>>>>>>>>>    End_Procedure
15184>>>>>>>>>
15184>>>>>>>>>    Function ComDefaultTransparency Returns Short
15186>>>>>>>>>        Short retVal
15186>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I2 to retVal
15187>>>>>>>>>        Function_Return retVal
15188>>>>>>>>>    End_Function
15189>>>>>>>>>
15189>>>>>>>>>    Procedure Set ComDefaultTransparency Short value
15191>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I2 to value
15192>>>>>>>>>    End_Procedure
15193>>>>>>>>>
15193>>>>>>>>>    Function ComDefaultBlendingFactors Returns Variant
15195>>>>>>>>>        Handle hDispatchDriver
15195>>>>>>>>>        Variant retVal
15195>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15196>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_VARIANT to retVal
15197>>>>>>>>>        Function_Return retVal
15198>>>>>>>>>    End_Function
15199>>>>>>>>>
15199>>>>>>>>>    Function ComDefaultBlendingPositions Returns Variant
15201>>>>>>>>>        Handle hDispatchDriver
15201>>>>>>>>>        Variant retVal
15201>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15202>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_VARIANT to retVal
15203>>>>>>>>>        Function_Return retVal
15204>>>>>>>>>    End_Function
15205>>>>>>>>>
15205>>>>>>>>>    Function ComIsShadowSupported Returns Boolean
15207>>>>>>>>>        Handle hDispatchDriver
15207>>>>>>>>>        Boolean retVal
15207>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15208>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_BOOL to retVal
15209>>>>>>>>>        Function_Return retVal
15210>>>>>>>>>    End_Function
15211>>>>>>>>>
15211>>>>>>>>>    Function ComEnableShadow OLE_HANDLE llhWnd OLE_COLOR llColor Integer llOuterSize Integer llInnerSize Integer llxOffset Integer llyOffset Short llTransparency Returns Variant
15213>>>>>>>>>        Handle hDispatchDriver
15213>>>>>>>>>        Variant retVal
15213>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15214>>>>>>>>>        Send PrepareParams to hDispatchDriver 7
15215>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15216>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
15217>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llOuterSize
15218>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llInnerSize
15219>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llxOffset
15220>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llyOffset
15221>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I2 llTransparency
15222>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
15223>>>>>>>>>        Function_Return retVal
15224>>>>>>>>>    End_Function
15225>>>>>>>>>
15225>>>>>>>>>    Procedure ComDisableShadow OLE_HANDLE llhWnd
15227>>>>>>>>>        Handle hDispatchDriver
15227>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15228>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15229>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15230>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 12 OLE_VT_VOID
15231>>>>>>>>>    End_Procedure
15232>>>>>>>>>
15232>>>>>>>>>    Function ComIsShadowEnabled OLE_HANDLE llhWnd Returns Boolean
15234>>>>>>>>>        Handle hDispatchDriver
15234>>>>>>>>>        Boolean retVal
15234>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15235>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15236>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15237>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
15238>>>>>>>>>        Function_Return retVal
15239>>>>>>>>>    End_Function
15240>>>>>>>>>
15240>>>>>>>>>    Function ComGetShadow OLE_HANDLE llhWnd Returns Variant
15242>>>>>>>>>        Handle hDispatchDriver
15242>>>>>>>>>        Variant retVal
15242>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15243>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15244>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15245>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_DISPATCH to retVal
15246>>>>>>>>>        Function_Return retVal
15247>>>>>>>>>    End_Function
15248>>>>>>>>>
15248>>>>>>>>>    Procedure ComFreezeUpdates Boolean llfreeze
15250>>>>>>>>>        Handle hDispatchDriver
15250>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15251>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15252>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llfreeze
15253>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
15254>>>>>>>>>    End_Procedure
15255>>>>>>>>>
15255>>>>>>>>>    Procedure ComSetGlobalOuterSize Integer llsize
15257>>>>>>>>>        Handle hDispatchDriver
15257>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15258>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15259>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llsize
15260>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
15261>>>>>>>>>    End_Procedure
15262>>>>>>>>>
15262>>>>>>>>>    Procedure ComSetGlobalInnerSize Integer llsize
15264>>>>>>>>>        Handle hDispatchDriver
15264>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15265>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15266>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llsize
15267>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
15268>>>>>>>>>    End_Procedure
15269>>>>>>>>>
15269>>>>>>>>>    Procedure ComSetGlobalOffset OLE_XSIZE_PIXELS llOffsetX OLE_YSIZE_PIXELS llOffsetY
15271>>>>>>>>>        Handle hDispatchDriver
15271>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15272>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15273>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llOffsetX
15274>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llOffsetY
15275>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
15276>>>>>>>>>    End_Procedure
15277>>>>>>>>>
15277>>>>>>>>>    Procedure ComSetGlobalColor OLE_COLOR llColor
15279>>>>>>>>>        Handle hDispatchDriver
15279>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15280>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15281>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
15282>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 19 OLE_VT_VOID
15283>>>>>>>>>    End_Procedure
15284>>>>>>>>>
15284>>>>>>>>>    Procedure ComSetGlobalTransparency Short llTransparency
15286>>>>>>>>>        Handle hDispatchDriver
15286>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15287>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15288>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I2 llTransparency
15289>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 20 OLE_VT_VOID
15290>>>>>>>>>    End_Procedure
15291>>>>>>>>>
15291>>>>>>>>>    Procedure ComSetDefaultBlendingOptions Variant llfactors Variant llpositions
15293>>>>>>>>>        Handle hDispatchDriver
15293>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15294>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15295>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llfactors
15296>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llpositions
15297>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
15298>>>>>>>>>    End_Procedure
15299>>>>>>>>>
15299>>>>>>>>>    Procedure ComSetGlobalBlendingOptions Variant llfactors Variant llpositions
15301>>>>>>>>>        Handle hDispatchDriver
15301>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15302>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15303>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llfactors
15304>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llpositions
15305>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
15306>>>>>>>>>    End_Procedure
15307>>>>>>>>>
15307>>>>>>>>>    Function ComFrameShadows Returns Variant
15309>>>>>>>>>        Handle hDispatchDriver
15309>>>>>>>>>        Variant retVal
15309>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15310>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 23 OLE_VT_DISPATCH to retVal
15311>>>>>>>>>        Function_Return retVal
15312>>>>>>>>>    End_Function
15313>>>>>>>>>End_Class
15314>>>>>>>>>
15314>>>>>>>>>// CoClass
15314>>>>>>>>>// CLSID: {0C48407F-DDA7-45FD-8AE8-B1A88391344D}
15314>>>>>>>>>Class cCJFrameShadowManager is a cComAutomationObject
15315>>>>>>>>>    Import_Class_Protocol cCJIFrameShadowManager
15316>>>>>>>>>
15316>>>>>>>>>    Procedure Construct_Object
15318>>>>>>>>>        Forward Send Construct_Object
15320>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
15321>>>>>>>>>    End_Procedure
15322>>>>>>>>>End_Class
15323>>>>>>>>>
15323>>>>>>>>>// CLSID: {1616DC35-B997-432B-AB4F-439341A769E5}
15323>>>>>>>>>// Dispatch interface for CommandBars Control
15323>>>>>>>>>Class cCJ_DCommandBars is a Mixin
15324>>>>>>>>>
15324>>>>>>>>>    Function ComVisualTheme Returns XTPVisualTheme
15326>>>>>>>>>        XTPVisualTheme retVal
15326>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
15327>>>>>>>>>        Function_Return retVal
15328>>>>>>>>>    End_Function
15329>>>>>>>>>
15329>>>>>>>>>    Procedure Set ComVisualTheme XTPVisualTheme value
15331>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
15332>>>>>>>>>    End_Procedure
15333>>>>>>>>>
15333>>>>>>>>>    Function ComIcons Returns Variant
15335>>>>>>>>>        Variant retVal
15335>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
15336>>>>>>>>>        Function_Return retVal
15337>>>>>>>>>    End_Function
15338>>>>>>>>>
15338>>>>>>>>>    Procedure Set ComIcons Variant value
15340>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
15341>>>>>>>>>    End_Procedure
15342>>>>>>>>>
15342>>>>>>>>>    Function ComScaleMode Returns XTPScaleMode
15344>>>>>>>>>        XTPScaleMode retVal
15344>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
15345>>>>>>>>>        Function_Return retVal
15346>>>>>>>>>    End_Function
15347>>>>>>>>>
15347>>>>>>>>>    Procedure Set ComScaleMode XTPScaleMode value
15349>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
15350>>>>>>>>>    End_Procedure
15351>>>>>>>>>
15351>>>>>>>>>    Function ComRightToLeft Returns Boolean
15353>>>>>>>>>        Boolean retVal
15353>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_BOOL to retVal
15354>>>>>>>>>        Function_Return retVal
15355>>>>>>>>>    End_Function
15356>>>>>>>>>
15356>>>>>>>>>    Procedure Set ComRightToLeft Boolean value
15358>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_BOOL to value
15359>>>>>>>>>    End_Procedure
15360>>>>>>>>>
15360>>>>>>>>>    Function ComIsAllCaps Returns Boolean
15362>>>>>>>>>        Boolean retVal
15362>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_BOOL to retVal
15363>>>>>>>>>        Function_Return retVal
15364>>>>>>>>>    End_Function
15365>>>>>>>>>
15365>>>>>>>>>    Procedure Set ComIsAllCaps Boolean value
15367>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_BOOL to value
15368>>>>>>>>>    End_Procedure
15369>>>>>>>>>
15369>>>>>>>>>    Function ComIsAllowFrameTransparency Returns Boolean
15371>>>>>>>>>        Boolean retVal
15371>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_BOOL to retVal
15372>>>>>>>>>        Function_Return retVal
15373>>>>>>>>>    End_Function
15374>>>>>>>>>
15374>>>>>>>>>    Procedure Set ComIsAllowFrameTransparency Boolean value
15376>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_BOOL to value
15377>>>>>>>>>    End_Procedure
15378>>>>>>>>>
15378>>>>>>>>>    Function ComReCreateReparented Returns Boolean
15380>>>>>>>>>        Boolean retVal
15380>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
15381>>>>>>>>>        Function_Return retVal
15382>>>>>>>>>    End_Function
15383>>>>>>>>>
15383>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
15385>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
15386>>>>>>>>>    End_Procedure
15387>>>>>>>>>
15387>>>>>>>>>    Function ComCount Returns Integer
15389>>>>>>>>>        Handle hDispatchDriver
15389>>>>>>>>>        Integer retVal
15389>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15390>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
15391>>>>>>>>>        Function_Return retVal
15392>>>>>>>>>    End_Function
15393>>>>>>>>>
15393>>>>>>>>>    // Returns a specific item.
15393>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
15395>>>>>>>>>        Handle hDispatchDriver
15395>>>>>>>>>        Variant retVal
15395>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15396>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15397>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
15398>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
15399>>>>>>>>>        Function_Return retVal
15400>>>>>>>>>    End_Function
15401>>>>>>>>>
15401>>>>>>>>>    Function Com_NewEnum Returns Variant
15403>>>>>>>>>        Handle hDispatchDriver
15403>>>>>>>>>        Variant retVal
15403>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15404>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
15405>>>>>>>>>        Function_Return retVal
15406>>>>>>>>>    End_Function
15407>>>>>>>>>
15407>>>>>>>>>    Function ComAdd String llName XTPBarPosition llPosition Returns Variant
15409>>>>>>>>>        Handle hDispatchDriver
15409>>>>>>>>>        Variant retVal
15409>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15410>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15411>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15412>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
15413>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
15414>>>>>>>>>        Function_Return retVal
15415>>>>>>>>>    End_Function
15416>>>>>>>>>
15416>>>>>>>>>    Procedure ComAddImageList Variant llImageList
15418>>>>>>>>>        Handle hDispatchDriver
15418>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15419>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15420>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llImageList
15421>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
15422>>>>>>>>>    End_Procedure
15423>>>>>>>>>
15423>>>>>>>>>    Function ComActiveMenuBar Returns Variant
15425>>>>>>>>>        Handle hDispatchDriver
15425>>>>>>>>>        Variant retVal
15425>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15426>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
15427>>>>>>>>>        Function_Return retVal
15428>>>>>>>>>    End_Function
15429>>>>>>>>>
15429>>>>>>>>>    Procedure ComGetClientRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
15431>>>>>>>>>        Handle hDispatchDriver
15431>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15432>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
15433>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
15434>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
15435>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
15436>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
15437>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
15438>>>>>>>>>    End_Procedure
15439>>>>>>>>>
15439>>>>>>>>>    Procedure ComRecalcLayout
15441>>>>>>>>>        Handle hDispatchDriver
15441>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15442>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
15443>>>>>>>>>    End_Procedure
15444>>>>>>>>>
15444>>>>>>>>>    Function ComKeyBindings Returns Variant
15446>>>>>>>>>        Handle hDispatchDriver
15446>>>>>>>>>        Variant retVal
15446>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15447>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_DISPATCH to retVal
15448>>>>>>>>>        Function_Return retVal
15449>>>>>>>>>    End_Function
15450>>>>>>>>>
15450>>>>>>>>>    Procedure ComAddIconHandle Integer llIcon Integer llCommand Integer llimageState Boolean llAlpha
15452>>>>>>>>>        Handle hDispatchDriver
15452>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15453>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
15454>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIcon
15455>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
15456>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
15457>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llAlpha
15458>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
15459>>>>>>>>>    End_Procedure
15460>>>>>>>>>
15460>>>>>>>>>    Function ComOptions Returns Variant
15462>>>>>>>>>        Handle hDispatchDriver
15462>>>>>>>>>        Variant retVal
15462>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15463>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
15464>>>>>>>>>        Function_Return retVal
15465>>>>>>>>>    End_Function
15466>>>>>>>>>
15466>>>>>>>>>    Procedure ComSaveCommandBars Variant llRegistryKey Variant llAppName Variant llSection
15468>>>>>>>>>        Handle hDispatchDriver
15468>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15469>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
15470>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRegistryKey
15471>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llAppName
15472>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llSection
15473>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
15474>>>>>>>>>    End_Procedure
15475>>>>>>>>>
15475>>>>>>>>>    Procedure ComLoadCommandBars Variant llRegistryKey Variant llAppName Variant llSection
15477>>>>>>>>>        Handle hDispatchDriver
15477>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15478>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
15479>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRegistryKey
15480>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llAppName
15481>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llSection
15482>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
15483>>>>>>>>>    End_Procedure
15484>>>>>>>>>
15484>>>>>>>>>    Procedure ComLoadDesignerBars Variant llFileNameOrResource Variant llInstance
15486>>>>>>>>>        Handle hDispatchDriver
15486>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15487>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15488>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFileNameOrResource
15489>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llInstance
15490>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
15491>>>>>>>>>    End_Procedure
15492>>>>>>>>>
15492>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
15494>>>>>>>>>        Handle hDispatchDriver
15494>>>>>>>>>        Variant retVal
15494>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15495>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
15496>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
15497>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
15498>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
15499>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
15500>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
15501>>>>>>>>>        Function_Return retVal
15502>>>>>>>>>    End_Function
15503>>>>>>>>>
15503>>>>>>>>>    Procedure ComAboutBox
15505>>>>>>>>>        Handle hDispatchDriver
15505>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15506>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
15507>>>>>>>>>    End_Procedure
15508>>>>>>>>>
15508>>>>>>>>>    Procedure ComDockToolBar Variant llToolBar Integer llx Integer lly XTPBarPosition llPosition
15510>>>>>>>>>        Handle hDispatchDriver
15510>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15511>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
15512>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llToolBar
15513>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
15514>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
15515>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
15516>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
15517>>>>>>>>>    End_Procedure
15518>>>>>>>>>
15518>>>>>>>>>    Function ComGetSpecialColor XTPColorManagerColor llIndex Returns OLE_COLOR
15520>>>>>>>>>        Handle hDispatchDriver
15520>>>>>>>>>        OLE_COLOR retVal
15520>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15521>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15522>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
15523>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 19 OLE_VT_I4 to retVal
15524>>>>>>>>>        Function_Return retVal
15525>>>>>>>>>    End_Function
15526>>>>>>>>>
15526>>>>>>>>>    Function ComShowTabWorkspace Boolean llShow Returns Variant
15528>>>>>>>>>        Handle hDispatchDriver
15528>>>>>>>>>        Variant retVal
15528>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15529>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15530>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llShow
15531>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
15532>>>>>>>>>        Function_Return retVal
15533>>>>>>>>>    End_Function
15534>>>>>>>>>
15534>>>>>>>>>    Procedure ComMoveAlignedControl Variant llControl Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
15536>>>>>>>>>        Handle hDispatchDriver
15536>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15537>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
15538>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llControl
15539>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
15540>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
15541>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
15542>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
15543>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
15544>>>>>>>>>    End_Procedure
15545>>>>>>>>>
15545>>>>>>>>>    Function ComTabWorkspace Returns Variant
15547>>>>>>>>>        Handle hDispatchDriver
15547>>>>>>>>>        Variant retVal
15547>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15548>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 22 OLE_VT_DISPATCH to retVal
15549>>>>>>>>>        Function_Return retVal
15550>>>>>>>>>    End_Function
15551>>>>>>>>>
15551>>>>>>>>>    Procedure ComLoadStateFromString String llProfile Boolean llRestoreControls Boolean llRestoreOptions Boolean llSilent
15553>>>>>>>>>        Handle hDispatchDriver
15553>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15554>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
15555>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
15556>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRestoreControls
15557>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRestoreOptions
15558>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSilent
15559>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
15560>>>>>>>>>    End_Procedure
15561>>>>>>>>>
15561>>>>>>>>>    Function ComSaveStateToString Boolean llSaveControls Boolean llSaveOnlyCustomized Boolean llSaveOptions Returns String
15563>>>>>>>>>        Handle hDispatchDriver
15563>>>>>>>>>        String retVal
15563>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15564>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
15565>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveControls
15566>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveOnlyCustomized
15567>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveOptions
15568>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 24 OLE_VT_BSTR to retVal
15569>>>>>>>>>        Function_Return retVal
15570>>>>>>>>>    End_Function
15571>>>>>>>>>
15571>>>>>>>>>    Function ComStatusBar Returns Variant
15573>>>>>>>>>        Handle hDispatchDriver
15573>>>>>>>>>        Variant retVal
15573>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15574>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 25 OLE_VT_DISPATCH to retVal
15575>>>>>>>>>        Function_Return retVal
15576>>>>>>>>>    End_Function
15577>>>>>>>>>
15577>>>>>>>>>    Function ComMessageBar Returns Variant
15579>>>>>>>>>        Handle hDispatchDriver
15579>>>>>>>>>        Variant retVal
15579>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15580>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 28 OLE_VT_DISPATCH to retVal
15581>>>>>>>>>        Function_Return retVal
15582>>>>>>>>>    End_Function
15583>>>>>>>>>
15583>>>>>>>>>    Procedure ComEnableCustomization Boolean llEnable
15585>>>>>>>>>        Handle hDispatchDriver
15585>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15586>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15587>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
15588>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 26 OLE_VT_VOID
15589>>>>>>>>>    End_Procedure
15590>>>>>>>>>
15590>>>>>>>>>    Function ComDesignerControls Returns Variant
15592>>>>>>>>>        Handle hDispatchDriver
15592>>>>>>>>>        Variant retVal
15592>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15593>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 27 OLE_VT_DISPATCH to retVal
15594>>>>>>>>>        Function_Return retVal
15595>>>>>>>>>    End_Function
15596>>>>>>>>>
15596>>>>>>>>>    Procedure ComEnableDefaultResetCustomizedToolbarChoice Boolean llEnable Boolean llDefaultYes
15598>>>>>>>>>        Handle hDispatchDriver
15598>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15599>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15600>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
15601>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llDefaultYes
15602>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 72 OLE_VT_VOID
15603>>>>>>>>>    End_Procedure
15604>>>>>>>>>
15604>>>>>>>>>    Function ComGetDispatch Returns Variant
15606>>>>>>>>>        Handle hDispatchDriver
15606>>>>>>>>>        Variant retVal
15606>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15607>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 31 OLE_VT_DISPATCH to retVal
15608>>>>>>>>>        Function_Return retVal
15609>>>>>>>>>    End_Function
15610>>>>>>>>>
15610>>>>>>>>>    Procedure ComSetMDIClient OLE_HANDLE llhWnd
15612>>>>>>>>>        Handle hDispatchDriver
15612>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15613>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15614>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15615>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
15616>>>>>>>>>    End_Procedure
15617>>>>>>>>>
15617>>>>>>>>>    Function ComGlobalSettings Returns Variant
15619>>>>>>>>>        Handle hDispatchDriver
15619>>>>>>>>>        Variant retVal
15619>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15620>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_DISPATCH to retVal
15621>>>>>>>>>        Function_Return retVal
15622>>>>>>>>>    End_Function
15623>>>>>>>>>
15623>>>>>>>>>    Procedure ComClosePopups
15625>>>>>>>>>        Handle hDispatchDriver
15625>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15626>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 34 OLE_VT_VOID
15627>>>>>>>>>    End_Procedure
15628>>>>>>>>>
15628>>>>>>>>>    Procedure ComSetSpecialColor XTPColorManagerColor llIndex OLE_COLOR llColor
15630>>>>>>>>>        Handle hDispatchDriver
15630>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15631>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15632>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
15633>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
15634>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
15635>>>>>>>>>    End_Procedure
15636>>>>>>>>>
15636>>>>>>>>>    Function ComAddDialogBar String llName XTPBarPosition llPosition Returns Variant
15638>>>>>>>>>        Handle hDispatchDriver
15638>>>>>>>>>        Variant retVal
15638>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15639>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15640>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15641>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
15642>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 36 OLE_VT_DISPATCH to retVal
15643>>>>>>>>>        Function_Return retVal
15644>>>>>>>>>    End_Function
15645>>>>>>>>>
15645>>>>>>>>>    Procedure ComLoadStateFromXMLString String llProfile String llstate Variant llOptions
15647>>>>>>>>>        Handle hDispatchDriver
15647>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15648>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
15649>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
15650>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstate
15651>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
15652>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
15653>>>>>>>>>    End_Procedure
15654>>>>>>>>>
15654>>>>>>>>>    Function ComSaveStateToXMLString String llProfile Variant llOptions Returns String
15656>>>>>>>>>        Handle hDispatchDriver
15656>>>>>>>>>        String retVal
15656>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15657>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15658>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
15659>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
15660>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 38 OLE_VT_BSTR to retVal
15661>>>>>>>>>        Function_Return retVal
15662>>>>>>>>>    End_Function
15663>>>>>>>>>
15663>>>>>>>>>    Function ComCreateStateOptions Returns Variant
15665>>>>>>>>>        Handle hDispatchDriver
15665>>>>>>>>>        Variant retVal
15665>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15666>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 39 OLE_VT_DISPATCH to retVal
15667>>>>>>>>>        Function_Return retVal
15668>>>>>>>>>    End_Function
15669>>>>>>>>>
15669>>>>>>>>>    Procedure ComDoPropExchange Variant llpPX Variant llOptions
15671>>>>>>>>>        Handle hDispatchDriver
15671>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15672>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
15673>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llpPX
15674>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
15675>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 45 OLE_VT_VOID
15676>>>>>>>>>    End_Procedure
15677>>>>>>>>>
15677>>>>>>>>>    Function ComCustomizedControl Returns Variant
15679>>>>>>>>>        Handle hDispatchDriver
15679>>>>>>>>>        Variant retVal
15679>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15680>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 40 OLE_VT_DISPATCH to retVal
15681>>>>>>>>>        Function_Return retVal
15682>>>>>>>>>    End_Function
15683>>>>>>>>>
15683>>>>>>>>>    // Deletes all of the toolbars
15683>>>>>>>>>    Procedure ComDeleteAll
15685>>>>>>>>>        Handle hDispatchDriver
15685>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15686>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 41 OLE_VT_VOID
15687>>>>>>>>>    End_Procedure
15688>>>>>>>>>
15688>>>>>>>>>    Function ComToolTipContext Returns Variant
15690>>>>>>>>>        Handle hDispatchDriver
15690>>>>>>>>>        Variant retVal
15690>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15691>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 42 OLE_VT_DISPATCH to retVal
15692>>>>>>>>>        Function_Return retVal
15693>>>>>>>>>    End_Function
15694>>>>>>>>>
15694>>>>>>>>>    Function ComTrackingMode Returns Boolean
15696>>>>>>>>>        Handle hDispatchDriver
15696>>>>>>>>>        Boolean retVal
15696>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15697>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 43 OLE_VT_BOOL to retVal
15698>>>>>>>>>        Function_Return retVal
15699>>>>>>>>>    End_Function
15700>>>>>>>>>
15700>>>>>>>>>    Function ComFocusedCommandBar Returns Variant
15702>>>>>>>>>        Handle hDispatchDriver
15702>>>>>>>>>        Variant retVal
15702>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15703>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 44 OLE_VT_DISPATCH to retVal
15704>>>>>>>>>        Function_Return retVal
15705>>>>>>>>>    End_Function
15706>>>>>>>>>
15706>>>>>>>>>    Function ComAddMenuBar String llName Returns Variant
15708>>>>>>>>>        Handle hDispatchDriver
15708>>>>>>>>>        Variant retVal
15708>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15709>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15710>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15711>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 47 OLE_VT_DISPATCH to retVal
15712>>>>>>>>>        Function_Return retVal
15713>>>>>>>>>    End_Function
15714>>>>>>>>>
15714>>>>>>>>>    Function ComAddTabToolBar String llName Returns Variant
15716>>>>>>>>>        Handle hDispatchDriver
15716>>>>>>>>>        Variant retVal
15716>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15717>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15718>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15719>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 48 OLE_VT_DISPATCH to retVal
15720>>>>>>>>>        Function_Return retVal
15721>>>>>>>>>    End_Function
15722>>>>>>>>>
15722>>>>>>>>>    Function ComAddRibbonBar String llName Returns Variant
15724>>>>>>>>>        Handle hDispatchDriver
15724>>>>>>>>>        Variant retVal
15724>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15725>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15726>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15727>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 49 OLE_VT_DISPATCH to retVal
15728>>>>>>>>>        Function_Return retVal
15729>>>>>>>>>    End_Function
15730>>>>>>>>>
15730>>>>>>>>>    Procedure ComAttachToWindow OLE_HANDLE llhWnd
15732>>>>>>>>>        Handle hDispatchDriver
15732>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15733>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15734>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15735>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 50 OLE_VT_VOID
15736>>>>>>>>>    End_Procedure
15737>>>>>>>>>
15737>>>>>>>>>    Procedure ComShowCustomizeDialog Integer llActiveTab
15739>>>>>>>>>        Handle hDispatchDriver
15739>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15740>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15741>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llActiveTab
15742>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 51 OLE_VT_VOID
15743>>>>>>>>>    End_Procedure
15744>>>>>>>>>
15744>>>>>>>>>    Procedure ComEnableOffice2007Frame Boolean llEnable
15746>>>>>>>>>        Handle hDispatchDriver
15746>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15747>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15748>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
15749>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 52 OLE_VT_VOID
15750>>>>>>>>>    End_Procedure
15751>>>>>>>>>
15751>>>>>>>>>    Procedure ComEnableActions
15753>>>>>>>>>        Handle hDispatchDriver
15753>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15754>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 53 OLE_VT_VOID
15755>>>>>>>>>    End_Procedure
15756>>>>>>>>>
15756>>>>>>>>>    Function ComActions Returns Variant
15758>>>>>>>>>        Handle hDispatchDriver
15758>>>>>>>>>        Variant retVal
15758>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15759>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 54 OLE_VT_DISPATCH to retVal
15760>>>>>>>>>        Function_Return retVal
15761>>>>>>>>>    End_Function
15762>>>>>>>>>
15762>>>>>>>>>    Function ComPaintManager Returns Variant
15764>>>>>>>>>        Handle hDispatchDriver
15764>>>>>>>>>        Variant retVal
15764>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15765>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 55 OLE_VT_DISPATCH to retVal
15766>>>>>>>>>        Function_Return retVal
15767>>>>>>>>>    End_Function
15768>>>>>>>>>
15768>>>>>>>>>    Function ComCreateGalleryItems Integer llId Returns Variant
15770>>>>>>>>>        Handle hDispatchDriver
15770>>>>>>>>>        Variant retVal
15770>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15771>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15772>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
15773>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 56 OLE_VT_DISPATCH to retVal
15774>>>>>>>>>        Function_Return retVal
15775>>>>>>>>>    End_Function
15776>>>>>>>>>
15776>>>>>>>>>    Procedure ComEnableOffice2007FrameHandle OLE_HANDLE llhWnd
15778>>>>>>>>>        Handle hDispatchDriver
15778>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15779>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15780>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15781>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 57 OLE_VT_VOID
15782>>>>>>>>>    End_Procedure
15783>>>>>>>>>
15783>>>>>>>>>    Function ComCreateCommandBarControl String llClassName Returns Variant
15785>>>>>>>>>        Handle hDispatchDriver
15785>>>>>>>>>        Variant retVal
15785>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15786>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15787>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
15788>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 58 OLE_VT_DISPATCH to retVal
15789>>>>>>>>>        Function_Return retVal
15790>>>>>>>>>    End_Function
15791>>>>>>>>>
15791>>>>>>>>>    Function ComCreateCommandBar String llClassName Returns Variant
15793>>>>>>>>>        Handle hDispatchDriver
15793>>>>>>>>>        Variant retVal
15793>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15794>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15795>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
15796>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 59 OLE_VT_DISPATCH to retVal
15797>>>>>>>>>        Function_Return retVal
15798>>>>>>>>>    End_Function
15799>>>>>>>>>
15799>>>>>>>>>    Function ComContextHelp Returns Integer
15801>>>>>>>>>        Handle hDispatchDriver
15801>>>>>>>>>        Integer retVal
15801>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15802>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 60 OLE_VT_I4 to retVal
15803>>>>>>>>>        Function_Return retVal
15804>>>>>>>>>    End_Function
15805>>>>>>>>>
15805>>>>>>>>>    Function ComContextMenus Returns Variant
15807>>>>>>>>>        Handle hDispatchDriver
15807>>>>>>>>>        Variant retVal
15807>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15808>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 61 OLE_VT_DISPATCH to retVal
15809>>>>>>>>>        Function_Return retVal
15810>>>>>>>>>    End_Function
15811>>>>>>>>>
15811>>>>>>>>>    Procedure ComOLEDrag
15813>>>>>>>>>        Handle hDispatchDriver
15813>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15814>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 62 OLE_VT_VOID
15815>>>>>>>>>    End_Procedure
15816>>>>>>>>>
15816>>>>>>>>>    Function ComAddMiniToolBar String llName Returns Variant
15818>>>>>>>>>        Handle hDispatchDriver
15818>>>>>>>>>        Variant retVal
15818>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15819>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15820>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15821>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 63 OLE_VT_DISPATCH to retVal
15822>>>>>>>>>        Function_Return retVal
15823>>>>>>>>>    End_Function
15824>>>>>>>>>
15824>>>>>>>>>    Function ComRecentFileList Returns Variant
15826>>>>>>>>>        Handle hDispatchDriver
15826>>>>>>>>>        Variant retVal
15826>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15827>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 64 OLE_VT_DISPATCH to retVal
15828>>>>>>>>>        Function_Return retVal
15829>>>>>>>>>    End_Function
15830>>>>>>>>>
15830>>>>>>>>>    Procedure ComDisableOffice2007FrameHandle OLE_HANDLE llhWnd
15832>>>>>>>>>        Handle hDispatchDriver
15832>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15833>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15834>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
15835>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 65 OLE_VT_VOID
15836>>>>>>>>>    End_Procedure
15837>>>>>>>>>
15837>>>>>>>>>    Procedure ComAddCustomBar Variant llCommandBar String llName XTPBarPosition llPosition
15839>>>>>>>>>        Handle hDispatchDriver
15839>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15840>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
15841>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llCommandBar
15842>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
15843>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
15844>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 66 OLE_VT_VOID
15845>>>>>>>>>    End_Procedure
15846>>>>>>>>>
15846>>>>>>>>>    Procedure ComEnableToolbarComposition Boolean llEnable
15848>>>>>>>>>        Handle hDispatchDriver
15848>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15849>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15850>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
15851>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 67 OLE_VT_VOID
15852>>>>>>>>>    End_Procedure
15853>>>>>>>>>
15853>>>>>>>>>    Procedure ComSetAllCaps Boolean llSetAllCaps
15855>>>>>>>>>        Handle hDispatchDriver
15855>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15856>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15857>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSetAllCaps
15858>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 68 OLE_VT_VOID
15859>>>>>>>>>    End_Procedure
15860>>>>>>>>>
15860>>>>>>>>>    Procedure ComAllowFrameTransparency Boolean llSetAllowTransparency
15862>>>>>>>>>        Handle hDispatchDriver
15862>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15863>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15864>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSetAllowTransparency
15865>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 70 OLE_VT_VOID
15866>>>>>>>>>    End_Procedure
15867>>>>>>>>>
15867>>>>>>>>>    Function ComSetOfficeSetBackImage XTPBackImage llBackImage Returns Boolean
15869>>>>>>>>>        Handle hDispatchDriver
15869>>>>>>>>>        Boolean retVal
15869>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
15870>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
15871>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBackImage
15872>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 80 OLE_VT_BOOL to retVal
15873>>>>>>>>>        Function_Return retVal
15874>>>>>>>>>    End_Function
15875>>>>>>>>>End_Class
15876>>>>>>>>>
15876>>>>>>>>>// CLSID: {151FF694-1D1A-4AFA-8DFF-8798A2181226}
15876>>>>>>>>>// Event interface for CommandBars Control
15876>>>>>>>>>Class cCJ_DCommandBarsEvents is a Mixin
15877>>>>>>>>>
15877>>>>>>>>>    Procedure OnComExecute Variant llControl
15879>>>>>>>>>    End_Procedure
15880>>>>>>>>>
15880>>>>>>>>>//    { MethodType=Event }
15880>>>>>>>>>//    Procedure OnComUpdate Variant llControl
15880>>>>>>>>>//    End_Procedure
15880>>>>>>>>>
15880>>>>>>>>>    Procedure OnComResize
15882>>>>>>>>>    End_Procedure
15883>>>>>>>>>
15883>>>>>>>>>    Procedure OnComGetClientBordersWidth Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
15885>>>>>>>>>    End_Procedure
15886>>>>>>>>>
15886>>>>>>>>>    Procedure OnComControlSelected Variant llControl
15888>>>>>>>>>    End_Procedure
15889>>>>>>>>>
15889>>>>>>>>>    Procedure OnComInitCommandsPopup Variant llCommandBar
15891>>>>>>>>>    End_Procedure
15892>>>>>>>>>
15892>>>>>>>>>    Procedure OnComResizeClient Integer llLeft Integer llTop Integer llRight Integer llBottom
15894>>>>>>>>>    End_Procedure
15895>>>>>>>>>
15895>>>>>>>>>    Procedure OnComSpecialColorChanged
15897>>>>>>>>>    End_Procedure
15898>>>>>>>>>
15898>>>>>>>>>    Procedure OnComRepositionAlignedControls Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
15900>>>>>>>>>    End_Procedure
15901>>>>>>>>>
15901>>>>>>>>>    Procedure OnComCustomization Variant llOptions
15903>>>>>>>>>    End_Procedure
15904>>>>>>>>>
15904>>>>>>>>>    Procedure OnComToolBarVisibleChanged Variant llToolBar
15906>>>>>>>>>    End_Procedure
15907>>>>>>>>>
15907>>>>>>>>>    Procedure OnComControlRButtonUp Variant llControl
15909>>>>>>>>>    End_Procedure
15910>>>>>>>>>
15910>>>>>>>>>    Procedure OnComCustomizationDone
15912>>>>>>>>>    End_Procedure
15913>>>>>>>>>
15913>>>>>>>>>    Procedure OnComCommandBarKeyDown Variant llCommandBar Integer ByRef llKeyCode Short llShift
15915>>>>>>>>>    End_Procedure
15916>>>>>>>>>
15916>>>>>>>>>    Procedure OnComToolBarContextMenu Variant llToolBar Variant llContextMenu
15918>>>>>>>>>    End_Procedure
15919>>>>>>>>>
15919>>>>>>>>>    Procedure OnComTrackingModeChanged Variant llCommandBar Boolean llMode
15921>>>>>>>>>    End_Procedure
15922>>>>>>>>>
15922>>>>>>>>>    Procedure OnComCustomizationResetToolBar Variant llToolBar
15924>>>>>>>>>    End_Procedure
15925>>>>>>>>>
15925>>>>>>>>>    Procedure OnComCustomizationAddToolBar Variant llToolBar
15927>>>>>>>>>    End_Procedure
15928>>>>>>>>>
15928>>>>>>>>>    Procedure OnComCustomizationDeleteToolBar Variant llToolBar
15930>>>>>>>>>    End_Procedure
15931>>>>>>>>>
15931>>>>>>>>>    Procedure OnComControlNotify Variant llControl Integer llCode Variant llNotifyData Variant llHandled
15933>>>>>>>>>    End_Procedure
15934>>>>>>>>>
15934>>>>>>>>>    Procedure OnComGetActiveDocumentID Integer ByRef llId
15936>>>>>>>>>    End_Procedure
15937>>>>>>>>>
15937>>>>>>>>>    Procedure OnComCustomizationResetAll
15939>>>>>>>>>    End_Procedure
15940>>>>>>>>>
15940>>>>>>>>>    Procedure OnComMessageBarClosed Variant llMessageBar
15942>>>>>>>>>    End_Procedure
15943>>>>>>>>>
15943>>>>>>>>>    Procedure OnComOLEStartDrag Variant llData Integer ByRef llAllowedEffects
15945>>>>>>>>>    End_Procedure
15946>>>>>>>>>
15946>>>>>>>>>    Procedure OnComOLECompleteDrag Integer ByRef llEffect
15948>>>>>>>>>    End_Procedure
15949>>>>>>>>>
15949>>>>>>>>>    Procedure OnComReCreated
15951>>>>>>>>>    End_Procedure
15952>>>>>>>>>
15952>>>>>>>>>    Procedure RegisterComEvents
15954>>>>>>>>>        Send RegisterComEvent 1 msg_OnComExecute
15955>>>>>>>>>//        Send RegisterComEvent 2 msg_OnComUpdate
15955>>>>>>>>>        Send RegisterComEvent 3 msg_OnComResize
15956>>>>>>>>>        Send RegisterComEvent 4 msg_OnComGetClientBordersWidth
15957>>>>>>>>>        Send RegisterComEvent 5 msg_OnComControlSelected
15958>>>>>>>>>        Send RegisterComEvent 6 msg_OnComInitCommandsPopup
15959>>>>>>>>>        Send RegisterComEvent 7 msg_OnComResizeClient
15960>>>>>>>>>        Send RegisterComEvent 8 msg_OnComSpecialColorChanged
15961>>>>>>>>>        Send RegisterComEvent 9 msg_OnComRepositionAlignedControls
15962>>>>>>>>>        Send RegisterComEvent 10 msg_OnComCustomization
15963>>>>>>>>>        Send RegisterComEvent 11 msg_OnComToolBarVisibleChanged
15964>>>>>>>>>        Send RegisterComEvent 12 msg_OnComControlRButtonUp
15965>>>>>>>>>        Send RegisterComEvent 13 msg_OnComCustomizationDone
15966>>>>>>>>>        Send RegisterComEvent -602 msg_OnComCommandBarKeyDown
15967>>>>>>>>>        Send RegisterComEvent 14 msg_OnComToolBarContextMenu
15968>>>>>>>>>        Send RegisterComEvent 15 msg_OnComTrackingModeChanged
15969>>>>>>>>>        Send RegisterComEvent 16 msg_OnComCustomizationResetToolBar
15970>>>>>>>>>        Send RegisterComEvent 17 msg_OnComCustomizationAddToolBar
15971>>>>>>>>>        Send RegisterComEvent 18 msg_OnComCustomizationDeleteToolBar
15972>>>>>>>>>        Send RegisterComEvent 19 msg_OnComControlNotify
15973>>>>>>>>>        Send RegisterComEvent 20 msg_OnComGetActiveDocumentID
15974>>>>>>>>>        Send RegisterComEvent 21 msg_OnComCustomizationResetAll
15975>>>>>>>>>        Send RegisterComEvent 22 msg_OnComMessageBarClosed
15976>>>>>>>>>        Send RegisterComEvent 303 msg_OnComOLEStartDrag
15977>>>>>>>>>        Send RegisterComEvent 304 msg_OnComOLECompleteDrag
15978>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
15979>>>>>>>>>    End_Procedure
15980>>>>>>>>>End_Class
15981>>>>>>>>>
15981>>>>>>>>>// CoClass
15981>>>>>>>>>// ProgID: Codejock.CommandBars.17.3.0
15981>>>>>>>>>// CLSID: {83D1DD5A-1EB5-4273-92F8-60E5FA3569D0}
15981>>>>>>>>>// Xtreme CommandBars Control
15981>>>>>>>>>Class cCJCommandBars is a cComActiveXControl
15982>>>>>>>>>    Import_Class_Protocol cCJ_DCommandBars
15983>>>>>>>>>    Import_Class_Protocol cCJ_DCommandBarsEvents
15984>>>>>>>>>
15984>>>>>>>>>    Procedure Construct_Object
15986>>>>>>>>>        Forward Send Construct_Object
15988>>>>>>>>>        Set psProgID to "{83D1DD5A-1EB5-4273-92F8-60E5FA3569D0}"
15989>>>>>>>>>        Set psEventId to "{151FF694-1D1A-4AFA-8DFF-8798A2181226}"
15990>>>>>>>>>        Set psLicenseKey to ("CommandBars Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.CommandBars.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: QQS-PNF-OJV-VBX")
15991>>>>>>>>>        Set peAutoCreate to acAutoCreate
15992>>>>>>>>>    End_Procedure
15993>>>>>>>>>End_Class
15994>>>>>>>>>
15994>>>>>>>>>// CLSID: {A77113E7-46A4-4F99-83D8-C6D3C2B390FC}
15994>>>>>>>>>Class cCJIRibbonGroup is a Mixin
15995>>>>>>>>>
15995>>>>>>>>>    Function ComCaption Returns String
15997>>>>>>>>>        String retVal
15997>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BSTR to retVal
15998>>>>>>>>>        Function_Return retVal
15999>>>>>>>>>    End_Function
16000>>>>>>>>>
16000>>>>>>>>>    Procedure Set ComCaption String value
16002>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BSTR to value
16003>>>>>>>>>    End_Procedure
16004>>>>>>>>>
16004>>>>>>>>>    Function ComShowOptionButton Returns Boolean
16006>>>>>>>>>        Boolean retVal
16006>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
16007>>>>>>>>>        Function_Return retVal
16008>>>>>>>>>    End_Function
16009>>>>>>>>>
16009>>>>>>>>>    Procedure Set ComShowOptionButton Boolean value
16011>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
16012>>>>>>>>>    End_Procedure
16013>>>>>>>>>
16013>>>>>>>>>    Function ComId Returns Integer
16015>>>>>>>>>        Integer retVal
16015>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to retVal
16016>>>>>>>>>        Function_Return retVal
16017>>>>>>>>>    End_Function
16018>>>>>>>>>
16018>>>>>>>>>    Procedure Set ComId Integer value
16020>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to value
16021>>>>>>>>>    End_Procedure
16022>>>>>>>>>
16022>>>>>>>>>    Function ComIconId Returns Integer
16024>>>>>>>>>        Integer retVal
16024>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to retVal
16025>>>>>>>>>        Function_Return retVal
16026>>>>>>>>>    End_Function
16027>>>>>>>>>
16027>>>>>>>>>    Procedure Set ComIconId Integer value
16029>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to value
16030>>>>>>>>>    End_Procedure
16031>>>>>>>>>
16031>>>>>>>>>    Function ComVisible Returns Boolean
16033>>>>>>>>>        Boolean retVal
16033>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
16034>>>>>>>>>        Function_Return retVal
16035>>>>>>>>>    End_Function
16036>>>>>>>>>
16036>>>>>>>>>    Procedure Set ComVisible Boolean value
16038>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
16039>>>>>>>>>    End_Procedure
16040>>>>>>>>>
16040>>>>>>>>>    Function ComControlsGrouping Returns Boolean
16042>>>>>>>>>        Boolean retVal
16042>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to retVal
16043>>>>>>>>>        Function_Return retVal
16044>>>>>>>>>    End_Function
16045>>>>>>>>>
16045>>>>>>>>>    Procedure Set ComControlsGrouping Boolean value
16047>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to value
16048>>>>>>>>>    End_Procedure
16049>>>>>>>>>
16049>>>>>>>>>    Function ComControlsCentering Returns Boolean
16051>>>>>>>>>        Boolean retVal
16051>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
16052>>>>>>>>>        Function_Return retVal
16053>>>>>>>>>    End_Function
16054>>>>>>>>>
16054>>>>>>>>>    Procedure Set ComControlsCentering Boolean value
16056>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
16057>>>>>>>>>    End_Procedure
16058>>>>>>>>>
16058>>>>>>>>>    Function ComAllowReduce Returns Integer
16060>>>>>>>>>        Integer retVal
16060>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to retVal
16061>>>>>>>>>        Function_Return retVal
16062>>>>>>>>>    End_Function
16063>>>>>>>>>
16063>>>>>>>>>    Procedure Set ComAllowReduce Integer value
16065>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to value
16066>>>>>>>>>    End_Procedure
16067>>>>>>>>>
16067>>>>>>>>>    Function ComAutoArrangeEditCaption Returns Boolean
16069>>>>>>>>>        Boolean retVal
16069>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
16070>>>>>>>>>        Function_Return retVal
16071>>>>>>>>>    End_Function
16072>>>>>>>>>
16072>>>>>>>>>    Procedure Set ComAutoArrangeEditCaption Boolean value
16074>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
16075>>>>>>>>>    End_Procedure
16076>>>>>>>>>
16076>>>>>>>>>    Function ComRibbonBar Returns Variant
16078>>>>>>>>>        Handle hDispatchDriver
16078>>>>>>>>>        Variant retVal
16078>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16079>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_DISPATCH to retVal
16080>>>>>>>>>        Function_Return retVal
16081>>>>>>>>>    End_Function
16082>>>>>>>>>
16082>>>>>>>>>    Function ComGroups Returns Variant
16084>>>>>>>>>        Handle hDispatchDriver
16084>>>>>>>>>        Variant retVal
16084>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16085>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_DISPATCH to retVal
16086>>>>>>>>>        Function_Return retVal
16087>>>>>>>>>    End_Function
16088>>>>>>>>>
16088>>>>>>>>>    // Gets the number of controls in the collection.
16088>>>>>>>>>    Function ComCount Returns Integer
16090>>>>>>>>>        Handle hDispatchDriver
16090>>>>>>>>>        Integer retVal
16090>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16091>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
16092>>>>>>>>>        Function_Return retVal
16093>>>>>>>>>    End_Function
16094>>>>>>>>>
16094>>>>>>>>>    // Gets an item from the collection by its index.
16094>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
16096>>>>>>>>>        Handle hDispatchDriver
16096>>>>>>>>>        Variant retVal
16096>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16097>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
16098>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
16099>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
16100>>>>>>>>>        Function_Return retVal
16101>>>>>>>>>    End_Function
16102>>>>>>>>>
16102>>>>>>>>>    Function Com_NewEnum Returns Variant
16104>>>>>>>>>        Handle hDispatchDriver
16104>>>>>>>>>        Variant retVal
16104>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16105>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
16106>>>>>>>>>        Function_Return retVal
16107>>>>>>>>>    End_Function
16108>>>>>>>>>
16108>>>>>>>>>    // Adds a new command bar control to the collection.
16108>>>>>>>>>    Function ComAdd XTPControlType llType Integer llId String llCaption Variant llBefore Variant llTemporary Returns Variant
16110>>>>>>>>>        Handle hDispatchDriver
16110>>>>>>>>>        Variant retVal
16110>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16111>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
16112>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llType
16113>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
16114>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
16115>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
16116>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llTemporary
16117>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
16118>>>>>>>>>        Function_Return retVal
16119>>>>>>>>>    End_Function
16120>>>>>>>>>
16120>>>>>>>>>    // Deletes all of the command bar controls from the collection
16120>>>>>>>>>    Procedure ComDeleteAll
16122>>>>>>>>>        Handle hDispatchDriver
16122>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16123>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
16124>>>>>>>>>    End_Procedure
16125>>>>>>>>>
16125>>>>>>>>>    Procedure ComDeleteAt Integer llIndex
16127>>>>>>>>>        Handle hDispatchDriver
16127>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16128>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
16129>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
16130>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
16131>>>>>>>>>    End_Procedure
16132>>>>>>>>>
16132>>>>>>>>>    Function ComControlGroupPopup Returns Variant
16134>>>>>>>>>        Handle hDispatchDriver
16134>>>>>>>>>        Variant retVal
16134>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16135>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 102 OLE_VT_DISPATCH to retVal
16136>>>>>>>>>        Function_Return retVal
16137>>>>>>>>>    End_Function
16138>>>>>>>>>
16138>>>>>>>>>    Function ComControlGroupOption Returns Variant
16140>>>>>>>>>        Handle hDispatchDriver
16140>>>>>>>>>        Variant retVal
16140>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16141>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 103 OLE_VT_DISPATCH to retVal
16142>>>>>>>>>        Function_Return retVal
16143>>>>>>>>>    End_Function
16144>>>>>>>>>
16144>>>>>>>>>    Function ComIndex Returns Integer
16146>>>>>>>>>        Handle hDispatchDriver
16146>>>>>>>>>        Integer retVal
16146>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16147>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 104 OLE_VT_I4 to retVal
16148>>>>>>>>>        Function_Return retVal
16149>>>>>>>>>    End_Function
16150>>>>>>>>>
16150>>>>>>>>>    Procedure ComAddControl Variant llControl Variant llBefore
16152>>>>>>>>>        Handle hDispatchDriver
16152>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16153>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
16154>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llControl
16155>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
16156>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 108 OLE_VT_VOID
16157>>>>>>>>>    End_Procedure
16158>>>>>>>>>
16158>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
16160>>>>>>>>>        Handle hDispatchDriver
16160>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16161>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
16162>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
16163>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
16164>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
16165>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
16166>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 110 OLE_VT_VOID
16167>>>>>>>>>    End_Procedure
16168>>>>>>>>>End_Class
16169>>>>>>>>>
16169>>>>>>>>>// CoClass
16169>>>>>>>>>// CLSID: {A771E32A-73F4-4849-A08C-8A64228AA2E3}
16169>>>>>>>>>Class cCJRibbonGroup is a cComAutomationObject
16170>>>>>>>>>    Import_Class_Protocol cCJIRibbonGroup
16171>>>>>>>>>
16171>>>>>>>>>    Procedure Construct_Object
16173>>>>>>>>>        Forward Send Construct_Object
16175>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16176>>>>>>>>>    End_Procedure
16177>>>>>>>>>End_Class
16178>>>>>>>>>
16178>>>>>>>>>// CLSID: {D517ECE6-65A8-4857-8DBD-FDE6CDA60B00}
16178>>>>>>>>>Class cCJICustomizeOptions is a Mixin
16179>>>>>>>>>
16179>>>>>>>>>    Function ComShowKeyboardPage Returns Boolean
16181>>>>>>>>>        Boolean retVal
16181>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
16182>>>>>>>>>        Function_Return retVal
16183>>>>>>>>>    End_Function
16184>>>>>>>>>
16184>>>>>>>>>    Procedure Set ComShowKeyboardPage Boolean value
16186>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
16187>>>>>>>>>    End_Procedure
16188>>>>>>>>>
16188>>>>>>>>>    Function ComShowOptionsPage Returns Boolean
16190>>>>>>>>>        Boolean retVal
16190>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
16191>>>>>>>>>        Function_Return retVal
16192>>>>>>>>>    End_Function
16193>>>>>>>>>
16193>>>>>>>>>    Procedure Set ComShowOptionsPage Boolean value
16195>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
16196>>>>>>>>>    End_Procedure
16197>>>>>>>>>
16197>>>>>>>>>    Function ComShowRibbonQuickAccessPage Returns Boolean
16199>>>>>>>>>        Boolean retVal
16199>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
16200>>>>>>>>>        Function_Return retVal
16201>>>>>>>>>    End_Function
16202>>>>>>>>>
16202>>>>>>>>>    Procedure Set ComShowRibbonQuickAccessPage Boolean value
16204>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
16205>>>>>>>>>    End_Procedure
16206>>>>>>>>>
16206>>>>>>>>>    Function ComShowMenusPage Returns Boolean
16208>>>>>>>>>        Boolean retVal
16208>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
16209>>>>>>>>>        Function_Return retVal
16210>>>>>>>>>    End_Function
16211>>>>>>>>>
16211>>>>>>>>>    Procedure Set ComShowMenusPage Boolean value
16213>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
16214>>>>>>>>>    End_Procedure
16215>>>>>>>>>
16215>>>>>>>>>    Function ComShowToolbarsPage Returns Boolean
16217>>>>>>>>>        Boolean retVal
16217>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
16218>>>>>>>>>        Function_Return retVal
16219>>>>>>>>>    End_Function
16220>>>>>>>>>
16220>>>>>>>>>    Procedure Set ComShowToolbarsPage Boolean value
16222>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
16223>>>>>>>>>    End_Procedure
16224>>>>>>>>>
16224>>>>>>>>>    Function ComShowCommandsPage Returns Boolean
16226>>>>>>>>>        Boolean retVal
16226>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
16227>>>>>>>>>        Function_Return retVal
16228>>>>>>>>>    End_Function
16229>>>>>>>>>
16229>>>>>>>>>    Procedure Set ComShowCommandsPage Boolean value
16231>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
16232>>>>>>>>>    End_Procedure
16233>>>>>>>>>
16233>>>>>>>>>    Function ComAllowNewToolbars Returns Boolean
16235>>>>>>>>>        Boolean retVal
16235>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
16236>>>>>>>>>        Function_Return retVal
16237>>>>>>>>>    End_Function
16238>>>>>>>>>
16238>>>>>>>>>    Procedure Set ComAllowNewToolbars Boolean value
16240>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
16241>>>>>>>>>    End_Procedure
16242>>>>>>>>>
16242>>>>>>>>>    Function ComResizableSheet Returns Boolean
16244>>>>>>>>>        Boolean retVal
16244>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
16245>>>>>>>>>        Function_Return retVal
16246>>>>>>>>>    End_Function
16247>>>>>>>>>
16247>>>>>>>>>    Procedure Set ComResizableSheet Boolean value
16249>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
16250>>>>>>>>>    End_Procedure
16251>>>>>>>>>
16251>>>>>>>>>    Function ComShowRibbonCustomizePage Returns Boolean
16253>>>>>>>>>        Boolean retVal
16253>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to retVal
16254>>>>>>>>>        Function_Return retVal
16255>>>>>>>>>    End_Function
16256>>>>>>>>>
16256>>>>>>>>>    Procedure Set ComShowRibbonCustomizePage Boolean value
16258>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to value
16259>>>>>>>>>    End_Procedure
16260>>>>>>>>>
16260>>>>>>>>>    Function ComShowListNavigation Returns Boolean
16262>>>>>>>>>        Boolean retVal
16262>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
16263>>>>>>>>>        Function_Return retVal
16264>>>>>>>>>    End_Function
16265>>>>>>>>>
16265>>>>>>>>>    Procedure Set ComShowListNavigation Boolean value
16267>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
16268>>>>>>>>>    End_Procedure
16269>>>>>>>>>
16269>>>>>>>>>    Function ComCustomIcons Returns Variant
16271>>>>>>>>>        Handle hDispatchDriver
16271>>>>>>>>>        Variant retVal
16271>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16272>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_DISPATCH to retVal
16273>>>>>>>>>        Function_Return retVal
16274>>>>>>>>>    End_Function
16275>>>>>>>>>
16275>>>>>>>>>    Function ComContextMenu Returns Variant
16277>>>>>>>>>        Handle hDispatchDriver
16277>>>>>>>>>        Variant retVal
16277>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16278>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
16279>>>>>>>>>        Function_Return retVal
16280>>>>>>>>>    End_Function
16281>>>>>>>>>
16281>>>>>>>>>    Procedure ComAddPage Integer llnIndex OLE_HANDLE llhWnd String llCaption
16283>>>>>>>>>        Handle hDispatchDriver
16283>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16284>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
16285>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llnIndex
16286>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
16287>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
16288>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
16289>>>>>>>>>    End_Procedure
16290>>>>>>>>>End_Class
16291>>>>>>>>>
16291>>>>>>>>>// CoClass
16291>>>>>>>>>// CLSID: {1112C4DB-8C00-4F05-AF87-9F05BCB55475}
16291>>>>>>>>>Class cCJCustomizeOptions is a cComAutomationObject
16292>>>>>>>>>    Import_Class_Protocol cCJICustomizeOptions
16293>>>>>>>>>
16293>>>>>>>>>    Procedure Construct_Object
16295>>>>>>>>>        Forward Send Construct_Object
16297>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16298>>>>>>>>>    End_Procedure
16299>>>>>>>>>End_Class
16300>>>>>>>>>
16300>>>>>>>>>// CLSID: {1824E8C6-FA2A-4E34-8586-52210A281A72}
16300>>>>>>>>>Class cCJIStateOptions is a Mixin
16301>>>>>>>>>
16301>>>>>>>>>    Function ComSerializeControls Returns Boolean
16303>>>>>>>>>        Boolean retVal
16303>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
16304>>>>>>>>>        Function_Return retVal
16305>>>>>>>>>    End_Function
16306>>>>>>>>>
16306>>>>>>>>>    Procedure Set ComSerializeControls Boolean value
16308>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
16309>>>>>>>>>    End_Procedure
16310>>>>>>>>>
16310>>>>>>>>>    Function ComSaveOnlyCustomized Returns Boolean
16312>>>>>>>>>        Boolean retVal
16312>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
16313>>>>>>>>>        Function_Return retVal
16314>>>>>>>>>    End_Function
16315>>>>>>>>>
16315>>>>>>>>>    Procedure Set ComSaveOnlyCustomized Boolean value
16317>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
16318>>>>>>>>>    End_Procedure
16319>>>>>>>>>
16319>>>>>>>>>    Function ComLoadSilent Returns Boolean
16321>>>>>>>>>        Boolean retVal
16321>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
16322>>>>>>>>>        Function_Return retVal
16323>>>>>>>>>    End_Function
16324>>>>>>>>>
16324>>>>>>>>>    Procedure Set ComLoadSilent Boolean value
16326>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
16327>>>>>>>>>    End_Procedure
16328>>>>>>>>>
16328>>>>>>>>>    Function ComSaveOriginalControls Returns Boolean
16330>>>>>>>>>        Boolean retVal
16330>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
16331>>>>>>>>>        Function_Return retVal
16332>>>>>>>>>    End_Function
16333>>>>>>>>>
16333>>>>>>>>>    Procedure Set ComSaveOriginalControls Boolean value
16335>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
16336>>>>>>>>>    End_Procedure
16337>>>>>>>>>
16337>>>>>>>>>    Function ComSerializeOptions Returns Boolean
16339>>>>>>>>>        Boolean retVal
16339>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
16340>>>>>>>>>        Function_Return retVal
16341>>>>>>>>>    End_Function
16342>>>>>>>>>
16342>>>>>>>>>    Procedure Set ComSerializeOptions Boolean value
16344>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
16345>>>>>>>>>    End_Procedure
16346>>>>>>>>>
16346>>>>>>>>>    Function ComSerializeImages Returns Boolean
16348>>>>>>>>>        Boolean retVal
16348>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
16349>>>>>>>>>        Function_Return retVal
16350>>>>>>>>>    End_Function
16351>>>>>>>>>
16351>>>>>>>>>    Procedure Set ComSerializeImages Boolean value
16353>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
16354>>>>>>>>>    End_Procedure
16355>>>>>>>>>
16355>>>>>>>>>    Function ComSerializeLayout Returns Boolean
16357>>>>>>>>>        Boolean retVal
16357>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
16358>>>>>>>>>        Function_Return retVal
16359>>>>>>>>>    End_Function
16360>>>>>>>>>
16360>>>>>>>>>    Procedure Set ComSerializeLayout Boolean value
16362>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
16363>>>>>>>>>    End_Procedure
16364>>>>>>>>>
16364>>>>>>>>>    Function ComSerializeDesignerControls Returns Boolean
16366>>>>>>>>>        Boolean retVal
16366>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
16367>>>>>>>>>        Function_Return retVal
16368>>>>>>>>>    End_Function
16369>>>>>>>>>
16369>>>>>>>>>    Procedure Set ComSerializeDesignerControls Boolean value
16371>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
16372>>>>>>>>>    End_Procedure
16373>>>>>>>>>
16373>>>>>>>>>    Function ComSerializeActions Returns Boolean
16375>>>>>>>>>        Boolean retVal
16375>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
16376>>>>>>>>>        Function_Return retVal
16377>>>>>>>>>    End_Function
16378>>>>>>>>>
16378>>>>>>>>>    Procedure Set ComSerializeActions Boolean value
16380>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
16381>>>>>>>>>    End_Procedure
16382>>>>>>>>>End_Class
16383>>>>>>>>>
16383>>>>>>>>>// CoClass
16383>>>>>>>>>// CLSID: {2312C4DB-8C00-4F05-AF87-9F05BCB55475}
16383>>>>>>>>>Class cCJStateOptions is a cComAutomationObject
16384>>>>>>>>>    Import_Class_Protocol cCJIStateOptions
16385>>>>>>>>>
16385>>>>>>>>>    Procedure Construct_Object
16387>>>>>>>>>        Forward Send Construct_Object
16389>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16390>>>>>>>>>    End_Procedure
16391>>>>>>>>>End_Class
16392>>>>>>>>>
16392>>>>>>>>>// CLSID: {DEC5479A-9E07-4079-924A-4CB1C11FC700}
16392>>>>>>>>>Class cCJICommandBarAction is a Mixin
16393>>>>>>>>>
16393>>>>>>>>>    Function ComCaption Returns String
16395>>>>>>>>>        String retVal
16395>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
16396>>>>>>>>>        Function_Return retVal
16397>>>>>>>>>    End_Function
16398>>>>>>>>>
16398>>>>>>>>>    Procedure Set ComCaption String value
16400>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
16401>>>>>>>>>    End_Procedure
16402>>>>>>>>>
16402>>>>>>>>>    Function ComDescriptionText Returns String
16404>>>>>>>>>        String retVal
16404>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
16405>>>>>>>>>        Function_Return retVal
16406>>>>>>>>>    End_Function
16407>>>>>>>>>
16407>>>>>>>>>    Procedure Set ComDescriptionText String value
16409>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
16410>>>>>>>>>    End_Procedure
16411>>>>>>>>>
16411>>>>>>>>>    Function ComId Returns Integer
16413>>>>>>>>>        Integer retVal
16413>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
16414>>>>>>>>>        Function_Return retVal
16415>>>>>>>>>    End_Function
16416>>>>>>>>>
16416>>>>>>>>>    Procedure Set ComId Integer value
16418>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
16419>>>>>>>>>    End_Procedure
16420>>>>>>>>>
16420>>>>>>>>>    Function ComShortcutText Returns String
16422>>>>>>>>>        String retVal
16422>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
16423>>>>>>>>>        Function_Return retVal
16424>>>>>>>>>    End_Function
16425>>>>>>>>>
16425>>>>>>>>>    Procedure Set ComShortcutText String value
16427>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
16428>>>>>>>>>    End_Procedure
16429>>>>>>>>>
16429>>>>>>>>>    Function ComTooltipText Returns String
16431>>>>>>>>>        String retVal
16431>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
16432>>>>>>>>>        Function_Return retVal
16433>>>>>>>>>    End_Function
16434>>>>>>>>>
16434>>>>>>>>>    Procedure Set ComTooltipText String value
16436>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
16437>>>>>>>>>    End_Procedure
16438>>>>>>>>>
16438>>>>>>>>>    Function ComVisible Returns Boolean
16440>>>>>>>>>        Boolean retVal
16440>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
16441>>>>>>>>>        Function_Return retVal
16442>>>>>>>>>    End_Function
16443>>>>>>>>>
16443>>>>>>>>>    Procedure Set ComVisible Boolean value
16445>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
16446>>>>>>>>>    End_Procedure
16447>>>>>>>>>
16447>>>>>>>>>    Function ComEnabled Returns Boolean
16449>>>>>>>>>        Boolean retVal
16449>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
16450>>>>>>>>>        Function_Return retVal
16451>>>>>>>>>    End_Function
16452>>>>>>>>>
16452>>>>>>>>>    Procedure Set ComEnabled Boolean value
16454>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
16455>>>>>>>>>    End_Procedure
16456>>>>>>>>>
16456>>>>>>>>>    Function ComChecked Returns Boolean
16458>>>>>>>>>        Boolean retVal
16458>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
16459>>>>>>>>>        Function_Return retVal
16460>>>>>>>>>    End_Function
16461>>>>>>>>>
16461>>>>>>>>>    Procedure Set ComChecked Boolean value
16463>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
16464>>>>>>>>>    End_Procedure
16465>>>>>>>>>
16465>>>>>>>>>    Function ComIconId Returns Integer
16467>>>>>>>>>        Integer retVal
16467>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
16468>>>>>>>>>        Function_Return retVal
16469>>>>>>>>>    End_Function
16470>>>>>>>>>
16470>>>>>>>>>    Procedure Set ComIconId Integer value
16472>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
16473>>>>>>>>>    End_Procedure
16474>>>>>>>>>
16474>>>>>>>>>    Function ComCategory Returns String
16476>>>>>>>>>        String retVal
16476>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
16477>>>>>>>>>        Function_Return retVal
16478>>>>>>>>>    End_Function
16479>>>>>>>>>
16479>>>>>>>>>    Procedure Set ComCategory String value
16481>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
16482>>>>>>>>>    End_Procedure
16483>>>>>>>>>
16483>>>>>>>>>    Function ComTag Returns Variant
16485>>>>>>>>>        Variant retVal
16485>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_VARIANT to retVal
16486>>>>>>>>>        Function_Return retVal
16487>>>>>>>>>    End_Function
16488>>>>>>>>>
16488>>>>>>>>>    Procedure Set ComTag Variant value
16490>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_VARIANT to value
16491>>>>>>>>>    End_Procedure
16492>>>>>>>>>
16492>>>>>>>>>    Function ComEditHint Returns String
16494>>>>>>>>>        String retVal
16494>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 55 OLE_VT_BSTR to retVal
16495>>>>>>>>>        Function_Return retVal
16496>>>>>>>>>    End_Function
16497>>>>>>>>>
16497>>>>>>>>>    Procedure Set ComEditHint String value
16499>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 55 OLE_VT_BSTR to value
16500>>>>>>>>>    End_Procedure
16501>>>>>>>>>
16501>>>>>>>>>    Function ComKeyboardTip Returns String
16503>>>>>>>>>        String retVal
16503>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 56 OLE_VT_BSTR to retVal
16504>>>>>>>>>        Function_Return retVal
16505>>>>>>>>>    End_Function
16506>>>>>>>>>
16506>>>>>>>>>    Procedure Set ComKeyboardTip String value
16508>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 56 OLE_VT_BSTR to value
16509>>>>>>>>>    End_Procedure
16510>>>>>>>>>
16510>>>>>>>>>    Function ComKey Returns String
16512>>>>>>>>>        String retVal
16512>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 57 OLE_VT_BSTR to retVal
16513>>>>>>>>>        Function_Return retVal
16514>>>>>>>>>    End_Function
16515>>>>>>>>>
16515>>>>>>>>>    Procedure Set ComKey String value
16517>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 57 OLE_VT_BSTR to value
16518>>>>>>>>>    End_Procedure
16519>>>>>>>>>
16519>>>>>>>>>    Function ComCustomShortcutText Returns String
16521>>>>>>>>>        String retVal
16521>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 58 OLE_VT_BSTR to retVal
16522>>>>>>>>>        Function_Return retVal
16523>>>>>>>>>    End_Function
16524>>>>>>>>>
16524>>>>>>>>>    Procedure Set ComCustomShortcutText String value
16526>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 58 OLE_VT_BSTR to value
16527>>>>>>>>>    End_Procedure
16528>>>>>>>>>End_Class
16529>>>>>>>>>
16529>>>>>>>>>// CoClass
16529>>>>>>>>>// CLSID: {DE62C4DB-8C00-4F05-AF87-9F05BCB55475}
16529>>>>>>>>>Class cCJCommandBarAction is a cComAutomationObject
16530>>>>>>>>>    Import_Class_Protocol cCJICommandBarAction
16531>>>>>>>>>
16531>>>>>>>>>    Procedure Construct_Object
16533>>>>>>>>>        Forward Send Construct_Object
16535>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16536>>>>>>>>>    End_Procedure
16537>>>>>>>>>End_Class
16538>>>>>>>>>
16538>>>>>>>>>// CLSID: {DE7BCC77-27BF-4CB1-9ABF-1788D9835223}
16538>>>>>>>>>Class cCJICommandBarActions is a Mixin
16539>>>>>>>>>
16539>>>>>>>>>    // Gets the number of controls in the collection.
16539>>>>>>>>>    Function ComCount Returns Integer
16541>>>>>>>>>        Handle hDispatchDriver
16541>>>>>>>>>        Integer retVal
16541>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16542>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
16543>>>>>>>>>        Function_Return retVal
16544>>>>>>>>>    End_Function
16545>>>>>>>>>
16545>>>>>>>>>    // Gets an item from the collection by its index.
16545>>>>>>>>>    Function ComAction Integer llId Returns Variant
16547>>>>>>>>>        Handle hDispatchDriver
16547>>>>>>>>>        Variant retVal
16547>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16548>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
16549>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
16550>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
16551>>>>>>>>>        Function_Return retVal
16552>>>>>>>>>    End_Function
16553>>>>>>>>>
16553>>>>>>>>>    Function Com_NewEnum Returns Variant
16555>>>>>>>>>        Handle hDispatchDriver
16555>>>>>>>>>        Variant retVal
16555>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16556>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
16557>>>>>>>>>        Function_Return retVal
16558>>>>>>>>>    End_Function
16559>>>>>>>>>
16559>>>>>>>>>    // Adds a new command bar control to the collection.
16559>>>>>>>>>    Function ComAdd Integer llId String llCaption String llTooltipText String llDescriptionText String llCategory Returns Variant
16561>>>>>>>>>        Handle hDispatchDriver
16561>>>>>>>>>        Variant retVal
16561>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16562>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
16563>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
16564>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
16565>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTooltipText
16566>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llDescriptionText
16567>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCategory
16568>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
16569>>>>>>>>>        Function_Return retVal
16570>>>>>>>>>    End_Function
16571>>>>>>>>>
16571>>>>>>>>>    Procedure ComDeleteAll
16573>>>>>>>>>        Handle hDispatchDriver
16573>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16574>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
16575>>>>>>>>>    End_Procedure
16576>>>>>>>>>End_Class
16577>>>>>>>>>
16577>>>>>>>>>// CoClass
16577>>>>>>>>>// CLSID: {DE3455AF-3543-4D3E-88F9-4F8822200142}
16577>>>>>>>>>Class cCJCommandBarActions is a cComAutomationObject
16578>>>>>>>>>    Import_Class_Protocol cCJICommandBarActions
16579>>>>>>>>>
16579>>>>>>>>>    Procedure Construct_Object
16581>>>>>>>>>        Forward Send Construct_Object
16583>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16584>>>>>>>>>    End_Procedure
16585>>>>>>>>>End_Class
16586>>>>>>>>>
16586>>>>>>>>>// CLSID: {1FC5479A-9E07-4079-924A-4CB1C11FC700}
16586>>>>>>>>>Class cCJICommandBarControl is a Mixin
16587>>>>>>>>>
16587>>>>>>>>>    Function ComChecked Returns Boolean
16589>>>>>>>>>        Boolean retVal
16589>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
16590>>>>>>>>>        Function_Return retVal
16591>>>>>>>>>    End_Function
16592>>>>>>>>>
16592>>>>>>>>>    Procedure Set ComChecked Boolean value
16594>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
16595>>>>>>>>>    End_Procedure
16596>>>>>>>>>
16596>>>>>>>>>    Function ComBeginGroup Returns Boolean
16598>>>>>>>>>        Boolean retVal
16598>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
16599>>>>>>>>>        Function_Return retVal
16600>>>>>>>>>    End_Function
16601>>>>>>>>>
16601>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
16603>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
16604>>>>>>>>>    End_Procedure
16605>>>>>>>>>
16605>>>>>>>>>    Function ComCaption Returns String
16607>>>>>>>>>        String retVal
16607>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
16608>>>>>>>>>        Function_Return retVal
16609>>>>>>>>>    End_Function
16610>>>>>>>>>
16610>>>>>>>>>    Procedure Set ComCaption String value
16612>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
16613>>>>>>>>>    End_Procedure
16614>>>>>>>>>
16614>>>>>>>>>    Function ComDescriptionText Returns String
16616>>>>>>>>>        String retVal
16616>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
16617>>>>>>>>>        Function_Return retVal
16618>>>>>>>>>    End_Function
16619>>>>>>>>>
16619>>>>>>>>>    Procedure Set ComDescriptionText String value
16621>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
16622>>>>>>>>>    End_Procedure
16623>>>>>>>>>
16623>>>>>>>>>    Function ComId Returns Integer
16625>>>>>>>>>        Integer retVal
16625>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
16626>>>>>>>>>        Function_Return retVal
16627>>>>>>>>>    End_Function
16628>>>>>>>>>
16628>>>>>>>>>    Procedure Set ComId Integer value
16630>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
16631>>>>>>>>>    End_Procedure
16632>>>>>>>>>
16632>>>>>>>>>    Function ComParameter Returns String
16634>>>>>>>>>        String retVal
16634>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
16635>>>>>>>>>        Function_Return retVal
16636>>>>>>>>>    End_Function
16637>>>>>>>>>
16637>>>>>>>>>    Procedure Set ComParameter String value
16639>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
16640>>>>>>>>>    End_Procedure
16641>>>>>>>>>
16641>>>>>>>>>    Function ComShortcutText Returns String
16643>>>>>>>>>        String retVal
16643>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
16644>>>>>>>>>        Function_Return retVal
16645>>>>>>>>>    End_Function
16646>>>>>>>>>
16646>>>>>>>>>    Procedure Set ComShortcutText String value
16648>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
16649>>>>>>>>>    End_Procedure
16650>>>>>>>>>
16650>>>>>>>>>    Function ComCustomShortcutText Returns String
16652>>>>>>>>>        String retVal
16652>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
16653>>>>>>>>>        Function_Return retVal
16654>>>>>>>>>    End_Function
16655>>>>>>>>>
16655>>>>>>>>>    Procedure Set ComCustomShortcutText String value
16657>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
16658>>>>>>>>>    End_Procedure
16659>>>>>>>>>
16659>>>>>>>>>    Function ComTooltipText Returns String
16661>>>>>>>>>        String retVal
16661>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
16662>>>>>>>>>        Function_Return retVal
16663>>>>>>>>>    End_Function
16664>>>>>>>>>
16664>>>>>>>>>    Procedure Set ComTooltipText String value
16666>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
16667>>>>>>>>>    End_Procedure
16668>>>>>>>>>
16668>>>>>>>>>    Function ComVisible Returns Boolean
16670>>>>>>>>>        Boolean retVal
16670>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
16671>>>>>>>>>        Function_Return retVal
16672>>>>>>>>>    End_Function
16673>>>>>>>>>
16673>>>>>>>>>    Procedure Set ComVisible Boolean value
16675>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
16676>>>>>>>>>    End_Procedure
16677>>>>>>>>>
16677>>>>>>>>>    Function ComEnabled Returns Boolean
16679>>>>>>>>>        Boolean retVal
16679>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
16680>>>>>>>>>        Function_Return retVal
16681>>>>>>>>>    End_Function
16682>>>>>>>>>
16682>>>>>>>>>    Procedure Set ComEnabled Boolean value
16684>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
16685>>>>>>>>>    End_Procedure
16686>>>>>>>>>
16686>>>>>>>>>    Function ComIconId Returns Integer
16688>>>>>>>>>        Integer retVal
16688>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
16689>>>>>>>>>        Function_Return retVal
16690>>>>>>>>>    End_Function
16691>>>>>>>>>
16691>>>>>>>>>    Procedure Set ComIconId Integer value
16693>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
16694>>>>>>>>>    End_Procedure
16695>>>>>>>>>
16695>>>>>>>>>    Function ComDefaultItem Returns Boolean
16697>>>>>>>>>        Boolean retVal
16697>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
16698>>>>>>>>>        Function_Return retVal
16699>>>>>>>>>    End_Function
16700>>>>>>>>>
16700>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
16702>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
16703>>>>>>>>>    End_Procedure
16704>>>>>>>>>
16704>>>>>>>>>    Function ComFlags Returns XTPControlFlags
16706>>>>>>>>>        XTPControlFlags retVal
16706>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
16707>>>>>>>>>        Function_Return retVal
16708>>>>>>>>>    End_Function
16709>>>>>>>>>
16709>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
16711>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
16712>>>>>>>>>    End_Procedure
16713>>>>>>>>>
16713>>>>>>>>>    Function ComCategory Returns String
16715>>>>>>>>>        String retVal
16715>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
16716>>>>>>>>>        Function_Return retVal
16717>>>>>>>>>    End_Function
16718>>>>>>>>>
16718>>>>>>>>>    Procedure Set ComCategory String value
16720>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
16721>>>>>>>>>    End_Procedure
16722>>>>>>>>>
16722>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
16724>>>>>>>>>        XTPControlHideFlags retVal
16724>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
16725>>>>>>>>>        Function_Return retVal
16726>>>>>>>>>    End_Function
16727>>>>>>>>>
16727>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
16729>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
16730>>>>>>>>>    End_Procedure
16731>>>>>>>>>
16731>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
16733>>>>>>>>>        Boolean retVal
16733>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
16734>>>>>>>>>        Function_Return retVal
16735>>>>>>>>>    End_Function
16736>>>>>>>>>
16736>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
16738>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
16739>>>>>>>>>    End_Procedure
16740>>>>>>>>>
16740>>>>>>>>>    Function ComAction Returns Variant
16742>>>>>>>>>        Variant retVal
16742>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
16743>>>>>>>>>        Function_Return retVal
16744>>>>>>>>>    End_Function
16745>>>>>>>>>
16745>>>>>>>>>    Procedure Set ComAction Variant value
16747>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
16748>>>>>>>>>    End_Procedure
16749>>>>>>>>>
16749>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
16751>>>>>>>>>        Integer retVal
16751>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
16752>>>>>>>>>        Function_Return retVal
16753>>>>>>>>>    End_Function
16754>>>>>>>>>
16754>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
16756>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
16757>>>>>>>>>    End_Procedure
16758>>>>>>>>>
16758>>>>>>>>>    Function ComWidth Returns Integer
16760>>>>>>>>>        Integer retVal
16760>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
16761>>>>>>>>>        Function_Return retVal
16762>>>>>>>>>    End_Function
16763>>>>>>>>>
16763>>>>>>>>>    Procedure Set ComWidth Integer value
16765>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
16766>>>>>>>>>    End_Procedure
16767>>>>>>>>>
16767>>>>>>>>>    Function ComHeight Returns Integer
16769>>>>>>>>>        Integer retVal
16769>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
16770>>>>>>>>>        Function_Return retVal
16771>>>>>>>>>    End_Function
16772>>>>>>>>>
16772>>>>>>>>>    Procedure Set ComHeight Integer value
16774>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
16775>>>>>>>>>    End_Procedure
16776>>>>>>>>>
16776>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
16778>>>>>>>>>        XTPButtonStyle retVal
16778>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
16779>>>>>>>>>        Function_Return retVal
16780>>>>>>>>>    End_Function
16781>>>>>>>>>
16781>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
16783>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
16784>>>>>>>>>    End_Procedure
16785>>>>>>>>>
16785>>>>>>>>>    Function ComKeyboardTip Returns String
16787>>>>>>>>>        String retVal
16787>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
16788>>>>>>>>>        Function_Return retVal
16789>>>>>>>>>    End_Function
16790>>>>>>>>>
16790>>>>>>>>>    Procedure Set ComKeyboardTip String value
16792>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
16793>>>>>>>>>    End_Procedure
16794>>>>>>>>>
16794>>>>>>>>>    Function ComControls Returns Variant
16796>>>>>>>>>        Handle hDispatchDriver
16796>>>>>>>>>        Variant retVal
16796>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16797>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
16798>>>>>>>>>        Function_Return retVal
16799>>>>>>>>>    End_Function
16800>>>>>>>>>
16800>>>>>>>>>    Function ComParent Returns Variant
16802>>>>>>>>>        Handle hDispatchDriver
16802>>>>>>>>>        Variant retVal
16802>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16803>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
16804>>>>>>>>>        Function_Return retVal
16805>>>>>>>>>    End_Function
16806>>>>>>>>>
16806>>>>>>>>>    Function ComIndex Returns Integer
16808>>>>>>>>>        Handle hDispatchDriver
16808>>>>>>>>>        Integer retVal
16808>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16809>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
16810>>>>>>>>>        Function_Return retVal
16811>>>>>>>>>    End_Function
16812>>>>>>>>>
16812>>>>>>>>>    Function ComType Returns XTPControlType
16814>>>>>>>>>        Handle hDispatchDriver
16814>>>>>>>>>        XTPControlType retVal
16814>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16815>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
16816>>>>>>>>>        Function_Return retVal
16817>>>>>>>>>    End_Function
16818>>>>>>>>>
16818>>>>>>>>>    Procedure ComDelete
16820>>>>>>>>>        Handle hDispatchDriver
16820>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16821>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
16822>>>>>>>>>    End_Procedure
16823>>>>>>>>>
16823>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
16825>>>>>>>>>        Handle hDispatchDriver
16825>>>>>>>>>        Variant retVal
16825>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16826>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
16827>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
16828>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
16829>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
16830>>>>>>>>>        Function_Return retVal
16831>>>>>>>>>    End_Function
16832>>>>>>>>>
16832>>>>>>>>>    Procedure ComSetFocus
16834>>>>>>>>>        Handle hDispatchDriver
16834>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16835>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
16836>>>>>>>>>    End_Procedure
16837>>>>>>>>>
16837>>>>>>>>>    Procedure ComExecute
16839>>>>>>>>>        Handle hDispatchDriver
16839>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16840>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
16841>>>>>>>>>    End_Procedure
16842>>>>>>>>>
16842>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
16844>>>>>>>>>        Handle hDispatchDriver
16844>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16845>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
16846>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
16847>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
16848>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
16849>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
16850>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
16851>>>>>>>>>    End_Procedure
16852>>>>>>>>>
16852>>>>>>>>>    Function ComRibbonGroup Returns Variant
16854>>>>>>>>>        Handle hDispatchDriver
16854>>>>>>>>>        Variant retVal
16854>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16855>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
16856>>>>>>>>>        Function_Return retVal
16857>>>>>>>>>    End_Function
16858>>>>>>>>>
16858>>>>>>>>>    Procedure ComReset
16860>>>>>>>>>        Handle hDispatchDriver
16860>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16861>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
16862>>>>>>>>>    End_Procedure
16863>>>>>>>>>
16863>>>>>>>>>    Function ComTop Returns Integer
16865>>>>>>>>>        Handle hDispatchDriver
16865>>>>>>>>>        Integer retVal
16865>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16866>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
16867>>>>>>>>>        Function_Return retVal
16868>>>>>>>>>    End_Function
16869>>>>>>>>>
16869>>>>>>>>>    Function ComLeft Returns Integer
16871>>>>>>>>>        Handle hDispatchDriver
16871>>>>>>>>>        Integer retVal
16871>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16872>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
16873>>>>>>>>>        Function_Return retVal
16874>>>>>>>>>    End_Function
16875>>>>>>>>>
16875>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
16877>>>>>>>>>        Handle hDispatchDriver
16877>>>>>>>>>        Variant retVal
16877>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16878>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
16879>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
16880>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
16881>>>>>>>>>        Function_Return retVal
16882>>>>>>>>>    End_Function
16883>>>>>>>>>
16883>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
16885>>>>>>>>>        Handle hDispatchDriver
16885>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16886>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
16887>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
16888>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
16889>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
16890>>>>>>>>>    End_Procedure
16891>>>>>>>>>
16891>>>>>>>>>    Function ComCommandBar Returns Variant
16893>>>>>>>>>        Handle hDispatchDriver
16893>>>>>>>>>        Variant retVal
16893>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
16894>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 50 OLE_VT_DISPATCH to retVal
16895>>>>>>>>>        Function_Return retVal
16896>>>>>>>>>    End_Function
16897>>>>>>>>>End_Class
16898>>>>>>>>>
16898>>>>>>>>>// CoClass
16898>>>>>>>>>// CLSID: {3362C4DB-8C00-4F05-AF87-9F05BCB55475}
16898>>>>>>>>>Class cCJCommandBarControl is a cComAutomationObject
16899>>>>>>>>>    Import_Class_Protocol cCJICommandBarControl
16900>>>>>>>>>
16900>>>>>>>>>    Procedure Construct_Object
16902>>>>>>>>>        Forward Send Construct_Object
16904>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
16905>>>>>>>>>    End_Procedure
16906>>>>>>>>>End_Class
16907>>>>>>>>>
16907>>>>>>>>>// CLSID: {324B467B-1E0F-446D-B92B-BEDBEF77302F}
16907>>>>>>>>>Class cCJICommandBarButton is a Mixin
16908>>>>>>>>>
16908>>>>>>>>>    Function ComChecked Returns Boolean
16910>>>>>>>>>        Boolean retVal
16910>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
16911>>>>>>>>>        Function_Return retVal
16912>>>>>>>>>    End_Function
16913>>>>>>>>>
16913>>>>>>>>>    Procedure Set ComChecked Boolean value
16915>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
16916>>>>>>>>>    End_Procedure
16917>>>>>>>>>
16917>>>>>>>>>    Function ComBeginGroup Returns Boolean
16919>>>>>>>>>        Boolean retVal
16919>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
16920>>>>>>>>>        Function_Return retVal
16921>>>>>>>>>    End_Function
16922>>>>>>>>>
16922>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
16924>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
16925>>>>>>>>>    End_Procedure
16926>>>>>>>>>
16926>>>>>>>>>    Function ComCaption Returns String
16928>>>>>>>>>        String retVal
16928>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
16929>>>>>>>>>        Function_Return retVal
16930>>>>>>>>>    End_Function
16931>>>>>>>>>
16931>>>>>>>>>    Procedure Set ComCaption String value
16933>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
16934>>>>>>>>>    End_Procedure
16935>>>>>>>>>
16935>>>>>>>>>    Function ComDescriptionText Returns String
16937>>>>>>>>>        String retVal
16937>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
16938>>>>>>>>>        Function_Return retVal
16939>>>>>>>>>    End_Function
16940>>>>>>>>>
16940>>>>>>>>>    Procedure Set ComDescriptionText String value
16942>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
16943>>>>>>>>>    End_Procedure
16944>>>>>>>>>
16944>>>>>>>>>    Function ComId Returns Integer
16946>>>>>>>>>        Integer retVal
16946>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
16947>>>>>>>>>        Function_Return retVal
16948>>>>>>>>>    End_Function
16949>>>>>>>>>
16949>>>>>>>>>    Procedure Set ComId Integer value
16951>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
16952>>>>>>>>>    End_Procedure
16953>>>>>>>>>
16953>>>>>>>>>    Function ComParameter Returns String
16955>>>>>>>>>        String retVal
16955>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
16956>>>>>>>>>        Function_Return retVal
16957>>>>>>>>>    End_Function
16958>>>>>>>>>
16958>>>>>>>>>    Procedure Set ComParameter String value
16960>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
16961>>>>>>>>>    End_Procedure
16962>>>>>>>>>
16962>>>>>>>>>    Function ComShortcutText Returns String
16964>>>>>>>>>        String retVal
16964>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
16965>>>>>>>>>        Function_Return retVal
16966>>>>>>>>>    End_Function
16967>>>>>>>>>
16967>>>>>>>>>    Procedure Set ComShortcutText String value
16969>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
16970>>>>>>>>>    End_Procedure
16971>>>>>>>>>
16971>>>>>>>>>    Function ComCustomShortcutText Returns String
16973>>>>>>>>>        String retVal
16973>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
16974>>>>>>>>>        Function_Return retVal
16975>>>>>>>>>    End_Function
16976>>>>>>>>>
16976>>>>>>>>>    Procedure Set ComCustomShortcutText String value
16978>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
16979>>>>>>>>>    End_Procedure
16980>>>>>>>>>
16980>>>>>>>>>    Function ComTooltipText Returns String
16982>>>>>>>>>        String retVal
16982>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
16983>>>>>>>>>        Function_Return retVal
16984>>>>>>>>>    End_Function
16985>>>>>>>>>
16985>>>>>>>>>    Procedure Set ComTooltipText String value
16987>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
16988>>>>>>>>>    End_Procedure
16989>>>>>>>>>
16989>>>>>>>>>    Function ComVisible Returns Boolean
16991>>>>>>>>>        Boolean retVal
16991>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
16992>>>>>>>>>        Function_Return retVal
16993>>>>>>>>>    End_Function
16994>>>>>>>>>
16994>>>>>>>>>    Procedure Set ComVisible Boolean value
16996>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
16997>>>>>>>>>    End_Procedure
16998>>>>>>>>>
16998>>>>>>>>>    Function ComEnabled Returns Boolean
17000>>>>>>>>>        Boolean retVal
17000>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
17001>>>>>>>>>        Function_Return retVal
17002>>>>>>>>>    End_Function
17003>>>>>>>>>
17003>>>>>>>>>    Procedure Set ComEnabled Boolean value
17005>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
17006>>>>>>>>>    End_Procedure
17007>>>>>>>>>
17007>>>>>>>>>    Function ComIconId Returns Integer
17009>>>>>>>>>        Integer retVal
17009>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
17010>>>>>>>>>        Function_Return retVal
17011>>>>>>>>>    End_Function
17012>>>>>>>>>
17012>>>>>>>>>    Procedure Set ComIconId Integer value
17014>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
17015>>>>>>>>>    End_Procedure
17016>>>>>>>>>
17016>>>>>>>>>    Function ComDefaultItem Returns Boolean
17018>>>>>>>>>        Boolean retVal
17018>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
17019>>>>>>>>>        Function_Return retVal
17020>>>>>>>>>    End_Function
17021>>>>>>>>>
17021>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
17023>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
17024>>>>>>>>>    End_Procedure
17025>>>>>>>>>
17025>>>>>>>>>    Function ComFlags Returns XTPControlFlags
17027>>>>>>>>>        XTPControlFlags retVal
17027>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
17028>>>>>>>>>        Function_Return retVal
17029>>>>>>>>>    End_Function
17030>>>>>>>>>
17030>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
17032>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
17033>>>>>>>>>    End_Procedure
17034>>>>>>>>>
17034>>>>>>>>>    Function ComCategory Returns String
17036>>>>>>>>>        String retVal
17036>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
17037>>>>>>>>>        Function_Return retVal
17038>>>>>>>>>    End_Function
17039>>>>>>>>>
17039>>>>>>>>>    Procedure Set ComCategory String value
17041>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
17042>>>>>>>>>    End_Procedure
17043>>>>>>>>>
17043>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
17045>>>>>>>>>        XTPControlHideFlags retVal
17045>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
17046>>>>>>>>>        Function_Return retVal
17047>>>>>>>>>    End_Function
17048>>>>>>>>>
17048>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
17050>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
17051>>>>>>>>>    End_Procedure
17052>>>>>>>>>
17052>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
17054>>>>>>>>>        Boolean retVal
17054>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
17055>>>>>>>>>        Function_Return retVal
17056>>>>>>>>>    End_Function
17057>>>>>>>>>
17057>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
17059>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
17060>>>>>>>>>    End_Procedure
17061>>>>>>>>>
17061>>>>>>>>>    Function ComAction Returns Variant
17063>>>>>>>>>        Variant retVal
17063>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
17064>>>>>>>>>        Function_Return retVal
17065>>>>>>>>>    End_Function
17066>>>>>>>>>
17066>>>>>>>>>    Procedure Set ComAction Variant value
17068>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
17069>>>>>>>>>    End_Procedure
17070>>>>>>>>>
17070>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
17072>>>>>>>>>        Integer retVal
17072>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
17073>>>>>>>>>        Function_Return retVal
17074>>>>>>>>>    End_Function
17075>>>>>>>>>
17075>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
17077>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
17078>>>>>>>>>    End_Procedure
17079>>>>>>>>>
17079>>>>>>>>>    Function ComWidth Returns Integer
17081>>>>>>>>>        Integer retVal
17081>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
17082>>>>>>>>>        Function_Return retVal
17083>>>>>>>>>    End_Function
17084>>>>>>>>>
17084>>>>>>>>>    Procedure Set ComWidth Integer value
17086>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
17087>>>>>>>>>    End_Procedure
17088>>>>>>>>>
17088>>>>>>>>>    Function ComHeight Returns Integer
17090>>>>>>>>>        Integer retVal
17090>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
17091>>>>>>>>>        Function_Return retVal
17092>>>>>>>>>    End_Function
17093>>>>>>>>>
17093>>>>>>>>>    Procedure Set ComHeight Integer value
17095>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
17096>>>>>>>>>    End_Procedure
17097>>>>>>>>>
17097>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
17099>>>>>>>>>        XTPButtonStyle retVal
17099>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
17100>>>>>>>>>        Function_Return retVal
17101>>>>>>>>>    End_Function
17102>>>>>>>>>
17102>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
17104>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
17105>>>>>>>>>    End_Procedure
17106>>>>>>>>>
17106>>>>>>>>>    Function ComKeyboardTip Returns String
17108>>>>>>>>>        String retVal
17108>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
17109>>>>>>>>>        Function_Return retVal
17110>>>>>>>>>    End_Function
17111>>>>>>>>>
17111>>>>>>>>>    Procedure Set ComKeyboardTip String value
17113>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
17114>>>>>>>>>    End_Procedure
17115>>>>>>>>>
17115>>>>>>>>>    Function ComControls Returns Variant
17117>>>>>>>>>        Handle hDispatchDriver
17117>>>>>>>>>        Variant retVal
17117>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17118>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
17119>>>>>>>>>        Function_Return retVal
17120>>>>>>>>>    End_Function
17121>>>>>>>>>
17121>>>>>>>>>    Function ComParent Returns Variant
17123>>>>>>>>>        Handle hDispatchDriver
17123>>>>>>>>>        Variant retVal
17123>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17124>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
17125>>>>>>>>>        Function_Return retVal
17126>>>>>>>>>    End_Function
17127>>>>>>>>>
17127>>>>>>>>>    Function ComIndex Returns Integer
17129>>>>>>>>>        Handle hDispatchDriver
17129>>>>>>>>>        Integer retVal
17129>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17130>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
17131>>>>>>>>>        Function_Return retVal
17132>>>>>>>>>    End_Function
17133>>>>>>>>>
17133>>>>>>>>>    Function ComType Returns XTPControlType
17135>>>>>>>>>        Handle hDispatchDriver
17135>>>>>>>>>        XTPControlType retVal
17135>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17136>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
17137>>>>>>>>>        Function_Return retVal
17138>>>>>>>>>    End_Function
17139>>>>>>>>>
17139>>>>>>>>>    Procedure ComDelete
17141>>>>>>>>>        Handle hDispatchDriver
17141>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17142>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
17143>>>>>>>>>    End_Procedure
17144>>>>>>>>>
17144>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
17146>>>>>>>>>        Handle hDispatchDriver
17146>>>>>>>>>        Variant retVal
17146>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17147>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
17148>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
17149>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
17150>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
17151>>>>>>>>>        Function_Return retVal
17152>>>>>>>>>    End_Function
17153>>>>>>>>>
17153>>>>>>>>>    Procedure ComSetFocus
17155>>>>>>>>>        Handle hDispatchDriver
17155>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17156>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
17157>>>>>>>>>    End_Procedure
17158>>>>>>>>>
17158>>>>>>>>>    Procedure ComExecute
17160>>>>>>>>>        Handle hDispatchDriver
17160>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17161>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
17162>>>>>>>>>    End_Procedure
17163>>>>>>>>>
17163>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
17165>>>>>>>>>        Handle hDispatchDriver
17165>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17166>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
17167>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
17168>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
17169>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
17170>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
17171>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
17172>>>>>>>>>    End_Procedure
17173>>>>>>>>>
17173>>>>>>>>>    Function ComRibbonGroup Returns Variant
17175>>>>>>>>>        Handle hDispatchDriver
17175>>>>>>>>>        Variant retVal
17175>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17176>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
17177>>>>>>>>>        Function_Return retVal
17178>>>>>>>>>    End_Function
17179>>>>>>>>>
17179>>>>>>>>>    Procedure ComReset
17181>>>>>>>>>        Handle hDispatchDriver
17181>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17182>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
17183>>>>>>>>>    End_Procedure
17184>>>>>>>>>
17184>>>>>>>>>    Function ComTop Returns Integer
17186>>>>>>>>>        Handle hDispatchDriver
17186>>>>>>>>>        Integer retVal
17186>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17187>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
17188>>>>>>>>>        Function_Return retVal
17189>>>>>>>>>    End_Function
17190>>>>>>>>>
17190>>>>>>>>>    Function ComLeft Returns Integer
17192>>>>>>>>>        Handle hDispatchDriver
17192>>>>>>>>>        Integer retVal
17192>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17193>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
17194>>>>>>>>>        Function_Return retVal
17195>>>>>>>>>    End_Function
17196>>>>>>>>>
17196>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
17198>>>>>>>>>        Handle hDispatchDriver
17198>>>>>>>>>        Variant retVal
17198>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17199>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
17200>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
17201>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
17202>>>>>>>>>        Function_Return retVal
17203>>>>>>>>>    End_Function
17204>>>>>>>>>
17204>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
17206>>>>>>>>>        Handle hDispatchDriver
17206>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17207>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
17208>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
17209>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
17210>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
17211>>>>>>>>>    End_Procedure
17212>>>>>>>>>End_Class
17213>>>>>>>>>
17213>>>>>>>>>// CoClass
17213>>>>>>>>>// CLSID: {004FCE65-AACD-4E77-8B1E-42B463760513}
17213>>>>>>>>>Class cCJCommandBarButton is a cComAutomationObject
17214>>>>>>>>>    Import_Class_Protocol cCJICommandBarButton
17215>>>>>>>>>
17215>>>>>>>>>    Procedure Construct_Object
17217>>>>>>>>>        Forward Send Construct_Object
17219>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
17220>>>>>>>>>    End_Procedure
17221>>>>>>>>>End_Class
17222>>>>>>>>>
17222>>>>>>>>>// CLSID: {09028A35-789A-40D9-B564-7577DA549319}
17222>>>>>>>>>Class cCJICommandBarPopup is a Mixin
17223>>>>>>>>>
17223>>>>>>>>>    Function ComChecked Returns Boolean
17225>>>>>>>>>        Boolean retVal
17225>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
17226>>>>>>>>>        Function_Return retVal
17227>>>>>>>>>    End_Function
17228>>>>>>>>>
17228>>>>>>>>>    Procedure Set ComChecked Boolean value
17230>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
17231>>>>>>>>>    End_Procedure
17232>>>>>>>>>
17232>>>>>>>>>    Function ComBeginGroup Returns Boolean
17234>>>>>>>>>        Boolean retVal
17234>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
17235>>>>>>>>>        Function_Return retVal
17236>>>>>>>>>    End_Function
17237>>>>>>>>>
17237>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
17239>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
17240>>>>>>>>>    End_Procedure
17241>>>>>>>>>
17241>>>>>>>>>    Function ComCaption Returns String
17243>>>>>>>>>        String retVal
17243>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
17244>>>>>>>>>        Function_Return retVal
17245>>>>>>>>>    End_Function
17246>>>>>>>>>
17246>>>>>>>>>    Procedure Set ComCaption String value
17248>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
17249>>>>>>>>>    End_Procedure
17250>>>>>>>>>
17250>>>>>>>>>    Function ComDescriptionText Returns String
17252>>>>>>>>>        String retVal
17252>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
17253>>>>>>>>>        Function_Return retVal
17254>>>>>>>>>    End_Function
17255>>>>>>>>>
17255>>>>>>>>>    Procedure Set ComDescriptionText String value
17257>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
17258>>>>>>>>>    End_Procedure
17259>>>>>>>>>
17259>>>>>>>>>    Function ComId Returns Integer
17261>>>>>>>>>        Integer retVal
17261>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
17262>>>>>>>>>        Function_Return retVal
17263>>>>>>>>>    End_Function
17264>>>>>>>>>
17264>>>>>>>>>    Procedure Set ComId Integer value
17266>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
17267>>>>>>>>>    End_Procedure
17268>>>>>>>>>
17268>>>>>>>>>    Function ComParameter Returns String
17270>>>>>>>>>        String retVal
17270>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
17271>>>>>>>>>        Function_Return retVal
17272>>>>>>>>>    End_Function
17273>>>>>>>>>
17273>>>>>>>>>    Procedure Set ComParameter String value
17275>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
17276>>>>>>>>>    End_Procedure
17277>>>>>>>>>
17277>>>>>>>>>    Function ComShortcutText Returns String
17279>>>>>>>>>        String retVal
17279>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
17280>>>>>>>>>        Function_Return retVal
17281>>>>>>>>>    End_Function
17282>>>>>>>>>
17282>>>>>>>>>    Procedure Set ComShortcutText String value
17284>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
17285>>>>>>>>>    End_Procedure
17286>>>>>>>>>
17286>>>>>>>>>    Function ComCustomShortcutText Returns String
17288>>>>>>>>>        String retVal
17288>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
17289>>>>>>>>>        Function_Return retVal
17290>>>>>>>>>    End_Function
17291>>>>>>>>>
17291>>>>>>>>>    Procedure Set ComCustomShortcutText String value
17293>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
17294>>>>>>>>>    End_Procedure
17295>>>>>>>>>
17295>>>>>>>>>    Function ComTooltipText Returns String
17297>>>>>>>>>        String retVal
17297>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
17298>>>>>>>>>        Function_Return retVal
17299>>>>>>>>>    End_Function
17300>>>>>>>>>
17300>>>>>>>>>    Procedure Set ComTooltipText String value
17302>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
17303>>>>>>>>>    End_Procedure
17304>>>>>>>>>
17304>>>>>>>>>    Function ComVisible Returns Boolean
17306>>>>>>>>>        Boolean retVal
17306>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
17307>>>>>>>>>        Function_Return retVal
17308>>>>>>>>>    End_Function
17309>>>>>>>>>
17309>>>>>>>>>    Procedure Set ComVisible Boolean value
17311>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
17312>>>>>>>>>    End_Procedure
17313>>>>>>>>>
17313>>>>>>>>>    Function ComEnabled Returns Boolean
17315>>>>>>>>>        Boolean retVal
17315>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
17316>>>>>>>>>        Function_Return retVal
17317>>>>>>>>>    End_Function
17318>>>>>>>>>
17318>>>>>>>>>    Procedure Set ComEnabled Boolean value
17320>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
17321>>>>>>>>>    End_Procedure
17322>>>>>>>>>
17322>>>>>>>>>    Function ComIconId Returns Integer
17324>>>>>>>>>        Integer retVal
17324>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
17325>>>>>>>>>        Function_Return retVal
17326>>>>>>>>>    End_Function
17327>>>>>>>>>
17327>>>>>>>>>    Procedure Set ComIconId Integer value
17329>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
17330>>>>>>>>>    End_Procedure
17331>>>>>>>>>
17331>>>>>>>>>    Function ComDefaultItem Returns Boolean
17333>>>>>>>>>        Boolean retVal
17333>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
17334>>>>>>>>>        Function_Return retVal
17335>>>>>>>>>    End_Function
17336>>>>>>>>>
17336>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
17338>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
17339>>>>>>>>>    End_Procedure
17340>>>>>>>>>
17340>>>>>>>>>    Function ComFlags Returns XTPControlFlags
17342>>>>>>>>>        XTPControlFlags retVal
17342>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
17343>>>>>>>>>        Function_Return retVal
17344>>>>>>>>>    End_Function
17345>>>>>>>>>
17345>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
17347>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
17348>>>>>>>>>    End_Procedure
17349>>>>>>>>>
17349>>>>>>>>>    Function ComCategory Returns String
17351>>>>>>>>>        String retVal
17351>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
17352>>>>>>>>>        Function_Return retVal
17353>>>>>>>>>    End_Function
17354>>>>>>>>>
17354>>>>>>>>>    Procedure Set ComCategory String value
17356>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
17357>>>>>>>>>    End_Procedure
17358>>>>>>>>>
17358>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
17360>>>>>>>>>        XTPControlHideFlags retVal
17360>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
17361>>>>>>>>>        Function_Return retVal
17362>>>>>>>>>    End_Function
17363>>>>>>>>>
17363>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
17365>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
17366>>>>>>>>>    End_Procedure
17367>>>>>>>>>
17367>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
17369>>>>>>>>>        Boolean retVal
17369>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
17370>>>>>>>>>        Function_Return retVal
17371>>>>>>>>>    End_Function
17372>>>>>>>>>
17372>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
17374>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
17375>>>>>>>>>    End_Procedure
17376>>>>>>>>>
17376>>>>>>>>>    Function ComAction Returns Variant
17378>>>>>>>>>        Variant retVal
17378>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
17379>>>>>>>>>        Function_Return retVal
17380>>>>>>>>>    End_Function
17381>>>>>>>>>
17381>>>>>>>>>    Procedure Set ComAction Variant value
17383>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
17384>>>>>>>>>    End_Procedure
17385>>>>>>>>>
17385>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
17387>>>>>>>>>        Integer retVal
17387>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
17388>>>>>>>>>        Function_Return retVal
17389>>>>>>>>>    End_Function
17390>>>>>>>>>
17390>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
17392>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
17393>>>>>>>>>    End_Procedure
17394>>>>>>>>>
17394>>>>>>>>>    Function ComWidth Returns Integer
17396>>>>>>>>>        Integer retVal
17396>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
17397>>>>>>>>>        Function_Return retVal
17398>>>>>>>>>    End_Function
17399>>>>>>>>>
17399>>>>>>>>>    Procedure Set ComWidth Integer value
17401>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
17402>>>>>>>>>    End_Procedure
17403>>>>>>>>>
17403>>>>>>>>>    Function ComHeight Returns Integer
17405>>>>>>>>>        Integer retVal
17405>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
17406>>>>>>>>>        Function_Return retVal
17407>>>>>>>>>    End_Function
17408>>>>>>>>>
17408>>>>>>>>>    Procedure Set ComHeight Integer value
17410>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
17411>>>>>>>>>    End_Procedure
17412>>>>>>>>>
17412>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
17414>>>>>>>>>        XTPButtonStyle retVal
17414>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
17415>>>>>>>>>        Function_Return retVal
17416>>>>>>>>>    End_Function
17417>>>>>>>>>
17417>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
17419>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
17420>>>>>>>>>    End_Procedure
17421>>>>>>>>>
17421>>>>>>>>>    Function ComKeyboardTip Returns String
17423>>>>>>>>>        String retVal
17423>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
17424>>>>>>>>>        Function_Return retVal
17425>>>>>>>>>    End_Function
17426>>>>>>>>>
17426>>>>>>>>>    Procedure Set ComKeyboardTip String value
17428>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
17429>>>>>>>>>    End_Procedure
17430>>>>>>>>>
17430>>>>>>>>>    Function ComCommandBar Returns Variant
17432>>>>>>>>>        Variant retVal
17432>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to retVal
17433>>>>>>>>>        Function_Return retVal
17434>>>>>>>>>    End_Function
17435>>>>>>>>>
17435>>>>>>>>>    Procedure Set ComCommandBar Variant value
17437>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to value
17438>>>>>>>>>    End_Procedure
17439>>>>>>>>>
17439>>>>>>>>>    Function ComControls Returns Variant
17441>>>>>>>>>        Handle hDispatchDriver
17441>>>>>>>>>        Variant retVal
17441>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17442>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
17443>>>>>>>>>        Function_Return retVal
17444>>>>>>>>>    End_Function
17445>>>>>>>>>
17445>>>>>>>>>    Function ComParent Returns Variant
17447>>>>>>>>>        Handle hDispatchDriver
17447>>>>>>>>>        Variant retVal
17447>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17448>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
17449>>>>>>>>>        Function_Return retVal
17450>>>>>>>>>    End_Function
17451>>>>>>>>>
17451>>>>>>>>>    Function ComIndex Returns Integer
17453>>>>>>>>>        Handle hDispatchDriver
17453>>>>>>>>>        Integer retVal
17453>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17454>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
17455>>>>>>>>>        Function_Return retVal
17456>>>>>>>>>    End_Function
17457>>>>>>>>>
17457>>>>>>>>>    Function ComType Returns XTPControlType
17459>>>>>>>>>        Handle hDispatchDriver
17459>>>>>>>>>        XTPControlType retVal
17459>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17460>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
17461>>>>>>>>>        Function_Return retVal
17462>>>>>>>>>    End_Function
17463>>>>>>>>>
17463>>>>>>>>>    Procedure ComDelete
17465>>>>>>>>>        Handle hDispatchDriver
17465>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17466>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
17467>>>>>>>>>    End_Procedure
17468>>>>>>>>>
17468>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
17470>>>>>>>>>        Handle hDispatchDriver
17470>>>>>>>>>        Variant retVal
17470>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17471>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
17472>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
17473>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
17474>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
17475>>>>>>>>>        Function_Return retVal
17476>>>>>>>>>    End_Function
17477>>>>>>>>>
17477>>>>>>>>>    Procedure ComSetFocus
17479>>>>>>>>>        Handle hDispatchDriver
17479>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17480>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
17481>>>>>>>>>    End_Procedure
17482>>>>>>>>>
17482>>>>>>>>>    Procedure ComExecute
17484>>>>>>>>>        Handle hDispatchDriver
17484>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17485>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
17486>>>>>>>>>    End_Procedure
17487>>>>>>>>>
17487>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
17489>>>>>>>>>        Handle hDispatchDriver
17489>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17490>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
17491>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
17492>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
17493>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
17494>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
17495>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
17496>>>>>>>>>    End_Procedure
17497>>>>>>>>>
17497>>>>>>>>>    Function ComRibbonGroup Returns Variant
17499>>>>>>>>>        Handle hDispatchDriver
17499>>>>>>>>>        Variant retVal
17499>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17500>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
17501>>>>>>>>>        Function_Return retVal
17502>>>>>>>>>    End_Function
17503>>>>>>>>>
17503>>>>>>>>>    Procedure ComReset
17505>>>>>>>>>        Handle hDispatchDriver
17505>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17506>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
17507>>>>>>>>>    End_Procedure
17508>>>>>>>>>
17508>>>>>>>>>    Function ComTop Returns Integer
17510>>>>>>>>>        Handle hDispatchDriver
17510>>>>>>>>>        Integer retVal
17510>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17511>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
17512>>>>>>>>>        Function_Return retVal
17513>>>>>>>>>    End_Function
17514>>>>>>>>>
17514>>>>>>>>>    Function ComLeft Returns Integer
17516>>>>>>>>>        Handle hDispatchDriver
17516>>>>>>>>>        Integer retVal
17516>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17517>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
17518>>>>>>>>>        Function_Return retVal
17519>>>>>>>>>    End_Function
17520>>>>>>>>>
17520>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
17522>>>>>>>>>        Handle hDispatchDriver
17522>>>>>>>>>        Variant retVal
17522>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17523>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
17524>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
17525>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
17526>>>>>>>>>        Function_Return retVal
17527>>>>>>>>>    End_Function
17528>>>>>>>>>
17528>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
17530>>>>>>>>>        Handle hDispatchDriver
17530>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17531>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
17532>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
17533>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
17534>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
17535>>>>>>>>>    End_Procedure
17536>>>>>>>>>End_Class
17537>>>>>>>>>
17537>>>>>>>>>// CoClass
17537>>>>>>>>>// CLSID: {48CCDA0A-BB71-4F79-9A7A-11ED146C387C}
17537>>>>>>>>>Class cCJCommandBarPopup is a cComAutomationObject
17538>>>>>>>>>    Import_Class_Protocol cCJICommandBarPopup
17539>>>>>>>>>
17539>>>>>>>>>    Procedure Construct_Object
17541>>>>>>>>>        Forward Send Construct_Object
17543>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
17544>>>>>>>>>    End_Procedure
17545>>>>>>>>>End_Class
17546>>>>>>>>>
17546>>>>>>>>>// CLSID: {ADB28A35-789A-40D9-B564-7577DA549319}
17546>>>>>>>>>Class cCJICommandBarGalleryItem is a Mixin
17547>>>>>>>>>
17547>>>>>>>>>    Function ComId Returns Integer
17549>>>>>>>>>        Integer retVal
17549>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
17550>>>>>>>>>        Function_Return retVal
17551>>>>>>>>>    End_Function
17552>>>>>>>>>
17552>>>>>>>>>    Procedure Set ComId Integer value
17554>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
17555>>>>>>>>>    End_Procedure
17556>>>>>>>>>
17556>>>>>>>>>    Function ComImageIndex Returns Integer
17558>>>>>>>>>        Integer retVal
17558>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
17559>>>>>>>>>        Function_Return retVal
17560>>>>>>>>>    End_Function
17561>>>>>>>>>
17561>>>>>>>>>    Procedure Set ComImageIndex Integer value
17563>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
17564>>>>>>>>>    End_Procedure
17565>>>>>>>>>
17565>>>>>>>>>    Function ComCaption Returns String
17567>>>>>>>>>        String retVal
17567>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to retVal
17568>>>>>>>>>        Function_Return retVal
17569>>>>>>>>>    End_Function
17570>>>>>>>>>
17570>>>>>>>>>    Procedure Set ComCaption String value
17572>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to value
17573>>>>>>>>>    End_Procedure
17574>>>>>>>>>
17574>>>>>>>>>    Function ComToolTip Returns String
17576>>>>>>>>>        String retVal
17576>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
17577>>>>>>>>>        Function_Return retVal
17578>>>>>>>>>    End_Function
17579>>>>>>>>>
17579>>>>>>>>>    Procedure Set ComToolTip String value
17581>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
17582>>>>>>>>>    End_Procedure
17583>>>>>>>>>
17583>>>>>>>>>    Function ComTag Returns Variant
17585>>>>>>>>>        Variant retVal
17585>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_VARIANT to retVal
17586>>>>>>>>>        Function_Return retVal
17587>>>>>>>>>    End_Function
17588>>>>>>>>>
17588>>>>>>>>>    Procedure Set ComTag Variant value
17590>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_VARIANT to value
17591>>>>>>>>>    End_Procedure
17592>>>>>>>>>
17592>>>>>>>>>    Function ComItemWidth Returns Integer
17594>>>>>>>>>        Integer retVal
17594>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to retVal
17595>>>>>>>>>        Function_Return retVal
17596>>>>>>>>>    End_Function
17597>>>>>>>>>
17597>>>>>>>>>    Procedure Set ComItemWidth Integer value
17599>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to value
17600>>>>>>>>>    End_Procedure
17601>>>>>>>>>
17601>>>>>>>>>    Function ComItemHeight Returns Integer
17603>>>>>>>>>        Integer retVal
17603>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to retVal
17604>>>>>>>>>        Function_Return retVal
17605>>>>>>>>>    End_Function
17606>>>>>>>>>
17606>>>>>>>>>    Procedure Set ComItemHeight Integer value
17608>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to value
17609>>>>>>>>>    End_Procedure
17610>>>>>>>>>
17610>>>>>>>>>    Function ComDescriptionText Returns String
17612>>>>>>>>>        String retVal
17612>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
17613>>>>>>>>>        Function_Return retVal
17614>>>>>>>>>    End_Function
17615>>>>>>>>>
17615>>>>>>>>>    Procedure Set ComDescriptionText String value
17617>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
17618>>>>>>>>>    End_Procedure
17619>>>>>>>>>
17619>>>>>>>>>    Function ComEnabled Returns Boolean
17621>>>>>>>>>        Boolean retVal
17621>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to retVal
17622>>>>>>>>>        Function_Return retVal
17623>>>>>>>>>    End_Function
17624>>>>>>>>>
17624>>>>>>>>>    Procedure Set ComEnabled Boolean value
17626>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to value
17627>>>>>>>>>    End_Procedure
17628>>>>>>>>>
17628>>>>>>>>>    Function ComIndex Returns Integer
17630>>>>>>>>>        Handle hDispatchDriver
17630>>>>>>>>>        Integer retVal
17630>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17631>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
17632>>>>>>>>>        Function_Return retVal
17633>>>>>>>>>    End_Function
17634>>>>>>>>>
17634>>>>>>>>>    Function ComLabel Returns Boolean
17636>>>>>>>>>        Handle hDispatchDriver
17636>>>>>>>>>        Boolean retVal
17636>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17637>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_BOOL to retVal
17638>>>>>>>>>        Function_Return retVal
17639>>>>>>>>>    End_Function
17640>>>>>>>>>End_Class
17641>>>>>>>>>
17641>>>>>>>>>// CoClass
17641>>>>>>>>>// CLSID: {ADBCDA0A-BB71-4F79-9A7A-11ED146C387C}
17641>>>>>>>>>Class cCJCommandBarGalleryItem is a cComAutomationObject
17642>>>>>>>>>    Import_Class_Protocol cCJICommandBarGalleryItem
17643>>>>>>>>>
17643>>>>>>>>>    Procedure Construct_Object
17645>>>>>>>>>        Forward Send Construct_Object
17647>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
17648>>>>>>>>>    End_Procedure
17649>>>>>>>>>End_Class
17650>>>>>>>>>
17650>>>>>>>>>// CLSID: {ADC28A35-789A-40D9-B564-7577DA549319}
17650>>>>>>>>>Class cCJICommandBarGalleryItems is a Mixin
17651>>>>>>>>>
17651>>>>>>>>>    Function ComIcons Returns Variant
17653>>>>>>>>>        Variant retVal
17653>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_DISPATCH to retVal
17654>>>>>>>>>        Function_Return retVal
17655>>>>>>>>>    End_Function
17656>>>>>>>>>
17656>>>>>>>>>    Procedure Set ComIcons Variant value
17658>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_DISPATCH to value
17659>>>>>>>>>    End_Procedure
17660>>>>>>>>>
17660>>>>>>>>>    Function ComItemWidth Returns Integer
17662>>>>>>>>>        Integer retVal
17662>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to retVal
17663>>>>>>>>>        Function_Return retVal
17664>>>>>>>>>    End_Function
17665>>>>>>>>>
17665>>>>>>>>>    Procedure Set ComItemWidth Integer value
17667>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to value
17668>>>>>>>>>    End_Procedure
17669>>>>>>>>>
17669>>>>>>>>>    Function ComItemHeight Returns Integer
17671>>>>>>>>>        Integer retVal
17671>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to retVal
17672>>>>>>>>>        Function_Return retVal
17673>>>>>>>>>    End_Function
17674>>>>>>>>>
17674>>>>>>>>>    Procedure Set ComItemHeight Integer value
17676>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to value
17677>>>>>>>>>    End_Procedure
17678>>>>>>>>>
17678>>>>>>>>>    Function ComClipItems Returns Boolean
17680>>>>>>>>>        Boolean retVal
17680>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
17681>>>>>>>>>        Function_Return retVal
17682>>>>>>>>>    End_Function
17683>>>>>>>>>
17683>>>>>>>>>    Procedure Set ComClipItems Boolean value
17685>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
17686>>>>>>>>>    End_Procedure
17687>>>>>>>>>
17687>>>>>>>>>    Function ComEnableMarkup Returns Boolean
17689>>>>>>>>>        Boolean retVal
17689>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
17690>>>>>>>>>        Function_Return retVal
17691>>>>>>>>>    End_Function
17692>>>>>>>>>
17692>>>>>>>>>    Procedure Set ComEnableMarkup Boolean value
17694>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
17695>>>>>>>>>    End_Procedure
17696>>>>>>>>>
17696>>>>>>>>>    Function ComAddItem Integer llId String llCaption Returns Variant
17698>>>>>>>>>        Handle hDispatchDriver
17698>>>>>>>>>        Variant retVal
17698>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17699>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
17700>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
17701>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
17702>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
17703>>>>>>>>>        Function_Return retVal
17704>>>>>>>>>    End_Function
17705>>>>>>>>>
17705>>>>>>>>>    Function ComAddLabel String llCaption Returns Variant
17707>>>>>>>>>        Handle hDispatchDriver
17707>>>>>>>>>        Variant retVal
17707>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17708>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
17709>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
17710>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
17711>>>>>>>>>        Function_Return retVal
17712>>>>>>>>>    End_Function
17713>>>>>>>>>
17713>>>>>>>>>    Function ComAddSeparator Returns Variant
17715>>>>>>>>>        Handle hDispatchDriver
17715>>>>>>>>>        Variant retVal
17715>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17716>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
17717>>>>>>>>>        Function_Return retVal
17718>>>>>>>>>    End_Function
17719>>>>>>>>>
17719>>>>>>>>>    // Gets the number of controls in the collection.
17719>>>>>>>>>    Function ComCount Returns Integer
17721>>>>>>>>>        Handle hDispatchDriver
17721>>>>>>>>>        Integer retVal
17721>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17722>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
17723>>>>>>>>>        Function_Return retVal
17724>>>>>>>>>    End_Function
17725>>>>>>>>>
17725>>>>>>>>>    // Gets an item from the collection by its index.
17725>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
17727>>>>>>>>>        Handle hDispatchDriver
17727>>>>>>>>>        Variant retVal
17727>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17728>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
17729>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
17730>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
17731>>>>>>>>>        Function_Return retVal
17732>>>>>>>>>    End_Function
17733>>>>>>>>>
17733>>>>>>>>>    Function Com_NewEnum Returns Variant
17735>>>>>>>>>        Handle hDispatchDriver
17735>>>>>>>>>        Variant retVal
17735>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17736>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
17737>>>>>>>>>        Function_Return retVal
17738>>>>>>>>>    End_Function
17739>>>>>>>>>
17739>>>>>>>>>    // Deletes all of the command bar controls from the collection
17739>>>>>>>>>    Procedure ComDeleteAll
17741>>>>>>>>>        Handle hDispatchDriver
17741>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17742>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
17743>>>>>>>>>    End_Procedure
17744>>>>>>>>>
17744>>>>>>>>>    Procedure ComDeleteAt Integer llIndex
17746>>>>>>>>>        Handle hDispatchDriver
17746>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17747>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
17748>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
17749>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 10 OLE_VT_VOID
17750>>>>>>>>>    End_Procedure
17751>>>>>>>>>
17751>>>>>>>>>    Function ComMarkupContext Returns Variant
17753>>>>>>>>>        Handle hDispatchDriver
17753>>>>>>>>>        Variant retVal
17753>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
17754>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 40 OLE_VT_DISPATCH to retVal
17755>>>>>>>>>        Function_Return retVal
17756>>>>>>>>>    End_Function
17757>>>>>>>>>End_Class
17758>>>>>>>>>
17758>>>>>>>>>// CLSID: {ADAA7B16-7BE8-42EC-870C-8849F5540F14}
17758>>>>>>>>>Class cCJICommandBarGalleryItemsEvents is a Mixin
17759>>>>>>>>>
17759>>>>>>>>>    Procedure OnComDrawItem OLE_HANDLE llhDC Variant llGallery Variant llItem Integer llx Integer lly Integer llcx Integer llcy Boolean llEnabled Boolean llSelected Boolean llPressed Boolean llChecked Variant llHandled
17761>>>>>>>>>    End_Procedure
17762>>>>>>>>>
17762>>>>>>>>>    Procedure RegisterComEvents
17764>>>>>>>>>        Send RegisterComEvent 1 msg_OnComDrawItem
17765>>>>>>>>>    End_Procedure
17766>>>>>>>>>End_Class
17767>>>>>>>>>
17767>>>>>>>>>// CoClass
17767>>>>>>>>>// CLSID: {ADCCDA0A-BB71-4F79-9A7A-11ED146C387C}
17767>>>>>>>>>Class cCJCommandBarGalleryItems is a cComAutomationObject
17768>>>>>>>>>    Import_Class_Protocol cCJICommandBarGalleryItems
17769>>>>>>>>>    Import_Class_Protocol cCJICommandBarGalleryItemsEvents
17770>>>>>>>>>
17770>>>>>>>>>    Procedure Construct_Object
17772>>>>>>>>>        Forward Send Construct_Object
17774>>>>>>>>>        Set psEventId to "{ADAA7B16-7BE8-42EC-870C-8849F5540F14}"
17775>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
17776>>>>>>>>>    End_Procedure
17777>>>>>>>>>End_Class
17778>>>>>>>>>
17778>>>>>>>>>// CLSID: {ADA28A35-789A-40D9-B564-7577DA549319}
17778>>>>>>>>>Class cCJICommandBarGallery is a Mixin
17779>>>>>>>>>
17779>>>>>>>>>    Function ComChecked Returns Boolean
17781>>>>>>>>>        Boolean retVal
17781>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
17782>>>>>>>>>        Function_Return retVal
17783>>>>>>>>>    End_Function
17784>>>>>>>>>
17784>>>>>>>>>    Procedure Set ComChecked Boolean value
17786>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
17787>>>>>>>>>    End_Procedure
17788>>>>>>>>>
17788>>>>>>>>>    Function ComBeginGroup Returns Boolean
17790>>>>>>>>>        Boolean retVal
17790>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
17791>>>>>>>>>        Function_Return retVal
17792>>>>>>>>>    End_Function
17793>>>>>>>>>
17793>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
17795>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
17796>>>>>>>>>    End_Procedure
17797>>>>>>>>>
17797>>>>>>>>>    Function ComCaption Returns String
17799>>>>>>>>>        String retVal
17799>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
17800>>>>>>>>>        Function_Return retVal
17801>>>>>>>>>    End_Function
17802>>>>>>>>>
17802>>>>>>>>>    Procedure Set ComCaption String value
17804>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
17805>>>>>>>>>    End_Procedure
17806>>>>>>>>>
17806>>>>>>>>>    Function ComDescriptionText Returns String
17808>>>>>>>>>        String retVal
17808>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
17809>>>>>>>>>        Function_Return retVal
17810>>>>>>>>>    End_Function
17811>>>>>>>>>
17811>>>>>>>>>    Procedure Set ComDescriptionText String value
17813>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
17814>>>>>>>>>    End_Procedure
17815>>>>>>>>>
17815>>>>>>>>>    Function ComId Returns Integer
17817>>>>>>>>>        Integer retVal
17817>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
17818>>>>>>>>>        Function_Return retVal
17819>>>>>>>>>    End_Function
17820>>>>>>>>>
17820>>>>>>>>>    Procedure Set ComId Integer value
17822>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
17823>>>>>>>>>    End_Procedure
17824>>>>>>>>>
17824>>>>>>>>>    Function ComParameter Returns String
17826>>>>>>>>>        String retVal
17826>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
17827>>>>>>>>>        Function_Return retVal
17828>>>>>>>>>    End_Function
17829>>>>>>>>>
17829>>>>>>>>>    Procedure Set ComParameter String value
17831>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
17832>>>>>>>>>    End_Procedure
17833>>>>>>>>>
17833>>>>>>>>>    Function ComShortcutText Returns String
17835>>>>>>>>>        String retVal
17835>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
17836>>>>>>>>>        Function_Return retVal
17837>>>>>>>>>    End_Function
17838>>>>>>>>>
17838>>>>>>>>>    Procedure Set ComShortcutText String value
17840>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
17841>>>>>>>>>    End_Procedure
17842>>>>>>>>>
17842>>>>>>>>>    Function ComCustomShortcutText Returns String
17844>>>>>>>>>        String retVal
17844>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
17845>>>>>>>>>        Function_Return retVal
17846>>>>>>>>>    End_Function
17847>>>>>>>>>
17847>>>>>>>>>    Procedure Set ComCustomShortcutText String value
17849>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
17850>>>>>>>>>    End_Procedure
17851>>>>>>>>>
17851>>>>>>>>>    Function ComTooltipText Returns String
17853>>>>>>>>>        String retVal
17853>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
17854>>>>>>>>>        Function_Return retVal
17855>>>>>>>>>    End_Function
17856>>>>>>>>>
17856>>>>>>>>>    Procedure Set ComTooltipText String value
17858>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
17859>>>>>>>>>    End_Procedure
17860>>>>>>>>>
17860>>>>>>>>>    Function ComVisible Returns Boolean
17862>>>>>>>>>        Boolean retVal
17862>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
17863>>>>>>>>>        Function_Return retVal
17864>>>>>>>>>    End_Function
17865>>>>>>>>>
17865>>>>>>>>>    Procedure Set ComVisible Boolean value
17867>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
17868>>>>>>>>>    End_Procedure
17869>>>>>>>>>
17869>>>>>>>>>    Function ComEnabled Returns Boolean
17871>>>>>>>>>        Boolean retVal
17871>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
17872>>>>>>>>>        Function_Return retVal
17873>>>>>>>>>    End_Function
17874>>>>>>>>>
17874>>>>>>>>>    Procedure Set ComEnabled Boolean value
17876>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
17877>>>>>>>>>    End_Procedure
17878>>>>>>>>>
17878>>>>>>>>>    Function ComIconId Returns Integer
17880>>>>>>>>>        Integer retVal
17880>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
17881>>>>>>>>>        Function_Return retVal
17882>>>>>>>>>    End_Function
17883>>>>>>>>>
17883>>>>>>>>>    Procedure Set ComIconId Integer value
17885>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
17886>>>>>>>>>    End_Procedure
17887>>>>>>>>>
17887>>>>>>>>>    Function ComDefaultItem Returns Boolean
17889>>>>>>>>>        Boolean retVal
17889>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
17890>>>>>>>>>        Function_Return retVal
17891>>>>>>>>>    End_Function
17892>>>>>>>>>
17892>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
17894>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
17895>>>>>>>>>    End_Procedure
17896>>>>>>>>>
17896>>>>>>>>>    Function ComFlags Returns XTPControlFlags
17898>>>>>>>>>        XTPControlFlags retVal
17898>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
17899>>>>>>>>>        Function_Return retVal
17900>>>>>>>>>    End_Function
17901>>>>>>>>>
17901>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
17903>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
17904>>>>>>>>>    End_Procedure
17905>>>>>>>>>
17905>>>>>>>>>    Function ComCategory Returns String
17907>>>>>>>>>        String retVal
17907>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
17908>>>>>>>>>        Function_Return retVal
17909>>>>>>>>>    End_Function
17910>>>>>>>>>
17910>>>>>>>>>    Procedure Set ComCategory String value
17912>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
17913>>>>>>>>>    End_Procedure
17914>>>>>>>>>
17914>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
17916>>>>>>>>>        XTPControlHideFlags retVal
17916>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
17917>>>>>>>>>        Function_Return retVal
17918>>>>>>>>>    End_Function
17919>>>>>>>>>
17919>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
17921>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
17922>>>>>>>>>    End_Procedure
17923>>>>>>>>>
17923>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
17925>>>>>>>>>        Boolean retVal
17925>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
17926>>>>>>>>>        Function_Return retVal
17927>>>>>>>>>    End_Function
17928>>>>>>>>>
17928>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
17930>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
17931>>>>>>>>>    End_Procedure
17932>>>>>>>>>
17932>>>>>>>>>    Function ComAction Returns Variant
17934>>>>>>>>>        Variant retVal
17934>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
17935>>>>>>>>>        Function_Return retVal
17936>>>>>>>>>    End_Function
17937>>>>>>>>>
17937>>>>>>>>>    Procedure Set ComAction Variant value
17939>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
17940>>>>>>>>>    End_Procedure
17941>>>>>>>>>
17941>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
17943>>>>>>>>>        Integer retVal
17943>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
17944>>>>>>>>>        Function_Return retVal
17945>>>>>>>>>    End_Function
17946>>>>>>>>>
17946>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
17948>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
17949>>>>>>>>>    End_Procedure
17950>>>>>>>>>
17950>>>>>>>>>    Function ComWidth Returns Integer
17952>>>>>>>>>        Integer retVal
17952>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
17953>>>>>>>>>        Function_Return retVal
17954>>>>>>>>>    End_Function
17955>>>>>>>>>
17955>>>>>>>>>    Procedure Set ComWidth Integer value
17957>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
17958>>>>>>>>>    End_Procedure
17959>>>>>>>>>
17959>>>>>>>>>    Function ComHeight Returns Integer
17961>>>>>>>>>        Integer retVal
17961>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
17962>>>>>>>>>        Function_Return retVal
17963>>>>>>>>>    End_Function
17964>>>>>>>>>
17964>>>>>>>>>    Procedure Set ComHeight Integer value
17966>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
17967>>>>>>>>>    End_Procedure
17968>>>>>>>>>
17968>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
17970>>>>>>>>>        XTPButtonStyle retVal
17970>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
17971>>>>>>>>>        Function_Return retVal
17972>>>>>>>>>    End_Function
17973>>>>>>>>>
17973>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
17975>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
17976>>>>>>>>>    End_Procedure
17977>>>>>>>>>
17977>>>>>>>>>    Function ComKeyboardTip Returns String
17979>>>>>>>>>        String retVal
17979>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
17980>>>>>>>>>        Function_Return retVal
17981>>>>>>>>>    End_Function
17982>>>>>>>>>
17982>>>>>>>>>    Procedure Set ComKeyboardTip String value
17984>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
17985>>>>>>>>>    End_Procedure
17986>>>>>>>>>
17986>>>>>>>>>    Function ComCommandBar Returns Variant
17988>>>>>>>>>        Variant retVal
17988>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to retVal
17989>>>>>>>>>        Function_Return retVal
17990>>>>>>>>>    End_Function
17991>>>>>>>>>
17991>>>>>>>>>    Procedure Set ComCommandBar Variant value
17993>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to value
17994>>>>>>>>>    End_Procedure
17995>>>>>>>>>
17995>>>>>>>>>    Function ComItems Returns Variant
17997>>>>>>>>>        Variant retVal
17997>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_DISPATCH to retVal
17998>>>>>>>>>        Function_Return retVal
17999>>>>>>>>>    End_Function
18000>>>>>>>>>
18000>>>>>>>>>    Procedure Set ComItems Variant value
18002>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_DISPATCH to value
18003>>>>>>>>>    End_Procedure
18004>>>>>>>>>
18004>>>>>>>>>    Function ComSelectedItem Returns Variant
18006>>>>>>>>>        Variant retVal
18006>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_DISPATCH to retVal
18007>>>>>>>>>        Function_Return retVal
18008>>>>>>>>>    End_Function
18009>>>>>>>>>
18009>>>>>>>>>    Procedure Set ComSelectedItem Variant value
18011>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_DISPATCH to value
18012>>>>>>>>>    End_Procedure
18013>>>>>>>>>
18013>>>>>>>>>    Function ComCheckedItem Returns Integer
18015>>>>>>>>>        Integer retVal
18015>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to retVal
18016>>>>>>>>>        Function_Return retVal
18017>>>>>>>>>    End_Function
18018>>>>>>>>>
18018>>>>>>>>>    Procedure Set ComCheckedItem Integer value
18020>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to value
18021>>>>>>>>>    End_Procedure
18022>>>>>>>>>
18022>>>>>>>>>    Function ComShowBorders Returns Boolean
18024>>>>>>>>>        Boolean retVal
18024>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BOOL to retVal
18025>>>>>>>>>        Function_Return retVal
18026>>>>>>>>>    End_Function
18027>>>>>>>>>
18027>>>>>>>>>    Procedure Set ComShowBorders Boolean value
18029>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BOOL to value
18030>>>>>>>>>    End_Procedure
18031>>>>>>>>>
18031>>>>>>>>>    Function ComShowLabels Returns Boolean
18033>>>>>>>>>        Boolean retVal
18033>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 54 OLE_VT_BOOL to retVal
18034>>>>>>>>>        Function_Return retVal
18035>>>>>>>>>    End_Function
18036>>>>>>>>>
18036>>>>>>>>>    Procedure Set ComShowLabels Boolean value
18038>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 54 OLE_VT_BOOL to value
18039>>>>>>>>>    End_Procedure
18040>>>>>>>>>
18040>>>>>>>>>    Function ComShowScrollBar Returns Boolean
18042>>>>>>>>>        Boolean retVal
18042>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 55 OLE_VT_BOOL to retVal
18043>>>>>>>>>        Function_Return retVal
18044>>>>>>>>>    End_Function
18045>>>>>>>>>
18045>>>>>>>>>    Procedure Set ComShowScrollBar Boolean value
18047>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 55 OLE_VT_BOOL to value
18048>>>>>>>>>    End_Procedure
18049>>>>>>>>>
18049>>>>>>>>>    Function ComScrollPos Returns Integer
18051>>>>>>>>>        Integer retVal
18051>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 56 OLE_VT_I4 to retVal
18052>>>>>>>>>        Function_Return retVal
18053>>>>>>>>>    End_Function
18054>>>>>>>>>
18054>>>>>>>>>    Procedure Set ComScrollPos Integer value
18056>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 56 OLE_VT_I4 to value
18057>>>>>>>>>    End_Procedure
18058>>>>>>>>>
18058>>>>>>>>>    Function ComResizable Returns XTPGalleryResizable
18060>>>>>>>>>        XTPGalleryResizable retVal
18060>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 62 OLE_VT_I4 to retVal
18061>>>>>>>>>        Function_Return retVal
18062>>>>>>>>>    End_Function
18063>>>>>>>>>
18063>>>>>>>>>    Procedure Set ComResizable XTPGalleryResizable value
18065>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 62 OLE_VT_I4 to value
18066>>>>>>>>>    End_Procedure
18067>>>>>>>>>
18067>>>>>>>>>    Function ComEnableTransparency Returns Boolean
18069>>>>>>>>>        Boolean retVal
18069>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 63 OLE_VT_BOOL to retVal
18070>>>>>>>>>        Function_Return retVal
18071>>>>>>>>>    End_Function
18072>>>>>>>>>
18072>>>>>>>>>    Procedure Set ComEnableTransparency Boolean value
18074>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 63 OLE_VT_BOOL to value
18075>>>>>>>>>    End_Procedure
18076>>>>>>>>>
18076>>>>>>>>>    Function ComControls Returns Variant
18078>>>>>>>>>        Handle hDispatchDriver
18078>>>>>>>>>        Variant retVal
18078>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18079>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
18080>>>>>>>>>        Function_Return retVal
18081>>>>>>>>>    End_Function
18082>>>>>>>>>
18082>>>>>>>>>    Function ComParent Returns Variant
18084>>>>>>>>>        Handle hDispatchDriver
18084>>>>>>>>>        Variant retVal
18084>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18085>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
18086>>>>>>>>>        Function_Return retVal
18087>>>>>>>>>    End_Function
18088>>>>>>>>>
18088>>>>>>>>>    Function ComIndex Returns Integer
18090>>>>>>>>>        Handle hDispatchDriver
18090>>>>>>>>>        Integer retVal
18090>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18091>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
18092>>>>>>>>>        Function_Return retVal
18093>>>>>>>>>    End_Function
18094>>>>>>>>>
18094>>>>>>>>>    Function ComType Returns XTPControlType
18096>>>>>>>>>        Handle hDispatchDriver
18096>>>>>>>>>        XTPControlType retVal
18096>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18097>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
18098>>>>>>>>>        Function_Return retVal
18099>>>>>>>>>    End_Function
18100>>>>>>>>>
18100>>>>>>>>>    Procedure ComDelete
18102>>>>>>>>>        Handle hDispatchDriver
18102>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18103>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
18104>>>>>>>>>    End_Procedure
18105>>>>>>>>>
18105>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
18107>>>>>>>>>        Handle hDispatchDriver
18107>>>>>>>>>        Variant retVal
18107>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18108>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18109>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
18110>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
18111>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
18112>>>>>>>>>        Function_Return retVal
18113>>>>>>>>>    End_Function
18114>>>>>>>>>
18114>>>>>>>>>    Procedure ComSetFocus
18116>>>>>>>>>        Handle hDispatchDriver
18116>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18117>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
18118>>>>>>>>>    End_Procedure
18119>>>>>>>>>
18119>>>>>>>>>    Procedure ComExecute
18121>>>>>>>>>        Handle hDispatchDriver
18121>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18122>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
18123>>>>>>>>>    End_Procedure
18124>>>>>>>>>
18124>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
18126>>>>>>>>>        Handle hDispatchDriver
18126>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18127>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
18128>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
18129>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
18130>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
18131>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
18132>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
18133>>>>>>>>>    End_Procedure
18134>>>>>>>>>
18134>>>>>>>>>    Function ComRibbonGroup Returns Variant
18136>>>>>>>>>        Handle hDispatchDriver
18136>>>>>>>>>        Variant retVal
18136>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18137>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
18138>>>>>>>>>        Function_Return retVal
18139>>>>>>>>>    End_Function
18140>>>>>>>>>
18140>>>>>>>>>    Procedure ComReset
18142>>>>>>>>>        Handle hDispatchDriver
18142>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18143>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
18144>>>>>>>>>    End_Procedure
18145>>>>>>>>>
18145>>>>>>>>>    Function ComTop Returns Integer
18147>>>>>>>>>        Handle hDispatchDriver
18147>>>>>>>>>        Integer retVal
18147>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18148>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
18149>>>>>>>>>        Function_Return retVal
18150>>>>>>>>>    End_Function
18151>>>>>>>>>
18151>>>>>>>>>    Function ComLeft Returns Integer
18153>>>>>>>>>        Handle hDispatchDriver
18153>>>>>>>>>        Integer retVal
18153>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18154>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
18155>>>>>>>>>        Function_Return retVal
18156>>>>>>>>>    End_Function
18157>>>>>>>>>
18157>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
18159>>>>>>>>>        Handle hDispatchDriver
18159>>>>>>>>>        Variant retVal
18159>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18160>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18161>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
18162>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
18163>>>>>>>>>        Function_Return retVal
18164>>>>>>>>>    End_Function
18165>>>>>>>>>
18165>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
18167>>>>>>>>>        Handle hDispatchDriver
18167>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18168>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18169>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
18170>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
18171>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
18172>>>>>>>>>    End_Procedure
18173>>>>>>>>>
18173>>>>>>>>>    Procedure ComSetItemsMargin Integer llLeft Integer llTop Integer llRight Integer llBottom
18175>>>>>>>>>        Handle hDispatchDriver
18175>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18176>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
18177>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llLeft
18178>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTop
18179>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRight
18180>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBottom
18181>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 59 OLE_VT_VOID
18182>>>>>>>>>    End_Procedure
18183>>>>>>>>>
18183>>>>>>>>>    Procedure ComEnsureVisible Integer llIndex
18185>>>>>>>>>        Handle hDispatchDriver
18185>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18186>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18187>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
18188>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 61 OLE_VT_VOID
18189>>>>>>>>>    End_Procedure
18190>>>>>>>>>End_Class
18191>>>>>>>>>
18191>>>>>>>>>// CoClass
18191>>>>>>>>>// CLSID: {ADACDA0A-BB71-4F79-9A7A-11ED146C387C}
18191>>>>>>>>>Class cCJCommandBarGallery is a cComAutomationObject
18192>>>>>>>>>    Import_Class_Protocol cCJICommandBarGallery
18193>>>>>>>>>
18193>>>>>>>>>    Procedure Construct_Object
18195>>>>>>>>>        Forward Send Construct_Object
18197>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
18198>>>>>>>>>    End_Procedure
18199>>>>>>>>>End_Class
18200>>>>>>>>>
18200>>>>>>>>>// CLSID: {F09F389C-1A6F-478C-8C8D-38C067A2BC1F}
18200>>>>>>>>>Class cCJICommandBarComboBox is a Mixin
18201>>>>>>>>>
18201>>>>>>>>>    Function ComChecked Returns Boolean
18203>>>>>>>>>        Boolean retVal
18203>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
18204>>>>>>>>>        Function_Return retVal
18205>>>>>>>>>    End_Function
18206>>>>>>>>>
18206>>>>>>>>>    Procedure Set ComChecked Boolean value
18208>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
18209>>>>>>>>>    End_Procedure
18210>>>>>>>>>
18210>>>>>>>>>    Function ComBeginGroup Returns Boolean
18212>>>>>>>>>        Boolean retVal
18212>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
18213>>>>>>>>>        Function_Return retVal
18214>>>>>>>>>    End_Function
18215>>>>>>>>>
18215>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
18217>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
18218>>>>>>>>>    End_Procedure
18219>>>>>>>>>
18219>>>>>>>>>    Function ComCaption Returns String
18221>>>>>>>>>        String retVal
18221>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
18222>>>>>>>>>        Function_Return retVal
18223>>>>>>>>>    End_Function
18224>>>>>>>>>
18224>>>>>>>>>    Procedure Set ComCaption String value
18226>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
18227>>>>>>>>>    End_Procedure
18228>>>>>>>>>
18228>>>>>>>>>    Function ComDescriptionText Returns String
18230>>>>>>>>>        String retVal
18230>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
18231>>>>>>>>>        Function_Return retVal
18232>>>>>>>>>    End_Function
18233>>>>>>>>>
18233>>>>>>>>>    Procedure Set ComDescriptionText String value
18235>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
18236>>>>>>>>>    End_Procedure
18237>>>>>>>>>
18237>>>>>>>>>    Function ComId Returns Integer
18239>>>>>>>>>        Integer retVal
18239>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
18240>>>>>>>>>        Function_Return retVal
18241>>>>>>>>>    End_Function
18242>>>>>>>>>
18242>>>>>>>>>    Procedure Set ComId Integer value
18244>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
18245>>>>>>>>>    End_Procedure
18246>>>>>>>>>
18246>>>>>>>>>    Function ComParameter Returns String
18248>>>>>>>>>        String retVal
18248>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
18249>>>>>>>>>        Function_Return retVal
18250>>>>>>>>>    End_Function
18251>>>>>>>>>
18251>>>>>>>>>    Procedure Set ComParameter String value
18253>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
18254>>>>>>>>>    End_Procedure
18255>>>>>>>>>
18255>>>>>>>>>    Function ComShortcutText Returns String
18257>>>>>>>>>        String retVal
18257>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
18258>>>>>>>>>        Function_Return retVal
18259>>>>>>>>>    End_Function
18260>>>>>>>>>
18260>>>>>>>>>    Procedure Set ComShortcutText String value
18262>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
18263>>>>>>>>>    End_Procedure
18264>>>>>>>>>
18264>>>>>>>>>    Function ComCustomShortcutText Returns String
18266>>>>>>>>>        String retVal
18266>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
18267>>>>>>>>>        Function_Return retVal
18268>>>>>>>>>    End_Function
18269>>>>>>>>>
18269>>>>>>>>>    Procedure Set ComCustomShortcutText String value
18271>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
18272>>>>>>>>>    End_Procedure
18273>>>>>>>>>
18273>>>>>>>>>    Function ComTooltipText Returns String
18275>>>>>>>>>        String retVal
18275>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
18276>>>>>>>>>        Function_Return retVal
18277>>>>>>>>>    End_Function
18278>>>>>>>>>
18278>>>>>>>>>    Procedure Set ComTooltipText String value
18280>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
18281>>>>>>>>>    End_Procedure
18282>>>>>>>>>
18282>>>>>>>>>    Function ComVisible Returns Boolean
18284>>>>>>>>>        Boolean retVal
18284>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
18285>>>>>>>>>        Function_Return retVal
18286>>>>>>>>>    End_Function
18287>>>>>>>>>
18287>>>>>>>>>    Procedure Set ComVisible Boolean value
18289>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
18290>>>>>>>>>    End_Procedure
18291>>>>>>>>>
18291>>>>>>>>>    Function ComEnabled Returns Boolean
18293>>>>>>>>>        Boolean retVal
18293>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
18294>>>>>>>>>        Function_Return retVal
18295>>>>>>>>>    End_Function
18296>>>>>>>>>
18296>>>>>>>>>    Procedure Set ComEnabled Boolean value
18298>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
18299>>>>>>>>>    End_Procedure
18300>>>>>>>>>
18300>>>>>>>>>    Function ComIconId Returns Integer
18302>>>>>>>>>        Integer retVal
18302>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
18303>>>>>>>>>        Function_Return retVal
18304>>>>>>>>>    End_Function
18305>>>>>>>>>
18305>>>>>>>>>    Procedure Set ComIconId Integer value
18307>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
18308>>>>>>>>>    End_Procedure
18309>>>>>>>>>
18309>>>>>>>>>    Function ComDefaultItem Returns Boolean
18311>>>>>>>>>        Boolean retVal
18311>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
18312>>>>>>>>>        Function_Return retVal
18313>>>>>>>>>    End_Function
18314>>>>>>>>>
18314>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
18316>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
18317>>>>>>>>>    End_Procedure
18318>>>>>>>>>
18318>>>>>>>>>    Function ComFlags Returns XTPControlFlags
18320>>>>>>>>>        XTPControlFlags retVal
18320>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
18321>>>>>>>>>        Function_Return retVal
18322>>>>>>>>>    End_Function
18323>>>>>>>>>
18323>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
18325>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
18326>>>>>>>>>    End_Procedure
18327>>>>>>>>>
18327>>>>>>>>>    Function ComCategory Returns String
18329>>>>>>>>>        String retVal
18329>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
18330>>>>>>>>>        Function_Return retVal
18331>>>>>>>>>    End_Function
18332>>>>>>>>>
18332>>>>>>>>>    Procedure Set ComCategory String value
18334>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
18335>>>>>>>>>    End_Procedure
18336>>>>>>>>>
18336>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
18338>>>>>>>>>        XTPControlHideFlags retVal
18338>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
18339>>>>>>>>>        Function_Return retVal
18340>>>>>>>>>    End_Function
18341>>>>>>>>>
18341>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
18343>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
18344>>>>>>>>>    End_Procedure
18345>>>>>>>>>
18345>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
18347>>>>>>>>>        Boolean retVal
18347>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
18348>>>>>>>>>        Function_Return retVal
18349>>>>>>>>>    End_Function
18350>>>>>>>>>
18350>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
18352>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
18353>>>>>>>>>    End_Procedure
18354>>>>>>>>>
18354>>>>>>>>>    Function ComAction Returns Variant
18356>>>>>>>>>        Variant retVal
18356>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
18357>>>>>>>>>        Function_Return retVal
18358>>>>>>>>>    End_Function
18359>>>>>>>>>
18359>>>>>>>>>    Procedure Set ComAction Variant value
18361>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
18362>>>>>>>>>    End_Procedure
18363>>>>>>>>>
18363>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
18365>>>>>>>>>        Integer retVal
18365>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
18366>>>>>>>>>        Function_Return retVal
18367>>>>>>>>>    End_Function
18368>>>>>>>>>
18368>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
18370>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
18371>>>>>>>>>    End_Procedure
18372>>>>>>>>>
18372>>>>>>>>>    Function ComWidth Returns Integer
18374>>>>>>>>>        Integer retVal
18374>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
18375>>>>>>>>>        Function_Return retVal
18376>>>>>>>>>    End_Function
18377>>>>>>>>>
18377>>>>>>>>>    Procedure Set ComWidth Integer value
18379>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
18380>>>>>>>>>    End_Procedure
18381>>>>>>>>>
18381>>>>>>>>>    Function ComHeight Returns Integer
18383>>>>>>>>>        Integer retVal
18383>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
18384>>>>>>>>>        Function_Return retVal
18385>>>>>>>>>    End_Function
18386>>>>>>>>>
18386>>>>>>>>>    Procedure Set ComHeight Integer value
18388>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
18389>>>>>>>>>    End_Procedure
18390>>>>>>>>>
18390>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
18392>>>>>>>>>        XTPButtonStyle retVal
18392>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
18393>>>>>>>>>        Function_Return retVal
18394>>>>>>>>>    End_Function
18395>>>>>>>>>
18395>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
18397>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
18398>>>>>>>>>    End_Procedure
18399>>>>>>>>>
18399>>>>>>>>>    Function ComKeyboardTip Returns String
18401>>>>>>>>>        String retVal
18401>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
18402>>>>>>>>>        Function_Return retVal
18403>>>>>>>>>    End_Function
18404>>>>>>>>>
18404>>>>>>>>>    Procedure Set ComKeyboardTip String value
18406>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
18407>>>>>>>>>    End_Procedure
18408>>>>>>>>>
18408>>>>>>>>>    Function ComCommandBar Returns Variant
18410>>>>>>>>>        Variant retVal
18410>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to retVal
18411>>>>>>>>>        Function_Return retVal
18412>>>>>>>>>    End_Function
18413>>>>>>>>>
18413>>>>>>>>>    Procedure Set ComCommandBar Variant value
18415>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to value
18416>>>>>>>>>    End_Procedure
18417>>>>>>>>>
18417>>>>>>>>>    Function ComDropDownWidth Returns Integer
18419>>>>>>>>>        Integer retVal
18419>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to retVal
18420>>>>>>>>>        Function_Return retVal
18421>>>>>>>>>    End_Function
18422>>>>>>>>>
18422>>>>>>>>>    Procedure Set ComDropDownWidth Integer value
18424>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to value
18425>>>>>>>>>    End_Procedure
18426>>>>>>>>>
18426>>>>>>>>>    Function ComDropDownListStyle Returns Boolean
18428>>>>>>>>>        Boolean retVal
18428>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BOOL to retVal
18429>>>>>>>>>        Function_Return retVal
18430>>>>>>>>>    End_Function
18431>>>>>>>>>
18431>>>>>>>>>    Procedure Set ComDropDownListStyle Boolean value
18433>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BOOL to value
18434>>>>>>>>>    End_Procedure
18435>>>>>>>>>
18435>>>>>>>>>    Function ComListIndex Returns Integer
18437>>>>>>>>>        Integer retVal
18437>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_I4 to retVal
18438>>>>>>>>>        Function_Return retVal
18439>>>>>>>>>    End_Function
18440>>>>>>>>>
18440>>>>>>>>>    Procedure Set ComListIndex Integer value
18442>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_I4 to value
18443>>>>>>>>>    End_Procedure
18444>>>>>>>>>
18444>>>>>>>>>    Function ComText Returns String
18446>>>>>>>>>        String retVal
18446>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 59 OLE_VT_BSTR to retVal
18447>>>>>>>>>        Function_Return retVal
18448>>>>>>>>>    End_Function
18449>>>>>>>>>
18449>>>>>>>>>    Procedure Set ComText String value
18451>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 59 OLE_VT_BSTR to value
18452>>>>>>>>>    End_Procedure
18453>>>>>>>>>
18453>>>>>>>>>    Function ComEditHint Returns String
18455>>>>>>>>>        String retVal
18455>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 67 OLE_VT_BSTR to retVal
18456>>>>>>>>>        Function_Return retVal
18457>>>>>>>>>    End_Function
18458>>>>>>>>>
18458>>>>>>>>>    Procedure Set ComEditHint String value
18460>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 67 OLE_VT_BSTR to value
18461>>>>>>>>>    End_Procedure
18462>>>>>>>>>
18462>>>>>>>>>    Function ComAutoComplete Returns Boolean
18464>>>>>>>>>        Boolean retVal
18464>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 68 OLE_VT_BOOL to retVal
18465>>>>>>>>>        Function_Return retVal
18466>>>>>>>>>    End_Function
18467>>>>>>>>>
18467>>>>>>>>>    Procedure Set ComAutoComplete Boolean value
18469>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 68 OLE_VT_BOOL to value
18470>>>>>>>>>    End_Procedure
18471>>>>>>>>>
18471>>>>>>>>>    Function ComShellAutoComplete Returns XTPShellAutoCompleteFlags
18473>>>>>>>>>        XTPShellAutoCompleteFlags retVal
18473>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_I4 to retVal
18474>>>>>>>>>        Function_Return retVal
18475>>>>>>>>>    End_Function
18476>>>>>>>>>
18476>>>>>>>>>    Procedure Set ComShellAutoComplete XTPShellAutoCompleteFlags value
18478>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_I4 to value
18479>>>>>>>>>    End_Procedure
18480>>>>>>>>>
18480>>>>>>>>>    Function ComEditIconId Returns Integer
18482>>>>>>>>>        Integer retVal
18482>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_I4 to retVal
18483>>>>>>>>>        Function_Return retVal
18484>>>>>>>>>    End_Function
18485>>>>>>>>>
18485>>>>>>>>>    Procedure Set ComEditIconId Integer value
18487>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_I4 to value
18488>>>>>>>>>    End_Procedure
18489>>>>>>>>>
18489>>>>>>>>>    Function ComEditStyle Returns XTPCommandBarEditStyle
18491>>>>>>>>>        XTPCommandBarEditStyle retVal
18491>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_I4 to retVal
18492>>>>>>>>>        Function_Return retVal
18493>>>>>>>>>    End_Function
18494>>>>>>>>>
18494>>>>>>>>>    Procedure Set ComEditStyle XTPCommandBarEditStyle value
18496>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_I4 to value
18497>>>>>>>>>    End_Procedure
18498>>>>>>>>>
18498>>>>>>>>>    Function ComDropDownItemCount Returns Integer
18500>>>>>>>>>        Integer retVal
18500>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 72 OLE_VT_I4 to retVal
18501>>>>>>>>>        Function_Return retVal
18502>>>>>>>>>    End_Function
18503>>>>>>>>>
18503>>>>>>>>>    Procedure Set ComDropDownItemCount Integer value
18505>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 72 OLE_VT_I4 to value
18506>>>>>>>>>    End_Procedure
18507>>>>>>>>>
18507>>>>>>>>>    Function ComThemedItems Returns Boolean
18509>>>>>>>>>        Boolean retVal
18509>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 73 OLE_VT_BOOL to retVal
18510>>>>>>>>>        Function_Return retVal
18511>>>>>>>>>    End_Function
18512>>>>>>>>>
18512>>>>>>>>>    Procedure Set ComThemedItems Boolean value
18514>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 73 OLE_VT_BOOL to value
18515>>>>>>>>>    End_Procedure
18516>>>>>>>>>
18516>>>>>>>>>    Function ComListIconId Returns Integer
18518>>>>>>>>>        Integer retVal
18518>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 74 OLE_VT_I4 to retVal
18519>>>>>>>>>        Function_Return retVal
18520>>>>>>>>>    End_Function
18521>>>>>>>>>
18521>>>>>>>>>    Procedure Set ComListIconId Integer value
18523>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 74 OLE_VT_I4 to value
18524>>>>>>>>>    End_Procedure
18525>>>>>>>>>
18525>>>>>>>>>    Function ComTextLimit Returns Integer
18527>>>>>>>>>        Integer retVal
18527>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 80 OLE_VT_I4 to retVal
18528>>>>>>>>>        Function_Return retVal
18529>>>>>>>>>    End_Function
18530>>>>>>>>>
18530>>>>>>>>>    Procedure Set ComTextLimit Integer value
18532>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 80 OLE_VT_I4 to value
18533>>>>>>>>>    End_Procedure
18534>>>>>>>>>
18534>>>>>>>>>    Function ComControls Returns Variant
18536>>>>>>>>>        Handle hDispatchDriver
18536>>>>>>>>>        Variant retVal
18536>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18537>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
18538>>>>>>>>>        Function_Return retVal
18539>>>>>>>>>    End_Function
18540>>>>>>>>>
18540>>>>>>>>>    Function ComParent Returns Variant
18542>>>>>>>>>        Handle hDispatchDriver
18542>>>>>>>>>        Variant retVal
18542>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18543>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
18544>>>>>>>>>        Function_Return retVal
18545>>>>>>>>>    End_Function
18546>>>>>>>>>
18546>>>>>>>>>    Function ComIndex Returns Integer
18548>>>>>>>>>        Handle hDispatchDriver
18548>>>>>>>>>        Integer retVal
18548>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18549>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
18550>>>>>>>>>        Function_Return retVal
18551>>>>>>>>>    End_Function
18552>>>>>>>>>
18552>>>>>>>>>    Function ComType Returns XTPControlType
18554>>>>>>>>>        Handle hDispatchDriver
18554>>>>>>>>>        XTPControlType retVal
18554>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18555>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
18556>>>>>>>>>        Function_Return retVal
18557>>>>>>>>>    End_Function
18558>>>>>>>>>
18558>>>>>>>>>    Procedure ComDelete
18560>>>>>>>>>        Handle hDispatchDriver
18560>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18561>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
18562>>>>>>>>>    End_Procedure
18563>>>>>>>>>
18563>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
18565>>>>>>>>>        Handle hDispatchDriver
18565>>>>>>>>>        Variant retVal
18565>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18566>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18567>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
18568>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
18569>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
18570>>>>>>>>>        Function_Return retVal
18571>>>>>>>>>    End_Function
18572>>>>>>>>>
18572>>>>>>>>>    Procedure ComSetFocus
18574>>>>>>>>>        Handle hDispatchDriver
18574>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18575>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
18576>>>>>>>>>    End_Procedure
18577>>>>>>>>>
18577>>>>>>>>>    Procedure ComExecute
18579>>>>>>>>>        Handle hDispatchDriver
18579>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18580>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
18581>>>>>>>>>    End_Procedure
18582>>>>>>>>>
18582>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
18584>>>>>>>>>        Handle hDispatchDriver
18584>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18585>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
18586>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
18587>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
18588>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
18589>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
18590>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
18591>>>>>>>>>    End_Procedure
18592>>>>>>>>>
18592>>>>>>>>>    Function ComRibbonGroup Returns Variant
18594>>>>>>>>>        Handle hDispatchDriver
18594>>>>>>>>>        Variant retVal
18594>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18595>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
18596>>>>>>>>>        Function_Return retVal
18597>>>>>>>>>    End_Function
18598>>>>>>>>>
18598>>>>>>>>>    Procedure ComReset
18600>>>>>>>>>        Handle hDispatchDriver
18600>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18601>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
18602>>>>>>>>>    End_Procedure
18603>>>>>>>>>
18603>>>>>>>>>    Function ComTop Returns Integer
18605>>>>>>>>>        Handle hDispatchDriver
18605>>>>>>>>>        Integer retVal
18605>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18606>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
18607>>>>>>>>>        Function_Return retVal
18608>>>>>>>>>    End_Function
18609>>>>>>>>>
18609>>>>>>>>>    Function ComLeft Returns Integer
18611>>>>>>>>>        Handle hDispatchDriver
18611>>>>>>>>>        Integer retVal
18611>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18612>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
18613>>>>>>>>>        Function_Return retVal
18614>>>>>>>>>    End_Function
18615>>>>>>>>>
18615>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
18617>>>>>>>>>        Handle hDispatchDriver
18617>>>>>>>>>        Variant retVal
18617>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18618>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18619>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
18620>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
18621>>>>>>>>>        Function_Return retVal
18622>>>>>>>>>    End_Function
18623>>>>>>>>>
18623>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
18625>>>>>>>>>        Handle hDispatchDriver
18625>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18626>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18627>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
18628>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
18629>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
18630>>>>>>>>>    End_Procedure
18631>>>>>>>>>
18631>>>>>>>>>    Procedure ComAddItem String llText Variant llIndex
18633>>>>>>>>>        Handle hDispatchDriver
18633>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18634>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18635>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llText
18636>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llIndex
18637>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 51 OLE_VT_VOID
18638>>>>>>>>>    End_Procedure
18639>>>>>>>>>
18639>>>>>>>>>    Function ComList Integer llIndex Returns String
18641>>>>>>>>>        Handle hDispatchDriver
18641>>>>>>>>>        String retVal
18641>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18642>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18643>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
18644>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 55 OLE_VT_BSTR to retVal
18645>>>>>>>>>        Function_Return retVal
18646>>>>>>>>>    End_Function
18647>>>>>>>>>
18647>>>>>>>>>    Procedure ComClear
18649>>>>>>>>>        Handle hDispatchDriver
18649>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18650>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 56 OLE_VT_VOID
18651>>>>>>>>>    End_Procedure
18652>>>>>>>>>
18652>>>>>>>>>    Function ComListCount Returns Integer
18654>>>>>>>>>        Handle hDispatchDriver
18654>>>>>>>>>        Integer retVal
18654>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18655>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 57 OLE_VT_I4 to retVal
18656>>>>>>>>>        Function_Return retVal
18657>>>>>>>>>    End_Function
18658>>>>>>>>>
18658>>>>>>>>>    Procedure ComRemoveItem Integer llnIndex
18660>>>>>>>>>        Handle hDispatchDriver
18660>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18661>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18662>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llnIndex
18663>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 58 OLE_VT_VOID
18664>>>>>>>>>    End_Procedure
18665>>>>>>>>>
18665>>>>>>>>>    Function ComFindItem String llText Returns Integer
18667>>>>>>>>>        Handle hDispatchDriver
18667>>>>>>>>>        Integer retVal
18667>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18668>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18669>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llText
18670>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 61 OLE_VT_I4 to retVal
18671>>>>>>>>>        Function_Return retVal
18672>>>>>>>>>    End_Function
18673>>>>>>>>>
18673>>>>>>>>>    Function ComItemData Integer llIndex Returns Integer
18675>>>>>>>>>        Handle hDispatchDriver
18675>>>>>>>>>        Integer retVal
18675>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18676>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
18677>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
18678>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 62 OLE_VT_I4 to retVal
18679>>>>>>>>>        Function_Return retVal
18680>>>>>>>>>    End_Function
18681>>>>>>>>>
18681>>>>>>>>>    Procedure Set ComItemData Integer llIndex Integer value
18683>>>>>>>>>        Handle hDispatchDriver
18683>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18684>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18685>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
18686>>>>>>>>>        Set ComProperty of hDispatchDriver 62 OLE_VT_I4 to value
18687>>>>>>>>>    End_Procedure
18688>>>>>>>>>
18688>>>>>>>>>    Function ComEditHandle Returns OLE_HANDLE
18690>>>>>>>>>        Handle hDispatchDriver
18690>>>>>>>>>        OLE_HANDLE retVal
18690>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18691>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 63 OLE_VT_I4 to retVal
18692>>>>>>>>>        Function_Return retVal
18693>>>>>>>>>    End_Function
18694>>>>>>>>>
18694>>>>>>>>>    Function ComHasFocus Returns Boolean
18696>>>>>>>>>        Handle hDispatchDriver
18696>>>>>>>>>        Boolean retVal
18696>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18697>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 66 OLE_VT_BOOL to retVal
18698>>>>>>>>>        Function_Return retVal
18699>>>>>>>>>    End_Function
18700>>>>>>>>>End_Class
18701>>>>>>>>>
18701>>>>>>>>>// CoClass
18701>>>>>>>>>// CLSID: {DACCCE94-B90A-44F8-86C2-B28D4540ABFA}
18701>>>>>>>>>Class cCJCommandBarComboBox is a cComAutomationObject
18702>>>>>>>>>    Import_Class_Protocol cCJICommandBarComboBox
18703>>>>>>>>>
18703>>>>>>>>>    Procedure Construct_Object
18705>>>>>>>>>        Forward Send Construct_Object
18707>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
18708>>>>>>>>>    End_Procedure
18709>>>>>>>>>End_Class
18710>>>>>>>>>
18710>>>>>>>>>// CLSID: {FA3F389C-1A6F-478C-8C8D-38C067A2BC1F}
18710>>>>>>>>>Class cCJICommandBarCheckBox is a Mixin
18711>>>>>>>>>
18711>>>>>>>>>    Function ComChecked Returns Integer
18713>>>>>>>>>        Integer retVal
18713>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_I4 to retVal
18714>>>>>>>>>        Function_Return retVal
18715>>>>>>>>>    End_Function
18716>>>>>>>>>
18716>>>>>>>>>    Procedure Set ComChecked Integer value
18718>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_I4 to value
18719>>>>>>>>>    End_Procedure
18720>>>>>>>>>
18720>>>>>>>>>    Function ComBeginGroup Returns Boolean
18722>>>>>>>>>        Boolean retVal
18722>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
18723>>>>>>>>>        Function_Return retVal
18724>>>>>>>>>    End_Function
18725>>>>>>>>>
18725>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
18727>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
18728>>>>>>>>>    End_Procedure
18729>>>>>>>>>
18729>>>>>>>>>    Function ComCaption Returns String
18731>>>>>>>>>        String retVal
18731>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
18732>>>>>>>>>        Function_Return retVal
18733>>>>>>>>>    End_Function
18734>>>>>>>>>
18734>>>>>>>>>    Procedure Set ComCaption String value
18736>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
18737>>>>>>>>>    End_Procedure
18738>>>>>>>>>
18738>>>>>>>>>    Function ComDescriptionText Returns String
18740>>>>>>>>>        String retVal
18740>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
18741>>>>>>>>>        Function_Return retVal
18742>>>>>>>>>    End_Function
18743>>>>>>>>>
18743>>>>>>>>>    Procedure Set ComDescriptionText String value
18745>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
18746>>>>>>>>>    End_Procedure
18747>>>>>>>>>
18747>>>>>>>>>    Function ComId Returns Integer
18749>>>>>>>>>        Integer retVal
18749>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
18750>>>>>>>>>        Function_Return retVal
18751>>>>>>>>>    End_Function
18752>>>>>>>>>
18752>>>>>>>>>    Procedure Set ComId Integer value
18754>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
18755>>>>>>>>>    End_Procedure
18756>>>>>>>>>
18756>>>>>>>>>    Function ComParameter Returns String
18758>>>>>>>>>        String retVal
18758>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
18759>>>>>>>>>        Function_Return retVal
18760>>>>>>>>>    End_Function
18761>>>>>>>>>
18761>>>>>>>>>    Procedure Set ComParameter String value
18763>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
18764>>>>>>>>>    End_Procedure
18765>>>>>>>>>
18765>>>>>>>>>    Function ComShortcutText Returns String
18767>>>>>>>>>        String retVal
18767>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
18768>>>>>>>>>        Function_Return retVal
18769>>>>>>>>>    End_Function
18770>>>>>>>>>
18770>>>>>>>>>    Procedure Set ComShortcutText String value
18772>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
18773>>>>>>>>>    End_Procedure
18774>>>>>>>>>
18774>>>>>>>>>    Function ComCustomShortcutText Returns String
18776>>>>>>>>>        String retVal
18776>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
18777>>>>>>>>>        Function_Return retVal
18778>>>>>>>>>    End_Function
18779>>>>>>>>>
18779>>>>>>>>>    Procedure Set ComCustomShortcutText String value
18781>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
18782>>>>>>>>>    End_Procedure
18783>>>>>>>>>
18783>>>>>>>>>    Function ComTooltipText Returns String
18785>>>>>>>>>        String retVal
18785>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
18786>>>>>>>>>        Function_Return retVal
18787>>>>>>>>>    End_Function
18788>>>>>>>>>
18788>>>>>>>>>    Procedure Set ComTooltipText String value
18790>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
18791>>>>>>>>>    End_Procedure
18792>>>>>>>>>
18792>>>>>>>>>    Function ComVisible Returns Boolean
18794>>>>>>>>>        Boolean retVal
18794>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
18795>>>>>>>>>        Function_Return retVal
18796>>>>>>>>>    End_Function
18797>>>>>>>>>
18797>>>>>>>>>    Procedure Set ComVisible Boolean value
18799>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
18800>>>>>>>>>    End_Procedure
18801>>>>>>>>>
18801>>>>>>>>>    Function ComEnabled Returns Boolean
18803>>>>>>>>>        Boolean retVal
18803>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
18804>>>>>>>>>        Function_Return retVal
18805>>>>>>>>>    End_Function
18806>>>>>>>>>
18806>>>>>>>>>    Procedure Set ComEnabled Boolean value
18808>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
18809>>>>>>>>>    End_Procedure
18810>>>>>>>>>
18810>>>>>>>>>    Function ComIconId Returns Integer
18812>>>>>>>>>        Integer retVal
18812>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
18813>>>>>>>>>        Function_Return retVal
18814>>>>>>>>>    End_Function
18815>>>>>>>>>
18815>>>>>>>>>    Procedure Set ComIconId Integer value
18817>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
18818>>>>>>>>>    End_Procedure
18819>>>>>>>>>
18819>>>>>>>>>    Function ComDefaultItem Returns Boolean
18821>>>>>>>>>        Boolean retVal
18821>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
18822>>>>>>>>>        Function_Return retVal
18823>>>>>>>>>    End_Function
18824>>>>>>>>>
18824>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
18826>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
18827>>>>>>>>>    End_Procedure
18828>>>>>>>>>
18828>>>>>>>>>    Function ComFlags Returns XTPControlFlags
18830>>>>>>>>>        XTPControlFlags retVal
18830>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
18831>>>>>>>>>        Function_Return retVal
18832>>>>>>>>>    End_Function
18833>>>>>>>>>
18833>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
18835>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
18836>>>>>>>>>    End_Procedure
18837>>>>>>>>>
18837>>>>>>>>>    Function ComCategory Returns String
18839>>>>>>>>>        String retVal
18839>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
18840>>>>>>>>>        Function_Return retVal
18841>>>>>>>>>    End_Function
18842>>>>>>>>>
18842>>>>>>>>>    Procedure Set ComCategory String value
18844>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
18845>>>>>>>>>    End_Procedure
18846>>>>>>>>>
18846>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
18848>>>>>>>>>        XTPControlHideFlags retVal
18848>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
18849>>>>>>>>>        Function_Return retVal
18850>>>>>>>>>    End_Function
18851>>>>>>>>>
18851>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
18853>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
18854>>>>>>>>>    End_Procedure
18855>>>>>>>>>
18855>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
18857>>>>>>>>>        Boolean retVal
18857>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
18858>>>>>>>>>        Function_Return retVal
18859>>>>>>>>>    End_Function
18860>>>>>>>>>
18860>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
18862>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
18863>>>>>>>>>    End_Procedure
18864>>>>>>>>>
18864>>>>>>>>>    Function ComAction Returns Variant
18866>>>>>>>>>        Variant retVal
18866>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
18867>>>>>>>>>        Function_Return retVal
18868>>>>>>>>>    End_Function
18869>>>>>>>>>
18869>>>>>>>>>    Procedure Set ComAction Variant value
18871>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
18872>>>>>>>>>    End_Procedure
18873>>>>>>>>>
18873>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
18875>>>>>>>>>        Integer retVal
18875>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
18876>>>>>>>>>        Function_Return retVal
18877>>>>>>>>>    End_Function
18878>>>>>>>>>
18878>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
18880>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
18881>>>>>>>>>    End_Procedure
18882>>>>>>>>>
18882>>>>>>>>>    Function ComWidth Returns Integer
18884>>>>>>>>>        Integer retVal
18884>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
18885>>>>>>>>>        Function_Return retVal
18886>>>>>>>>>    End_Function
18887>>>>>>>>>
18887>>>>>>>>>    Procedure Set ComWidth Integer value
18889>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
18890>>>>>>>>>    End_Procedure
18891>>>>>>>>>
18891>>>>>>>>>    Function ComHeight Returns Integer
18893>>>>>>>>>        Integer retVal
18893>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
18894>>>>>>>>>        Function_Return retVal
18895>>>>>>>>>    End_Function
18896>>>>>>>>>
18896>>>>>>>>>    Procedure Set ComHeight Integer value
18898>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
18899>>>>>>>>>    End_Procedure
18900>>>>>>>>>
18900>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
18902>>>>>>>>>        XTPButtonStyle retVal
18902>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
18903>>>>>>>>>        Function_Return retVal
18904>>>>>>>>>    End_Function
18905>>>>>>>>>
18905>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
18907>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
18908>>>>>>>>>    End_Procedure
18909>>>>>>>>>
18909>>>>>>>>>    Function ComKeyboardTip Returns String
18911>>>>>>>>>        String retVal
18911>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
18912>>>>>>>>>        Function_Return retVal
18913>>>>>>>>>    End_Function
18914>>>>>>>>>
18914>>>>>>>>>    Procedure Set ComKeyboardTip String value
18916>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
18917>>>>>>>>>    End_Procedure
18918>>>>>>>>>
18918>>>>>>>>>    Function ComControls Returns Variant
18920>>>>>>>>>        Handle hDispatchDriver
18920>>>>>>>>>        Variant retVal
18920>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18921>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
18922>>>>>>>>>        Function_Return retVal
18923>>>>>>>>>    End_Function
18924>>>>>>>>>
18924>>>>>>>>>    Function ComParent Returns Variant
18926>>>>>>>>>        Handle hDispatchDriver
18926>>>>>>>>>        Variant retVal
18926>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18927>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
18928>>>>>>>>>        Function_Return retVal
18929>>>>>>>>>    End_Function
18930>>>>>>>>>
18930>>>>>>>>>    Function ComIndex Returns Integer
18932>>>>>>>>>        Handle hDispatchDriver
18932>>>>>>>>>        Integer retVal
18932>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18933>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
18934>>>>>>>>>        Function_Return retVal
18935>>>>>>>>>    End_Function
18936>>>>>>>>>
18936>>>>>>>>>    Function ComType Returns XTPControlType
18938>>>>>>>>>        Handle hDispatchDriver
18938>>>>>>>>>        XTPControlType retVal
18938>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18939>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
18940>>>>>>>>>        Function_Return retVal
18941>>>>>>>>>    End_Function
18942>>>>>>>>>
18942>>>>>>>>>    Procedure ComDelete
18944>>>>>>>>>        Handle hDispatchDriver
18944>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18945>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
18946>>>>>>>>>    End_Procedure
18947>>>>>>>>>
18947>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
18949>>>>>>>>>        Handle hDispatchDriver
18949>>>>>>>>>        Variant retVal
18949>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18950>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
18951>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
18952>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
18953>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
18954>>>>>>>>>        Function_Return retVal
18955>>>>>>>>>    End_Function
18956>>>>>>>>>
18956>>>>>>>>>    Procedure ComSetFocus
18958>>>>>>>>>        Handle hDispatchDriver
18958>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18959>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
18960>>>>>>>>>    End_Procedure
18961>>>>>>>>>
18961>>>>>>>>>    Procedure ComExecute
18963>>>>>>>>>        Handle hDispatchDriver
18963>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18964>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
18965>>>>>>>>>    End_Procedure
18966>>>>>>>>>
18966>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
18968>>>>>>>>>        Handle hDispatchDriver
18968>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18969>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
18970>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
18971>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
18972>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
18973>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
18974>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
18975>>>>>>>>>    End_Procedure
18976>>>>>>>>>
18976>>>>>>>>>    Function ComRibbonGroup Returns Variant
18978>>>>>>>>>        Handle hDispatchDriver
18978>>>>>>>>>        Variant retVal
18978>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18979>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
18980>>>>>>>>>        Function_Return retVal
18981>>>>>>>>>    End_Function
18982>>>>>>>>>
18982>>>>>>>>>    Procedure ComReset
18984>>>>>>>>>        Handle hDispatchDriver
18984>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18985>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
18986>>>>>>>>>    End_Procedure
18987>>>>>>>>>
18987>>>>>>>>>    Function ComTop Returns Integer
18989>>>>>>>>>        Handle hDispatchDriver
18989>>>>>>>>>        Integer retVal
18989>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18990>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
18991>>>>>>>>>        Function_Return retVal
18992>>>>>>>>>    End_Function
18993>>>>>>>>>
18993>>>>>>>>>    Function ComLeft Returns Integer
18995>>>>>>>>>        Handle hDispatchDriver
18995>>>>>>>>>        Integer retVal
18995>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
18996>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
18997>>>>>>>>>        Function_Return retVal
18998>>>>>>>>>    End_Function
18999>>>>>>>>>
18999>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
19001>>>>>>>>>        Handle hDispatchDriver
19001>>>>>>>>>        Variant retVal
19001>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19002>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19003>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
19004>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
19005>>>>>>>>>        Function_Return retVal
19006>>>>>>>>>    End_Function
19007>>>>>>>>>
19007>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
19009>>>>>>>>>        Handle hDispatchDriver
19009>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19010>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19011>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
19012>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
19013>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
19014>>>>>>>>>    End_Procedure
19015>>>>>>>>>End_Class
19016>>>>>>>>>
19016>>>>>>>>>// CoClass
19016>>>>>>>>>// CLSID: {FA3CCE94-B90A-44F8-86C2-B28D4540ABFA}
19016>>>>>>>>>Class cCJCommandBarCheckBox is a cComAutomationObject
19017>>>>>>>>>    Import_Class_Protocol cCJICommandBarCheckBox
19018>>>>>>>>>
19018>>>>>>>>>    Procedure Construct_Object
19020>>>>>>>>>        Forward Send Construct_Object
19022>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
19023>>>>>>>>>    End_Procedure
19024>>>>>>>>>End_Class
19025>>>>>>>>>
19025>>>>>>>>>// CLSID: {03C5E982-7A03-46D9-B095-9FB1F825530D}
19025>>>>>>>>>Class cCJICommandBarEdit is a Mixin
19026>>>>>>>>>
19026>>>>>>>>>    Function ComChecked Returns Boolean
19028>>>>>>>>>        Boolean retVal
19028>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
19029>>>>>>>>>        Function_Return retVal
19030>>>>>>>>>    End_Function
19031>>>>>>>>>
19031>>>>>>>>>    Procedure Set ComChecked Boolean value
19033>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
19034>>>>>>>>>    End_Procedure
19035>>>>>>>>>
19035>>>>>>>>>    Function ComBeginGroup Returns Boolean
19037>>>>>>>>>        Boolean retVal
19037>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
19038>>>>>>>>>        Function_Return retVal
19039>>>>>>>>>    End_Function
19040>>>>>>>>>
19040>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
19042>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
19043>>>>>>>>>    End_Procedure
19044>>>>>>>>>
19044>>>>>>>>>    Function ComCaption Returns String
19046>>>>>>>>>        String retVal
19046>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
19047>>>>>>>>>        Function_Return retVal
19048>>>>>>>>>    End_Function
19049>>>>>>>>>
19049>>>>>>>>>    Procedure Set ComCaption String value
19051>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
19052>>>>>>>>>    End_Procedure
19053>>>>>>>>>
19053>>>>>>>>>    Function ComDescriptionText Returns String
19055>>>>>>>>>        String retVal
19055>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
19056>>>>>>>>>        Function_Return retVal
19057>>>>>>>>>    End_Function
19058>>>>>>>>>
19058>>>>>>>>>    Procedure Set ComDescriptionText String value
19060>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
19061>>>>>>>>>    End_Procedure
19062>>>>>>>>>
19062>>>>>>>>>    Function ComId Returns Integer
19064>>>>>>>>>        Integer retVal
19064>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
19065>>>>>>>>>        Function_Return retVal
19066>>>>>>>>>    End_Function
19067>>>>>>>>>
19067>>>>>>>>>    Procedure Set ComId Integer value
19069>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
19070>>>>>>>>>    End_Procedure
19071>>>>>>>>>
19071>>>>>>>>>    Function ComParameter Returns String
19073>>>>>>>>>        String retVal
19073>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
19074>>>>>>>>>        Function_Return retVal
19075>>>>>>>>>    End_Function
19076>>>>>>>>>
19076>>>>>>>>>    Procedure Set ComParameter String value
19078>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
19079>>>>>>>>>    End_Procedure
19080>>>>>>>>>
19080>>>>>>>>>    Function ComShortcutText Returns String
19082>>>>>>>>>        String retVal
19082>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
19083>>>>>>>>>        Function_Return retVal
19084>>>>>>>>>    End_Function
19085>>>>>>>>>
19085>>>>>>>>>    Procedure Set ComShortcutText String value
19087>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
19088>>>>>>>>>    End_Procedure
19089>>>>>>>>>
19089>>>>>>>>>    Function ComCustomShortcutText Returns String
19091>>>>>>>>>        String retVal
19091>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
19092>>>>>>>>>        Function_Return retVal
19093>>>>>>>>>    End_Function
19094>>>>>>>>>
19094>>>>>>>>>    Procedure Set ComCustomShortcutText String value
19096>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
19097>>>>>>>>>    End_Procedure
19098>>>>>>>>>
19098>>>>>>>>>    Function ComTooltipText Returns String
19100>>>>>>>>>        String retVal
19100>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
19101>>>>>>>>>        Function_Return retVal
19102>>>>>>>>>    End_Function
19103>>>>>>>>>
19103>>>>>>>>>    Procedure Set ComTooltipText String value
19105>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
19106>>>>>>>>>    End_Procedure
19107>>>>>>>>>
19107>>>>>>>>>    Function ComVisible Returns Boolean
19109>>>>>>>>>        Boolean retVal
19109>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
19110>>>>>>>>>        Function_Return retVal
19111>>>>>>>>>    End_Function
19112>>>>>>>>>
19112>>>>>>>>>    Procedure Set ComVisible Boolean value
19114>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
19115>>>>>>>>>    End_Procedure
19116>>>>>>>>>
19116>>>>>>>>>    Function ComEnabled Returns Boolean
19118>>>>>>>>>        Boolean retVal
19118>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
19119>>>>>>>>>        Function_Return retVal
19120>>>>>>>>>    End_Function
19121>>>>>>>>>
19121>>>>>>>>>    Procedure Set ComEnabled Boolean value
19123>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
19124>>>>>>>>>    End_Procedure
19125>>>>>>>>>
19125>>>>>>>>>    Function ComIconId Returns Integer
19127>>>>>>>>>        Integer retVal
19127>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
19128>>>>>>>>>        Function_Return retVal
19129>>>>>>>>>    End_Function
19130>>>>>>>>>
19130>>>>>>>>>    Procedure Set ComIconId Integer value
19132>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
19133>>>>>>>>>    End_Procedure
19134>>>>>>>>>
19134>>>>>>>>>    Function ComDefaultItem Returns Boolean
19136>>>>>>>>>        Boolean retVal
19136>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
19137>>>>>>>>>        Function_Return retVal
19138>>>>>>>>>    End_Function
19139>>>>>>>>>
19139>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
19141>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
19142>>>>>>>>>    End_Procedure
19143>>>>>>>>>
19143>>>>>>>>>    Function ComFlags Returns XTPControlFlags
19145>>>>>>>>>        XTPControlFlags retVal
19145>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
19146>>>>>>>>>        Function_Return retVal
19147>>>>>>>>>    End_Function
19148>>>>>>>>>
19148>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
19150>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
19151>>>>>>>>>    End_Procedure
19152>>>>>>>>>
19152>>>>>>>>>    Function ComCategory Returns String
19154>>>>>>>>>        String retVal
19154>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
19155>>>>>>>>>        Function_Return retVal
19156>>>>>>>>>    End_Function
19157>>>>>>>>>
19157>>>>>>>>>    Procedure Set ComCategory String value
19159>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
19160>>>>>>>>>    End_Procedure
19161>>>>>>>>>
19161>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
19163>>>>>>>>>        XTPControlHideFlags retVal
19163>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
19164>>>>>>>>>        Function_Return retVal
19165>>>>>>>>>    End_Function
19166>>>>>>>>>
19166>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
19168>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
19169>>>>>>>>>    End_Procedure
19170>>>>>>>>>
19170>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
19172>>>>>>>>>        Boolean retVal
19172>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
19173>>>>>>>>>        Function_Return retVal
19174>>>>>>>>>    End_Function
19175>>>>>>>>>
19175>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
19177>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
19178>>>>>>>>>    End_Procedure
19179>>>>>>>>>
19179>>>>>>>>>    Function ComAction Returns Variant
19181>>>>>>>>>        Variant retVal
19181>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
19182>>>>>>>>>        Function_Return retVal
19183>>>>>>>>>    End_Function
19184>>>>>>>>>
19184>>>>>>>>>    Procedure Set ComAction Variant value
19186>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
19187>>>>>>>>>    End_Procedure
19188>>>>>>>>>
19188>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
19190>>>>>>>>>        Integer retVal
19190>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
19191>>>>>>>>>        Function_Return retVal
19192>>>>>>>>>    End_Function
19193>>>>>>>>>
19193>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
19195>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
19196>>>>>>>>>    End_Procedure
19197>>>>>>>>>
19197>>>>>>>>>    Function ComWidth Returns Integer
19199>>>>>>>>>        Integer retVal
19199>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
19200>>>>>>>>>        Function_Return retVal
19201>>>>>>>>>    End_Function
19202>>>>>>>>>
19202>>>>>>>>>    Procedure Set ComWidth Integer value
19204>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
19205>>>>>>>>>    End_Procedure
19206>>>>>>>>>
19206>>>>>>>>>    Function ComHeight Returns Integer
19208>>>>>>>>>        Integer retVal
19208>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
19209>>>>>>>>>        Function_Return retVal
19210>>>>>>>>>    End_Function
19211>>>>>>>>>
19211>>>>>>>>>    Procedure Set ComHeight Integer value
19213>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
19214>>>>>>>>>    End_Procedure
19215>>>>>>>>>
19215>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
19217>>>>>>>>>        XTPButtonStyle retVal
19217>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
19218>>>>>>>>>        Function_Return retVal
19219>>>>>>>>>    End_Function
19220>>>>>>>>>
19220>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
19222>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
19223>>>>>>>>>    End_Procedure
19224>>>>>>>>>
19224>>>>>>>>>    Function ComKeyboardTip Returns String
19226>>>>>>>>>        String retVal
19226>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
19227>>>>>>>>>        Function_Return retVal
19228>>>>>>>>>    End_Function
19229>>>>>>>>>
19229>>>>>>>>>    Procedure Set ComKeyboardTip String value
19231>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
19232>>>>>>>>>    End_Procedure
19233>>>>>>>>>
19233>>>>>>>>>    Function ComShowLabel Returns Boolean
19235>>>>>>>>>        Boolean retVal
19235>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_BOOL to retVal
19236>>>>>>>>>        Function_Return retVal
19237>>>>>>>>>    End_Function
19238>>>>>>>>>
19238>>>>>>>>>    Procedure Set ComShowLabel Boolean value
19240>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_BOOL to value
19241>>>>>>>>>    End_Procedure
19242>>>>>>>>>
19242>>>>>>>>>    Function ComText Returns String
19244>>>>>>>>>        String retVal
19244>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 59 OLE_VT_BSTR to retVal
19245>>>>>>>>>        Function_Return retVal
19246>>>>>>>>>    End_Function
19247>>>>>>>>>
19247>>>>>>>>>    Procedure Set ComText String value
19249>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 59 OLE_VT_BSTR to value
19250>>>>>>>>>    End_Procedure
19251>>>>>>>>>
19251>>>>>>>>>    Function ComReadOnly Returns Boolean
19253>>>>>>>>>        Boolean retVal
19253>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_BOOL to retVal
19254>>>>>>>>>        Function_Return retVal
19255>>>>>>>>>    End_Function
19256>>>>>>>>>
19256>>>>>>>>>    Procedure Set ComReadOnly Boolean value
19258>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 60 OLE_VT_BOOL to value
19259>>>>>>>>>    End_Procedure
19260>>>>>>>>>
19260>>>>>>>>>    Function ComEditHint Returns String
19262>>>>>>>>>        String retVal
19262>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 67 OLE_VT_BSTR to retVal
19263>>>>>>>>>        Function_Return retVal
19264>>>>>>>>>    End_Function
19265>>>>>>>>>
19265>>>>>>>>>    Procedure Set ComEditHint String value
19267>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 67 OLE_VT_BSTR to value
19268>>>>>>>>>    End_Procedure
19269>>>>>>>>>
19269>>>>>>>>>    Function ComShellAutoComplete Returns XTPShellAutoCompleteFlags
19271>>>>>>>>>        XTPShellAutoCompleteFlags retVal
19271>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_I4 to retVal
19272>>>>>>>>>        Function_Return retVal
19273>>>>>>>>>    End_Function
19274>>>>>>>>>
19274>>>>>>>>>    Procedure Set ComShellAutoComplete XTPShellAutoCompleteFlags value
19276>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 69 OLE_VT_I4 to value
19277>>>>>>>>>    End_Procedure
19278>>>>>>>>>
19278>>>>>>>>>    Function ComEditIconId Returns Integer
19280>>>>>>>>>        Integer retVal
19280>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_I4 to retVal
19281>>>>>>>>>        Function_Return retVal
19282>>>>>>>>>    End_Function
19283>>>>>>>>>
19283>>>>>>>>>    Procedure Set ComEditIconId Integer value
19285>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_I4 to value
19286>>>>>>>>>    End_Procedure
19287>>>>>>>>>
19287>>>>>>>>>    Function ComEditStyle Returns XTPCommandBarEditStyle
19289>>>>>>>>>        XTPCommandBarEditStyle retVal
19289>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_I4 to retVal
19290>>>>>>>>>        Function_Return retVal
19291>>>>>>>>>    End_Function
19292>>>>>>>>>
19292>>>>>>>>>    Procedure Set ComEditStyle XTPCommandBarEditStyle value
19294>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 71 OLE_VT_I4 to value
19295>>>>>>>>>    End_Procedure
19296>>>>>>>>>
19296>>>>>>>>>    Function ComShowSpinButtons Returns Boolean
19298>>>>>>>>>        Boolean retVal
19298>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 72 OLE_VT_BOOL to retVal
19299>>>>>>>>>        Function_Return retVal
19300>>>>>>>>>    End_Function
19301>>>>>>>>>
19301>>>>>>>>>    Procedure Set ComShowSpinButtons Boolean value
19303>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 72 OLE_VT_BOOL to value
19304>>>>>>>>>    End_Procedure
19305>>>>>>>>>
19305>>>>>>>>>    Function ComBuddyButtonId Returns Integer
19307>>>>>>>>>        Integer retVal
19307>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 81 OLE_VT_I4 to retVal
19308>>>>>>>>>        Function_Return retVal
19309>>>>>>>>>    End_Function
19310>>>>>>>>>
19310>>>>>>>>>    Procedure Set ComBuddyButtonId Integer value
19312>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 81 OLE_VT_I4 to value
19313>>>>>>>>>    End_Procedure
19314>>>>>>>>>
19314>>>>>>>>>    Function ComTextLimit Returns Integer
19316>>>>>>>>>        Integer retVal
19316>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 80 OLE_VT_I4 to retVal
19317>>>>>>>>>        Function_Return retVal
19318>>>>>>>>>    End_Function
19319>>>>>>>>>
19319>>>>>>>>>    Procedure Set ComTextLimit Integer value
19321>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 80 OLE_VT_I4 to value
19322>>>>>>>>>    End_Procedure
19323>>>>>>>>>
19323>>>>>>>>>    Function ComControls Returns Variant
19325>>>>>>>>>        Handle hDispatchDriver
19325>>>>>>>>>        Variant retVal
19325>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19326>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
19327>>>>>>>>>        Function_Return retVal
19328>>>>>>>>>    End_Function
19329>>>>>>>>>
19329>>>>>>>>>    Function ComParent Returns Variant
19331>>>>>>>>>        Handle hDispatchDriver
19331>>>>>>>>>        Variant retVal
19331>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19332>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
19333>>>>>>>>>        Function_Return retVal
19334>>>>>>>>>    End_Function
19335>>>>>>>>>
19335>>>>>>>>>    Function ComIndex Returns Integer
19337>>>>>>>>>        Handle hDispatchDriver
19337>>>>>>>>>        Integer retVal
19337>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19338>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
19339>>>>>>>>>        Function_Return retVal
19340>>>>>>>>>    End_Function
19341>>>>>>>>>
19341>>>>>>>>>    Function ComType Returns XTPControlType
19343>>>>>>>>>        Handle hDispatchDriver
19343>>>>>>>>>        XTPControlType retVal
19343>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19344>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
19345>>>>>>>>>        Function_Return retVal
19346>>>>>>>>>    End_Function
19347>>>>>>>>>
19347>>>>>>>>>    Procedure ComDelete
19349>>>>>>>>>        Handle hDispatchDriver
19349>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19350>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
19351>>>>>>>>>    End_Procedure
19352>>>>>>>>>
19352>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
19354>>>>>>>>>        Handle hDispatchDriver
19354>>>>>>>>>        Variant retVal
19354>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19355>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19356>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
19357>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
19358>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
19359>>>>>>>>>        Function_Return retVal
19360>>>>>>>>>    End_Function
19361>>>>>>>>>
19361>>>>>>>>>    Procedure ComSetFocus
19363>>>>>>>>>        Handle hDispatchDriver
19363>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19364>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
19365>>>>>>>>>    End_Procedure
19366>>>>>>>>>
19366>>>>>>>>>    Procedure ComExecute
19368>>>>>>>>>        Handle hDispatchDriver
19368>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19369>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
19370>>>>>>>>>    End_Procedure
19371>>>>>>>>>
19371>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
19373>>>>>>>>>        Handle hDispatchDriver
19373>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19374>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
19375>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
19376>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
19377>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
19378>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
19379>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
19380>>>>>>>>>    End_Procedure
19381>>>>>>>>>
19381>>>>>>>>>    Function ComRibbonGroup Returns Variant
19383>>>>>>>>>        Handle hDispatchDriver
19383>>>>>>>>>        Variant retVal
19383>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19384>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
19385>>>>>>>>>        Function_Return retVal
19386>>>>>>>>>    End_Function
19387>>>>>>>>>
19387>>>>>>>>>    Procedure ComReset
19389>>>>>>>>>        Handle hDispatchDriver
19389>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19390>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
19391>>>>>>>>>    End_Procedure
19392>>>>>>>>>
19392>>>>>>>>>    Function ComTop Returns Integer
19394>>>>>>>>>        Handle hDispatchDriver
19394>>>>>>>>>        Integer retVal
19394>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19395>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
19396>>>>>>>>>        Function_Return retVal
19397>>>>>>>>>    End_Function
19398>>>>>>>>>
19398>>>>>>>>>    Function ComLeft Returns Integer
19400>>>>>>>>>        Handle hDispatchDriver
19400>>>>>>>>>        Integer retVal
19400>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19401>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
19402>>>>>>>>>        Function_Return retVal
19403>>>>>>>>>    End_Function
19404>>>>>>>>>
19404>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
19406>>>>>>>>>        Handle hDispatchDriver
19406>>>>>>>>>        Variant retVal
19406>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19407>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19408>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
19409>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
19410>>>>>>>>>        Function_Return retVal
19411>>>>>>>>>    End_Function
19412>>>>>>>>>
19412>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
19414>>>>>>>>>        Handle hDispatchDriver
19414>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19415>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19416>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
19417>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
19418>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
19419>>>>>>>>>    End_Procedure
19420>>>>>>>>>
19420>>>>>>>>>    Function ComEditHandle Returns OLE_HANDLE
19422>>>>>>>>>        Handle hDispatchDriver
19422>>>>>>>>>        OLE_HANDLE retVal
19422>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19423>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 63 OLE_VT_I4 to retVal
19424>>>>>>>>>        Function_Return retVal
19425>>>>>>>>>    End_Function
19426>>>>>>>>>
19426>>>>>>>>>    Function ComHasFocus Returns Boolean
19428>>>>>>>>>        Handle hDispatchDriver
19428>>>>>>>>>        Boolean retVal
19428>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19429>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 66 OLE_VT_BOOL to retVal
19430>>>>>>>>>        Function_Return retVal
19431>>>>>>>>>    End_Function
19432>>>>>>>>>End_Class
19433>>>>>>>>>
19433>>>>>>>>>// CoClass
19433>>>>>>>>>// CLSID: {7EA9957E-3096-4792-B180-D404D55E8532}
19433>>>>>>>>>Class cCJCommandBarEdit is a cComAutomationObject
19434>>>>>>>>>    Import_Class_Protocol cCJICommandBarEdit
19435>>>>>>>>>
19435>>>>>>>>>    Procedure Construct_Object
19437>>>>>>>>>        Forward Send Construct_Object
19439>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
19440>>>>>>>>>    End_Procedure
19441>>>>>>>>>End_Class
19442>>>>>>>>>
19442>>>>>>>>>// CLSID: {A5CE0F75-CB1F-40FD-B073-4BC151A5205F}
19442>>>>>>>>>Class cCJICommandBarControlCustom is a Mixin
19443>>>>>>>>>
19443>>>>>>>>>    Function ComChecked Returns Boolean
19445>>>>>>>>>        Boolean retVal
19445>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
19446>>>>>>>>>        Function_Return retVal
19447>>>>>>>>>    End_Function
19448>>>>>>>>>
19448>>>>>>>>>    Procedure Set ComChecked Boolean value
19450>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
19451>>>>>>>>>    End_Procedure
19452>>>>>>>>>
19452>>>>>>>>>    Function ComBeginGroup Returns Boolean
19454>>>>>>>>>        Boolean retVal
19454>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
19455>>>>>>>>>        Function_Return retVal
19456>>>>>>>>>    End_Function
19457>>>>>>>>>
19457>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
19459>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
19460>>>>>>>>>    End_Procedure
19461>>>>>>>>>
19461>>>>>>>>>    Function ComCaption Returns String
19463>>>>>>>>>        String retVal
19463>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
19464>>>>>>>>>        Function_Return retVal
19465>>>>>>>>>    End_Function
19466>>>>>>>>>
19466>>>>>>>>>    Procedure Set ComCaption String value
19468>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
19469>>>>>>>>>    End_Procedure
19470>>>>>>>>>
19470>>>>>>>>>    Function ComDescriptionText Returns String
19472>>>>>>>>>        String retVal
19472>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
19473>>>>>>>>>        Function_Return retVal
19474>>>>>>>>>    End_Function
19475>>>>>>>>>
19475>>>>>>>>>    Procedure Set ComDescriptionText String value
19477>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
19478>>>>>>>>>    End_Procedure
19479>>>>>>>>>
19479>>>>>>>>>    Function ComId Returns Integer
19481>>>>>>>>>        Integer retVal
19481>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
19482>>>>>>>>>        Function_Return retVal
19483>>>>>>>>>    End_Function
19484>>>>>>>>>
19484>>>>>>>>>    Procedure Set ComId Integer value
19486>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
19487>>>>>>>>>    End_Procedure
19488>>>>>>>>>
19488>>>>>>>>>    Function ComParameter Returns String
19490>>>>>>>>>        String retVal
19490>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
19491>>>>>>>>>        Function_Return retVal
19492>>>>>>>>>    End_Function
19493>>>>>>>>>
19493>>>>>>>>>    Procedure Set ComParameter String value
19495>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
19496>>>>>>>>>    End_Procedure
19497>>>>>>>>>
19497>>>>>>>>>    Function ComShortcutText Returns String
19499>>>>>>>>>        String retVal
19499>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
19500>>>>>>>>>        Function_Return retVal
19501>>>>>>>>>    End_Function
19502>>>>>>>>>
19502>>>>>>>>>    Procedure Set ComShortcutText String value
19504>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
19505>>>>>>>>>    End_Procedure
19506>>>>>>>>>
19506>>>>>>>>>    Function ComCustomShortcutText Returns String
19508>>>>>>>>>        String retVal
19508>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
19509>>>>>>>>>        Function_Return retVal
19510>>>>>>>>>    End_Function
19511>>>>>>>>>
19511>>>>>>>>>    Procedure Set ComCustomShortcutText String value
19513>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
19514>>>>>>>>>    End_Procedure
19515>>>>>>>>>
19515>>>>>>>>>    Function ComTooltipText Returns String
19517>>>>>>>>>        String retVal
19517>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
19518>>>>>>>>>        Function_Return retVal
19519>>>>>>>>>    End_Function
19520>>>>>>>>>
19520>>>>>>>>>    Procedure Set ComTooltipText String value
19522>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
19523>>>>>>>>>    End_Procedure
19524>>>>>>>>>
19524>>>>>>>>>    Function ComVisible Returns Boolean
19526>>>>>>>>>        Boolean retVal
19526>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
19527>>>>>>>>>        Function_Return retVal
19528>>>>>>>>>    End_Function
19529>>>>>>>>>
19529>>>>>>>>>    Procedure Set ComVisible Boolean value
19531>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
19532>>>>>>>>>    End_Procedure
19533>>>>>>>>>
19533>>>>>>>>>    Function ComEnabled Returns Boolean
19535>>>>>>>>>        Boolean retVal
19535>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
19536>>>>>>>>>        Function_Return retVal
19537>>>>>>>>>    End_Function
19538>>>>>>>>>
19538>>>>>>>>>    Procedure Set ComEnabled Boolean value
19540>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
19541>>>>>>>>>    End_Procedure
19542>>>>>>>>>
19542>>>>>>>>>    Function ComIconId Returns Integer
19544>>>>>>>>>        Integer retVal
19544>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
19545>>>>>>>>>        Function_Return retVal
19546>>>>>>>>>    End_Function
19547>>>>>>>>>
19547>>>>>>>>>    Procedure Set ComIconId Integer value
19549>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
19550>>>>>>>>>    End_Procedure
19551>>>>>>>>>
19551>>>>>>>>>    Function ComDefaultItem Returns Boolean
19553>>>>>>>>>        Boolean retVal
19553>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
19554>>>>>>>>>        Function_Return retVal
19555>>>>>>>>>    End_Function
19556>>>>>>>>>
19556>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
19558>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
19559>>>>>>>>>    End_Procedure
19560>>>>>>>>>
19560>>>>>>>>>    Function ComFlags Returns XTPControlFlags
19562>>>>>>>>>        XTPControlFlags retVal
19562>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
19563>>>>>>>>>        Function_Return retVal
19564>>>>>>>>>    End_Function
19565>>>>>>>>>
19565>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
19567>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
19568>>>>>>>>>    End_Procedure
19569>>>>>>>>>
19569>>>>>>>>>    Function ComCategory Returns String
19571>>>>>>>>>        String retVal
19571>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
19572>>>>>>>>>        Function_Return retVal
19573>>>>>>>>>    End_Function
19574>>>>>>>>>
19574>>>>>>>>>    Procedure Set ComCategory String value
19576>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
19577>>>>>>>>>    End_Procedure
19578>>>>>>>>>
19578>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
19580>>>>>>>>>        XTPControlHideFlags retVal
19580>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
19581>>>>>>>>>        Function_Return retVal
19582>>>>>>>>>    End_Function
19583>>>>>>>>>
19583>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
19585>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
19586>>>>>>>>>    End_Procedure
19587>>>>>>>>>
19587>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
19589>>>>>>>>>        Boolean retVal
19589>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
19590>>>>>>>>>        Function_Return retVal
19591>>>>>>>>>    End_Function
19592>>>>>>>>>
19592>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
19594>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
19595>>>>>>>>>    End_Procedure
19596>>>>>>>>>
19596>>>>>>>>>    Function ComAction Returns Variant
19598>>>>>>>>>        Variant retVal
19598>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
19599>>>>>>>>>        Function_Return retVal
19600>>>>>>>>>    End_Function
19601>>>>>>>>>
19601>>>>>>>>>    Procedure Set ComAction Variant value
19603>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
19604>>>>>>>>>    End_Procedure
19605>>>>>>>>>
19605>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
19607>>>>>>>>>        Integer retVal
19607>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
19608>>>>>>>>>        Function_Return retVal
19609>>>>>>>>>    End_Function
19610>>>>>>>>>
19610>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
19612>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
19613>>>>>>>>>    End_Procedure
19614>>>>>>>>>
19614>>>>>>>>>    Function ComWidth Returns Integer
19616>>>>>>>>>        Integer retVal
19616>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
19617>>>>>>>>>        Function_Return retVal
19618>>>>>>>>>    End_Function
19619>>>>>>>>>
19619>>>>>>>>>    Procedure Set ComWidth Integer value
19621>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
19622>>>>>>>>>    End_Procedure
19623>>>>>>>>>
19623>>>>>>>>>    Function ComHeight Returns Integer
19625>>>>>>>>>        Integer retVal
19625>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
19626>>>>>>>>>        Function_Return retVal
19627>>>>>>>>>    End_Function
19628>>>>>>>>>
19628>>>>>>>>>    Procedure Set ComHeight Integer value
19630>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
19631>>>>>>>>>    End_Procedure
19632>>>>>>>>>
19632>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
19634>>>>>>>>>        XTPButtonStyle retVal
19634>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
19635>>>>>>>>>        Function_Return retVal
19636>>>>>>>>>    End_Function
19637>>>>>>>>>
19637>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
19639>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
19640>>>>>>>>>    End_Procedure
19641>>>>>>>>>
19641>>>>>>>>>    Function ComKeyboardTip Returns String
19643>>>>>>>>>        String retVal
19643>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
19644>>>>>>>>>        Function_Return retVal
19645>>>>>>>>>    End_Function
19646>>>>>>>>>
19646>>>>>>>>>    Procedure Set ComKeyboardTip String value
19648>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
19649>>>>>>>>>    End_Procedure
19650>>>>>>>>>
19650>>>>>>>>>    Function ComHandle Returns Integer
19652>>>>>>>>>        Integer retVal
19652>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to retVal
19653>>>>>>>>>        Function_Return retVal
19654>>>>>>>>>    End_Function
19655>>>>>>>>>
19655>>>>>>>>>    Procedure Set ComHandle Integer value
19657>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to value
19658>>>>>>>>>    End_Procedure
19659>>>>>>>>>
19659>>>>>>>>>    Function ComVerticalOptions Returns XTPControlCustomVerticalOptions
19661>>>>>>>>>        XTPControlCustomVerticalOptions retVal
19661>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to retVal
19662>>>>>>>>>        Function_Return retVal
19663>>>>>>>>>    End_Function
19664>>>>>>>>>
19664>>>>>>>>>    Procedure Set ComVerticalOptions XTPControlCustomVerticalOptions value
19666>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to value
19667>>>>>>>>>    End_Procedure
19668>>>>>>>>>
19668>>>>>>>>>    Function ComControls Returns Variant
19670>>>>>>>>>        Handle hDispatchDriver
19670>>>>>>>>>        Variant retVal
19670>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19671>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
19672>>>>>>>>>        Function_Return retVal
19673>>>>>>>>>    End_Function
19674>>>>>>>>>
19674>>>>>>>>>    Function ComParent Returns Variant
19676>>>>>>>>>        Handle hDispatchDriver
19676>>>>>>>>>        Variant retVal
19676>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19677>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
19678>>>>>>>>>        Function_Return retVal
19679>>>>>>>>>    End_Function
19680>>>>>>>>>
19680>>>>>>>>>    Function ComIndex Returns Integer
19682>>>>>>>>>        Handle hDispatchDriver
19682>>>>>>>>>        Integer retVal
19682>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19683>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
19684>>>>>>>>>        Function_Return retVal
19685>>>>>>>>>    End_Function
19686>>>>>>>>>
19686>>>>>>>>>    Function ComType Returns XTPControlType
19688>>>>>>>>>        Handle hDispatchDriver
19688>>>>>>>>>        XTPControlType retVal
19688>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19689>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
19690>>>>>>>>>        Function_Return retVal
19691>>>>>>>>>    End_Function
19692>>>>>>>>>
19692>>>>>>>>>    Procedure ComDelete
19694>>>>>>>>>        Handle hDispatchDriver
19694>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19695>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
19696>>>>>>>>>    End_Procedure
19697>>>>>>>>>
19697>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
19699>>>>>>>>>        Handle hDispatchDriver
19699>>>>>>>>>        Variant retVal
19699>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19700>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19701>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
19702>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
19703>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
19704>>>>>>>>>        Function_Return retVal
19705>>>>>>>>>    End_Function
19706>>>>>>>>>
19706>>>>>>>>>    Procedure ComSetFocus
19708>>>>>>>>>        Handle hDispatchDriver
19708>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19709>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
19710>>>>>>>>>    End_Procedure
19711>>>>>>>>>
19711>>>>>>>>>    Procedure ComExecute
19713>>>>>>>>>        Handle hDispatchDriver
19713>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19714>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
19715>>>>>>>>>    End_Procedure
19716>>>>>>>>>
19716>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
19718>>>>>>>>>        Handle hDispatchDriver
19718>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19719>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
19720>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
19721>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
19722>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
19723>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
19724>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
19725>>>>>>>>>    End_Procedure
19726>>>>>>>>>
19726>>>>>>>>>    Function ComRibbonGroup Returns Variant
19728>>>>>>>>>        Handle hDispatchDriver
19728>>>>>>>>>        Variant retVal
19728>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19729>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
19730>>>>>>>>>        Function_Return retVal
19731>>>>>>>>>    End_Function
19732>>>>>>>>>
19732>>>>>>>>>    Procedure ComReset
19734>>>>>>>>>        Handle hDispatchDriver
19734>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19735>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
19736>>>>>>>>>    End_Procedure
19737>>>>>>>>>
19737>>>>>>>>>    Function ComTop Returns Integer
19739>>>>>>>>>        Handle hDispatchDriver
19739>>>>>>>>>        Integer retVal
19739>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19740>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
19741>>>>>>>>>        Function_Return retVal
19742>>>>>>>>>    End_Function
19743>>>>>>>>>
19743>>>>>>>>>    Function ComLeft Returns Integer
19745>>>>>>>>>        Handle hDispatchDriver
19745>>>>>>>>>        Integer retVal
19745>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19746>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
19747>>>>>>>>>        Function_Return retVal
19748>>>>>>>>>    End_Function
19749>>>>>>>>>
19749>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
19751>>>>>>>>>        Handle hDispatchDriver
19751>>>>>>>>>        Variant retVal
19751>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19752>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19753>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
19754>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
19755>>>>>>>>>        Function_Return retVal
19756>>>>>>>>>    End_Function
19757>>>>>>>>>
19757>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
19759>>>>>>>>>        Handle hDispatchDriver
19759>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19760>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19761>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
19762>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
19763>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
19764>>>>>>>>>    End_Procedure
19765>>>>>>>>>
19765>>>>>>>>>    Procedure ComSetSize Integer llcx Integer llcy
19767>>>>>>>>>        Handle hDispatchDriver
19767>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19768>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19769>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
19770>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
19771>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 51 OLE_VT_VOID
19772>>>>>>>>>    End_Procedure
19773>>>>>>>>>End_Class
19774>>>>>>>>>
19774>>>>>>>>>// CoClass
19774>>>>>>>>>// CLSID: {1119957E-3096-4792-B180-D404D55E8532}
19774>>>>>>>>>Class cCJCommandBarControlCustom is a cComAutomationObject
19775>>>>>>>>>    Import_Class_Protocol cCJICommandBarControlCustom
19776>>>>>>>>>
19776>>>>>>>>>    Procedure Construct_Object
19778>>>>>>>>>        Forward Send Construct_Object
19780>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
19781>>>>>>>>>    End_Procedure
19782>>>>>>>>>End_Class
19783>>>>>>>>>
19783>>>>>>>>>// CLSID: {D87BCC77-27BF-4CB1-9ABF-1788D9835223}
19783>>>>>>>>>Class cCJICommandBarControls is a Mixin
19784>>>>>>>>>
19784>>>>>>>>>    // Gets the number of controls in the collection.
19784>>>>>>>>>    Function ComCount Returns Integer
19786>>>>>>>>>        Handle hDispatchDriver
19786>>>>>>>>>        Integer retVal
19786>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19787>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
19788>>>>>>>>>        Function_Return retVal
19789>>>>>>>>>    End_Function
19790>>>>>>>>>
19790>>>>>>>>>    // Gets an item from the collection by its index.
19790>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
19792>>>>>>>>>        Handle hDispatchDriver
19792>>>>>>>>>        Variant retVal
19792>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19793>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19794>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
19795>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
19796>>>>>>>>>        Function_Return retVal
19797>>>>>>>>>    End_Function
19798>>>>>>>>>
19798>>>>>>>>>    Function Com_NewEnum Returns Variant
19800>>>>>>>>>        Handle hDispatchDriver
19800>>>>>>>>>        Variant retVal
19800>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19801>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
19802>>>>>>>>>        Function_Return retVal
19803>>>>>>>>>    End_Function
19804>>>>>>>>>
19804>>>>>>>>>    // Adds a new command bar control to the collection.
19804>>>>>>>>>    Function ComAdd XTPControlType llType Integer llId String llCaption Variant llBefore Variant llTemporary Returns Variant
19806>>>>>>>>>        Handle hDispatchDriver
19806>>>>>>>>>        Variant retVal
19806>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19807>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
19808>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llType
19809>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
19810>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
19811>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
19812>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llTemporary
19813>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
19814>>>>>>>>>        Function_Return retVal
19815>>>>>>>>>    End_Function
19816>>>>>>>>>
19816>>>>>>>>>    // Gets the popup control representing the parent of the command bar
19816>>>>>>>>>    Function ComParent Returns Variant
19818>>>>>>>>>        Handle hDispatchDriver
19818>>>>>>>>>        Variant retVal
19818>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19819>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_DISPATCH to retVal
19820>>>>>>>>>        Function_Return retVal
19821>>>>>>>>>    End_Function
19822>>>>>>>>>
19822>>>>>>>>>    // Finds the specified control
19822>>>>>>>>>    Function ComFind Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
19824>>>>>>>>>        Handle hDispatchDriver
19824>>>>>>>>>        Variant retVal
19824>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19825>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
19826>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
19827>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
19828>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
19829>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
19830>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
19831>>>>>>>>>        Function_Return retVal
19832>>>>>>>>>    End_Function
19833>>>>>>>>>
19833>>>>>>>>>    // Deletes all of the command bar controls from the collection
19833>>>>>>>>>    Procedure ComDeleteAll
19835>>>>>>>>>        Handle hDispatchDriver
19835>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19836>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
19837>>>>>>>>>    End_Procedure
19838>>>>>>>>>
19838>>>>>>>>>    // Recreates original controls
19838>>>>>>>>>    Procedure ComCreateOriginalControls
19840>>>>>>>>>        Handle hDispatchDriver
19840>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19841>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
19842>>>>>>>>>    End_Procedure
19843>>>>>>>>>
19843>>>>>>>>>    // Retrieve original controls
19843>>>>>>>>>    Function ComOriginalControls Returns Variant
19845>>>>>>>>>        Handle hDispatchDriver
19845>>>>>>>>>        Variant retVal
19845>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19846>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_DISPATCH to retVal
19847>>>>>>>>>        Function_Return retVal
19848>>>>>>>>>    End_Function
19849>>>>>>>>>
19849>>>>>>>>>    Procedure ComAddControl Variant llControl Variant llBefore
19851>>>>>>>>>        Handle hDispatchDriver
19851>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19852>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19853>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llControl
19854>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
19855>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
19856>>>>>>>>>    End_Procedure
19857>>>>>>>>>End_Class
19858>>>>>>>>>
19858>>>>>>>>>// CoClass
19858>>>>>>>>>// CLSID: {803455AF-3543-4D3E-88F9-4F8822200142}
19858>>>>>>>>>Class cCJCommandBarControls is a cComAutomationObject
19859>>>>>>>>>    Import_Class_Protocol cCJICommandBarControls
19860>>>>>>>>>
19860>>>>>>>>>    Procedure Construct_Object
19862>>>>>>>>>        Forward Send Construct_Object
19864>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
19865>>>>>>>>>    End_Procedure
19866>>>>>>>>>End_Class
19867>>>>>>>>>
19867>>>>>>>>>// CLSID: {5BE5CC96-7369-4EAB-9B25-1D5C52916D86}
19867>>>>>>>>>Class cCJIKeyBinding is a Mixin
19868>>>>>>>>>
19868>>>>>>>>>    Function ComCommand Returns Integer
19870>>>>>>>>>        Integer retVal
19870>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
19871>>>>>>>>>        Function_Return retVal
19872>>>>>>>>>    End_Function
19873>>>>>>>>>
19873>>>>>>>>>    Procedure Set ComCommand Integer value
19875>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
19876>>>>>>>>>    End_Procedure
19877>>>>>>>>>
19877>>>>>>>>>    Function ComShortcutText Returns String
19879>>>>>>>>>        String retVal
19879>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
19880>>>>>>>>>        Function_Return retVal
19881>>>>>>>>>    End_Function
19882>>>>>>>>>
19882>>>>>>>>>    Procedure Set ComShortcutText String value
19884>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
19885>>>>>>>>>    End_Procedure
19886>>>>>>>>>End_Class
19887>>>>>>>>>
19887>>>>>>>>>// CoClass
19887>>>>>>>>>// CLSID: {87644A92-EA68-4E0D-946F-45694C26F6BA}
19887>>>>>>>>>Class cCJKeyBinding is a cComAutomationObject
19888>>>>>>>>>    Import_Class_Protocol cCJIKeyBinding
19889>>>>>>>>>
19889>>>>>>>>>    Procedure Construct_Object
19891>>>>>>>>>        Forward Send Construct_Object
19893>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
19894>>>>>>>>>    End_Procedure
19895>>>>>>>>>End_Class
19896>>>>>>>>>
19896>>>>>>>>>// CLSID: {4BE5CC96-7369-4EAB-9B25-1D5C52916D86}
19896>>>>>>>>>Class cCJIKeyBindings is a Mixin
19897>>>>>>>>>
19897>>>>>>>>>    Function ComUseSystemKeyNameText Returns Boolean
19899>>>>>>>>>        Boolean retVal
19899>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
19900>>>>>>>>>        Function_Return retVal
19901>>>>>>>>>    End_Function
19902>>>>>>>>>
19902>>>>>>>>>    Procedure Set ComUseSystemKeyNameText Boolean value
19904>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
19905>>>>>>>>>    End_Procedure
19906>>>>>>>>>
19906>>>>>>>>>    Function ComAllowDoubleKeyShortcuts Returns Boolean
19908>>>>>>>>>        Boolean retVal
19908>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
19909>>>>>>>>>        Function_Return retVal
19910>>>>>>>>>    End_Function
19911>>>>>>>>>
19911>>>>>>>>>    Procedure Set ComAllowDoubleKeyShortcuts Boolean value
19913>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
19914>>>>>>>>>    End_Procedure
19915>>>>>>>>>
19915>>>>>>>>>    Function ComEnabled Returns Boolean
19917>>>>>>>>>        Boolean retVal
19917>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
19918>>>>>>>>>        Function_Return retVal
19919>>>>>>>>>    End_Function
19920>>>>>>>>>
19920>>>>>>>>>    Procedure Set ComEnabled Boolean value
19922>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
19923>>>>>>>>>    End_Procedure
19924>>>>>>>>>
19924>>>>>>>>>    Function ComDisableOnCapture Returns Boolean
19926>>>>>>>>>        Boolean retVal
19926>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
19927>>>>>>>>>        Function_Return retVal
19928>>>>>>>>>    End_Function
19929>>>>>>>>>
19929>>>>>>>>>    Procedure Set ComDisableOnCapture Boolean value
19931>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
19932>>>>>>>>>    End_Procedure
19933>>>>>>>>>
19933>>>>>>>>>    Function ComEnableCustomShortcutText Returns Boolean
19935>>>>>>>>>        Boolean retVal
19935>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
19936>>>>>>>>>        Function_Return retVal
19937>>>>>>>>>    End_Function
19938>>>>>>>>>
19938>>>>>>>>>    Procedure Set ComEnableCustomShortcutText Boolean value
19940>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
19941>>>>>>>>>    End_Procedure
19942>>>>>>>>>
19942>>>>>>>>>    Procedure ComAdd Integer llfVirt Integer llKey Integer llCommand
19944>>>>>>>>>        Handle hDispatchDriver
19944>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19945>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
19946>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llfVirt
19947>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llKey
19948>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
19949>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 1 OLE_VT_VOID
19950>>>>>>>>>    End_Procedure
19951>>>>>>>>>
19951>>>>>>>>>    Procedure ComAddShortcut Integer llCommand String llShortcut
19953>>>>>>>>>        Handle hDispatchDriver
19953>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19954>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19955>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
19956>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llShortcut
19957>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
19958>>>>>>>>>    End_Procedure
19959>>>>>>>>>
19959>>>>>>>>>    Procedure ComDeleteAll
19961>>>>>>>>>        Handle hDispatchDriver
19961>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19962>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
19963>>>>>>>>>    End_Procedure
19964>>>>>>>>>
19964>>>>>>>>>    Procedure ComSetKeyNameText Integer llKey String llKeyName
19966>>>>>>>>>        Handle hDispatchDriver
19966>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19967>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
19968>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llKey
19969>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llKeyName
19970>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
19971>>>>>>>>>    End_Procedure
19972>>>>>>>>>
19972>>>>>>>>>    Procedure ComDelete Integer llCommand
19974>>>>>>>>>        Handle hDispatchDriver
19974>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19975>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19976>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
19977>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
19978>>>>>>>>>    End_Procedure
19979>>>>>>>>>
19979>>>>>>>>>    Function ComCount Returns Integer
19981>>>>>>>>>        Handle hDispatchDriver
19981>>>>>>>>>        Integer retVal
19981>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19982>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_I4 to retVal
19983>>>>>>>>>        Function_Return retVal
19984>>>>>>>>>    End_Function
19985>>>>>>>>>
19985>>>>>>>>>    Function Com_NewEnum Returns Variant
19987>>>>>>>>>        Handle hDispatchDriver
19987>>>>>>>>>        Variant retVal
19987>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19988>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
19989>>>>>>>>>        Function_Return retVal
19990>>>>>>>>>    End_Function
19991>>>>>>>>>
19991>>>>>>>>>    // Gets an item from the collection by its Id.
19991>>>>>>>>>    Function ComShortcut Integer llIndex Returns Variant
19993>>>>>>>>>        Handle hDispatchDriver
19993>>>>>>>>>        Variant retVal
19993>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
19994>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
19995>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
19996>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
19997>>>>>>>>>        Function_Return retVal
19998>>>>>>>>>    End_Function
19999>>>>>>>>>
19999>>>>>>>>>    Function ComFindShortcut Integer llCommand Returns Variant
20001>>>>>>>>>        Handle hDispatchDriver
20001>>>>>>>>>        Variant retVal
20001>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20002>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20003>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
20004>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
20005>>>>>>>>>        Function_Return retVal
20006>>>>>>>>>    End_Function
20007>>>>>>>>>End_Class
20008>>>>>>>>>
20008>>>>>>>>>// CLSID: {380A7B16-7BE8-42EC-870C-8849F5540F14}
20008>>>>>>>>>Class cCJIKeyBindingsEvents is a Mixin
20009>>>>>>>>>
20009>>>>>>>>>    Procedure OnComBeforeTranslate Integer llCommand Variant llCancel
20011>>>>>>>>>    End_Procedure
20012>>>>>>>>>
20012>>>>>>>>>    Procedure OnComBeforeAdd Integer llfVirt Integer llKey Integer llCommand Variant llCancel
20014>>>>>>>>>    End_Procedure
20015>>>>>>>>>
20015>>>>>>>>>    Procedure OnComBeforeRemove Integer llfVirt Integer llKey Integer llCommand Variant llCancel
20017>>>>>>>>>    End_Procedure
20018>>>>>>>>>
20018>>>>>>>>>    Procedure RegisterComEvents
20020>>>>>>>>>        Send RegisterComEvent 1 msg_OnComBeforeTranslate
20021>>>>>>>>>        Send RegisterComEvent 2 msg_OnComBeforeAdd
20022>>>>>>>>>        Send RegisterComEvent 3 msg_OnComBeforeRemove
20023>>>>>>>>>    End_Procedure
20024>>>>>>>>>End_Class
20025>>>>>>>>>
20025>>>>>>>>>// CoClass
20025>>>>>>>>>// CLSID: {CAA84A92-EA68-4E0D-946F-45694C26F6BA}
20025>>>>>>>>>Class cCJKeyBindings is a cComAutomationObject
20026>>>>>>>>>    Import_Class_Protocol cCJIKeyBindings
20027>>>>>>>>>    Import_Class_Protocol cCJIKeyBindingsEvents
20028>>>>>>>>>
20028>>>>>>>>>    Procedure Construct_Object
20030>>>>>>>>>        Forward Send Construct_Object
20032>>>>>>>>>        Set psEventId to "{380A7B16-7BE8-42EC-870C-8849F5540F14}"
20033>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
20034>>>>>>>>>    End_Procedure
20035>>>>>>>>>End_Class
20036>>>>>>>>>
20036>>>>>>>>>// CLSID: {42F4B293-5628-42A4-BDF8-08263B63FFEF}
20036>>>>>>>>>Class cCJICommandBarsOptions is a Mixin
20037>>>>>>>>>
20037>>>>>>>>>    Function ComAlwaysShowFullMenus Returns Boolean
20039>>>>>>>>>        Boolean retVal
20039>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
20040>>>>>>>>>        Function_Return retVal
20041>>>>>>>>>    End_Function
20042>>>>>>>>>
20042>>>>>>>>>    Procedure Set ComAlwaysShowFullMenus Boolean value
20044>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
20045>>>>>>>>>    End_Procedure
20046>>>>>>>>>
20046>>>>>>>>>    Function ComShowFullAfterDelay Returns Boolean
20048>>>>>>>>>        Boolean retVal
20048>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
20049>>>>>>>>>        Function_Return retVal
20050>>>>>>>>>    End_Function
20051>>>>>>>>>
20051>>>>>>>>>    Procedure Set ComShowFullAfterDelay Boolean value
20053>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
20054>>>>>>>>>    End_Procedure
20055>>>>>>>>>
20055>>>>>>>>>    Function ComToolBarScreenTips Returns Boolean
20057>>>>>>>>>        Boolean retVal
20057>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
20058>>>>>>>>>        Function_Return retVal
20059>>>>>>>>>    End_Function
20060>>>>>>>>>
20060>>>>>>>>>    Procedure Set ComToolBarScreenTips Boolean value
20062>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
20063>>>>>>>>>    End_Procedure
20064>>>>>>>>>
20064>>>>>>>>>    Function ComToolBarAccelTips Returns Boolean
20066>>>>>>>>>        Boolean retVal
20066>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
20067>>>>>>>>>        Function_Return retVal
20068>>>>>>>>>    End_Function
20069>>>>>>>>>
20069>>>>>>>>>    Procedure Set ComToolBarAccelTips Boolean value
20071>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
20072>>>>>>>>>    End_Procedure
20073>>>>>>>>>
20073>>>>>>>>>    Function ComLargeIcons Returns Boolean
20075>>>>>>>>>        Boolean retVal
20075>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
20076>>>>>>>>>        Function_Return retVal
20077>>>>>>>>>    End_Function
20078>>>>>>>>>
20078>>>>>>>>>    Procedure Set ComLargeIcons Boolean value
20080>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
20081>>>>>>>>>    End_Procedure
20082>>>>>>>>>
20082>>>>>>>>>    Function ComUseFadedIcons Returns Boolean
20084>>>>>>>>>        Boolean retVal
20084>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to retVal
20085>>>>>>>>>        Function_Return retVal
20086>>>>>>>>>    End_Function
20087>>>>>>>>>
20087>>>>>>>>>    Procedure Set ComUseFadedIcons Boolean value
20089>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_BOOL to value
20090>>>>>>>>>    End_Procedure
20091>>>>>>>>>
20091>>>>>>>>>    Function ComUseDisabledIcons Returns Boolean
20093>>>>>>>>>        Boolean retVal
20093>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
20094>>>>>>>>>        Function_Return retVal
20095>>>>>>>>>    End_Function
20096>>>>>>>>>
20096>>>>>>>>>    Procedure Set ComUseDisabledIcons Boolean value
20098>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
20099>>>>>>>>>    End_Procedure
20100>>>>>>>>>
20100>>>>>>>>>    Function ComIconsWithShadow Returns Boolean
20102>>>>>>>>>        Boolean retVal
20102>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
20103>>>>>>>>>        Function_Return retVal
20104>>>>>>>>>    End_Function
20105>>>>>>>>>
20105>>>>>>>>>    Procedure Set ComIconsWithShadow Boolean value
20107>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
20108>>>>>>>>>    End_Procedure
20109>>>>>>>>>
20109>>>>>>>>>    Function ComShowExpandButtonAlways Returns Boolean
20111>>>>>>>>>        Boolean retVal
20111>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to retVal
20112>>>>>>>>>        Function_Return retVal
20113>>>>>>>>>    End_Function
20114>>>>>>>>>
20114>>>>>>>>>    Procedure Set ComShowExpandButtonAlways Boolean value
20116>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to value
20117>>>>>>>>>    End_Procedure
20118>>>>>>>>>
20118>>>>>>>>>    Function ComAnimation Returns XTPAnimationType
20120>>>>>>>>>        XTPAnimationType retVal
20120>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_I4 to retVal
20121>>>>>>>>>        Function_Return retVal
20122>>>>>>>>>    End_Function
20123>>>>>>>>>
20123>>>>>>>>>    Procedure Set ComAnimation XTPAnimationType value
20125>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_I4 to value
20126>>>>>>>>>    End_Procedure
20127>>>>>>>>>
20127>>>>>>>>>    Function ComLunaColors Returns Boolean
20129>>>>>>>>>        Boolean retVal
20129>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
20130>>>>>>>>>        Function_Return retVal
20131>>>>>>>>>    End_Function
20132>>>>>>>>>
20132>>>>>>>>>    Procedure Set ComLunaColors Boolean value
20134>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
20135>>>>>>>>>    End_Procedure
20136>>>>>>>>>
20136>>>>>>>>>    Function ComUseSharedImageList Returns Boolean
20138>>>>>>>>>        Boolean retVal
20138>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
20139>>>>>>>>>        Function_Return retVal
20140>>>>>>>>>    End_Function
20141>>>>>>>>>
20141>>>>>>>>>    Procedure Set ComUseSharedImageList Boolean value
20143>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
20144>>>>>>>>>    End_Procedure
20145>>>>>>>>>
20145>>>>>>>>>    Function ComSyncFloatingToolbars Returns Boolean
20147>>>>>>>>>        Boolean retVal
20147>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_BOOL to retVal
20148>>>>>>>>>        Function_Return retVal
20149>>>>>>>>>    End_Function
20150>>>>>>>>>
20150>>>>>>>>>    Procedure Set ComSyncFloatingToolbars Boolean value
20152>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_BOOL to value
20153>>>>>>>>>    End_Procedure
20154>>>>>>>>>
20154>>>>>>>>>    Function ComFloatToolbarsByDoubleClick Returns Boolean
20156>>>>>>>>>        Boolean retVal
20156>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
20157>>>>>>>>>        Function_Return retVal
20158>>>>>>>>>    End_Function
20159>>>>>>>>>
20159>>>>>>>>>    Procedure Set ComFloatToolbarsByDoubleClick Boolean value
20161>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
20162>>>>>>>>>    End_Procedure
20163>>>>>>>>>
20163>>>>>>>>>    Function ComAutoHideUnusedPopups Returns Boolean
20165>>>>>>>>>        Boolean retVal
20165>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_BOOL to retVal
20166>>>>>>>>>        Function_Return retVal
20167>>>>>>>>>    End_Function
20168>>>>>>>>>
20168>>>>>>>>>    Procedure Set ComAutoHideUnusedPopups Boolean value
20170>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_BOOL to value
20171>>>>>>>>>    End_Procedure
20172>>>>>>>>>
20172>>>>>>>>>    Function ComShowPopupBarToolTips Returns Boolean
20174>>>>>>>>>        Boolean retVal
20174>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
20175>>>>>>>>>        Function_Return retVal
20176>>>>>>>>>    End_Function
20177>>>>>>>>>
20177>>>>>>>>>    Procedure Set ComShowPopupBarToolTips Boolean value
20179>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
20180>>>>>>>>>    End_Procedure
20181>>>>>>>>>
20181>>>>>>>>>    Function ComShowTextBelowIcons Returns Boolean
20183>>>>>>>>>        Boolean retVal
20183>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
20184>>>>>>>>>        Function_Return retVal
20185>>>>>>>>>    End_Function
20186>>>>>>>>>
20186>>>>>>>>>    Procedure Set ComShowTextBelowIcons Boolean value
20188>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
20189>>>>>>>>>    End_Procedure
20190>>>>>>>>>
20190>>>>>>>>>    Function ComUpdatePeriod Returns Integer
20192>>>>>>>>>        Integer retVal
20192>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_I4 to retVal
20193>>>>>>>>>        Function_Return retVal
20194>>>>>>>>>    End_Function
20195>>>>>>>>>
20195>>>>>>>>>    Procedure Set ComUpdatePeriod Integer value
20197>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_I4 to value
20198>>>>>>>>>    End_Procedure
20199>>>>>>>>>
20199>>>>>>>>>    Function ComAltDragCustomization Returns Boolean
20201>>>>>>>>>        Boolean retVal
20201>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
20202>>>>>>>>>        Function_Return retVal
20203>>>>>>>>>    End_Function
20204>>>>>>>>>
20204>>>>>>>>>    Procedure Set ComAltDragCustomization Boolean value
20206>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
20207>>>>>>>>>    End_Procedure
20208>>>>>>>>>
20208>>>>>>>>>    Function ComFont Returns Variant
20210>>>>>>>>>        Variant retVal
20210>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
20211>>>>>>>>>        Function_Return retVal
20212>>>>>>>>>    End_Function
20213>>>>>>>>>
20213>>>>>>>>>    Procedure Set ComFont Variant value
20215>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
20216>>>>>>>>>    End_Procedure
20217>>>>>>>>>
20217>>>>>>>>>    Function ComMaxPopupWidth Returns Real
20219>>>>>>>>>        Real retVal
20219>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_R8 to retVal
20220>>>>>>>>>        Function_Return retVal
20221>>>>>>>>>    End_Function
20222>>>>>>>>>
20222>>>>>>>>>    Procedure Set ComMaxPopupWidth Real value
20224>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_R8 to value
20225>>>>>>>>>    End_Procedure
20226>>>>>>>>>
20226>>>>>>>>>    Function ComKeyboardCuesShow Returns XTPKeyboardCuesShow
20228>>>>>>>>>        XTPKeyboardCuesShow retVal
20228>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to retVal
20229>>>>>>>>>        Function_Return retVal
20230>>>>>>>>>    End_Function
20231>>>>>>>>>
20231>>>>>>>>>    Procedure Set ComKeyboardCuesShow XTPKeyboardCuesShow value
20233>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to value
20234>>>>>>>>>    End_Procedure
20235>>>>>>>>>
20235>>>>>>>>>    Function ComKeyboardCuesUse Returns XTPKeyboardCuesUse
20237>>>>>>>>>        XTPKeyboardCuesUse retVal
20237>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to retVal
20238>>>>>>>>>        Function_Return retVal
20239>>>>>>>>>    End_Function
20240>>>>>>>>>
20240>>>>>>>>>    Procedure Set ComKeyboardCuesUse XTPKeyboardCuesUse value
20242>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to value
20243>>>>>>>>>    End_Procedure
20244>>>>>>>>>
20244>>>>>>>>>    Function ComFloatingBarCaptionFont Returns Variant
20246>>>>>>>>>        Variant retVal
20246>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_DISPATCH to retVal
20247>>>>>>>>>        Function_Return retVal
20248>>>>>>>>>    End_Function
20249>>>>>>>>>
20249>>>>>>>>>    Procedure Set ComFloatingBarCaptionFont Variant value
20251>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_DISPATCH to value
20252>>>>>>>>>    End_Procedure
20253>>>>>>>>>
20253>>>>>>>>>    Function ComComboBoxFont Returns Variant
20255>>>>>>>>>        Variant retVal
20255>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_DISPATCH to retVal
20256>>>>>>>>>        Function_Return retVal
20257>>>>>>>>>    End_Function
20258>>>>>>>>>
20258>>>>>>>>>    Procedure Set ComComboBoxFont Variant value
20260>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 27 OLE_VT_DISPATCH to value
20261>>>>>>>>>    End_Procedure
20262>>>>>>>>>
20262>>>>>>>>>    Function ComOfficeStyleDisabledIcons Returns Boolean
20264>>>>>>>>>        Boolean retVal
20264>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_BOOL to retVal
20265>>>>>>>>>        Function_Return retVal
20266>>>>>>>>>    End_Function
20267>>>>>>>>>
20267>>>>>>>>>    Procedure Set ComOfficeStyleDisabledIcons Boolean value
20269>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_BOOL to value
20270>>>>>>>>>    End_Procedure
20271>>>>>>>>>
20271>>>>>>>>>    Function ComExpandHoverDelay Returns Integer
20273>>>>>>>>>        Integer retVal
20273>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to retVal
20274>>>>>>>>>        Function_Return retVal
20275>>>>>>>>>    End_Function
20276>>>>>>>>>
20276>>>>>>>>>    Procedure Set ComExpandHoverDelay Integer value
20278>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_I4 to value
20279>>>>>>>>>    End_Procedure
20280>>>>>>>>>
20280>>>>>>>>>    Function ComExpandDelay Returns Integer
20282>>>>>>>>>        Integer retVal
20282>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
20283>>>>>>>>>        Function_Return retVal
20284>>>>>>>>>    End_Function
20285>>>>>>>>>
20285>>>>>>>>>    Procedure Set ComExpandDelay Integer value
20287>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
20288>>>>>>>>>    End_Procedure
20289>>>>>>>>>
20289>>>>>>>>>    Function ComUseAltNumPadKeys Returns Boolean
20291>>>>>>>>>        Boolean retVal
20291>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to retVal
20292>>>>>>>>>        Function_Return retVal
20293>>>>>>>>>    End_Function
20294>>>>>>>>>
20294>>>>>>>>>    Procedure Set ComUseAltNumPadKeys Boolean value
20296>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to value
20297>>>>>>>>>    End_Procedure
20298>>>>>>>>>
20298>>>>>>>>>    Function ComUseSystemSaveBitsStyle Returns Boolean
20300>>>>>>>>>        Boolean retVal
20300>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_BOOL to retVal
20301>>>>>>>>>        Function_Return retVal
20302>>>>>>>>>    End_Function
20303>>>>>>>>>
20303>>>>>>>>>    Procedure Set ComUseSystemSaveBitsStyle Boolean value
20305>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_BOOL to value
20306>>>>>>>>>    End_Procedure
20307>>>>>>>>>
20307>>>>>>>>>    Function ComWrapLargePopups Returns Boolean
20309>>>>>>>>>        Boolean retVal
20309>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to retVal
20310>>>>>>>>>        Function_Return retVal
20311>>>>>>>>>    End_Function
20312>>>>>>>>>
20312>>>>>>>>>    Procedure Set ComWrapLargePopups Boolean value
20314>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to value
20315>>>>>>>>>    End_Procedure
20316>>>>>>>>>
20316>>>>>>>>>    Function ComShowKeyboardTips Returns Boolean
20318>>>>>>>>>        Boolean retVal
20318>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_BOOL to retVal
20319>>>>>>>>>        Function_Return retVal
20320>>>>>>>>>    End_Function
20321>>>>>>>>>
20321>>>>>>>>>    Procedure Set ComShowKeyboardTips Boolean value
20323>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_BOOL to value
20324>>>>>>>>>    End_Procedure
20325>>>>>>>>>
20325>>>>>>>>>    Function ComShowContextMenuAccelerators Returns Boolean
20327>>>>>>>>>        Boolean retVal
20327>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 35 OLE_VT_BOOL to retVal
20328>>>>>>>>>        Function_Return retVal
20329>>>>>>>>>    End_Function
20330>>>>>>>>>
20330>>>>>>>>>    Procedure Set ComShowContextMenuAccelerators Boolean value
20332>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 35 OLE_VT_BOOL to value
20333>>>>>>>>>    End_Procedure
20334>>>>>>>>>
20334>>>>>>>>>    // Synchronizes the activation of the mini-frame windows to the activation of its parent window
20334>>>>>>>>>    Function ComSyncActiveFloatingFrames Returns Boolean
20336>>>>>>>>>        Boolean retVal
20336>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
20337>>>>>>>>>        Function_Return retVal
20338>>>>>>>>>    End_Function
20339>>>>>>>>>
20339>>>>>>>>>    // Synchronizes the activation of the mini-frame windows to the activation of its parent window
20339>>>>>>>>>    Procedure Set ComSyncActiveFloatingFrames Boolean value
20341>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
20342>>>>>>>>>    End_Procedure
20343>>>>>>>>>
20343>>>>>>>>>    Function ComShowMiniToolbarTips Returns Boolean
20345>>>>>>>>>        Boolean retVal
20345>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
20346>>>>>>>>>        Function_Return retVal
20347>>>>>>>>>    End_Function
20348>>>>>>>>>
20348>>>>>>>>>    Procedure Set ComShowMiniToolbarTips Boolean value
20350>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
20351>>>>>>>>>    End_Procedure
20352>>>>>>>>>
20352>>>>>>>>>    Procedure ComSetIconSize Boolean llLargeIcons Integer llcx Integer llcy
20354>>>>>>>>>        Handle hDispatchDriver
20354>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20355>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
20356>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llLargeIcons
20357>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
20358>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
20359>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
20360>>>>>>>>>    End_Procedure
20361>>>>>>>>>
20361>>>>>>>>>    Procedure ComAddHiddenCommand Integer llCommand
20363>>>>>>>>>        Handle hDispatchDriver
20363>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20364>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20365>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
20366>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 10 OLE_VT_VOID
20367>>>>>>>>>    End_Procedure
20368>>>>>>>>>
20368>>>>>>>>>    Procedure ComSetPopupIconSize Integer llcx Integer llcy
20370>>>>>>>>>        Handle hDispatchDriver
20370>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20371>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20372>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
20373>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
20374>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
20375>>>>>>>>>    End_Procedure
20376>>>>>>>>>
20376>>>>>>>>>    Procedure ComRemoveHiddenCommands
20378>>>>>>>>>        Handle hDispatchDriver
20378>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20379>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 36 OLE_VT_VOID
20380>>>>>>>>>    End_Procedure
20381>>>>>>>>>
20381>>>>>>>>>    Procedure ComSetDPIScallingOptions Boolean llbScaleGalleryItems Boolean llbScaleToolbarIcons
20383>>>>>>>>>        Handle hDispatchDriver
20383>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20384>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20385>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llbScaleGalleryItems
20386>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llbScaleToolbarIcons
20387>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 39 OLE_VT_VOID
20388>>>>>>>>>    End_Procedure
20389>>>>>>>>>End_Class
20390>>>>>>>>>
20390>>>>>>>>>// CoClass
20390>>>>>>>>>// CLSID: {73F6AF99-A0EA-4D8E-8A73-49D5D084F527}
20390>>>>>>>>>Class cCJCommandBarsOptions is a cComAutomationObject
20391>>>>>>>>>    Import_Class_Protocol cCJICommandBarsOptions
20392>>>>>>>>>
20392>>>>>>>>>    Procedure Construct_Object
20394>>>>>>>>>        Forward Send Construct_Object
20396>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
20397>>>>>>>>>    End_Procedure
20398>>>>>>>>>End_Class
20399>>>>>>>>>
20399>>>>>>>>>// CLSID: {723CBB00-0690-4528-8656-E33E61F39377}
20399>>>>>>>>>Class cCJICommandBar is a Mixin
20400>>>>>>>>>
20400>>>>>>>>>    Function ComTitle Returns String
20402>>>>>>>>>        String retVal
20402>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
20403>>>>>>>>>        Function_Return retVal
20404>>>>>>>>>    End_Function
20405>>>>>>>>>
20405>>>>>>>>>    Procedure Set ComTitle String value
20407>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
20408>>>>>>>>>    End_Procedure
20409>>>>>>>>>
20409>>>>>>>>>    Function ComVisible Returns Boolean
20411>>>>>>>>>        Boolean retVal
20411>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
20412>>>>>>>>>        Function_Return retVal
20413>>>>>>>>>    End_Function
20414>>>>>>>>>
20414>>>>>>>>>    Procedure Set ComVisible Boolean value
20416>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
20417>>>>>>>>>    End_Procedure
20418>>>>>>>>>
20418>>>>>>>>>    Function ComPosition Returns XTPBarPosition
20420>>>>>>>>>        XTPBarPosition retVal
20420>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
20421>>>>>>>>>        Function_Return retVal
20422>>>>>>>>>    End_Function
20423>>>>>>>>>
20423>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
20425>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
20426>>>>>>>>>    End_Procedure
20427>>>>>>>>>
20427>>>>>>>>>    Function ComBarID Returns Integer
20429>>>>>>>>>        Integer retVal
20429>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
20430>>>>>>>>>        Function_Return retVal
20431>>>>>>>>>    End_Function
20432>>>>>>>>>
20432>>>>>>>>>    Procedure Set ComBarID Integer value
20434>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
20435>>>>>>>>>    End_Procedure
20436>>>>>>>>>
20436>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
20438>>>>>>>>>        Boolean retVal
20438>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
20439>>>>>>>>>        Function_Return retVal
20440>>>>>>>>>    End_Function
20441>>>>>>>>>
20441>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
20443>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
20444>>>>>>>>>    End_Procedure
20445>>>>>>>>>
20445>>>>>>>>>    Function ComWidth Returns Integer
20447>>>>>>>>>        Integer retVal
20447>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
20448>>>>>>>>>        Function_Return retVal
20449>>>>>>>>>    End_Function
20450>>>>>>>>>
20450>>>>>>>>>    Procedure Set ComWidth Integer value
20452>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
20453>>>>>>>>>    End_Procedure
20454>>>>>>>>>
20454>>>>>>>>>    Function ComCloseable Returns Boolean
20456>>>>>>>>>        Boolean retVal
20456>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
20457>>>>>>>>>        Function_Return retVal
20458>>>>>>>>>    End_Function
20459>>>>>>>>>
20459>>>>>>>>>    Procedure Set ComCloseable Boolean value
20461>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
20462>>>>>>>>>    End_Procedure
20463>>>>>>>>>
20463>>>>>>>>>    Function ComEnableAnimation Returns Boolean
20465>>>>>>>>>        Boolean retVal
20465>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
20466>>>>>>>>>        Function_Return retVal
20467>>>>>>>>>    End_Function
20468>>>>>>>>>
20468>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
20470>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
20471>>>>>>>>>    End_Procedure
20472>>>>>>>>>
20472>>>>>>>>>    Function ComShowGripper Returns Boolean
20474>>>>>>>>>        Boolean retVal
20474>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
20475>>>>>>>>>        Function_Return retVal
20476>>>>>>>>>    End_Function
20477>>>>>>>>>
20477>>>>>>>>>    Procedure Set ComShowGripper Boolean value
20479>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
20480>>>>>>>>>    End_Procedure
20481>>>>>>>>>
20481>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
20483>>>>>>>>>        XTPButtonStyle retVal
20483>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
20484>>>>>>>>>        Function_Return retVal
20485>>>>>>>>>    End_Function
20486>>>>>>>>>
20486>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
20488>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
20489>>>>>>>>>    End_Procedure
20490>>>>>>>>>
20490>>>>>>>>>    Function ComCustomizable Returns Boolean
20492>>>>>>>>>        Boolean retVal
20492>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
20493>>>>>>>>>        Function_Return retVal
20494>>>>>>>>>    End_Function
20495>>>>>>>>>
20495>>>>>>>>>    Procedure Set ComCustomizable Boolean value
20497>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
20498>>>>>>>>>    End_Procedure
20499>>>>>>>>>
20499>>>>>>>>>    Function ComShowTextBelowIcons Returns Boolean
20501>>>>>>>>>        Boolean retVal
20501>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
20502>>>>>>>>>        Function_Return retVal
20503>>>>>>>>>    End_Function
20504>>>>>>>>>
20504>>>>>>>>>    Procedure Set ComShowTextBelowIcons Boolean value
20506>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
20507>>>>>>>>>    End_Procedure
20508>>>>>>>>>
20508>>>>>>>>>    Function ComDoubleGripper Returns Boolean
20510>>>>>>>>>        Boolean retVal
20510>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
20511>>>>>>>>>        Function_Return retVal
20512>>>>>>>>>    End_Function
20513>>>>>>>>>
20513>>>>>>>>>    Procedure Set ComDoubleGripper Boolean value
20515>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
20516>>>>>>>>>    End_Procedure
20517>>>>>>>>>
20517>>>>>>>>>    Function ComShowExpandButton Returns Boolean
20519>>>>>>>>>        Boolean retVal
20519>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to retVal
20520>>>>>>>>>        Function_Return retVal
20521>>>>>>>>>    End_Function
20522>>>>>>>>>
20522>>>>>>>>>    Procedure Set ComShowExpandButton Boolean value
20524>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to value
20525>>>>>>>>>    End_Procedure
20526>>>>>>>>>
20526>>>>>>>>>    Function ComSelectedControl Returns Variant
20528>>>>>>>>>        Variant retVal
20528>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to retVal
20529>>>>>>>>>        Function_Return retVal
20530>>>>>>>>>    End_Function
20531>>>>>>>>>
20531>>>>>>>>>    Procedure Set ComSelectedControl Variant value
20533>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to value
20534>>>>>>>>>    End_Procedure
20535>>>>>>>>>
20535>>>>>>>>>    Function ComCustomizeDialogPresent Returns Boolean
20537>>>>>>>>>        Boolean retVal
20537>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to retVal
20538>>>>>>>>>        Function_Return retVal
20539>>>>>>>>>    End_Function
20540>>>>>>>>>
20540>>>>>>>>>    Procedure Set ComCustomizeDialogPresent Boolean value
20542>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to value
20543>>>>>>>>>    End_Procedure
20544>>>>>>>>>
20544>>>>>>>>>    Function ComTextOrientation Returns XTPBarTextOrientation
20546>>>>>>>>>        XTPBarTextOrientation retVal
20546>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_I4 to retVal
20547>>>>>>>>>        Function_Return retVal
20548>>>>>>>>>    End_Function
20549>>>>>>>>>
20549>>>>>>>>>    Procedure Set ComTextOrientation XTPBarTextOrientation value
20551>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 40 OLE_VT_I4 to value
20552>>>>>>>>>    End_Procedure
20553>>>>>>>>>
20553>>>>>>>>>    Function ComType Returns XTPBarType
20555>>>>>>>>>        Handle hDispatchDriver
20555>>>>>>>>>        XTPBarType retVal
20555>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20556>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
20557>>>>>>>>>        Function_Return retVal
20558>>>>>>>>>    End_Function
20559>>>>>>>>>
20559>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
20561>>>>>>>>>        Handle hDispatchDriver
20561>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20562>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20563>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
20564>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
20565>>>>>>>>>    End_Procedure
20566>>>>>>>>>
20566>>>>>>>>>    Function ComBuiltIn Returns Boolean
20568>>>>>>>>>        Handle hDispatchDriver
20568>>>>>>>>>        Boolean retVal
20568>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20569>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
20570>>>>>>>>>        Function_Return retVal
20571>>>>>>>>>    End_Function
20572>>>>>>>>>
20572>>>>>>>>>    Procedure ComDelete
20574>>>>>>>>>        Handle hDispatchDriver
20574>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20575>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
20576>>>>>>>>>    End_Procedure
20577>>>>>>>>>
20577>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
20579>>>>>>>>>        Handle hDispatchDriver
20579>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20580>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
20581>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
20582>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
20583>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
20584>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
20585>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
20586>>>>>>>>>    End_Procedure
20587>>>>>>>>>
20587>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
20589>>>>>>>>>        Handle hDispatchDriver
20589>>>>>>>>>        OLE_HANDLE retVal
20589>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20590>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
20591>>>>>>>>>        Function_Return retVal
20592>>>>>>>>>    End_Function
20593>>>>>>>>>
20593>>>>>>>>>    Function ComCommandBars Returns Variant
20595>>>>>>>>>        Handle hDispatchDriver
20595>>>>>>>>>        Variant retVal
20595>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20596>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
20597>>>>>>>>>        Function_Return retVal
20598>>>>>>>>>    End_Function
20599>>>>>>>>>
20599>>>>>>>>>    Function ComControls Returns Variant
20601>>>>>>>>>        Handle hDispatchDriver
20601>>>>>>>>>        Variant retVal
20601>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20602>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
20603>>>>>>>>>        Function_Return retVal
20604>>>>>>>>>    End_Function
20605>>>>>>>>>
20605>>>>>>>>>    Function ComShowPopup Variant llFlags Variant llx Variant lly Returns Integer
20607>>>>>>>>>        Handle hDispatchDriver
20607>>>>>>>>>        Integer retVal
20607>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20608>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
20609>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFlags
20610>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llx
20611>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT lly
20612>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_I4 to retVal
20613>>>>>>>>>        Function_Return retVal
20614>>>>>>>>>    End_Function
20615>>>>>>>>>
20615>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
20617>>>>>>>>>        Handle hDispatchDriver
20617>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20618>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20619>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
20620>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
20621>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
20622>>>>>>>>>    End_Procedure
20623>>>>>>>>>
20623>>>>>>>>>    Procedure ComSetTearOffPopup String llCaption Integer llId Integer llWidth
20625>>>>>>>>>        Handle hDispatchDriver
20625>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20626>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
20627>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
20628>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
20629>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
20630>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
20631>>>>>>>>>    End_Procedure
20632>>>>>>>>>
20632>>>>>>>>>    Function ComParent Returns Variant
20634>>>>>>>>>        Handle hDispatchDriver
20634>>>>>>>>>        Variant retVal
20634>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20635>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
20636>>>>>>>>>        Function_Return retVal
20637>>>>>>>>>    End_Function
20638>>>>>>>>>
20638>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
20640>>>>>>>>>        Handle hDispatchDriver
20640>>>>>>>>>        Variant retVal
20640>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20641>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
20642>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
20643>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
20644>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
20645>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
20646>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
20647>>>>>>>>>        Function_Return retVal
20648>>>>>>>>>    End_Function
20649>>>>>>>>>
20649>>>>>>>>>    Procedure ComSetPopupToolBar Boolean llToolBarType
20651>>>>>>>>>        Handle hDispatchDriver
20651>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20652>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20653>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llToolBarType
20654>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 20 OLE_VT_VOID
20655>>>>>>>>>    End_Procedure
20656>>>>>>>>>
20656>>>>>>>>>    Procedure ComSetFlags XTPMenuBarFlags llAdd XTPMenuBarFlags llRemove
20658>>>>>>>>>        Handle hDispatchDriver
20658>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20659>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20660>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
20661>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
20662>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
20663>>>>>>>>>    End_Procedure
20664>>>>>>>>>
20664>>>>>>>>>    Procedure ComModifyStyle XTPCommandBarStyle llRemove XTPCommandBarStyle llAdd
20666>>>>>>>>>        Handle hDispatchDriver
20666>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20667>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20668>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
20669>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
20670>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
20671>>>>>>>>>    End_Procedure
20672>>>>>>>>>
20672>>>>>>>>>    Procedure ComRedrawBar
20674>>>>>>>>>        Handle hDispatchDriver
20674>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20675>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
20676>>>>>>>>>    End_Procedure
20677>>>>>>>>>
20677>>>>>>>>>    Procedure ComRecalcLayout
20679>>>>>>>>>        Handle hDispatchDriver
20679>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20680>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
20681>>>>>>>>>    End_Procedure
20682>>>>>>>>>
20682>>>>>>>>>    Procedure ComReset
20684>>>>>>>>>        Handle hDispatchDriver
20684>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20685>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
20686>>>>>>>>>    End_Procedure
20687>>>>>>>>>End_Class
20688>>>>>>>>>
20688>>>>>>>>>// CoClass
20688>>>>>>>>>// CLSID: {BCB1E32A-73F4-4849-A08C-8A64228AA2E3}
20688>>>>>>>>>Class cCJCommandBar is a cComAutomationObject
20689>>>>>>>>>    Import_Class_Protocol cCJICommandBar
20690>>>>>>>>>
20690>>>>>>>>>    Procedure Construct_Object
20692>>>>>>>>>        Forward Send Construct_Object
20694>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
20695>>>>>>>>>    End_Procedure
20696>>>>>>>>>End_Class
20697>>>>>>>>>
20697>>>>>>>>>// CLSID: {555CBB00-0690-4528-8656-E33E61F39377}
20697>>>>>>>>>Class cCJIMenuBarMDIMenu is a Mixin
20698>>>>>>>>>
20698>>>>>>>>>    Function ComCaption Returns String
20700>>>>>>>>>        String retVal
20700>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
20701>>>>>>>>>        Function_Return retVal
20702>>>>>>>>>    End_Function
20703>>>>>>>>>
20703>>>>>>>>>    Procedure Set ComCaption String value
20705>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
20706>>>>>>>>>    End_Procedure
20707>>>>>>>>>
20707>>>>>>>>>    Function ComDescription Returns String
20709>>>>>>>>>        String retVal
20709>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to retVal
20710>>>>>>>>>        Function_Return retVal
20711>>>>>>>>>    End_Function
20712>>>>>>>>>
20712>>>>>>>>>    Procedure Set ComDescription String value
20714>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to value
20715>>>>>>>>>    End_Procedure
20716>>>>>>>>>
20716>>>>>>>>>    Function ComId Returns Integer
20718>>>>>>>>>        Handle hDispatchDriver
20718>>>>>>>>>        Integer retVal
20718>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20719>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
20720>>>>>>>>>        Function_Return retVal
20721>>>>>>>>>    End_Function
20722>>>>>>>>>
20722>>>>>>>>>    Function ComControls Returns Variant
20724>>>>>>>>>        Handle hDispatchDriver
20724>>>>>>>>>        Variant retVal
20724>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20725>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
20726>>>>>>>>>        Function_Return retVal
20727>>>>>>>>>    End_Function
20728>>>>>>>>>End_Class
20729>>>>>>>>>
20729>>>>>>>>>// CoClass
20729>>>>>>>>>// CLSID: {5551E32A-73F4-4849-A08C-8A64228AA2E3}
20729>>>>>>>>>Class cCJComMenuBarMDIMenu is a cComAutomationObject
20730>>>>>>>>>    Import_Class_Protocol cCJIMenuBarMDIMenu
20731>>>>>>>>>
20731>>>>>>>>>    Procedure Construct_Object
20733>>>>>>>>>        Forward Send Construct_Object
20735>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
20736>>>>>>>>>    End_Procedure
20737>>>>>>>>>End_Class
20738>>>>>>>>>
20738>>>>>>>>>// CLSID: {444CBB00-0690-4528-8656-E33E61F39377}
20738>>>>>>>>>Class cCJIMenuBarMDIMenus is a Mixin
20739>>>>>>>>>
20739>>>>>>>>>    // Gets the number of menus in the collection.
20739>>>>>>>>>    Function ComCount Returns Integer
20741>>>>>>>>>        Handle hDispatchDriver
20741>>>>>>>>>        Integer retVal
20741>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20742>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
20743>>>>>>>>>        Function_Return retVal
20744>>>>>>>>>    End_Function
20745>>>>>>>>>
20745>>>>>>>>>    // Gets an item from the collection by its Id.
20745>>>>>>>>>    Function ComItem Integer llId Returns Variant
20747>>>>>>>>>        Handle hDispatchDriver
20747>>>>>>>>>        Variant retVal
20747>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20748>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20749>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
20750>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
20751>>>>>>>>>        Function_Return retVal
20752>>>>>>>>>    End_Function
20753>>>>>>>>>
20753>>>>>>>>>    Function Com_NewEnum Returns Variant
20755>>>>>>>>>        Handle hDispatchDriver
20755>>>>>>>>>        Variant retVal
20755>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20756>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
20757>>>>>>>>>        Function_Return retVal
20758>>>>>>>>>    End_Function
20759>>>>>>>>>
20759>>>>>>>>>    Function ComAdd Integer llId String llCaption String llDescription Returns Variant
20761>>>>>>>>>        Handle hDispatchDriver
20761>>>>>>>>>        Variant retVal
20761>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20762>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
20763>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
20764>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
20765>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llDescription
20766>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
20767>>>>>>>>>        Function_Return retVal
20768>>>>>>>>>    End_Function
20769>>>>>>>>>
20769>>>>>>>>>    // Deletes all of the menus from the collection
20769>>>>>>>>>    Procedure ComDeleteAll
20771>>>>>>>>>        Handle hDispatchDriver
20771>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20772>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
20773>>>>>>>>>    End_Procedure
20774>>>>>>>>>End_Class
20775>>>>>>>>>
20775>>>>>>>>>// CoClass
20775>>>>>>>>>// CLSID: {4441E32A-73F4-4849-A08C-8A64228AA2E3}
20775>>>>>>>>>Class cCJComMenuBarMDIMenus is a cComAutomationObject
20776>>>>>>>>>    Import_Class_Protocol cCJIMenuBarMDIMenus
20777>>>>>>>>>
20777>>>>>>>>>    Procedure Construct_Object
20779>>>>>>>>>        Forward Send Construct_Object
20781>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
20782>>>>>>>>>    End_Procedure
20783>>>>>>>>>End_Class
20784>>>>>>>>>
20784>>>>>>>>>// CLSID: {888CBB00-0690-4528-8656-E33E61F39377}
20784>>>>>>>>>Class cCJIMenuBar is a Mixin
20785>>>>>>>>>
20785>>>>>>>>>    Function ComTitle Returns String
20787>>>>>>>>>        String retVal
20787>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
20788>>>>>>>>>        Function_Return retVal
20789>>>>>>>>>    End_Function
20790>>>>>>>>>
20790>>>>>>>>>    Procedure Set ComTitle String value
20792>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
20793>>>>>>>>>    End_Procedure
20794>>>>>>>>>
20794>>>>>>>>>    Function ComVisible Returns Boolean
20796>>>>>>>>>        Boolean retVal
20796>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
20797>>>>>>>>>        Function_Return retVal
20798>>>>>>>>>    End_Function
20799>>>>>>>>>
20799>>>>>>>>>    Procedure Set ComVisible Boolean value
20801>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
20802>>>>>>>>>    End_Procedure
20803>>>>>>>>>
20803>>>>>>>>>    Function ComPosition Returns XTPBarPosition
20805>>>>>>>>>        XTPBarPosition retVal
20805>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
20806>>>>>>>>>        Function_Return retVal
20807>>>>>>>>>    End_Function
20808>>>>>>>>>
20808>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
20810>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
20811>>>>>>>>>    End_Procedure
20812>>>>>>>>>
20812>>>>>>>>>    Function ComBarID Returns Integer
20814>>>>>>>>>        Integer retVal
20814>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
20815>>>>>>>>>        Function_Return retVal
20816>>>>>>>>>    End_Function
20817>>>>>>>>>
20817>>>>>>>>>    Procedure Set ComBarID Integer value
20819>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
20820>>>>>>>>>    End_Procedure
20821>>>>>>>>>
20821>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
20823>>>>>>>>>        Boolean retVal
20823>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
20824>>>>>>>>>        Function_Return retVal
20825>>>>>>>>>    End_Function
20826>>>>>>>>>
20826>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
20828>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
20829>>>>>>>>>    End_Procedure
20830>>>>>>>>>
20830>>>>>>>>>    Function ComWidth Returns Integer
20832>>>>>>>>>        Integer retVal
20832>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
20833>>>>>>>>>        Function_Return retVal
20834>>>>>>>>>    End_Function
20835>>>>>>>>>
20835>>>>>>>>>    Procedure Set ComWidth Integer value
20837>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
20838>>>>>>>>>    End_Procedure
20839>>>>>>>>>
20839>>>>>>>>>    Function ComCloseable Returns Boolean
20841>>>>>>>>>        Boolean retVal
20841>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
20842>>>>>>>>>        Function_Return retVal
20843>>>>>>>>>    End_Function
20844>>>>>>>>>
20844>>>>>>>>>    Procedure Set ComCloseable Boolean value
20846>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
20847>>>>>>>>>    End_Procedure
20848>>>>>>>>>
20848>>>>>>>>>    Function ComEnableAnimation Returns Boolean
20850>>>>>>>>>        Boolean retVal
20850>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
20851>>>>>>>>>        Function_Return retVal
20852>>>>>>>>>    End_Function
20853>>>>>>>>>
20853>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
20855>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
20856>>>>>>>>>    End_Procedure
20857>>>>>>>>>
20857>>>>>>>>>    Function ComShowGripper Returns Boolean
20859>>>>>>>>>        Boolean retVal
20859>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
20860>>>>>>>>>        Function_Return retVal
20861>>>>>>>>>    End_Function
20862>>>>>>>>>
20862>>>>>>>>>    Procedure Set ComShowGripper Boolean value
20864>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
20865>>>>>>>>>    End_Procedure
20866>>>>>>>>>
20866>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
20868>>>>>>>>>        XTPButtonStyle retVal
20868>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
20869>>>>>>>>>        Function_Return retVal
20870>>>>>>>>>    End_Function
20871>>>>>>>>>
20871>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
20873>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
20874>>>>>>>>>    End_Procedure
20875>>>>>>>>>
20875>>>>>>>>>    Function ComCustomizable Returns Boolean
20877>>>>>>>>>        Boolean retVal
20877>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
20878>>>>>>>>>        Function_Return retVal
20879>>>>>>>>>    End_Function
20880>>>>>>>>>
20880>>>>>>>>>    Procedure Set ComCustomizable Boolean value
20882>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
20883>>>>>>>>>    End_Procedure
20884>>>>>>>>>
20884>>>>>>>>>    Function ComShowTextBelowIcons Returns Boolean
20886>>>>>>>>>        Boolean retVal
20886>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
20887>>>>>>>>>        Function_Return retVal
20888>>>>>>>>>    End_Function
20889>>>>>>>>>
20889>>>>>>>>>    Procedure Set ComShowTextBelowIcons Boolean value
20891>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
20892>>>>>>>>>    End_Procedure
20893>>>>>>>>>
20893>>>>>>>>>    Function ComShowExpandButton Returns Boolean
20895>>>>>>>>>        Boolean retVal
20895>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to retVal
20896>>>>>>>>>        Function_Return retVal
20897>>>>>>>>>    End_Function
20898>>>>>>>>>
20898>>>>>>>>>    Procedure Set ComShowExpandButton Boolean value
20900>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to value
20901>>>>>>>>>    End_Procedure
20902>>>>>>>>>
20902>>>>>>>>>    Function ComSelectedControl Returns Variant
20904>>>>>>>>>        Variant retVal
20904>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to retVal
20905>>>>>>>>>        Function_Return retVal
20906>>>>>>>>>    End_Function
20907>>>>>>>>>
20907>>>>>>>>>    Procedure Set ComSelectedControl Variant value
20909>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to value
20910>>>>>>>>>    End_Procedure
20911>>>>>>>>>
20911>>>>>>>>>    Function ComCustomizeDialogPresent Returns Boolean
20913>>>>>>>>>        Boolean retVal
20913>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to retVal
20914>>>>>>>>>        Function_Return retVal
20915>>>>>>>>>    End_Function
20916>>>>>>>>>
20916>>>>>>>>>    Procedure Set ComCustomizeDialogPresent Boolean value
20918>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to value
20919>>>>>>>>>    End_Procedure
20920>>>>>>>>>
20920>>>>>>>>>    Function ComType Returns XTPBarType
20922>>>>>>>>>        Handle hDispatchDriver
20922>>>>>>>>>        XTPBarType retVal
20922>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20923>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
20924>>>>>>>>>        Function_Return retVal
20925>>>>>>>>>    End_Function
20926>>>>>>>>>
20926>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
20928>>>>>>>>>        Handle hDispatchDriver
20928>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20929>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
20930>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
20931>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
20932>>>>>>>>>    End_Procedure
20933>>>>>>>>>
20933>>>>>>>>>    Function ComBuiltIn Returns Boolean
20935>>>>>>>>>        Handle hDispatchDriver
20935>>>>>>>>>        Boolean retVal
20935>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20936>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
20937>>>>>>>>>        Function_Return retVal
20938>>>>>>>>>    End_Function
20939>>>>>>>>>
20939>>>>>>>>>    Procedure ComDelete
20941>>>>>>>>>        Handle hDispatchDriver
20941>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20942>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
20943>>>>>>>>>    End_Procedure
20944>>>>>>>>>
20944>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
20946>>>>>>>>>        Handle hDispatchDriver
20946>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20947>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
20948>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
20949>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
20950>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
20951>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
20952>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
20953>>>>>>>>>    End_Procedure
20954>>>>>>>>>
20954>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
20956>>>>>>>>>        Handle hDispatchDriver
20956>>>>>>>>>        OLE_HANDLE retVal
20956>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20957>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
20958>>>>>>>>>        Function_Return retVal
20959>>>>>>>>>    End_Function
20960>>>>>>>>>
20960>>>>>>>>>    Function ComCommandBars Returns Variant
20962>>>>>>>>>        Handle hDispatchDriver
20962>>>>>>>>>        Variant retVal
20962>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20963>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
20964>>>>>>>>>        Function_Return retVal
20965>>>>>>>>>    End_Function
20966>>>>>>>>>
20966>>>>>>>>>    Function ComControls Returns Variant
20968>>>>>>>>>        Handle hDispatchDriver
20968>>>>>>>>>        Variant retVal
20968>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20969>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
20970>>>>>>>>>        Function_Return retVal
20971>>>>>>>>>    End_Function
20972>>>>>>>>>
20972>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
20974>>>>>>>>>        Handle hDispatchDriver
20974>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20975>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
20976>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
20977>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
20978>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
20979>>>>>>>>>    End_Procedure
20980>>>>>>>>>
20980>>>>>>>>>    Function ComParent Returns Variant
20982>>>>>>>>>        Handle hDispatchDriver
20982>>>>>>>>>        Variant retVal
20982>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20983>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
20984>>>>>>>>>        Function_Return retVal
20985>>>>>>>>>    End_Function
20986>>>>>>>>>
20986>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
20988>>>>>>>>>        Handle hDispatchDriver
20988>>>>>>>>>        Variant retVal
20988>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
20989>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
20990>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
20991>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
20992>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
20993>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
20994>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
20995>>>>>>>>>        Function_Return retVal
20996>>>>>>>>>    End_Function
20997>>>>>>>>>
20997>>>>>>>>>    Procedure ComSetFlags XTPMenuBarFlags llAdd XTPMenuBarFlags llRemove
20999>>>>>>>>>        Handle hDispatchDriver
20999>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21000>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21001>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
21002>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
21003>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
21004>>>>>>>>>    End_Procedure
21005>>>>>>>>>
21005>>>>>>>>>    Procedure ComModifyStyle XTPCommandBarStyle llRemove XTPCommandBarStyle llAdd
21007>>>>>>>>>        Handle hDispatchDriver
21007>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21008>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21009>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
21010>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
21011>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
21012>>>>>>>>>    End_Procedure
21013>>>>>>>>>
21013>>>>>>>>>    Procedure ComRedrawBar
21015>>>>>>>>>        Handle hDispatchDriver
21015>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21016>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
21017>>>>>>>>>    End_Procedure
21018>>>>>>>>>
21018>>>>>>>>>    Procedure ComRecalcLayout
21020>>>>>>>>>        Handle hDispatchDriver
21020>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21021>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
21022>>>>>>>>>    End_Procedure
21023>>>>>>>>>
21023>>>>>>>>>    Procedure ComReset
21025>>>>>>>>>        Handle hDispatchDriver
21025>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21026>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
21027>>>>>>>>>    End_Procedure
21028>>>>>>>>>
21028>>>>>>>>>    Function ComMDIMenus Returns Variant
21030>>>>>>>>>        Handle hDispatchDriver
21030>>>>>>>>>        Variant retVal
21030>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21031>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 130 OLE_VT_DISPATCH to retVal
21032>>>>>>>>>        Function_Return retVal
21033>>>>>>>>>    End_Function
21034>>>>>>>>>
21034>>>>>>>>>    Procedure ComSwitchMDIMenu Integer llId
21036>>>>>>>>>        Handle hDispatchDriver
21036>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21037>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21038>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
21039>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 131 OLE_VT_VOID
21040>>>>>>>>>    End_Procedure
21041>>>>>>>>>End_Class
21042>>>>>>>>>
21042>>>>>>>>>// CoClass
21042>>>>>>>>>// CLSID: {8881E32A-73F4-4849-A08C-8A64228AA2E3}
21042>>>>>>>>>Class cCJComMenuBar is a cComAutomationObject
21043>>>>>>>>>    Import_Class_Protocol cCJIMenuBar
21044>>>>>>>>>
21044>>>>>>>>>    Procedure Construct_Object
21046>>>>>>>>>        Forward Send Construct_Object
21048>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
21049>>>>>>>>>    End_Procedure
21050>>>>>>>>>End_Class
21051>>>>>>>>>
21051>>>>>>>>>// CLSID: {777CBB00-0690-4528-8656-E33E61F39377}
21051>>>>>>>>>Class cCJICommandBarsContextMenus is a Mixin
21052>>>>>>>>>
21052>>>>>>>>>    // Gets the number of menus in the collection.
21052>>>>>>>>>    Function ComCount Returns Integer
21054>>>>>>>>>        Handle hDispatchDriver
21054>>>>>>>>>        Integer retVal
21054>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21055>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
21056>>>>>>>>>        Function_Return retVal
21057>>>>>>>>>    End_Function
21058>>>>>>>>>
21058>>>>>>>>>    // Gets an item from the collection by its index.
21058>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
21060>>>>>>>>>        Handle hDispatchDriver
21060>>>>>>>>>        Variant retVal
21060>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21061>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21062>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21063>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
21064>>>>>>>>>        Function_Return retVal
21065>>>>>>>>>    End_Function
21066>>>>>>>>>
21066>>>>>>>>>    Function Com_NewEnum Returns Variant
21068>>>>>>>>>        Handle hDispatchDriver
21068>>>>>>>>>        Variant retVal
21068>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21069>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
21070>>>>>>>>>        Function_Return retVal
21071>>>>>>>>>    End_Function
21072>>>>>>>>>
21072>>>>>>>>>    // Adds a new command bar to the collection.
21072>>>>>>>>>    Function ComAdd Integer llId String llCaption Returns Variant
21074>>>>>>>>>        Handle hDispatchDriver
21074>>>>>>>>>        Variant retVal
21074>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21075>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21076>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
21077>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
21078>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
21079>>>>>>>>>        Function_Return retVal
21080>>>>>>>>>    End_Function
21081>>>>>>>>>
21081>>>>>>>>>    // Finds the specified menu
21081>>>>>>>>>    Function ComFind Integer llId Returns Variant
21083>>>>>>>>>        Handle hDispatchDriver
21083>>>>>>>>>        Variant retVal
21083>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21084>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21085>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
21086>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
21087>>>>>>>>>        Function_Return retVal
21088>>>>>>>>>    End_Function
21089>>>>>>>>>
21089>>>>>>>>>    // Deletes all of the menus from the collection
21089>>>>>>>>>    Procedure ComDeleteAll
21091>>>>>>>>>        Handle hDispatchDriver
21091>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21092>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
21093>>>>>>>>>    End_Procedure
21094>>>>>>>>>
21094>>>>>>>>>    // Adds a new command bar to the collection.
21094>>>>>>>>>    Procedure ComAddPopup Variant llPopupBar
21096>>>>>>>>>        Handle hDispatchDriver
21096>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21097>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21098>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llPopupBar
21099>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
21100>>>>>>>>>    End_Procedure
21101>>>>>>>>>End_Class
21102>>>>>>>>>
21102>>>>>>>>>// CoClass
21102>>>>>>>>>// CLSID: {7771E32A-73F4-4849-A08C-8A64228AA2E3}
21102>>>>>>>>>Class cCJCommandBarsContextMenus is a cComAutomationObject
21103>>>>>>>>>    Import_Class_Protocol cCJICommandBarsContextMenus
21104>>>>>>>>>
21104>>>>>>>>>    Procedure Construct_Object
21106>>>>>>>>>        Forward Send Construct_Object
21108>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
21109>>>>>>>>>    End_Procedure
21110>>>>>>>>>End_Class
21111>>>>>>>>>
21111>>>>>>>>>// CLSID: {ABB113E7-46A4-4F99-83D8-C6D3C2B390FC}
21111>>>>>>>>>Class cCJITabToolBar is a Mixin
21112>>>>>>>>>
21112>>>>>>>>>    Function ComTitle Returns String
21114>>>>>>>>>        String retVal
21114>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
21115>>>>>>>>>        Function_Return retVal
21116>>>>>>>>>    End_Function
21117>>>>>>>>>
21117>>>>>>>>>    Procedure Set ComTitle String value
21119>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
21120>>>>>>>>>    End_Procedure
21121>>>>>>>>>
21121>>>>>>>>>    Function ComVisible Returns Boolean
21123>>>>>>>>>        Boolean retVal
21123>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
21124>>>>>>>>>        Function_Return retVal
21125>>>>>>>>>    End_Function
21126>>>>>>>>>
21126>>>>>>>>>    Procedure Set ComVisible Boolean value
21128>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
21129>>>>>>>>>    End_Procedure
21130>>>>>>>>>
21130>>>>>>>>>    Function ComPosition Returns XTPBarPosition
21132>>>>>>>>>        XTPBarPosition retVal
21132>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
21133>>>>>>>>>        Function_Return retVal
21134>>>>>>>>>    End_Function
21135>>>>>>>>>
21135>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
21137>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
21138>>>>>>>>>    End_Procedure
21139>>>>>>>>>
21139>>>>>>>>>    Function ComBarID Returns Integer
21141>>>>>>>>>        Integer retVal
21141>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
21142>>>>>>>>>        Function_Return retVal
21143>>>>>>>>>    End_Function
21144>>>>>>>>>
21144>>>>>>>>>    Procedure Set ComBarID Integer value
21146>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
21147>>>>>>>>>    End_Procedure
21148>>>>>>>>>
21148>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
21150>>>>>>>>>        Boolean retVal
21150>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
21151>>>>>>>>>        Function_Return retVal
21152>>>>>>>>>    End_Function
21153>>>>>>>>>
21153>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
21155>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
21156>>>>>>>>>    End_Procedure
21157>>>>>>>>>
21157>>>>>>>>>    Function ComWidth Returns Integer
21159>>>>>>>>>        Integer retVal
21159>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
21160>>>>>>>>>        Function_Return retVal
21161>>>>>>>>>    End_Function
21162>>>>>>>>>
21162>>>>>>>>>    Procedure Set ComWidth Integer value
21164>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
21165>>>>>>>>>    End_Procedure
21166>>>>>>>>>
21166>>>>>>>>>    Function ComCloseable Returns Boolean
21168>>>>>>>>>        Boolean retVal
21168>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
21169>>>>>>>>>        Function_Return retVal
21170>>>>>>>>>    End_Function
21171>>>>>>>>>
21171>>>>>>>>>    Procedure Set ComCloseable Boolean value
21173>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
21174>>>>>>>>>    End_Procedure
21175>>>>>>>>>
21175>>>>>>>>>    Function ComEnableAnimation Returns Boolean
21177>>>>>>>>>        Boolean retVal
21177>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
21178>>>>>>>>>        Function_Return retVal
21179>>>>>>>>>    End_Function
21180>>>>>>>>>
21180>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
21182>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
21183>>>>>>>>>    End_Procedure
21184>>>>>>>>>
21184>>>>>>>>>    Function ComShowGripper Returns Boolean
21186>>>>>>>>>        Boolean retVal
21186>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
21187>>>>>>>>>        Function_Return retVal
21188>>>>>>>>>    End_Function
21189>>>>>>>>>
21189>>>>>>>>>    Procedure Set ComShowGripper Boolean value
21191>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
21192>>>>>>>>>    End_Procedure
21193>>>>>>>>>
21193>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
21195>>>>>>>>>        XTPButtonStyle retVal
21195>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
21196>>>>>>>>>        Function_Return retVal
21197>>>>>>>>>    End_Function
21198>>>>>>>>>
21198>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
21200>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
21201>>>>>>>>>    End_Procedure
21202>>>>>>>>>
21202>>>>>>>>>    Function ComCustomizable Returns Boolean
21204>>>>>>>>>        Boolean retVal
21204>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
21205>>>>>>>>>        Function_Return retVal
21206>>>>>>>>>    End_Function
21207>>>>>>>>>
21207>>>>>>>>>    Procedure Set ComCustomizable Boolean value
21209>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
21210>>>>>>>>>    End_Procedure
21211>>>>>>>>>
21211>>>>>>>>>    Function ComShowTextBelowIcons Returns Boolean
21213>>>>>>>>>        Boolean retVal
21213>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
21214>>>>>>>>>        Function_Return retVal
21215>>>>>>>>>    End_Function
21216>>>>>>>>>
21216>>>>>>>>>    Procedure Set ComShowTextBelowIcons Boolean value
21218>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
21219>>>>>>>>>    End_Procedure
21220>>>>>>>>>
21220>>>>>>>>>    Function ComDoubleGripper Returns Boolean
21222>>>>>>>>>        Boolean retVal
21222>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
21223>>>>>>>>>        Function_Return retVal
21224>>>>>>>>>    End_Function
21225>>>>>>>>>
21225>>>>>>>>>    Procedure Set ComDoubleGripper Boolean value
21227>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
21228>>>>>>>>>    End_Procedure
21229>>>>>>>>>
21229>>>>>>>>>    Function ComShowExpandButton Returns Boolean
21231>>>>>>>>>        Boolean retVal
21231>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to retVal
21232>>>>>>>>>        Function_Return retVal
21233>>>>>>>>>    End_Function
21234>>>>>>>>>
21234>>>>>>>>>    Procedure Set ComShowExpandButton Boolean value
21236>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 33 OLE_VT_BOOL to value
21237>>>>>>>>>    End_Procedure
21238>>>>>>>>>
21238>>>>>>>>>    Function ComSelectedControl Returns Variant
21240>>>>>>>>>        Variant retVal
21240>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to retVal
21241>>>>>>>>>        Function_Return retVal
21242>>>>>>>>>    End_Function
21243>>>>>>>>>
21243>>>>>>>>>    Procedure Set ComSelectedControl Variant value
21245>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to value
21246>>>>>>>>>    End_Procedure
21247>>>>>>>>>
21247>>>>>>>>>    Function ComCustomizeDialogPresent Returns Boolean
21249>>>>>>>>>        Boolean retVal
21249>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to retVal
21250>>>>>>>>>        Function_Return retVal
21251>>>>>>>>>    End_Function
21252>>>>>>>>>
21252>>>>>>>>>    Procedure Set ComCustomizeDialogPresent Boolean value
21254>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BOOL to value
21255>>>>>>>>>    End_Procedure
21256>>>>>>>>>
21256>>>>>>>>>    Function ComMinimumWidth Returns Integer
21258>>>>>>>>>        Integer retVal
21258>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 104 OLE_VT_I4 to retVal
21259>>>>>>>>>        Function_Return retVal
21260>>>>>>>>>    End_Function
21261>>>>>>>>>
21261>>>>>>>>>    Procedure Set ComMinimumWidth Integer value
21263>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 104 OLE_VT_I4 to value
21264>>>>>>>>>    End_Procedure
21265>>>>>>>>>
21265>>>>>>>>>    Function ComAllowReorder Returns Boolean
21267>>>>>>>>>        Boolean retVal
21267>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_BOOL to retVal
21268>>>>>>>>>        Function_Return retVal
21269>>>>>>>>>    End_Function
21270>>>>>>>>>
21270>>>>>>>>>    Procedure Set ComAllowReorder Boolean value
21272>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_BOOL to value
21273>>>>>>>>>    End_Procedure
21274>>>>>>>>>
21274>>>>>>>>>    Function ComType Returns XTPBarType
21276>>>>>>>>>        Handle hDispatchDriver
21276>>>>>>>>>        XTPBarType retVal
21276>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21277>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
21278>>>>>>>>>        Function_Return retVal
21279>>>>>>>>>    End_Function
21280>>>>>>>>>
21280>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
21282>>>>>>>>>        Handle hDispatchDriver
21282>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21283>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21284>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
21285>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
21286>>>>>>>>>    End_Procedure
21287>>>>>>>>>
21287>>>>>>>>>    Function ComBuiltIn Returns Boolean
21289>>>>>>>>>        Handle hDispatchDriver
21289>>>>>>>>>        Boolean retVal
21289>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21290>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
21291>>>>>>>>>        Function_Return retVal
21292>>>>>>>>>    End_Function
21293>>>>>>>>>
21293>>>>>>>>>    Procedure ComDelete
21295>>>>>>>>>        Handle hDispatchDriver
21295>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21296>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
21297>>>>>>>>>    End_Procedure
21298>>>>>>>>>
21298>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
21300>>>>>>>>>        Handle hDispatchDriver
21300>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21301>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
21302>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
21303>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
21304>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
21305>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
21306>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
21307>>>>>>>>>    End_Procedure
21308>>>>>>>>>
21308>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
21310>>>>>>>>>        Handle hDispatchDriver
21310>>>>>>>>>        OLE_HANDLE retVal
21310>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21311>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
21312>>>>>>>>>        Function_Return retVal
21313>>>>>>>>>    End_Function
21314>>>>>>>>>
21314>>>>>>>>>    Function ComCommandBars Returns Variant
21316>>>>>>>>>        Handle hDispatchDriver
21316>>>>>>>>>        Variant retVal
21316>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21317>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
21318>>>>>>>>>        Function_Return retVal
21319>>>>>>>>>    End_Function
21320>>>>>>>>>
21320>>>>>>>>>    Function ComControls Returns Variant
21322>>>>>>>>>        Handle hDispatchDriver
21322>>>>>>>>>        Variant retVal
21322>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21323>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
21324>>>>>>>>>        Function_Return retVal
21325>>>>>>>>>    End_Function
21326>>>>>>>>>
21326>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
21328>>>>>>>>>        Handle hDispatchDriver
21328>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21329>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21330>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
21331>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
21332>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
21333>>>>>>>>>    End_Procedure
21334>>>>>>>>>
21334>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
21336>>>>>>>>>        Handle hDispatchDriver
21336>>>>>>>>>        Variant retVal
21336>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21337>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
21338>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
21339>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
21340>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
21341>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
21342>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
21343>>>>>>>>>        Function_Return retVal
21344>>>>>>>>>    End_Function
21345>>>>>>>>>
21345>>>>>>>>>    Procedure ComSetFlags XTPMenuBarFlags llAdd XTPMenuBarFlags llRemove
21347>>>>>>>>>        Handle hDispatchDriver
21347>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21348>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21349>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
21350>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
21351>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
21352>>>>>>>>>    End_Procedure
21353>>>>>>>>>
21353>>>>>>>>>    Procedure ComModifyStyle XTPCommandBarStyle llRemove XTPCommandBarStyle llAdd
21355>>>>>>>>>        Handle hDispatchDriver
21355>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21356>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21357>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
21358>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
21359>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
21360>>>>>>>>>    End_Procedure
21361>>>>>>>>>
21361>>>>>>>>>    Procedure ComRedrawBar
21363>>>>>>>>>        Handle hDispatchDriver
21363>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21364>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
21365>>>>>>>>>    End_Procedure
21366>>>>>>>>>
21366>>>>>>>>>    Procedure ComRecalcLayout
21368>>>>>>>>>        Handle hDispatchDriver
21368>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21369>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
21370>>>>>>>>>    End_Procedure
21371>>>>>>>>>
21371>>>>>>>>>    Procedure ComReset
21373>>>>>>>>>        Handle hDispatchDriver
21373>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21374>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
21375>>>>>>>>>    End_Procedure
21376>>>>>>>>>
21376>>>>>>>>>    Function ComInsertCategory Integer llIndex String llCategory Returns Variant
21378>>>>>>>>>        Handle hDispatchDriver
21378>>>>>>>>>        Variant retVal
21378>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21379>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21380>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21381>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCategory
21382>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_DISPATCH to retVal
21383>>>>>>>>>        Function_Return retVal
21384>>>>>>>>>    End_Function
21385>>>>>>>>>
21385>>>>>>>>>    Function ComCategoryCount Returns Integer
21387>>>>>>>>>        Handle hDispatchDriver
21387>>>>>>>>>        Integer retVal
21387>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21388>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_I4 to retVal
21389>>>>>>>>>        Function_Return retVal
21390>>>>>>>>>    End_Function
21391>>>>>>>>>
21391>>>>>>>>>    Function ComCategory Integer llIndex Returns Variant
21393>>>>>>>>>        Handle hDispatchDriver
21393>>>>>>>>>        Variant retVal
21393>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21394>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21395>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21396>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
21397>>>>>>>>>        Function_Return retVal
21398>>>>>>>>>    End_Function
21399>>>>>>>>>
21399>>>>>>>>>    Function Com_NewEnum Returns Variant
21401>>>>>>>>>        Handle hDispatchDriver
21401>>>>>>>>>        Variant retVal
21401>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21402>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
21403>>>>>>>>>        Function_Return retVal
21404>>>>>>>>>    End_Function
21405>>>>>>>>>
21405>>>>>>>>>    Procedure ComRemoveCategory Integer llIndex
21407>>>>>>>>>        Handle hDispatchDriver
21407>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21408>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21409>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21410>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 102 OLE_VT_VOID
21411>>>>>>>>>    End_Procedure
21412>>>>>>>>>
21412>>>>>>>>>    Function ComTabPaintManager Returns Variant
21414>>>>>>>>>        Handle hDispatchDriver
21414>>>>>>>>>        Variant retVal
21414>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21415>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 103 OLE_VT_DISPATCH to retVal
21416>>>>>>>>>        Function_Return retVal
21417>>>>>>>>>    End_Function
21418>>>>>>>>>
21418>>>>>>>>>    Procedure ComUpdateTabs
21420>>>>>>>>>        Handle hDispatchDriver
21420>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21421>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 105 OLE_VT_VOID
21422>>>>>>>>>    End_Procedure
21423>>>>>>>>>End_Class
21424>>>>>>>>>
21424>>>>>>>>>// CLSID: {154A7B16-7BE8-42EC-870C-8849F5540F14}
21424>>>>>>>>>Class cCJITabToolBarEvents is a Mixin
21425>>>>>>>>>
21425>>>>>>>>>    Procedure OnComSelectedChanged Variant llItem
21427>>>>>>>>>    End_Procedure
21428>>>>>>>>>
21428>>>>>>>>>    Procedure OnComBeforeItemClick Variant llItem Variant llCancel
21430>>>>>>>>>    End_Procedure
21431>>>>>>>>>
21431>>>>>>>>>    Procedure RegisterComEvents
21433>>>>>>>>>        Send RegisterComEvent 1 msg_OnComSelectedChanged
21434>>>>>>>>>        Send RegisterComEvent 4 msg_OnComBeforeItemClick
21435>>>>>>>>>    End_Procedure
21436>>>>>>>>>End_Class
21437>>>>>>>>>
21437>>>>>>>>>// CoClass
21437>>>>>>>>>// CLSID: {ABB1E32A-73F4-4849-A08C-8A64228AA2E3}
21437>>>>>>>>>Class cCJComTabToolBar is a cComAutomationObject
21438>>>>>>>>>    Import_Class_Protocol cCJITabToolBar
21439>>>>>>>>>    Import_Class_Protocol cCJITabToolBarEvents
21440>>>>>>>>>
21440>>>>>>>>>    Procedure Construct_Object
21442>>>>>>>>>        Forward Send Construct_Object
21444>>>>>>>>>        Set psEventId to "{154A7B16-7BE8-42EC-870C-8849F5540F14}"
21445>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
21446>>>>>>>>>    End_Procedure
21447>>>>>>>>>End_Class
21448>>>>>>>>>
21448>>>>>>>>>// CLSID: {A11113E7-46A4-4F99-83D8-C6D3C2B390FC}
21448>>>>>>>>>Class cCJIRibbonGroups is a Mixin
21449>>>>>>>>>
21449>>>>>>>>>    Function ComInsertGroup Integer llIndex String llCaption Integer llId Returns Variant
21451>>>>>>>>>        Handle hDispatchDriver
21451>>>>>>>>>        Variant retVal
21451>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21452>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
21453>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21454>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
21455>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
21456>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_DISPATCH to retVal
21457>>>>>>>>>        Function_Return retVal
21458>>>>>>>>>    End_Function
21459>>>>>>>>>
21459>>>>>>>>>    Function ComGroupCount Returns Integer
21461>>>>>>>>>        Handle hDispatchDriver
21461>>>>>>>>>        Integer retVal
21461>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21462>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_I4 to retVal
21463>>>>>>>>>        Function_Return retVal
21464>>>>>>>>>    End_Function
21465>>>>>>>>>
21465>>>>>>>>>    Function ComGroup Integer llIndex Returns Variant
21467>>>>>>>>>        Handle hDispatchDriver
21467>>>>>>>>>        Variant retVal
21467>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21468>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21469>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21470>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
21471>>>>>>>>>        Function_Return retVal
21472>>>>>>>>>    End_Function
21473>>>>>>>>>
21473>>>>>>>>>    Function Com_NewEnum Returns Variant
21475>>>>>>>>>        Handle hDispatchDriver
21475>>>>>>>>>        Variant retVal
21475>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21476>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
21477>>>>>>>>>        Function_Return retVal
21478>>>>>>>>>    End_Function
21479>>>>>>>>>
21479>>>>>>>>>    Function ComAddGroup String llCaption Integer llId Returns Variant
21481>>>>>>>>>        Handle hDispatchDriver
21481>>>>>>>>>        Variant retVal
21481>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21482>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21483>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
21484>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
21485>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 102 OLE_VT_DISPATCH to retVal
21486>>>>>>>>>        Function_Return retVal
21487>>>>>>>>>    End_Function
21488>>>>>>>>>
21488>>>>>>>>>    Procedure ComRemoveGroup Integer llIndex
21490>>>>>>>>>        Handle hDispatchDriver
21490>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21491>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21492>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21493>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 103 OLE_VT_VOID
21494>>>>>>>>>    End_Procedure
21495>>>>>>>>>
21495>>>>>>>>>    Procedure ComRemoveAll
21497>>>>>>>>>        Handle hDispatchDriver
21497>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21498>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 104 OLE_VT_VOID
21499>>>>>>>>>    End_Procedure
21500>>>>>>>>>
21500>>>>>>>>>    Function ComRibbonTab Returns Variant
21502>>>>>>>>>        Handle hDispatchDriver
21502>>>>>>>>>        Variant retVal
21502>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21503>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_DISPATCH to retVal
21504>>>>>>>>>        Function_Return retVal
21505>>>>>>>>>    End_Function
21506>>>>>>>>>End_Class
21507>>>>>>>>>
21507>>>>>>>>>// CoClass
21507>>>>>>>>>// CLSID: {A111E32A-73F4-4849-A08C-8A64228AA2E3}
21507>>>>>>>>>Class cCJRibbonGroups is a cComAutomationObject
21508>>>>>>>>>    Import_Class_Protocol cCJIRibbonGroups
21509>>>>>>>>>
21509>>>>>>>>>    Procedure Construct_Object
21511>>>>>>>>>        Forward Send Construct_Object
21513>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
21514>>>>>>>>>    End_Procedure
21515>>>>>>>>>End_Class
21516>>>>>>>>>
21516>>>>>>>>>// CLSID: {A33113E7-46A4-4F99-83D8-C6D3C2B390FC}
21516>>>>>>>>>Class cCJIRibbonTab is a Mixin
21517>>>>>>>>>
21517>>>>>>>>>    Function ComCaption Returns String
21519>>>>>>>>>        String retVal
21519>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
21520>>>>>>>>>        Function_Return retVal
21521>>>>>>>>>    End_Function
21522>>>>>>>>>
21522>>>>>>>>>    Procedure Set ComCaption String value
21524>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
21525>>>>>>>>>    End_Procedure
21526>>>>>>>>>
21526>>>>>>>>>    Function ComTag Returns Variant
21528>>>>>>>>>        Variant retVal
21528>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_VARIANT to retVal
21529>>>>>>>>>        Function_Return retVal
21530>>>>>>>>>    End_Function
21531>>>>>>>>>
21531>>>>>>>>>    Procedure Set ComTag Variant value
21533>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_VARIANT to value
21534>>>>>>>>>    End_Procedure
21535>>>>>>>>>
21535>>>>>>>>>    Function ComSelected Returns Boolean
21537>>>>>>>>>        Boolean retVal
21537>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
21538>>>>>>>>>        Function_Return retVal
21539>>>>>>>>>    End_Function
21540>>>>>>>>>
21540>>>>>>>>>    Procedure Set ComSelected Boolean value
21542>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
21543>>>>>>>>>    End_Procedure
21544>>>>>>>>>
21544>>>>>>>>>    Function ComImage Returns Integer
21546>>>>>>>>>        Integer retVal
21546>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
21547>>>>>>>>>        Function_Return retVal
21548>>>>>>>>>    End_Function
21549>>>>>>>>>
21549>>>>>>>>>    Procedure Set ComImage Integer value
21551>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
21552>>>>>>>>>    End_Procedure
21553>>>>>>>>>
21553>>>>>>>>>    Function ComVisible Returns Boolean
21555>>>>>>>>>        Boolean retVal
21555>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
21556>>>>>>>>>        Function_Return retVal
21557>>>>>>>>>    End_Function
21558>>>>>>>>>
21558>>>>>>>>>    Procedure Set ComVisible Boolean value
21560>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
21561>>>>>>>>>    End_Procedure
21562>>>>>>>>>
21562>>>>>>>>>    Function ComEnabled Returns Boolean
21564>>>>>>>>>        Boolean retVal
21564>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to retVal
21565>>>>>>>>>        Function_Return retVal
21566>>>>>>>>>    End_Function
21567>>>>>>>>>
21567>>>>>>>>>    Procedure Set ComEnabled Boolean value
21569>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BOOL to value
21570>>>>>>>>>    End_Procedure
21571>>>>>>>>>
21571>>>>>>>>>    Function ComToolTip Returns String
21573>>>>>>>>>        String retVal
21573>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
21574>>>>>>>>>        Function_Return retVal
21575>>>>>>>>>    End_Function
21576>>>>>>>>>
21576>>>>>>>>>    Procedure Set ComToolTip String value
21578>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
21579>>>>>>>>>    End_Procedure
21580>>>>>>>>>
21580>>>>>>>>>    Function ComKeyboardTip Returns String
21582>>>>>>>>>        String retVal
21582>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BSTR to retVal
21583>>>>>>>>>        Function_Return retVal
21584>>>>>>>>>    End_Function
21585>>>>>>>>>
21585>>>>>>>>>    Procedure Set ComKeyboardTip String value
21587>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 53 OLE_VT_BSTR to value
21588>>>>>>>>>    End_Procedure
21589>>>>>>>>>
21589>>>>>>>>>    Function ComId Returns Integer
21591>>>>>>>>>        Integer retVal
21591>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to retVal
21592>>>>>>>>>        Function_Return retVal
21593>>>>>>>>>    End_Function
21594>>>>>>>>>
21594>>>>>>>>>    Procedure Set ComId Integer value
21596>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_I4 to value
21597>>>>>>>>>    End_Procedure
21598>>>>>>>>>
21598>>>>>>>>>    Function ComColor Returns XTPRibbonTabContextColor
21600>>>>>>>>>        XTPRibbonTabContextColor retVal
21600>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_I4 to retVal
21601>>>>>>>>>        Function_Return retVal
21602>>>>>>>>>    End_Function
21603>>>>>>>>>
21603>>>>>>>>>    Procedure Set ComColor XTPRibbonTabContextColor value
21605>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 51 OLE_VT_I4 to value
21606>>>>>>>>>    End_Procedure
21607>>>>>>>>>
21607>>>>>>>>>    Function ComContextCaption Returns String
21609>>>>>>>>>        String retVal
21609>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_BSTR to retVal
21610>>>>>>>>>        Function_Return retVal
21611>>>>>>>>>    End_Function
21612>>>>>>>>>
21612>>>>>>>>>    Procedure Set ComContextCaption String value
21614>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_BSTR to value
21615>>>>>>>>>    End_Procedure
21616>>>>>>>>>
21616>>>>>>>>>    Function ComCustomizeCaption Returns String
21618>>>>>>>>>        String retVal
21618>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 54 OLE_VT_BSTR to retVal
21619>>>>>>>>>        Function_Return retVal
21620>>>>>>>>>    End_Function
21621>>>>>>>>>
21621>>>>>>>>>    Procedure Set ComCustomizeCaption String value
21623>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 54 OLE_VT_BSTR to value
21624>>>>>>>>>    End_Procedure
21625>>>>>>>>>
21625>>>>>>>>>    Function ComIndex Returns Integer
21627>>>>>>>>>        Handle hDispatchDriver
21627>>>>>>>>>        Integer retVal
21627>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21628>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_I4 to retVal
21629>>>>>>>>>        Function_Return retVal
21630>>>>>>>>>    End_Function
21631>>>>>>>>>
21631>>>>>>>>>    Procedure ComMove Integer llIndex
21633>>>>>>>>>        Handle hDispatchDriver
21633>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21634>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21635>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
21636>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
21637>>>>>>>>>    End_Procedure
21638>>>>>>>>>
21638>>>>>>>>>    Function ComRibbonBar Returns Variant
21640>>>>>>>>>        Handle hDispatchDriver
21640>>>>>>>>>        Variant retVal
21640>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21641>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_DISPATCH to retVal
21642>>>>>>>>>        Function_Return retVal
21643>>>>>>>>>    End_Function
21644>>>>>>>>>
21644>>>>>>>>>    Function ComGroups Returns Variant
21646>>>>>>>>>        Handle hDispatchDriver
21646>>>>>>>>>        Variant retVal
21646>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21647>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_DISPATCH to retVal
21648>>>>>>>>>        Function_Return retVal
21649>>>>>>>>>    End_Function
21650>>>>>>>>>
21650>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
21652>>>>>>>>>        Handle hDispatchDriver
21652>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21653>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
21654>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
21655>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
21656>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
21657>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
21658>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 110 OLE_VT_VOID
21659>>>>>>>>>    End_Procedure
21660>>>>>>>>>End_Class
21661>>>>>>>>>
21661>>>>>>>>>// CoClass
21661>>>>>>>>>// CLSID: {A331E32A-73F4-4849-A08C-8A64228AA2E3}
21661>>>>>>>>>Class cCJRibbonTab is a cComAutomationObject
21662>>>>>>>>>    Import_Class_Protocol cCJIRibbonTab
21663>>>>>>>>>
21663>>>>>>>>>    Procedure Construct_Object
21665>>>>>>>>>        Forward Send Construct_Object
21667>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
21668>>>>>>>>>    End_Procedure
21669>>>>>>>>>End_Class
21670>>>>>>>>>
21670>>>>>>>>>// CLSID: {ADD113E7-46A4-4F99-83D8-C6D3C2B390FC}
21670>>>>>>>>>Class cCJIRibbonBar is a Mixin
21671>>>>>>>>>
21671>>>>>>>>>    Function ComTitle Returns String
21673>>>>>>>>>        String retVal
21673>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
21674>>>>>>>>>        Function_Return retVal
21675>>>>>>>>>    End_Function
21676>>>>>>>>>
21676>>>>>>>>>    Procedure Set ComTitle String value
21678>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
21679>>>>>>>>>    End_Procedure
21680>>>>>>>>>
21680>>>>>>>>>    Function ComVisible Returns Boolean
21682>>>>>>>>>        Boolean retVal
21682>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
21683>>>>>>>>>        Function_Return retVal
21684>>>>>>>>>    End_Function
21685>>>>>>>>>
21685>>>>>>>>>    Procedure Set ComVisible Boolean value
21687>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
21688>>>>>>>>>    End_Procedure
21689>>>>>>>>>
21689>>>>>>>>>    Function ComPosition Returns XTPBarPosition
21691>>>>>>>>>        XTPBarPosition retVal
21691>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
21692>>>>>>>>>        Function_Return retVal
21693>>>>>>>>>    End_Function
21694>>>>>>>>>
21694>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
21696>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
21697>>>>>>>>>    End_Procedure
21698>>>>>>>>>
21698>>>>>>>>>    Function ComBarID Returns Integer
21700>>>>>>>>>        Integer retVal
21700>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
21701>>>>>>>>>        Function_Return retVal
21702>>>>>>>>>    End_Function
21703>>>>>>>>>
21703>>>>>>>>>    Procedure Set ComBarID Integer value
21705>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
21706>>>>>>>>>    End_Procedure
21707>>>>>>>>>
21707>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
21709>>>>>>>>>        Boolean retVal
21709>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
21710>>>>>>>>>        Function_Return retVal
21711>>>>>>>>>    End_Function
21712>>>>>>>>>
21712>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
21714>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
21715>>>>>>>>>    End_Procedure
21716>>>>>>>>>
21716>>>>>>>>>    Function ComWidth Returns Integer
21718>>>>>>>>>        Integer retVal
21718>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
21719>>>>>>>>>        Function_Return retVal
21720>>>>>>>>>    End_Function
21721>>>>>>>>>
21721>>>>>>>>>    Procedure Set ComWidth Integer value
21723>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
21724>>>>>>>>>    End_Procedure
21725>>>>>>>>>
21725>>>>>>>>>    Function ComCloseable Returns Boolean
21727>>>>>>>>>        Boolean retVal
21727>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
21728>>>>>>>>>        Function_Return retVal
21729>>>>>>>>>    End_Function
21730>>>>>>>>>
21730>>>>>>>>>    Procedure Set ComCloseable Boolean value
21732>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
21733>>>>>>>>>    End_Procedure
21734>>>>>>>>>
21734>>>>>>>>>    Function ComEnableAnimation Returns Boolean
21736>>>>>>>>>        Boolean retVal
21736>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
21737>>>>>>>>>        Function_Return retVal
21738>>>>>>>>>    End_Function
21739>>>>>>>>>
21739>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
21741>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
21742>>>>>>>>>    End_Procedure
21743>>>>>>>>>
21743>>>>>>>>>    Function ComShowGripper Returns Boolean
21745>>>>>>>>>        Boolean retVal
21745>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
21746>>>>>>>>>        Function_Return retVal
21747>>>>>>>>>    End_Function
21748>>>>>>>>>
21748>>>>>>>>>    Procedure Set ComShowGripper Boolean value
21750>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
21751>>>>>>>>>    End_Procedure
21752>>>>>>>>>
21752>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
21754>>>>>>>>>        XTPButtonStyle retVal
21754>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
21755>>>>>>>>>        Function_Return retVal
21756>>>>>>>>>    End_Function
21757>>>>>>>>>
21757>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
21759>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
21760>>>>>>>>>    End_Procedure
21761>>>>>>>>>
21761>>>>>>>>>    Function ComCustomizable Returns Boolean
21763>>>>>>>>>        Boolean retVal
21763>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
21764>>>>>>>>>        Function_Return retVal
21765>>>>>>>>>    End_Function
21766>>>>>>>>>
21766>>>>>>>>>    Procedure Set ComCustomizable Boolean value
21768>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
21769>>>>>>>>>    End_Procedure
21770>>>>>>>>>
21770>>>>>>>>>    Function ComSelectedControl Returns Variant
21772>>>>>>>>>        Variant retVal
21772>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to retVal
21773>>>>>>>>>        Function_Return retVal
21774>>>>>>>>>    End_Function
21775>>>>>>>>>
21775>>>>>>>>>    Procedure Set ComSelectedControl Variant value
21777>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to value
21778>>>>>>>>>    End_Procedure
21779>>>>>>>>>
21779>>>>>>>>>    Function ComGroupsVisible Returns Boolean
21781>>>>>>>>>        Boolean retVal
21781>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 104 OLE_VT_BOOL to retVal
21782>>>>>>>>>        Function_Return retVal
21783>>>>>>>>>    End_Function
21784>>>>>>>>>
21784>>>>>>>>>    Procedure Set ComGroupsVisible Boolean value
21786>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 104 OLE_VT_BOOL to value
21787>>>>>>>>>    End_Procedure
21788>>>>>>>>>
21788>>>>>>>>>    Function ComSelectedTab Returns Variant
21790>>>>>>>>>        Variant retVal
21790>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 105 OLE_VT_DISPATCH to retVal
21791>>>>>>>>>        Function_Return retVal
21792>>>>>>>>>    End_Function
21793>>>>>>>>>
21793>>>>>>>>>    Procedure Set ComSelectedTab Variant value
21795>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 105 OLE_VT_DISPATCH to value
21796>>>>>>>>>    End_Procedure
21797>>>>>>>>>
21797>>>>>>>>>    Function ComMinimumVisibleWidth Returns Integer
21799>>>>>>>>>        Integer retVal
21799>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_I4 to retVal
21800>>>>>>>>>        Function_Return retVal
21801>>>>>>>>>    End_Function
21802>>>>>>>>>
21802>>>>>>>>>    Procedure Set ComMinimumVisibleWidth Integer value
21804>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_I4 to value
21805>>>>>>>>>    End_Procedure
21806>>>>>>>>>
21806>>>>>>>>>    Function ComShowQuickAccessBelowRibbon Returns Boolean
21808>>>>>>>>>        Boolean retVal
21808>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 110 OLE_VT_BOOL to retVal
21809>>>>>>>>>        Function_Return retVal
21810>>>>>>>>>    End_Function
21811>>>>>>>>>
21811>>>>>>>>>    Procedure Set ComShowQuickAccessBelowRibbon Boolean value
21813>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 110 OLE_VT_BOOL to value
21814>>>>>>>>>    End_Procedure
21815>>>>>>>>>
21815>>>>>>>>>    Function ComShowQuickAccess Returns Boolean
21817>>>>>>>>>        Boolean retVal
21817>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 115 OLE_VT_BOOL to retVal
21818>>>>>>>>>        Function_Return retVal
21819>>>>>>>>>    End_Function
21820>>>>>>>>>
21820>>>>>>>>>    Procedure Set ComShowQuickAccess Boolean value
21822>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 115 OLE_VT_BOOL to value
21823>>>>>>>>>    End_Procedure
21824>>>>>>>>>
21824>>>>>>>>>    Function ComAllowQuickAccessDuplicates Returns Boolean
21826>>>>>>>>>        Boolean retVal
21826>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 116 OLE_VT_BOOL to retVal
21827>>>>>>>>>        Function_Return retVal
21828>>>>>>>>>    End_Function
21829>>>>>>>>>
21829>>>>>>>>>    Procedure Set ComAllowQuickAccessDuplicates Boolean value
21831>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 116 OLE_VT_BOOL to value
21832>>>>>>>>>    End_Procedure
21833>>>>>>>>>
21833>>>>>>>>>    Function ComAllowMinimize Returns Boolean
21835>>>>>>>>>        Boolean retVal
21835>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 117 OLE_VT_BOOL to retVal
21836>>>>>>>>>        Function_Return retVal
21837>>>>>>>>>    End_Function
21838>>>>>>>>>
21838>>>>>>>>>    Procedure Set ComAllowMinimize Boolean value
21840>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 117 OLE_VT_BOOL to value
21841>>>>>>>>>    End_Procedure
21842>>>>>>>>>
21842>>>>>>>>>    Function ComMinimized Returns Boolean
21844>>>>>>>>>        Boolean retVal
21844>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 118 OLE_VT_BOOL to retVal
21845>>>>>>>>>        Function_Return retVal
21846>>>>>>>>>    End_Function
21847>>>>>>>>>
21847>>>>>>>>>    Procedure Set ComMinimized Boolean value
21849>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 118 OLE_VT_BOOL to value
21850>>>>>>>>>    End_Procedure
21851>>>>>>>>>
21851>>>>>>>>>    Function ComFontHeight Returns Integer
21853>>>>>>>>>        Integer retVal
21853>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 119 OLE_VT_I4 to retVal
21854>>>>>>>>>        Function_Return retVal
21855>>>>>>>>>    End_Function
21856>>>>>>>>>
21856>>>>>>>>>    Procedure Set ComFontHeight Integer value
21858>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 119 OLE_VT_I4 to value
21859>>>>>>>>>    End_Procedure
21860>>>>>>>>>
21860>>>>>>>>>    Function ComTabsVisible Returns Boolean
21862>>>>>>>>>        Boolean retVal
21862>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_BOOL to retVal
21863>>>>>>>>>        Function_Return retVal
21864>>>>>>>>>    End_Function
21865>>>>>>>>>
21865>>>>>>>>>    Procedure Set ComTabsVisible Boolean value
21867>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_BOOL to value
21868>>>>>>>>>    End_Procedure
21869>>>>>>>>>
21869>>>>>>>>>    Function ComShowCaptionAlways Returns Boolean
21871>>>>>>>>>        Boolean retVal
21871>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 123 OLE_VT_BOOL to retVal
21872>>>>>>>>>        Function_Return retVal
21873>>>>>>>>>    End_Function
21874>>>>>>>>>
21874>>>>>>>>>    Procedure Set ComShowCaptionAlways Boolean value
21876>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 123 OLE_VT_BOOL to value
21877>>>>>>>>>    End_Procedure
21878>>>>>>>>>
21878>>>>>>>>>    Function ComAllowQuickAccessCustomization Returns Boolean
21880>>>>>>>>>        Boolean retVal
21880>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 124 OLE_VT_BOOL to retVal
21881>>>>>>>>>        Function_Return retVal
21882>>>>>>>>>    End_Function
21883>>>>>>>>>
21883>>>>>>>>>    Procedure Set ComAllowQuickAccessCustomization Boolean value
21885>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 124 OLE_VT_BOOL to value
21886>>>>>>>>>    End_Procedure
21887>>>>>>>>>
21887>>>>>>>>>    Function ComGroupsHeight Returns Integer
21889>>>>>>>>>        Integer retVal
21889>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 125 OLE_VT_I4 to retVal
21890>>>>>>>>>        Function_Return retVal
21891>>>>>>>>>    End_Function
21892>>>>>>>>>
21892>>>>>>>>>    Procedure Set ComGroupsHeight Integer value
21894>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 125 OLE_VT_I4 to value
21895>>>>>>>>>    End_Procedure
21896>>>>>>>>>
21896>>>>>>>>>    Function ComClientHeight Returns Integer
21898>>>>>>>>>        Integer retVal
21898>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 126 OLE_VT_I4 to retVal
21899>>>>>>>>>        Function_Return retVal
21900>>>>>>>>>    End_Function
21901>>>>>>>>>
21901>>>>>>>>>    Procedure Set ComClientHeight Integer value
21903>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 126 OLE_VT_I4 to value
21904>>>>>>>>>    End_Procedure
21905>>>>>>>>>
21905>>>>>>>>>    Function ComQuickAccessEmptyIconId Returns Integer
21907>>>>>>>>>        Integer retVal
21907>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 130 OLE_VT_I4 to retVal
21908>>>>>>>>>        Function_Return retVal
21909>>>>>>>>>    End_Function
21910>>>>>>>>>
21910>>>>>>>>>    Procedure Set ComQuickAccessEmptyIconId Integer value
21912>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 130 OLE_VT_I4 to value
21913>>>>>>>>>    End_Procedure
21914>>>>>>>>>
21914>>>>>>>>>    Function ComSystemButton Returns Variant
21916>>>>>>>>>        Variant retVal
21916>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 128 OLE_VT_DISPATCH to retVal
21917>>>>>>>>>        Function_Return retVal
21918>>>>>>>>>    End_Function
21919>>>>>>>>>
21919>>>>>>>>>    Procedure Set ComSystemButton Variant value
21921>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 128 OLE_VT_DISPATCH to value
21922>>>>>>>>>    End_Procedure
21923>>>>>>>>>
21923>>>>>>>>>    Function ComType Returns XTPBarType
21925>>>>>>>>>        Handle hDispatchDriver
21925>>>>>>>>>        XTPBarType retVal
21925>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21926>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
21927>>>>>>>>>        Function_Return retVal
21928>>>>>>>>>    End_Function
21929>>>>>>>>>
21929>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
21931>>>>>>>>>        Handle hDispatchDriver
21931>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21932>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
21933>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
21934>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
21935>>>>>>>>>    End_Procedure
21936>>>>>>>>>
21936>>>>>>>>>    Function ComBuiltIn Returns Boolean
21938>>>>>>>>>        Handle hDispatchDriver
21938>>>>>>>>>        Boolean retVal
21938>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21939>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
21940>>>>>>>>>        Function_Return retVal
21941>>>>>>>>>    End_Function
21942>>>>>>>>>
21942>>>>>>>>>    Procedure ComDelete
21944>>>>>>>>>        Handle hDispatchDriver
21944>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21945>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
21946>>>>>>>>>    End_Procedure
21947>>>>>>>>>
21947>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
21949>>>>>>>>>        Handle hDispatchDriver
21949>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21950>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
21951>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
21952>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
21953>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
21954>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
21955>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
21956>>>>>>>>>    End_Procedure
21957>>>>>>>>>
21957>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
21959>>>>>>>>>        Handle hDispatchDriver
21959>>>>>>>>>        OLE_HANDLE retVal
21959>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21960>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
21961>>>>>>>>>        Function_Return retVal
21962>>>>>>>>>    End_Function
21963>>>>>>>>>
21963>>>>>>>>>    Function ComCommandBars Returns Variant
21965>>>>>>>>>        Handle hDispatchDriver
21965>>>>>>>>>        Variant retVal
21965>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21966>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
21967>>>>>>>>>        Function_Return retVal
21968>>>>>>>>>    End_Function
21969>>>>>>>>>
21969>>>>>>>>>    Function ComControls Returns Variant
21971>>>>>>>>>        Handle hDispatchDriver
21971>>>>>>>>>        Variant retVal
21971>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21972>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
21973>>>>>>>>>        Function_Return retVal
21974>>>>>>>>>    End_Function
21975>>>>>>>>>
21975>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
21977>>>>>>>>>        Handle hDispatchDriver
21977>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21978>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21979>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
21980>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
21981>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
21982>>>>>>>>>    End_Procedure
21983>>>>>>>>>
21983>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
21985>>>>>>>>>        Handle hDispatchDriver
21985>>>>>>>>>        Variant retVal
21985>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21986>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
21987>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
21988>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
21989>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
21990>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
21991>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
21992>>>>>>>>>        Function_Return retVal
21993>>>>>>>>>    End_Function
21994>>>>>>>>>
21994>>>>>>>>>    Procedure ComSetFlags XTPMenuBarFlags llAdd XTPMenuBarFlags llRemove
21996>>>>>>>>>        Handle hDispatchDriver
21996>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
21997>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
21998>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
21999>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
22000>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
22001>>>>>>>>>    End_Procedure
22002>>>>>>>>>
22002>>>>>>>>>    Procedure ComRedrawBar
22004>>>>>>>>>        Handle hDispatchDriver
22004>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22005>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
22006>>>>>>>>>    End_Procedure
22007>>>>>>>>>
22007>>>>>>>>>    Procedure ComRecalcLayout
22009>>>>>>>>>        Handle hDispatchDriver
22009>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22010>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
22011>>>>>>>>>    End_Procedure
22012>>>>>>>>>
22012>>>>>>>>>    Procedure ComReset
22014>>>>>>>>>        Handle hDispatchDriver
22014>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22015>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
22016>>>>>>>>>    End_Procedure
22017>>>>>>>>>
22017>>>>>>>>>    Function ComInsertTab Integer llIndex String llCaption Returns Variant
22019>>>>>>>>>        Handle hDispatchDriver
22019>>>>>>>>>        Variant retVal
22019>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22020>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22021>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22022>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
22023>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_DISPATCH to retVal
22024>>>>>>>>>        Function_Return retVal
22025>>>>>>>>>    End_Function
22026>>>>>>>>>
22026>>>>>>>>>    Function ComTabCount Returns Integer
22028>>>>>>>>>        Handle hDispatchDriver
22028>>>>>>>>>        Integer retVal
22028>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22029>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_I4 to retVal
22030>>>>>>>>>        Function_Return retVal
22031>>>>>>>>>    End_Function
22032>>>>>>>>>
22032>>>>>>>>>    Function ComTab Integer llIndex Returns Variant
22034>>>>>>>>>        Handle hDispatchDriver
22034>>>>>>>>>        Variant retVal
22034>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22035>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22036>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22037>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
22038>>>>>>>>>        Function_Return retVal
22039>>>>>>>>>    End_Function
22040>>>>>>>>>
22040>>>>>>>>>    Function Com_NewEnum Returns Variant
22042>>>>>>>>>        Handle hDispatchDriver
22042>>>>>>>>>        Variant retVal
22042>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22043>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
22044>>>>>>>>>        Function_Return retVal
22045>>>>>>>>>    End_Function
22046>>>>>>>>>
22046>>>>>>>>>    Function ComRibbonPaintManager Returns Variant
22048>>>>>>>>>        Handle hDispatchDriver
22048>>>>>>>>>        Variant retVal
22048>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22049>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 102 OLE_VT_DISPATCH to retVal
22050>>>>>>>>>        Function_Return retVal
22051>>>>>>>>>    End_Function
22052>>>>>>>>>
22052>>>>>>>>>    Function ComTabPaintManager Returns Variant
22054>>>>>>>>>        Handle hDispatchDriver
22054>>>>>>>>>        Variant retVal
22054>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22055>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 103 OLE_VT_DISPATCH to retVal
22056>>>>>>>>>        Function_Return retVal
22057>>>>>>>>>    End_Function
22058>>>>>>>>>
22058>>>>>>>>>    Procedure ComEnableFrameTheme
22060>>>>>>>>>        Handle hDispatchDriver
22060>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22061>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 107 OLE_VT_VOID
22062>>>>>>>>>    End_Procedure
22063>>>>>>>>>
22063>>>>>>>>>    Function ComAddSystemButton Returns Variant
22065>>>>>>>>>        Handle hDispatchDriver
22065>>>>>>>>>        Variant retVal
22065>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22066>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 108 OLE_VT_DISPATCH to retVal
22067>>>>>>>>>        Function_Return retVal
22068>>>>>>>>>    End_Function
22069>>>>>>>>>
22069>>>>>>>>>    Function ComQuickAccessControls Returns Variant
22071>>>>>>>>>        Handle hDispatchDriver
22071>>>>>>>>>        Variant retVal
22071>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22072>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 109 OLE_VT_DISPATCH to retVal
22073>>>>>>>>>        Function_Return retVal
22074>>>>>>>>>    End_Function
22075>>>>>>>>>
22075>>>>>>>>>    Function ComFindTab Integer llId Returns Variant
22077>>>>>>>>>        Handle hDispatchDriver
22077>>>>>>>>>        Variant retVal
22077>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22078>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22079>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22080>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 111 OLE_VT_DISPATCH to retVal
22081>>>>>>>>>        Function_Return retVal
22082>>>>>>>>>    End_Function
22083>>>>>>>>>
22083>>>>>>>>>    Function ComFindGroup Integer llId Returns Variant
22085>>>>>>>>>        Handle hDispatchDriver
22085>>>>>>>>>        Variant retVal
22085>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22086>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22087>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22088>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 112 OLE_VT_DISPATCH to retVal
22089>>>>>>>>>        Function_Return retVal
22090>>>>>>>>>    End_Function
22091>>>>>>>>>
22091>>>>>>>>>    Procedure ComRemoveAllTabs
22093>>>>>>>>>        Handle hDispatchDriver
22093>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22094>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 113 OLE_VT_VOID
22095>>>>>>>>>    End_Procedure
22096>>>>>>>>>
22096>>>>>>>>>    Procedure ComRemoveTab Integer llIndex
22098>>>>>>>>>        Handle hDispatchDriver
22098>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22099>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22100>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22101>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 114 OLE_VT_VOID
22102>>>>>>>>>    End_Procedure
22103>>>>>>>>>
22103>>>>>>>>>    Function ComControlQuickAccess Returns Variant
22105>>>>>>>>>        Handle hDispatchDriver
22105>>>>>>>>>        Variant retVal
22105>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22106>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 120 OLE_VT_DISPATCH to retVal
22107>>>>>>>>>        Function_Return retVal
22108>>>>>>>>>    End_Function
22109>>>>>>>>>
22109>>>>>>>>>    Function ComControlSystemButton Returns Variant
22111>>>>>>>>>        Handle hDispatchDriver
22111>>>>>>>>>        Variant retVal
22111>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22112>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 121 OLE_VT_DISPATCH to retVal
22113>>>>>>>>>        Function_Return retVal
22114>>>>>>>>>    End_Function
22115>>>>>>>>>End_Class
22116>>>>>>>>>
22116>>>>>>>>>// CoClass
22116>>>>>>>>>// CLSID: {ADD1E32A-73F4-4849-A08C-8A64228AA2E3}
22116>>>>>>>>>Class cCJRibbonBar is a cComAutomationObject
22117>>>>>>>>>    Import_Class_Protocol cCJIRibbonBar
22118>>>>>>>>>
22118>>>>>>>>>    Procedure Construct_Object
22120>>>>>>>>>        Forward Send Construct_Object
22122>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
22123>>>>>>>>>    End_Procedure
22124>>>>>>>>>End_Class
22125>>>>>>>>>
22125>>>>>>>>>// CLSID: {235113E7-46A4-4F99-83D8-C6D3C2B390FC}
22125>>>>>>>>>Class cCJIDialogBar is a Mixin
22126>>>>>>>>>
22126>>>>>>>>>    Function ComTitle Returns String
22128>>>>>>>>>        String retVal
22128>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
22129>>>>>>>>>        Function_Return retVal
22130>>>>>>>>>    End_Function
22131>>>>>>>>>
22131>>>>>>>>>    Procedure Set ComTitle String value
22133>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
22134>>>>>>>>>    End_Procedure
22135>>>>>>>>>
22135>>>>>>>>>    Function ComVisible Returns Boolean
22137>>>>>>>>>        Boolean retVal
22137>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
22138>>>>>>>>>        Function_Return retVal
22139>>>>>>>>>    End_Function
22140>>>>>>>>>
22140>>>>>>>>>    Procedure Set ComVisible Boolean value
22142>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
22143>>>>>>>>>    End_Procedure
22144>>>>>>>>>
22144>>>>>>>>>    Function ComPosition Returns XTPBarPosition
22146>>>>>>>>>        XTPBarPosition retVal
22146>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
22147>>>>>>>>>        Function_Return retVal
22148>>>>>>>>>    End_Function
22149>>>>>>>>>
22149>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
22151>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
22152>>>>>>>>>    End_Procedure
22153>>>>>>>>>
22153>>>>>>>>>    Function ComBarID Returns Integer
22155>>>>>>>>>        Integer retVal
22155>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
22156>>>>>>>>>        Function_Return retVal
22157>>>>>>>>>    End_Function
22158>>>>>>>>>
22158>>>>>>>>>    Procedure Set ComBarID Integer value
22160>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
22161>>>>>>>>>    End_Procedure
22162>>>>>>>>>
22162>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
22164>>>>>>>>>        Boolean retVal
22164>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
22165>>>>>>>>>        Function_Return retVal
22166>>>>>>>>>    End_Function
22167>>>>>>>>>
22167>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
22169>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
22170>>>>>>>>>    End_Procedure
22171>>>>>>>>>
22171>>>>>>>>>    Function ComWidth Returns Integer
22173>>>>>>>>>        Integer retVal
22173>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
22174>>>>>>>>>        Function_Return retVal
22175>>>>>>>>>    End_Function
22176>>>>>>>>>
22176>>>>>>>>>    Procedure Set ComWidth Integer value
22178>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
22179>>>>>>>>>    End_Procedure
22180>>>>>>>>>
22180>>>>>>>>>    Function ComCloseable Returns Boolean
22182>>>>>>>>>        Boolean retVal
22182>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
22183>>>>>>>>>        Function_Return retVal
22184>>>>>>>>>    End_Function
22185>>>>>>>>>
22185>>>>>>>>>    Procedure Set ComCloseable Boolean value
22187>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
22188>>>>>>>>>    End_Procedure
22189>>>>>>>>>
22189>>>>>>>>>    Function ComEnableAnimation Returns Boolean
22191>>>>>>>>>        Boolean retVal
22191>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
22192>>>>>>>>>        Function_Return retVal
22193>>>>>>>>>    End_Function
22194>>>>>>>>>
22194>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
22196>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
22197>>>>>>>>>    End_Procedure
22198>>>>>>>>>
22198>>>>>>>>>    Function ComShowGripper Returns Boolean
22200>>>>>>>>>        Boolean retVal
22200>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
22201>>>>>>>>>        Function_Return retVal
22202>>>>>>>>>    End_Function
22203>>>>>>>>>
22203>>>>>>>>>    Procedure Set ComShowGripper Boolean value
22205>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
22206>>>>>>>>>    End_Procedure
22207>>>>>>>>>
22207>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
22209>>>>>>>>>        XTPButtonStyle retVal
22209>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
22210>>>>>>>>>        Function_Return retVal
22211>>>>>>>>>    End_Function
22212>>>>>>>>>
22212>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
22214>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
22215>>>>>>>>>    End_Procedure
22216>>>>>>>>>
22216>>>>>>>>>    Function ComCaption Returns String
22218>>>>>>>>>        String retVal
22218>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BSTR to retVal
22219>>>>>>>>>        Function_Return retVal
22220>>>>>>>>>    End_Function
22221>>>>>>>>>
22221>>>>>>>>>    Procedure Set ComCaption String value
22223>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BSTR to value
22224>>>>>>>>>    End_Procedure
22225>>>>>>>>>
22225>>>>>>>>>    Function ComResizable Returns Boolean
22227>>>>>>>>>        Boolean retVal
22227>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BOOL to retVal
22228>>>>>>>>>        Function_Return retVal
22229>>>>>>>>>    End_Function
22230>>>>>>>>>
22230>>>>>>>>>    Procedure Set ComResizable Boolean value
22232>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BOOL to value
22233>>>>>>>>>    End_Procedure
22234>>>>>>>>>
22234>>>>>>>>>    Function ComChildHandle Returns OLE_HANDLE
22236>>>>>>>>>        OLE_HANDLE retVal
22236>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 103 OLE_VT_I4 to retVal
22237>>>>>>>>>        Function_Return retVal
22238>>>>>>>>>    End_Function
22239>>>>>>>>>
22239>>>>>>>>>    Procedure Set ComChildHandle OLE_HANDLE value
22241>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 103 OLE_VT_I4 to value
22242>>>>>>>>>    End_Procedure
22243>>>>>>>>>
22243>>>>>>>>>    Function ComShowCaption Returns Boolean
22245>>>>>>>>>        Boolean retVal
22245>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 105 OLE_VT_BOOL to retVal
22246>>>>>>>>>        Function_Return retVal
22247>>>>>>>>>    End_Function
22248>>>>>>>>>
22248>>>>>>>>>    Procedure Set ComShowCaption Boolean value
22250>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 105 OLE_VT_BOOL to value
22251>>>>>>>>>    End_Procedure
22252>>>>>>>>>
22252>>>>>>>>>    Function ComCaptionPopup Returns Boolean
22254>>>>>>>>>        Boolean retVal
22254>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_BOOL to retVal
22255>>>>>>>>>        Function_Return retVal
22256>>>>>>>>>    End_Function
22257>>>>>>>>>
22257>>>>>>>>>    Procedure Set ComCaptionPopup Boolean value
22259>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 106 OLE_VT_BOOL to value
22260>>>>>>>>>    End_Procedure
22261>>>>>>>>>
22261>>>>>>>>>    Function ComType Returns XTPBarType
22263>>>>>>>>>        Handle hDispatchDriver
22263>>>>>>>>>        XTPBarType retVal
22263>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22264>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
22265>>>>>>>>>        Function_Return retVal
22266>>>>>>>>>    End_Function
22267>>>>>>>>>
22267>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
22269>>>>>>>>>        Handle hDispatchDriver
22269>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22270>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22271>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
22272>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
22273>>>>>>>>>    End_Procedure
22274>>>>>>>>>
22274>>>>>>>>>    Function ComBuiltIn Returns Boolean
22276>>>>>>>>>        Handle hDispatchDriver
22276>>>>>>>>>        Boolean retVal
22276>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22277>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
22278>>>>>>>>>        Function_Return retVal
22279>>>>>>>>>    End_Function
22280>>>>>>>>>
22280>>>>>>>>>    Procedure ComDelete
22282>>>>>>>>>        Handle hDispatchDriver
22282>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22283>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
22284>>>>>>>>>    End_Procedure
22285>>>>>>>>>
22285>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
22287>>>>>>>>>        Handle hDispatchDriver
22287>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22288>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
22289>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
22290>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
22291>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
22292>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
22293>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
22294>>>>>>>>>    End_Procedure
22295>>>>>>>>>
22295>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
22297>>>>>>>>>        Handle hDispatchDriver
22297>>>>>>>>>        OLE_HANDLE retVal
22297>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22298>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
22299>>>>>>>>>        Function_Return retVal
22300>>>>>>>>>    End_Function
22301>>>>>>>>>
22301>>>>>>>>>    Function ComCommandBars Returns Variant
22303>>>>>>>>>        Handle hDispatchDriver
22303>>>>>>>>>        Variant retVal
22303>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22304>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
22305>>>>>>>>>        Function_Return retVal
22306>>>>>>>>>    End_Function
22307>>>>>>>>>
22307>>>>>>>>>    Function ComCaptionPopupBar Returns Variant
22309>>>>>>>>>        Handle hDispatchDriver
22309>>>>>>>>>        Variant retVal
22309>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22310>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 102 OLE_VT_DISPATCH to retVal
22311>>>>>>>>>        Function_Return retVal
22312>>>>>>>>>    End_Function
22313>>>>>>>>>
22313>>>>>>>>>    Procedure ComSetSize Integer llcx Integer llcy
22315>>>>>>>>>        Handle hDispatchDriver
22315>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22316>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22317>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
22318>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
22319>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 104 OLE_VT_VOID
22320>>>>>>>>>    End_Procedure
22321>>>>>>>>>End_Class
22322>>>>>>>>>
22322>>>>>>>>>// CoClass
22322>>>>>>>>>// CLSID: {FCB1E32A-73F4-4849-A08C-8A64228AA2E3}
22322>>>>>>>>>Class cCJDialogBar is a cComAutomationObject
22323>>>>>>>>>    Import_Class_Protocol cCJIDialogBar
22324>>>>>>>>>
22324>>>>>>>>>    Procedure Construct_Object
22326>>>>>>>>>        Forward Send Construct_Object
22328>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
22329>>>>>>>>>    End_Procedure
22330>>>>>>>>>End_Class
22331>>>>>>>>>
22331>>>>>>>>>// CLSID: {555113E7-46A4-4F99-83D8-C6D3C2B390FC}
22331>>>>>>>>>Class cCJIPaintManager is a Mixin
22332>>>>>>>>>
22332>>>>>>>>>    Function ComEnableAnimation Returns Boolean
22334>>>>>>>>>        Boolean retVal
22334>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
22335>>>>>>>>>        Function_Return retVal
22336>>>>>>>>>    End_Function
22337>>>>>>>>>
22337>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
22339>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
22340>>>>>>>>>    End_Procedure
22341>>>>>>>>>
22341>>>>>>>>>    Function ComFlatToolBar Returns Boolean
22343>>>>>>>>>        Boolean retVal
22343>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to retVal
22344>>>>>>>>>        Function_Return retVal
22345>>>>>>>>>    End_Function
22346>>>>>>>>>
22346>>>>>>>>>    Procedure Set ComFlatToolBar Boolean value
22348>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BOOL to value
22349>>>>>>>>>    End_Procedure
22350>>>>>>>>>
22350>>>>>>>>>    Function ComFlatMenuBar Returns Boolean
22352>>>>>>>>>        Boolean retVal
22352>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
22353>>>>>>>>>        Function_Return retVal
22354>>>>>>>>>    End_Function
22355>>>>>>>>>
22355>>>>>>>>>    Procedure Set ComFlatMenuBar Boolean value
22357>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
22358>>>>>>>>>    End_Procedure
22359>>>>>>>>>
22359>>>>>>>>>    Function ComClearTypeTextQuality Returns Boolean
22361>>>>>>>>>        Boolean retVal
22361>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
22362>>>>>>>>>        Function_Return retVal
22363>>>>>>>>>    End_Function
22364>>>>>>>>>
22364>>>>>>>>>    Procedure Set ComClearTypeTextQuality Boolean value
22366>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
22367>>>>>>>>>    End_Procedure
22368>>>>>>>>>
22368>>>>>>>>>    Function ComShowShadow Returns Boolean
22370>>>>>>>>>        Boolean retVal
22370>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
22371>>>>>>>>>        Function_Return retVal
22372>>>>>>>>>    End_Function
22373>>>>>>>>>
22373>>>>>>>>>    Procedure Set ComShowShadow Boolean value
22375>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
22376>>>>>>>>>    End_Procedure
22377>>>>>>>>>
22377>>>>>>>>>    Function ComThemedStatusBar Returns Boolean
22379>>>>>>>>>        Boolean retVal
22379>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
22380>>>>>>>>>        Function_Return retVal
22381>>>>>>>>>    End_Function
22382>>>>>>>>>
22382>>>>>>>>>    Procedure Set ComThemedStatusBar Boolean value
22384>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
22385>>>>>>>>>    End_Procedure
22386>>>>>>>>>
22386>>>>>>>>>    Function ComThickCheckMark Returns Boolean
22388>>>>>>>>>        Boolean retVal
22388>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to retVal
22389>>>>>>>>>        Function_Return retVal
22390>>>>>>>>>    End_Function
22391>>>>>>>>>
22391>>>>>>>>>    Procedure Set ComThickCheckMark Boolean value
22393>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BOOL to value
22394>>>>>>>>>    End_Procedure
22395>>>>>>>>>
22395>>>>>>>>>    Function ComSelectImageInPopupBar Returns Boolean
22397>>>>>>>>>        Boolean retVal
22397>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
22398>>>>>>>>>        Function_Return retVal
22399>>>>>>>>>    End_Function
22400>>>>>>>>>
22400>>>>>>>>>    Procedure Set ComSelectImageInPopupBar Boolean value
22402>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
22403>>>>>>>>>    End_Procedure
22404>>>>>>>>>
22404>>>>>>>>>    Function ComThemedCheckBox Returns Boolean
22406>>>>>>>>>        Boolean retVal
22406>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
22407>>>>>>>>>        Function_Return retVal
22408>>>>>>>>>    End_Function
22409>>>>>>>>>
22409>>>>>>>>>    Procedure Set ComThemedCheckBox Boolean value
22411>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
22412>>>>>>>>>    End_Procedure
22413>>>>>>>>>
22413>>>>>>>>>    Function ComAutoResizeIcons Returns Boolean
22415>>>>>>>>>        Boolean retVal
22415>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
22416>>>>>>>>>        Function_Return retVal
22417>>>>>>>>>    End_Function
22418>>>>>>>>>
22418>>>>>>>>>    Procedure Set ComAutoResizeIcons Boolean value
22420>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
22421>>>>>>>>>    End_Procedure
22422>>>>>>>>>
22422>>>>>>>>>    Procedure ComRefreshMetrics
22424>>>>>>>>>        Handle hDispatchDriver
22424>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22425>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
22426>>>>>>>>>    End_Procedure
22427>>>>>>>>>
22427>>>>>>>>>    Procedure ComFillWorkspace OLE_HANDLE llhDC Integer llx Integer lly Integer llcx Integer llcy
22429>>>>>>>>>        Handle hDispatchDriver
22429>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22430>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
22431>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhDC
22432>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
22433>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
22434>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
22435>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
22436>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
22437>>>>>>>>>    End_Procedure
22438>>>>>>>>>
22438>>>>>>>>>    Procedure ComDrawRectangle OLE_HANDLE llhDC Integer llx Integer lly Integer llcx Integer llcy Boolean llSelected Boolean llPressed Boolean llEnabled Boolean llChecked Boolean llPopuped XTPBarType llbarType XTPBarPosition llbarPosition
22440>>>>>>>>>        Handle hDispatchDriver
22440>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22441>>>>>>>>>        Send PrepareParams to hDispatchDriver 12
22442>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhDC
22443>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
22444>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
22445>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
22446>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
22447>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSelected
22448>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llPressed
22449>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnabled
22450>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llChecked
22451>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llPopuped
22452>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llbarType
22453>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llbarPosition
22454>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
22455>>>>>>>>>    End_Procedure
22456>>>>>>>>>
22456>>>>>>>>>    Function ComGetRectangleTextColor Boolean llSelected Boolean llPressed Boolean llEnabled Boolean llChecked Boolean llPopuped XTPBarType llbarType XTPBarPosition llbarPosition Returns OLE_COLOR
22458>>>>>>>>>        Handle hDispatchDriver
22458>>>>>>>>>        OLE_COLOR retVal
22458>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22459>>>>>>>>>        Send PrepareParams to hDispatchDriver 7
22460>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSelected
22461>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llPressed
22462>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnabled
22463>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llChecked
22464>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llPopuped
22465>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llbarType
22466>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llbarPosition
22467>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_I4 to retVal
22468>>>>>>>>>        Function_Return retVal
22469>>>>>>>>>    End_Function
22470>>>>>>>>>
22470>>>>>>>>>    Procedure ComLoadFrameIcon OLE_HANDLE llModule String llPath Integer llWidth Integer llHeight
22472>>>>>>>>>        Handle hDispatchDriver
22472>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22473>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
22474>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llModule
22475>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
22476>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
22477>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llHeight
22478>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
22479>>>>>>>>>    End_Procedure
22480>>>>>>>>>End_Class
22481>>>>>>>>>
22481>>>>>>>>>// CoClass
22481>>>>>>>>>// CLSID: {55B1E32A-73F4-4849-A08C-8A64228AA2E3}
22481>>>>>>>>>Class cCJPaintManager is a cComAutomationObject
22482>>>>>>>>>    Import_Class_Protocol cCJIPaintManager
22483>>>>>>>>>
22483>>>>>>>>>    Procedure Construct_Object
22485>>>>>>>>>        Forward Send Construct_Object
22487>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
22488>>>>>>>>>    End_Procedure
22489>>>>>>>>>End_Class
22490>>>>>>>>>
22490>>>>>>>>>// CLSID: {F10C6EB2-2F2F-4C05-92CF-6AEB0BFA0E6D}
22490>>>>>>>>>Class cCJITabWorkspace is a Mixin
22491>>>>>>>>>
22491>>>>>>>>>    Function ComFlags Returns XTPWorkspaceButtons
22493>>>>>>>>>        XTPWorkspaceButtons retVal
22493>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
22494>>>>>>>>>        Function_Return retVal
22495>>>>>>>>>    End_Function
22496>>>>>>>>>
22496>>>>>>>>>    Procedure Set ComFlags XTPWorkspaceButtons value
22498>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
22499>>>>>>>>>    End_Procedure
22500>>>>>>>>>
22500>>>>>>>>>    Function ComAllowReorder Returns Boolean
22502>>>>>>>>>        Boolean retVal
22502>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
22503>>>>>>>>>        Function_Return retVal
22504>>>>>>>>>    End_Function
22505>>>>>>>>>
22505>>>>>>>>>    Procedure Set ComAllowReorder Boolean value
22507>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
22508>>>>>>>>>    End_Procedure
22509>>>>>>>>>
22509>>>>>>>>>    Function ComAutoTheme Returns Boolean
22511>>>>>>>>>        Boolean retVal
22511>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
22512>>>>>>>>>        Function_Return retVal
22513>>>>>>>>>    End_Function
22514>>>>>>>>>
22514>>>>>>>>>    Procedure Set ComAutoTheme Boolean value
22516>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
22517>>>>>>>>>    End_Procedure
22518>>>>>>>>>
22518>>>>>>>>>    Function ComThemedBackColor Returns Boolean
22520>>>>>>>>>        Boolean retVal
22520>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
22521>>>>>>>>>        Function_Return retVal
22522>>>>>>>>>    End_Function
22523>>>>>>>>>
22523>>>>>>>>>    Procedure Set ComThemedBackColor Boolean value
22525>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
22526>>>>>>>>>    End_Procedure
22527>>>>>>>>>
22527>>>>>>>>>    Function ComUseSplitterTracker Returns Boolean
22529>>>>>>>>>        Boolean retVal
22529>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
22530>>>>>>>>>        Function_Return retVal
22531>>>>>>>>>    End_Function
22532>>>>>>>>>
22532>>>>>>>>>    Procedure Set ComUseSplitterTracker Boolean value
22534>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
22535>>>>>>>>>    End_Procedure
22536>>>>>>>>>
22536>>>>>>>>>    Function ComHorizGroupSplitting Returns Boolean
22538>>>>>>>>>        Boolean retVal
22538>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
22539>>>>>>>>>        Function_Return retVal
22540>>>>>>>>>    End_Function
22541>>>>>>>>>
22541>>>>>>>>>    Procedure Set ComHorizGroupSplitting Boolean value
22543>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
22544>>>>>>>>>    End_Procedure
22545>>>>>>>>>
22545>>>>>>>>>    Function ComNewTabPosition Returns XTPWorkspaceNewTabPosition
22547>>>>>>>>>        XTPWorkspaceNewTabPosition retVal
22547>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to retVal
22548>>>>>>>>>        Function_Return retVal
22549>>>>>>>>>    End_Function
22550>>>>>>>>>
22550>>>>>>>>>    Procedure Set ComNewTabPosition XTPWorkspaceNewTabPosition value
22552>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to value
22553>>>>>>>>>    End_Procedure
22554>>>>>>>>>
22554>>>>>>>>>    Function ComRightToLeft Returns Boolean
22556>>>>>>>>>        Boolean retVal
22556>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
22557>>>>>>>>>        Function_Return retVal
22558>>>>>>>>>    End_Function
22559>>>>>>>>>
22559>>>>>>>>>    Procedure Set ComRightToLeft Boolean value
22561>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
22562>>>>>>>>>    End_Procedure
22563>>>>>>>>>
22563>>>>>>>>>    Function ComIgnoreFlickersOnActivate Returns Boolean
22565>>>>>>>>>        Boolean retVal
22565>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_BOOL to retVal
22566>>>>>>>>>        Function_Return retVal
22567>>>>>>>>>    End_Function
22568>>>>>>>>>
22568>>>>>>>>>    Procedure Set ComIgnoreFlickersOnActivate Boolean value
22570>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_BOOL to value
22571>>>>>>>>>    End_Procedure
22572>>>>>>>>>
22572>>>>>>>>>    Function ComAutoUpdateTabCaption Returns Boolean
22574>>>>>>>>>        Boolean retVal
22574>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_BOOL to retVal
22575>>>>>>>>>        Function_Return retVal
22576>>>>>>>>>    End_Function
22577>>>>>>>>>
22577>>>>>>>>>    Procedure Set ComAutoUpdateTabCaption Boolean value
22579>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_BOOL to value
22580>>>>>>>>>    End_Procedure
22581>>>>>>>>>
22581>>>>>>>>>    Function ComEnableMarkup Returns Boolean
22583>>>>>>>>>        Boolean retVal
22583>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
22584>>>>>>>>>        Function_Return retVal
22585>>>>>>>>>    End_Function
22586>>>>>>>>>
22586>>>>>>>>>    Procedure Set ComEnableMarkup Boolean value
22588>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
22589>>>>>>>>>    End_Procedure
22590>>>>>>>>>
22590>>>>>>>>>    Function ComPaintManager Returns Variant
22592>>>>>>>>>        Handle hDispatchDriver
22592>>>>>>>>>        Variant retVal
22592>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22593>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
22594>>>>>>>>>        Function_Return retVal
22595>>>>>>>>>    End_Function
22596>>>>>>>>>
22596>>>>>>>>>    Procedure ComEnableGroups
22598>>>>>>>>>        Handle hDispatchDriver
22598>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22599>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
22600>>>>>>>>>    End_Procedure
22601>>>>>>>>>
22601>>>>>>>>>    Procedure ComRefresh
22603>>>>>>>>>        Handle hDispatchDriver
22603>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22604>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
22605>>>>>>>>>    End_Procedure
22606>>>>>>>>>
22606>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
22608>>>>>>>>>        Handle hDispatchDriver
22608>>>>>>>>>        Variant retVal
22608>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22609>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22610>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22611>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
22612>>>>>>>>>        Function_Return retVal
22613>>>>>>>>>    End_Function
22614>>>>>>>>>
22614>>>>>>>>>    Function Com_NewEnum Returns Variant
22616>>>>>>>>>        Handle hDispatchDriver
22616>>>>>>>>>        Variant retVal
22616>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22617>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
22618>>>>>>>>>        Function_Return retVal
22619>>>>>>>>>    End_Function
22620>>>>>>>>>
22620>>>>>>>>>    Function ComItemCount Returns Integer
22622>>>>>>>>>        Handle hDispatchDriver
22622>>>>>>>>>        Integer retVal
22622>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22623>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
22624>>>>>>>>>        Function_Return retVal
22625>>>>>>>>>    End_Function
22626>>>>>>>>>
22626>>>>>>>>>    Function ComHitTest Integer llx Integer lly Returns Variant
22628>>>>>>>>>        Handle hDispatchDriver
22628>>>>>>>>>        Variant retVal
22628>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22629>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22630>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
22631>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
22632>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_DISPATCH to retVal
22633>>>>>>>>>        Function_Return retVal
22634>>>>>>>>>    End_Function
22635>>>>>>>>>
22635>>>>>>>>>    Function ComSelected Returns Variant
22637>>>>>>>>>        Handle hDispatchDriver
22637>>>>>>>>>        Variant retVal
22637>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22638>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_DISPATCH to retVal
22639>>>>>>>>>        Function_Return retVal
22640>>>>>>>>>    End_Function
22641>>>>>>>>>
22641>>>>>>>>>    Procedure ComDoWorkspaceCommand XTPWorkspaceCommand llId
22643>>>>>>>>>        Handle hDispatchDriver
22643>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22644>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22645>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22646>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
22647>>>>>>>>>    End_Procedure
22648>>>>>>>>>
22648>>>>>>>>>    Function ComIsWorkspaceCommandEnabled XTPWorkspaceCommand llId Returns Boolean
22650>>>>>>>>>        Handle hDispatchDriver
22650>>>>>>>>>        Boolean retVal
22650>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22651>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22652>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22653>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_BOOL to retVal
22654>>>>>>>>>        Function_Return retVal
22655>>>>>>>>>    End_Function
22656>>>>>>>>>
22656>>>>>>>>>    Function ComToolTipContext Returns Variant
22658>>>>>>>>>        Handle hDispatchDriver
22658>>>>>>>>>        Variant retVal
22658>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22659>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_DISPATCH to retVal
22660>>>>>>>>>        Function_Return retVal
22661>>>>>>>>>    End_Function
22662>>>>>>>>>
22662>>>>>>>>>    Function ComGroupCount Returns Integer
22664>>>>>>>>>        Handle hDispatchDriver
22664>>>>>>>>>        Integer retVal
22664>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22665>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_I4 to retVal
22666>>>>>>>>>        Function_Return retVal
22667>>>>>>>>>    End_Function
22668>>>>>>>>>
22668>>>>>>>>>    Function ComFindItem OLE_HANDLE llhWnd Returns Variant
22670>>>>>>>>>        Handle hDispatchDriver
22670>>>>>>>>>        Variant retVal
22670>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22671>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22672>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
22673>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 21 OLE_VT_DISPATCH to retVal
22674>>>>>>>>>        Function_Return retVal
22675>>>>>>>>>    End_Function
22676>>>>>>>>>
22676>>>>>>>>>    Function ComFindGroup Variant llpItem Returns Integer
22678>>>>>>>>>        Handle hDispatchDriver
22678>>>>>>>>>        Integer retVal
22678>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22679>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22680>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llpItem
22681>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 22 OLE_VT_I4 to retVal
22682>>>>>>>>>        Function_Return retVal
22683>>>>>>>>>    End_Function
22684>>>>>>>>>
22684>>>>>>>>>    Procedure ComCreateGroup Variant llItem Boolean llHoriz
22686>>>>>>>>>        Handle hDispatchDriver
22686>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22687>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22688>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llItem
22689>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llHoriz
22690>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
22691>>>>>>>>>    End_Procedure
22692>>>>>>>>>
22692>>>>>>>>>    Procedure ComMoveToGroup Variant llItem Integer llGroup
22694>>>>>>>>>        Handle hDispatchDriver
22694>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22695>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22696>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llItem
22697>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llGroup
22698>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 24 OLE_VT_VOID
22699>>>>>>>>>    End_Procedure
22700>>>>>>>>>
22700>>>>>>>>>    Function ComGroupSplitter Integer llGroup Returns Real
22702>>>>>>>>>        Handle hDispatchDriver
22702>>>>>>>>>        Real retVal
22702>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22703>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22704>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llGroup
22705>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 27 OLE_VT_R8 to retVal
22706>>>>>>>>>        Function_Return retVal
22707>>>>>>>>>    End_Function
22708>>>>>>>>>
22708>>>>>>>>>    Procedure Set ComGroupSplitter Integer llGroup Real value
22710>>>>>>>>>        Handle hDispatchDriver
22710>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22711>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22712>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llGroup
22713>>>>>>>>>        Set ComProperty of hDispatchDriver 27 OLE_VT_R8 to value
22714>>>>>>>>>    End_Procedure
22715>>>>>>>>>
22715>>>>>>>>>    Procedure ComShowNewWindowTab Boolean llShow Integer llCommand
22717>>>>>>>>>        Handle hDispatchDriver
22717>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22718>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22719>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llShow
22720>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
22721>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
22722>>>>>>>>>    End_Procedure
22723>>>>>>>>>
22723>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
22725>>>>>>>>>        Handle hDispatchDriver
22725>>>>>>>>>        OLE_HANDLE retVal
22725>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22726>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
22727>>>>>>>>>        Function_Return retVal
22728>>>>>>>>>    End_Function
22729>>>>>>>>>End_Class
22730>>>>>>>>>
22730>>>>>>>>>// CLSID: {180A7B16-7BE8-42EC-870C-8849F5540F14}
22730>>>>>>>>>Class cCJITabWorkspaceEvents is a Mixin
22731>>>>>>>>>
22731>>>>>>>>>    Procedure OnComRClick Variant llItem
22733>>>>>>>>>    End_Procedure
22734>>>>>>>>>
22734>>>>>>>>>    Procedure OnComNewItem Variant llItem
22736>>>>>>>>>    End_Procedure
22737>>>>>>>>>
22737>>>>>>>>>    Procedure OnComSelectedChanged Variant llItem
22739>>>>>>>>>    End_Procedure
22740>>>>>>>>>
22740>>>>>>>>>    Procedure OnComBeforeItemClick Variant llItem
22742>>>>>>>>>    End_Procedure
22743>>>>>>>>>
22743>>>>>>>>>    Procedure RegisterComEvents
22745>>>>>>>>>        Send RegisterComEvent 1 msg_OnComRClick
22746>>>>>>>>>        Send RegisterComEvent 2 msg_OnComNewItem
22747>>>>>>>>>        Send RegisterComEvent 3 msg_OnComSelectedChanged
22748>>>>>>>>>        Send RegisterComEvent 4 msg_OnComBeforeItemClick
22749>>>>>>>>>    End_Procedure
22750>>>>>>>>>End_Class
22751>>>>>>>>>
22751>>>>>>>>>// CoClass
22751>>>>>>>>>// CLSID: {505B92E7-C1B2-4583-B022-37367FE0CF90}
22751>>>>>>>>>Class cCJTabWorkspace is a cComAutomationObject
22752>>>>>>>>>    Import_Class_Protocol cCJITabWorkspace
22753>>>>>>>>>    Import_Class_Protocol cCJITabWorkspaceEvents
22754>>>>>>>>>
22754>>>>>>>>>    Procedure Construct_Object
22756>>>>>>>>>        Forward Send Construct_Object
22758>>>>>>>>>        Set psEventId to "{180A7B16-7BE8-42EC-870C-8849F5540F14}"
22759>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
22760>>>>>>>>>    End_Procedure
22761>>>>>>>>>End_Class
22762>>>>>>>>>
22762>>>>>>>>>// CLSID: {23745B78-7A0A-447D-9CDC-8F63E7E5AF55}
22762>>>>>>>>>// Dispatch interface for StatusBar Control
22762>>>>>>>>>Class cCJIStatusBar is a Mixin
22763>>>>>>>>>
22763>>>>>>>>>    Function ComVisible Returns Boolean
22765>>>>>>>>>        Boolean retVal
22765>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
22766>>>>>>>>>        Function_Return retVal
22767>>>>>>>>>    End_Function
22768>>>>>>>>>
22768>>>>>>>>>    Procedure Set ComVisible Boolean value
22770>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
22771>>>>>>>>>    End_Procedure
22772>>>>>>>>>
22772>>>>>>>>>    Function ComIdleText Returns String
22774>>>>>>>>>        String retVal
22774>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to retVal
22775>>>>>>>>>        Function_Return retVal
22776>>>>>>>>>    End_Function
22777>>>>>>>>>
22777>>>>>>>>>    Procedure Set ComIdleText String value
22779>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to value
22780>>>>>>>>>    End_Procedure
22781>>>>>>>>>
22781>>>>>>>>>    Function ComDrawDisabledText Returns Boolean
22783>>>>>>>>>        Boolean retVal
22783>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
22784>>>>>>>>>        Function_Return retVal
22785>>>>>>>>>    End_Function
22786>>>>>>>>>
22786>>>>>>>>>    Procedure Set ComDrawDisabledText Boolean value
22788>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
22789>>>>>>>>>    End_Procedure
22790>>>>>>>>>
22790>>>>>>>>>    Function ComMinHeight Returns Integer
22792>>>>>>>>>        Integer retVal
22792>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to retVal
22793>>>>>>>>>        Function_Return retVal
22794>>>>>>>>>    End_Function
22795>>>>>>>>>
22795>>>>>>>>>    Procedure Set ComMinHeight Integer value
22797>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_I4 to value
22798>>>>>>>>>    End_Procedure
22799>>>>>>>>>
22799>>>>>>>>>    Function ComFont Returns Variant
22801>>>>>>>>>        Variant retVal
22801>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
22802>>>>>>>>>        Function_Return retVal
22803>>>>>>>>>    End_Function
22804>>>>>>>>>
22804>>>>>>>>>    Procedure Set ComFont Variant value
22806>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
22807>>>>>>>>>    End_Procedure
22808>>>>>>>>>
22808>>>>>>>>>    Function ComShowSizeGripper Returns Boolean
22810>>>>>>>>>        Boolean retVal
22810>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BOOL to retVal
22811>>>>>>>>>        Function_Return retVal
22812>>>>>>>>>    End_Function
22813>>>>>>>>>
22813>>>>>>>>>    Procedure Set ComShowSizeGripper Boolean value
22815>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BOOL to value
22816>>>>>>>>>    End_Procedure
22817>>>>>>>>>
22817>>>>>>>>>    Function ComRibbonDividerIndex Returns Integer
22819>>>>>>>>>        Integer retVal
22819>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_I4 to retVal
22820>>>>>>>>>        Function_Return retVal
22821>>>>>>>>>    End_Function
22822>>>>>>>>>
22822>>>>>>>>>    Procedure Set ComRibbonDividerIndex Integer value
22824>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_I4 to value
22825>>>>>>>>>    End_Procedure
22826>>>>>>>>>
22826>>>>>>>>>    Function ComEnableMarkup Returns Boolean
22828>>>>>>>>>        Boolean retVal
22828>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
22829>>>>>>>>>        Function_Return retVal
22830>>>>>>>>>    End_Function
22831>>>>>>>>>
22831>>>>>>>>>    Procedure Set ComEnableMarkup Boolean value
22833>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
22834>>>>>>>>>    End_Procedure
22835>>>>>>>>>
22835>>>>>>>>>    Function ComIsAllCaps Returns Boolean
22837>>>>>>>>>        Boolean retVal
22837>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to retVal
22838>>>>>>>>>        Function_Return retVal
22839>>>>>>>>>    End_Function
22840>>>>>>>>>
22840>>>>>>>>>    Procedure Set ComIsAllCaps Boolean value
22842>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_BOOL to value
22843>>>>>>>>>    End_Procedure
22844>>>>>>>>>
22844>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
22846>>>>>>>>>        Handle hDispatchDriver
22846>>>>>>>>>        OLE_HANDLE retVal
22846>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22847>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
22848>>>>>>>>>        Function_Return retVal
22849>>>>>>>>>    End_Function
22850>>>>>>>>>
22850>>>>>>>>>    Function ComAddPane Integer llId Returns Variant
22852>>>>>>>>>        Handle hDispatchDriver
22852>>>>>>>>>        Variant retVal
22852>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22853>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22854>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22855>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
22856>>>>>>>>>        Function_Return retVal
22857>>>>>>>>>    End_Function
22858>>>>>>>>>
22858>>>>>>>>>    Procedure ComSetPaneText Integer llIndex String llText
22860>>>>>>>>>        Handle hDispatchDriver
22860>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22861>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22862>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22863>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llText
22864>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
22865>>>>>>>>>    End_Procedure
22866>>>>>>>>>
22866>>>>>>>>>    Procedure ComSetPaneWidth Integer llIndex Integer llWidth
22868>>>>>>>>>        Handle hDispatchDriver
22868>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22869>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22870>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22871>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llWidth
22872>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
22873>>>>>>>>>    End_Procedure
22874>>>>>>>>>
22874>>>>>>>>>    Procedure ComSetPaneStyle Integer llIndex XTPStatusPaneStyle llStyle
22876>>>>>>>>>        Handle hDispatchDriver
22876>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22877>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22878>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22879>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llStyle
22880>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
22881>>>>>>>>>    End_Procedure
22882>>>>>>>>>
22882>>>>>>>>>    Function ComPane Integer llIndex Returns Variant
22884>>>>>>>>>        Handle hDispatchDriver
22884>>>>>>>>>        Variant retVal
22884>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22885>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22886>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22887>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
22888>>>>>>>>>        Function_Return retVal
22889>>>>>>>>>    End_Function
22890>>>>>>>>>
22890>>>>>>>>>    Function Com_NewEnum Returns Variant
22892>>>>>>>>>        Handle hDispatchDriver
22892>>>>>>>>>        Variant retVal
22892>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22893>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
22894>>>>>>>>>        Function_Return retVal
22895>>>>>>>>>    End_Function
22896>>>>>>>>>
22896>>>>>>>>>    Procedure ComRemoveAll
22898>>>>>>>>>        Handle hDispatchDriver
22898>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22899>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
22900>>>>>>>>>    End_Procedure
22901>>>>>>>>>
22901>>>>>>>>>    Function ComPaneCount Returns Integer
22903>>>>>>>>>        Handle hDispatchDriver
22903>>>>>>>>>        Integer retVal
22903>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22904>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_I4 to retVal
22905>>>>>>>>>        Function_Return retVal
22906>>>>>>>>>    End_Function
22907>>>>>>>>>
22907>>>>>>>>>    Function ComInsertPane Integer llIndex Integer llId Returns Variant
22909>>>>>>>>>        Handle hDispatchDriver
22909>>>>>>>>>        Variant retVal
22909>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22910>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22911>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
22912>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22913>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_DISPATCH to retVal
22914>>>>>>>>>        Function_Return retVal
22915>>>>>>>>>    End_Function
22916>>>>>>>>>
22916>>>>>>>>>    Function ComFindPane Integer llId Returns Variant
22918>>>>>>>>>        Handle hDispatchDriver
22918>>>>>>>>>        Variant retVal
22918>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22919>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22920>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22921>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
22922>>>>>>>>>        Function_Return retVal
22923>>>>>>>>>    End_Function
22924>>>>>>>>>
22924>>>>>>>>>    Function ComHitTest Integer llx Integer lly Returns Variant
22926>>>>>>>>>        Handle hDispatchDriver
22926>>>>>>>>>        Variant retVal
22926>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22927>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
22928>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
22929>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
22930>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_DISPATCH to retVal
22931>>>>>>>>>        Function_Return retVal
22932>>>>>>>>>    End_Function
22933>>>>>>>>>
22933>>>>>>>>>    Function ComToolTipContext Returns Variant
22935>>>>>>>>>        Handle hDispatchDriver
22935>>>>>>>>>        Variant retVal
22935>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22936>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 15 OLE_VT_DISPATCH to retVal
22937>>>>>>>>>        Function_Return retVal
22938>>>>>>>>>    End_Function
22939>>>>>>>>>
22939>>>>>>>>>    Function ComAddSwitchPane Integer llId Returns Variant
22941>>>>>>>>>        Handle hDispatchDriver
22941>>>>>>>>>        Variant retVal
22941>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22942>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22943>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22944>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 17 OLE_VT_DISPATCH to retVal
22945>>>>>>>>>        Function_Return retVal
22946>>>>>>>>>    End_Function
22947>>>>>>>>>
22947>>>>>>>>>    Function ComAddSliderPane Integer llId Returns Variant
22949>>>>>>>>>        Handle hDispatchDriver
22949>>>>>>>>>        Variant retVal
22949>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22950>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22951>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22952>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 18 OLE_VT_DISPATCH to retVal
22953>>>>>>>>>        Function_Return retVal
22954>>>>>>>>>    End_Function
22955>>>>>>>>>
22955>>>>>>>>>    Function ComAddProgressPane Integer llId Returns Variant
22957>>>>>>>>>        Handle hDispatchDriver
22957>>>>>>>>>        Variant retVal
22957>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22958>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22959>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
22960>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 21 OLE_VT_DISPATCH to retVal
22961>>>>>>>>>        Function_Return retVal
22962>>>>>>>>>    End_Function
22963>>>>>>>>>
22963>>>>>>>>>    Procedure ComEnableCustomization Boolean llEnable
22965>>>>>>>>>        Handle hDispatchDriver
22965>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22966>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22967>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
22968>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 20 OLE_VT_VOID
22969>>>>>>>>>    End_Procedure
22970>>>>>>>>>
22970>>>>>>>>>    Procedure ComSetAllCaps Boolean llSetAllCaps
22972>>>>>>>>>        Handle hDispatchDriver
22972>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
22973>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
22974>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSetAllCaps
22975>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
22976>>>>>>>>>    End_Procedure
22977>>>>>>>>>End_Class
22978>>>>>>>>>
22978>>>>>>>>>// CLSID: {280A7B16-7BE8-42EC-870C-8849F5540F14}
22978>>>>>>>>>Class cCJIStatusBarEvents is a Mixin
22979>>>>>>>>>
22979>>>>>>>>>    Procedure OnComMouseDown Short llButton Short llShift Integer llx Integer lly
22981>>>>>>>>>    End_Procedure
22982>>>>>>>>>
22982>>>>>>>>>    Procedure OnComMouseUp Short llButton Short llShift Integer llx Integer lly
22984>>>>>>>>>    End_Procedure
22985>>>>>>>>>
22985>>>>>>>>>    Procedure OnComPaneDblClick Variant llPane
22987>>>>>>>>>    End_Procedure
22988>>>>>>>>>
22988>>>>>>>>>    Procedure OnComPaneClick Variant llPane
22990>>>>>>>>>    End_Procedure
22991>>>>>>>>>
22991>>>>>>>>>    Procedure OnComSwitchPaneClick Variant llPane Integer llSwitch
22993>>>>>>>>>    End_Procedure
22994>>>>>>>>>
22994>>>>>>>>>    Procedure OnComSliderPaneClick Variant llPane XTPSliderCommand llCommand Integer llPos
22996>>>>>>>>>    End_Procedure
22997>>>>>>>>>
22997>>>>>>>>>    Procedure RegisterComEvents
22999>>>>>>>>>        Send RegisterComEvent -605 msg_OnComMouseDown
23000>>>>>>>>>        Send RegisterComEvent -607 msg_OnComMouseUp
23001>>>>>>>>>        Send RegisterComEvent 1 msg_OnComPaneDblClick
23002>>>>>>>>>        Send RegisterComEvent 2 msg_OnComPaneClick
23003>>>>>>>>>        Send RegisterComEvent 3 msg_OnComSwitchPaneClick
23004>>>>>>>>>        Send RegisterComEvent 4 msg_OnComSliderPaneClick
23005>>>>>>>>>    End_Procedure
23006>>>>>>>>>End_Class
23007>>>>>>>>>
23007>>>>>>>>>// CoClass
23007>>>>>>>>>// CLSID: {4A554B68-0AC9-4997-B4D7-75B0F2E7E4BD}
23007>>>>>>>>>// Xtreme StatusBar Control
23007>>>>>>>>>Class cCJComStatusBar is a cComAutomationObject
23008>>>>>>>>>    Import_Class_Protocol cCJIStatusBar
23009>>>>>>>>>    Import_Class_Protocol cCJIStatusBarEvents
23010>>>>>>>>>
23010>>>>>>>>>    Procedure Construct_Object
23012>>>>>>>>>        Forward Send Construct_Object
23014>>>>>>>>>        Set psEventId to "{280A7B16-7BE8-42EC-870C-8849F5540F14}"
23015>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
23016>>>>>>>>>    End_Procedure
23017>>>>>>>>>End_Class
23018>>>>>>>>>
23018>>>>>>>>>// CLSID: {3E35E103-97D0-43D4-BEE8-9E2511D89F64}
23018>>>>>>>>>// Dispatch interface for CommandBars Control
23018>>>>>>>>>Class cCJ_DCommandBarsFrame is a Mixin
23019>>>>>>>>>
23019>>>>>>>>>    Function ComVisualTheme Returns XTPVisualTheme
23021>>>>>>>>>        XTPVisualTheme retVal
23021>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
23022>>>>>>>>>        Function_Return retVal
23023>>>>>>>>>    End_Function
23024>>>>>>>>>
23024>>>>>>>>>    Procedure Set ComVisualTheme XTPVisualTheme value
23026>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
23027>>>>>>>>>    End_Procedure
23028>>>>>>>>>
23028>>>>>>>>>    Function ComIcons Returns Variant
23030>>>>>>>>>        Variant retVal
23030>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
23031>>>>>>>>>        Function_Return retVal
23032>>>>>>>>>    End_Function
23033>>>>>>>>>
23033>>>>>>>>>    Procedure Set ComIcons Variant value
23035>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
23036>>>>>>>>>    End_Procedure
23037>>>>>>>>>
23037>>>>>>>>>    Function ComScaleMode Returns XTPScaleMode
23039>>>>>>>>>        XTPScaleMode retVal
23039>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
23040>>>>>>>>>        Function_Return retVal
23041>>>>>>>>>    End_Function
23042>>>>>>>>>
23042>>>>>>>>>    Procedure Set ComScaleMode XTPScaleMode value
23044>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
23045>>>>>>>>>    End_Procedure
23046>>>>>>>>>
23046>>>>>>>>>    Function ComRightToLeft Returns Boolean
23048>>>>>>>>>        Boolean retVal
23048>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_BOOL to retVal
23049>>>>>>>>>        Function_Return retVal
23050>>>>>>>>>    End_Function
23051>>>>>>>>>
23051>>>>>>>>>    Procedure Set ComRightToLeft Boolean value
23053>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 46 OLE_VT_BOOL to value
23054>>>>>>>>>    End_Procedure
23055>>>>>>>>>
23055>>>>>>>>>    Function ComReCreateReparented Returns Boolean
23057>>>>>>>>>        Boolean retVal
23057>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
23058>>>>>>>>>        Function_Return retVal
23059>>>>>>>>>    End_Function
23060>>>>>>>>>
23060>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
23062>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
23063>>>>>>>>>    End_Procedure
23064>>>>>>>>>
23064>>>>>>>>>    Function ComCount Returns Integer
23066>>>>>>>>>        Handle hDispatchDriver
23066>>>>>>>>>        Integer retVal
23066>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23067>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_I4 to retVal
23068>>>>>>>>>        Function_Return retVal
23069>>>>>>>>>    End_Function
23070>>>>>>>>>
23070>>>>>>>>>    // Returns a specific item.
23070>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
23072>>>>>>>>>        Handle hDispatchDriver
23072>>>>>>>>>        Variant retVal
23072>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23073>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23074>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
23075>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
23076>>>>>>>>>        Function_Return retVal
23077>>>>>>>>>    End_Function
23078>>>>>>>>>
23078>>>>>>>>>    Function Com_NewEnum Returns Variant
23080>>>>>>>>>        Handle hDispatchDriver
23080>>>>>>>>>        Variant retVal
23080>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23081>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
23082>>>>>>>>>        Function_Return retVal
23083>>>>>>>>>    End_Function
23084>>>>>>>>>
23084>>>>>>>>>    Function ComAdd String llName XTPBarPosition llPosition Returns Variant
23086>>>>>>>>>        Handle hDispatchDriver
23086>>>>>>>>>        Variant retVal
23086>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23087>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23088>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23089>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
23090>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
23091>>>>>>>>>        Function_Return retVal
23092>>>>>>>>>    End_Function
23093>>>>>>>>>
23093>>>>>>>>>    Procedure ComAddImageList Variant llImageList
23095>>>>>>>>>        Handle hDispatchDriver
23095>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23096>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23097>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llImageList
23098>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
23099>>>>>>>>>    End_Procedure
23100>>>>>>>>>
23100>>>>>>>>>    Function ComActiveMenuBar Returns Variant
23102>>>>>>>>>        Handle hDispatchDriver
23102>>>>>>>>>        Variant retVal
23102>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23103>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_DISPATCH to retVal
23104>>>>>>>>>        Function_Return retVal
23105>>>>>>>>>    End_Function
23106>>>>>>>>>
23106>>>>>>>>>    Procedure ComGetClientRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
23108>>>>>>>>>        Handle hDispatchDriver
23108>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23109>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
23110>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
23111>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
23112>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
23113>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
23114>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
23115>>>>>>>>>    End_Procedure
23116>>>>>>>>>
23116>>>>>>>>>    Procedure ComRecalcLayout
23118>>>>>>>>>        Handle hDispatchDriver
23118>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23119>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
23120>>>>>>>>>    End_Procedure
23121>>>>>>>>>
23121>>>>>>>>>    Function ComKeyBindings Returns Variant
23123>>>>>>>>>        Handle hDispatchDriver
23123>>>>>>>>>        Variant retVal
23123>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23124>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_DISPATCH to retVal
23125>>>>>>>>>        Function_Return retVal
23126>>>>>>>>>    End_Function
23127>>>>>>>>>
23127>>>>>>>>>    Procedure ComAddIconHandle Integer llIcon Integer llCommand Integer llimageState Boolean llAlpha
23129>>>>>>>>>        Handle hDispatchDriver
23129>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23130>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
23131>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIcon
23132>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
23133>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llimageState
23134>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llAlpha
23135>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
23136>>>>>>>>>    End_Procedure
23137>>>>>>>>>
23137>>>>>>>>>    Function ComOptions Returns Variant
23139>>>>>>>>>        Handle hDispatchDriver
23139>>>>>>>>>        Variant retVal
23139>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23140>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
23141>>>>>>>>>        Function_Return retVal
23142>>>>>>>>>    End_Function
23143>>>>>>>>>
23143>>>>>>>>>    Procedure ComSaveCommandBars Variant llRegistryKey Variant llAppName Variant llSection
23145>>>>>>>>>        Handle hDispatchDriver
23145>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23146>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
23147>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRegistryKey
23148>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llAppName
23149>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llSection
23150>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
23151>>>>>>>>>    End_Procedure
23152>>>>>>>>>
23152>>>>>>>>>    Procedure ComLoadCommandBars Variant llRegistryKey Variant llAppName Variant llSection
23154>>>>>>>>>        Handle hDispatchDriver
23154>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23155>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
23156>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRegistryKey
23157>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llAppName
23158>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llSection
23159>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
23160>>>>>>>>>    End_Procedure
23161>>>>>>>>>
23161>>>>>>>>>    Procedure ComLoadDesignerBars Variant llFileNameOrResource Variant llInstance
23163>>>>>>>>>        Handle hDispatchDriver
23163>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23164>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23165>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFileNameOrResource
23166>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llInstance
23167>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
23168>>>>>>>>>    End_Procedure
23169>>>>>>>>>
23169>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
23171>>>>>>>>>        Handle hDispatchDriver
23171>>>>>>>>>        Variant retVal
23171>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23172>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
23173>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
23174>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
23175>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
23176>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
23177>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
23178>>>>>>>>>        Function_Return retVal
23179>>>>>>>>>    End_Function
23180>>>>>>>>>
23180>>>>>>>>>    Procedure ComAboutBox
23182>>>>>>>>>        Handle hDispatchDriver
23182>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23183>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
23184>>>>>>>>>    End_Procedure
23185>>>>>>>>>
23185>>>>>>>>>    Procedure ComDockToolBar Variant llToolBar Integer llx Integer lly XTPBarPosition llPosition
23187>>>>>>>>>        Handle hDispatchDriver
23187>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23188>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
23189>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llToolBar
23190>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
23191>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
23192>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
23193>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
23194>>>>>>>>>    End_Procedure
23195>>>>>>>>>
23195>>>>>>>>>    Function ComGetSpecialColor XTPColorManagerColor llIndex Returns OLE_COLOR
23197>>>>>>>>>        Handle hDispatchDriver
23197>>>>>>>>>        OLE_COLOR retVal
23197>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23198>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23199>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
23200>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 19 OLE_VT_I4 to retVal
23201>>>>>>>>>        Function_Return retVal
23202>>>>>>>>>    End_Function
23203>>>>>>>>>
23203>>>>>>>>>    Function ComShowTabWorkspace Boolean llShow Returns Variant
23205>>>>>>>>>        Handle hDispatchDriver
23205>>>>>>>>>        Variant retVal
23205>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23206>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23207>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llShow
23208>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
23209>>>>>>>>>        Function_Return retVal
23210>>>>>>>>>    End_Function
23211>>>>>>>>>
23211>>>>>>>>>    Procedure ComMoveAlignedControl Variant llControl Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
23213>>>>>>>>>        Handle hDispatchDriver
23213>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23214>>>>>>>>>        Send PrepareParams to hDispatchDriver 5
23215>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llControl
23216>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
23217>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
23218>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
23219>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
23220>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
23221>>>>>>>>>    End_Procedure
23222>>>>>>>>>
23222>>>>>>>>>    Function ComTabWorkspace Returns Variant
23224>>>>>>>>>        Handle hDispatchDriver
23224>>>>>>>>>        Variant retVal
23224>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23225>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 22 OLE_VT_DISPATCH to retVal
23226>>>>>>>>>        Function_Return retVal
23227>>>>>>>>>    End_Function
23228>>>>>>>>>
23228>>>>>>>>>    Procedure ComLoadStateFromString String llProfile Boolean llRestoreControls Boolean llRestoreOptions Boolean llSilent
23230>>>>>>>>>        Handle hDispatchDriver
23230>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23231>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
23232>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
23233>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRestoreControls
23234>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRestoreOptions
23235>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSilent
23236>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
23237>>>>>>>>>    End_Procedure
23238>>>>>>>>>
23238>>>>>>>>>    Function ComSaveStateToString Boolean llSaveControls Boolean llSaveOnlyCustomized Boolean llSaveOptions Returns String
23240>>>>>>>>>        Handle hDispatchDriver
23240>>>>>>>>>        String retVal
23240>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23241>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
23242>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveControls
23243>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveOnlyCustomized
23244>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llSaveOptions
23245>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 24 OLE_VT_BSTR to retVal
23246>>>>>>>>>        Function_Return retVal
23247>>>>>>>>>    End_Function
23248>>>>>>>>>
23248>>>>>>>>>    Function ComStatusBar Returns Variant
23250>>>>>>>>>        Handle hDispatchDriver
23250>>>>>>>>>        Variant retVal
23250>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23251>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 25 OLE_VT_DISPATCH to retVal
23252>>>>>>>>>        Function_Return retVal
23253>>>>>>>>>    End_Function
23254>>>>>>>>>
23254>>>>>>>>>    Function ComMessageBar Returns Variant
23256>>>>>>>>>        Handle hDispatchDriver
23256>>>>>>>>>        Variant retVal
23256>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23257>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 28 OLE_VT_DISPATCH to retVal
23258>>>>>>>>>        Function_Return retVal
23259>>>>>>>>>    End_Function
23260>>>>>>>>>
23260>>>>>>>>>    Procedure ComEnableCustomization Boolean llEnable
23262>>>>>>>>>        Handle hDispatchDriver
23262>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23263>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23264>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
23265>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 26 OLE_VT_VOID
23266>>>>>>>>>    End_Procedure
23267>>>>>>>>>
23267>>>>>>>>>    Function ComDesignerControls Returns Variant
23269>>>>>>>>>        Handle hDispatchDriver
23269>>>>>>>>>        Variant retVal
23269>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23270>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 27 OLE_VT_DISPATCH to retVal
23271>>>>>>>>>        Function_Return retVal
23272>>>>>>>>>    End_Function
23273>>>>>>>>>
23273>>>>>>>>>    Function ComGetDispatch Returns Variant
23275>>>>>>>>>        Handle hDispatchDriver
23275>>>>>>>>>        Variant retVal
23275>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23276>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 31 OLE_VT_DISPATCH to retVal
23277>>>>>>>>>        Function_Return retVal
23278>>>>>>>>>    End_Function
23279>>>>>>>>>
23279>>>>>>>>>    Procedure ComSetMDIClient OLE_HANDLE llhWnd
23281>>>>>>>>>        Handle hDispatchDriver
23281>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23282>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23283>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
23284>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
23285>>>>>>>>>    End_Procedure
23286>>>>>>>>>
23286>>>>>>>>>    Function ComGlobalSettings Returns Variant
23288>>>>>>>>>        Handle hDispatchDriver
23288>>>>>>>>>        Variant retVal
23288>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23289>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_DISPATCH to retVal
23290>>>>>>>>>        Function_Return retVal
23291>>>>>>>>>    End_Function
23292>>>>>>>>>
23292>>>>>>>>>    Procedure ComClosePopups
23294>>>>>>>>>        Handle hDispatchDriver
23294>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23295>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 34 OLE_VT_VOID
23296>>>>>>>>>    End_Procedure
23297>>>>>>>>>
23297>>>>>>>>>    Procedure ComSetSpecialColor XTPColorManagerColor llIndex OLE_COLOR llColor
23299>>>>>>>>>        Handle hDispatchDriver
23299>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23300>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23301>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
23302>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llColor
23303>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
23304>>>>>>>>>    End_Procedure
23305>>>>>>>>>
23305>>>>>>>>>    Function ComAddDialogBar String llName XTPBarPosition llPosition Returns Variant
23307>>>>>>>>>        Handle hDispatchDriver
23307>>>>>>>>>        Variant retVal
23307>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23308>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23309>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23310>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
23311>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 36 OLE_VT_DISPATCH to retVal
23312>>>>>>>>>        Function_Return retVal
23313>>>>>>>>>    End_Function
23314>>>>>>>>>
23314>>>>>>>>>    Procedure ComLoadStateFromXMLString String llProfile String llstate Variant llOptions
23316>>>>>>>>>        Handle hDispatchDriver
23316>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23317>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
23318>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
23319>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstate
23320>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
23321>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
23322>>>>>>>>>    End_Procedure
23323>>>>>>>>>
23323>>>>>>>>>    Function ComSaveStateToXMLString String llProfile Variant llOptions Returns String
23325>>>>>>>>>        Handle hDispatchDriver
23325>>>>>>>>>        String retVal
23325>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23326>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23327>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProfile
23328>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
23329>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 38 OLE_VT_BSTR to retVal
23330>>>>>>>>>        Function_Return retVal
23331>>>>>>>>>    End_Function
23332>>>>>>>>>
23332>>>>>>>>>    Function ComCreateStateOptions Returns Variant
23334>>>>>>>>>        Handle hDispatchDriver
23334>>>>>>>>>        Variant retVal
23334>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23335>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 39 OLE_VT_DISPATCH to retVal
23336>>>>>>>>>        Function_Return retVal
23337>>>>>>>>>    End_Function
23338>>>>>>>>>
23338>>>>>>>>>    Procedure ComDoPropExchange Variant llpPX Variant llOptions
23340>>>>>>>>>        Handle hDispatchDriver
23340>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23341>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
23342>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llpPX
23343>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llOptions
23344>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 45 OLE_VT_VOID
23345>>>>>>>>>    End_Procedure
23346>>>>>>>>>
23346>>>>>>>>>    Function ComCustomizedControl Returns Variant
23348>>>>>>>>>        Handle hDispatchDriver
23348>>>>>>>>>        Variant retVal
23348>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23349>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 40 OLE_VT_DISPATCH to retVal
23350>>>>>>>>>        Function_Return retVal
23351>>>>>>>>>    End_Function
23352>>>>>>>>>
23352>>>>>>>>>    // Deletes all of the toolbars
23352>>>>>>>>>    Procedure ComDeleteAll
23354>>>>>>>>>        Handle hDispatchDriver
23354>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23355>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 41 OLE_VT_VOID
23356>>>>>>>>>    End_Procedure
23357>>>>>>>>>
23357>>>>>>>>>    Function ComToolTipContext Returns Variant
23359>>>>>>>>>        Handle hDispatchDriver
23359>>>>>>>>>        Variant retVal
23359>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23360>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 42 OLE_VT_DISPATCH to retVal
23361>>>>>>>>>        Function_Return retVal
23362>>>>>>>>>    End_Function
23363>>>>>>>>>
23363>>>>>>>>>    Function ComTrackingMode Returns Boolean
23365>>>>>>>>>        Handle hDispatchDriver
23365>>>>>>>>>        Boolean retVal
23365>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23366>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 43 OLE_VT_BOOL to retVal
23367>>>>>>>>>        Function_Return retVal
23368>>>>>>>>>    End_Function
23369>>>>>>>>>
23369>>>>>>>>>    Function ComFocusedCommandBar Returns Variant
23371>>>>>>>>>        Handle hDispatchDriver
23371>>>>>>>>>        Variant retVal
23371>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23372>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 44 OLE_VT_DISPATCH to retVal
23373>>>>>>>>>        Function_Return retVal
23374>>>>>>>>>    End_Function
23375>>>>>>>>>
23375>>>>>>>>>    Function ComAddMenuBar String llName Returns Variant
23377>>>>>>>>>        Handle hDispatchDriver
23377>>>>>>>>>        Variant retVal
23377>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23378>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23379>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23380>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 47 OLE_VT_DISPATCH to retVal
23381>>>>>>>>>        Function_Return retVal
23382>>>>>>>>>    End_Function
23383>>>>>>>>>
23383>>>>>>>>>    Function ComAddTabToolBar String llName Returns Variant
23385>>>>>>>>>        Handle hDispatchDriver
23385>>>>>>>>>        Variant retVal
23385>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23386>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23387>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23388>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 48 OLE_VT_DISPATCH to retVal
23389>>>>>>>>>        Function_Return retVal
23390>>>>>>>>>    End_Function
23391>>>>>>>>>
23391>>>>>>>>>    Function ComAddRibbonBar String llName Returns Variant
23393>>>>>>>>>        Handle hDispatchDriver
23393>>>>>>>>>        Variant retVal
23393>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23394>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23395>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23396>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 49 OLE_VT_DISPATCH to retVal
23397>>>>>>>>>        Function_Return retVal
23398>>>>>>>>>    End_Function
23399>>>>>>>>>
23399>>>>>>>>>    Procedure ComAttachToWindow OLE_HANDLE llhWnd
23401>>>>>>>>>        Handle hDispatchDriver
23401>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23402>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23403>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
23404>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 50 OLE_VT_VOID
23405>>>>>>>>>    End_Procedure
23406>>>>>>>>>
23406>>>>>>>>>    Procedure ComShowCustomizeDialog Integer llActiveTab
23408>>>>>>>>>        Handle hDispatchDriver
23408>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23409>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23410>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llActiveTab
23411>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 51 OLE_VT_VOID
23412>>>>>>>>>    End_Procedure
23413>>>>>>>>>
23413>>>>>>>>>    Procedure ComEnableOffice2007Frame Boolean llEnable
23415>>>>>>>>>        Handle hDispatchDriver
23415>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23416>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23417>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
23418>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 52 OLE_VT_VOID
23419>>>>>>>>>    End_Procedure
23420>>>>>>>>>
23420>>>>>>>>>    Procedure ComEnableActions
23422>>>>>>>>>        Handle hDispatchDriver
23422>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23423>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 53 OLE_VT_VOID
23424>>>>>>>>>    End_Procedure
23425>>>>>>>>>
23425>>>>>>>>>    Function ComActions Returns Variant
23427>>>>>>>>>        Handle hDispatchDriver
23427>>>>>>>>>        Variant retVal
23427>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23428>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 54 OLE_VT_DISPATCH to retVal
23429>>>>>>>>>        Function_Return retVal
23430>>>>>>>>>    End_Function
23431>>>>>>>>>
23431>>>>>>>>>    Function ComPaintManager Returns Variant
23433>>>>>>>>>        Handle hDispatchDriver
23433>>>>>>>>>        Variant retVal
23433>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23434>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 55 OLE_VT_DISPATCH to retVal
23435>>>>>>>>>        Function_Return retVal
23436>>>>>>>>>    End_Function
23437>>>>>>>>>
23437>>>>>>>>>    Function ComCreateGalleryItems Integer llId Returns Variant
23439>>>>>>>>>        Handle hDispatchDriver
23439>>>>>>>>>        Variant retVal
23439>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23440>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23441>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
23442>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 56 OLE_VT_DISPATCH to retVal
23443>>>>>>>>>        Function_Return retVal
23444>>>>>>>>>    End_Function
23445>>>>>>>>>
23445>>>>>>>>>    Procedure ComEnableOffice2007FrameHandle OLE_HANDLE llhWnd
23447>>>>>>>>>        Handle hDispatchDriver
23447>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23448>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23449>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
23450>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 57 OLE_VT_VOID
23451>>>>>>>>>    End_Procedure
23452>>>>>>>>>
23452>>>>>>>>>    Procedure ComDisableOffice2007FrameHandle OLE_HANDLE llhWnd
23454>>>>>>>>>        Handle hDispatchDriver
23454>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23455>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23456>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
23457>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 65 OLE_VT_VOID
23458>>>>>>>>>    End_Procedure
23459>>>>>>>>>
23459>>>>>>>>>    Function ComCreateCommandBarControl String llClassName Returns Variant
23461>>>>>>>>>        Handle hDispatchDriver
23461>>>>>>>>>        Variant retVal
23461>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23462>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23463>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
23464>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 58 OLE_VT_DISPATCH to retVal
23465>>>>>>>>>        Function_Return retVal
23466>>>>>>>>>    End_Function
23467>>>>>>>>>
23467>>>>>>>>>    Function ComCreateCommandBar String llClassName Returns Variant
23469>>>>>>>>>        Handle hDispatchDriver
23469>>>>>>>>>        Variant retVal
23469>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23470>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23471>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
23472>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 59 OLE_VT_DISPATCH to retVal
23473>>>>>>>>>        Function_Return retVal
23474>>>>>>>>>    End_Function
23475>>>>>>>>>
23475>>>>>>>>>    Function ComContextHelp Returns Integer
23477>>>>>>>>>        Handle hDispatchDriver
23477>>>>>>>>>        Integer retVal
23477>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23478>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 60 OLE_VT_I4 to retVal
23479>>>>>>>>>        Function_Return retVal
23480>>>>>>>>>    End_Function
23481>>>>>>>>>
23481>>>>>>>>>    Function ComContextMenus Returns Variant
23483>>>>>>>>>        Handle hDispatchDriver
23483>>>>>>>>>        Variant retVal
23483>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23484>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 61 OLE_VT_DISPATCH to retVal
23485>>>>>>>>>        Function_Return retVal
23486>>>>>>>>>    End_Function
23487>>>>>>>>>
23487>>>>>>>>>    Procedure ComOLEDrag
23489>>>>>>>>>        Handle hDispatchDriver
23489>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23490>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 62 OLE_VT_VOID
23491>>>>>>>>>    End_Procedure
23492>>>>>>>>>
23492>>>>>>>>>    Function ComAddMiniToolBar String llName Returns Variant
23494>>>>>>>>>        Handle hDispatchDriver
23494>>>>>>>>>        Variant retVal
23494>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23495>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23496>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23497>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 63 OLE_VT_DISPATCH to retVal
23498>>>>>>>>>        Function_Return retVal
23499>>>>>>>>>    End_Function
23500>>>>>>>>>
23500>>>>>>>>>    Function ComRecentFileList Returns Variant
23502>>>>>>>>>        Handle hDispatchDriver
23502>>>>>>>>>        Variant retVal
23502>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23503>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 64 OLE_VT_DISPATCH to retVal
23504>>>>>>>>>        Function_Return retVal
23505>>>>>>>>>    End_Function
23506>>>>>>>>>
23506>>>>>>>>>    Procedure ComAddCustomBar Variant llCommandBar String llName XTPBarPosition llPosition
23508>>>>>>>>>        Handle hDispatchDriver
23508>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23509>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
23510>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llCommandBar
23511>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llName
23512>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llPosition
23513>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 66 OLE_VT_VOID
23514>>>>>>>>>    End_Procedure
23515>>>>>>>>>End_Class
23516>>>>>>>>>
23516>>>>>>>>>// CLSID: {BEBCFF31-D2EF-4119-BBBB-8314B5794E11}
23516>>>>>>>>>// Event interface for CommandBars Control
23516>>>>>>>>>Class cCJ_DCommandBarsFrameEvents is a Mixin
23517>>>>>>>>>
23517>>>>>>>>>    Procedure OnComExecute Variant llControl
23519>>>>>>>>>    End_Procedure
23520>>>>>>>>>
23520>>>>>>>>>    Procedure OnComUpdate Variant llControl
23522>>>>>>>>>    End_Procedure
23523>>>>>>>>>
23523>>>>>>>>>    Procedure OnComResize
23525>>>>>>>>>    End_Procedure
23526>>>>>>>>>
23526>>>>>>>>>    Procedure OnComGetClientBordersWidth Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
23528>>>>>>>>>    End_Procedure
23529>>>>>>>>>
23529>>>>>>>>>    Procedure OnComControlSelected Variant llControl
23531>>>>>>>>>    End_Procedure
23532>>>>>>>>>
23532>>>>>>>>>    Procedure OnComInitCommandsPopup Variant llCommandBar
23534>>>>>>>>>    End_Procedure
23535>>>>>>>>>
23535>>>>>>>>>    Procedure OnComResizeClient Integer llLeft Integer llTop Integer llRight Integer llBottom
23537>>>>>>>>>    End_Procedure
23538>>>>>>>>>
23538>>>>>>>>>    Procedure OnComSpecialColorChanged
23540>>>>>>>>>    End_Procedure
23541>>>>>>>>>
23541>>>>>>>>>    Procedure OnComRepositionAlignedControls Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
23543>>>>>>>>>    End_Procedure
23544>>>>>>>>>
23544>>>>>>>>>    Procedure OnComCustomization Variant llOptions
23546>>>>>>>>>    End_Procedure
23547>>>>>>>>>
23547>>>>>>>>>    Procedure OnComToolBarVisibleChanged Variant llToolBar
23549>>>>>>>>>    End_Procedure
23550>>>>>>>>>
23550>>>>>>>>>    Procedure OnComControlRButtonUp Variant llControl
23552>>>>>>>>>    End_Procedure
23553>>>>>>>>>
23553>>>>>>>>>    Procedure OnComCustomizationDone
23555>>>>>>>>>    End_Procedure
23556>>>>>>>>>
23556>>>>>>>>>    Procedure OnComCommandBarKeyDown Variant llCommandBar Integer ByRef llKeyCode Short llShift
23558>>>>>>>>>    End_Procedure
23559>>>>>>>>>
23559>>>>>>>>>    Procedure OnComToolBarContextMenu Variant llToolBar Variant llContextMenu
23561>>>>>>>>>    End_Procedure
23562>>>>>>>>>
23562>>>>>>>>>    Procedure OnComTrackingModeChanged Variant llCommandBar Boolean llMode
23564>>>>>>>>>    End_Procedure
23565>>>>>>>>>
23565>>>>>>>>>    Procedure OnComCustomizationResetToolBar Variant llToolBar
23567>>>>>>>>>    End_Procedure
23568>>>>>>>>>
23568>>>>>>>>>    Procedure OnComCustomizationAddToolBar Variant llToolBar
23570>>>>>>>>>    End_Procedure
23571>>>>>>>>>
23571>>>>>>>>>    Procedure OnComCustomizationDeleteToolBar Variant llToolBar
23573>>>>>>>>>    End_Procedure
23574>>>>>>>>>
23574>>>>>>>>>    Procedure OnComControlNotify Variant llControl Integer llCode Variant llNotifyData Variant llHandled
23576>>>>>>>>>    End_Procedure
23577>>>>>>>>>
23577>>>>>>>>>    Procedure OnComGetActiveDocumentID Integer ByRef llId
23579>>>>>>>>>    End_Procedure
23580>>>>>>>>>
23580>>>>>>>>>    Procedure OnComCustomizationResetAll
23582>>>>>>>>>    End_Procedure
23583>>>>>>>>>
23583>>>>>>>>>    Procedure OnComOLEStartDrag Variant llData Integer ByRef llAllowedEffects
23585>>>>>>>>>    End_Procedure
23586>>>>>>>>>
23586>>>>>>>>>    Procedure OnComOLECompleteDrag Integer ByRef llEffect
23588>>>>>>>>>    End_Procedure
23589>>>>>>>>>
23589>>>>>>>>>    Procedure OnComReCreated
23591>>>>>>>>>    End_Procedure
23592>>>>>>>>>
23592>>>>>>>>>    Procedure RegisterComEvents
23594>>>>>>>>>        Send RegisterComEvent 1 msg_OnComExecute
23595>>>>>>>>>        Send RegisterComEvent 2 msg_OnComUpdate
23596>>>>>>>>>        Send RegisterComEvent 3 msg_OnComResize
23597>>>>>>>>>        Send RegisterComEvent 4 msg_OnComGetClientBordersWidth
23598>>>>>>>>>        Send RegisterComEvent 5 msg_OnComControlSelected
23599>>>>>>>>>        Send RegisterComEvent 6 msg_OnComInitCommandsPopup
23600>>>>>>>>>        Send RegisterComEvent 7 msg_OnComResizeClient
23601>>>>>>>>>        Send RegisterComEvent 8 msg_OnComSpecialColorChanged
23602>>>>>>>>>        Send RegisterComEvent 9 msg_OnComRepositionAlignedControls
23603>>>>>>>>>        Send RegisterComEvent 10 msg_OnComCustomization
23604>>>>>>>>>        Send RegisterComEvent 11 msg_OnComToolBarVisibleChanged
23605>>>>>>>>>        Send RegisterComEvent 12 msg_OnComControlRButtonUp
23606>>>>>>>>>        Send RegisterComEvent 13 msg_OnComCustomizationDone
23607>>>>>>>>>        Send RegisterComEvent -602 msg_OnComCommandBarKeyDown
23608>>>>>>>>>        Send RegisterComEvent 14 msg_OnComToolBarContextMenu
23609>>>>>>>>>        Send RegisterComEvent 15 msg_OnComTrackingModeChanged
23610>>>>>>>>>        Send RegisterComEvent 16 msg_OnComCustomizationResetToolBar
23611>>>>>>>>>        Send RegisterComEvent 17 msg_OnComCustomizationAddToolBar
23612>>>>>>>>>        Send RegisterComEvent 18 msg_OnComCustomizationDeleteToolBar
23613>>>>>>>>>        Send RegisterComEvent 19 msg_OnComControlNotify
23614>>>>>>>>>        Send RegisterComEvent 20 msg_OnComGetActiveDocumentID
23615>>>>>>>>>        Send RegisterComEvent 21 msg_OnComCustomizationResetAll
23616>>>>>>>>>        Send RegisterComEvent 303 msg_OnComOLEStartDrag
23617>>>>>>>>>        Send RegisterComEvent 304 msg_OnComOLECompleteDrag
23618>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
23619>>>>>>>>>    End_Procedure
23620>>>>>>>>>End_Class
23621>>>>>>>>>
23621>>>>>>>>>// CoClass
23621>>>>>>>>>// ProgID: Codejock.CommandBarsFrame.17.3.0
23621>>>>>>>>>// CLSID: {0AB91F7B-870E-4D83-8D3E-A1A1B7EFADD1}
23621>>>>>>>>>// Xtreme CommandBars Frame Control
23621>>>>>>>>>Class cCJCommandBarsFrame is a cComActiveXControl
23622>>>>>>>>>    Import_Class_Protocol cCJ_DCommandBarsFrame
23623>>>>>>>>>    Import_Class_Protocol cCJ_DCommandBarsFrameEvents
23624>>>>>>>>>
23624>>>>>>>>>    Procedure Construct_Object
23626>>>>>>>>>        Forward Send Construct_Object
23628>>>>>>>>>        Set psProgID to "{0AB91F7B-870E-4D83-8D3E-A1A1B7EFADD1}"
23629>>>>>>>>>        Set psEventId to "{BEBCFF31-D2EF-4119-BBBB-8314B5794E11}"
23630>>>>>>>>>        Set psLicenseKey to ("CommandBars Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.CommandBars.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: QQS-PNF-OJV-VBX")
23631>>>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
23632>>>>>>>>>    End_Procedure
23633>>>>>>>>>End_Class
23634>>>>>>>>>
23634>>>>>>>>>// CLSID: {25156D92-3B80-4CED-A441-19E468F8D087}
23634>>>>>>>>>// Dispatch interface for PrintPreview Control
23634>>>>>>>>>Class cCJ_DPrintPreview is a Mixin
23635>>>>>>>>>
23635>>>>>>>>>    Function ComPrintView Returns Variant
23637>>>>>>>>>        Variant retVal
23637>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_UNKNOWN to retVal
23638>>>>>>>>>        Function_Return retVal
23639>>>>>>>>>    End_Function
23640>>>>>>>>>
23640>>>>>>>>>    Procedure Set ComPrintView Variant value
23642>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_UNKNOWN to value
23643>>>>>>>>>    End_Procedure
23644>>>>>>>>>
23644>>>>>>>>>    Function ComTitle Returns String
23646>>>>>>>>>        String retVal
23646>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
23647>>>>>>>>>        Function_Return retVal
23648>>>>>>>>>    End_Function
23649>>>>>>>>>
23649>>>>>>>>>    Procedure Set ComTitle String value
23651>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
23652>>>>>>>>>    End_Procedure
23653>>>>>>>>>
23653>>>>>>>>>    Function ComVisualTheme Returns XTPVisualTheme
23655>>>>>>>>>        XTPVisualTheme retVal
23655>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
23656>>>>>>>>>        Function_Return retVal
23657>>>>>>>>>    End_Function
23658>>>>>>>>>
23658>>>>>>>>>    Procedure Set ComVisualTheme XTPVisualTheme value
23660>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
23661>>>>>>>>>    End_Procedure
23662>>>>>>>>>
23662>>>>>>>>>    Function ComZoomState Returns Integer
23664>>>>>>>>>        Integer retVal
23664>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to retVal
23665>>>>>>>>>        Function_Return retVal
23666>>>>>>>>>    End_Function
23667>>>>>>>>>
23667>>>>>>>>>    Procedure Set ComZoomState Integer value
23669>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_I4 to value
23670>>>>>>>>>    End_Procedure
23671>>>>>>>>>
23671>>>>>>>>>    Function ComToolBarVisible Returns Boolean
23673>>>>>>>>>        Boolean retVal
23673>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
23674>>>>>>>>>        Function_Return retVal
23675>>>>>>>>>    End_Function
23676>>>>>>>>>
23676>>>>>>>>>    Procedure Set ComToolBarVisible Boolean value
23678>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
23679>>>>>>>>>    End_Procedure
23680>>>>>>>>>
23680>>>>>>>>>    Function ComOrientation Returns XTPPrintOrientation
23682>>>>>>>>>        XTPPrintOrientation retVal
23682>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
23683>>>>>>>>>        Function_Return retVal
23684>>>>>>>>>    End_Function
23685>>>>>>>>>
23685>>>>>>>>>    Procedure Set ComOrientation XTPPrintOrientation value
23687>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
23688>>>>>>>>>    End_Procedure
23689>>>>>>>>>
23689>>>>>>>>>    Function ComBackColor Returns OLE_COLOR
23691>>>>>>>>>        OLE_COLOR retVal
23691>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to retVal
23692>>>>>>>>>        Function_Return retVal
23693>>>>>>>>>    End_Function
23694>>>>>>>>>
23694>>>>>>>>>    Procedure Set ComBackColor OLE_COLOR value
23696>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to value
23697>>>>>>>>>    End_Procedure
23698>>>>>>>>>
23698>>>>>>>>>    Function ComShowBorder Returns Boolean
23700>>>>>>>>>        Boolean retVal
23700>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
23701>>>>>>>>>        Function_Return retVal
23702>>>>>>>>>    End_Function
23703>>>>>>>>>
23703>>>>>>>>>    Procedure Set ComShowBorder Boolean value
23705>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
23706>>>>>>>>>    End_Procedure
23707>>>>>>>>>
23707>>>>>>>>>    Function ComReCreateReparented Returns Boolean
23709>>>>>>>>>        Boolean retVal
23709>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
23710>>>>>>>>>        Function_Return retVal
23711>>>>>>>>>    End_Function
23712>>>>>>>>>
23712>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
23714>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
23715>>>>>>>>>    End_Procedure
23716>>>>>>>>>
23716>>>>>>>>>    Function ComCreateMarkupPrintView String llMarkupText Returns Variant
23718>>>>>>>>>        Handle hDispatchDriver
23718>>>>>>>>>        Variant retVal
23718>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23719>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23720>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llMarkupText
23721>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_UNKNOWN to retVal
23722>>>>>>>>>        Function_Return retVal
23723>>>>>>>>>    End_Function
23724>>>>>>>>>
23724>>>>>>>>>    Procedure ComShowPrintDialog
23726>>>>>>>>>        Handle hDispatchDriver
23726>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23727>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
23728>>>>>>>>>    End_Procedure
23729>>>>>>>>>
23729>>>>>>>>>    Function ComCreateRichEditPrintView String llText Returns Variant
23731>>>>>>>>>        Handle hDispatchDriver
23731>>>>>>>>>        Variant retVal
23731>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23732>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23733>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llText
23734>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_UNKNOWN to retVal
23735>>>>>>>>>        Function_Return retVal
23736>>>>>>>>>    End_Function
23737>>>>>>>>>
23737>>>>>>>>>    Function ComToolBar Returns Variant
23739>>>>>>>>>        Handle hDispatchDriver
23739>>>>>>>>>        Variant retVal
23739>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23740>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_DISPATCH to retVal
23741>>>>>>>>>        Function_Return retVal
23742>>>>>>>>>    End_Function
23743>>>>>>>>>
23743>>>>>>>>>    Procedure ComPrintDirect OLE_HANDLE llhDC
23745>>>>>>>>>        Handle hDispatchDriver
23745>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23746>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
23747>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhDC
23748>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
23749>>>>>>>>>    End_Procedure
23750>>>>>>>>>
23750>>>>>>>>>    Procedure ComAboutBox
23752>>>>>>>>>        Handle hDispatchDriver
23752>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
23753>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
23754>>>>>>>>>    End_Procedure
23755>>>>>>>>>End_Class
23756>>>>>>>>>
23756>>>>>>>>>// CLSID: {9F985B8F-403B-41C9-9729-7C965ECCA543}
23756>>>>>>>>>// Event interface for PrintPreview Control
23756>>>>>>>>>Class cCJ_DPrintPreviewEvents is a Mixin
23757>>>>>>>>>
23757>>>>>>>>>    Procedure OnComCloseClick
23759>>>>>>>>>    End_Procedure
23760>>>>>>>>>
23760>>>>>>>>>    Procedure OnComPrintClick
23762>>>>>>>>>    End_Procedure
23763>>>>>>>>>
23763>>>>>>>>>    Procedure OnComReCreated
23765>>>>>>>>>    End_Procedure
23766>>>>>>>>>
23766>>>>>>>>>    Procedure RegisterComEvents
23768>>>>>>>>>        Send RegisterComEvent 1 msg_OnComCloseClick
23769>>>>>>>>>        Send RegisterComEvent 2 msg_OnComPrintClick
23770>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
23771>>>>>>>>>    End_Procedure
23772>>>>>>>>>End_Class
23773>>>>>>>>>
23773>>>>>>>>>// CoClass
23773>>>>>>>>>// ProgID: Codejock.PrintPreview.17.3.0
23773>>>>>>>>>// CLSID: {9A9349FF-6012-4326-A0D9-7825E4DF8EE1}
23773>>>>>>>>>// PrintPreview Control
23773>>>>>>>>>Class cCJPrintPreview is a cComActiveXControl
23774>>>>>>>>>    Import_Class_Protocol cCJ_DPrintPreview
23775>>>>>>>>>    Import_Class_Protocol cCJ_DPrintPreviewEvents
23776>>>>>>>>>
23776>>>>>>>>>    Procedure Construct_Object
23778>>>>>>>>>        Forward Send Construct_Object
23780>>>>>>>>>        Set psProgID to "{9A9349FF-6012-4326-A0D9-7825E4DF8EE1}"
23781>>>>>>>>>        Set psEventId to "{9F985B8F-403B-41C9-9729-7C965ECCA543}"
23782>>>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
23783>>>>>>>>>    End_Procedure
23784>>>>>>>>>End_Class
23785>>>>>>>>>
23785>>>>>>>>>// CLSID: {56737751-7F27-46D2-91A1-0442FD6DA0DD}
23785>>>>>>>>>// Dispatch interface for PushButton Control
23785>>>>>>>>>Class cCJ_DBackstageButton is a Mixin
23786>>>>>>>>>
23786>>>>>>>>>    Function ComValue Returns Boolean
23788>>>>>>>>>        Boolean retVal
23788>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BOOL to retVal
23789>>>>>>>>>        Function_Return retVal
23790>>>>>>>>>    End_Function
23791>>>>>>>>>
23791>>>>>>>>>    Procedure Set ComValue Boolean value
23793>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 0 OLE_VT_BOOL to value
23794>>>>>>>>>    End_Procedure
23795>>>>>>>>>
23795>>>>>>>>>    Function ComCaption Returns String
23797>>>>>>>>>        String retVal
23797>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to retVal
23798>>>>>>>>>        Function_Return retVal
23799>>>>>>>>>    End_Function
23800>>>>>>>>>
23800>>>>>>>>>    Procedure Set ComCaption String value
23802>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to value
23803>>>>>>>>>    End_Procedure
23804>>>>>>>>>
23804>>>>>>>>>    Function ComFont Returns Variant
23806>>>>>>>>>        Variant retVal
23806>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
23807>>>>>>>>>        Function_Return retVal
23808>>>>>>>>>    End_Function
23809>>>>>>>>>
23809>>>>>>>>>    Procedure Set ComFont Variant value
23811>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
23812>>>>>>>>>    End_Procedure
23813>>>>>>>>>
23813>>>>>>>>>    Function ComBackColor Returns OLE_COLOR
23815>>>>>>>>>        OLE_COLOR retVal
23815>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to retVal
23816>>>>>>>>>        Function_Return retVal
23817>>>>>>>>>    End_Function
23818>>>>>>>>>
23818>>>>>>>>>    Procedure Set ComBackColor OLE_COLOR value
23820>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to value
23821>>>>>>>>>    End_Procedure
23822>>>>>>>>>
23822>>>>>>>>>    Function ComForeColor Returns OLE_COLOR
23824>>>>>>>>>        OLE_COLOR retVal
23824>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -513 OLE_VT_I4 to retVal
23825>>>>>>>>>        Function_Return retVal
23826>>>>>>>>>    End_Function
23827>>>>>>>>>
23827>>>>>>>>>    Procedure Set ComForeColor OLE_COLOR value
23829>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -513 OLE_VT_I4 to value
23830>>>>>>>>>    End_Procedure
23831>>>>>>>>>
23831>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
23833>>>>>>>>>        OLE_HANDLE retVal
23833>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to retVal
23834>>>>>>>>>        Function_Return retVal
23835>>>>>>>>>    End_Function
23836>>>>>>>>>
23836>>>>>>>>>    Procedure Set ComHWnd OLE_HANDLE value
23838>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -515 OLE_VT_I4 to value
23839>>>>>>>>>    End_Procedure
23840>>>>>>>>>
23840>>>>>>>>>    Function ComEnabled Returns Boolean
23842>>>>>>>>>        Boolean retVal
23842>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -514 OLE_VT_BOOL to retVal
23843>>>>>>>>>        Function_Return retVal
23844>>>>>>>>>    End_Function
23845>>>>>>>>>
23845>>>>>>>>>    Procedure Set ComEnabled Boolean value
23847>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -514 OLE_VT_BOOL to value
23848>>>>>>>>>    End_Procedure
23849>>>>>>>>>
23849>>>>>>>>>    Function ComDefault Returns Boolean
23851>>>>>>>>>        Boolean retVal
23851>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1745027088 OLE_VT_BOOL to retVal
23852>>>>>>>>>        Function_Return retVal
23853>>>>>>>>>    End_Function
23854>>>>>>>>>
23854>>>>>>>>>    Procedure Set ComDefault Boolean value
23856>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1745027088 OLE_VT_BOOL to value
23857>>>>>>>>>    End_Procedure
23858>>>>>>>>>
23858>>>>>>>>>    Function ComFlatStyle Returns Boolean
23860>>>>>>>>>        Boolean retVal
23860>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
23861>>>>>>>>>        Function_Return retVal
23862>>>>>>>>>    End_Function
23863>>>>>>>>>
23863>>>>>>>>>    Procedure Set ComFlatStyle Boolean value
23865>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
23866>>>>>>>>>    End_Procedure
23867>>>>>>>>>
23867>>>>>>>>>    Function ComAppearance Returns XTPBackstageButtonControlAppearanceStyle
23869>>>>>>>>>        XTPBackstageButtonControlAppearanceStyle retVal
23869>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
23870>>>>>>>>>        Function_Return retVal
23871>>>>>>>>>    End_Function
23872>>>>>>>>>
23872>>>>>>>>>    Procedure Set ComAppearance XTPBackstageButtonControlAppearanceStyle value
23874>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
23875>>>>>>>>>    End_Procedure
23876>>>>>>>>>
23876>>>>>>>>>    Function ComTextAlignment Returns OLEAlignmentStyle
23878>>>>>>>>>        OLEAlignmentStyle retVal
23878>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to retVal
23879>>>>>>>>>        Function_Return retVal
23880>>>>>>>>>    End_Function
23881>>>>>>>>>
23881>>>>>>>>>    Procedure Set ComTextAlignment OLEAlignmentStyle value
23883>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_I4 to value
23884>>>>>>>>>    End_Procedure
23885>>>>>>>>>
23885>>>>>>>>>    Function ComMultiLine Returns Boolean
23887>>>>>>>>>        Boolean retVal
23887>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to retVal
23888>>>>>>>>>        Function_Return retVal
23889>>>>>>>>>    End_Function
23890>>>>>>>>>
23890>>>>>>>>>    Procedure Set ComMultiLine Boolean value
23892>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BOOL to value
23893>>>>>>>>>    End_Procedure
23894>>>>>>>>>
23894>>>>>>>>>    Function ComChecked Returns Boolean
23896>>>>>>>>>        Boolean retVal
23896>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
23897>>>>>>>>>        Function_Return retVal
23898>>>>>>>>>    End_Function
23899>>>>>>>>>
23899>>>>>>>>>    Procedure Set ComChecked Boolean value
23901>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
23902>>>>>>>>>    End_Procedure
23903>>>>>>>>>
23903>>>>>>>>>    Function ComIcon Returns Variant
23905>>>>>>>>>        Variant retVal
23905>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_DISPATCH to retVal
23906>>>>>>>>>        Function_Return retVal
23907>>>>>>>>>    End_Function
23908>>>>>>>>>
23908>>>>>>>>>    Procedure Set ComIcon Variant value
23910>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_DISPATCH to value
23911>>>>>>>>>    End_Procedure
23912>>>>>>>>>
23912>>>>>>>>>    Function ComRightToLeft Returns Boolean
23914>>>>>>>>>        Boolean retVal
23914>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -611 OLE_VT_BOOL to retVal
23915>>>>>>>>>        Function_Return retVal
23916>>>>>>>>>    End_Function
23917>>>>>>>>>
23917>>>>>>>>>    Procedure Set ComRightToLeft Boolean value
23919>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -611 OLE_VT_BOOL to value
23920>>>>>>>>>    End_Procedure
23921>>>>>>>>>
23921>>>>>>>>>    Function ComImageAlignment Returns OLEAlignmentStyle
23923>>>>>>>>>        OLEAlignmentStyle retVal
23923>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_I4 to retVal
23924>>>>>>>>>        Function_Return retVal
23925>>>>>>>>>    End_Function
23926>>>>>>>>>
23926>>>>>>>>>    Procedure Set ComImageAlignment OLEAlignmentStyle value
23928>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 20 OLE_VT_I4 to value
23929>>>>>>>>>    End_Procedure
23930>>>>>>>>>
23930>>>>>>>>>    Function ComTextImageRelation Returns OLETextImageRelationStyle
23932>>>>>>>>>        OLETextImageRelationStyle retVal
23932>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
23933>>>>>>>>>        Function_Return retVal
23934>>>>>>>>>    End_Function
23935>>>>>>>>>
23935>>>>>>>>>    Procedure Set ComTextImageRelation OLETextImageRelationStyle value
23937>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
23938>>>>>>>>>    End_Procedure
23939>>>>>>>>>
23939>>>>>>>>>    Function ComImageGap Returns Integer
23941>>>>>>>>>        Integer retVal
23941>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
23942>>>>>>>>>        Function_Return retVal
23943>>>>>>>>>    End_Function
23944>>>>>>>>>
23944>>>>>>>>>    Procedure Set ComImageGap Integer value
23946>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
23947>>>>>>>>>    End_Procedure
23948>>>>>>>>>
23948>>>>>>>>>    Function ComBorderGap Returns Integer
23950>>>>>>>>>        Integer retVal
23950>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
23951>>>>>>>>>        Function_Return retVal
23952>>>>>>>>>    End_Function
23953>>>>>>>>>
23953>>>>>>>>>    Procedure Set ComBorderGap Integer value
23955>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
23956>>>>>>>>>    End_Procedure
23957>>>>>>>>>
23957>>>>>>>>>    Function ComStyle Returns OLEPushButtonStyle
23959>>>>>>>>>        OLEPushButtonStyle retVal
23959>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to retVal
23960>>>>>>>>>        Function_Return retVal
23961>>>>>>>>>    End_Function
23962>>>>>>>>>
23962>>>>>>>>>    Procedure Set ComStyle OLEPushButtonStyle value
23964>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_I4 to value
23965>>>>>>>>>    End_Procedure
23966>>>>>>>>>
23966>>>>>>>>>    Function ComEnableMarkup Returns Boolean
23968>>>>>>>>>        Boolean retVal
23968>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to retVal
23969>>>>>>>>>        Function_Return retVal
23970>>>>>>>>>    End_Function
23971>>>>>>>>>
23971>>>>>>>>>    Procedure Set ComEnableMarkup Boolean value
23973>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_BOOL to value
23974>>>>>>>>>    End_Procedure
23975>>>>>>>>>
23975>>>>>>>>>    // Returns/Sets whether this control can act as an OLE drop target.
23975>>>>>>>>>    Function ComOLEDropMode Returns OLEDropConstants
23977>>>>>>>>>        OLEDropConstants retVal
23977>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to retVal
23978>>>>>>>>>        Function_Return retVal
23979>>>>>>>>>    End_Function
23980>>>>>>>>>
23980>>>>>>>>>    // Returns/Sets whether this control can act as an OLE drop target.
23980>>>>>>>>>    Procedure Set ComOLEDropMode OLEDropConstants value
23982>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 52 OLE_VT_I4 to value
23983>>>>>>>>>    End_Procedure
23984>>>>>>>>>
23984>>>>>>>>>    Function ComControlToolTip Returns String
23986>>>>>>>>>        String retVal
23986>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_BSTR to retVal
23987>>>>>>>>>        Function_Return retVal
23988>>>>>>>>>    End_Function
23989>>>>>>>>>
23989>>>>>>>>>    Procedure Set ComControlToolTip String value
23991>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 70 OLE_VT_BSTR to value
23992>>>>>>>>>    End_Procedure
23993>>>>>>>>>
23993>>>>>>>>>    Function ComShowShadow Returns Boolean
23995>>>>>>>>>        Boolean retVal
23995>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 78 OLE_VT_BOOL to retVal
23996>>>>>>>>>        Function_Return retVal
23997>>>>>>>>>    End_Function
23998>>>>>>>>>
23998>>>>>>>>>    Procedure Set ComShowShadow Boolean value
24000>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 78 OLE_VT_BOOL to value
24001>>>>>>>>>    End_Procedure
24002>>>>>>>>>
24002>>>>>>>>>    Function ComTabStyle Returns Boolean
24004>>>>>>>>>        Boolean retVal
24004>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 79 OLE_VT_BOOL to retVal
24005>>>>>>>>>        Function_Return retVal
24006>>>>>>>>>    End_Function
24007>>>>>>>>>
24007>>>>>>>>>    Procedure Set ComTabStyle Boolean value
24009>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 79 OLE_VT_BOOL to value
24010>>>>>>>>>    End_Procedure
24011>>>>>>>>>
24011>>>>>>>>>    Function ComReCreateReparented Returns Boolean
24013>>>>>>>>>        Boolean retVal
24013>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
24014>>>>>>>>>        Function_Return retVal
24015>>>>>>>>>    End_Function
24016>>>>>>>>>
24016>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
24018>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
24019>>>>>>>>>    End_Procedure
24020>>>>>>>>>
24020>>>>>>>>>    Function ComMarkupContext Returns Variant
24022>>>>>>>>>        Handle hDispatchDriver
24022>>>>>>>>>        Variant retVal
24022>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24023>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 40 OLE_VT_DISPATCH to retVal
24024>>>>>>>>>        Function_Return retVal
24025>>>>>>>>>    End_Function
24026>>>>>>>>>
24026>>>>>>>>>    Procedure ComAboutBox
24028>>>>>>>>>        Handle hDispatchDriver
24028>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24029>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
24030>>>>>>>>>    End_Procedure
24031>>>>>>>>>
24031>>>>>>>>>    Function ComToolTipContext Returns Variant
24033>>>>>>>>>        Handle hDispatchDriver
24033>>>>>>>>>        Variant retVal
24033>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24034>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 71 OLE_VT_DISPATCH to retVal
24035>>>>>>>>>        Function_Return retVal
24036>>>>>>>>>    End_Function
24037>>>>>>>>>End_Class
24038>>>>>>>>>
24038>>>>>>>>>// CLSID: {5677BE9B-8784-4B18-976D-F889C1F8B1E9}
24038>>>>>>>>>// Event interface for PushButton Control
24038>>>>>>>>>Class cCJ_DBackstageButtonEvents is a Mixin
24039>>>>>>>>>
24039>>>>>>>>>    Procedure OnComClick
24041>>>>>>>>>    End_Procedure
24042>>>>>>>>>
24042>>>>>>>>>    Procedure OnComMouseDown Short llButton Short llShift OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly
24044>>>>>>>>>    End_Procedure
24045>>>>>>>>>
24045>>>>>>>>>    Procedure OnComMouseMove Short llButton Short llShift OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly
24047>>>>>>>>>    End_Procedure
24048>>>>>>>>>
24048>>>>>>>>>    Procedure OnComMouseUp Short llButton Short llShift OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly
24050>>>>>>>>>    End_Procedure
24051>>>>>>>>>
24051>>>>>>>>>    Procedure OnComKeyDown Short ByRef llKeyCode Short llShift
24053>>>>>>>>>    End_Procedure
24054>>>>>>>>>
24054>>>>>>>>>    Procedure OnComKeyPress Short ByRef llKeyAscii
24056>>>>>>>>>    End_Procedure
24057>>>>>>>>>
24057>>>>>>>>>    Procedure OnComKeyUp Short ByRef llKeyCode Short llShift
24059>>>>>>>>>    End_Procedure
24060>>>>>>>>>
24060>>>>>>>>>    Procedure OnComDropDown
24062>>>>>>>>>    End_Procedure
24063>>>>>>>>>
24063>>>>>>>>>    Procedure OnComOLEDragOver Variant llData Integer ByRef llEffect Short llButton Short llShift OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly Short llstate
24065>>>>>>>>>    End_Procedure
24066>>>>>>>>>
24066>>>>>>>>>    Procedure OnComOLEDragDrop Variant llData Integer ByRef llEffect Short llButton Short llShift OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly
24068>>>>>>>>>    End_Procedure
24069>>>>>>>>>
24069>>>>>>>>>    Procedure OnComReCreated
24071>>>>>>>>>    End_Procedure
24072>>>>>>>>>
24072>>>>>>>>>    Procedure RegisterComEvents
24074>>>>>>>>>        Send RegisterComEvent -600 msg_OnComClick
24075>>>>>>>>>        Send RegisterComEvent -605 msg_OnComMouseDown
24076>>>>>>>>>        Send RegisterComEvent -606 msg_OnComMouseMove
24077>>>>>>>>>        Send RegisterComEvent -607 msg_OnComMouseUp
24078>>>>>>>>>        Send RegisterComEvent -602 msg_OnComKeyDown
24079>>>>>>>>>        Send RegisterComEvent -603 msg_OnComKeyPress
24080>>>>>>>>>        Send RegisterComEvent -604 msg_OnComKeyUp
24081>>>>>>>>>        Send RegisterComEvent 1 msg_OnComDropDown
24082>>>>>>>>>        Send RegisterComEvent 300 msg_OnComOLEDragOver
24083>>>>>>>>>        Send RegisterComEvent 301 msg_OnComOLEDragDrop
24084>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
24085>>>>>>>>>    End_Procedure
24086>>>>>>>>>End_Class
24087>>>>>>>>>
24087>>>>>>>>>// CoClass
24087>>>>>>>>>// ProgID: Codejock.BackstageButton.17.3.0
24087>>>>>>>>>// CLSID: {15888A53-4E60-4F99-A14C-B24073D90DF0}
24087>>>>>>>>>// PushButton Control
24087>>>>>>>>>Class cCJBackstageButton is a cComActiveXControl
24088>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageButton
24089>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageButtonEvents
24090>>>>>>>>>
24090>>>>>>>>>    Procedure Construct_Object
24092>>>>>>>>>        Forward Send Construct_Object
24094>>>>>>>>>        Set psProgID to "{15888A53-4E60-4F99-A14C-B24073D90DF0}"
24095>>>>>>>>>        Set psEventId to "{5677BE9B-8784-4B18-976D-F889C1F8B1E9}"
24096>>>>>>>>>        Set psLicenseKey to ("CommandBars Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.CommandBars.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: QQS-PNF-OJV-VBX")
24097>>>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
24098>>>>>>>>>    End_Procedure
24099>>>>>>>>>End_Class
24100>>>>>>>>>
24100>>>>>>>>>// CLSID: {0607A23A-E970-416D-838B-AFF30EDC1D51}
24100>>>>>>>>>// Dispatch interface for BackstageSeparator Control
24100>>>>>>>>>Class cCJ_DBackstageSeparator is a Mixin
24101>>>>>>>>>
24101>>>>>>>>>    Function ComVertical Returns Boolean
24103>>>>>>>>>        Boolean retVal
24103>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
24104>>>>>>>>>        Function_Return retVal
24105>>>>>>>>>    End_Function
24106>>>>>>>>>
24106>>>>>>>>>    Procedure Set ComVertical Boolean value
24108>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
24109>>>>>>>>>    End_Procedure
24110>>>>>>>>>
24110>>>>>>>>>    Function ComAppearance Returns XTPBackstageSeparatorControlAppearanceStyle
24112>>>>>>>>>        XTPBackstageSeparatorControlAppearanceStyle retVal
24112>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
24113>>>>>>>>>        Function_Return retVal
24114>>>>>>>>>    End_Function
24115>>>>>>>>>
24115>>>>>>>>>    Procedure Set ComAppearance XTPBackstageSeparatorControlAppearanceStyle value
24117>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
24118>>>>>>>>>    End_Procedure
24119>>>>>>>>>
24119>>>>>>>>>    Function ComMarkupText Returns String
24121>>>>>>>>>        String retVal
24121>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to retVal
24122>>>>>>>>>        Function_Return retVal
24123>>>>>>>>>    End_Function
24124>>>>>>>>>
24124>>>>>>>>>    Procedure Set ComMarkupText String value
24126>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -518 OLE_VT_BSTR to value
24127>>>>>>>>>    End_Procedure
24128>>>>>>>>>
24128>>>>>>>>>    Function ComReCreateReparented Returns Boolean
24130>>>>>>>>>        Boolean retVal
24130>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
24131>>>>>>>>>        Function_Return retVal
24132>>>>>>>>>    End_Function
24133>>>>>>>>>
24133>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
24135>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
24136>>>>>>>>>    End_Procedure
24137>>>>>>>>>
24137>>>>>>>>>    Procedure ComAboutBox
24139>>>>>>>>>        Handle hDispatchDriver
24139>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24140>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
24141>>>>>>>>>    End_Procedure
24142>>>>>>>>>End_Class
24143>>>>>>>>>
24143>>>>>>>>>// CLSID: {C746B3BE-A9B6-458C-8DBE-71B544CD06B4}
24143>>>>>>>>>// Event interface for BackstageSeparator Control
24143>>>>>>>>>Class cCJ_DBackstageSeparatorEvents is a Mixin
24144>>>>>>>>>
24144>>>>>>>>>    Procedure OnComReCreated
24146>>>>>>>>>    End_Procedure
24147>>>>>>>>>
24147>>>>>>>>>    Procedure RegisterComEvents
24149>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
24150>>>>>>>>>    End_Procedure
24151>>>>>>>>>End_Class
24152>>>>>>>>>
24152>>>>>>>>>// CoClass
24152>>>>>>>>>// ProgID: Codejock.BackstageSeparator.17.3.0
24152>>>>>>>>>// CLSID: {9E3659E9-3184-4EE3-9A47-618B6F067A96}
24152>>>>>>>>>// BackstageSeparator Control
24152>>>>>>>>>Class cCJBackstageSeparator is a cComActiveXControl
24153>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageSeparator
24154>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageSeparatorEvents
24155>>>>>>>>>
24155>>>>>>>>>    Procedure Construct_Object
24157>>>>>>>>>        Forward Send Construct_Object
24159>>>>>>>>>        Set psProgID to "{9E3659E9-3184-4EE3-9A47-618B6F067A96}"
24160>>>>>>>>>        Set psEventId to "{C746B3BE-A9B6-458C-8DBE-71B544CD06B4}"
24161>>>>>>>>>        Set psLicenseKey to ("CommandBars Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.CommandBars.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: QQS-PNF-OJV-VBX")
24162>>>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
24163>>>>>>>>>    End_Procedure
24164>>>>>>>>>End_Class
24165>>>>>>>>>
24165>>>>>>>>>// CLSID: {01AFA23A-E970-416D-838B-AFF30EDC1D51}
24165>>>>>>>>>// Dispatch interface for BackstageListBox Control
24165>>>>>>>>>Class cCJ_DBackstageListBox is a Mixin
24166>>>>>>>>>
24166>>>>>>>>>    Function ComVisualTheme Returns XTPVisualTheme
24168>>>>>>>>>        XTPVisualTheme retVal
24168>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
24169>>>>>>>>>        Function_Return retVal
24170>>>>>>>>>    End_Function
24171>>>>>>>>>
24171>>>>>>>>>    Procedure Set ComVisualTheme XTPVisualTheme value
24173>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
24174>>>>>>>>>    End_Procedure
24175>>>>>>>>>
24175>>>>>>>>>    Function ComShowScrollBarAlways Returns Boolean
24177>>>>>>>>>        Boolean retVal
24177>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
24178>>>>>>>>>        Function_Return retVal
24179>>>>>>>>>    End_Function
24180>>>>>>>>>
24180>>>>>>>>>    Procedure Set ComShowScrollBarAlways Boolean value
24182>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
24183>>>>>>>>>    End_Procedure
24184>>>>>>>>>
24184>>>>>>>>>    Function ComReCreateReparented Returns Boolean
24186>>>>>>>>>        Boolean retVal
24186>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to retVal
24187>>>>>>>>>        Function_Return retVal
24188>>>>>>>>>    End_Function
24189>>>>>>>>>
24189>>>>>>>>>    Procedure Set ComReCreateReparented Boolean value
24191>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10002000 OLE_VT_BOOL to value
24192>>>>>>>>>    End_Procedure
24193>>>>>>>>>
24193>>>>>>>>>    Function ComItems Returns Variant
24195>>>>>>>>>        Handle hDispatchDriver
24195>>>>>>>>>        Variant retVal
24195>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24196>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
24197>>>>>>>>>        Function_Return retVal
24198>>>>>>>>>    End_Function
24199>>>>>>>>>
24199>>>>>>>>>    Function ComGallery Returns Variant
24201>>>>>>>>>        Handle hDispatchDriver
24201>>>>>>>>>        Variant retVal
24201>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24202>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
24203>>>>>>>>>        Function_Return retVal
24204>>>>>>>>>    End_Function
24205>>>>>>>>>
24205>>>>>>>>>    Function ComIcons Returns Variant
24207>>>>>>>>>        Handle hDispatchDriver
24207>>>>>>>>>        Variant retVal
24207>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24208>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_DISPATCH to retVal
24209>>>>>>>>>        Function_Return retVal
24210>>>>>>>>>    End_Function
24211>>>>>>>>>
24211>>>>>>>>>    Function ComToolTipContext Returns Variant
24213>>>>>>>>>        Handle hDispatchDriver
24213>>>>>>>>>        Variant retVal
24213>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24214>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_DISPATCH to retVal
24215>>>>>>>>>        Function_Return retVal
24216>>>>>>>>>    End_Function
24217>>>>>>>>>
24217>>>>>>>>>    Procedure ComCreateRecentFileListItems Variant llRecentFileList
24219>>>>>>>>>        Handle hDispatchDriver
24219>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24220>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
24221>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llRecentFileList
24222>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
24223>>>>>>>>>    End_Procedure
24224>>>>>>>>>
24224>>>>>>>>>    Function ComPaintManager Returns Variant
24226>>>>>>>>>        Handle hDispatchDriver
24226>>>>>>>>>        Variant retVal
24226>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24227>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
24228>>>>>>>>>        Function_Return retVal
24229>>>>>>>>>    End_Function
24230>>>>>>>>>
24230>>>>>>>>>    Function ComHitTest OLE_XPOS_PIXELS llx OLE_YPOS_PIXELS lly Returns Variant
24232>>>>>>>>>        Handle hDispatchDriver
24232>>>>>>>>>        Variant retVal
24232>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24233>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
24234>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llx
24235>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lly
24236>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 17 OLE_VT_DISPATCH to retVal
24237>>>>>>>>>        Function_Return retVal
24238>>>>>>>>>    End_Function
24239>>>>>>>>>
24239>>>>>>>>>    Procedure ComAboutBox
24241>>>>>>>>>        Handle hDispatchDriver
24241>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24242>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
24243>>>>>>>>>    End_Procedure
24244>>>>>>>>>End_Class
24245>>>>>>>>>
24245>>>>>>>>>// CLSID: {FF56B3BE-A9B6-458C-8DBE-71B544CD06B4}
24245>>>>>>>>>// Event interface for BackstageListBox Control
24245>>>>>>>>>Class cCJ_DBackstageListBoxEvents is a Mixin
24246>>>>>>>>>
24246>>>>>>>>>    Procedure OnComItemClick Variant llItem
24248>>>>>>>>>    End_Procedure
24249>>>>>>>>>
24249>>>>>>>>>    Procedure OnComMouseDown Short llButton Short llShift Integer llx Integer lly
24251>>>>>>>>>    End_Procedure
24252>>>>>>>>>
24252>>>>>>>>>    Procedure OnComMouseUp Short llButton Short llShift Integer llx Integer lly
24254>>>>>>>>>    End_Procedure
24255>>>>>>>>>
24255>>>>>>>>>    Procedure OnComReCreated
24257>>>>>>>>>    End_Procedure
24258>>>>>>>>>
24258>>>>>>>>>    Procedure RegisterComEvents
24260>>>>>>>>>        Send RegisterComEvent 1 msg_OnComItemClick
24261>>>>>>>>>        Send RegisterComEvent -605 msg_OnComMouseDown
24262>>>>>>>>>        Send RegisterComEvent -607 msg_OnComMouseUp
24263>>>>>>>>>        Send RegisterComEvent 10001000 msg_OnComReCreated
24264>>>>>>>>>    End_Procedure
24265>>>>>>>>>End_Class
24266>>>>>>>>>
24266>>>>>>>>>// CoClass
24266>>>>>>>>>// ProgID: Codejock.BackstageListBox.17.3.0
24266>>>>>>>>>// CLSID: {4E92FBC1-7F84-4958-9D58-ECFB635ECBA2}
24266>>>>>>>>>// BackstageListBox Control
24266>>>>>>>>>Class cCJBackstageListBox is a cComActiveXControl
24267>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageListBox
24268>>>>>>>>>    Import_Class_Protocol cCJ_DBackstageListBoxEvents
24269>>>>>>>>>
24269>>>>>>>>>    Procedure Construct_Object
24271>>>>>>>>>        Forward Send Construct_Object
24273>>>>>>>>>        Set psProgID to "{4E92FBC1-7F84-4958-9D58-ECFB635ECBA2}"
24274>>>>>>>>>        Set psEventId to "{FF56B3BE-A9B6-458C-8DBE-71B544CD06B4}"
24275>>>>>>>>>        Set psLicenseKey to ("CommandBars Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.CommandBars.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: QQS-PNF-OJV-VBX")
24276>>>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
24277>>>>>>>>>    End_Procedure
24278>>>>>>>>>End_Class
24279>>>>>>>>>
24279>>>>>>>>>// CLSID: {3B1B84AB-AC95-4BA8-895F-0C49C0DC30AB}
24279>>>>>>>>>// Global Global Settings
24279>>>>>>>>>Class cCJICommandBarsGlobalSettings is a Mixin
24280>>>>>>>>>
24280>>>>>>>>>    Function ComResourceFile Returns String
24282>>>>>>>>>        String retVal
24282>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BSTR to retVal
24283>>>>>>>>>        Function_Return retVal
24284>>>>>>>>>    End_Function
24285>>>>>>>>>
24285>>>>>>>>>    Procedure Set ComResourceFile String value
24287>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BSTR to value
24288>>>>>>>>>    End_Procedure
24289>>>>>>>>>
24289>>>>>>>>>    Function ComLicense Returns String
24291>>>>>>>>>        String retVal
24291>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to retVal
24292>>>>>>>>>        Function_Return retVal
24293>>>>>>>>>    End_Function
24294>>>>>>>>>
24294>>>>>>>>>    Procedure Set ComLicense String value
24296>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to value
24297>>>>>>>>>    End_Procedure
24298>>>>>>>>>
24298>>>>>>>>>    Function ComTitle Returns String
24300>>>>>>>>>        String retVal
24300>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to retVal
24301>>>>>>>>>        Function_Return retVal
24302>>>>>>>>>    End_Function
24303>>>>>>>>>
24303>>>>>>>>>    Procedure Set ComTitle String value
24305>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to value
24306>>>>>>>>>    End_Procedure
24307>>>>>>>>>
24307>>>>>>>>>    Function ComReCreateReparentedControls Returns Boolean
24309>>>>>>>>>        Boolean retVal
24309>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 109 OLE_VT_BOOL to retVal
24310>>>>>>>>>        Function_Return retVal
24311>>>>>>>>>    End_Function
24312>>>>>>>>>
24312>>>>>>>>>    Procedure Set ComReCreateReparentedControls Boolean value
24314>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 109 OLE_VT_BOOL to value
24315>>>>>>>>>    End_Procedure
24316>>>>>>>>>
24316>>>>>>>>>    Function ComApp Returns Variant
24318>>>>>>>>>        Variant retVal
24318>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_DISPATCH to retVal
24319>>>>>>>>>        Function_Return retVal
24320>>>>>>>>>    End_Function
24321>>>>>>>>>
24321>>>>>>>>>    Procedure Set ComApp Variant value
24323>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_DISPATCH to value
24324>>>>>>>>>    End_Procedure
24325>>>>>>>>>
24325>>>>>>>>>    Function ComCompanyName Returns String
24327>>>>>>>>>        String retVal
24327>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
24328>>>>>>>>>        Function_Return retVal
24329>>>>>>>>>    End_Function
24330>>>>>>>>>
24330>>>>>>>>>    Procedure Set ComCompanyName String value
24332>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
24333>>>>>>>>>    End_Procedure
24334>>>>>>>>>
24334>>>>>>>>>    Function ComColorManager Returns Variant
24336>>>>>>>>>        Handle hDispatchDriver
24336>>>>>>>>>        Variant retVal
24336>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24337>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 103 OLE_VT_DISPATCH to retVal
24338>>>>>>>>>        Function_Return retVal
24339>>>>>>>>>    End_Function
24340>>>>>>>>>
24340>>>>>>>>>    Function ComFrameShadowManager Returns Variant
24342>>>>>>>>>        Handle hDispatchDriver
24342>>>>>>>>>        Variant retVal
24342>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24343>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 10003000 OLE_VT_DISPATCH to retVal
24344>>>>>>>>>        Function_Return retVal
24345>>>>>>>>>    End_Function
24346>>>>>>>>>
24346>>>>>>>>>    Function ComVersion Returns String
24348>>>>>>>>>        Handle hDispatchDriver
24348>>>>>>>>>        String retVal
24348>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24349>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 104 OLE_VT_BSTR to retVal
24350>>>>>>>>>        Function_Return retVal
24351>>>>>>>>>    End_Function
24352>>>>>>>>>
24352>>>>>>>>>    Function ComUnicode Returns Boolean
24354>>>>>>>>>        Handle hDispatchDriver
24354>>>>>>>>>        Boolean retVal
24354>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24355>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_BOOL to retVal
24356>>>>>>>>>        Function_Return retVal
24357>>>>>>>>>    End_Function
24358>>>>>>>>>
24358>>>>>>>>>    Function ComOcxPath Returns String
24360>>>>>>>>>        Handle hDispatchDriver
24360>>>>>>>>>        String retVal
24360>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24361>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 106 OLE_VT_BSTR to retVal
24362>>>>>>>>>        Function_Return retVal
24363>>>>>>>>>    End_Function
24364>>>>>>>>>
24364>>>>>>>>>    Function ComCreatePropExchange Returns Variant
24366>>>>>>>>>        Handle hDispatchDriver
24366>>>>>>>>>        Variant retVal
24366>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24367>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 107 OLE_VT_DISPATCH to retVal
24368>>>>>>>>>        Function_Return retVal
24369>>>>>>>>>    End_Function
24370>>>>>>>>>
24370>>>>>>>>>    Function ComIcons Returns Variant
24372>>>>>>>>>        Handle hDispatchDriver
24372>>>>>>>>>        Variant retVal
24372>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24373>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 108 OLE_VT_DISPATCH to retVal
24374>>>>>>>>>        Function_Return retVal
24375>>>>>>>>>    End_Function
24376>>>>>>>>>
24376>>>>>>>>>    Function ComResourceImages Returns Variant
24378>>>>>>>>>        Handle hDispatchDriver
24378>>>>>>>>>        Variant retVal
24378>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24379>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_DISPATCH to retVal
24380>>>>>>>>>        Function_Return retVal
24381>>>>>>>>>    End_Function
24382>>>>>>>>>End_Class
24383>>>>>>>>>
24383>>>>>>>>>// CoClass
24383>>>>>>>>>// ProgID: Codejock.CommandBarsGlobalSettings.17.3.0
24383>>>>>>>>>// CLSID: {C793579E-A057-4902-BE42-D805643FBC23}
24383>>>>>>>>>// Command Bars Settings
24383>>>>>>>>>Class cCJCommandBarsGlobalSettings is a cComAutomationObject
24384>>>>>>>>>    Import_Class_Protocol cCJICommandBarsGlobalSettings
24385>>>>>>>>>
24385>>>>>>>>>    Procedure Construct_Object
24387>>>>>>>>>        Forward Send Construct_Object
24389>>>>>>>>>        Set psProgID to "{C793579E-A057-4902-BE42-D805643FBC23}"
24390>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
24391>>>>>>>>>    End_Procedure
24392>>>>>>>>>End_Class
24393>>>>>>>>>
24393>>>>>>>>>// CLSID: {2B69783D-A5D8-4569-8690-592295C5583A}
24393>>>>>>>>>Class cCJComStatusBarPane is a cComAutomationObject
24394>>>>>>>>>
24394>>>>>>>>>    Function ComWidth Returns Integer
24396>>>>>>>>>        Integer retVal
24396>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
24397>>>>>>>>>        Function_Return retVal
24398>>>>>>>>>    End_Function
24399>>>>>>>>>
24399>>>>>>>>>    Procedure Set ComWidth Integer value
24401>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
24402>>>>>>>>>    End_Procedure
24403>>>>>>>>>
24403>>>>>>>>>    Function ComStyle Returns XTPStatusPaneStyle
24405>>>>>>>>>        XTPStatusPaneStyle retVal
24405>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
24406>>>>>>>>>        Function_Return retVal
24407>>>>>>>>>    End_Function
24408>>>>>>>>>
24408>>>>>>>>>    Procedure Set ComStyle XTPStatusPaneStyle value
24410>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
24411>>>>>>>>>    End_Procedure
24412>>>>>>>>>
24412>>>>>>>>>    Function ComVisible Returns Boolean
24414>>>>>>>>>        Boolean retVal
24414>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
24415>>>>>>>>>        Function_Return retVal
24416>>>>>>>>>    End_Function
24417>>>>>>>>>
24417>>>>>>>>>    Procedure Set ComVisible Boolean value
24419>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
24420>>>>>>>>>    End_Procedure
24421>>>>>>>>>
24421>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
24423>>>>>>>>>        OLE_HANDLE retVal
24423>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
24424>>>>>>>>>        Function_Return retVal
24425>>>>>>>>>    End_Function
24426>>>>>>>>>
24426>>>>>>>>>    Procedure Set ComHandle OLE_HANDLE value
24428>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
24429>>>>>>>>>    End_Procedure
24430>>>>>>>>>
24430>>>>>>>>>    Function ComToolTip Returns String
24432>>>>>>>>>        String retVal
24432>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to retVal
24433>>>>>>>>>        Function_Return retVal
24434>>>>>>>>>    End_Function
24435>>>>>>>>>
24435>>>>>>>>>    Procedure Set ComToolTip String value
24437>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to value
24438>>>>>>>>>    End_Procedure
24439>>>>>>>>>
24439>>>>>>>>>    Function ComBeginGroup Returns Boolean
24441>>>>>>>>>        Boolean retVal
24441>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
24442>>>>>>>>>        Function_Return retVal
24443>>>>>>>>>    End_Function
24444>>>>>>>>>
24444>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
24446>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
24447>>>>>>>>>    End_Procedure
24448>>>>>>>>>
24448>>>>>>>>>    Function ComCaption Returns String
24450>>>>>>>>>        String retVal
24450>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to retVal
24451>>>>>>>>>        Function_Return retVal
24452>>>>>>>>>    End_Function
24453>>>>>>>>>
24453>>>>>>>>>    Procedure Set ComCaption String value
24455>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to value
24456>>>>>>>>>    End_Procedure
24457>>>>>>>>>
24457>>>>>>>>>    Function ComEnabled Returns Boolean
24459>>>>>>>>>        Boolean retVal
24459>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
24460>>>>>>>>>        Function_Return retVal
24461>>>>>>>>>    End_Function
24462>>>>>>>>>
24462>>>>>>>>>    Procedure Set ComEnabled Boolean value
24464>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
24465>>>>>>>>>    End_Procedure
24466>>>>>>>>>
24466>>>>>>>>>    Function ComCustomizable Returns Boolean
24468>>>>>>>>>        Boolean retVal
24468>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
24469>>>>>>>>>        Function_Return retVal
24470>>>>>>>>>    End_Function
24471>>>>>>>>>
24471>>>>>>>>>    Procedure Set ComCustomizable Boolean value
24473>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
24474>>>>>>>>>    End_Procedure
24475>>>>>>>>>
24475>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
24477>>>>>>>>>        XTPControlHideFlags retVal
24477>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
24478>>>>>>>>>        Function_Return retVal
24479>>>>>>>>>    End_Function
24480>>>>>>>>>
24480>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
24482>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
24483>>>>>>>>>    End_Procedure
24484>>>>>>>>>
24484>>>>>>>>>    Function ComDark Returns Boolean
24486>>>>>>>>>        Boolean retVal
24486>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
24487>>>>>>>>>        Function_Return retVal
24488>>>>>>>>>    End_Function
24489>>>>>>>>>
24489>>>>>>>>>    Procedure Set ComDark Boolean value
24491>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
24492>>>>>>>>>    End_Procedure
24493>>>>>>>>>
24493>>>>>>>>>    Function ComText Returns String
24495>>>>>>>>>        String retVal
24495>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
24496>>>>>>>>>        Function_Return retVal
24497>>>>>>>>>    End_Function
24498>>>>>>>>>
24498>>>>>>>>>    Procedure Set ComText String value
24500>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
24501>>>>>>>>>    End_Procedure
24502>>>>>>>>>
24502>>>>>>>>>    Function ComTextColor Returns OLE_COLOR
24504>>>>>>>>>        OLE_COLOR retVal
24504>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -513 OLE_VT_I4 to retVal
24505>>>>>>>>>        Function_Return retVal
24506>>>>>>>>>    End_Function
24507>>>>>>>>>
24507>>>>>>>>>    Procedure Set ComTextColor OLE_COLOR value
24509>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -513 OLE_VT_I4 to value
24510>>>>>>>>>    End_Procedure
24511>>>>>>>>>
24511>>>>>>>>>    Function ComTextGrayColor Returns OLE_COLOR
24513>>>>>>>>>        OLE_COLOR retVal
24513>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to retVal
24514>>>>>>>>>        Function_Return retVal
24515>>>>>>>>>    End_Function
24516>>>>>>>>>
24516>>>>>>>>>    Procedure Set ComTextGrayColor OLE_COLOR value
24518>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 25 OLE_VT_I4 to value
24519>>>>>>>>>    End_Procedure
24520>>>>>>>>>
24520>>>>>>>>>    Function ComBackgroundColor Returns OLE_COLOR
24522>>>>>>>>>        OLE_COLOR retVal
24522>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to retVal
24523>>>>>>>>>        Function_Return retVal
24524>>>>>>>>>    End_Function
24525>>>>>>>>>
24525>>>>>>>>>    Procedure Set ComBackgroundColor OLE_COLOR value
24527>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -501 OLE_VT_I4 to value
24528>>>>>>>>>    End_Procedure
24529>>>>>>>>>
24529>>>>>>>>>    Function ComFont Returns Variant
24531>>>>>>>>>        Variant retVal
24531>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
24532>>>>>>>>>        Function_Return retVal
24533>>>>>>>>>    End_Function
24534>>>>>>>>>
24534>>>>>>>>>    Procedure Set ComFont Variant value
24536>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
24537>>>>>>>>>    End_Procedure
24538>>>>>>>>>
24538>>>>>>>>>    Function ComIconIndex Returns Integer
24540>>>>>>>>>        Integer retVal
24540>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to retVal
24541>>>>>>>>>        Function_Return retVal
24542>>>>>>>>>    End_Function
24543>>>>>>>>>
24543>>>>>>>>>    Procedure Set ComIconIndex Integer value
24545>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_I4 to value
24546>>>>>>>>>    End_Procedure
24547>>>>>>>>>
24547>>>>>>>>>    Function ComAlignment Returns XTPTextAlignment
24549>>>>>>>>>        XTPTextAlignment retVal
24549>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to retVal
24550>>>>>>>>>        Function_Return retVal
24551>>>>>>>>>    End_Function
24552>>>>>>>>>
24552>>>>>>>>>    Procedure Set ComAlignment XTPTextAlignment value
24554>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_I4 to value
24555>>>>>>>>>    End_Procedure
24556>>>>>>>>>
24556>>>>>>>>>    Function ComButton Returns Boolean
24558>>>>>>>>>        Boolean retVal
24558>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
24559>>>>>>>>>        Function_Return retVal
24560>>>>>>>>>    End_Function
24561>>>>>>>>>
24561>>>>>>>>>    Procedure Set ComButton Boolean value
24563>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
24564>>>>>>>>>    End_Procedure
24565>>>>>>>>>
24565>>>>>>>>>    Function ComValue Returns String
24567>>>>>>>>>        String retVal
24567>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BSTR to retVal
24568>>>>>>>>>        Function_Return retVal
24569>>>>>>>>>    End_Function
24570>>>>>>>>>
24570>>>>>>>>>    Procedure Set ComValue String value
24572>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BSTR to value
24573>>>>>>>>>    End_Procedure
24574>>>>>>>>>
24574>>>>>>>>>    Function ComChecked Returns Boolean
24576>>>>>>>>>        Boolean retVal
24576>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
24577>>>>>>>>>        Function_Return retVal
24578>>>>>>>>>    End_Function
24579>>>>>>>>>
24579>>>>>>>>>    Procedure Set ComChecked Boolean value
24581>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
24582>>>>>>>>>    End_Procedure
24583>>>>>>>>>
24583>>>>>>>>>    Function ComId Returns Integer
24585>>>>>>>>>        Handle hDispatchDriver
24585>>>>>>>>>        Integer retVal
24585>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24586>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
24587>>>>>>>>>        Function_Return retVal
24588>>>>>>>>>    End_Function
24589>>>>>>>>>
24589>>>>>>>>>    Function ComIndex Returns Integer
24591>>>>>>>>>        Handle hDispatchDriver
24591>>>>>>>>>        Integer retVal
24591>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24592>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
24593>>>>>>>>>        Function_Return retVal
24594>>>>>>>>>    End_Function
24595>>>>>>>>>
24595>>>>>>>>>    Procedure ComRemove
24597>>>>>>>>>        Handle hDispatchDriver
24597>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24598>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
24599>>>>>>>>>    End_Procedure
24600>>>>>>>>>
24600>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
24602>>>>>>>>>        Handle hDispatchDriver
24602>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24603>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
24604>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
24605>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
24606>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
24607>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
24608>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
24609>>>>>>>>>    End_Procedure
24610>>>>>>>>>
24610>>>>>>>>>    Procedure ComRedrawPane
24612>>>>>>>>>        Handle hDispatchDriver
24612>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24613>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 333 OLE_VT_VOID
24614>>>>>>>>>    End_Procedure
24615>>>>>>>>>
24615>>>>>>>>>    Procedure ComSetPadding Integer llLeft Integer llTop Integer llRight Integer llBottom
24617>>>>>>>>>        Handle hDispatchDriver
24617>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24618>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
24619>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llLeft
24620>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTop
24621>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRight
24622>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBottom
24623>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
24624>>>>>>>>>    End_Procedure
24625>>>>>>>>>
24625>>>>>>>>>    Procedure ComSetMargins Integer llLeft Integer llTop Integer llRight Integer llBottom
24627>>>>>>>>>        Handle hDispatchDriver
24627>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24628>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
24629>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llLeft
24630>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTop
24631>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRight
24632>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llBottom
24633>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 20 OLE_VT_VOID
24634>>>>>>>>>    End_Procedure
24635>>>>>>>>>End_Class
24636>>>>>>>>>
24636>>>>>>>>>// CLSID: {4569783D-A5D8-4569-8690-592295C5583A}
24636>>>>>>>>>Class cCJStatusBarSwitchPane is a cComAutomationObject
24637>>>>>>>>>
24637>>>>>>>>>    Function ComWidth Returns Integer
24639>>>>>>>>>        Integer retVal
24639>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
24640>>>>>>>>>        Function_Return retVal
24641>>>>>>>>>    End_Function
24642>>>>>>>>>
24642>>>>>>>>>    Procedure Set ComWidth Integer value
24644>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
24645>>>>>>>>>    End_Procedure
24646>>>>>>>>>
24646>>>>>>>>>    Function ComStyle Returns XTPStatusPaneStyle
24648>>>>>>>>>        XTPStatusPaneStyle retVal
24648>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
24649>>>>>>>>>        Function_Return retVal
24650>>>>>>>>>    End_Function
24651>>>>>>>>>
24651>>>>>>>>>    Procedure Set ComStyle XTPStatusPaneStyle value
24653>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
24654>>>>>>>>>    End_Procedure
24655>>>>>>>>>
24655>>>>>>>>>    Function ComVisible Returns Boolean
24657>>>>>>>>>        Boolean retVal
24657>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
24658>>>>>>>>>        Function_Return retVal
24659>>>>>>>>>    End_Function
24660>>>>>>>>>
24660>>>>>>>>>    Procedure Set ComVisible Boolean value
24662>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
24663>>>>>>>>>    End_Procedure
24664>>>>>>>>>
24664>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
24666>>>>>>>>>        OLE_HANDLE retVal
24666>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
24667>>>>>>>>>        Function_Return retVal
24668>>>>>>>>>    End_Function
24669>>>>>>>>>
24669>>>>>>>>>    Procedure Set ComHandle OLE_HANDLE value
24671>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
24672>>>>>>>>>    End_Procedure
24673>>>>>>>>>
24673>>>>>>>>>    Function ComToolTip Returns String
24675>>>>>>>>>        String retVal
24675>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to retVal
24676>>>>>>>>>        Function_Return retVal
24677>>>>>>>>>    End_Function
24678>>>>>>>>>
24678>>>>>>>>>    Procedure Set ComToolTip String value
24680>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to value
24681>>>>>>>>>    End_Procedure
24682>>>>>>>>>
24682>>>>>>>>>    Function ComBeginGroup Returns Boolean
24684>>>>>>>>>        Boolean retVal
24684>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
24685>>>>>>>>>        Function_Return retVal
24686>>>>>>>>>    End_Function
24687>>>>>>>>>
24687>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
24689>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
24690>>>>>>>>>    End_Procedure
24691>>>>>>>>>
24691>>>>>>>>>    Function ComCaption Returns String
24693>>>>>>>>>        String retVal
24693>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to retVal
24694>>>>>>>>>        Function_Return retVal
24695>>>>>>>>>    End_Function
24696>>>>>>>>>
24696>>>>>>>>>    Procedure Set ComCaption String value
24698>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to value
24699>>>>>>>>>    End_Procedure
24700>>>>>>>>>
24700>>>>>>>>>    Function ComEnabled Returns Boolean
24702>>>>>>>>>        Boolean retVal
24702>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
24703>>>>>>>>>        Function_Return retVal
24704>>>>>>>>>    End_Function
24705>>>>>>>>>
24705>>>>>>>>>    Procedure Set ComEnabled Boolean value
24707>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
24708>>>>>>>>>    End_Procedure
24709>>>>>>>>>
24709>>>>>>>>>    Function ComCustomizable Returns Boolean
24711>>>>>>>>>        Boolean retVal
24711>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
24712>>>>>>>>>        Function_Return retVal
24713>>>>>>>>>    End_Function
24714>>>>>>>>>
24714>>>>>>>>>    Procedure Set ComCustomizable Boolean value
24716>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
24717>>>>>>>>>    End_Procedure
24718>>>>>>>>>
24718>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
24720>>>>>>>>>        XTPControlHideFlags retVal
24720>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
24721>>>>>>>>>        Function_Return retVal
24722>>>>>>>>>    End_Function
24723>>>>>>>>>
24723>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
24725>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
24726>>>>>>>>>    End_Procedure
24727>>>>>>>>>
24727>>>>>>>>>    Function ComDark Returns Boolean
24729>>>>>>>>>        Boolean retVal
24729>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
24730>>>>>>>>>        Function_Return retVal
24731>>>>>>>>>    End_Function
24732>>>>>>>>>
24732>>>>>>>>>    Procedure Set ComDark Boolean value
24734>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
24735>>>>>>>>>    End_Procedure
24736>>>>>>>>>
24736>>>>>>>>>    Function ComChecked Returns Integer
24738>>>>>>>>>        Integer retVal
24738>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to retVal
24739>>>>>>>>>        Function_Return retVal
24740>>>>>>>>>    End_Function
24741>>>>>>>>>
24741>>>>>>>>>    Procedure Set ComChecked Integer value
24743>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to value
24744>>>>>>>>>    End_Procedure
24745>>>>>>>>>
24745>>>>>>>>>    Function ComId Returns Integer
24747>>>>>>>>>        Handle hDispatchDriver
24747>>>>>>>>>        Integer retVal
24747>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24748>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
24749>>>>>>>>>        Function_Return retVal
24750>>>>>>>>>    End_Function
24751>>>>>>>>>
24751>>>>>>>>>    Function ComIndex Returns Integer
24753>>>>>>>>>        Handle hDispatchDriver
24753>>>>>>>>>        Integer retVal
24753>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24754>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
24755>>>>>>>>>        Function_Return retVal
24756>>>>>>>>>    End_Function
24757>>>>>>>>>
24757>>>>>>>>>    Procedure ComRemove
24759>>>>>>>>>        Handle hDispatchDriver
24759>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24760>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
24761>>>>>>>>>    End_Procedure
24762>>>>>>>>>
24762>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
24764>>>>>>>>>        Handle hDispatchDriver
24764>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24765>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
24766>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
24767>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
24768>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
24769>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
24770>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
24771>>>>>>>>>    End_Procedure
24772>>>>>>>>>
24772>>>>>>>>>    Procedure ComRedrawPane
24774>>>>>>>>>        Handle hDispatchDriver
24774>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24775>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 333 OLE_VT_VOID
24776>>>>>>>>>    End_Procedure
24777>>>>>>>>>
24777>>>>>>>>>    Procedure ComAddSwitch Integer llId String llToolTip
24779>>>>>>>>>        Handle hDispatchDriver
24779>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24780>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
24781>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
24782>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llToolTip
24783>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 120 OLE_VT_VOID
24784>>>>>>>>>    End_Procedure
24785>>>>>>>>>
24785>>>>>>>>>    Procedure ComRemoveSwitch Integer llId
24787>>>>>>>>>        Handle hDispatchDriver
24787>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24788>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
24789>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
24790>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 121 OLE_VT_VOID
24791>>>>>>>>>    End_Procedure
24792>>>>>>>>>
24792>>>>>>>>>    Procedure ComEnableSwitch Integer llId Boolean llEnable
24794>>>>>>>>>        Handle hDispatchDriver
24794>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24795>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
24796>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
24797>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llEnable
24798>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 123 OLE_VT_VOID
24799>>>>>>>>>    End_Procedure
24800>>>>>>>>>
24800>>>>>>>>>    Function ComSwitchTooltip Integer llId Returns String
24802>>>>>>>>>        Handle hDispatchDriver
24802>>>>>>>>>        String retVal
24802>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24803>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
24804>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
24805>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 124 OLE_VT_BSTR to retVal
24806>>>>>>>>>        Function_Return retVal
24807>>>>>>>>>    End_Function
24808>>>>>>>>>
24808>>>>>>>>>    Procedure Set ComSwitchTooltip Integer llId String value
24810>>>>>>>>>        Handle hDispatchDriver
24810>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24811>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
24812>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
24813>>>>>>>>>        Set ComProperty of hDispatchDriver 124 OLE_VT_BSTR to value
24814>>>>>>>>>    End_Procedure
24815>>>>>>>>>End_Class
24816>>>>>>>>>
24816>>>>>>>>>// CLSID: {4579783D-A5D8-4569-8690-592295C5583A}
24816>>>>>>>>>Class cCJStatusBarSliderPane is a cComAutomationObject
24817>>>>>>>>>
24817>>>>>>>>>    Function ComWidth Returns Integer
24819>>>>>>>>>        Integer retVal
24819>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
24820>>>>>>>>>        Function_Return retVal
24821>>>>>>>>>    End_Function
24822>>>>>>>>>
24822>>>>>>>>>    Procedure Set ComWidth Integer value
24824>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
24825>>>>>>>>>    End_Procedure
24826>>>>>>>>>
24826>>>>>>>>>    Function ComStyle Returns XTPStatusPaneStyle
24828>>>>>>>>>        XTPStatusPaneStyle retVal
24828>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
24829>>>>>>>>>        Function_Return retVal
24830>>>>>>>>>    End_Function
24831>>>>>>>>>
24831>>>>>>>>>    Procedure Set ComStyle XTPStatusPaneStyle value
24833>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
24834>>>>>>>>>    End_Procedure
24835>>>>>>>>>
24835>>>>>>>>>    Function ComVisible Returns Boolean
24837>>>>>>>>>        Boolean retVal
24837>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
24838>>>>>>>>>        Function_Return retVal
24839>>>>>>>>>    End_Function
24840>>>>>>>>>
24840>>>>>>>>>    Procedure Set ComVisible Boolean value
24842>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
24843>>>>>>>>>    End_Procedure
24844>>>>>>>>>
24844>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
24846>>>>>>>>>        OLE_HANDLE retVal
24846>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
24847>>>>>>>>>        Function_Return retVal
24848>>>>>>>>>    End_Function
24849>>>>>>>>>
24849>>>>>>>>>    Procedure Set ComHandle OLE_HANDLE value
24851>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
24852>>>>>>>>>    End_Procedure
24853>>>>>>>>>
24853>>>>>>>>>    Function ComToolTip Returns String
24855>>>>>>>>>        String retVal
24855>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to retVal
24856>>>>>>>>>        Function_Return retVal
24857>>>>>>>>>    End_Function
24858>>>>>>>>>
24858>>>>>>>>>    Procedure Set ComToolTip String value
24860>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to value
24861>>>>>>>>>    End_Procedure
24862>>>>>>>>>
24862>>>>>>>>>    Function ComBeginGroup Returns Boolean
24864>>>>>>>>>        Boolean retVal
24864>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
24865>>>>>>>>>        Function_Return retVal
24866>>>>>>>>>    End_Function
24867>>>>>>>>>
24867>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
24869>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
24870>>>>>>>>>    End_Procedure
24871>>>>>>>>>
24871>>>>>>>>>    Function ComCaption Returns String
24873>>>>>>>>>        String retVal
24873>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to retVal
24874>>>>>>>>>        Function_Return retVal
24875>>>>>>>>>    End_Function
24876>>>>>>>>>
24876>>>>>>>>>    Procedure Set ComCaption String value
24878>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to value
24879>>>>>>>>>    End_Procedure
24880>>>>>>>>>
24880>>>>>>>>>    Function ComEnabled Returns Boolean
24882>>>>>>>>>        Boolean retVal
24882>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
24883>>>>>>>>>        Function_Return retVal
24884>>>>>>>>>    End_Function
24885>>>>>>>>>
24885>>>>>>>>>    Procedure Set ComEnabled Boolean value
24887>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
24888>>>>>>>>>    End_Procedure
24889>>>>>>>>>
24889>>>>>>>>>    Function ComCustomizable Returns Boolean
24891>>>>>>>>>        Boolean retVal
24891>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
24892>>>>>>>>>        Function_Return retVal
24893>>>>>>>>>    End_Function
24894>>>>>>>>>
24894>>>>>>>>>    Procedure Set ComCustomizable Boolean value
24896>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
24897>>>>>>>>>    End_Procedure
24898>>>>>>>>>
24898>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
24900>>>>>>>>>        XTPControlHideFlags retVal
24900>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
24901>>>>>>>>>        Function_Return retVal
24902>>>>>>>>>    End_Function
24903>>>>>>>>>
24903>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
24905>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
24906>>>>>>>>>    End_Procedure
24907>>>>>>>>>
24907>>>>>>>>>    Function ComDark Returns Boolean
24909>>>>>>>>>        Boolean retVal
24909>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
24910>>>>>>>>>        Function_Return retVal
24911>>>>>>>>>    End_Function
24912>>>>>>>>>
24912>>>>>>>>>    Procedure Set ComDark Boolean value
24914>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
24915>>>>>>>>>    End_Procedure
24916>>>>>>>>>
24916>>>>>>>>>    Function ComMin Returns Integer
24918>>>>>>>>>        Integer retVal
24918>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 120 OLE_VT_I4 to retVal
24919>>>>>>>>>        Function_Return retVal
24920>>>>>>>>>    End_Function
24921>>>>>>>>>
24921>>>>>>>>>    Procedure Set ComMin Integer value
24923>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 120 OLE_VT_I4 to value
24924>>>>>>>>>    End_Procedure
24925>>>>>>>>>
24925>>>>>>>>>    Function ComMax Returns Integer
24927>>>>>>>>>        Integer retVal
24927>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 121 OLE_VT_I4 to retVal
24928>>>>>>>>>        Function_Return retVal
24929>>>>>>>>>    End_Function
24930>>>>>>>>>
24930>>>>>>>>>    Procedure Set ComMax Integer value
24932>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 121 OLE_VT_I4 to value
24933>>>>>>>>>    End_Procedure
24934>>>>>>>>>
24934>>>>>>>>>    Function ComValue Returns Integer
24936>>>>>>>>>        Integer retVal
24936>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to retVal
24937>>>>>>>>>        Function_Return retVal
24938>>>>>>>>>    End_Function
24939>>>>>>>>>
24939>>>>>>>>>    Procedure Set ComValue Integer value
24941>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to value
24942>>>>>>>>>    End_Procedure
24943>>>>>>>>>
24943>>>>>>>>>    Function ComId Returns Integer
24945>>>>>>>>>        Handle hDispatchDriver
24945>>>>>>>>>        Integer retVal
24945>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24946>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
24947>>>>>>>>>        Function_Return retVal
24948>>>>>>>>>    End_Function
24949>>>>>>>>>
24949>>>>>>>>>    Function ComIndex Returns Integer
24951>>>>>>>>>        Handle hDispatchDriver
24951>>>>>>>>>        Integer retVal
24951>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24952>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
24953>>>>>>>>>        Function_Return retVal
24954>>>>>>>>>    End_Function
24955>>>>>>>>>
24955>>>>>>>>>    Procedure ComRemove
24957>>>>>>>>>        Handle hDispatchDriver
24957>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24958>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
24959>>>>>>>>>    End_Procedure
24960>>>>>>>>>
24960>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
24962>>>>>>>>>        Handle hDispatchDriver
24962>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24963>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
24964>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
24965>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
24966>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
24967>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
24968>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
24969>>>>>>>>>    End_Procedure
24970>>>>>>>>>
24970>>>>>>>>>    Procedure ComRedrawPane
24972>>>>>>>>>        Handle hDispatchDriver
24972>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24973>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 333 OLE_VT_VOID
24974>>>>>>>>>    End_Procedure
24975>>>>>>>>>
24975>>>>>>>>>    Procedure ComSetTooltipPart XTPSliderCommand llCommand String llToolTip
24977>>>>>>>>>        Handle hDispatchDriver
24977>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24978>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
24979>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llCommand
24980>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llToolTip
24981>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 123 OLE_VT_VOID
24982>>>>>>>>>    End_Procedure
24983>>>>>>>>>
24983>>>>>>>>>    Procedure ComSetTicks Variant llTicks
24985>>>>>>>>>        Handle hDispatchDriver
24985>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
24986>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
24987>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llTicks
24988>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 124 OLE_VT_VOID
24989>>>>>>>>>    End_Procedure
24990>>>>>>>>>End_Class
24991>>>>>>>>>
24991>>>>>>>>>// CLSID: {7889783D-A5D8-4569-8690-592295C5583A}
24991>>>>>>>>>Class cCJStatusBarProgressPane is a cComAutomationObject
24992>>>>>>>>>
24992>>>>>>>>>    Function ComWidth Returns Integer
24994>>>>>>>>>        Integer retVal
24994>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
24995>>>>>>>>>        Function_Return retVal
24996>>>>>>>>>    End_Function
24997>>>>>>>>>
24997>>>>>>>>>    Procedure Set ComWidth Integer value
24999>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
25000>>>>>>>>>    End_Procedure
25001>>>>>>>>>
25001>>>>>>>>>    Function ComStyle Returns XTPStatusPaneStyle
25003>>>>>>>>>        XTPStatusPaneStyle retVal
25003>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
25004>>>>>>>>>        Function_Return retVal
25005>>>>>>>>>    End_Function
25006>>>>>>>>>
25006>>>>>>>>>    Procedure Set ComStyle XTPStatusPaneStyle value
25008>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
25009>>>>>>>>>    End_Procedure
25010>>>>>>>>>
25010>>>>>>>>>    Function ComVisible Returns Boolean
25012>>>>>>>>>        Boolean retVal
25012>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to retVal
25013>>>>>>>>>        Function_Return retVal
25014>>>>>>>>>    End_Function
25015>>>>>>>>>
25015>>>>>>>>>    Procedure Set ComVisible Boolean value
25017>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 7 OLE_VT_BOOL to value
25018>>>>>>>>>    End_Procedure
25019>>>>>>>>>
25019>>>>>>>>>    Function ComHandle Returns OLE_HANDLE
25021>>>>>>>>>        OLE_HANDLE retVal
25021>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
25022>>>>>>>>>        Function_Return retVal
25023>>>>>>>>>    End_Function
25024>>>>>>>>>
25024>>>>>>>>>    Procedure Set ComHandle OLE_HANDLE value
25026>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
25027>>>>>>>>>    End_Procedure
25028>>>>>>>>>
25028>>>>>>>>>    Function ComToolTip Returns String
25030>>>>>>>>>        String retVal
25030>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to retVal
25031>>>>>>>>>        Function_Return retVal
25032>>>>>>>>>    End_Function
25033>>>>>>>>>
25033>>>>>>>>>    Procedure Set ComToolTip String value
25035>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 11 OLE_VT_BSTR to value
25036>>>>>>>>>    End_Procedure
25037>>>>>>>>>
25037>>>>>>>>>    Function ComBeginGroup Returns Boolean
25039>>>>>>>>>        Boolean retVal
25039>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
25040>>>>>>>>>        Function_Return retVal
25041>>>>>>>>>    End_Function
25042>>>>>>>>>
25042>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
25044>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
25045>>>>>>>>>    End_Procedure
25046>>>>>>>>>
25046>>>>>>>>>    Function ComCaption Returns String
25048>>>>>>>>>        String retVal
25048>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to retVal
25049>>>>>>>>>        Function_Return retVal
25050>>>>>>>>>    End_Function
25051>>>>>>>>>
25051>>>>>>>>>    Procedure Set ComCaption String value
25053>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 16 OLE_VT_BSTR to value
25054>>>>>>>>>    End_Procedure
25055>>>>>>>>>
25055>>>>>>>>>    Function ComEnabled Returns Boolean
25057>>>>>>>>>        Boolean retVal
25057>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to retVal
25058>>>>>>>>>        Function_Return retVal
25059>>>>>>>>>    End_Function
25060>>>>>>>>>
25060>>>>>>>>>    Procedure Set ComEnabled Boolean value
25062>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_BOOL to value
25063>>>>>>>>>    End_Procedure
25064>>>>>>>>>
25064>>>>>>>>>    Function ComCustomizable Returns Boolean
25066>>>>>>>>>        Boolean retVal
25066>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to retVal
25067>>>>>>>>>        Function_Return retVal
25068>>>>>>>>>    End_Function
25069>>>>>>>>>
25069>>>>>>>>>    Procedure Set ComCustomizable Boolean value
25071>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_BOOL to value
25072>>>>>>>>>    End_Procedure
25073>>>>>>>>>
25073>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
25075>>>>>>>>>        XTPControlHideFlags retVal
25075>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to retVal
25076>>>>>>>>>        Function_Return retVal
25077>>>>>>>>>    End_Function
25078>>>>>>>>>
25078>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
25080>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 22 OLE_VT_I4 to value
25081>>>>>>>>>    End_Procedure
25082>>>>>>>>>
25082>>>>>>>>>    Function ComDark Returns Boolean
25084>>>>>>>>>        Boolean retVal
25084>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to retVal
25085>>>>>>>>>        Function_Return retVal
25086>>>>>>>>>    End_Function
25087>>>>>>>>>
25087>>>>>>>>>    Procedure Set ComDark Boolean value
25089>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 26 OLE_VT_BOOL to value
25090>>>>>>>>>    End_Procedure
25091>>>>>>>>>
25091>>>>>>>>>    Function ComMin Returns Integer
25093>>>>>>>>>        Integer retVal
25093>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 120 OLE_VT_I4 to retVal
25094>>>>>>>>>        Function_Return retVal
25095>>>>>>>>>    End_Function
25096>>>>>>>>>
25096>>>>>>>>>    Procedure Set ComMin Integer value
25098>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 120 OLE_VT_I4 to value
25099>>>>>>>>>    End_Procedure
25100>>>>>>>>>
25100>>>>>>>>>    Function ComMax Returns Integer
25102>>>>>>>>>        Integer retVal
25102>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 121 OLE_VT_I4 to retVal
25103>>>>>>>>>        Function_Return retVal
25104>>>>>>>>>    End_Function
25105>>>>>>>>>
25105>>>>>>>>>    Procedure Set ComMax Integer value
25107>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 121 OLE_VT_I4 to value
25108>>>>>>>>>    End_Procedure
25109>>>>>>>>>
25109>>>>>>>>>    Function ComValue Returns Integer
25111>>>>>>>>>        Integer retVal
25111>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to retVal
25112>>>>>>>>>        Function_Return retVal
25113>>>>>>>>>    End_Function
25114>>>>>>>>>
25114>>>>>>>>>    Procedure Set ComValue Integer value
25116>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 122 OLE_VT_I4 to value
25117>>>>>>>>>    End_Procedure
25118>>>>>>>>>
25118>>>>>>>>>    Function ComId Returns Integer
25120>>>>>>>>>        Handle hDispatchDriver
25120>>>>>>>>>        Integer retVal
25120>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25121>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
25122>>>>>>>>>        Function_Return retVal
25123>>>>>>>>>    End_Function
25124>>>>>>>>>
25124>>>>>>>>>    Function ComIndex Returns Integer
25126>>>>>>>>>        Handle hDispatchDriver
25126>>>>>>>>>        Integer retVal
25126>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25127>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
25128>>>>>>>>>        Function_Return retVal
25129>>>>>>>>>    End_Function
25130>>>>>>>>>
25130>>>>>>>>>    Procedure ComRemove
25132>>>>>>>>>        Handle hDispatchDriver
25132>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25133>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
25134>>>>>>>>>    End_Procedure
25135>>>>>>>>>
25135>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
25137>>>>>>>>>        Handle hDispatchDriver
25137>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25138>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
25139>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
25140>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
25141>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
25142>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
25143>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
25144>>>>>>>>>    End_Procedure
25145>>>>>>>>>
25145>>>>>>>>>    Procedure ComRedrawPane
25147>>>>>>>>>        Handle hDispatchDriver
25147>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25148>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 333 OLE_VT_VOID
25149>>>>>>>>>    End_Procedure
25150>>>>>>>>>
25150>>>>>>>>>    Procedure ComRedrawProgress
25152>>>>>>>>>        Handle hDispatchDriver
25152>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25153>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 334 OLE_VT_VOID
25154>>>>>>>>>    End_Procedure
25155>>>>>>>>>End_Class
25156>>>>>>>>>
25156>>>>>>>>>// CLSID: {46445B78-7A0A-447D-9CDC-8F63E7E5AF55}
25156>>>>>>>>>// Dispatch interface for MessageBar Control
25156>>>>>>>>>Class cCJMessageBar is a cComAutomationObject
25157>>>>>>>>>
25157>>>>>>>>>    Function ComVisible Returns Boolean
25159>>>>>>>>>        Boolean retVal
25159>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
25160>>>>>>>>>        Function_Return retVal
25161>>>>>>>>>    End_Function
25162>>>>>>>>>
25162>>>>>>>>>    Procedure Set ComVisible Boolean value
25164>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
25165>>>>>>>>>    End_Procedure
25166>>>>>>>>>
25166>>>>>>>>>    Function ComMessage Returns String
25168>>>>>>>>>        String retVal
25168>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
25169>>>>>>>>>        Function_Return retVal
25170>>>>>>>>>    End_Function
25171>>>>>>>>>
25171>>>>>>>>>    Procedure Set ComMessage String value
25173>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
25174>>>>>>>>>    End_Procedure
25175>>>>>>>>>
25175>>>>>>>>>    Function ComHeight Returns Integer
25177>>>>>>>>>        Integer retVal
25177>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
25178>>>>>>>>>        Function_Return retVal
25179>>>>>>>>>    End_Function
25180>>>>>>>>>
25180>>>>>>>>>    Procedure Set ComHeight Integer value
25182>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
25183>>>>>>>>>    End_Procedure
25184>>>>>>>>>
25184>>>>>>>>>    Procedure ComAddButton Integer llId String llCaption String llToolTip
25186>>>>>>>>>        Handle hDispatchDriver
25186>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25187>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
25188>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
25189>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
25190>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llToolTip
25191>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
25192>>>>>>>>>    End_Procedure
25193>>>>>>>>>
25193>>>>>>>>>    Procedure ComRemoveButtons
25195>>>>>>>>>        Handle hDispatchDriver
25195>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25196>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
25197>>>>>>>>>    End_Procedure
25198>>>>>>>>>
25198>>>>>>>>>    Procedure ComAddCloseButton String llToolTip
25200>>>>>>>>>        Handle hDispatchDriver
25200>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25201>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25202>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llToolTip
25203>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
25204>>>>>>>>>    End_Procedure
25205>>>>>>>>>End_Class
25206>>>>>>>>>
25206>>>>>>>>>// CLSID: {56728A35-789A-40D9-B564-7577DA549319}
25206>>>>>>>>>Class cCJRibbonBarSystemButton is a cComAutomationObject
25207>>>>>>>>>
25207>>>>>>>>>    Function ComChecked Returns Boolean
25209>>>>>>>>>        Boolean retVal
25209>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
25210>>>>>>>>>        Function_Return retVal
25211>>>>>>>>>    End_Function
25212>>>>>>>>>
25212>>>>>>>>>    Procedure Set ComChecked Boolean value
25214>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
25215>>>>>>>>>    End_Procedure
25216>>>>>>>>>
25216>>>>>>>>>    Function ComBeginGroup Returns Boolean
25218>>>>>>>>>        Boolean retVal
25218>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
25219>>>>>>>>>        Function_Return retVal
25220>>>>>>>>>    End_Function
25221>>>>>>>>>
25221>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
25223>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
25224>>>>>>>>>    End_Procedure
25225>>>>>>>>>
25225>>>>>>>>>    Function ComCaption Returns String
25227>>>>>>>>>        String retVal
25227>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
25228>>>>>>>>>        Function_Return retVal
25229>>>>>>>>>    End_Function
25230>>>>>>>>>
25230>>>>>>>>>    Procedure Set ComCaption String value
25232>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
25233>>>>>>>>>    End_Procedure
25234>>>>>>>>>
25234>>>>>>>>>    Function ComDescriptionText Returns String
25236>>>>>>>>>        String retVal
25236>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
25237>>>>>>>>>        Function_Return retVal
25238>>>>>>>>>    End_Function
25239>>>>>>>>>
25239>>>>>>>>>    Procedure Set ComDescriptionText String value
25241>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
25242>>>>>>>>>    End_Procedure
25243>>>>>>>>>
25243>>>>>>>>>    Function ComId Returns Integer
25245>>>>>>>>>        Integer retVal
25245>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
25246>>>>>>>>>        Function_Return retVal
25247>>>>>>>>>    End_Function
25248>>>>>>>>>
25248>>>>>>>>>    Procedure Set ComId Integer value
25250>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
25251>>>>>>>>>    End_Procedure
25252>>>>>>>>>
25252>>>>>>>>>    Function ComParameter Returns String
25254>>>>>>>>>        String retVal
25254>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
25255>>>>>>>>>        Function_Return retVal
25256>>>>>>>>>    End_Function
25257>>>>>>>>>
25257>>>>>>>>>    Procedure Set ComParameter String value
25259>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
25260>>>>>>>>>    End_Procedure
25261>>>>>>>>>
25261>>>>>>>>>    Function ComShortcutText Returns String
25263>>>>>>>>>        String retVal
25263>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
25264>>>>>>>>>        Function_Return retVal
25265>>>>>>>>>    End_Function
25266>>>>>>>>>
25266>>>>>>>>>    Procedure Set ComShortcutText String value
25268>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
25269>>>>>>>>>    End_Procedure
25270>>>>>>>>>
25270>>>>>>>>>    Function ComCustomShortcutText Returns String
25272>>>>>>>>>        String retVal
25272>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
25273>>>>>>>>>        Function_Return retVal
25274>>>>>>>>>    End_Function
25275>>>>>>>>>
25275>>>>>>>>>    Procedure Set ComCustomShortcutText String value
25277>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
25278>>>>>>>>>    End_Procedure
25279>>>>>>>>>
25279>>>>>>>>>    Function ComTooltipText Returns String
25281>>>>>>>>>        String retVal
25281>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
25282>>>>>>>>>        Function_Return retVal
25283>>>>>>>>>    End_Function
25284>>>>>>>>>
25284>>>>>>>>>    Procedure Set ComTooltipText String value
25286>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
25287>>>>>>>>>    End_Procedure
25288>>>>>>>>>
25288>>>>>>>>>    Function ComVisible Returns Boolean
25290>>>>>>>>>        Boolean retVal
25290>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
25291>>>>>>>>>        Function_Return retVal
25292>>>>>>>>>    End_Function
25293>>>>>>>>>
25293>>>>>>>>>    Procedure Set ComVisible Boolean value
25295>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
25296>>>>>>>>>    End_Procedure
25297>>>>>>>>>
25297>>>>>>>>>    Function ComEnabled Returns Boolean
25299>>>>>>>>>        Boolean retVal
25299>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
25300>>>>>>>>>        Function_Return retVal
25301>>>>>>>>>    End_Function
25302>>>>>>>>>
25302>>>>>>>>>    Procedure Set ComEnabled Boolean value
25304>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
25305>>>>>>>>>    End_Procedure
25306>>>>>>>>>
25306>>>>>>>>>    Function ComIconId Returns Integer
25308>>>>>>>>>        Integer retVal
25308>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
25309>>>>>>>>>        Function_Return retVal
25310>>>>>>>>>    End_Function
25311>>>>>>>>>
25311>>>>>>>>>    Procedure Set ComIconId Integer value
25313>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
25314>>>>>>>>>    End_Procedure
25315>>>>>>>>>
25315>>>>>>>>>    Function ComDefaultItem Returns Boolean
25317>>>>>>>>>        Boolean retVal
25317>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
25318>>>>>>>>>        Function_Return retVal
25319>>>>>>>>>    End_Function
25320>>>>>>>>>
25320>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
25322>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
25323>>>>>>>>>    End_Procedure
25324>>>>>>>>>
25324>>>>>>>>>    Function ComFlags Returns XTPControlFlags
25326>>>>>>>>>        XTPControlFlags retVal
25326>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
25327>>>>>>>>>        Function_Return retVal
25328>>>>>>>>>    End_Function
25329>>>>>>>>>
25329>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
25331>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
25332>>>>>>>>>    End_Procedure
25333>>>>>>>>>
25333>>>>>>>>>    Function ComCategory Returns String
25335>>>>>>>>>        String retVal
25335>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
25336>>>>>>>>>        Function_Return retVal
25337>>>>>>>>>    End_Function
25338>>>>>>>>>
25338>>>>>>>>>    Procedure Set ComCategory String value
25340>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
25341>>>>>>>>>    End_Procedure
25342>>>>>>>>>
25342>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
25344>>>>>>>>>        XTPControlHideFlags retVal
25344>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
25345>>>>>>>>>        Function_Return retVal
25346>>>>>>>>>    End_Function
25347>>>>>>>>>
25347>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
25349>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
25350>>>>>>>>>    End_Procedure
25351>>>>>>>>>
25351>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
25353>>>>>>>>>        Boolean retVal
25353>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
25354>>>>>>>>>        Function_Return retVal
25355>>>>>>>>>    End_Function
25356>>>>>>>>>
25356>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
25358>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
25359>>>>>>>>>    End_Procedure
25360>>>>>>>>>
25360>>>>>>>>>    Function ComAction Returns Variant
25362>>>>>>>>>        Variant retVal
25362>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
25363>>>>>>>>>        Function_Return retVal
25364>>>>>>>>>    End_Function
25365>>>>>>>>>
25365>>>>>>>>>    Procedure Set ComAction Variant value
25367>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
25368>>>>>>>>>    End_Procedure
25369>>>>>>>>>
25369>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
25371>>>>>>>>>        Integer retVal
25371>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
25372>>>>>>>>>        Function_Return retVal
25373>>>>>>>>>    End_Function
25374>>>>>>>>>
25374>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
25376>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
25377>>>>>>>>>    End_Procedure
25378>>>>>>>>>
25378>>>>>>>>>    Function ComWidth Returns Integer
25380>>>>>>>>>        Integer retVal
25380>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
25381>>>>>>>>>        Function_Return retVal
25382>>>>>>>>>    End_Function
25383>>>>>>>>>
25383>>>>>>>>>    Procedure Set ComWidth Integer value
25385>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
25386>>>>>>>>>    End_Procedure
25387>>>>>>>>>
25387>>>>>>>>>    Function ComHeight Returns Integer
25389>>>>>>>>>        Integer retVal
25389>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
25390>>>>>>>>>        Function_Return retVal
25391>>>>>>>>>    End_Function
25392>>>>>>>>>
25392>>>>>>>>>    Procedure Set ComHeight Integer value
25394>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
25395>>>>>>>>>    End_Procedure
25396>>>>>>>>>
25396>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
25398>>>>>>>>>        XTPButtonStyle retVal
25398>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
25399>>>>>>>>>        Function_Return retVal
25400>>>>>>>>>    End_Function
25401>>>>>>>>>
25401>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
25403>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
25404>>>>>>>>>    End_Procedure
25405>>>>>>>>>
25405>>>>>>>>>    Function ComKeyboardTip Returns String
25407>>>>>>>>>        String retVal
25407>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
25408>>>>>>>>>        Function_Return retVal
25409>>>>>>>>>    End_Function
25410>>>>>>>>>
25410>>>>>>>>>    Procedure Set ComKeyboardTip String value
25412>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
25413>>>>>>>>>    End_Procedure
25414>>>>>>>>>
25414>>>>>>>>>    Function ComCommandBar Returns Variant
25416>>>>>>>>>        Variant retVal
25416>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to retVal
25417>>>>>>>>>        Function_Return retVal
25418>>>>>>>>>    End_Function
25419>>>>>>>>>
25419>>>>>>>>>    Procedure Set ComCommandBar Variant value
25421>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to value
25422>>>>>>>>>    End_Procedure
25423>>>>>>>>>
25423>>>>>>>>>    Function ComCloseOnDblClick Returns Boolean
25425>>>>>>>>>        Boolean retVal
25425>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_BOOL to retVal
25426>>>>>>>>>        Function_Return retVal
25427>>>>>>>>>    End_Function
25428>>>>>>>>>
25428>>>>>>>>>    Procedure Set ComCloseOnDblClick Boolean value
25430>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_BOOL to value
25431>>>>>>>>>    End_Procedure
25432>>>>>>>>>
25432>>>>>>>>>    Function ComControls Returns Variant
25434>>>>>>>>>        Handle hDispatchDriver
25434>>>>>>>>>        Variant retVal
25434>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25435>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
25436>>>>>>>>>        Function_Return retVal
25437>>>>>>>>>    End_Function
25438>>>>>>>>>
25438>>>>>>>>>    Function ComParent Returns Variant
25440>>>>>>>>>        Handle hDispatchDriver
25440>>>>>>>>>        Variant retVal
25440>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25441>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
25442>>>>>>>>>        Function_Return retVal
25443>>>>>>>>>    End_Function
25444>>>>>>>>>
25444>>>>>>>>>    Function ComIndex Returns Integer
25446>>>>>>>>>        Handle hDispatchDriver
25446>>>>>>>>>        Integer retVal
25446>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25447>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
25448>>>>>>>>>        Function_Return retVal
25449>>>>>>>>>    End_Function
25450>>>>>>>>>
25450>>>>>>>>>    Function ComType Returns XTPControlType
25452>>>>>>>>>        Handle hDispatchDriver
25452>>>>>>>>>        XTPControlType retVal
25452>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25453>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
25454>>>>>>>>>        Function_Return retVal
25455>>>>>>>>>    End_Function
25456>>>>>>>>>
25456>>>>>>>>>    Procedure ComDelete
25458>>>>>>>>>        Handle hDispatchDriver
25458>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25459>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
25460>>>>>>>>>    End_Procedure
25461>>>>>>>>>
25461>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
25463>>>>>>>>>        Handle hDispatchDriver
25463>>>>>>>>>        Variant retVal
25463>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25464>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
25465>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
25466>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
25467>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
25468>>>>>>>>>        Function_Return retVal
25469>>>>>>>>>    End_Function
25470>>>>>>>>>
25470>>>>>>>>>    Procedure ComSetFocus
25472>>>>>>>>>        Handle hDispatchDriver
25472>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25473>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
25474>>>>>>>>>    End_Procedure
25475>>>>>>>>>
25475>>>>>>>>>    Procedure ComExecute
25477>>>>>>>>>        Handle hDispatchDriver
25477>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25478>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
25479>>>>>>>>>    End_Procedure
25480>>>>>>>>>
25480>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
25482>>>>>>>>>        Handle hDispatchDriver
25482>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25483>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
25484>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
25485>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
25486>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
25487>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
25488>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
25489>>>>>>>>>    End_Procedure
25490>>>>>>>>>
25490>>>>>>>>>    Function ComRibbonGroup Returns Variant
25492>>>>>>>>>        Handle hDispatchDriver
25492>>>>>>>>>        Variant retVal
25492>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25493>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
25494>>>>>>>>>        Function_Return retVal
25495>>>>>>>>>    End_Function
25496>>>>>>>>>
25496>>>>>>>>>    Procedure ComReset
25498>>>>>>>>>        Handle hDispatchDriver
25498>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25499>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
25500>>>>>>>>>    End_Procedure
25501>>>>>>>>>
25501>>>>>>>>>    Function ComTop Returns Integer
25503>>>>>>>>>        Handle hDispatchDriver
25503>>>>>>>>>        Integer retVal
25503>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25504>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
25505>>>>>>>>>        Function_Return retVal
25506>>>>>>>>>    End_Function
25507>>>>>>>>>
25507>>>>>>>>>    Function ComLeft Returns Integer
25509>>>>>>>>>        Handle hDispatchDriver
25509>>>>>>>>>        Integer retVal
25509>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25510>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
25511>>>>>>>>>        Function_Return retVal
25512>>>>>>>>>    End_Function
25513>>>>>>>>>
25513>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
25515>>>>>>>>>        Handle hDispatchDriver
25515>>>>>>>>>        Variant retVal
25515>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25516>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25517>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
25518>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
25519>>>>>>>>>        Function_Return retVal
25520>>>>>>>>>    End_Function
25521>>>>>>>>>
25521>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
25523>>>>>>>>>        Handle hDispatchDriver
25523>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25524>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
25525>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
25526>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
25527>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
25528>>>>>>>>>    End_Procedure
25529>>>>>>>>>End_Class
25530>>>>>>>>>
25530>>>>>>>>>// CLSID: {A99113E7-46A4-4F99-83D8-C6D3C2B390FC}
25530>>>>>>>>>Class cCJRibbonPaintManager is a cComAutomationObject
25531>>>>>>>>>
25531>>>>>>>>>    Function ComCaptionFont Returns Variant
25533>>>>>>>>>        Variant retVal
25533>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to retVal
25534>>>>>>>>>        Function_Return retVal
25535>>>>>>>>>    End_Function
25536>>>>>>>>>
25536>>>>>>>>>    Procedure Set ComCaptionFont Variant value
25538>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) -512 OLE_VT_DISPATCH to value
25539>>>>>>>>>    End_Procedure
25540>>>>>>>>>
25540>>>>>>>>>    Function ComHotTrackingGroups Returns Boolean
25542>>>>>>>>>        Boolean retVal
25542>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BOOL to retVal
25543>>>>>>>>>        Function_Return retVal
25544>>>>>>>>>    End_Function
25545>>>>>>>>>
25545>>>>>>>>>    Procedure Set ComHotTrackingGroups Boolean value
25547>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 100 OLE_VT_BOOL to value
25548>>>>>>>>>    End_Procedure
25549>>>>>>>>>
25549>>>>>>>>>    Function ComWindowCaptionFont Returns Variant
25551>>>>>>>>>        Variant retVal
25551>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_DISPATCH to retVal
25552>>>>>>>>>        Function_Return retVal
25553>>>>>>>>>    End_Function
25554>>>>>>>>>
25554>>>>>>>>>    Procedure Set ComWindowCaptionFont Variant value
25556>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_DISPATCH to value
25557>>>>>>>>>    End_Procedure
25558>>>>>>>>>End_Class
25559>>>>>>>>>
25559>>>>>>>>>// CLSID: {766113E7-46A4-4F99-83D8-C6D3C2B390FC}
25559>>>>>>>>>Class cCJMiniToolBar is a cComAutomationObject
25560>>>>>>>>>
25560>>>>>>>>>    Function ComTitle Returns String
25562>>>>>>>>>        String retVal
25562>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
25563>>>>>>>>>        Function_Return retVal
25564>>>>>>>>>    End_Function
25565>>>>>>>>>
25565>>>>>>>>>    Procedure Set ComTitle String value
25567>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
25568>>>>>>>>>    End_Procedure
25569>>>>>>>>>
25569>>>>>>>>>    Function ComVisible Returns Boolean
25571>>>>>>>>>        Boolean retVal
25571>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
25572>>>>>>>>>        Function_Return retVal
25573>>>>>>>>>    End_Function
25574>>>>>>>>>
25574>>>>>>>>>    Procedure Set ComVisible Boolean value
25576>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
25577>>>>>>>>>    End_Procedure
25578>>>>>>>>>
25578>>>>>>>>>    Function ComPosition Returns XTPBarPosition
25580>>>>>>>>>        XTPBarPosition retVal
25580>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to retVal
25581>>>>>>>>>        Function_Return retVal
25582>>>>>>>>>    End_Function
25583>>>>>>>>>
25583>>>>>>>>>    Procedure Set ComPosition XTPBarPosition value
25585>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_I4 to value
25586>>>>>>>>>    End_Procedure
25587>>>>>>>>>
25587>>>>>>>>>    Function ComBarID Returns Integer
25589>>>>>>>>>        Integer retVal
25589>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to retVal
25590>>>>>>>>>        Function_Return retVal
25591>>>>>>>>>    End_Function
25592>>>>>>>>>
25592>>>>>>>>>    Procedure Set ComBarID Integer value
25594>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_I4 to value
25595>>>>>>>>>    End_Procedure
25596>>>>>>>>>
25596>>>>>>>>>    Function ComContextMenuPresent Returns Boolean
25598>>>>>>>>>        Boolean retVal
25598>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to retVal
25599>>>>>>>>>        Function_Return retVal
25600>>>>>>>>>    End_Function
25601>>>>>>>>>
25601>>>>>>>>>    Procedure Set ComContextMenuPresent Boolean value
25603>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_BOOL to value
25604>>>>>>>>>    End_Procedure
25605>>>>>>>>>
25605>>>>>>>>>    Function ComWidth Returns Integer
25607>>>>>>>>>        Integer retVal
25607>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to retVal
25608>>>>>>>>>        Function_Return retVal
25609>>>>>>>>>    End_Function
25610>>>>>>>>>
25610>>>>>>>>>    Procedure Set ComWidth Integer value
25612>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 21 OLE_VT_I4 to value
25613>>>>>>>>>    End_Procedure
25614>>>>>>>>>
25614>>>>>>>>>    Function ComCloseable Returns Boolean
25616>>>>>>>>>        Boolean retVal
25616>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
25617>>>>>>>>>        Function_Return retVal
25618>>>>>>>>>    End_Function
25619>>>>>>>>>
25619>>>>>>>>>    Procedure Set ComCloseable Boolean value
25621>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
25622>>>>>>>>>    End_Procedure
25623>>>>>>>>>
25623>>>>>>>>>    Function ComEnableAnimation Returns Boolean
25625>>>>>>>>>        Boolean retVal
25625>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to retVal
25626>>>>>>>>>        Function_Return retVal
25627>>>>>>>>>    End_Function
25628>>>>>>>>>
25628>>>>>>>>>    Procedure Set ComEnableAnimation Boolean value
25630>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 37 OLE_VT_BOOL to value
25631>>>>>>>>>    End_Procedure
25632>>>>>>>>>
25632>>>>>>>>>    Function ComShowGripper Returns Boolean
25634>>>>>>>>>        Boolean retVal
25634>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to retVal
25635>>>>>>>>>        Function_Return retVal
25636>>>>>>>>>    End_Function
25637>>>>>>>>>
25637>>>>>>>>>    Procedure Set ComShowGripper Boolean value
25639>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 38 OLE_VT_BOOL to value
25640>>>>>>>>>    End_Procedure
25641>>>>>>>>>
25641>>>>>>>>>    Function ComDefaultButtonStyle Returns XTPButtonStyle
25643>>>>>>>>>        XTPButtonStyle retVal
25643>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to retVal
25644>>>>>>>>>        Function_Return retVal
25645>>>>>>>>>    End_Function
25646>>>>>>>>>
25646>>>>>>>>>    Procedure Set ComDefaultButtonStyle XTPButtonStyle value
25648>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 39 OLE_VT_I4 to value
25649>>>>>>>>>    End_Procedure
25650>>>>>>>>>
25650>>>>>>>>>    Function ComCustomizable Returns Boolean
25652>>>>>>>>>        Boolean retVal
25652>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to retVal
25653>>>>>>>>>        Function_Return retVal
25654>>>>>>>>>    End_Function
25655>>>>>>>>>
25655>>>>>>>>>    Procedure Set ComCustomizable Boolean value
25657>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_BOOL to value
25658>>>>>>>>>    End_Procedure
25659>>>>>>>>>
25659>>>>>>>>>    Function ComShowTextBelowIcons Returns Boolean
25661>>>>>>>>>        Boolean retVal
25661>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to retVal
25662>>>>>>>>>        Function_Return retVal
25663>>>>>>>>>    End_Function
25664>>>>>>>>>
25664>>>>>>>>>    Procedure Set ComShowTextBelowIcons Boolean value
25666>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BOOL to value
25667>>>>>>>>>    End_Procedure
25668>>>>>>>>>
25668>>>>>>>>>    Function ComCustomControlKeyboardInteraction Returns Boolean
25670>>>>>>>>>        Boolean retVal
25670>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 302 OLE_VT_BOOL to retVal
25671>>>>>>>>>        Function_Return retVal
25672>>>>>>>>>    End_Function
25673>>>>>>>>>
25673>>>>>>>>>    Procedure Set ComCustomControlKeyboardInteraction Boolean value
25675>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 302 OLE_VT_BOOL to value
25676>>>>>>>>>    End_Procedure
25677>>>>>>>>>
25677>>>>>>>>>    Function ComSelectedControl Returns Variant
25679>>>>>>>>>        Variant retVal
25679>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to retVal
25680>>>>>>>>>        Function_Return retVal
25681>>>>>>>>>    End_Function
25682>>>>>>>>>
25682>>>>>>>>>    Procedure Set ComSelectedControl Variant value
25684>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 34 OLE_VT_DISPATCH to value
25685>>>>>>>>>    End_Procedure
25686>>>>>>>>>
25686>>>>>>>>>    Function ComType Returns XTPBarType
25688>>>>>>>>>        Handle hDispatchDriver
25688>>>>>>>>>        XTPBarType retVal
25688>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25689>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
25690>>>>>>>>>        Function_Return retVal
25691>>>>>>>>>    End_Function
25692>>>>>>>>>
25692>>>>>>>>>    Procedure ComEnableDocking XTPToolBarFlags lldwFlags
25694>>>>>>>>>        Handle hDispatchDriver
25694>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25695>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25696>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldwFlags
25697>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
25698>>>>>>>>>    End_Procedure
25699>>>>>>>>>
25699>>>>>>>>>    Function ComBuiltIn Returns Boolean
25701>>>>>>>>>        Handle hDispatchDriver
25701>>>>>>>>>        Boolean retVal
25701>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25702>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_BOOL to retVal
25703>>>>>>>>>        Function_Return retVal
25704>>>>>>>>>    End_Function
25705>>>>>>>>>
25705>>>>>>>>>    Procedure ComDelete
25707>>>>>>>>>        Handle hDispatchDriver
25707>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25708>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 14 OLE_VT_VOID
25709>>>>>>>>>    End_Procedure
25710>>>>>>>>>
25710>>>>>>>>>    Procedure ComGetWindowRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
25712>>>>>>>>>        Handle hDispatchDriver
25712>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25713>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
25714>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
25715>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
25716>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
25717>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
25718>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
25719>>>>>>>>>    End_Procedure
25720>>>>>>>>>
25720>>>>>>>>>    Function ComHWnd Returns OLE_HANDLE
25722>>>>>>>>>        Handle hDispatchDriver
25722>>>>>>>>>        OLE_HANDLE retVal
25722>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25723>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
25724>>>>>>>>>        Function_Return retVal
25725>>>>>>>>>    End_Function
25726>>>>>>>>>
25726>>>>>>>>>    Function ComCommandBars Returns Variant
25728>>>>>>>>>        Handle hDispatchDriver
25728>>>>>>>>>        Variant retVal
25728>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25729>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 45 OLE_VT_DISPATCH to retVal
25730>>>>>>>>>        Function_Return retVal
25731>>>>>>>>>    End_Function
25732>>>>>>>>>
25732>>>>>>>>>    Function ComControls Returns Variant
25734>>>>>>>>>        Handle hDispatchDriver
25734>>>>>>>>>        Variant retVal
25734>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25735>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
25736>>>>>>>>>        Function_Return retVal
25737>>>>>>>>>    End_Function
25738>>>>>>>>>
25738>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
25740>>>>>>>>>        Handle hDispatchDriver
25740>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25741>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
25742>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
25743>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
25744>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
25745>>>>>>>>>    End_Procedure
25746>>>>>>>>>
25746>>>>>>>>>    Function ComFindControl Variant llType Variant llId Variant llVisible Variant llRecursive Returns Variant
25748>>>>>>>>>        Handle hDispatchDriver
25748>>>>>>>>>        Variant retVal
25748>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25749>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
25750>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llType
25751>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llId
25752>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llVisible
25753>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
25754>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
25755>>>>>>>>>        Function_Return retVal
25756>>>>>>>>>    End_Function
25757>>>>>>>>>
25757>>>>>>>>>    Procedure ComSetFlags XTPMenuBarFlags llAdd XTPMenuBarFlags llRemove
25759>>>>>>>>>        Handle hDispatchDriver
25759>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25760>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
25761>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llAdd
25762>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llRemove
25763>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 18 OLE_VT_VOID
25764>>>>>>>>>    End_Procedure
25765>>>>>>>>>
25765>>>>>>>>>    Procedure ComRedrawBar
25767>>>>>>>>>        Handle hDispatchDriver
25767>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25768>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 31 OLE_VT_VOID
25769>>>>>>>>>    End_Procedure
25770>>>>>>>>>
25770>>>>>>>>>    Procedure ComRecalcLayout
25772>>>>>>>>>        Handle hDispatchDriver
25772>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25773>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 32 OLE_VT_VOID
25774>>>>>>>>>    End_Procedure
25775>>>>>>>>>
25775>>>>>>>>>    Procedure ComReset
25777>>>>>>>>>        Handle hDispatchDriver
25777>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25778>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 35 OLE_VT_VOID
25779>>>>>>>>>    End_Procedure
25780>>>>>>>>>
25780>>>>>>>>>    Function ComPopupContextMenu Variant llPopupBar Variant llFlags Variant llx Variant lly Returns Integer
25782>>>>>>>>>        Handle hDispatchDriver
25782>>>>>>>>>        Integer retVal
25782>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25783>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
25784>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llPopupBar
25785>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFlags
25786>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llx
25787>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT lly
25788>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_I4 to retVal
25789>>>>>>>>>        Function_Return retVal
25790>>>>>>>>>    End_Function
25791>>>>>>>>>
25791>>>>>>>>>    Function ComPopupMiniToolBar Variant llFlags Variant llx Variant lly Returns Integer
25793>>>>>>>>>        Handle hDispatchDriver
25793>>>>>>>>>        Integer retVal
25793>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25794>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
25795>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llFlags
25796>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llx
25797>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT lly
25798>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 106 OLE_VT_I4 to retVal
25799>>>>>>>>>        Function_Return retVal
25800>>>>>>>>>    End_Function
25801>>>>>>>>>End_Class
25802>>>>>>>>>
25802>>>>>>>>>// CLSID: {C6A3D51B-CBD0-4AF0-9D33-EB56AB0648D8}
25802>>>>>>>>>Class cCJRecentFileList is a cComAutomationObject
25803>>>>>>>>>
25803>>>>>>>>>    Function ComMaxSize Returns Integer
25805>>>>>>>>>        Integer retVal
25805>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
25806>>>>>>>>>        Function_Return retVal
25807>>>>>>>>>    End_Function
25808>>>>>>>>>
25808>>>>>>>>>    Procedure Set ComMaxSize Integer value
25810>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
25811>>>>>>>>>    End_Procedure
25812>>>>>>>>>
25812>>>>>>>>>    Function ComPinable Returns Boolean
25814>>>>>>>>>        Boolean retVal
25814>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
25815>>>>>>>>>        Function_Return retVal
25816>>>>>>>>>    End_Function
25817>>>>>>>>>
25817>>>>>>>>>    Procedure Set ComPinable Boolean value
25819>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
25820>>>>>>>>>    End_Procedure
25821>>>>>>>>>
25821>>>>>>>>>    Function Com_NewEnum Returns Variant
25823>>>>>>>>>        Handle hDispatchDriver
25823>>>>>>>>>        Variant retVal
25823>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25824>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
25825>>>>>>>>>        Function_Return retVal
25826>>>>>>>>>    End_Function
25827>>>>>>>>>
25827>>>>>>>>>    Function ComItem Integer llIndex Returns Variant
25829>>>>>>>>>        Handle hDispatchDriver
25829>>>>>>>>>        Variant retVal
25829>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25830>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25831>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
25832>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
25833>>>>>>>>>        Function_Return retVal
25834>>>>>>>>>    End_Function
25835>>>>>>>>>
25835>>>>>>>>>    Function ComAdd String llPathName Returns Variant
25837>>>>>>>>>        Handle hDispatchDriver
25837>>>>>>>>>        Variant retVal
25837>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25838>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25839>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPathName
25840>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
25841>>>>>>>>>        Function_Return retVal
25842>>>>>>>>>    End_Function
25843>>>>>>>>>
25843>>>>>>>>>    Function ComCount Returns Integer
25845>>>>>>>>>        Handle hDispatchDriver
25845>>>>>>>>>        Integer retVal
25845>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25846>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
25847>>>>>>>>>        Function_Return retVal
25848>>>>>>>>>    End_Function
25849>>>>>>>>>
25849>>>>>>>>>    Procedure ComRemove Integer llIndex
25851>>>>>>>>>        Handle hDispatchDriver
25851>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25852>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
25853>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
25854>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
25855>>>>>>>>>    End_Procedure
25856>>>>>>>>>End_Class
25857>>>>>>>>>
25857>>>>>>>>>// CLSID: {9113D51B-CBD0-4AF0-9D33-EB56AB0648D8}
25857>>>>>>>>>Class cCJRecentFileListItem is a cComAutomationObject
25858>>>>>>>>>
25858>>>>>>>>>    Function ComCaption Returns String
25860>>>>>>>>>        String retVal
25860>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
25861>>>>>>>>>        Function_Return retVal
25862>>>>>>>>>    End_Function
25863>>>>>>>>>
25863>>>>>>>>>    Procedure Set ComCaption String value
25865>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
25866>>>>>>>>>    End_Procedure
25867>>>>>>>>>
25867>>>>>>>>>    Function ComTag Returns String
25869>>>>>>>>>        String retVal
25869>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
25870>>>>>>>>>        Function_Return retVal
25871>>>>>>>>>    End_Function
25872>>>>>>>>>
25872>>>>>>>>>    Procedure Set ComTag String value
25874>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
25875>>>>>>>>>    End_Procedure
25876>>>>>>>>>
25876>>>>>>>>>    Function ComIconId Returns Integer
25878>>>>>>>>>        Integer retVal
25878>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to retVal
25879>>>>>>>>>        Function_Return retVal
25880>>>>>>>>>    End_Function
25881>>>>>>>>>
25881>>>>>>>>>    Procedure Set ComIconId Integer value
25883>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_I4 to value
25884>>>>>>>>>    End_Procedure
25885>>>>>>>>>
25885>>>>>>>>>    Function ComPinned Returns Boolean
25887>>>>>>>>>        Boolean retVal
25887>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to retVal
25888>>>>>>>>>        Function_Return retVal
25889>>>>>>>>>    End_Function
25890>>>>>>>>>
25890>>>>>>>>>    Procedure Set ComPinned Boolean value
25892>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BOOL to value
25893>>>>>>>>>    End_Procedure
25894>>>>>>>>>
25894>>>>>>>>>    Function ComPathName Returns String
25896>>>>>>>>>        Handle hDispatchDriver
25896>>>>>>>>>        String retVal
25896>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
25897>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_BSTR to retVal
25898>>>>>>>>>        Function_Return retVal
25899>>>>>>>>>    End_Function
25900>>>>>>>>>End_Class
25901>>>>>>>>>
25901>>>>>>>>>// CLSID: {71568A35-789A-40D9-B564-7577DA549319}
25901>>>>>>>>>Class cCJCommandBarSlider is a cComAutomationObject
25902>>>>>>>>>
25902>>>>>>>>>    Function ComChecked Returns Boolean
25904>>>>>>>>>        Boolean retVal
25904>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
25905>>>>>>>>>        Function_Return retVal
25906>>>>>>>>>    End_Function
25907>>>>>>>>>
25907>>>>>>>>>    Procedure Set ComChecked Boolean value
25909>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
25910>>>>>>>>>    End_Procedure
25911>>>>>>>>>
25911>>>>>>>>>    Function ComBeginGroup Returns Boolean
25913>>>>>>>>>        Boolean retVal
25913>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
25914>>>>>>>>>        Function_Return retVal
25915>>>>>>>>>    End_Function
25916>>>>>>>>>
25916>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
25918>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
25919>>>>>>>>>    End_Procedure
25920>>>>>>>>>
25920>>>>>>>>>    Function ComCaption Returns String
25922>>>>>>>>>        String retVal
25922>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
25923>>>>>>>>>        Function_Return retVal
25924>>>>>>>>>    End_Function
25925>>>>>>>>>
25925>>>>>>>>>    Procedure Set ComCaption String value
25927>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
25928>>>>>>>>>    End_Procedure
25929>>>>>>>>>
25929>>>>>>>>>    Function ComDescriptionText Returns String
25931>>>>>>>>>        String retVal
25931>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
25932>>>>>>>>>        Function_Return retVal
25933>>>>>>>>>    End_Function
25934>>>>>>>>>
25934>>>>>>>>>    Procedure Set ComDescriptionText String value
25936>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
25937>>>>>>>>>    End_Procedure
25938>>>>>>>>>
25938>>>>>>>>>    Function ComId Returns Integer
25940>>>>>>>>>        Integer retVal
25940>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
25941>>>>>>>>>        Function_Return retVal
25942>>>>>>>>>    End_Function
25943>>>>>>>>>
25943>>>>>>>>>    Procedure Set ComId Integer value
25945>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
25946>>>>>>>>>    End_Procedure
25947>>>>>>>>>
25947>>>>>>>>>    Function ComParameter Returns String
25949>>>>>>>>>        String retVal
25949>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
25950>>>>>>>>>        Function_Return retVal
25951>>>>>>>>>    End_Function
25952>>>>>>>>>
25952>>>>>>>>>    Procedure Set ComParameter String value
25954>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
25955>>>>>>>>>    End_Procedure
25956>>>>>>>>>
25956>>>>>>>>>    Function ComShortcutText Returns String
25958>>>>>>>>>        String retVal
25958>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
25959>>>>>>>>>        Function_Return retVal
25960>>>>>>>>>    End_Function
25961>>>>>>>>>
25961>>>>>>>>>    Procedure Set ComShortcutText String value
25963>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
25964>>>>>>>>>    End_Procedure
25965>>>>>>>>>
25965>>>>>>>>>    Function ComCustomShortcutText Returns String
25967>>>>>>>>>        String retVal
25967>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
25968>>>>>>>>>        Function_Return retVal
25969>>>>>>>>>    End_Function
25970>>>>>>>>>
25970>>>>>>>>>    Procedure Set ComCustomShortcutText String value
25972>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
25973>>>>>>>>>    End_Procedure
25974>>>>>>>>>
25974>>>>>>>>>    Function ComTooltipText Returns String
25976>>>>>>>>>        String retVal
25976>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
25977>>>>>>>>>        Function_Return retVal
25978>>>>>>>>>    End_Function
25979>>>>>>>>>
25979>>>>>>>>>    Procedure Set ComTooltipText String value
25981>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
25982>>>>>>>>>    End_Procedure
25983>>>>>>>>>
25983>>>>>>>>>    Function ComVisible Returns Boolean
25985>>>>>>>>>        Boolean retVal
25985>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
25986>>>>>>>>>        Function_Return retVal
25987>>>>>>>>>    End_Function
25988>>>>>>>>>
25988>>>>>>>>>    Procedure Set ComVisible Boolean value
25990>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
25991>>>>>>>>>    End_Procedure
25992>>>>>>>>>
25992>>>>>>>>>    Function ComEnabled Returns Boolean
25994>>>>>>>>>        Boolean retVal
25994>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
25995>>>>>>>>>        Function_Return retVal
25996>>>>>>>>>    End_Function
25997>>>>>>>>>
25997>>>>>>>>>    Procedure Set ComEnabled Boolean value
25999>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
26000>>>>>>>>>    End_Procedure
26001>>>>>>>>>
26001>>>>>>>>>    Function ComIconId Returns Integer
26003>>>>>>>>>        Integer retVal
26003>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
26004>>>>>>>>>        Function_Return retVal
26005>>>>>>>>>    End_Function
26006>>>>>>>>>
26006>>>>>>>>>    Procedure Set ComIconId Integer value
26008>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
26009>>>>>>>>>    End_Procedure
26010>>>>>>>>>
26010>>>>>>>>>    Function ComDefaultItem Returns Boolean
26012>>>>>>>>>        Boolean retVal
26012>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
26013>>>>>>>>>        Function_Return retVal
26014>>>>>>>>>    End_Function
26015>>>>>>>>>
26015>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
26017>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
26018>>>>>>>>>    End_Procedure
26019>>>>>>>>>
26019>>>>>>>>>    Function ComFlags Returns XTPControlFlags
26021>>>>>>>>>        XTPControlFlags retVal
26021>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
26022>>>>>>>>>        Function_Return retVal
26023>>>>>>>>>    End_Function
26024>>>>>>>>>
26024>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
26026>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
26027>>>>>>>>>    End_Procedure
26028>>>>>>>>>
26028>>>>>>>>>    Function ComCategory Returns String
26030>>>>>>>>>        String retVal
26030>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
26031>>>>>>>>>        Function_Return retVal
26032>>>>>>>>>    End_Function
26033>>>>>>>>>
26033>>>>>>>>>    Procedure Set ComCategory String value
26035>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
26036>>>>>>>>>    End_Procedure
26037>>>>>>>>>
26037>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
26039>>>>>>>>>        XTPControlHideFlags retVal
26039>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
26040>>>>>>>>>        Function_Return retVal
26041>>>>>>>>>    End_Function
26042>>>>>>>>>
26042>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
26044>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
26045>>>>>>>>>    End_Procedure
26046>>>>>>>>>
26046>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
26048>>>>>>>>>        Boolean retVal
26048>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
26049>>>>>>>>>        Function_Return retVal
26050>>>>>>>>>    End_Function
26051>>>>>>>>>
26051>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
26053>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
26054>>>>>>>>>    End_Procedure
26055>>>>>>>>>
26055>>>>>>>>>    Function ComAction Returns Variant
26057>>>>>>>>>        Variant retVal
26057>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
26058>>>>>>>>>        Function_Return retVal
26059>>>>>>>>>    End_Function
26060>>>>>>>>>
26060>>>>>>>>>    Procedure Set ComAction Variant value
26062>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
26063>>>>>>>>>    End_Procedure
26064>>>>>>>>>
26064>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
26066>>>>>>>>>        Integer retVal
26066>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
26067>>>>>>>>>        Function_Return retVal
26068>>>>>>>>>    End_Function
26069>>>>>>>>>
26069>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
26071>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
26072>>>>>>>>>    End_Procedure
26073>>>>>>>>>
26073>>>>>>>>>    Function ComWidth Returns Integer
26075>>>>>>>>>        Integer retVal
26075>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
26076>>>>>>>>>        Function_Return retVal
26077>>>>>>>>>    End_Function
26078>>>>>>>>>
26078>>>>>>>>>    Procedure Set ComWidth Integer value
26080>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
26081>>>>>>>>>    End_Procedure
26082>>>>>>>>>
26082>>>>>>>>>    Function ComHeight Returns Integer
26084>>>>>>>>>        Integer retVal
26084>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
26085>>>>>>>>>        Function_Return retVal
26086>>>>>>>>>    End_Function
26087>>>>>>>>>
26087>>>>>>>>>    Procedure Set ComHeight Integer value
26089>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
26090>>>>>>>>>    End_Procedure
26091>>>>>>>>>
26091>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
26093>>>>>>>>>        XTPButtonStyle retVal
26093>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
26094>>>>>>>>>        Function_Return retVal
26095>>>>>>>>>    End_Function
26096>>>>>>>>>
26096>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
26098>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
26099>>>>>>>>>    End_Procedure
26100>>>>>>>>>
26100>>>>>>>>>    Function ComKeyboardTip Returns String
26102>>>>>>>>>        String retVal
26102>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
26103>>>>>>>>>        Function_Return retVal
26104>>>>>>>>>    End_Function
26105>>>>>>>>>
26105>>>>>>>>>    Procedure Set ComKeyboardTip String value
26107>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
26108>>>>>>>>>    End_Procedure
26109>>>>>>>>>
26109>>>>>>>>>    Function ComPos Returns Integer
26111>>>>>>>>>        Integer retVal
26111>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to retVal
26112>>>>>>>>>        Function_Return retVal
26113>>>>>>>>>    End_Function
26114>>>>>>>>>
26114>>>>>>>>>    Procedure Set ComPos Integer value
26116>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to value
26117>>>>>>>>>    End_Procedure
26118>>>>>>>>>
26118>>>>>>>>>    Function ComMin Returns Integer
26120>>>>>>>>>        Integer retVal
26120>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to retVal
26121>>>>>>>>>        Function_Return retVal
26122>>>>>>>>>    End_Function
26123>>>>>>>>>
26123>>>>>>>>>    Procedure Set ComMin Integer value
26125>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to value
26126>>>>>>>>>    End_Procedure
26127>>>>>>>>>
26127>>>>>>>>>    Function ComMax Returns Integer
26129>>>>>>>>>        Integer retVal
26129>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to retVal
26130>>>>>>>>>        Function_Return retVal
26131>>>>>>>>>    End_Function
26132>>>>>>>>>
26132>>>>>>>>>    Procedure Set ComMax Integer value
26134>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to value
26135>>>>>>>>>    End_Procedure
26136>>>>>>>>>
26136>>>>>>>>>    Function ComControls Returns Variant
26138>>>>>>>>>        Handle hDispatchDriver
26138>>>>>>>>>        Variant retVal
26138>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26139>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
26140>>>>>>>>>        Function_Return retVal
26141>>>>>>>>>    End_Function
26142>>>>>>>>>
26142>>>>>>>>>    Function ComParent Returns Variant
26144>>>>>>>>>        Handle hDispatchDriver
26144>>>>>>>>>        Variant retVal
26144>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26145>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
26146>>>>>>>>>        Function_Return retVal
26147>>>>>>>>>    End_Function
26148>>>>>>>>>
26148>>>>>>>>>    Function ComIndex Returns Integer
26150>>>>>>>>>        Handle hDispatchDriver
26150>>>>>>>>>        Integer retVal
26150>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26151>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
26152>>>>>>>>>        Function_Return retVal
26153>>>>>>>>>    End_Function
26154>>>>>>>>>
26154>>>>>>>>>    Function ComType Returns XTPControlType
26156>>>>>>>>>        Handle hDispatchDriver
26156>>>>>>>>>        XTPControlType retVal
26156>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26157>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
26158>>>>>>>>>        Function_Return retVal
26159>>>>>>>>>    End_Function
26160>>>>>>>>>
26160>>>>>>>>>    Procedure ComDelete
26162>>>>>>>>>        Handle hDispatchDriver
26162>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26163>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
26164>>>>>>>>>    End_Procedure
26165>>>>>>>>>
26165>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
26167>>>>>>>>>        Handle hDispatchDriver
26167>>>>>>>>>        Variant retVal
26167>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26168>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26169>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
26170>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
26171>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
26172>>>>>>>>>        Function_Return retVal
26173>>>>>>>>>    End_Function
26174>>>>>>>>>
26174>>>>>>>>>    Procedure ComSetFocus
26176>>>>>>>>>        Handle hDispatchDriver
26176>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26177>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
26178>>>>>>>>>    End_Procedure
26179>>>>>>>>>
26179>>>>>>>>>    Procedure ComExecute
26181>>>>>>>>>        Handle hDispatchDriver
26181>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26182>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
26183>>>>>>>>>    End_Procedure
26184>>>>>>>>>
26184>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
26186>>>>>>>>>        Handle hDispatchDriver
26186>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26187>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
26188>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
26189>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
26190>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
26191>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
26192>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
26193>>>>>>>>>    End_Procedure
26194>>>>>>>>>
26194>>>>>>>>>    Function ComRibbonGroup Returns Variant
26196>>>>>>>>>        Handle hDispatchDriver
26196>>>>>>>>>        Variant retVal
26196>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26197>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
26198>>>>>>>>>        Function_Return retVal
26199>>>>>>>>>    End_Function
26200>>>>>>>>>
26200>>>>>>>>>    Procedure ComReset
26202>>>>>>>>>        Handle hDispatchDriver
26202>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26203>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
26204>>>>>>>>>    End_Procedure
26205>>>>>>>>>
26205>>>>>>>>>    Function ComTop Returns Integer
26207>>>>>>>>>        Handle hDispatchDriver
26207>>>>>>>>>        Integer retVal
26207>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26208>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
26209>>>>>>>>>        Function_Return retVal
26210>>>>>>>>>    End_Function
26211>>>>>>>>>
26211>>>>>>>>>    Function ComLeft Returns Integer
26213>>>>>>>>>        Handle hDispatchDriver
26213>>>>>>>>>        Integer retVal
26213>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26214>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
26215>>>>>>>>>        Function_Return retVal
26216>>>>>>>>>    End_Function
26217>>>>>>>>>
26217>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
26219>>>>>>>>>        Handle hDispatchDriver
26219>>>>>>>>>        Variant retVal
26219>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26220>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
26221>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
26222>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
26223>>>>>>>>>        Function_Return retVal
26224>>>>>>>>>    End_Function
26225>>>>>>>>>
26225>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
26227>>>>>>>>>        Handle hDispatchDriver
26227>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26228>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26229>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
26230>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
26231>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
26232>>>>>>>>>    End_Procedure
26233>>>>>>>>>End_Class
26234>>>>>>>>>
26234>>>>>>>>>// CLSID: {79968A35-789A-40D9-B564-7577DA549319}
26234>>>>>>>>>Class cCJCommandBarProgress is a cComAutomationObject
26235>>>>>>>>>
26235>>>>>>>>>    Function ComChecked Returns Boolean
26237>>>>>>>>>        Boolean retVal
26237>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
26238>>>>>>>>>        Function_Return retVal
26239>>>>>>>>>    End_Function
26240>>>>>>>>>
26240>>>>>>>>>    Procedure Set ComChecked Boolean value
26242>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
26243>>>>>>>>>    End_Procedure
26244>>>>>>>>>
26244>>>>>>>>>    Function ComBeginGroup Returns Boolean
26246>>>>>>>>>        Boolean retVal
26246>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
26247>>>>>>>>>        Function_Return retVal
26248>>>>>>>>>    End_Function
26249>>>>>>>>>
26249>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
26251>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
26252>>>>>>>>>    End_Procedure
26253>>>>>>>>>
26253>>>>>>>>>    Function ComCaption Returns String
26255>>>>>>>>>        String retVal
26255>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
26256>>>>>>>>>        Function_Return retVal
26257>>>>>>>>>    End_Function
26258>>>>>>>>>
26258>>>>>>>>>    Procedure Set ComCaption String value
26260>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
26261>>>>>>>>>    End_Procedure
26262>>>>>>>>>
26262>>>>>>>>>    Function ComDescriptionText Returns String
26264>>>>>>>>>        String retVal
26264>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
26265>>>>>>>>>        Function_Return retVal
26266>>>>>>>>>    End_Function
26267>>>>>>>>>
26267>>>>>>>>>    Procedure Set ComDescriptionText String value
26269>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
26270>>>>>>>>>    End_Procedure
26271>>>>>>>>>
26271>>>>>>>>>    Function ComId Returns Integer
26273>>>>>>>>>        Integer retVal
26273>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
26274>>>>>>>>>        Function_Return retVal
26275>>>>>>>>>    End_Function
26276>>>>>>>>>
26276>>>>>>>>>    Procedure Set ComId Integer value
26278>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
26279>>>>>>>>>    End_Procedure
26280>>>>>>>>>
26280>>>>>>>>>    Function ComParameter Returns String
26282>>>>>>>>>        String retVal
26282>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
26283>>>>>>>>>        Function_Return retVal
26284>>>>>>>>>    End_Function
26285>>>>>>>>>
26285>>>>>>>>>    Procedure Set ComParameter String value
26287>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
26288>>>>>>>>>    End_Procedure
26289>>>>>>>>>
26289>>>>>>>>>    Function ComShortcutText Returns String
26291>>>>>>>>>        String retVal
26291>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
26292>>>>>>>>>        Function_Return retVal
26293>>>>>>>>>    End_Function
26294>>>>>>>>>
26294>>>>>>>>>    Procedure Set ComShortcutText String value
26296>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
26297>>>>>>>>>    End_Procedure
26298>>>>>>>>>
26298>>>>>>>>>    Function ComCustomShortcutText Returns String
26300>>>>>>>>>        String retVal
26300>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
26301>>>>>>>>>        Function_Return retVal
26302>>>>>>>>>    End_Function
26303>>>>>>>>>
26303>>>>>>>>>    Procedure Set ComCustomShortcutText String value
26305>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
26306>>>>>>>>>    End_Procedure
26307>>>>>>>>>
26307>>>>>>>>>    Function ComTooltipText Returns String
26309>>>>>>>>>        String retVal
26309>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
26310>>>>>>>>>        Function_Return retVal
26311>>>>>>>>>    End_Function
26312>>>>>>>>>
26312>>>>>>>>>    Procedure Set ComTooltipText String value
26314>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
26315>>>>>>>>>    End_Procedure
26316>>>>>>>>>
26316>>>>>>>>>    Function ComVisible Returns Boolean
26318>>>>>>>>>        Boolean retVal
26318>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
26319>>>>>>>>>        Function_Return retVal
26320>>>>>>>>>    End_Function
26321>>>>>>>>>
26321>>>>>>>>>    Procedure Set ComVisible Boolean value
26323>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
26324>>>>>>>>>    End_Procedure
26325>>>>>>>>>
26325>>>>>>>>>    Function ComEnabled Returns Boolean
26327>>>>>>>>>        Boolean retVal
26327>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
26328>>>>>>>>>        Function_Return retVal
26329>>>>>>>>>    End_Function
26330>>>>>>>>>
26330>>>>>>>>>    Procedure Set ComEnabled Boolean value
26332>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
26333>>>>>>>>>    End_Procedure
26334>>>>>>>>>
26334>>>>>>>>>    Function ComIconId Returns Integer
26336>>>>>>>>>        Integer retVal
26336>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
26337>>>>>>>>>        Function_Return retVal
26338>>>>>>>>>    End_Function
26339>>>>>>>>>
26339>>>>>>>>>    Procedure Set ComIconId Integer value
26341>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
26342>>>>>>>>>    End_Procedure
26343>>>>>>>>>
26343>>>>>>>>>    Function ComDefaultItem Returns Boolean
26345>>>>>>>>>        Boolean retVal
26345>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
26346>>>>>>>>>        Function_Return retVal
26347>>>>>>>>>    End_Function
26348>>>>>>>>>
26348>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
26350>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
26351>>>>>>>>>    End_Procedure
26352>>>>>>>>>
26352>>>>>>>>>    Function ComFlags Returns XTPControlFlags
26354>>>>>>>>>        XTPControlFlags retVal
26354>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
26355>>>>>>>>>        Function_Return retVal
26356>>>>>>>>>    End_Function
26357>>>>>>>>>
26357>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
26359>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
26360>>>>>>>>>    End_Procedure
26361>>>>>>>>>
26361>>>>>>>>>    Function ComCategory Returns String
26363>>>>>>>>>        String retVal
26363>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
26364>>>>>>>>>        Function_Return retVal
26365>>>>>>>>>    End_Function
26366>>>>>>>>>
26366>>>>>>>>>    Procedure Set ComCategory String value
26368>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
26369>>>>>>>>>    End_Procedure
26370>>>>>>>>>
26370>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
26372>>>>>>>>>        XTPControlHideFlags retVal
26372>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
26373>>>>>>>>>        Function_Return retVal
26374>>>>>>>>>    End_Function
26375>>>>>>>>>
26375>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
26377>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
26378>>>>>>>>>    End_Procedure
26379>>>>>>>>>
26379>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
26381>>>>>>>>>        Boolean retVal
26381>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
26382>>>>>>>>>        Function_Return retVal
26383>>>>>>>>>    End_Function
26384>>>>>>>>>
26384>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
26386>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
26387>>>>>>>>>    End_Procedure
26388>>>>>>>>>
26388>>>>>>>>>    Function ComAction Returns Variant
26390>>>>>>>>>        Variant retVal
26390>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
26391>>>>>>>>>        Function_Return retVal
26392>>>>>>>>>    End_Function
26393>>>>>>>>>
26393>>>>>>>>>    Procedure Set ComAction Variant value
26395>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
26396>>>>>>>>>    End_Procedure
26397>>>>>>>>>
26397>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
26399>>>>>>>>>        Integer retVal
26399>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
26400>>>>>>>>>        Function_Return retVal
26401>>>>>>>>>    End_Function
26402>>>>>>>>>
26402>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
26404>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
26405>>>>>>>>>    End_Procedure
26406>>>>>>>>>
26406>>>>>>>>>    Function ComWidth Returns Integer
26408>>>>>>>>>        Integer retVal
26408>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
26409>>>>>>>>>        Function_Return retVal
26410>>>>>>>>>    End_Function
26411>>>>>>>>>
26411>>>>>>>>>    Procedure Set ComWidth Integer value
26413>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
26414>>>>>>>>>    End_Procedure
26415>>>>>>>>>
26415>>>>>>>>>    Function ComHeight Returns Integer
26417>>>>>>>>>        Integer retVal
26417>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
26418>>>>>>>>>        Function_Return retVal
26419>>>>>>>>>    End_Function
26420>>>>>>>>>
26420>>>>>>>>>    Procedure Set ComHeight Integer value
26422>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
26423>>>>>>>>>    End_Procedure
26424>>>>>>>>>
26424>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
26426>>>>>>>>>        XTPButtonStyle retVal
26426>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
26427>>>>>>>>>        Function_Return retVal
26428>>>>>>>>>    End_Function
26429>>>>>>>>>
26429>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
26431>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
26432>>>>>>>>>    End_Procedure
26433>>>>>>>>>
26433>>>>>>>>>    Function ComKeyboardTip Returns String
26435>>>>>>>>>        String retVal
26435>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
26436>>>>>>>>>        Function_Return retVal
26437>>>>>>>>>    End_Function
26438>>>>>>>>>
26438>>>>>>>>>    Procedure Set ComKeyboardTip String value
26440>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
26441>>>>>>>>>    End_Procedure
26442>>>>>>>>>
26442>>>>>>>>>    Function ComPos Returns Integer
26444>>>>>>>>>        Integer retVal
26444>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to retVal
26445>>>>>>>>>        Function_Return retVal
26446>>>>>>>>>    End_Function
26447>>>>>>>>>
26447>>>>>>>>>    Procedure Set ComPos Integer value
26449>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to value
26450>>>>>>>>>    End_Procedure
26451>>>>>>>>>
26451>>>>>>>>>    Function ComMin Returns Integer
26453>>>>>>>>>        Integer retVal
26453>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to retVal
26454>>>>>>>>>        Function_Return retVal
26455>>>>>>>>>    End_Function
26456>>>>>>>>>
26456>>>>>>>>>    Procedure Set ComMin Integer value
26458>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to value
26459>>>>>>>>>    End_Procedure
26460>>>>>>>>>
26460>>>>>>>>>    Function ComMax Returns Integer
26462>>>>>>>>>        Integer retVal
26462>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to retVal
26463>>>>>>>>>        Function_Return retVal
26464>>>>>>>>>    End_Function
26465>>>>>>>>>
26465>>>>>>>>>    Procedure Set ComMax Integer value
26467>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to value
26468>>>>>>>>>    End_Procedure
26469>>>>>>>>>
26469>>>>>>>>>    Function ComControls Returns Variant
26471>>>>>>>>>        Handle hDispatchDriver
26471>>>>>>>>>        Variant retVal
26471>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26472>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
26473>>>>>>>>>        Function_Return retVal
26474>>>>>>>>>    End_Function
26475>>>>>>>>>
26475>>>>>>>>>    Function ComParent Returns Variant
26477>>>>>>>>>        Handle hDispatchDriver
26477>>>>>>>>>        Variant retVal
26477>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26478>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
26479>>>>>>>>>        Function_Return retVal
26480>>>>>>>>>    End_Function
26481>>>>>>>>>
26481>>>>>>>>>    Function ComIndex Returns Integer
26483>>>>>>>>>        Handle hDispatchDriver
26483>>>>>>>>>        Integer retVal
26483>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26484>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
26485>>>>>>>>>        Function_Return retVal
26486>>>>>>>>>    End_Function
26487>>>>>>>>>
26487>>>>>>>>>    Function ComType Returns XTPControlType
26489>>>>>>>>>        Handle hDispatchDriver
26489>>>>>>>>>        XTPControlType retVal
26489>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26490>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
26491>>>>>>>>>        Function_Return retVal
26492>>>>>>>>>    End_Function
26493>>>>>>>>>
26493>>>>>>>>>    Procedure ComDelete
26495>>>>>>>>>        Handle hDispatchDriver
26495>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26496>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
26497>>>>>>>>>    End_Procedure
26498>>>>>>>>>
26498>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
26500>>>>>>>>>        Handle hDispatchDriver
26500>>>>>>>>>        Variant retVal
26500>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26501>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26502>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
26503>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
26504>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
26505>>>>>>>>>        Function_Return retVal
26506>>>>>>>>>    End_Function
26507>>>>>>>>>
26507>>>>>>>>>    Procedure ComSetFocus
26509>>>>>>>>>        Handle hDispatchDriver
26509>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26510>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
26511>>>>>>>>>    End_Procedure
26512>>>>>>>>>
26512>>>>>>>>>    Procedure ComExecute
26514>>>>>>>>>        Handle hDispatchDriver
26514>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26515>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
26516>>>>>>>>>    End_Procedure
26517>>>>>>>>>
26517>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
26519>>>>>>>>>        Handle hDispatchDriver
26519>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26520>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
26521>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
26522>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
26523>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
26524>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
26525>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
26526>>>>>>>>>    End_Procedure
26527>>>>>>>>>
26527>>>>>>>>>    Function ComRibbonGroup Returns Variant
26529>>>>>>>>>        Handle hDispatchDriver
26529>>>>>>>>>        Variant retVal
26529>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26530>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
26531>>>>>>>>>        Function_Return retVal
26532>>>>>>>>>    End_Function
26533>>>>>>>>>
26533>>>>>>>>>    Procedure ComReset
26535>>>>>>>>>        Handle hDispatchDriver
26535>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26536>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
26537>>>>>>>>>    End_Procedure
26538>>>>>>>>>
26538>>>>>>>>>    Function ComTop Returns Integer
26540>>>>>>>>>        Handle hDispatchDriver
26540>>>>>>>>>        Integer retVal
26540>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26541>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
26542>>>>>>>>>        Function_Return retVal
26543>>>>>>>>>    End_Function
26544>>>>>>>>>
26544>>>>>>>>>    Function ComLeft Returns Integer
26546>>>>>>>>>        Handle hDispatchDriver
26546>>>>>>>>>        Integer retVal
26546>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26547>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
26548>>>>>>>>>        Function_Return retVal
26549>>>>>>>>>    End_Function
26550>>>>>>>>>
26550>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
26552>>>>>>>>>        Handle hDispatchDriver
26552>>>>>>>>>        Variant retVal
26552>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26553>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
26554>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
26555>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
26556>>>>>>>>>        Function_Return retVal
26557>>>>>>>>>    End_Function
26558>>>>>>>>>
26558>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
26560>>>>>>>>>        Handle hDispatchDriver
26560>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26561>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26562>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
26563>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
26564>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
26565>>>>>>>>>    End_Procedure
26566>>>>>>>>>End_Class
26567>>>>>>>>>
26567>>>>>>>>>// CLSID: {72568A35-789A-40D9-B564-7577DA549319}
26567>>>>>>>>>Class cCJCommandBarScrollBar is a cComAutomationObject
26568>>>>>>>>>
26568>>>>>>>>>    Function ComChecked Returns Boolean
26570>>>>>>>>>        Boolean retVal
26570>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
26571>>>>>>>>>        Function_Return retVal
26572>>>>>>>>>    End_Function
26573>>>>>>>>>
26573>>>>>>>>>    Procedure Set ComChecked Boolean value
26575>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
26576>>>>>>>>>    End_Procedure
26577>>>>>>>>>
26577>>>>>>>>>    Function ComBeginGroup Returns Boolean
26579>>>>>>>>>        Boolean retVal
26579>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
26580>>>>>>>>>        Function_Return retVal
26581>>>>>>>>>    End_Function
26582>>>>>>>>>
26582>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
26584>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
26585>>>>>>>>>    End_Procedure
26586>>>>>>>>>
26586>>>>>>>>>    Function ComCaption Returns String
26588>>>>>>>>>        String retVal
26588>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
26589>>>>>>>>>        Function_Return retVal
26590>>>>>>>>>    End_Function
26591>>>>>>>>>
26591>>>>>>>>>    Procedure Set ComCaption String value
26593>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
26594>>>>>>>>>    End_Procedure
26595>>>>>>>>>
26595>>>>>>>>>    Function ComDescriptionText Returns String
26597>>>>>>>>>        String retVal
26597>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
26598>>>>>>>>>        Function_Return retVal
26599>>>>>>>>>    End_Function
26600>>>>>>>>>
26600>>>>>>>>>    Procedure Set ComDescriptionText String value
26602>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
26603>>>>>>>>>    End_Procedure
26604>>>>>>>>>
26604>>>>>>>>>    Function ComId Returns Integer
26606>>>>>>>>>        Integer retVal
26606>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
26607>>>>>>>>>        Function_Return retVal
26608>>>>>>>>>    End_Function
26609>>>>>>>>>
26609>>>>>>>>>    Procedure Set ComId Integer value
26611>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
26612>>>>>>>>>    End_Procedure
26613>>>>>>>>>
26613>>>>>>>>>    Function ComParameter Returns String
26615>>>>>>>>>        String retVal
26615>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
26616>>>>>>>>>        Function_Return retVal
26617>>>>>>>>>    End_Function
26618>>>>>>>>>
26618>>>>>>>>>    Procedure Set ComParameter String value
26620>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
26621>>>>>>>>>    End_Procedure
26622>>>>>>>>>
26622>>>>>>>>>    Function ComShortcutText Returns String
26624>>>>>>>>>        String retVal
26624>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
26625>>>>>>>>>        Function_Return retVal
26626>>>>>>>>>    End_Function
26627>>>>>>>>>
26627>>>>>>>>>    Procedure Set ComShortcutText String value
26629>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
26630>>>>>>>>>    End_Procedure
26631>>>>>>>>>
26631>>>>>>>>>    Function ComCustomShortcutText Returns String
26633>>>>>>>>>        String retVal
26633>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
26634>>>>>>>>>        Function_Return retVal
26635>>>>>>>>>    End_Function
26636>>>>>>>>>
26636>>>>>>>>>    Procedure Set ComCustomShortcutText String value
26638>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
26639>>>>>>>>>    End_Procedure
26640>>>>>>>>>
26640>>>>>>>>>    Function ComTooltipText Returns String
26642>>>>>>>>>        String retVal
26642>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
26643>>>>>>>>>        Function_Return retVal
26644>>>>>>>>>    End_Function
26645>>>>>>>>>
26645>>>>>>>>>    Procedure Set ComTooltipText String value
26647>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
26648>>>>>>>>>    End_Procedure
26649>>>>>>>>>
26649>>>>>>>>>    Function ComVisible Returns Boolean
26651>>>>>>>>>        Boolean retVal
26651>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
26652>>>>>>>>>        Function_Return retVal
26653>>>>>>>>>    End_Function
26654>>>>>>>>>
26654>>>>>>>>>    Procedure Set ComVisible Boolean value
26656>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
26657>>>>>>>>>    End_Procedure
26658>>>>>>>>>
26658>>>>>>>>>    Function ComEnabled Returns Boolean
26660>>>>>>>>>        Boolean retVal
26660>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
26661>>>>>>>>>        Function_Return retVal
26662>>>>>>>>>    End_Function
26663>>>>>>>>>
26663>>>>>>>>>    Procedure Set ComEnabled Boolean value
26665>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
26666>>>>>>>>>    End_Procedure
26667>>>>>>>>>
26667>>>>>>>>>    Function ComIconId Returns Integer
26669>>>>>>>>>        Integer retVal
26669>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
26670>>>>>>>>>        Function_Return retVal
26671>>>>>>>>>    End_Function
26672>>>>>>>>>
26672>>>>>>>>>    Procedure Set ComIconId Integer value
26674>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
26675>>>>>>>>>    End_Procedure
26676>>>>>>>>>
26676>>>>>>>>>    Function ComDefaultItem Returns Boolean
26678>>>>>>>>>        Boolean retVal
26678>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
26679>>>>>>>>>        Function_Return retVal
26680>>>>>>>>>    End_Function
26681>>>>>>>>>
26681>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
26683>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
26684>>>>>>>>>    End_Procedure
26685>>>>>>>>>
26685>>>>>>>>>    Function ComFlags Returns XTPControlFlags
26687>>>>>>>>>        XTPControlFlags retVal
26687>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
26688>>>>>>>>>        Function_Return retVal
26689>>>>>>>>>    End_Function
26690>>>>>>>>>
26690>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
26692>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
26693>>>>>>>>>    End_Procedure
26694>>>>>>>>>
26694>>>>>>>>>    Function ComCategory Returns String
26696>>>>>>>>>        String retVal
26696>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
26697>>>>>>>>>        Function_Return retVal
26698>>>>>>>>>    End_Function
26699>>>>>>>>>
26699>>>>>>>>>    Procedure Set ComCategory String value
26701>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
26702>>>>>>>>>    End_Procedure
26703>>>>>>>>>
26703>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
26705>>>>>>>>>        XTPControlHideFlags retVal
26705>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
26706>>>>>>>>>        Function_Return retVal
26707>>>>>>>>>    End_Function
26708>>>>>>>>>
26708>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
26710>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
26711>>>>>>>>>    End_Procedure
26712>>>>>>>>>
26712>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
26714>>>>>>>>>        Boolean retVal
26714>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
26715>>>>>>>>>        Function_Return retVal
26716>>>>>>>>>    End_Function
26717>>>>>>>>>
26717>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
26719>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
26720>>>>>>>>>    End_Procedure
26721>>>>>>>>>
26721>>>>>>>>>    Function ComAction Returns Variant
26723>>>>>>>>>        Variant retVal
26723>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
26724>>>>>>>>>        Function_Return retVal
26725>>>>>>>>>    End_Function
26726>>>>>>>>>
26726>>>>>>>>>    Procedure Set ComAction Variant value
26728>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
26729>>>>>>>>>    End_Procedure
26730>>>>>>>>>
26730>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
26732>>>>>>>>>        Integer retVal
26732>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
26733>>>>>>>>>        Function_Return retVal
26734>>>>>>>>>    End_Function
26735>>>>>>>>>
26735>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
26737>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
26738>>>>>>>>>    End_Procedure
26739>>>>>>>>>
26739>>>>>>>>>    Function ComWidth Returns Integer
26741>>>>>>>>>        Integer retVal
26741>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
26742>>>>>>>>>        Function_Return retVal
26743>>>>>>>>>    End_Function
26744>>>>>>>>>
26744>>>>>>>>>    Procedure Set ComWidth Integer value
26746>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
26747>>>>>>>>>    End_Procedure
26748>>>>>>>>>
26748>>>>>>>>>    Function ComHeight Returns Integer
26750>>>>>>>>>        Integer retVal
26750>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
26751>>>>>>>>>        Function_Return retVal
26752>>>>>>>>>    End_Function
26753>>>>>>>>>
26753>>>>>>>>>    Procedure Set ComHeight Integer value
26755>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
26756>>>>>>>>>    End_Procedure
26757>>>>>>>>>
26757>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
26759>>>>>>>>>        XTPButtonStyle retVal
26759>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
26760>>>>>>>>>        Function_Return retVal
26761>>>>>>>>>    End_Function
26762>>>>>>>>>
26762>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
26764>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
26765>>>>>>>>>    End_Procedure
26766>>>>>>>>>
26766>>>>>>>>>    Function ComKeyboardTip Returns String
26768>>>>>>>>>        String retVal
26768>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
26769>>>>>>>>>        Function_Return retVal
26770>>>>>>>>>    End_Function
26771>>>>>>>>>
26771>>>>>>>>>    Procedure Set ComKeyboardTip String value
26773>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
26774>>>>>>>>>    End_Procedure
26775>>>>>>>>>
26775>>>>>>>>>    Function ComPos Returns Integer
26777>>>>>>>>>        Integer retVal
26777>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to retVal
26778>>>>>>>>>        Function_Return retVal
26779>>>>>>>>>    End_Function
26780>>>>>>>>>
26780>>>>>>>>>    Procedure Set ComPos Integer value
26782>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to value
26783>>>>>>>>>    End_Procedure
26784>>>>>>>>>
26784>>>>>>>>>    Function ComMin Returns Integer
26786>>>>>>>>>        Integer retVal
26786>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to retVal
26787>>>>>>>>>        Function_Return retVal
26788>>>>>>>>>    End_Function
26789>>>>>>>>>
26789>>>>>>>>>    Procedure Set ComMin Integer value
26791>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 201 OLE_VT_I4 to value
26792>>>>>>>>>    End_Procedure
26793>>>>>>>>>
26793>>>>>>>>>    Function ComMax Returns Integer
26795>>>>>>>>>        Integer retVal
26795>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to retVal
26796>>>>>>>>>        Function_Return retVal
26797>>>>>>>>>    End_Function
26798>>>>>>>>>
26798>>>>>>>>>    Procedure Set ComMax Integer value
26800>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 202 OLE_VT_I4 to value
26801>>>>>>>>>    End_Procedure
26802>>>>>>>>>
26802>>>>>>>>>    Function ComScrollBarStyle Returns XTPScrollBarStyle
26804>>>>>>>>>        XTPScrollBarStyle retVal
26804>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 204 OLE_VT_I4 to retVal
26805>>>>>>>>>        Function_Return retVal
26806>>>>>>>>>    End_Function
26807>>>>>>>>>
26807>>>>>>>>>    Procedure Set ComScrollBarStyle XTPScrollBarStyle value
26809>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 204 OLE_VT_I4 to value
26810>>>>>>>>>    End_Procedure
26811>>>>>>>>>
26811>>>>>>>>>    Function ComControls Returns Variant
26813>>>>>>>>>        Handle hDispatchDriver
26813>>>>>>>>>        Variant retVal
26813>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26814>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
26815>>>>>>>>>        Function_Return retVal
26816>>>>>>>>>    End_Function
26817>>>>>>>>>
26817>>>>>>>>>    Function ComParent Returns Variant
26819>>>>>>>>>        Handle hDispatchDriver
26819>>>>>>>>>        Variant retVal
26819>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26820>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
26821>>>>>>>>>        Function_Return retVal
26822>>>>>>>>>    End_Function
26823>>>>>>>>>
26823>>>>>>>>>    Function ComIndex Returns Integer
26825>>>>>>>>>        Handle hDispatchDriver
26825>>>>>>>>>        Integer retVal
26825>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26826>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
26827>>>>>>>>>        Function_Return retVal
26828>>>>>>>>>    End_Function
26829>>>>>>>>>
26829>>>>>>>>>    Function ComType Returns XTPControlType
26831>>>>>>>>>        Handle hDispatchDriver
26831>>>>>>>>>        XTPControlType retVal
26831>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26832>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
26833>>>>>>>>>        Function_Return retVal
26834>>>>>>>>>    End_Function
26835>>>>>>>>>
26835>>>>>>>>>    Procedure ComDelete
26837>>>>>>>>>        Handle hDispatchDriver
26837>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26838>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
26839>>>>>>>>>    End_Procedure
26840>>>>>>>>>
26840>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
26842>>>>>>>>>        Handle hDispatchDriver
26842>>>>>>>>>        Variant retVal
26842>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26843>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26844>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
26845>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
26846>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
26847>>>>>>>>>        Function_Return retVal
26848>>>>>>>>>    End_Function
26849>>>>>>>>>
26849>>>>>>>>>    Procedure ComSetFocus
26851>>>>>>>>>        Handle hDispatchDriver
26851>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26852>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
26853>>>>>>>>>    End_Procedure
26854>>>>>>>>>
26854>>>>>>>>>    Procedure ComExecute
26856>>>>>>>>>        Handle hDispatchDriver
26856>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26857>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
26858>>>>>>>>>    End_Procedure
26859>>>>>>>>>
26859>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
26861>>>>>>>>>        Handle hDispatchDriver
26861>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26862>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
26863>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
26864>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
26865>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
26866>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
26867>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
26868>>>>>>>>>    End_Procedure
26869>>>>>>>>>
26869>>>>>>>>>    Function ComRibbonGroup Returns Variant
26871>>>>>>>>>        Handle hDispatchDriver
26871>>>>>>>>>        Variant retVal
26871>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26872>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
26873>>>>>>>>>        Function_Return retVal
26874>>>>>>>>>    End_Function
26875>>>>>>>>>
26875>>>>>>>>>    Procedure ComReset
26877>>>>>>>>>        Handle hDispatchDriver
26877>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26878>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
26879>>>>>>>>>    End_Procedure
26880>>>>>>>>>
26880>>>>>>>>>    Function ComTop Returns Integer
26882>>>>>>>>>        Handle hDispatchDriver
26882>>>>>>>>>        Integer retVal
26882>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26883>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
26884>>>>>>>>>        Function_Return retVal
26885>>>>>>>>>    End_Function
26886>>>>>>>>>
26886>>>>>>>>>    Function ComLeft Returns Integer
26888>>>>>>>>>        Handle hDispatchDriver
26888>>>>>>>>>        Integer retVal
26888>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26889>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
26890>>>>>>>>>        Function_Return retVal
26891>>>>>>>>>    End_Function
26892>>>>>>>>>
26892>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
26894>>>>>>>>>        Handle hDispatchDriver
26894>>>>>>>>>        Variant retVal
26894>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26895>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
26896>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
26897>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
26898>>>>>>>>>        Function_Return retVal
26899>>>>>>>>>    End_Function
26900>>>>>>>>>
26900>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
26902>>>>>>>>>        Handle hDispatchDriver
26902>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
26903>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
26904>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
26905>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
26906>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
26907>>>>>>>>>    End_Procedure
26908>>>>>>>>>End_Class
26909>>>>>>>>>
26909>>>>>>>>>// CLSID: {A4568A35-789A-40D9-B564-7577DA549319}
26909>>>>>>>>>Class cCJCommandBarPopupColor is a cComAutomationObject
26910>>>>>>>>>
26910>>>>>>>>>    Function ComChecked Returns Boolean
26912>>>>>>>>>        Boolean retVal
26912>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
26913>>>>>>>>>        Function_Return retVal
26914>>>>>>>>>    End_Function
26915>>>>>>>>>
26915>>>>>>>>>    Procedure Set ComChecked Boolean value
26917>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
26918>>>>>>>>>    End_Procedure
26919>>>>>>>>>
26919>>>>>>>>>    Function ComBeginGroup Returns Boolean
26921>>>>>>>>>        Boolean retVal
26921>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
26922>>>>>>>>>        Function_Return retVal
26923>>>>>>>>>    End_Function
26924>>>>>>>>>
26924>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
26926>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
26927>>>>>>>>>    End_Procedure
26928>>>>>>>>>
26928>>>>>>>>>    Function ComCaption Returns String
26930>>>>>>>>>        String retVal
26930>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
26931>>>>>>>>>        Function_Return retVal
26932>>>>>>>>>    End_Function
26933>>>>>>>>>
26933>>>>>>>>>    Procedure Set ComCaption String value
26935>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
26936>>>>>>>>>    End_Procedure
26937>>>>>>>>>
26937>>>>>>>>>    Function ComDescriptionText Returns String
26939>>>>>>>>>        String retVal
26939>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
26940>>>>>>>>>        Function_Return retVal
26941>>>>>>>>>    End_Function
26942>>>>>>>>>
26942>>>>>>>>>    Procedure Set ComDescriptionText String value
26944>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
26945>>>>>>>>>    End_Procedure
26946>>>>>>>>>
26946>>>>>>>>>    Function ComId Returns Integer
26948>>>>>>>>>        Integer retVal
26948>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
26949>>>>>>>>>        Function_Return retVal
26950>>>>>>>>>    End_Function
26951>>>>>>>>>
26951>>>>>>>>>    Procedure Set ComId Integer value
26953>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
26954>>>>>>>>>    End_Procedure
26955>>>>>>>>>
26955>>>>>>>>>    Function ComParameter Returns String
26957>>>>>>>>>        String retVal
26957>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
26958>>>>>>>>>        Function_Return retVal
26959>>>>>>>>>    End_Function
26960>>>>>>>>>
26960>>>>>>>>>    Procedure Set ComParameter String value
26962>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
26963>>>>>>>>>    End_Procedure
26964>>>>>>>>>
26964>>>>>>>>>    Function ComShortcutText Returns String
26966>>>>>>>>>        String retVal
26966>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
26967>>>>>>>>>        Function_Return retVal
26968>>>>>>>>>    End_Function
26969>>>>>>>>>
26969>>>>>>>>>    Procedure Set ComShortcutText String value
26971>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
26972>>>>>>>>>    End_Procedure
26973>>>>>>>>>
26973>>>>>>>>>    Function ComCustomShortcutText Returns String
26975>>>>>>>>>        String retVal
26975>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
26976>>>>>>>>>        Function_Return retVal
26977>>>>>>>>>    End_Function
26978>>>>>>>>>
26978>>>>>>>>>    Procedure Set ComCustomShortcutText String value
26980>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
26981>>>>>>>>>    End_Procedure
26982>>>>>>>>>
26982>>>>>>>>>    Function ComTooltipText Returns String
26984>>>>>>>>>        String retVal
26984>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
26985>>>>>>>>>        Function_Return retVal
26986>>>>>>>>>    End_Function
26987>>>>>>>>>
26987>>>>>>>>>    Procedure Set ComTooltipText String value
26989>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
26990>>>>>>>>>    End_Procedure
26991>>>>>>>>>
26991>>>>>>>>>    Function ComVisible Returns Boolean
26993>>>>>>>>>        Boolean retVal
26993>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
26994>>>>>>>>>        Function_Return retVal
26995>>>>>>>>>    End_Function
26996>>>>>>>>>
26996>>>>>>>>>    Procedure Set ComVisible Boolean value
26998>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
26999>>>>>>>>>    End_Procedure
27000>>>>>>>>>
27000>>>>>>>>>    Function ComEnabled Returns Boolean
27002>>>>>>>>>        Boolean retVal
27002>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
27003>>>>>>>>>        Function_Return retVal
27004>>>>>>>>>    End_Function
27005>>>>>>>>>
27005>>>>>>>>>    Procedure Set ComEnabled Boolean value
27007>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
27008>>>>>>>>>    End_Procedure
27009>>>>>>>>>
27009>>>>>>>>>    Function ComIconId Returns Integer
27011>>>>>>>>>        Integer retVal
27011>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
27012>>>>>>>>>        Function_Return retVal
27013>>>>>>>>>    End_Function
27014>>>>>>>>>
27014>>>>>>>>>    Procedure Set ComIconId Integer value
27016>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
27017>>>>>>>>>    End_Procedure
27018>>>>>>>>>
27018>>>>>>>>>    Function ComDefaultItem Returns Boolean
27020>>>>>>>>>        Boolean retVal
27020>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
27021>>>>>>>>>        Function_Return retVal
27022>>>>>>>>>    End_Function
27023>>>>>>>>>
27023>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
27025>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
27026>>>>>>>>>    End_Procedure
27027>>>>>>>>>
27027>>>>>>>>>    Function ComFlags Returns XTPControlFlags
27029>>>>>>>>>        XTPControlFlags retVal
27029>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
27030>>>>>>>>>        Function_Return retVal
27031>>>>>>>>>    End_Function
27032>>>>>>>>>
27032>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
27034>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
27035>>>>>>>>>    End_Procedure
27036>>>>>>>>>
27036>>>>>>>>>    Function ComCategory Returns String
27038>>>>>>>>>        String retVal
27038>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
27039>>>>>>>>>        Function_Return retVal
27040>>>>>>>>>    End_Function
27041>>>>>>>>>
27041>>>>>>>>>    Procedure Set ComCategory String value
27043>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
27044>>>>>>>>>    End_Procedure
27045>>>>>>>>>
27045>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
27047>>>>>>>>>        XTPControlHideFlags retVal
27047>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
27048>>>>>>>>>        Function_Return retVal
27049>>>>>>>>>    End_Function
27050>>>>>>>>>
27050>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
27052>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
27053>>>>>>>>>    End_Procedure
27054>>>>>>>>>
27054>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
27056>>>>>>>>>        Boolean retVal
27056>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
27057>>>>>>>>>        Function_Return retVal
27058>>>>>>>>>    End_Function
27059>>>>>>>>>
27059>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
27061>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
27062>>>>>>>>>    End_Procedure
27063>>>>>>>>>
27063>>>>>>>>>    Function ComAction Returns Variant
27065>>>>>>>>>        Variant retVal
27065>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
27066>>>>>>>>>        Function_Return retVal
27067>>>>>>>>>    End_Function
27068>>>>>>>>>
27068>>>>>>>>>    Procedure Set ComAction Variant value
27070>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
27071>>>>>>>>>    End_Procedure
27072>>>>>>>>>
27072>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
27074>>>>>>>>>        Integer retVal
27074>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
27075>>>>>>>>>        Function_Return retVal
27076>>>>>>>>>    End_Function
27077>>>>>>>>>
27077>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
27079>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
27080>>>>>>>>>    End_Procedure
27081>>>>>>>>>
27081>>>>>>>>>    Function ComWidth Returns Integer
27083>>>>>>>>>        Integer retVal
27083>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
27084>>>>>>>>>        Function_Return retVal
27085>>>>>>>>>    End_Function
27086>>>>>>>>>
27086>>>>>>>>>    Procedure Set ComWidth Integer value
27088>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
27089>>>>>>>>>    End_Procedure
27090>>>>>>>>>
27090>>>>>>>>>    Function ComHeight Returns Integer
27092>>>>>>>>>        Integer retVal
27092>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
27093>>>>>>>>>        Function_Return retVal
27094>>>>>>>>>    End_Function
27095>>>>>>>>>
27095>>>>>>>>>    Procedure Set ComHeight Integer value
27097>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
27098>>>>>>>>>    End_Procedure
27099>>>>>>>>>
27099>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
27101>>>>>>>>>        XTPButtonStyle retVal
27101>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
27102>>>>>>>>>        Function_Return retVal
27103>>>>>>>>>    End_Function
27104>>>>>>>>>
27104>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
27106>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
27107>>>>>>>>>    End_Procedure
27108>>>>>>>>>
27108>>>>>>>>>    Function ComKeyboardTip Returns String
27110>>>>>>>>>        String retVal
27110>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
27111>>>>>>>>>        Function_Return retVal
27112>>>>>>>>>    End_Function
27113>>>>>>>>>
27113>>>>>>>>>    Procedure Set ComKeyboardTip String value
27115>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
27116>>>>>>>>>    End_Procedure
27117>>>>>>>>>
27117>>>>>>>>>    Function ComColor Returns OLE_COLOR
27119>>>>>>>>>        OLE_COLOR retVal
27119>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to retVal
27120>>>>>>>>>        Function_Return retVal
27121>>>>>>>>>    End_Function
27122>>>>>>>>>
27122>>>>>>>>>    Procedure Set ComColor OLE_COLOR value
27124>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to value
27125>>>>>>>>>    End_Procedure
27126>>>>>>>>>
27126>>>>>>>>>    Function ComCommandBar Returns Variant
27128>>>>>>>>>        Variant retVal
27128>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to retVal
27129>>>>>>>>>        Function_Return retVal
27130>>>>>>>>>    End_Function
27131>>>>>>>>>
27131>>>>>>>>>    Procedure Set ComCommandBar Variant value
27133>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 50 OLE_VT_DISPATCH to value
27134>>>>>>>>>    End_Procedure
27135>>>>>>>>>
27135>>>>>>>>>    Function ComControls Returns Variant
27137>>>>>>>>>        Handle hDispatchDriver
27137>>>>>>>>>        Variant retVal
27137>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27138>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
27139>>>>>>>>>        Function_Return retVal
27140>>>>>>>>>    End_Function
27141>>>>>>>>>
27141>>>>>>>>>    Function ComParent Returns Variant
27143>>>>>>>>>        Handle hDispatchDriver
27143>>>>>>>>>        Variant retVal
27143>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27144>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27145>>>>>>>>>        Function_Return retVal
27146>>>>>>>>>    End_Function
27147>>>>>>>>>
27147>>>>>>>>>    Function ComIndex Returns Integer
27149>>>>>>>>>        Handle hDispatchDriver
27149>>>>>>>>>        Integer retVal
27149>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27150>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27151>>>>>>>>>        Function_Return retVal
27152>>>>>>>>>    End_Function
27153>>>>>>>>>
27153>>>>>>>>>    Function ComType Returns XTPControlType
27155>>>>>>>>>        Handle hDispatchDriver
27155>>>>>>>>>        XTPControlType retVal
27155>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27156>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
27157>>>>>>>>>        Function_Return retVal
27158>>>>>>>>>    End_Function
27159>>>>>>>>>
27159>>>>>>>>>    Procedure ComDelete
27161>>>>>>>>>        Handle hDispatchDriver
27161>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27162>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
27163>>>>>>>>>    End_Procedure
27164>>>>>>>>>
27164>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
27166>>>>>>>>>        Handle hDispatchDriver
27166>>>>>>>>>        Variant retVal
27166>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27167>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
27168>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
27169>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
27170>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
27171>>>>>>>>>        Function_Return retVal
27172>>>>>>>>>    End_Function
27173>>>>>>>>>
27173>>>>>>>>>    Procedure ComSetFocus
27175>>>>>>>>>        Handle hDispatchDriver
27175>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27176>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
27177>>>>>>>>>    End_Procedure
27178>>>>>>>>>
27178>>>>>>>>>    Procedure ComExecute
27180>>>>>>>>>        Handle hDispatchDriver
27180>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27181>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
27182>>>>>>>>>    End_Procedure
27183>>>>>>>>>
27183>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
27185>>>>>>>>>        Handle hDispatchDriver
27185>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27186>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
27187>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
27188>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
27189>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
27190>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
27191>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
27192>>>>>>>>>    End_Procedure
27193>>>>>>>>>
27193>>>>>>>>>    Function ComRibbonGroup Returns Variant
27195>>>>>>>>>        Handle hDispatchDriver
27195>>>>>>>>>        Variant retVal
27195>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27196>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
27197>>>>>>>>>        Function_Return retVal
27198>>>>>>>>>    End_Function
27199>>>>>>>>>
27199>>>>>>>>>    Procedure ComReset
27201>>>>>>>>>        Handle hDispatchDriver
27201>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27202>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
27203>>>>>>>>>    End_Procedure
27204>>>>>>>>>
27204>>>>>>>>>    Function ComTop Returns Integer
27206>>>>>>>>>        Handle hDispatchDriver
27206>>>>>>>>>        Integer retVal
27206>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27207>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
27208>>>>>>>>>        Function_Return retVal
27209>>>>>>>>>    End_Function
27210>>>>>>>>>
27210>>>>>>>>>    Function ComLeft Returns Integer
27212>>>>>>>>>        Handle hDispatchDriver
27212>>>>>>>>>        Integer retVal
27212>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27213>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
27214>>>>>>>>>        Function_Return retVal
27215>>>>>>>>>    End_Function
27216>>>>>>>>>
27216>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
27218>>>>>>>>>        Handle hDispatchDriver
27218>>>>>>>>>        Variant retVal
27218>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27219>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
27220>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
27221>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
27222>>>>>>>>>        Function_Return retVal
27223>>>>>>>>>    End_Function
27224>>>>>>>>>
27224>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
27226>>>>>>>>>        Handle hDispatchDriver
27226>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27227>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
27228>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
27229>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
27230>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
27231>>>>>>>>>    End_Procedure
27232>>>>>>>>>End_Class
27233>>>>>>>>>
27233>>>>>>>>>// CLSID: {B4568A35-789A-40D9-B564-7577DA549319}
27233>>>>>>>>>Class cCJCommandBarControlColorSelector is a cComAutomationObject
27234>>>>>>>>>
27234>>>>>>>>>    Function ComChecked Returns Boolean
27236>>>>>>>>>        Boolean retVal
27236>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to retVal
27237>>>>>>>>>        Function_Return retVal
27238>>>>>>>>>    End_Function
27239>>>>>>>>>
27239>>>>>>>>>    Procedure Set ComChecked Boolean value
27241>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 14 OLE_VT_BOOL to value
27242>>>>>>>>>    End_Procedure
27243>>>>>>>>>
27243>>>>>>>>>    Function ComBeginGroup Returns Boolean
27245>>>>>>>>>        Boolean retVal
27245>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to retVal
27246>>>>>>>>>        Function_Return retVal
27247>>>>>>>>>    End_Function
27248>>>>>>>>>
27248>>>>>>>>>    Procedure Set ComBeginGroup Boolean value
27250>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BOOL to value
27251>>>>>>>>>    End_Procedure
27252>>>>>>>>>
27252>>>>>>>>>    Function ComCaption Returns String
27254>>>>>>>>>        String retVal
27254>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
27255>>>>>>>>>        Function_Return retVal
27256>>>>>>>>>    End_Function
27257>>>>>>>>>
27257>>>>>>>>>    Procedure Set ComCaption String value
27259>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
27260>>>>>>>>>    End_Procedure
27261>>>>>>>>>
27261>>>>>>>>>    Function ComDescriptionText Returns String
27263>>>>>>>>>        String retVal
27263>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
27264>>>>>>>>>        Function_Return retVal
27265>>>>>>>>>    End_Function
27266>>>>>>>>>
27266>>>>>>>>>    Procedure Set ComDescriptionText String value
27268>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
27269>>>>>>>>>    End_Procedure
27270>>>>>>>>>
27270>>>>>>>>>    Function ComId Returns Integer
27272>>>>>>>>>        Integer retVal
27272>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
27273>>>>>>>>>        Function_Return retVal
27274>>>>>>>>>    End_Function
27275>>>>>>>>>
27275>>>>>>>>>    Procedure Set ComId Integer value
27277>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
27278>>>>>>>>>    End_Procedure
27279>>>>>>>>>
27279>>>>>>>>>    Function ComParameter Returns String
27281>>>>>>>>>        String retVal
27281>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
27282>>>>>>>>>        Function_Return retVal
27283>>>>>>>>>    End_Function
27284>>>>>>>>>
27284>>>>>>>>>    Procedure Set ComParameter String value
27286>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
27287>>>>>>>>>    End_Procedure
27288>>>>>>>>>
27288>>>>>>>>>    Function ComShortcutText Returns String
27290>>>>>>>>>        String retVal
27290>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to retVal
27291>>>>>>>>>        Function_Return retVal
27292>>>>>>>>>    End_Function
27293>>>>>>>>>
27293>>>>>>>>>    Procedure Set ComShortcutText String value
27295>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 9 OLE_VT_BSTR to value
27296>>>>>>>>>    End_Procedure
27297>>>>>>>>>
27297>>>>>>>>>    Function ComCustomShortcutText Returns String
27299>>>>>>>>>        String retVal
27299>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to retVal
27300>>>>>>>>>        Function_Return retVal
27301>>>>>>>>>    End_Function
27302>>>>>>>>>
27302>>>>>>>>>    Procedure Set ComCustomShortcutText String value
27304>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 90 OLE_VT_BSTR to value
27305>>>>>>>>>    End_Procedure
27306>>>>>>>>>
27306>>>>>>>>>    Function ComTooltipText Returns String
27308>>>>>>>>>        String retVal
27308>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to retVal
27309>>>>>>>>>        Function_Return retVal
27310>>>>>>>>>    End_Function
27311>>>>>>>>>
27311>>>>>>>>>    Procedure Set ComTooltipText String value
27313>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BSTR to value
27314>>>>>>>>>    End_Procedure
27315>>>>>>>>>
27315>>>>>>>>>    Function ComVisible Returns Boolean
27317>>>>>>>>>        Boolean retVal
27317>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
27318>>>>>>>>>        Function_Return retVal
27319>>>>>>>>>    End_Function
27320>>>>>>>>>
27320>>>>>>>>>    Procedure Set ComVisible Boolean value
27322>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
27323>>>>>>>>>    End_Procedure
27324>>>>>>>>>
27324>>>>>>>>>    Function ComEnabled Returns Boolean
27326>>>>>>>>>        Boolean retVal
27326>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
27327>>>>>>>>>        Function_Return retVal
27328>>>>>>>>>    End_Function
27329>>>>>>>>>
27329>>>>>>>>>    Procedure Set ComEnabled Boolean value
27331>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
27332>>>>>>>>>    End_Procedure
27333>>>>>>>>>
27333>>>>>>>>>    Function ComIconId Returns Integer
27335>>>>>>>>>        Integer retVal
27335>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
27336>>>>>>>>>        Function_Return retVal
27337>>>>>>>>>    End_Function
27338>>>>>>>>>
27338>>>>>>>>>    Procedure Set ComIconId Integer value
27340>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
27341>>>>>>>>>    End_Procedure
27342>>>>>>>>>
27342>>>>>>>>>    Function ComDefaultItem Returns Boolean
27344>>>>>>>>>        Boolean retVal
27344>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
27345>>>>>>>>>        Function_Return retVal
27346>>>>>>>>>    End_Function
27347>>>>>>>>>
27347>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
27349>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
27350>>>>>>>>>    End_Procedure
27351>>>>>>>>>
27351>>>>>>>>>    Function ComFlags Returns XTPControlFlags
27353>>>>>>>>>        XTPControlFlags retVal
27353>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to retVal
27354>>>>>>>>>        Function_Return retVal
27355>>>>>>>>>    End_Function
27356>>>>>>>>>
27356>>>>>>>>>    Procedure Set ComFlags XTPControlFlags value
27358>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 18 OLE_VT_I4 to value
27359>>>>>>>>>    End_Procedure
27360>>>>>>>>>
27360>>>>>>>>>    Function ComCategory Returns String
27362>>>>>>>>>        String retVal
27362>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to retVal
27363>>>>>>>>>        Function_Return retVal
27364>>>>>>>>>    End_Function
27365>>>>>>>>>
27365>>>>>>>>>    Procedure Set ComCategory String value
27367>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 19 OLE_VT_BSTR to value
27368>>>>>>>>>    End_Procedure
27369>>>>>>>>>
27369>>>>>>>>>    Function ComHideFlags Returns XTPControlHideFlags
27371>>>>>>>>>        XTPControlHideFlags retVal
27371>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to retVal
27372>>>>>>>>>        Function_Return retVal
27373>>>>>>>>>    End_Function
27374>>>>>>>>>
27374>>>>>>>>>    Procedure Set ComHideFlags XTPControlHideFlags value
27376>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 23 OLE_VT_I4 to value
27377>>>>>>>>>    End_Procedure
27378>>>>>>>>>
27378>>>>>>>>>    Function ComCloseSubMenuOnClick Returns Boolean
27380>>>>>>>>>        Boolean retVal
27380>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to retVal
27381>>>>>>>>>        Function_Return retVal
27382>>>>>>>>>    End_Function
27383>>>>>>>>>
27383>>>>>>>>>    Procedure Set ComCloseSubMenuOnClick Boolean value
27385>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 24 OLE_VT_BOOL to value
27386>>>>>>>>>    End_Procedure
27387>>>>>>>>>
27387>>>>>>>>>    Function ComAction Returns Variant
27389>>>>>>>>>        Variant retVal
27389>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
27390>>>>>>>>>        Function_Return retVal
27391>>>>>>>>>    End_Function
27392>>>>>>>>>
27392>>>>>>>>>    Procedure Set ComAction Variant value
27394>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
27395>>>>>>>>>    End_Procedure
27396>>>>>>>>>
27396>>>>>>>>>    Function ComExecuteOnPressInterval Returns Integer
27398>>>>>>>>>        Integer retVal
27398>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to retVal
27399>>>>>>>>>        Function_Return retVal
27400>>>>>>>>>    End_Function
27401>>>>>>>>>
27401>>>>>>>>>    Procedure Set ComExecuteOnPressInterval Integer value
27403>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 30 OLE_VT_I4 to value
27404>>>>>>>>>    End_Procedure
27405>>>>>>>>>
27405>>>>>>>>>    Function ComWidth Returns Integer
27407>>>>>>>>>        Integer retVal
27407>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to retVal
27408>>>>>>>>>        Function_Return retVal
27409>>>>>>>>>    End_Function
27410>>>>>>>>>
27410>>>>>>>>>    Procedure Set ComWidth Integer value
27412>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 31 OLE_VT_I4 to value
27413>>>>>>>>>    End_Procedure
27414>>>>>>>>>
27414>>>>>>>>>    Function ComHeight Returns Integer
27416>>>>>>>>>        Integer retVal
27416>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to retVal
27417>>>>>>>>>        Function_Return retVal
27418>>>>>>>>>    End_Function
27419>>>>>>>>>
27419>>>>>>>>>    Procedure Set ComHeight Integer value
27421>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 32 OLE_VT_I4 to value
27422>>>>>>>>>    End_Procedure
27423>>>>>>>>>
27423>>>>>>>>>    Function ComStyle Returns XTPButtonStyle
27425>>>>>>>>>        XTPButtonStyle retVal
27425>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to retVal
27426>>>>>>>>>        Function_Return retVal
27427>>>>>>>>>    End_Function
27428>>>>>>>>>
27428>>>>>>>>>    Procedure Set ComStyle XTPButtonStyle value
27430>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 28 OLE_VT_I4 to value
27431>>>>>>>>>    End_Procedure
27432>>>>>>>>>
27432>>>>>>>>>    Function ComKeyboardTip Returns String
27434>>>>>>>>>        String retVal
27434>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to retVal
27435>>>>>>>>>        Function_Return retVal
27436>>>>>>>>>    End_Function
27437>>>>>>>>>
27437>>>>>>>>>    Procedure Set ComKeyboardTip String value
27439>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 36 OLE_VT_BSTR to value
27440>>>>>>>>>    End_Procedure
27441>>>>>>>>>
27441>>>>>>>>>    Function ComColor Returns OLE_COLOR
27443>>>>>>>>>        OLE_COLOR retVal
27443>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to retVal
27444>>>>>>>>>        Function_Return retVal
27445>>>>>>>>>    End_Function
27446>>>>>>>>>
27446>>>>>>>>>    Procedure Set ComColor OLE_COLOR value
27448>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 200 OLE_VT_I4 to value
27449>>>>>>>>>    End_Procedure
27450>>>>>>>>>
27450>>>>>>>>>    Function ComControls Returns Variant
27452>>>>>>>>>        Handle hDispatchDriver
27452>>>>>>>>>        Variant retVal
27452>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27453>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
27454>>>>>>>>>        Function_Return retVal
27455>>>>>>>>>    End_Function
27456>>>>>>>>>
27456>>>>>>>>>    Function ComParent Returns Variant
27458>>>>>>>>>        Handle hDispatchDriver
27458>>>>>>>>>        Variant retVal
27458>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27459>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27460>>>>>>>>>        Function_Return retVal
27461>>>>>>>>>    End_Function
27462>>>>>>>>>
27462>>>>>>>>>    Function ComIndex Returns Integer
27464>>>>>>>>>        Handle hDispatchDriver
27464>>>>>>>>>        Integer retVal
27464>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27465>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27466>>>>>>>>>        Function_Return retVal
27467>>>>>>>>>    End_Function
27468>>>>>>>>>
27468>>>>>>>>>    Function ComType Returns XTPControlType
27470>>>>>>>>>        Handle hDispatchDriver
27470>>>>>>>>>        XTPControlType retVal
27470>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27471>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_I4 to retVal
27472>>>>>>>>>        Function_Return retVal
27473>>>>>>>>>    End_Function
27474>>>>>>>>>
27474>>>>>>>>>    Procedure ComDelete
27476>>>>>>>>>        Handle hDispatchDriver
27476>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27477>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
27478>>>>>>>>>    End_Procedure
27479>>>>>>>>>
27479>>>>>>>>>    Function ComCopy Variant llBar Variant llBefore Returns Variant
27481>>>>>>>>>        Handle hDispatchDriver
27481>>>>>>>>>        Variant retVal
27481>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27482>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
27483>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llBar
27484>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llBefore
27485>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_DISPATCH to retVal
27486>>>>>>>>>        Function_Return retVal
27487>>>>>>>>>    End_Function
27488>>>>>>>>>
27488>>>>>>>>>    Procedure ComSetFocus
27490>>>>>>>>>        Handle hDispatchDriver
27490>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27491>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 21 OLE_VT_VOID
27492>>>>>>>>>    End_Procedure
27493>>>>>>>>>
27493>>>>>>>>>    Procedure ComExecute
27495>>>>>>>>>        Handle hDispatchDriver
27495>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27496>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 22 OLE_VT_VOID
27497>>>>>>>>>    End_Procedure
27498>>>>>>>>>
27498>>>>>>>>>    Procedure ComGetRect Integer ByRef llLeft Integer ByRef llTop Integer ByRef llRight Integer ByRef llBottom
27500>>>>>>>>>        Handle hDispatchDriver
27500>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27501>>>>>>>>>        Send PrepareParams to hDispatchDriver 4
27502>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llLeft
27503>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llTop
27504>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llRight
27505>>>>>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llBottom
27506>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
27507>>>>>>>>>    End_Procedure
27508>>>>>>>>>
27508>>>>>>>>>    Function ComRibbonGroup Returns Variant
27510>>>>>>>>>        Handle hDispatchDriver
27510>>>>>>>>>        Variant retVal
27510>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27511>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 26 OLE_VT_DISPATCH to retVal
27512>>>>>>>>>        Function_Return retVal
27513>>>>>>>>>    End_Function
27514>>>>>>>>>
27514>>>>>>>>>    Procedure ComReset
27516>>>>>>>>>        Handle hDispatchDriver
27516>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27517>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 27 OLE_VT_VOID
27518>>>>>>>>>    End_Procedure
27519>>>>>>>>>
27519>>>>>>>>>    Function ComTop Returns Integer
27521>>>>>>>>>        Handle hDispatchDriver
27521>>>>>>>>>        Integer retVal
27521>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27522>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 33 OLE_VT_I4 to retVal
27523>>>>>>>>>        Function_Return retVal
27524>>>>>>>>>    End_Function
27525>>>>>>>>>
27525>>>>>>>>>    Function ComLeft Returns Integer
27527>>>>>>>>>        Handle hDispatchDriver
27527>>>>>>>>>        Integer retVal
27527>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27528>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 34 OLE_VT_I4 to retVal
27529>>>>>>>>>        Function_Return retVal
27530>>>>>>>>>    End_Function
27531>>>>>>>>>
27531>>>>>>>>>    Function ComClone Variant llRecursive Returns Variant
27533>>>>>>>>>        Handle hDispatchDriver
27533>>>>>>>>>        Variant retVal
27533>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27534>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
27535>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llRecursive
27536>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 35 OLE_VT_DISPATCH to retVal
27537>>>>>>>>>        Function_Return retVal
27538>>>>>>>>>    End_Function
27539>>>>>>>>>
27539>>>>>>>>>    Procedure ComSetIconSize Integer llcx Integer llcy
27541>>>>>>>>>        Handle hDispatchDriver
27541>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27542>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
27543>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcx
27544>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcy
27545>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 37 OLE_VT_VOID
27546>>>>>>>>>    End_Procedure
27547>>>>>>>>>End_Class
27548>>>>>>>>>
27548>>>>>>>>>// CLSID: {08D4667A-9A19-461C-8F10-5F8605AF99FD}
27548>>>>>>>>>Class cCJPrintInfo is a cComAutomationObject
27549>>>>>>>>>
27549>>>>>>>>>    Function ComContinuePrinting Returns Boolean
27551>>>>>>>>>        Boolean retVal
27551>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to retVal
27552>>>>>>>>>        Function_Return retVal
27553>>>>>>>>>    End_Function
27554>>>>>>>>>
27554>>>>>>>>>    Procedure Set ComContinuePrinting Boolean value
27556>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BOOL to value
27557>>>>>>>>>    End_Procedure
27558>>>>>>>>>
27558>>>>>>>>>    Function ComMaxPage Returns Integer
27560>>>>>>>>>        Integer retVal
27560>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to retVal
27561>>>>>>>>>        Function_Return retVal
27562>>>>>>>>>    End_Function
27563>>>>>>>>>
27563>>>>>>>>>    Procedure Set ComMaxPage Integer value
27565>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_I4 to value
27566>>>>>>>>>    End_Procedure
27567>>>>>>>>>
27567>>>>>>>>>    Function ComPreviewMode Returns Boolean
27569>>>>>>>>>        Handle hDispatchDriver
27569>>>>>>>>>        Boolean retVal
27569>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27570>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BOOL to retVal
27571>>>>>>>>>        Function_Return retVal
27572>>>>>>>>>    End_Function
27573>>>>>>>>>
27573>>>>>>>>>    Function ComCurrentPage Returns Integer
27575>>>>>>>>>        Handle hDispatchDriver
27575>>>>>>>>>        Integer retVal
27575>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27576>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_I4 to retVal
27577>>>>>>>>>        Function_Return retVal
27578>>>>>>>>>    End_Function
27579>>>>>>>>>
27579>>>>>>>>>    Function ComPrintRectLeft Returns Integer
27581>>>>>>>>>        Handle hDispatchDriver
27581>>>>>>>>>        Integer retVal
27581>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27582>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_I4 to retVal
27583>>>>>>>>>        Function_Return retVal
27584>>>>>>>>>    End_Function
27585>>>>>>>>>
27585>>>>>>>>>    Function ComPrintRectTop Returns Integer
27587>>>>>>>>>        Handle hDispatchDriver
27587>>>>>>>>>        Integer retVal
27587>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27588>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_I4 to retVal
27589>>>>>>>>>        Function_Return retVal
27590>>>>>>>>>    End_Function
27591>>>>>>>>>
27591>>>>>>>>>    Function ComPrintRectRight Returns Integer
27593>>>>>>>>>        Handle hDispatchDriver
27593>>>>>>>>>        Integer retVal
27593>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27594>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27595>>>>>>>>>        Function_Return retVal
27596>>>>>>>>>    End_Function
27597>>>>>>>>>
27597>>>>>>>>>    Function ComPrintRectBottom Returns Integer
27599>>>>>>>>>        Handle hDispatchDriver
27599>>>>>>>>>        Integer retVal
27599>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27600>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 8 OLE_VT_I4 to retVal
27601>>>>>>>>>        Function_Return retVal
27602>>>>>>>>>    End_Function
27603>>>>>>>>>End_Class
27604>>>>>>>>>
27604>>>>>>>>>// CLSID: {66CE0F75-CB1F-40FD-B073-4BC151A5205F}
27604>>>>>>>>>Class cCJRibbonBackstageView is a cComAutomationObject
27605>>>>>>>>>
27605>>>>>>>>>    Function ComControls Returns Variant
27607>>>>>>>>>        Handle hDispatchDriver
27607>>>>>>>>>        Variant retVal
27607>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27608>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27609>>>>>>>>>        Function_Return retVal
27610>>>>>>>>>    End_Function
27611>>>>>>>>>
27611>>>>>>>>>    Function ComAddCommand Integer llId String llCaption Returns Variant
27613>>>>>>>>>        Handle hDispatchDriver
27613>>>>>>>>>        Variant retVal
27613>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27614>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
27615>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
27616>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
27617>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1000 OLE_VT_DISPATCH to retVal
27618>>>>>>>>>        Function_Return retVal
27619>>>>>>>>>    End_Function
27620>>>>>>>>>
27620>>>>>>>>>    Function ComAddTab Integer llId String llCaption OLE_HANDLE llControlPaneHwnd Returns Variant
27622>>>>>>>>>        Handle hDispatchDriver
27622>>>>>>>>>        Variant retVal
27622>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27623>>>>>>>>>        Send PrepareParams to hDispatchDriver 3
27624>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llId
27625>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llCaption
27626>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llControlPaneHwnd
27627>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1001 OLE_VT_DISPATCH to retVal
27628>>>>>>>>>        Function_Return retVal
27629>>>>>>>>>    End_Function
27630>>>>>>>>>
27630>>>>>>>>>    Procedure ComClose
27632>>>>>>>>>        Handle hDispatchDriver
27632>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27633>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 1002 OLE_VT_VOID
27634>>>>>>>>>    End_Procedure
27635>>>>>>>>>
27635>>>>>>>>>    Procedure ComSetTheme XTPVisualTheme llTheme
27637>>>>>>>>>        Handle hDispatchDriver
27637>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27638>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
27639>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llTheme
27640>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 1003 OLE_VT_VOID
27641>>>>>>>>>    End_Procedure
27642>>>>>>>>>
27642>>>>>>>>>    Function ComAddMenuSeparator Returns Variant
27644>>>>>>>>>        Handle hDispatchDriver
27644>>>>>>>>>        Variant retVal
27644>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27645>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1004 OLE_VT_DISPATCH to retVal
27646>>>>>>>>>        Function_Return retVal
27647>>>>>>>>>    End_Function
27648>>>>>>>>>
27648>>>>>>>>>    Function ComGetForeColor Returns OLE_COLOR
27650>>>>>>>>>        Handle hDispatchDriver
27650>>>>>>>>>        OLE_COLOR retVal
27650>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27651>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1100 OLE_VT_I4 to retVal
27652>>>>>>>>>        Function_Return retVal
27653>>>>>>>>>    End_Function
27654>>>>>>>>>
27654>>>>>>>>>    Function ComGetBackColor Returns OLE_COLOR
27656>>>>>>>>>        Handle hDispatchDriver
27656>>>>>>>>>        OLE_COLOR retVal
27656>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27657>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1101 OLE_VT_I4 to retVal
27658>>>>>>>>>        Function_Return retVal
27659>>>>>>>>>    End_Function
27660>>>>>>>>>End_Class
27661>>>>>>>>>
27661>>>>>>>>>// CLSID: {66AE0F75-CB1F-40FD-B073-4BC151A5205F}
27661>>>>>>>>>Class cCJRibbonBackstageCommad is a cComAutomationObject
27662>>>>>>>>>
27662>>>>>>>>>    Function ComCaption Returns String
27664>>>>>>>>>        String retVal
27664>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
27665>>>>>>>>>        Function_Return retVal
27666>>>>>>>>>    End_Function
27667>>>>>>>>>
27667>>>>>>>>>    Procedure Set ComCaption String value
27669>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
27670>>>>>>>>>    End_Procedure
27671>>>>>>>>>
27671>>>>>>>>>    Function ComDescriptionText Returns String
27673>>>>>>>>>        String retVal
27673>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
27674>>>>>>>>>        Function_Return retVal
27675>>>>>>>>>    End_Function
27676>>>>>>>>>
27676>>>>>>>>>    Procedure Set ComDescriptionText String value
27678>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
27679>>>>>>>>>    End_Procedure
27680>>>>>>>>>
27680>>>>>>>>>    Function ComId Returns Integer
27682>>>>>>>>>        Integer retVal
27682>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
27683>>>>>>>>>        Function_Return retVal
27684>>>>>>>>>    End_Function
27685>>>>>>>>>
27685>>>>>>>>>    Procedure Set ComId Integer value
27687>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
27688>>>>>>>>>    End_Procedure
27689>>>>>>>>>
27689>>>>>>>>>    Function ComParameter Returns String
27691>>>>>>>>>        String retVal
27691>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
27692>>>>>>>>>        Function_Return retVal
27693>>>>>>>>>    End_Function
27694>>>>>>>>>
27694>>>>>>>>>    Procedure Set ComParameter String value
27696>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
27697>>>>>>>>>    End_Procedure
27698>>>>>>>>>
27698>>>>>>>>>    Function ComEnabled Returns Boolean
27700>>>>>>>>>        Boolean retVal
27700>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
27701>>>>>>>>>        Function_Return retVal
27702>>>>>>>>>    End_Function
27703>>>>>>>>>
27703>>>>>>>>>    Procedure Set ComEnabled Boolean value
27705>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
27706>>>>>>>>>    End_Procedure
27707>>>>>>>>>
27707>>>>>>>>>    Function ComVisible Returns Boolean
27709>>>>>>>>>        Boolean retVal
27709>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
27710>>>>>>>>>        Function_Return retVal
27711>>>>>>>>>    End_Function
27712>>>>>>>>>
27712>>>>>>>>>    Procedure Set ComVisible Boolean value
27714>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
27715>>>>>>>>>    End_Procedure
27716>>>>>>>>>
27716>>>>>>>>>    Function ComIconId Returns Integer
27718>>>>>>>>>        Integer retVal
27718>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
27719>>>>>>>>>        Function_Return retVal
27720>>>>>>>>>    End_Function
27721>>>>>>>>>
27721>>>>>>>>>    Procedure Set ComIconId Integer value
27723>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
27724>>>>>>>>>    End_Procedure
27725>>>>>>>>>
27725>>>>>>>>>    Function ComAction Returns Variant
27727>>>>>>>>>        Variant retVal
27727>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
27728>>>>>>>>>        Function_Return retVal
27729>>>>>>>>>    End_Function
27730>>>>>>>>>
27730>>>>>>>>>    Procedure Set ComAction Variant value
27732>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
27733>>>>>>>>>    End_Procedure
27734>>>>>>>>>
27734>>>>>>>>>    Function ComControls Returns Variant
27736>>>>>>>>>        Handle hDispatchDriver
27736>>>>>>>>>        Variant retVal
27736>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27737>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
27738>>>>>>>>>        Function_Return retVal
27739>>>>>>>>>    End_Function
27740>>>>>>>>>
27740>>>>>>>>>    Function ComParent Returns Variant
27742>>>>>>>>>        Handle hDispatchDriver
27742>>>>>>>>>        Variant retVal
27742>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27743>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27744>>>>>>>>>        Function_Return retVal
27745>>>>>>>>>    End_Function
27746>>>>>>>>>
27746>>>>>>>>>    Function ComIndex Returns Integer
27748>>>>>>>>>        Handle hDispatchDriver
27748>>>>>>>>>        Integer retVal
27748>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27749>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27750>>>>>>>>>        Function_Return retVal
27751>>>>>>>>>    End_Function
27752>>>>>>>>>
27752>>>>>>>>>    Procedure ComDelete
27754>>>>>>>>>        Handle hDispatchDriver
27754>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27755>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
27756>>>>>>>>>    End_Procedure
27757>>>>>>>>>End_Class
27758>>>>>>>>>
27758>>>>>>>>>// CLSID: {66BE0F75-CB1F-40FD-B073-4BC151A5205F}
27758>>>>>>>>>Class cCJRibbonBackstageTab is a cComAutomationObject
27759>>>>>>>>>
27759>>>>>>>>>    Function ComCaption Returns String
27761>>>>>>>>>        String retVal
27761>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to retVal
27762>>>>>>>>>        Function_Return retVal
27763>>>>>>>>>    End_Function
27764>>>>>>>>>
27764>>>>>>>>>    Procedure Set ComCaption String value
27766>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 4 OLE_VT_BSTR to value
27767>>>>>>>>>    End_Procedure
27768>>>>>>>>>
27768>>>>>>>>>    Function ComDescriptionText Returns String
27770>>>>>>>>>        String retVal
27770>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to retVal
27771>>>>>>>>>        Function_Return retVal
27772>>>>>>>>>    End_Function
27773>>>>>>>>>
27773>>>>>>>>>    Procedure Set ComDescriptionText String value
27775>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BSTR to value
27776>>>>>>>>>    End_Procedure
27777>>>>>>>>>
27777>>>>>>>>>    Function ComId Returns Integer
27779>>>>>>>>>        Integer retVal
27779>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
27780>>>>>>>>>        Function_Return retVal
27781>>>>>>>>>    End_Function
27782>>>>>>>>>
27782>>>>>>>>>    Procedure Set ComId Integer value
27784>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
27785>>>>>>>>>    End_Procedure
27786>>>>>>>>>
27786>>>>>>>>>    Function ComParameter Returns String
27788>>>>>>>>>        String retVal
27788>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to retVal
27789>>>>>>>>>        Function_Return retVal
27790>>>>>>>>>    End_Function
27791>>>>>>>>>
27791>>>>>>>>>    Procedure Set ComParameter String value
27793>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 8 OLE_VT_BSTR to value
27794>>>>>>>>>    End_Procedure
27795>>>>>>>>>
27795>>>>>>>>>    Function ComEnabled Returns Boolean
27797>>>>>>>>>        Boolean retVal
27797>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to retVal
27798>>>>>>>>>        Function_Return retVal
27799>>>>>>>>>    End_Function
27800>>>>>>>>>
27800>>>>>>>>>    Procedure Set ComEnabled Boolean value
27802>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 13 OLE_VT_BOOL to value
27803>>>>>>>>>    End_Procedure
27804>>>>>>>>>
27804>>>>>>>>>    Function ComVisible Returns Boolean
27806>>>>>>>>>        Boolean retVal
27806>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
27807>>>>>>>>>        Function_Return retVal
27808>>>>>>>>>    End_Function
27809>>>>>>>>>
27809>>>>>>>>>    Procedure Set ComVisible Boolean value
27811>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
27812>>>>>>>>>    End_Procedure
27813>>>>>>>>>
27813>>>>>>>>>    Function ComIconId Returns Integer
27815>>>>>>>>>        Integer retVal
27815>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to retVal
27816>>>>>>>>>        Function_Return retVal
27817>>>>>>>>>    End_Function
27818>>>>>>>>>
27818>>>>>>>>>    Procedure Set ComIconId Integer value
27820>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 15 OLE_VT_I4 to value
27821>>>>>>>>>    End_Procedure
27822>>>>>>>>>
27822>>>>>>>>>    Function ComDefaultItem Returns Boolean
27824>>>>>>>>>        Boolean retVal
27824>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
27825>>>>>>>>>        Function_Return retVal
27826>>>>>>>>>    End_Function
27827>>>>>>>>>
27827>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
27829>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
27830>>>>>>>>>    End_Procedure
27831>>>>>>>>>
27831>>>>>>>>>    Function ComAction Returns Variant
27833>>>>>>>>>        Variant retVal
27833>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to retVal
27834>>>>>>>>>        Function_Return retVal
27835>>>>>>>>>    End_Function
27836>>>>>>>>>
27836>>>>>>>>>    Procedure Set ComAction Variant value
27838>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 29 OLE_VT_DISPATCH to value
27839>>>>>>>>>    End_Procedure
27840>>>>>>>>>
27840>>>>>>>>>    Function ComControls Returns Variant
27842>>>>>>>>>        Handle hDispatchDriver
27842>>>>>>>>>        Variant retVal
27842>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27843>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
27844>>>>>>>>>        Function_Return retVal
27845>>>>>>>>>    End_Function
27846>>>>>>>>>
27846>>>>>>>>>    Function ComParent Returns Variant
27848>>>>>>>>>        Handle hDispatchDriver
27848>>>>>>>>>        Variant retVal
27848>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27849>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27850>>>>>>>>>        Function_Return retVal
27851>>>>>>>>>    End_Function
27852>>>>>>>>>
27852>>>>>>>>>    Function ComIndex Returns Integer
27854>>>>>>>>>        Handle hDispatchDriver
27854>>>>>>>>>        Integer retVal
27854>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27855>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27856>>>>>>>>>        Function_Return retVal
27857>>>>>>>>>    End_Function
27858>>>>>>>>>
27858>>>>>>>>>    Procedure ComDelete
27860>>>>>>>>>        Handle hDispatchDriver
27860>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27861>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
27862>>>>>>>>>    End_Procedure
27863>>>>>>>>>End_Class
27864>>>>>>>>>
27864>>>>>>>>>// CLSID: {E440E10A-3890-484C-A9B0-978E6AA0AA8D}
27864>>>>>>>>>Class cCJRibbonBackstageMenuSeparator is a cComAutomationObject
27865>>>>>>>>>
27865>>>>>>>>>    Function ComId Returns Integer
27867>>>>>>>>>        Integer retVal
27867>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to retVal
27868>>>>>>>>>        Function_Return retVal
27869>>>>>>>>>    End_Function
27870>>>>>>>>>
27870>>>>>>>>>    Procedure Set ComId Integer value
27872>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 6 OLE_VT_I4 to value
27873>>>>>>>>>    End_Procedure
27874>>>>>>>>>
27874>>>>>>>>>    Function ComVisible Returns Boolean
27876>>>>>>>>>        Boolean retVal
27876>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to retVal
27877>>>>>>>>>        Function_Return retVal
27878>>>>>>>>>    End_Function
27879>>>>>>>>>
27879>>>>>>>>>    Procedure Set ComVisible Boolean value
27881>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 12 OLE_VT_BOOL to value
27882>>>>>>>>>    End_Procedure
27883>>>>>>>>>
27883>>>>>>>>>    Function ComDefaultItem Returns Boolean
27885>>>>>>>>>        Boolean retVal
27885>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to retVal
27886>>>>>>>>>        Function_Return retVal
27887>>>>>>>>>    End_Function
27888>>>>>>>>>
27888>>>>>>>>>    Procedure Set ComDefaultItem Boolean value
27890>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 17 OLE_VT_BOOL to value
27891>>>>>>>>>    End_Procedure
27892>>>>>>>>>
27892>>>>>>>>>    Function ComControls Returns Variant
27894>>>>>>>>>        Handle hDispatchDriver
27894>>>>>>>>>        Variant retVal
27894>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27895>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_DISPATCH to retVal
27896>>>>>>>>>        Function_Return retVal
27897>>>>>>>>>    End_Function
27898>>>>>>>>>
27898>>>>>>>>>    Function ComParent Returns Variant
27900>>>>>>>>>        Handle hDispatchDriver
27900>>>>>>>>>        Variant retVal
27900>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27901>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_DISPATCH to retVal
27902>>>>>>>>>        Function_Return retVal
27903>>>>>>>>>    End_Function
27904>>>>>>>>>
27904>>>>>>>>>    Function ComIndex Returns Integer
27906>>>>>>>>>        Handle hDispatchDriver
27906>>>>>>>>>        Integer retVal
27906>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27907>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_I4 to retVal
27908>>>>>>>>>        Function_Return retVal
27909>>>>>>>>>    End_Function
27910>>>>>>>>>
27910>>>>>>>>>    Procedure ComDelete
27912>>>>>>>>>        Handle hDispatchDriver
27912>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
27913>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 16 OLE_VT_VOID
27914>>>>>>>>>    End_Procedure
27915>>>>>>>>>End_Class
27916>>>>>>>Use tWinStructs.pkg
27916>>>>>>>Use Winkern.pkg
27916>>>>>>>
27916>>>>>>>// idle timer used for updates.
27916>>>>>>>Class cCJIdleHandler is a cIdleHandler
27917>>>>>>>    Procedure OnIdle
27919>>>>>>>        Delegate Send Update
27921>>>>>>>    End_Procedure
27922>>>>>>>End_Class
27923>>>>>>>
27923>>>>>>>// xtpThemeOffice2007 was removed by CJ
27923>>>>>>>Define xtpThemeOffice2007 for xtpThemeResource
27923>>>>>>>
27923>>>>>>>// define custom theme names. We use these to turn these into usable
27923>>>>>>>// themes and their dll/ini files. This is in addition to whatever codejock provides
27923>>>>>>>
27923>>>>>>>Enum_List
27923>>>>>>>    Define xtpThemeOffice2007Aqua for 1024            
27923>>>>>>>    Define xtpThemeOffice2007Blue            
27923>>>>>>>    Define xtpThemeOffice2007Black            
27923>>>>>>>    Define xtpThemeOffice2007Silver            
27923>>>>>>>
27923>>>>>>>    Define xtpThemeOffice2010
27923>>>>>>>    Define xtpThemeOffice2010Blue            
27923>>>>>>>    Define xtpThemeOffice2010Black            
27923>>>>>>>    Define xtpThemeOffice2010Silver
27923>>>>>>>
27923>>>>>>>    Define xtpThemeOffice2013Word            
27923>>>>>>>    Define xtpThemeOffice2013Outlook            
27923>>>>>>>    Define xtpThemeOffice2013Excel         
27923>>>>>>>    Define xtpThemeOffice2013PowerPoint           
27923>>>>>>>    Define xtpThemeOffice2013Access      
27923>>>>>>>    Define xtpThemeOffice2013Publisher            
27923>>>>>>>    Define xtpThemeOffice2013OneNote            
27923>>>>>>>    
27923>>>>>>>    Define xtpThemeWindows7            
27923>>>>>>>
27923>>>>>>>    Define xtpThemeVisualStudio2015Blue            
27923>>>>>>>                
27923>>>>>>>End_Enum_List
27923>>>>>>>
27923>>>>>>>// Used for key bindings along with the VK_ defintions
27923>>>>>>>Define xtpKey_None for 0
27923>>>>>>>Define xtpKey_Shift for 4
27923>>>>>>>Define xtpKey_Ctrl for 8
27923>>>>>>>Define xtpKey_Alt for 16
27923>>>>>>>
27923>>>>>>>Define ID_CommandBarsAutoStart for 20001 // start for auto assigned menu items
27923>>>>>>>Define ID_StatusBarsAutoStart  for 10001 // start for auto assigned status panes
27923>>>>>>>Define ID_CommandBarIDAutoStart for 5000 // start for auto assigned commandbar BarIds
27923>>>>>>>Define ID_ImageAutoStart for 5000 // start for auto assigned image ids
27923>>>>>>>
27923>>>>>>>// options for loading and saving command bar layout
27923>>>>>>>Enum_List
27923>>>>>>>    Define rlNoSaveRestore         // don't load or save anything
27923>>>>>>>    Define rlSaveRestoreLayout     // just load and save the layout (position of toolbars)
27923>>>>>>>    Define rlSaveRestoreFullLayout // load/save layout plus addition info such as theme, large icons, etc.
27923>>>>>>>    Define rlSaveRestoreAll        // load and save layout and the controls (useful if you customize)
27923>>>>>>>End_Enum_List
27923>>>>>>>
27923>>>>>>>Enum_List
27923>>>>>>>    Define stNoStretch
27923>>>>>>>    Define stStretch
27923>>>>>>>    Define stStretchShared
27923>>>>>>>End_Enum_List
27923>>>>>>>
27923>>>>>>>// special StatusBar Id valus (piID) values for statusbar panes.
27923>>>>>>>Enum_List
27923>>>>>>>    Define sbpIDAutoAssign for -1    // ID will be auto assigned during pane's end_construct_Object
27923>>>>>>>    Define sbpIDIdlePane   for 0     // Used to display idle text and the DescriptionText of controls on mouse over. 
27923>>>>>>>    Define sbpIDCapslock   for 59137 // Indicates whether CAPS Lock is on or off. 
27923>>>>>>>    Define sbpIDNumLock    for 59138 // Indicates whether Num Lock is on or off. 
27923>>>>>>>    Define sbpIDScrollLock for 59139 // Indicates whether Scroll Lock is on or off 
27923>>>>>>>End_Enum_List
27923>>>>>>>
27923>>>>>>>// this keeps track of a global commandbars, which should be the Main menu's commandBars object
27923>>>>>>>// context menus use this to attach to commandbars
27923>>>>>>>Global_Variable Integer ghoCommandBars
27923>>>>>>>Move 0 to ghoCommandBars
27924>>>>>>>
27924>>>>>>>
27924>>>>>>>
27924>>>>>>>
27924>>>>>>>
27924>>>>>>>Class cCJCommandBarSystem is a cCJCommandBars
27925>>>>>>>    
27925>>>>>>>    Procedure Construct_Object
27927>>>>>>>        Handle hoTimer hoMain
27927>>>>>>>        Forward Send Construct_Object
27929>>>>>>>        
27929>>>>>>>        // do we save/restore command bars and if so how 
27929>>>>>>>        Property Integer peRestoreLayout rlNoSaveRestore
27930>>>>>>>        
27930>>>>>>>        // This allows developers to control when a load layout should not be used
27930>>>>>>>        // because it is out of date. Just keep incrementing this value when you change
27930>>>>>>>        // something that is not compatible
27930>>>>>>>        Property Integer piLayoutBuild 1
27931>>>>>>>        
27931>>>>>>>        // Name used to save a store commandbars. Can be changed to create
27931>>>>>>>        // custom setups.
27931>>>>>>>        Property String  psLayoutSection "CommandBars"
27932>>>>>>>        
27932>>>>>>>        // if true this expects client area and a panel. Auto assigned
27932>>>>>>>        Property Boolean pbMDIMenu False
27933>>>>>>>                
27933>>>>>>>        Property Handle phoStatusBar 0 // assigned automatically
27934>>>>>>>        
27934>>>>>>>        Property Integer pePrivateVisualTheme xtpThemeWhidbey               
27935>>>>>>>        Property Boolean pbPrivateEnableCustomization False
27936>>>>>>>        Property Boolean pbPrivateAltDragCustomization False
27937>>>>>>>        Property Integer pePrivateAnimation xtpAnimateWindowsDefault
27938>>>>>>>        Property Boolean pbPrivateLargeIcons False
27939>>>>>>>        Property Boolean pbPrivateShowTextBelowIcons False
27940>>>>>>>        Property Boolean pbPrivateAlwaysShowFullMenus True
27941>>>>>>>        Property Boolean pbPrivateShowFullAfterDelay True
27942>>>>>>>        Property Boolean pbPrivateOfficeStyleDisabledIcons False
27943>>>>>>>        Property Boolean pbPrivateIconsWithShadow True
27944>>>>>>>        Property Boolean pbPrivateToolBarScreenTips True
27945>>>>>>>        Property Boolean pbPrivateShowPopupBarToolTips False
27946>>>>>>>        Property Boolean pbPrivateToolBarAccelTips True
27947>>>>>>>        Property Boolean pbPrivateAutoHideUnusedPopups False
27948>>>>>>>        Property Boolean pbPrivateShowExpandButtonAlways False
27949>>>>>>>        Property Boolean pbPrivateSyncFloatingToolbars True
27950>>>>>>>        Property Boolean pbPrivateFloatToolbarsByDoubleClick False
27951>>>>>>>        Property Boolean pbPrivateAutoResizeIcons False
27952>>>>>>>
27952>>>>>>>        Property Boolean pbCustomizeShowKeyboardPage False
27953>>>>>>>        Property Boolean pbCustomizeShowOptionsPage False
27954>>>>>>>
27954>>>>>>>        // This is design-time only.
27954>>>>>>>        Property Boolean pbTabbedWorkspaces False
27955>>>>>>>        // This is mostly design-time only.
27955>>>>>>>        Property Boolean pbCenterTabbedViews True
27956>>>>>>>        // these will not be exposed. 
27956>>>>>>>        //Property Boolean pbShowIconsShadow // ????
27956>>>>>>>        //Property Boolean pbGenerateDisabledcIcons  // ????
27956>>>>>>>        //Property Boolean pbUseFadedIcons
27956>>>>>>>        //Property Integer piExpandDelay
27956>>>>>>>        //Property Integer piExplandHoverDelay
27956>>>>>>>        //Property Integer peShowKbdCues
27956>>>>>>>        //Property Integer peUseKbdCues
27956>>>>>>>        //Property Integer piMaxPopupWidth
27956>>>>>>>        //Property Integer piIconsSize // folded??
27956>>>>>>>        //Property Integer piLargeIconSize
27956>>>>>>>        //Property Integer piPopupIconSize
27956>>>>>>>
27956>>>>>>>        
27956>>>>>>>        Property Handle phoPrivateActions           (Create(Self,U_cCJCommandBarActions))
27957>>>>>>>        Property Handle phoPrivateDesignerControls  (Create(Self,U_cCJCommandBarControls))
27958>>>>>>>        Property Handle phoPrivateKeyBindings       (Create(Self,U_cCJKeyBindings))
27959>>>>>>>        Property Handle phoPrivateOptions           (Create(Self,U_cCJCommandBarsOptions))
27960>>>>>>>        Property Boolean pbPrivateTimerUpdate True
27961>>>>>>>        
27961>>>>>>>        // array of all registered actions (i.e., actions that have a DF object and are COM instanciated)
27961>>>>>>>        Property Handle[] phoRegisteredActions
27962>>>>>>>        
27962>>>>>>>        // array of actions that should actively updated via timer refresh
27962>>>>>>>        Property Handle[] phoActiveUpdates
27963>>>>>>>        
27963>>>>>>>        // array of action IDs that can be reused. We do this because we cannot destroy actions
27963>>>>>>>        Property Integer[] piActionIdPool
27964>>>>>>>        
27964>>>>>>>        // last auto assigned BarId
27964>>>>>>>        Property Integer piLastBarId ID_CommandBarIDAutoStart
27965>>>>>>>        
27965>>>>>>>        // last auto assigned image ID
27965>>>>>>>        Property Integer piLastImageId ID_ImageAutoStart
27966>>>>>>>        
27966>>>>>>>        // used to determine of Load should occur. When the count changes in the
27966>>>>>>>        // the action IDs or barIds it is not safe to reload things.
27966>>>>>>>        Property Integer piLastAssignedDesignTimeID 0 
27967>>>>>>>        Property Integer piLastAssignedDesignTimeBarID 0 
27968>>>>>>>
27968>>>>>>>        Property Handle phoTimer 0
27969>>>>>>>        
27969>>>>>>>        Get Create U_cCJIdleHandler to hoTimer
27970>>>>>>>        Set phoTimer to hoTimer
27971>>>>>>>
27971>>>>>>>        Get Main_Panel_id to hoMain
27972>>>>>>>        Set peAutoCreate to acDeferredAutoCreate
27973>>>>>>>        Set peNeighborhood to nhPublic
27974>>>>>>>        // if commandbar is part of a focusable ring (like a view) we never want it to
27974>>>>>>>        // take the focus
27974>>>>>>>        Set Skip_State to True
27975>>>>>>>        
27975>>>>>>>        Send AssignMDIMenu // determine if this is an MDI commandbar.
27976>>>>>>>        
27976>>>>>>>        
27976>>>>>>>        
27976>>>>>>>    End_Procedure
27977>>>>>>>    
27977>>>>>>>    
27977>>>>>>>    // this will figure out if this is an MDI menu and assign the ghoCommandBars
27977>>>>>>>    // global variable if needed.
27977>>>>>>>    // We assume it is MDI if the main_panel_id is commandbars parent and it is MDI style 
27977>>>>>>>    Procedure AssignMDIMenu
27979>>>>>>>        Handle hoMain hoParent
27979>>>>>>>        Boolean bIsMdi
27979>>>>>>>        Get parent to hoParent
27980>>>>>>>        Get Main_Panel_Id to hoMain
27981>>>>>>>        Move (hoMain and hoMain=hoParent and  MDI_State(hoMain)) to bIsMdi
27982>>>>>>>        Set pbMDIMenu to bIsMdi
27983>>>>>>>        If bIsMdi Begin
27985>>>>>>>            Set phoCommandBars of hoMain to Self
27986>>>>>>>            Move Self to ghoCommandBars
27987>>>>>>>        End
27987>>>>>>>>
27987>>>>>>>    End_Procedure
27988>>>>>>>    
27988>>>>>>>    Function IsMDIMenu Returns Boolean
27990>>>>>>>        Boolean bMDI
27990>>>>>>>        Get pbMDIMenu to bMDI
27991>>>>>>>        Function_Return bMDI
27992>>>>>>>    End_Function
27993>>>>>>>    
27993>>>>>>>    // returns the ClientArea DF object if this is an MDI style system.
27993>>>>>>>    Function ClientAreaObject Returns Handle
27995>>>>>>>        Boolean bMDI
27995>>>>>>>        Handle hoClientArea
27995>>>>>>>        Get IsMDIMenu to bMDI
27996>>>>>>>        If (bMDI) Begin
27998>>>>>>>            Get Client_Id of (Parent(Self)) to hoClientArea
27999>>>>>>>        End
27999>>>>>>>>
27999>>>>>>>        Function_Return hoClientArea
28000>>>>>>>    End_Function
28001>>>>>>>    
28001>>>>>>>    // Generic Get and Set property that is used to get and set a DF/COM options property.
28001>>>>>>>    // can be used by any integer or boolean property
28001>>>>>>>    
28001>>>>>>>    Procedure SetComOptionsProperty Handle hmPrivateProperty Handle hmCOMProperty Integer iValue
28003>>>>>>>        Handle hoOptions
28003>>>>>>>        Set hmPrivateProperty to iValue
28004>>>>>>>        If (IsComObjectCreated(Self)) Begin
28006>>>>>>>            Get OptionsObject to hoOptions
28007>>>>>>>            Set hmCOMProperty of hoOptions to iValue
28008>>>>>>>        End
28008>>>>>>>>
28008>>>>>>>    End_Procedure
28009>>>>>>>    
28009>>>>>>>    Function GetComOptionsProperty Handle hmPrivateProperty Handle hmCOMProperty Returns Integer
28011>>>>>>>        Handle hoOptions
28011>>>>>>>        Integer iValue
28011>>>>>>>        If (IsComObjectCreated(Self)) Begin
28013>>>>>>>            Get OptionsObject to hoOptions
28014>>>>>>>            Get hmCOMProperty of hoOptions to iValue
28015>>>>>>>        End
28015>>>>>>>>
28015>>>>>>>        Else Begin
28016>>>>>>>            Get hmPrivateProperty to iValue
28017>>>>>>>        End
28017>>>>>>>>
28017>>>>>>>        Function_Return iValue
28018>>>>>>>    End_Function
28019>>>>>>>    
28019>>>>>>>    // You can call this to handle whatever Theme or Custom theme you have. This is
28019>>>>>>>    // called by Set peVisualTheme
28019>>>>>>>    Procedure ApplyVisualTheme Integer eTheme String sDll String sIni
28021>>>>>>>        Boolean bOk
28021>>>>>>>        Integer iOldAuto
28021>>>>>>>        If (sDll<>"") Begin
28023>>>>>>>            Get LoadResourceImagesFromFile sDll sIni to bOk
28024>>>>>>>            If (not(bOk)) Begin
28026>>>>>>>                Error DFERR_PROGRAM (SFormat("Cannot load Theme resource file %1 %2",sDll,sIni))
28027>>>>>>>>
28027>>>>>>>            End
28027>>>>>>>>
28027>>>>>>>        End
28027>>>>>>>>
28027>>>>>>>        Get pbAutoResizeIcons to iOldAuto
28028>>>>>>>        Set ComVisualTheme to eTheme
28029>>>>>>>        Set pbAutoResizeIcons to iOldAuto
28030>>>>>>>    End_Procedure
28031>>>>>>>
28031>>>>>>>        
28031>>>>>>>    // This converts our thems to themes that can be used by Codejock and its system
28031>>>>>>>    // of using dlls and inis for some themes. This will change over time and can be
28031>>>>>>>    // augmented for custom values 
28031>>>>>>>    Procedure VisualThemeParams Integer ByRef eTheme String ByRef sDll String ByRef sIni
28033>>>>>>>        Case Begin
28033>>>>>>>            Case (eTheme=xtpThemeOffice2007)
28035>>>>>>>            Case (eTheme=xtpThemeResource)
28038>>>>>>>            Case (eTheme=xtpThemeOffice2007Blue)
28041>>>>>>>                Move "Office2007.dll" to sDll
28042>>>>>>>                Move "Office2007Blue.ini" to sIni
28043>>>>>>>                Move xtpThemeResource to eTheme
28044>>>>>>>                Case Break
28045>>>>>>>            Case (eTheme=xtpThemeOffice2007Aqua)
28048>>>>>>>                Move "Office2007.dll" to sDll
28049>>>>>>>                Move "Office2007Aqua.ini" to sIni
28050>>>>>>>                Move xtpThemeResource to eTheme
28051>>>>>>>                Case Break
28052>>>>>>>            Case (eTheme=xtpThemeOffice2007Black)
28055>>>>>>>                Move "Office2007.dll" to sDll
28056>>>>>>>                Move "Office2007Black.ini" to sIni
28057>>>>>>>                Move xtpThemeResource to eTheme
28058>>>>>>>                Case Break
28059>>>>>>>            Case (eTheme=xtpThemeOffice2007Silver)
28062>>>>>>>                Move "Office2007.dll" to sDll
28063>>>>>>>                Move "Office2007Silver.ini" to sIni
28064>>>>>>>                Move xtpThemeResource to eTheme
28065>>>>>>>                Case Break
28066>>>>>>>
28066>>>>>>>            Case (eTheme=xtpThemeOffice2010Blue)
28069>>>>>>>            Case (eTheme=xtpThemeOffice2010)
28072>>>>>>>                Move "Office2010.dll" to sDll
28073>>>>>>>                Move "Office2010Blue.ini" to sIni
28074>>>>>>>                Move xtpThemeResource to eTheme
28075>>>>>>>                Case Break
28076>>>>>>>            Case (eTheme=xtpThemeOffice2010Black)
28079>>>>>>>                Move "Office2010.dll" to sDll
28080>>>>>>>                Move "Office2010Black.ini" to sIni
28081>>>>>>>                Move xtpThemeResource to eTheme
28082>>>>>>>                Case Break
28083>>>>>>>            Case (eTheme=xtpThemeOffice2010Silver)
28086>>>>>>>                Move "Office2010.dll" to sDll
28087>>>>>>>                Move "Office2010Silver.ini" to sIni
28088>>>>>>>                Move xtpThemeResource to eTheme
28089>>>>>>>                Case Break
28090>>>>>>>
28090>>>>>>>            Case (eTheme=xtpThemeOffice2013)
28093>>>>>>>            Case (eTheme=xtpThemeOffice2013Word)
28096>>>>>>>                Move "Office2013.dll" to sDll
28097>>>>>>>                Move "Office2013Word.ini" to sIni
28098>>>>>>>                Move xtpThemeOffice2013 to eTheme
28099>>>>>>>                Case Break
28100>>>>>>>            Case (eTheme=xtpThemeOffice2013Excel)
28103>>>>>>>                Move "Office2013.dll" to sDll
28104>>>>>>>                Move "Office2013Excel.ini" to sIni
28105>>>>>>>                Move xtpThemeOffice2013 to eTheme
28106>>>>>>>                Case Break
28107>>>>>>>            Case (eTheme=xtpThemeOffice2013PowerPoint)
28110>>>>>>>                Move "Office2013.dll" to sDll
28111>>>>>>>                Move "Office2013PowerPoint.ini" to sIni
28112>>>>>>>                Move xtpThemeOffice2013 to eTheme
28113>>>>>>>                Case Break
28114>>>>>>>            Case (eTheme=xtpThemeOffice2013OutLook)
28117>>>>>>>                Move "Office2013.dll" to sDll
28118>>>>>>>                Move "Office2013OutLook.ini" to sIni
28119>>>>>>>                Move xtpThemeOffice2013 to eTheme
28120>>>>>>>                Case Break
28121>>>>>>>            Case (eTheme=xtpThemeOffice2013Publisher)
28124>>>>>>>                Move "Office2013.dll" to sDll
28125>>>>>>>                Move "Office2013Publisher.ini" to sIni
28126>>>>>>>                Move xtpThemeOffice2013 to eTheme
28127>>>>>>>                Case Break
28128>>>>>>>            Case (eTheme=xtpThemeOffice2013Access)
28131>>>>>>>                Move "Office2013.dll" to sDll
28132>>>>>>>                Move "Office2013Access.ini" to sIni
28133>>>>>>>                Move xtpThemeOffice2013 to eTheme
28134>>>>>>>                Case Break
28135>>>>>>>            Case (eTheme=xtpThemeOffice2013OneNote)
28138>>>>>>>                Move "Office2013.dll" to sDll
28139>>>>>>>                Move "Office2013OneNote.ini" to sIni
28140>>>>>>>                Move xtpThemeOffice2013 to eTheme
28141>>>>>>>                Case Break
28142>>>>>>>
28142>>>>>>>            Case (eTheme=xtpThemeWindows7)
28145>>>>>>>                Move "Windows7.dll" to sDll
28146>>>>>>>                Move "Windows7Blue.ini" to sIni
28147>>>>>>>                Move xtpThemeResource to eTheme
28148>>>>>>>                Case Break
28149>>>>>>>
28149>>>>>>>            Case (eTheme=xtpThemeVisualStudio2012)
28152>>>>>>>            Case (eTheme=xtpThemeVisualStudio2012Light)
28155>>>>>>>                Move "VisualStudio2012.dll" to sDll
28156>>>>>>>                Move "VisualStudio2012Light.ini" to sIni
28157>>>>>>>                Move xtpThemeVisualStudio2012 to eTheme
28158>>>>>>>                Case Break
28159>>>>>>>            Case (eTheme=xtpThemeVisualStudio2012Dark)
28162>>>>>>>                Move "VisualStudio2012.dll" to sDll
28163>>>>>>>                Move "VisualStudio2012Dark.ini" to sIni
28164>>>>>>>                Move xtpThemeVisualStudio2012 to eTheme
28165>>>>>>>                Case Break
28166>>>>>>>                
28166>>>>>>>            Case (eTheme=xtpThemeVisualStudio2015)
28169>>>>>>>            Case (eTheme=xtpThemeVisualStudio2015Blue)
28172>>>>>>>                Move "VisualStudio2015.dll" to sDll
28173>>>>>>>                Move "VisualStudio2015Blue.ini" to sIni
28174>>>>>>>                Move xtpThemeVisualStudio2015 to eTheme
28175>>>>>>>                Case Break
28176>>>>>>>            Case (eTheme=xtpThemeVisualStudio2015Light)
28179>>>>>>>                Move "VisualStudio2015.dll" to sDll
28180>>>>>>>                Move "VisualStudio2015Light.ini" to sIni
28181>>>>>>>                Move xtpThemeVisualStudio2015 to eTheme
28182>>>>>>>                Case Break
28183>>>>>>>            Case (eTheme=xtpThemeVisualStudio2015Dark)
28186>>>>>>>                Move "VisualStudio2015.dll" to sDll
28187>>>>>>>                Move "VisualStudio2015Dark.ini" to sIni
28188>>>>>>>                Move xtpThemeVisualStudio2015 to eTheme
28189>>>>>>>                Case Break
28190>>>>>>>            Case Else
28190>>>>>>>                Move "" to sDll
28191>>>>>>>                Move "" to sIni
28192>>>>>>>        Case End
28192>>>>>>>    End_Procedure
28193>>>>>>>                    
28193>>>>>>>                
28193>>>>>>>    Procedure Set peVisualTheme Integer eValue
28195>>>>>>>        String sDll sIni
28195>>>>>>>        Integer iOldAuto
28195>>>>>>>        Set pePrivateVisualTheme to eValue
28196>>>>>>>        If (IsComObjectCreated(Self)) Begin
28198>>>>>>>            Send VisualThemeParams (&eValue) (&sDll) (&sIni)
28199>>>>>>>            Send ApplyVisualTheme eValue sDll sIni
28200>>>>>>>        End
28200>>>>>>>>
28200>>>>>>>    End_Procedure
28201>>>>>>>    
28201>>>>>>>    Function peVisualTheme Returns Integer
28203>>>>>>>        Integer eValue
28203>>>>>>>        // always returns our version of the theme because we have custom values
28203>>>>>>>        // If you need the actual theme use ComVisualTheme
28203>>>>>>>        Get pePrivateVisualTheme to eValue
28204>>>>>>>        Function_Return eValue
28205>>>>>>>    End_Function
28206>>>>>>>        
28206>>>>>>>    Procedure Set pbEnableCustomization Boolean bValue
28208>>>>>>>        Set pbPrivateEnableCustomization to bValue
28209>>>>>>>        If (IsComObjectCreated(Self)) Begin
28211>>>>>>>            Send ComEnableCustomization bValue
28212>>>>>>>        End
28212>>>>>>>>
28212>>>>>>>    End_Procedure
28213>>>>>>>    
28213>>>>>>>    Function pbEnableCustomization Returns Boolean
28215>>>>>>>        Boolean bValue
28215>>>>>>>        Get pbPrivateEnableCustomization to bValue
28216>>>>>>>        Function_Return bValue
28217>>>>>>>    End_Function
28218>>>>>>>
28218>>>>>>>    
28218>>>>>>>    // these are set in the cCJCommandBars's Option object
28218>>>>>>>
28218>>>>>>>    Procedure Set peAnimation Integer eValue
28220>>>>>>>        Send SetComOptionsProperty set_pePrivateAnimation set_ComAnimation eValue
28221>>>>>>>    End_Procedure
28222>>>>>>>    
28222>>>>>>>    Function peAnimation Returns Integer
28224>>>>>>>        Integer eValue
28224>>>>>>>        Get GetComOptionsProperty get_pePrivateAnimation get_ComAnimation to eValue
28225>>>>>>>        Function_Return eValue
28226>>>>>>>    End_Function
28227>>>>>>>    
28227>>>>>>>
28227>>>>>>>    Procedure Set pbAlwaysShowFullMenus Boolean bValue
28229>>>>>>>        Send SetComOptionsProperty set_pbPrivateAlwaysShowFullMenus set_ComAlwaysShowFullMenus bValue
28230>>>>>>>    End_Procedure
28231>>>>>>>    
28231>>>>>>>    Function pbAlwaysShowFullMenus Returns Boolean
28233>>>>>>>        Boolean bValue
28233>>>>>>>        Get GetComOptionsProperty get_pbPrivateAlwaysShowFullMenus get_ComAlwaysShowFullMenus to bValue
28234>>>>>>>        Function_Return bValue
28235>>>>>>>    End_Function
28236>>>>>>>    
28236>>>>>>>    Procedure Set pbShowFullAfterDelay Boolean bValue
28238>>>>>>>        Send SetComOptionsProperty set_pbPrivateShowFullAfterDelay set_ComShowFullAfterDelay bValue
28239>>>>>>>    End_Procedure
28240>>>>>>>    
28240>>>>>>>    Function pbShowFullAfterDelay Returns Boolean
28242>>>>>>>        Boolean bValue
28242>>>>>>>        Get GetComOptionsProperty get_pbPrivateShowFullAfterDelay get_ComShowFullAfterDelay to bValue
28243>>>>>>>        Function_Return bValue
28244>>>>>>>    End_Function
28245>>>>>>>
28245>>>>>>>    Procedure Set pbAutoHideUnusedPopups Boolean bValue
28247>>>>>>>        Send SetComOptionsProperty set_pbPrivateAutoHideUnusedPopups set_ComAutoHideUnusedPopups bValue
28248>>>>>>>    End_Procedure
28249>>>>>>>    
28249>>>>>>>    Function pbAutoHideUnusedPopups Returns Boolean
28251>>>>>>>        Boolean bValue
28251>>>>>>>        Get GetComOptionsProperty get_pbPrivateAutoHideUnusedPopups get_ComAutoHideUnusedPopups to bValue
28252>>>>>>>        Function_Return bValue
28253>>>>>>>    End_Function
28254>>>>>>>
28254>>>>>>>    Procedure Set pbToolBarScreenTips Boolean bValue
28256>>>>>>>        Send SetComOptionsProperty set_pbPrivateToolBarScreenTips set_ComToolBarScreenTips bValue
28257>>>>>>>    End_Procedure
28258>>>>>>>    
28258>>>>>>>    Function pbToolBarScreenTips Returns Boolean
28260>>>>>>>        Boolean bValue
28260>>>>>>>        Get GetComOptionsProperty get_pbPrivateToolBarScreenTips get_ComToolBarScreenTips to bValue
28261>>>>>>>        Function_Return bValue
28262>>>>>>>    End_Function
28263>>>>>>>
28263>>>>>>>    Procedure Set pbShowPopupBarToolTips Boolean bValue
28265>>>>>>>        Send SetComOptionsProperty set_pbPrivateShowPopupBarToolTips set_ComShowPopupBarToolTips bValue
28266>>>>>>>    End_Procedure
28267>>>>>>>    
28267>>>>>>>    Function pbShowPopupBarToolTips Returns Boolean
28269>>>>>>>        Boolean bValue
28269>>>>>>>        Get GetComOptionsProperty get_pbPrivateShowPopupBarToolTips get_ComShowPopupBarToolTips to bValue
28270>>>>>>>        Function_Return bValue
28271>>>>>>>    End_Function
28272>>>>>>>
28272>>>>>>>    Procedure Set pbToolBarAccelTips Boolean bValue
28274>>>>>>>        Send SetComOptionsProperty set_pbPrivateToolBarAccelTips set_ComToolBarAccelTips bValue
28275>>>>>>>    End_Procedure
28276>>>>>>>    
28276>>>>>>>    Function pbToolBarAccelTips Returns Boolean
28278>>>>>>>        Boolean bValue
28278>>>>>>>        Get GetComOptionsProperty get_pbPrivateToolBarAccelTips get_ComToolBarAccelTips to bValue
28279>>>>>>>        Function_Return bValue
28280>>>>>>>    End_Function
28281>>>>>>>
28281>>>>>>>    Procedure Set pbShowExpandButtonAlways Boolean bValue
28283>>>>>>>        Send SetComOptionsProperty set_pbPrivateShowExpandButtonAlways set_ComShowExpandButtonAlways bValue
28284>>>>>>>    End_Procedure
28285>>>>>>>    
28285>>>>>>>    Function pbShowExpandButtonAlways Returns Boolean
28287>>>>>>>        Boolean bValue
28287>>>>>>>        Get GetComOptionsProperty get_pbPrivateShowExpandButtonAlways get_ComShowExpandButtonAlways to bValue
28288>>>>>>>        Function_Return bValue
28289>>>>>>>    End_Function
28290>>>>>>>
28290>>>>>>>    Procedure Set pbLargeIcons Boolean bValue
28292>>>>>>>        Send SetComOptionsProperty set_pbPrivateLargeIcons set_ComLargeIcons bValue
28293>>>>>>>    End_Procedure
28294>>>>>>>    
28294>>>>>>>    Function pbLargeIcons Returns Boolean
28296>>>>>>>        Boolean bValue
28296>>>>>>>        Get GetComOptionsProperty get_pbPrivateLargeIcons get_ComLargeIcons to bValue
28297>>>>>>>        Function_Return bValue
28298>>>>>>>    End_Function
28299>>>>>>>
28299>>>>>>>    Procedure Set pbSyncFloatingToolbars Boolean bValue
28301>>>>>>>        Send SetComOptionsProperty set_pbPrivateSyncFloatingToolbars set_ComSyncFloatingToolbars bValue
28302>>>>>>>    End_Procedure
28303>>>>>>>    
28303>>>>>>>    Function pbSyncFloatingToolbars Returns Boolean
28305>>>>>>>        Boolean bValue
28305>>>>>>>        Get GetComOptionsProperty get_pbPrivateSyncFloatingToolbars get_ComSyncFloatingToolbars to bValue
28306>>>>>>>        Function_Return bValue
28307>>>>>>>    End_Function
28308>>>>>>>
28308>>>>>>>    Procedure Set pbFloatToolbarsByDoubleClick Boolean bValue
28310>>>>>>>        Send SetComOptionsProperty set_pbPrivateFloatToolbarsByDoubleClick set_ComFloatToolbarsByDoubleClick bValue
28311>>>>>>>    End_Procedure
28312>>>>>>>    
28312>>>>>>>    Function pbFloatToolbarsByDoubleClick Returns Boolean
28314>>>>>>>        Boolean bValue
28314>>>>>>>        Get GetComOptionsProperty get_pbPrivateFloatToolbarsByDoubleClick get_ComFloatToolbarsByDoubleClick to bValue
28315>>>>>>>        Function_Return bValue
28316>>>>>>>    End_Function
28317>>>>>>>
28317>>>>>>>    Procedure Set pbShowTextBelowIcons Boolean bValue
28319>>>>>>>        Send SetComOptionsProperty set_pbPrivateShowTextBelowIcons set_ComShowTextBelowIcons bValue
28320>>>>>>>    End_Procedure
28321>>>>>>>    
28321>>>>>>>    Function pbShowTextBelowIcons Returns Boolean
28323>>>>>>>        Boolean bValue
28323>>>>>>>        Get GetComOptionsProperty get_pbPrivateShowTextBelowIcons get_ComShowTextBelowIcons to bValue
28324>>>>>>>        Function_Return bValue
28325>>>>>>>    End_Function
28326>>>>>>>
28326>>>>>>>    Procedure Set pbAltDragCustomization Boolean bValue
28328>>>>>>>        Send SetComOptionsProperty set_pbPrivateAltDragCustomization set_ComAltDragCustomization bValue
28329>>>>>>>    End_Procedure
28330>>>>>>>    
28330>>>>>>>    Function pbAltDragCustomization Returns Boolean
28332>>>>>>>        Boolean bValue
28332>>>>>>>        Get GetComOptionsProperty get_pbPrivateAltDragCustomization get_ComAltDragCustomization to bValue
28333>>>>>>>        Function_Return bValue
28334>>>>>>>    End_Function
28335>>>>>>>
28335>>>>>>>    Procedure Set pbOfficeStyleDisabledIcons Boolean bValue
28337>>>>>>>        Send SetComOptionsProperty set_pbPrivateOfficeStyleDisabledIcons set_ComOfficeStyleDisabledIcons bValue
28338>>>>>>>    End_Procedure
28339>>>>>>>    
28339>>>>>>>    Function pbOfficeStyleDisabledIcons Returns Boolean
28341>>>>>>>        Boolean bValue
28341>>>>>>>        Get GetComOptionsProperty get_pbPrivateOfficeStyleDisabledIcons get_ComOfficeStyleDisabledIcons to bValue
28342>>>>>>>        Function_Return bValue
28343>>>>>>>     End_Function
28344>>>>>>>
28344>>>>>>>    Procedure Set pbIconsWithShadow Boolean bValue
28346>>>>>>>        Send SetComOptionsProperty set_pbPrivateIconsWithShadow set_ComIconsWithShadow bValue
28347>>>>>>>    End_Procedure
28348>>>>>>>    
28348>>>>>>>    Function pbIconsWithShadow Returns Boolean
28350>>>>>>>        Boolean bValue
28350>>>>>>>        Get GetComOptionsProperty get_pbPrivateIconsWithShadow get_ComIconsWithShadow to bValue
28351>>>>>>>        Function_Return bValue
28352>>>>>>>     End_Function
28353>>>>>>>
28353>>>>>>>    Procedure Set pbTimerUpdate Boolean bValue
28355>>>>>>>        Handle hoTimer
28355>>>>>>>        Set pbPrivateTimerUpdate to bValue
28356>>>>>>>        If (IsComObjectCreated(Self)) Begin
28358>>>>>>>            Get phoTimer to hoTimer
28359>>>>>>>            Set pbEnabled of hoTimer to bValue
28360>>>>>>>        End
28360>>>>>>>>
28360>>>>>>>    End_Procedure
28361>>>>>>>    
28361>>>>>>>    Function pbTimerUpdate Returns Boolean
28363>>>>>>>        Boolean bValue
28363>>>>>>>        Get pbPrivateTimerUpdate to bValue
28364>>>>>>>        Function_Return bValue
28365>>>>>>>    End_Function
28366>>>>>>>
28366>>>>>>>
28366>>>>>>>    Procedure Set pbAutoResizeIcons Boolean bValue
28368>>>>>>>        Handle hoPaint
28368>>>>>>>        Variant vPaint
28368>>>>>>>        
28368>>>>>>>        Set pbPrivateAutoResizeIcons to bValue
28369>>>>>>>        If (IsComObjectCreated(Self)) Begin
28371>>>>>>>            Get Create (RefClass(cCJPaintManager)) to hoPaint
28372>>>>>>>            Get ComPaintManager to vPaint
28373>>>>>>>            Set pvComObject of hoPaint to vPaint
28374>>>>>>>            Set ComAutoResizeIcons of hoPaint to bValue
28375>>>>>>>            Send Destroy of hoPaint
28376>>>>>>>        End
28376>>>>>>>>
28376>>>>>>>    End_Procedure
28377>>>>>>>    
28377>>>>>>>    Function pbAutoResizeIcons Returns Boolean
28379>>>>>>>        Boolean bValue
28379>>>>>>>        Get pbPrivateAutoResizeIcons to bValue
28380>>>>>>>        Function_Return bValue
28381>>>>>>>    End_Function
28382>>>>>>>
28382>>>>>>>
28382>>>>>>>    // returns the CommandBars object handle, which is this object. All menu objects
28382>>>>>>>    // within a command bar will get this via delegation. The exception is context menus (and
28382>>>>>>>    // children of context menus) which uses the global commandbars variable instead.
28382>>>>>>>    Function CommandBarSystemObject Returns Handle
28384>>>>>>>        Function_Return Self
28385>>>>>>>    End_Function
28386>>>>>>>    
28386>>>>>>>    // these are here to make life easier. These return a df-object attached to
28386>>>>>>>    // the following collecions and child objects. These are used enough that
28386>>>>>>>    // an easy access to them was provided. 
28386>>>>>>>    
28386>>>>>>>    Function ActionsCollection Returns Handle
28388>>>>>>>        Handle hoPrivate
28388>>>>>>>        Variant vCom
28388>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28390>>>>>>>            Function_Return 0
28391>>>>>>>        End
28391>>>>>>>>
28391>>>>>>>        
28391>>>>>>>        Get phoPrivateActions to hoPrivate
28392>>>>>>>        Get ComActions of hoPrivate to vCom
28393>>>>>>>        Set pvComObject of hoPrivate to vCom
28394>>>>>>>        Function_Return hoPrivate
28395>>>>>>>    End_Function
28396>>>>>>>    
28396>>>>>>>    Function DesignerControlsCollection Returns Handle
28398>>>>>>>        Handle hoPrivate
28398>>>>>>>        Variant vCom
28398>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28400>>>>>>>            Function_Return 0
28401>>>>>>>        End
28401>>>>>>>>
28401>>>>>>>        
28401>>>>>>>        Get phoPrivateDesignerControls to hoPrivate
28402>>>>>>>        Get ComDesignerControls to vCom
28403>>>>>>>        Set pvComObject of hoPrivate to vCom
28404>>>>>>>        Function_Return hoPrivate
28405>>>>>>>    End_Function
28406>>>>>>>    
28406>>>>>>>    Function KeyBindingsCollection Returns Handle
28408>>>>>>>        Handle hoPrivate
28408>>>>>>>        Variant vCom
28408>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28410>>>>>>>            Function_Return 0
28411>>>>>>>        End
28411>>>>>>>>
28411>>>>>>>        
28411>>>>>>>        Get phoPrivateKeyBindings to hoPrivate
28412>>>>>>>        Get ComKeyBindings to vCom
28413>>>>>>>        Set pvComObject of hoPrivate to vCom
28414>>>>>>>        Function_Return hoPrivate
28415>>>>>>>    End_Function
28416>>>>>>>    
28416>>>>>>>    Function OptionsObject Returns Handle
28418>>>>>>>        Handle hoPrivate
28418>>>>>>>        Variant vCom
28418>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28420>>>>>>>            Function_Return 0
28421>>>>>>>        End
28421>>>>>>>>
28421>>>>>>>        
28421>>>>>>>        Get phoPrivateOptions to hoPrivate
28422>>>>>>>        Get ComOptions to vCom
28423>>>>>>>        Set pvComObject of hoPrivate to vCom
28424>>>>>>>        Function_Return hoPrivate
28425>>>>>>>    End_Function
28426>>>>>>>
28426>>>>>>>   
28426>>>>>>>    // when a commandbars is deactivated, this is called.
28426>>>>>>>    // save layout as needed
28426>>>>>>>    // release all of the action objects in the various arrays
28426>>>>>>>    // make sure that all DF objects are released.
28426>>>>>>>    // One oddity is that at this point the object is deactivated and this causes the
28426>>>>>>>    // statubar's visibleState to always be false. We correct for this in the statusbar's pbVisible
28426>>>>>>>    Procedure ReleaseComObject
28428>>>>>>>        Handle[] hoObjects hoEmpty 
28430>>>>>>>        Handle hoTimer hoObj
28430>>>>>>>        Integer i iCount
28430>>>>>>>        Variant vTab
28430>>>>>>>
28430>>>>>>>        Get phoTimer to hoTimer
28431>>>>>>>        Set pbEnabled of hoTimer to False
28432>>>>>>>        
28432>>>>>>>        Send SaveEnvironment // save layout if needed
28433>>>>>>>
28433>>>>>>>        // clear the active updates array
28433>>>>>>>        Set phoActiveUpdates to hoEmpty
28434>>>>>>>        
28434>>>>>>>        // release all actions attached to DF objects. This will release actions
28434>>>>>>>        // in context menus
28434>>>>>>>        Get phoRegisteredActions to hoObjects
28435>>>>>>>        Move (SizeOfArray(hoObjects)) to iCount
28436>>>>>>>        For i from 0 to (iCount-1)
28442>>>>>>>>
28442>>>>>>>            // it's possible that we've got actions that have been already been destroyed during shut down (context menus)
28442>>>>>>>            Get Object_Id of hoObjects[i] to hoObj
28443>>>>>>>            If hoObj Begin
28445>>>>>>>                Send ReleaseComObject of hoObj
28446>>>>>>>            End
28446>>>>>>>>
28446>>>>>>>        Loop
28447>>>>>>>>
28447>>>>>>>        Set phoRegisteredActions to hoEmpty
28448>>>>>>>        
28448>>>>>>>        // this should not be needed, but it can't hurt.
28448>>>>>>>        Broadcast Recursive_up Send ReleaseComObject 
28450>>>>>>>        Send OnRelease
28451>>>>>>>        Forward Send ReleaseComObject
28453>>>>>>>    End_Procedure 
28454>>>>>>>
28454>>>>>>>    Procedure OnCreateTabbedWorkspace Handle hoTabWorkspace Handle hoTabPaintManager
28456>>>>>>>    End_Procedure
28457>>>>>>>    
28457>>>>>>>    // This sets all of the commandbars properties and the options properties
28457>>>>>>>    Procedure CreateCommandBars
28459>>>>>>>        Handle hWND hoClient hoMain hoOptions hoImageManager hoCommandBar hoTimer hoPaint
28459>>>>>>>        Variant vToolbarObject vImageManager vPaint
28459>>>>>>>        Integer eVisualTheme eAnimation
28459>>>>>>>        Integer iLast
28459>>>>>>>        Boolean bMDIMEnu
28459>>>>>>>        Boolean bEnableCustomization bAltDragCustomization bLargeIcons bShowTextBelowIcons bAlwaysShowFullMenus bShowFullAfterDelay
28459>>>>>>>        Boolean bToolBarScreenTips bToolBarAccelTips bShowPopupBarToolTips bAutoHideUnusedPopups
28459>>>>>>>        Boolean bOfficeStyleDisabledIcons bFloatToolbarsByDoubleClick bSyncFloatingToolbars bShowExpandButtonAlways bIconsWithShadow
28459>>>>>>>        Boolean bTimer bAutoResizeIcons bTabbedWorkspaces
28459>>>>>>>    
28459>>>>>>>        Get pePrivateVisualTheme to eVisualTheme
28460>>>>>>>        Get pbPrivateEnableCustomization to bEnableCustomization
28461>>>>>>>        Get pbPrivateAltDragCustomization to bAltDragCustomization
28462>>>>>>>        Get pePrivateAnimation to eAnimation
28463>>>>>>>        Get pbPrivateLargeIcons to bLargeIcons
28464>>>>>>>        Get pbPrivateShowTextBelowIcons to bShowTextBelowIcons
28465>>>>>>>        Get pbPrivateAlwaysShowFullMenus to bAlwaysShowFullMenus
28466>>>>>>>        Get pbPrivateShowFullAfterDelay to bShowFullAfterDelay
28467>>>>>>>        Get pbPrivateToolBarScreenTips to bToolBarScreenTips
28468>>>>>>>        Get pbPrivateToolBarAccelTips to bToolBarAccelTips
28469>>>>>>>        Get pbPrivateShowPopupBarToolTips to bShowPopupBarToolTips  
28470>>>>>>>        Get pbPrivateOfficeStyleDisabledIcons to bOfficeStyleDisabledIcons   
28471>>>>>>>        Get pbPrivateIconsWithShadow to bIconsWithShadow
28472>>>>>>>        Get pbPrivateFloatToolbarsByDoubleClick to bFloatToolbarsByDoubleClick  
28473>>>>>>>        Get pbPrivateSyncFloatingToolbars   to bSyncFloatingToolbars
28474>>>>>>>        Get pbPrivateShowExpandButtonAlways to bShowExpandButtonAlways
28475>>>>>>>        Get pbPrivateAutoHideUnusedPopups   to bAutoHideUnusedPopups
28476>>>>>>>        Get pbPrivateAutoResizeIcons        to bAutoResizeIcons
28477>>>>>>>        Get pbTabbedWorkspaces to bTabbedWorkspaces
28478>>>>>>>        
28478>>>>>>>        // attach to parent window. This should actually happen automatically
28478>>>>>>>        Get Parent to hoMain
28479>>>>>>>        Get Window_Handle of hoMain to hWND
28480>>>>>>>        Send ComAttachToWindow hWND
28481>>>>>>>    
28481>>>>>>>        // if an MDI menu, find and set the client area 
28481>>>>>>>        Get pbMDIMenu to bMDIMenu
28482>>>>>>>        If bMDIMEnu Begin
28484>>>>>>>            Get ClientAreaObject to hoClient
28485>>>>>>>            If hoClient Begin
28487>>>>>>>                If not (Active_State(hoClient)) Begin
28489>>>>>>>                    Send Add_Focus of hoClient hoMain
28490>>>>>>>                End
28490>>>>>>>>
28490>>>>>>>                Get Window_Handle of hoClient to hWND
28491>>>>>>>                Send ComSetMDIClient hWND
28492>>>>>>>            End
28492>>>>>>>>
28492>>>>>>>        End
28492>>>>>>>>
28492>>>>>>>        
28492>>>>>>>        // make sure the first command bar is a main menu 
28492>>>>>>>        Get Create U_cCJCommandBar to hoCommandBar
28493>>>>>>>        Get ComAddMenuBar "Main menu" to vToolbarObject
28494>>>>>>>        Set pvComObject of hoCommandBar to vToolbarObject
28495>>>>>>>        Set ComVisible of hoCommandBar to False
28496>>>>>>>        Send Destroy of hoCommandBar
28497>>>>>>>        
28497>>>>>>>            
28497>>>>>>>        // the following are set directly in the object
28497>>>>>>>        Set ComScaleMode to  xtpScalePixel
28498>>>>>>>        //Set ComVisualTheme to eVisualTheme
28498>>>>>>>        Set peVisualTheme to eVisualTheme
28499>>>>>>>        Send ComEnableCustomization bEnableCustomization
28500>>>>>>>        
28500>>>>>>>        // the following are set in the options object
28500>>>>>>>        Get OptionsObject to hoOptions
28501>>>>>>>        // event is completely disabled
28501>>>>>>>        //Set ComUpdatePeriod of hoOptions to 0 // we don't use this method, shut off the timer
28501>>>>>>>        Set ComAltDragCustomization of hoOptions to bAltDragCustomization
28502>>>>>>>        Set ComAnimation of hoOptions to eAnimation
28503>>>>>>>        Set ComLargeIcons of hoOptions to bLargeIcons
28504>>>>>>>        Set ComShowTextBelowIcons of hoOptions to bShowTextBelowIcons
28505>>>>>>>        Set ComShowFullAfterDelay of hoOptions to bShowFullAfterDelay
28506>>>>>>>        Set ComAlwaysShowFullMenus of hoOptions to bAlwaysShowFullMenus
28507>>>>>>>        Set ComToolBarAccelTips of hoOptions to  bToolBarAccelTips
28508>>>>>>>        Set ComToolBarScreenTips of hoOptions to bToolBarScreenTips
28509>>>>>>>        Set ComShowPopupBarToolTips of hoOptions to bShowPopupBarToolTips  
28510>>>>>>>        Set ComOfficeStyleDisabledIcons of hoOptions to bOfficeStyleDisabledIcons
28511>>>>>>>        Set ComIconsWithShadow of hoOptions to bIconsWithShadow     
28512>>>>>>>        Set ComFloatToolbarsByDoubleClick of hoOptions to bFloatToolbarsByDoubleClick
28513>>>>>>>        Set ComSyncFloatingToolbars of hoOptions to bSyncFloatingToolbars
28514>>>>>>>        Set ComShowExpandButtonAlways of hoOptions to bShowExpandButtonAlways
28515>>>>>>>        Get ComAutoHideUnusedPopups of hoOptions to bAutoHideUnusedPopups
28516>>>>>>>        
28516>>>>>>>        // the following are set in the paint object
28516>>>>>>>        Get Create (RefClass(cCJPaintManager)) to hoPaint
28517>>>>>>>        Get ComPaintManager to vPaint
28518>>>>>>>        Set pvComObject of hoPaint to vPaint
28519>>>>>>>        Set ComAutoResizeIcons of hoPaint to bAutoResizeIcons
28520>>>>>>>        Send Destroy of hoPaint
28521>>>>>>>        
28521>>>>>>>        Send ComEnableActions
28522>>>>>>>    
28522>>>>>>>        // We must explicitly create an image list collection and add it to the object
28522>>>>>>>        Get Create U_cCJImageManager to hoImageManager
28523>>>>>>>        Send CreateComObject of hoImageManager
28524>>>>>>>        Get ComIcons of hoImageManager to vImageManager
28525>>>>>>>        Set ComIcons to vImageManager
28526>>>>>>>        Send destroy of hoImageManager
28527>>>>>>>    
28527>>>>>>>        // if tabbed workspace, enable it.
28527>>>>>>>        If (bTabbedWorkspaces) Begin
28529>>>>>>>            Send EnableTabbedWorkspace
28530>>>>>>>        End
28530>>>>>>>>
28530>>>>>>>    
28530>>>>>>>    
28530>>>>>>>        // event sent before any child objects are created.
28530>>>>>>>        Send OnCreateCommandBars
28531>>>>>>>    
28531>>>>>>>        // this creates all of the actions and items
28531>>>>>>>        Broadcast Send CreateComInstance
28533>>>>>>>        
28533>>>>>>>        // we keep track of the last action Id and last bar Id auto assigned.
28533>>>>>>>        // We use this to determine if a load environment can be safely done.
28533>>>>>>>        // Anything auto-assigned after this is considered to be dynamic.
28533>>>>>>>        Get LastAssignedId to iLast
28534>>>>>>>        Set piLastAssignedDesignTimeId to iLast
28535>>>>>>>        Get piLastBarId to iLast
28536>>>>>>>        Set piLastAssignedDesignTimeBarId to iLast
28537>>>>>>>    
28537>>>>>>>        Send LoadEnvironment // load layout if needed
28538>>>>>>>    
28538>>>>>>>        Get pbTimerUpdate to bTimer
28539>>>>>>>        If bTimer Begin
28541>>>>>>>            Get phoTimer to hoTimer
28542>>>>>>>            Set pbEnabled of hoTimer to True
28543>>>>>>>        End
28543>>>>>>>>
28543>>>>>>>    
28543>>>>>>>        Send ComRecalcLayout
28544>>>>>>>    End_Procedure
28545>>>>>>>    
28545>>>>>>>    // enable tabbed workspaces. This should only happen when the CON commandbars are
28545>>>>>>>    // being created as part of CreateCommandBars when pbTabbedWorkspaces is true.
28545>>>>>>>    // Use OnCreateTabbedWorkspace to customize 
28545>>>>>>>    Procedure EnableTabbedWorkspace
28547>>>>>>>        Variant vTab vPaint
28547>>>>>>>        Handle hoTab hoPaint
28547>>>>>>>        Integer iFgs
28547>>>>>>>
28547>>>>>>>        Get Create (RefClass(cCJTabWorkspace)) to hoTab
28548>>>>>>>        Get ComShowTabWorkspace True to vTab
28549>>>>>>>        Set pvComObject of hoTab to vTab
28550>>>>>>>        Send ComEnableGroups of hoTab
28551>>>>>>>        Get ComFlags of hoTab to iFgs
28552>>>>>>>        Set ComFlags of hoTab to (iFgs ior xtpWorkspaceShowCloseTab ior xtpWorkspaceShowActiveFiles)
28553>>>>>>>        Get ComPaintManager of hoTab to vPaint
28554>>>>>>>        Get Create (RefClass(cCJTabPaintManager)) to hoPaint
28555>>>>>>>        Set pvComObject of hoPaint to vPaint
28556>>>>>>>        Set ComShowIcons of hoPaint to False
28557>>>>>>>        // event to customize tabbed workspace
28557>>>>>>>        Send OnCreateTabbedWorkspace hoTab hoPaint
28558>>>>>>>        Send Destroy of hoPaint
28559>>>>>>>        Send Destroy of hoTab
28560>>>>>>>    End_Procedure
28561>>>>>>>
28561>>>>>>>    // Perform an Update. This can be called manually or via the timer
28561>>>>>>>    // it send update to the Statusbar and to all active actions
28561>>>>>>>    Procedure Update
28563>>>>>>>        Handle[] hoActions
28564>>>>>>>        Handle hoStatusBar
28564>>>>>>>        Integer i iActions
28564>>>>>>>        Variant vAction
28564>>>>>>>        If (IsComObjectCreated(Self)) Begin
28566>>>>>>>            Send OnUpdate // update event for commandbars
28567>>>>>>>            Get phoActiveUpdates to hoActions
28568>>>>>>>            Move (SizeOfArray(hoActions)) to iActions
28569>>>>>>>            For i from 0 to (iActions-1)
28575>>>>>>>>
28575>>>>>>>                Send Update of hoActions[i]
28576>>>>>>>            Loop
28577>>>>>>>>
28577>>>>>>>            Get phoStatusBar to hoStatusBar
28578>>>>>>>            If (hoStatusBar) Begin
28580>>>>>>>                Send Update of hoStatusBar
28581>>>>>>>            End
28581>>>>>>>>
28581>>>>>>>        End
28581>>>>>>>>
28581>>>>>>>    End_Procedure
28582>>>>>>>
28582>>>>>>>    Procedure UpdateAllActions
28584>>>>>>>        Handle[] hoActions
28585>>>>>>>        Integer i iActions
28585>>>>>>>        Variant vAction
28585>>>>>>>        Get phoRegisteredActions to hoActions
28586>>>>>>>        Move (SizeOfArray(hoActions)) to iActions
28587>>>>>>>        For i from 0 to (iActions-1)
28593>>>>>>>>
28593>>>>>>>            Send Update of hoActions[i]
28594>>>>>>>        Loop
28595>>>>>>>>
28595>>>>>>>    End_Procedure
28596>>>>>>>
28596>>>>>>>    Function LastAssignedId Returns Integer
28598>>>>>>>        Integer[] iActionIdPool
28599>>>>>>>        Integer iId iCount
28599>>>>>>>        Get piActionIdPool to iActionIdPool
28600>>>>>>>        Move (SizeOfArray(iActionIdPool)) to iCount
28601>>>>>>>        If (iCount=0) Begin
28603>>>>>>>            Move ID_CommandBarsAutoStart to iId
28604>>>>>>>        End
28604>>>>>>>>
28604>>>>>>>        Else Begin
28605>>>>>>>            Move (iActionIdPool[0]) to iId
28606>>>>>>>        End
28606>>>>>>>>
28606>>>>>>>        Function_Return iId
28607>>>>>>>    End_Function
28608>>>>>>>         
28608>>>>>>>    Function AssignID Returns Integer // auto assign an Id. Callend in end_construct_object if needed
28610>>>>>>>        Integer[] iActionIdPool
28611>>>>>>>        Integer iId iCount
28611>>>>>>>        Get piActionIdPool to iActionIdPool
28612>>>>>>>        Move (SizeOfArray(iActionIdPool)) to iCount
28613>>>>>>>        If (iCount=0) Begin
28615>>>>>>>            Move ID_CommandBarsAutoStart to iId
28616>>>>>>>            Move iId to iActionIdPool[0] 
28617>>>>>>>        End
28617>>>>>>>>
28617>>>>>>>        Else If (iCount=1) Begin
28620>>>>>>>            Move (iActionIdPool[0]+1) to iId
28621>>>>>>>            Move iId to iActionIdPool[0]
28622>>>>>>>        End
28622>>>>>>>>
28622>>>>>>>        Else Begin
28623>>>>>>>            Move iActionIdPool[iCount-1] to iId
28624>>>>>>>            Move (ResizeArray(iActionIdPool,iCount-1)) to iActionIdPool
28625>>>>>>>        End
28625>>>>>>>>
28625>>>>>>>        Set piActionIdPool to iActionIdPool
28626>>>>>>>        Function_Return iId
28627>>>>>>>    End_Function
28628>>>>>>>    
28628>>>>>>>    Procedure ReleaseID Integer iId // might be needed to maintain a pool of actions
28630>>>>>>>        Integer[] iActionIdPool
28631>>>>>>>        Integer iCount iIndex
28631>>>>>>>        Get piActionIdPool to iActionIdPool
28632>>>>>>>        // we must make sure that an action is never added to the pool more than once.
28632>>>>>>>        // this first value is a trick value (the highest number) so we allow a hit on
28632>>>>>>>        // that one. So -1 or 0 is ok 
28632>>>>>>>        If (SearchArray(iId,iActionIdPool)<=0) Begin
28634>>>>>>>            Move (SizeOfArray(iActionIdPool)) to iCount
28635>>>>>>>            Move iId to iActionIdPool[iCount] 
28636>>>>>>>            Set piActionIdPool to iActionIdPool
28637>>>>>>>        End
28637>>>>>>>>
28637>>>>>>>        Else Begin
28638>>>>>>>            Error DFERR_PROGRAM "Assert: Duplicate released ID in commandbars"
28639>>>>>>>>
28639>>>>>>>        End
28639>>>>>>>>
28639>>>>>>>    End_Procedure
28640>>>>>>>    
28640>>>>>>>    Function AssignBarId Returns Integer
28642>>>>>>>        Integer iId
28642>>>>>>>        Get piLastBarId to iId
28643>>>>>>>        Increment iId
28644>>>>>>>        Set piLastBarId to iId
28645>>>>>>>        Function_Return iId
28646>>>>>>>    End_Function
28647>>>>>>>    
28647>>>>>>>    Procedure AddActiveAction Handle hoAction
28649>>>>>>>        Handle[] hoActiveActions
28650>>>>>>>        Get phoActiveUpdates to hoActiveActions
28651>>>>>>>        Move hoAction to hoActiveActions[SizeOfArray(hoActiveActions)]
28652>>>>>>>        Set phoActiveUpdates to hoActiveActions
28653>>>>>>>    End_Procedure
28654>>>>>>>    
28654>>>>>>>    Procedure RegisterAction Handle hoAction
28656>>>>>>>        Boolean bActive
28656>>>>>>>        Handle[] hoActions
28657>>>>>>>        Get phoRegisteredActions to hoActions
28658>>>>>>>        Move hoAction to hoActions[SizeOfArray(hoActions)]
28659>>>>>>>        Set phoRegisteredActions to hoActions
28660>>>>>>>        Get pbActiveUpdate of hoAction to bActive
28661>>>>>>>        If bActive Begin
28663>>>>>>>            Send AddActiveAction hoAction
28664>>>>>>>        End
28664>>>>>>>>
28664>>>>>>>    End_Procedure
28665>>>>>>>    
28665>>>>>>>    // remove action from list of active actions.
28665>>>>>>>    Procedure RemoveActiveAction Handle hoAction
28667>>>>>>>        Handle[] hoActiveActions
28668>>>>>>>        Integer iIndex i iCount
28668>>>>>>>        Get phoActiveUpdates to hoActiveActions
28669>>>>>>>        Move (SearchArray(hoAction,hoActiveActions)) to iIndex
28670>>>>>>>        If (iIndex<>-1) Begin
28672>>>>>>>            Move (SizeOfArray(hoActiveActions)) to iCount
28673>>>>>>>            For i from iIndex to (iCount-2)
28679>>>>>>>>
28679>>>>>>>                Move hoActiveActions[i+1] to hoActiveActions[i]
28680>>>>>>>            Loop
28681>>>>>>>>
28681>>>>>>>            Move (ResizeArray(hoActiveActions,iCount-1)) to hoActiveActions
28682>>>>>>>            Set phoActiveUpdates to hoActiveActions
28683>>>>>>>        End
28683>>>>>>>>
28683>>>>>>>    End_Procedure
28684>>>>>>>
28684>>>>>>>    // remove action from list of registered actions.
28684>>>>>>>    Procedure RemoveRegisteredAction Handle hoAction
28686>>>>>>>        Handle[] hoActiveActions
28687>>>>>>>        Boolean bActive
28687>>>>>>>        Integer iIndex i iCount 
28687>>>>>>>        Get phoRegisteredActions to hoActiveActions
28688>>>>>>>        Move (SearchArray(hoAction,hoActiveActions)) to iIndex
28689>>>>>>>        If (iIndex<>-1) Begin
28691>>>>>>>            Move (SizeOfArray(hoActiveActions)) to iCount
28692>>>>>>>            For i from iIndex to (iCount-2)
28698>>>>>>>>
28698>>>>>>>                Move hoActiveActions[i+1] to hoActiveActions[i]
28699>>>>>>>            Loop
28700>>>>>>>>
28700>>>>>>>            Move (ResizeArray(hoActiveActions,iCount-1)) to hoActiveActions
28701>>>>>>>            Set phoRegisteredActions to hoActiveActions
28702>>>>>>>        End
28702>>>>>>>>
28702>>>>>>>        Get pbActiveUpdate of hoAction to bActive
28703>>>>>>>        If bActive Begin
28705>>>>>>>            Send RemoveActiveAction hoAction
28706>>>>>>>        End
28706>>>>>>>>
28706>>>>>>>    End_Procedure
28707>>>>>>>
28707>>>>>>>    // Retrieves a populated tGrpIconDir struct for the passed icon name. The data is populated
28707>>>>>>>    // from the icon group resource related to the passed icon name.
28707>>>>>>>    // sIcon        - is the name of the icon file e.g. "cut.ico" - this must be an icon resource compiled 
28707>>>>>>>    //                into the running application.
28707>>>>>>>    // GroupIconDir - [out] This is the tWinGrpIconDir struct that is populated and passed back
28707>>>>>>>    // Returns      - True of the icon group data could be read otherwise returns false. 
28707>>>>>>>    Function GetIconGroupData String sIcon tWinGrpIconDir ByRef GroupIconDir Returns Boolean
28709>>>>>>>        Handle hResInfo hResData        
28709>>>>>>>        Pointer lpType lpIconInfo lpDest
28709>>>>>>>        Integer iIcon icIcon iStructSize
28709>>>>>>>        Boolean bOK
28709>>>>>>>        tWinGrpIconDirEntry GroupIconDirEntry
28709>>>>>>>        tWinGrpIconDirEntry GroupIconDirEntry
28709>>>>>>>        
28709>>>>>>>        // Retrieve information about the icon group resource
28709>>>>>>>        Move (FindResource(GetModuleHandle(0), sIcon, RT_GROUP_ICON)) to hResInfo   // get the resource info handle for the icon group resource
28710>>>>>>>        If (hResInfo = 0) Function_Return False
28713>>>>>>>        
28713>>>>>>>        Move (LoadResource(GetModuleHandle(0), hResInfo)) to hResData               // get the resource data handle from the resource info handle
28714>>>>>>>        If (hResData = 0) Function_Return False
28717>>>>>>>        
28717>>>>>>>        Move (LockResource(hResData)) to lpIconInfo                                 // pointer to tGrpIconDir struct
28718>>>>>>>        If (lpIconInfo = 0) Function_Return False
28721>>>>>>>                
28721>>>>>>>        // Copy the resource information into our Group Icon Dir Struct
28721>>>>>>>        Move (AddressOf(GroupIconDir)) to lpDest
28722>>>>>>>        Move (MemCopy(lpDest, lpIconInfo, 6)) to bOK     // copy the base data
28723>>>>>>>        If (not(bOK)) Function_Return False
28726>>>>>>>         
28726>>>>>>>        Move GroupIconDir.idCount to icIcon                            // get the number of IconDirEntry members
28727>>>>>>>        Move GroupIconDirEntry to GroupIconDir.idEntries[icIcon-1]     // create the empty IconDirEntry array
28728>>>>>>>        Move (SizeOfType(tWinGrpIconDirEntry)) to iStructSize
28729>>>>>>>        Move (lpIconInfo + 6) to lpIconInfo    // advance the memory pointer to the start of the array
28730>>>>>>>        
28730>>>>>>>        For iIcon from 0 to (icIcon-1)    // copy each array member one by one
28736>>>>>>>>
28736>>>>>>>            Move (AddressOf(GroupIconDir.idEntries[iIcon])) to lpDest
28737>>>>>>>            Move (MemCopy(lpDest, lpIconInfo, iStructSize)) to bOK     // copy the base data
28738>>>>>>>            If (not(bOK)) Function_Return False
28741>>>>>>>            
28741>>>>>>>            // advance the memory pointer to the start of the next array member
28741>>>>>>>            Move (lpIconInfo + iStructSize) to lpIconInfo
28742>>>>>>>        Loop
28743>>>>>>>>
28743>>>>>>>        
28743>>>>>>>        Function_Return True        
28744>>>>>>>    End_Function
28745>>>>>>>    
28745>>>>>>>    // Loads all icon image resources that belong to the icon group of the passed icon name.
28745>>>>>>>    // The entire icon group is added to the commandbar's icons collection with the same icon ID.
28745>>>>>>>    // sIcon        - Name of the resource group icon we are loading e.g. "Save.ico"
28745>>>>>>>    // iID          - CJ Commandbar ID to be assigned to the icons that we load
28745>>>>>>>    // hoImageIcons - Handle to the command bar's cCJImageManagerIcons object where the icon will be added
28745>>>>>>>    // eImageType   - The commandbar image type, e.g. xtpImageNormal
28745>>>>>>>    // Boolean      - Returns True if successful, otherwise returns False
28745>>>>>>>    Function LoadIconGroupFromResource String sIcon Integer iID Handle hoImageIcons Integer eImageType Returns Boolean
28747>>>>>>>        Integer iIcon
28747>>>>>>>        tWinGrpIconDir GroupIconDir
28747>>>>>>>        tWinGrpIconDir GroupIconDir
28747>>>>>>>        Boolean bRetValue
28747>>>>>>>        
28747>>>>>>>        Get GetIconGroupData sIcon (&GroupIconDir) to bRetValue
28748>>>>>>>        
28748>>>>>>>        If (bRetValue) Begin
28750>>>>>>>            // Iterate the icon entries...
28750>>>>>>>            For iIcon from 0 to (GroupIconDir.idCount-1)
28756>>>>>>>>
28756>>>>>>>                Send ComLoadIconFromResource of hoImageIcons (GetModuleHandle(0)) GroupIconDir.idEntries[iIcon].nID iID eImageType
28757>>>>>>>            Loop
28758>>>>>>>>
28758>>>>>>>        End
28758>>>>>>>>
28758>>>>>>>
28758>>>>>>>        Function_Return bRetValue
28759>>>>>>>    End_Function
28760>>>>>>>    
28760>>>>>>>
28760>>>>>>>    // Adds an image to imagelist. Pass if bmp or icon, the image name and the Id and image type (normal, disabled, etc.)
28760>>>>>>>    // With Bitmaps this will first look for the resource then search for the file in the file path.
28760>>>>>>>    // With Icons it checks for the file first (explained below)
28760>>>>>>>    // return Image Id if success
28760>>>>>>>    Function AddImageType Boolean bIsIcon String sImage Integer iId Integer eImageType Returns Integer
28762>>>>>>>        Handle hBitmap
28762>>>>>>>        Variant vImageManager
28762>>>>>>>        Handle hoImageIcons
28762>>>>>>>        Integer iVoid
28762>>>>>>>        Boolean bOk 
28762>>>>>>>        String sFileImage
28762>>>>>>>        
28762>>>>>>>        If (iId=0) Begin
28764>>>>>>>            Get piLastImageId to iId
28765>>>>>>>            Increment iId
28766>>>>>>>            Set piLastImageId to iId
28767>>>>>>>        End
28767>>>>>>>>
28767>>>>>>>        
28767>>>>>>>        Get CreateNamed (RefClass(cCJImageManagerIcons)) "oImageManagerIcons" to hoImageIcons
28768>>>>>>>        Get ComIcons to vImageManager
28769>>>>>>>        Set pvComObject of hoImageIcons to vImageManager
28770>>>>>>>
28770>>>>>>>        If bIsIcon Begin
28772>>>>>>>            // if an Icon - try to load from resource first otherwise load from file
28772>>>>>>>//            Move (LoadImage(GetModuleHandle(0), sImage, IMAGE_ICON, 0, 0, 0)) to hBitmap
28772>>>>>>>//            
28772>>>>>>>//            If hBitmap Begin
28772>>>>>>>//                // this works with alpha blends - even when passed false
28772>>>>>>>//                Send ComAddIconHandle hBitmap iId eImageType False
28772>>>>>>>//                Move (DestroyIcon(hBitmap)) to iVoid
28772>>>>>>>//                Move True to bOk
28772>>>>>>>//            End
28772>>>>>>>//            Else Begin
28772>>>>>>>
28772>>>>>>>            Get LoadIconGroupFromResource sImage iId hoImageIcons eImageType to bOk
28773>>>>>>>            
28773>>>>>>>            If (not(bOk)) Begin
28775>>>>>>>                Get_File_Path sImage to sFileImage // find path in DFPATH, if appropriate
28776>>>>>>>                If (sFileImage<>"") Begin
28778>>>>>>>                    Send ComLoadIcon of hoImageIcons sFileImage iId eImageType
28779>>>>>>>                    Move True to bOk
28780>>>>>>>                End
28780>>>>>>>>
28780>>>>>>>            End
28780>>>>>>>>
28780>>>>>>>        End
28780>>>>>>>>
28780>>>>>>>        Else Begin
28781>>>>>>>            // if a bitmap - load from resource first then from file
28781>>>>>>>            Move (LoadImage(GetModuleHandle(0), sImage, IMAGE_BITMAP, 0, 0, 0)) to hBitmap
28782>>>>>>>
28782>>>>>>>            If (hBitmap=0) Begin // the bitmap was not in the EXE resource
28784>>>>>>>                Get_File_Path sImage to sFileImage // find path in DFPATH, if appropriate
28785>>>>>>> 
28785>>>>>>>                If (sFileImage <>"") Begin // The image was found!
28787>>>>>>>//                    Move (LoadImage(0, sFileImage, IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE)) to hBitmap
28787>>>>>>>                    Send ComLoadBitmap of hoImageIcons sFileImage iId eImageType
28788>>>>>>>                    Move True to bOk
28789>>>>>>>                End
28789>>>>>>>>
28789>>>>>>>            End
28789>>>>>>>>
28789>>>>>>>    
28789>>>>>>>            If hBitmap Begin
28791>>>>>>>                Send ComAddBitmap of hoImageIcons hBitmap iId eImageType False
28792>>>>>>>                Move (DeleteObject(hBitmap)) to iVoid
28793>>>>>>>                Move True to bOk
28794>>>>>>>            End
28794>>>>>>>>
28794>>>>>>>        End
28794>>>>>>>>
28794>>>>>>>
28794>>>>>>>        Send Destroy of hoImageIcons
28795>>>>>>>
28795>>>>>>>        Function_Return (If(bOk, iId, 0))
28796>>>>>>>    End_Procedure
28797>>>>>>>    
28797>>>>>>>    // Adds an image to imagelist. 
28797>>>>>>>    // We assume that this is an icon unless the .bmp extension is passed. 
28797>>>>>>>    // return True if success
28797>>>>>>>    Function AddImage String sImage Integer iId Integer eImageType Returns Integer
28799>>>>>>>        Boolean bIsIcon
28799>>>>>>>        // Command Bars support many graphics formats including .bmp, .gif, .jpg etc.
28799>>>>>>>        // These are all non-icon formats...
28799>>>>>>>//        Move (Pos(".bmp", Lowercase(sImage)) = 0) to bIsIcon
28799>>>>>>>        Move (Right(Lowercase(sImage), 4) = ".ico") to bIsIcon
28800>>>>>>>        Get AddImageType bIsIcon sImage iId eImageType to iId
28801>>>>>>>        Function_Return iId
28802>>>>>>>    End_Procedure
28803>>>>>>>    
28803>>>>>>>    // Create a StateOptions object and set it as needed. This is used to save and
28803>>>>>>>    // load settings. You could augment this to customize as needed.
28803>>>>>>>    Function CreateStateOptions Integer eLayout Returns Handle
28805>>>>>>>        Handle hoStateOptions
28805>>>>>>>        Variant vStateOptions
28805>>>>>>>        
28805>>>>>>>        Get Create U_cCJStateOptions to hoStateOptions
28806>>>>>>>        Get ComCreateStateOptions to vStateOptions
28807>>>>>>>        Set pvComObject of hoStateOptions to vStateOptions
28808>>>>>>>        
28808>>>>>>>        Set ComLoadSilent of hoStateOptions to True
28809>>>>>>>    
28809>>>>>>>        // If True, only CommandBars that have been customized will be saved.
28809>>>>>>>        Set ComSaveOnlyCustomized of hoStateOptions to True
28810>>>>>>>    
28810>>>>>>>        // If True, the original state of the CommandBars is saved along with the customized state
28810>>>>>>>        // For example, if a button on a toolbar is moved, then both the original and modified states will be saved.
28810>>>>>>>        Set ComSaveOriginalControls of hoStateOptions to True
28811>>>>>>>        
28811>>>>>>>        Set ComSerializeDesignerControls of hoStateOptions to False
28812>>>>>>>        
28812>>>>>>>        // If True, the controls in the CommandBars will be saved. If False, no controls will be saved,
28812>>>>>>>        // regardless of the other settings.
28812>>>>>>>        Set ComSerializeControls of hoStateOptions to (eLayout=rlSaveRestoreAll)
28813>>>>>>>        
28813>>>>>>>        // If True, the images stored in the ImageManager will be saved.
28813>>>>>>>        Set ComSerializeImages of hoStateOptions to False
28814>>>>>>>        
28814>>>>>>>        // If True, the layout of the CommandBars will be saved. The Layout includes information such as
28814>>>>>>>        // bar position, location, and size.
28814>>>>>>>        Set ComSerializeLayout of hoStateOptions to (eLayout<>rlNoSaveRestore)
28815>>>>>>>        
28815>>>>>>>        // If True, the setting on the Keyboard and Options pages of the Customize dialog will
28815>>>>>>>        // be saved. This includes shortcut keys and CommandBar options like large icons and full menus.
28815>>>>>>>        Set ComSerializeOptions of hoStateOptions to (eLayout=rlSaveRestoreAll or eLayout=rlSaveRestoreFullLayout)
28816>>>>>>>        
28816>>>>>>>        // in our model, actions are never saved.
28816>>>>>>>        Set ComSerializeActions of hoStateOptions to False
28817>>>>>>>        
28817>>>>>>>        Function_Return hoStateOptions
28818>>>>>>>    End_Function
28819>>>>>>>    
28819>>>>>>>    Function CreatePropExchangeObject Returns Handle
28821>>>>>>>        Handle hoPropExchange hoGlobal
28821>>>>>>>        Variant vPropExchange vGlobal
28821>>>>>>>
28821>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28823>>>>>>>            Error DFERR_PROGRAM "Cannot exchange Commands bars data. COM object not created"
28824>>>>>>>>
28824>>>>>>>            Function_Return 0
28825>>>>>>>        End
28825>>>>>>>>
28825>>>>>>>
28825>>>>>>>        Get Create U_cCJCommandBarsGlobalSettings to hoGlobal
28826>>>>>>>        Get ComGlobalSettings to vGlobal
28827>>>>>>>        Set pvComObject of hoGlobal to vGlobal
28828>>>>>>>        Get ComCreatePropExchange of hoGlobal to vPropExchange
28829>>>>>>>        Get Create U_cCJPropExchange to hoPropExchange
28830>>>>>>>        Set pvComObject of hoPropExchange to vPropExchange
28831>>>>>>>        Send Destroy of hoGlobal
28832>>>>>>>        Function_Return hoPropExchange
28833>>>>>>>    End_Function
28834>>>>>>>   
28834>>>>>>>   // exchange the current commandbar layout with the prop exchange object.
28834>>>>>>>   // pass the exchange object and the section name to save this under. The exchange
28834>>>>>>>   // object contains information if this is a save or load (ComLoading).
28834>>>>>>>   // can be called by any exchange object allowing developers to save a commandbar
28834>>>>>>>   // structure as part of other information they may be saving and loading 
28834>>>>>>>   
28834>>>>>>>   Procedure ExchangeLayout Handle hoExchange String sSection Integer eLayout
28836>>>>>>>        Variant vSection vOptions
28836>>>>>>>        Handle hoExchangePref hoStatusBar  hoStateOptions
28836>>>>>>>        Integer iLast iLastBar iStatusBarVisible iBuild iIDBuild iIDCount iIDBarCount
28836>>>>>>>        Boolean bLoad bSerializeControls
28836>>>>>>>        
28836>>>>>>>        If (not(IsComObjectCreated(Self))) Begin
28838>>>>>>>            Error DFERR_PROGRAM "Cannot exchange Commands bars data. COM object not created"
28839>>>>>>>>
28839>>>>>>>            Procedure_Return 
28840>>>>>>>        End
28840>>>>>>>>
28840>>>>>>>
28840>>>>>>>        Get phoStatusBar to hoStatusBar
28841>>>>>>>        Get ComLoading of hoExchange to bLoad
28842>>>>>>>        Get piLastAssignedDesignTimeId to iLast
28843>>>>>>>        Get piLastAssignedDesignTimeBarId to iLastBar
28844>>>>>>>        Get piLayoutBuild to iBuild
28845>>>>>>>
28845>>>>>>>        Get CreateStateOptions eLayout to hoStateOptions
28846>>>>>>>        Get ComSerializeControls of hoStateOptions to bSerializeControls
28847>>>>>>>        Get pvComObject of hoStateOptions to vOptions
28848>>>>>>>
28848>>>>>>>        Get Create U_cCJPropExchange to hoExchangePref
28849>>>>>>>
28849>>>>>>>        Get ComGetSection of hoExchange sSection to vSection
28850>>>>>>>        Set pvComObject of hoExchangePref to vSection
28851>>>>>>>        
28851>>>>>>>        If (not(bLoad)) Begin
28853>>>>>>>            
28853>>>>>>>            Send ComDoPropExchange vSection vOptions 
28854>>>>>>>            Send ComExchangeInt of hoExchangePref "IDCount" (&iLast) 0
28855>>>>>>>            Send ComExchangeInt of hoExchangePref "BarIDCount" (&iLastBar) 0
28856>>>>>>>            If (hoStatusBar) Begin
28858>>>>>>>                Get pbVisible of hoStatusBar to iStatusBarVisible
28859>>>>>>>                Send ComExchangeInt of hoExchangePref "IsStatusBarVisible" (&iStatusBarVisible) 1
28860>>>>>>>            End
28860>>>>>>>>
28860>>>>>>>            Send ComExchangeInt of hoExchangePref "Build" (&iBuild) 0
28861>>>>>>>        End
28861>>>>>>>>
28861>>>>>>>        Else Begin
28862>>>>>>>            // get the build from the data. If it is not what we expect, don't load - it is out of date
28862>>>>>>>            Send ComExchangeInt of hoExchangePref "Build" (&iIDBuild) 0
28863>>>>>>>            If (iIDBuild=iBuild) Begin
28865>>>>>>>                Send ComExchangeInt of hoExchangePref "IDCount" (&iIDCount) 0
28866>>>>>>>                Send ComExchangeInt of hoExchangePref "BarIDCount" (&iIDBarCount) 0
28867>>>>>>>                If (hoStatusBar) Begin
28869>>>>>>>                    Send ComExchangeInt of hoExchangePref "IsStatusBarVisible" (&iStatusBarVisible) 1
28870>>>>>>>                    Set pbVisible of hoStatusBar to iStatusBarVisible
28871>>>>>>>                End
28871>>>>>>>>
28871>>>>>>>
28871>>>>>>>                // do the load if we serialize controls and the control count is ok
28871>>>>>>>                // and if the barId count is ok
28871>>>>>>>                If ((not(bSerializeControls) or iLast=iIDCount) and iLastBar=iIDBarCount) Begin
28873>>>>>>>                    Send ComDoPropExchange vSection vOptions
28874>>>>>>>                End
28874>>>>>>>>
28874>>>>>>>                Send ComRecalcLayout
28875>>>>>>>            End
28875>>>>>>>>
28875>>>>>>>        End
28875>>>>>>>>
28875>>>>>>>            
28875>>>>>>>        Send destroy of hoExchangePref
28876>>>>>>>        Send Destroy of hoStateOptions
28877>>>>>>>    End_Procedure
28878>>>>>>>
28878>>>>>>>
28878>>>>>>>   // saves and loads commands info to the registry.
28878>>>>>>>   // While this is private. It provides a good model for how to do this kind of thing.
28878>>>>>>>   Function LoadLayoutFromRegistry Integer eLayout String sKey Returns Boolean
28880>>>>>>>        Handle hoExchange
28880>>>>>>>        Boolean bOk
28880>>>>>>>        String sSection sFullKey
28880>>>>>>>        
28880>>>>>>>        If (eLayout=rlNoSaveRestore) Begin
28882>>>>>>>            Function_Return True 
28883>>>>>>>        End
28883>>>>>>>>
28883>>>>>>>
28883>>>>>>>        Move ("HKEY_CURRENT_USER\" - sKey) to sFullKey
28884>>>>>>>        Get psLayoutSection to sSection
28885>>>>>>>        Get CreatePropExchangeObject to hoExchange
28886>>>>>>>
28886>>>>>>>        Get ComCreateAsRegistry of hoExchange True sFullKey to bOk
28887>>>>>>>        
28887>>>>>>>        If not (bOk) Begin
28889>>>>>>>            Error DFERR_PROGRAM "Assert: Cannot load from registry"
28890>>>>>>>>
28890>>>>>>>        End
28890>>>>>>>>
28890>>>>>>>        
28890>>>>>>>        If bOk Begin
28892>>>>>>>            Send ExchangeLayout hoExchange sSection eLayout
28893>>>>>>>            Send ComRecalcLayout
28894>>>>>>>        End
28894>>>>>>>>
28894>>>>>>>        Send destroy of hoExchange
28895>>>>>>>        Function_Return bOk
28896>>>>>>>   End_Function
28897>>>>>>>
28897>>>>>>>
28897>>>>>>>   Procedure SaveLayoutToRegistry Integer eLayout String sKey 
28899>>>>>>>        Handle hoExchange hoRegistry
28899>>>>>>>        Boolean bOk bExists bVoid
28899>>>>>>>        String sSection sFullKey sShortKey
28899>>>>>>>        
28899>>>>>>>        If (eLayout=rlNoSaveRestore) Begin
28901>>>>>>>            Procedure_Return
28902>>>>>>>        End
28902>>>>>>>>
28902>>>>>>>
28902>>>>>>>        Move ("HKEY_CURRENT_USER\" - sKey) to sFullKey
28903>>>>>>>        Get psLayoutSection to sSection
28904>>>>>>>        Move (sKey - "\" - sSection) to sShortKey
28905>>>>>>>        
28905>>>>>>>        If (sKey="" or sSection="") Begin
28907>>>>>>>            Error DFERR_PROGRAM "Assert: Registry Key or Section name is invalid"
28908>>>>>>>>
28908>>>>>>>        End
28908>>>>>>>>
28908>>>>>>>        
28908>>>>>>>        Get CreatePropExchangeObject to hoExchange
28909>>>>>>>        Get ComCreateAsRegistry of hoExchange False sFullKey to bOk
28910>>>>>>>        
28910>>>>>>>        If not (bOk) Begin
28912>>>>>>>            Error DFERR_PROGRAM "Assert: Cannot save layout to registry"
28913>>>>>>>>
28913>>>>>>>        End
28913>>>>>>>>
28913>>>>>>>        
28913>>>>>>>        If bOk Begin
28915>>>>>>>            // delete the existing registry information for this section
28915>>>>>>>            Get Create U_cRegistry to hoRegistry
28916>>>>>>>            Set pbLazyWrite of hoRegistry to False
28917>>>>>>>            Get KeyExists of hoRegistry sShortKey to bExists
28918>>>>>>>            If bExists Begin
28920>>>>>>>                Get DeleteKey of hoRegistry sShortKey to bVoid
28921>>>>>>>            End
28921>>>>>>>>
28921>>>>>>>            Send Destroy of hoRegistry
28922>>>>>>>
28922>>>>>>>            Send ExchangeLayout hoExchange sSection eLayout
28923>>>>>>>        End
28923>>>>>>>>
28923>>>>>>>        
28923>>>>>>>        Send destroy of hoExchange
28924>>>>>>>   End_Procedure
28925>>>>>>>   
28925>>>>>>>   
28925>>>>>>>   Function LoadLayoutFromXML Integer eLayout String sFileName Returns Boolean
28927>>>>>>>        Handle hoExchange 
28927>>>>>>>        String sSection
28927>>>>>>>        Boolean bOk
28927>>>>>>>        
28927>>>>>>>        If (eLayout=rlNoSaveRestore) Begin
28929>>>>>>>            Function_Return True
28930>>>>>>>        End
28930>>>>>>>>
28930>>>>>>>
28930>>>>>>>        Get psLayoutSection to sSection
28931>>>>>>>        Get CreatePropExchangeObject to hoExchange
28932>>>>>>>
28932>>>>>>>        Get ComCreateAsXML of hoExchange True "Settings" to bOk
28933>>>>>>>        
28933>>>>>>>        If not (bOk) Begin
28935>>>>>>>            Error DFERR_PROGRAM "Assert: Cannot load layout from XML"
28936>>>>>>>>
28936>>>>>>>        End
28936>>>>>>>>
28936>>>>>>>        
28936>>>>>>>        If bOk Begin
28938>>>>>>>            Get ComLoadFromFile of hoExchange sFileName to bOk
28939>>>>>>>            If bOk Begin
28941>>>>>>>                Send ExchangeLayout hoExchange sSection eLayout
28942>>>>>>>                Send ComRecalcLayout
28943>>>>>>>            End
28943>>>>>>>>
28943>>>>>>>        End
28943>>>>>>>>
28943>>>>>>>        Send destroy of hoExchange
28944>>>>>>>        Function_Return bOk
28945>>>>>>>   End_Function
28946>>>>>>>
28946>>>>>>>   Procedure SaveLayoutToXML Integer eLayout String sFileName
28948>>>>>>>        Handle hoExchange 
28948>>>>>>>        String sSection
28948>>>>>>>        Boolean bOk
28948>>>>>>>        
28948>>>>>>>        If (eLayout=rlNoSaveRestore) Begin
28950>>>>>>>            Procedure_Return
28951>>>>>>>        End
28951>>>>>>>>
28951>>>>>>>
28951>>>>>>>        Get psLayoutSection to sSection
28952>>>>>>>        Get CreatePropExchangeObject to hoExchange
28953>>>>>>>
28953>>>>>>>        Get ComCreateAsXML of hoExchange False "Settings" to bOk
28954>>>>>>>        
28954>>>>>>>        If not (bOk) Begin
28956>>>>>>>            Error DFERR_PROGRAM "Assert: Cannot save XML layout"
28957>>>>>>>>
28957>>>>>>>        End
28957>>>>>>>>
28957>>>>>>>        
28957>>>>>>>        If bOk Begin
28959>>>>>>>            Send ExchangeLayout hoExchange sSection eLayout
28960>>>>>>>            Send ComSaveToFile of hoExchange sFileName
28961>>>>>>>        End
28961>>>>>>>>
28961>>>>>>>        Send destroy of hoExchange
28962>>>>>>>   End_Procedure
28963>>>>>>>   
28963>>>>>>>   // needed in case where no application object is present
28963>>>>>>>   Register_Function pbPreserveEnvironment Returns Boolean
28963>>>>>>>   Register_Function RegistryKeyString Returns String
28963>>>>>>>
28963>>>>>>>   // Standard SaveEnvironment Behavior. This is called when the commandbar system
28963>>>>>>>   // is closed. It will save environment if:
28963>>>>>>>   // 1) application Object exists and pbPreserveEnvironment is true
28963>>>>>>>   // 2) peRestoreLayout is not rlNoSaveRestore
28963>>>>>>>   // This is good for augmentation if you wish to change the standard save
28963>>>>>>>   Procedure SaveEnvironment
28965>>>>>>>        Handle eLayout
28965>>>>>>>        String sKey
28965>>>>>>>        Boolean bPreserveEnvironment
28965>>>>>>>
28965>>>>>>>        If (ghoApplication=0) Begin
28967>>>>>>>            Procedure_Return
28968>>>>>>>        End
28968>>>>>>>>
28968>>>>>>>        Get pbPreserveEnvironment of ghoApplication to bPreserveEnvironment
28969>>>>>>>        If bPreserveEnvironment Begin
28971>>>>>>>            Get peRestoreLayout to eLayout
28972>>>>>>>            Get RegistryKeyString of ghoApplication to sKey
28973>>>>>>>            Send SaveLayoutToRegistry eLayout sKey
28974>>>>>>>        End
28974>>>>>>>>
28974>>>>>>>   End_Procedure
28975>>>>>>>
28975>>>>>>>
28975>>>>>>>   // Standard LoadEnvironment Behavior. This is called when the commandbar system
28975>>>>>>>   // is created. It will load environment if:
28975>>>>>>>   // 1) application Object exists and pbPreserveEnvironment is true
28975>>>>>>>   // 2) peRestoreLayout is not rlNoSaveRestore
28975>>>>>>>   // This is good for augmentation if you wish to change the standard load.
28975>>>>>>>   
28975>>>>>>>   Procedure LoadEnvironment
28977>>>>>>>        Handle eLayout
28977>>>>>>>        String sKey
28977>>>>>>>        Boolean bOk bPreserveEnvironment
28977>>>>>>>
28977>>>>>>>        If (ghoApplication=0) Begin
28979>>>>>>>            Procedure_Return
28980>>>>>>>        End
28980>>>>>>>>
28980>>>>>>>        Get pbPreserveEnvironment of ghoApplication to bPreserveEnvironment
28981>>>>>>>        If bPreserveEnvironment Begin
28983>>>>>>>            Get peRestoreLayout to eLayout
28984>>>>>>>            Get RegistryKeyString of ghoApplication to sKey
28985>>>>>>>            Get LoadLayoutFromRegistry eLayout sKey to bOk
28986>>>>>>>        End
28986>>>>>>>>
28986>>>>>>>   End_Procedure
28987>>>>>>>
28987>>>>>>>   
28987>>>>>>>   Procedure RestoreLayout
28989>>>>>>>        Variant vToolBarObject
28989>>>>>>>        Send ComDeleteAll
28990>>>>>>>        Get ComAddMenuBar "Main menu" to vToolbarObject
28991>>>>>>>        //Broadcast Send CreateComCommandBarInstance
28991>>>>>>>        Broadcast Send CreateComInstance
28993>>>>>>>        Send ComRecalcLayout
28994>>>>>>>   End_Procedure
28995>>>>>>>   
28995>>>>>>>   // used to dock a commandbar, on the same row and to the right of another commandbar
28995>>>>>>>   // used by pbDockNextTo property in toolbars
28995>>>>>>>   Procedure DockNextTo Variant vBarToDock Variant vBarOnLeft
28997>>>>>>>       Integer iLeft iTop iRight iBottom iPosition
28997>>>>>>>       Handle hoBarOnLeft
28997>>>>>>>       Get Create U_cCJCommandBar to hoBarOnLeft
28998>>>>>>>       Set pvComObject of hoBarOnLeft to vBarOnLeft
28999>>>>>>>       Send ComRecalcLayout
29000>>>>>>>       Send ComGetWindowRect of hoBarOnLeft (&iLeft) (&iTop) (&iRight) (&iBottom)
29001>>>>>>>       Get ComPosition of hoBarOnLeft to iPosition
29002>>>>>>>       Send ComDockToolBar vBarToDock (iLeft+1) ((iBottom + iTop)/2) iPosition
29003>>>>>>>       Send Destroy of hoBarOnLeft
29004>>>>>>>   End_Procedure
29005>>>>>>>   
29005>>>>>>>   // This only works if this command bar is placed inside of BasicPanel or if the
29005>>>>>>>   // command bar is in a modal dialog that is placed inside of a Panel
29005>>>>>>>   Function Is_Function Integer iMsgId Integer hoObjId Boolean bDelegateFg Returns Boolean
29007>>>>>>>      Boolean bOk
29007>>>>>>>      Handle hoMain
29007>>>>>>>      // this should get resolved via delegation
29007>>>>>>>      Get Main_Panel_id to hoMain
29008>>>>>>>      If (hoObjId>Desktop and hoMain) ;         Get Is_Function of hoMain iMsgId hoObjId bDelegateFg to bOk
29011>>>>>>>      Function_Return bOk
29012>>>>>>>   End_Function
29013>>>>>>>
29013>>>>>>>    // these must be registered if you are using this with a non-db application. If you are using this
29013>>>>>>>    // with a non-db application, you should not be calling the DEOInformation method as you will get
29013>>>>>>>    // a runtime programming error.
29013>>>>>>>    
29013>>>>>>>    Register_Function Server Returns Integer
29013>>>>>>>    Register_Function DEO_Object Returns Integer
29013>>>>>>>    Register_Function DEO_Control_Object Returns Integer
29013>>>>>>>    Register_Function File_Field_Index Integer iFile Integer iField Returns Integer
29013>>>>>>>
29013>>>>>>>    // returns information about the Focus object. If it returns True its a DEO. If a DEO the
29013>>>>>>>    // server, hasRecord, changed and hasindex info will all be returned by ref.
29013>>>>>>>    // If false, these are all unchanged.
29013>>>>>>>    Function DEOInformation Handle ByRef hoServer Boolean ByRef bHasRecord Boolean ByRef bChanged Boolean ByRef bHasIndex Returns Boolean
29015>>>>>>>        Handle hoFocus
29015>>>>>>>        Boolean bISDeo bIsControl
29015>>>>>>>        Integer iFile iField
29015>>>>>>>        Get Focus of desktop to hoFocus
29016>>>>>>>        Get Is_Function Get_Deo_Object hoFocus True to bIsDeo
29017>>>>>>>        If bISDEO Begin
29019>>>>>>>            Move False to bHasRecord
29020>>>>>>>            Move False to bChanged
29021>>>>>>>            Move False to bHasIndex
29022>>>>>>>            Get Server of hoFocus to hoServer
29023>>>>>>>            If hoServer Begin
29025>>>>>>>                Get HasRecord of hoServer to bHasRecord
29026>>>>>>>                Get Should_Save of hoServer to bChanged
29027>>>>>>>                Get Is_Function Get_DEO_Control_Object hoFocus False to bIsControl
29028>>>>>>>                If (bIsControl) Begin
29030>>>>>>>                    Get Data_File of hoFocus to iFile
29031>>>>>>>                    Get Data_Field of hoFocus to iField
29032>>>>>>>                    Move ( iFile>0 and File_Field_Index(hoServer,iFile,iField)>-1) to bHasIndex
29033>>>>>>>                End
29033>>>>>>>>
29033>>>>>>>            End
29033>>>>>>>>
29033>>>>>>>        End
29033>>>>>>>>
29033>>>>>>>        Function_Return bISDeo        
29034>>>>>>>    End_Function
29035>>>>>>>   
29035>>>>>>>    // Find all controls within this control with the passed Id.
29035>>>>>>>    Procedure ControlsInControl Integer iId Handle hoControl Variant[] ByRef ArrayOfvControls
29037>>>>>>>        Variant vCommandBar
29037>>>>>>>        Handle  hoCommandBar
29037>>>>>>>        Integer eType
29037>>>>>>>        Get ComType of hoControl to eType
29038>>>>>>>        If (eType=xtpControlPopup or eType=xtpControlButtonPopup or eType=xtpControlSplitButtonPopup) Begin
29040>>>>>>>            Get Create U_cCJCommandBar to hoCommandbar
29041>>>>>>>            Get ComCommandBar of hoControl to vCommandBar
29042>>>>>>>            Set pvComObject of hoCommandBar to vCommandBar
29043>>>>>>>            Send ControlsInCommandBar iId hoCommandBar (&ArrayOfvControls)
29044>>>>>>>            Send Destroy of hoCommandBar
29045>>>>>>>        End
29045>>>>>>>>
29045>>>>>>>    End_Procedure
29046>>>>>>>
29046>>>>>>>    // Find all controls within this commandbar with the passed Id.
29046>>>>>>>    Procedure ControlsInCommandBar Integer iId Handle hoCommandBar Variant[] ByRef ArrayOfvControls
29048>>>>>>>        Variant vNewControl  vNewControls
29048>>>>>>>        Handle  hoNewControl hoNewControls
29048>>>>>>>        Integer iControls i  iNewId
29048>>>>>>>        
29048>>>>>>>        Get Create U_cCJCommandBarControls to hoNewControls
29049>>>>>>>        Get Create U_cCJCommandBarPopup to hoNewControl
29050>>>>>>>
29050>>>>>>>        Get ComControls of hoCommandBar to vNewControls
29051>>>>>>>        Set pvComObject of hoNewControls to vNewControls
29052>>>>>>>
29052>>>>>>>        Get ComCount of hoNewControls to iControls
29053>>>>>>>        For i from 1 to iControls
29059>>>>>>>>
29059>>>>>>>            Get ComItem of hoNewControls i to  vNewControl
29060>>>>>>>            Set pvComObject of hoNewControl to vNewControl
29061>>>>>>>
29061>>>>>>>            Get ComId of hoNewControl to iNewId
29062>>>>>>>            If (iNewId=iId) Begin
29064>>>>>>>                Move vNewControl to ArrayOfvControls[SizeOfArray(ArrayOfvControls)]
29065>>>>>>>            End
29065>>>>>>>>
29065>>>>>>>
29065>>>>>>>            Send ControlsInControl iId hoNewControl (&ArrayOfvControls)
29066>>>>>>>        Loop
29067>>>>>>>>
29067>>>>>>>
29067>>>>>>>        Send Destroy of hoNewControl
29068>>>>>>>        Send Destroy of hoNewControls
29069>>>>>>>    End_Procedure
29070>>>>>>>
29070>>>>>>>    // Find all controls within the commandbarsystem with the passed Id. 
29070>>>>>>>    // This can be used to search for Ids within a popup menu item. You only need to use
29070>>>>>>>    // this is there is a chance that there will be more than one control with this id.
29070>>>>>>>    Function FindControls Integer iId Returns Variant[]
29072>>>>>>>        Variant[] ArrayOfvControls
29073>>>>>>>        Variant vCommandBar
29073>>>>>>>        Integer iCommandBars i
29073>>>>>>>        Handle hoCommandBar
29073>>>>>>>
29073>>>>>>>        Get Create U_cCJCommandBar to hoCommandbar
29074>>>>>>>        Get ComCount to iCommandBars
29075>>>>>>>        For i from 1 to iCommandBars
29081>>>>>>>>
29081>>>>>>>            Get ComItem i to vCommandBar
29082>>>>>>>            Set pvComObject of hoCommandBar to vCommandBar
29083>>>>>>>            Send ControlsInCommandBar iId hoCommandBar (&ArrayOfvControls)
29084>>>>>>>        Loop
29085>>>>>>>>
29085>>>>>>>        Send Destroy of hoCommandBar
29086>>>>>>>        Function_Return ArrayOfvControls
29087>>>>>>>    End_Function
29088>>>>>>>
29088>>>>>>>
29088>>>>>>>
29088>>>>>>>    // this sends update to the action of all of the child menu items. Note these are the children
29088>>>>>>>    // of visual control, not the children of the action. This is used to enable, disable all 
29088>>>>>>>    // menu items, etc.
29088>>>>>>>    
29088>>>>>>>    Procedure PopupInit Handle hoCommandBar Handle hoCommandBarControls
29090>>>>>>>        Handle hoControl hoAction hoItem
29090>>>>>>>        Variant vAction vControl 
29090>>>>>>>        Integer i iCount
29090>>>>>>>        
29090>>>>>>>        Get Create U_cCJCommandBarControl to hoControl
29091>>>>>>>        Get Create U_cCJCommandBarAction to hoAction
29092>>>>>>>        
29092>>>>>>>        Get ComCount of hoCommandBarControls to iCount
29093>>>>>>>        // for each control we must find its action and set the action, which in
29093>>>>>>>        // turn will set this control (and any other control there might be with that action).
29093>>>>>>>        For i from 1 to iCount
29099>>>>>>>>
29099>>>>>>>            Get ComItem of hoCommandBarControls i to vControl
29100>>>>>>>            Set pvComObject of hoControl to vControl
29101>>>>>>>            Get ComAction of hoControl to vAction
29102>>>>>>>            // it is possible that there will be no action, in which case do nothing
29102>>>>>>>            If not (IsNullComObject(vAction)) Begin
29104>>>>>>>                Set pvComObject of hoAction to vAction
29105>>>>>>>                Get ComTag of hoAction to hoItem
29106>>>>>>>                If hoItem Begin
29108>>>>>>>                    Send Update of hoItem                
29109>>>>>>>                End
29109>>>>>>>>
29109>>>>>>>            End
29109>>>>>>>>
29109>>>>>>>        Loop
29110>>>>>>>>
29110>>>>>>>        
29110>>>>>>>        Send Destroy of hoAction
29111>>>>>>>        Send Destroy of hoControl
29112>>>>>>>    End_Procedure
29113>>>>>>>
29113>>>>>>>
29113>>>>>>>    Procedure OnCreate
29115>>>>>>>        Forward Send OnCreate
29117>>>>>>>        Send CreateCommandBars
29118>>>>>>>    End_Procedure
29119>>>>>>>    
29119>>>>>>>    Procedure OnCreateCommandBars
29121>>>>>>>    End_Procedure
29122>>>>>>>    
29122>>>>>>>    Procedure OnRelease
29124>>>>>>>    End_Procedure
29125>>>>>>>    
29125>>>>>>>    Procedure OnUpdate
29127>>>>>>>    End_Procedure
29128>>>>>>>    
29128>>>>>>>    Procedure OnComExecute Variant llControl
29130>>>>>>>        Handle hoControl hoAction hoActionPointer
29130>>>>>>>        Variant vAction
29130>>>>>>>        Get Create U_cCJCommandBarControl to hoControl
29131>>>>>>>        Get Create U_cCJCommandBarAction to hoAction
29132>>>>>>>
29132>>>>>>>        Set pvComObject of hoControl to llControl
29133>>>>>>>        Get ComAction of hoControl to vAction
29134>>>>>>>        // There should always be an action but it is possible that all
29134>>>>>>>        // CJ controls will not use this. (colorselector). So we must test.
29134>>>>>>>        If not (IsNullComObject(vAction)) Begin
29136>>>>>>>            Set pvComObject of hoAction to vAction
29137>>>>>>>            Get ComTag of hoAction to hoActionPointer
29138>>>>>>>        End
29138>>>>>>>>
29138>>>>>>>        Send Destroy of hoAction
29139>>>>>>>        Send Destroy of hoControl
29140>>>>>>>        
29140>>>>>>>        If hoActionPointer Begin
29142>>>>>>>            Send Execute of hoActionPointer llControl
29143>>>>>>>        End
29143>>>>>>>>
29143>>>>>>>        Else Begin
29144>>>>>>>            // if for some reason there is no action COM and/or DF object
29144>>>>>>>            // we allow this to be handled by this class as an unhandled 
29144>>>>>>>            // execute
29144>>>>>>>            Send OnUnhandledExecute llControl
29145>>>>>>>        End
29145>>>>>>>>
29145>>>>>>>        
29145>>>>>>>    End_Procedure
29146>>>>>>>
29146>>>>>>>    // this happens when the execute control either has no COM action
29146>>>>>>>    // or it has no DF action object. In such a case, we don't do anything other than
29146>>>>>>>    // call this method. Note that there may be a valid action but fo rsome reason
29146>>>>>>>    // the ComAction property did not get properly assigned by CJ. This seems to happen
29146>>>>>>>    // with the color selector object. 
29146>>>>>>>    Procedure OnUnhandledExecute Variant llControl
29148>>>>>>>    End_Procedure
29149>>>>>>>
29149>>>>>>>
29149>>>>>>>    Procedure OnComControlSelected Variant llControl
29151>>>>>>>        Handle hoControl hoAction hoActionPointer
29151>>>>>>>        Variant vAction
29151>>>>>>>        If (not(IsNullComObject(llControl))) Begin
29153>>>>>>>            Get Create U_cCJCommandBarControl to hoControl
29154>>>>>>>            Get Create U_cCJCommandBarAction to hoAction
29155>>>>>>>    
29155>>>>>>>            Set pvComObject of hoControl to llControl
29156>>>>>>>            Get ComAction of hoControl to vAction
29157>>>>>>>            If (not(IsNullComObject(vAction))) Begin
29159>>>>>>>                Set pvComObject of hoAction to vAction
29160>>>>>>>                Get ComTag of hoAction to hoActionPointer
29161>>>>>>>            End
29161>>>>>>>>
29161>>>>>>>            Send Destroy of hoAction
29162>>>>>>>            Send Destroy of hoControl
29163>>>>>>>            
29163>>>>>>>            If hoActionPointer Begin
29165>>>>>>>                Send OnSelected of hoActionPointer llControl
29166>>>>>>>            End
29166>>>>>>>>
29166>>>>>>>            Else Begin
29167>>>>>>>                Send OnUnhandledControlSelected llControl
29168>>>>>>>            End
29168>>>>>>>>
29168>>>>>>>        End
29168>>>>>>>>
29168>>>>>>>        
29168>>>>>>>    End_Procedure
29169>>>>>>>    
29169>>>>>>>    Procedure OnUnhandledControlSelected Variant llControl
29171>>>>>>>    End_Procedure
29172>>>>>>>    
29172>>>>>>>    Procedure OnComInitCommandsPopup Variant llCommandBar
29174>>>>>>>        Handle hoCommandBar hoAction hoActionPointer hoCommandBarControl hoCommandBarControls
29174>>>>>>>        Variant vAction vCommandBarControl vCommandBarControls 
29174>>>>>>>        Integer eType
29174>>>>>>>        
29174>>>>>>>        Get Create U_cCJCommandbar to hoCommandBar
29175>>>>>>>        Get Create U_cCJCommandBarControls to hoCommandBarControls
29176>>>>>>>
29176>>>>>>>        Set pvComObject of hoCommandBar to llCommandBar
29177>>>>>>>        Get ComControls of hoCommandBar to vCommandBarControls
29178>>>>>>>        Set pvComObject of hoCommandBarControls to vCommandBarControls
29179>>>>>>>        
29179>>>>>>>        Get ComType of hoCommandBar to eType
29180>>>>>>>
29180>>>>>>>        // if no parent it's a context menu. This is not handled here. It is handled by
29180>>>>>>>        // the context menu during the popup 
29180>>>>>>>        Get ComParent of hoCommandBar to vCommandBarControl
29181>>>>>>>        //If (eType=xtpBarTypePopup and (not(IsNullComObject(vCommandBarControl)))) Begin
29181>>>>>>>        If (not(IsNullComObject(vCommandBarControl))) Begin
29183>>>>>>>            // set all the child objects enabled and disabled
29183>>>>>>>            Send PopupInit hoCommandBar hoCommandBarControls
29184>>>>>>>                            
29184>>>>>>>            Get Create U_cCJCommandbarControl to hoCommandBarControl
29185>>>>>>>            Get Create U_cCJCommandbarAction to hoAction
29186>>>>>>>            
29186>>>>>>>            Set pvComObject of hoCommandBarControl to vCommandBarControl
29187>>>>>>>            Get ComAction of hoCommandBarControl to vAction
29188>>>>>>>            // builtin menus like customize may not have actions
29188>>>>>>>            If not (IsNullComObject(vAction)) Begin
29190>>>>>>>                Set pvComObject of hoAction to vAction
29191>>>>>>>                Get ComTag of hoAction to hoActionPointer
29192>>>>>>>            End
29192>>>>>>>>
29192>>>>>>>            
29192>>>>>>>            Send Destroy of hoAction
29193>>>>>>>            Send Destroy of hoCommandBarControl
29194>>>>>>>        
29194>>>>>>>            If hoActionPointer Begin
29196>>>>>>>                Send OnPopupInit of hoActionPointer vCommandBarControl hoCommandBarControls 
29197>>>>>>>            End
29197>>>>>>>>
29197>>>>>>>            Else Begin
29198>>>>>>>                Send OnUnhandledInitCommandsPopup llCommandBar
29199>>>>>>>            End
29199>>>>>>>>
29199>>>>>>>        End
29199>>>>>>>>
29199>>>>>>>        
29199>>>>>>>        Send Destroy of hoCommandBarControls
29200>>>>>>>        Send Destroy of hoCommandBar
29201>>>>>>>        
29201>>>>>>>    End_Procedure
29202>>>>>>>    
29202>>>>>>>    Procedure OnUnhandledInitCommandsPopup Variant llCommandBar
29204>>>>>>>    End_Procedure
29205>>>>>>>
29205>>>>>>>    
29205>>>>>>>    Procedure OnComCustomization Variant vCustomizeOptions
29207>>>>>>>        Handle hoCustomize
29207>>>>>>>        Boolean bShowKeyboardPage bShowOptionsPage
29207>>>>>>>        
29207>>>>>>>        // directly support setting of keyboard and option tab pages.
29207>>>>>>>        // any other customization should be done by developer
29207>>>>>>>        Get pbCustomizeShowKeyboardPage to bShowKeyboardPage
29208>>>>>>>        Get pbCustomizeShowOptionsPage to bShowOptionsPage
29209>>>>>>>        Get Create U_cCJCustomizeOptions to hoCustomize
29210>>>>>>>        Set pvComObject of hoCustomize to vCustomizeOptions
29211>>>>>>>        Set ComShowKeyboardPage of hoCustomize to bShowKeyboardPage
29212>>>>>>>        Set ComShowOptionsPage of hoCustomize to bShowOptionsPage
29213>>>>>>>        Send Destroy of hoCustomize
29214>>>>>>>        
29214>>>>>>>        Forward Send OnComCustomization vCustomizeOptions
29216>>>>>>>    End_Procedure
29217>>>>>>>    
29217>>>>>>>    
29217>>>>>>>    // we do it this way so function DFBinPath is always created. Makes Compiler happy
29217>>>>>>>    Function DFBinPath Returns String
29219>>>>>>>        String sRoot
29219>>>>>>>        Get DFBinPath of ghoApplication to sRoot
29220>>>>>>>        Function_Return sRoot
29221>>>>>>>    End_Function
29222>>>>>>>    
29222>>>>>>>    
29222>>>>>>>    // returns the path for the ResourceImages, which is bin\styles (as of 19)
29222>>>>>>>    //
29222>>>>>>>    Function ResourceImagesPath Returns String
29224>>>>>>>        String sPath
29224>>>>>>>        If ghoApplication Begin
29226>>>>>>>            Get DFBinPath to sPath
29227>>>>>>>            Move (sPath +"\styles") to sPath
29228>>>>>>>        End
29228>>>>>>>>
29228>>>>>>>        Else Begin
29229>>>>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
29230>>>>>>>>
29230>>>>>>>        End
29230>>>>>>>>
29230>>>>>>>        Function_Return sPath
29231>>>>>>>    End_Function
29232>>>>>>>    
29232>>>>>>>    // Loads theme images for File and Ini. This is used with peVisualTheme=xtpThemeResource
29232>>>>>>>    // which must be set *after* this is called. 
29232>>>>>>>    // From CJ Docs:
29232>>>>>>>    //   Supported Styles as of version 15.0:
29232>>>>>>>    //     Office2007.dll
29232>>>>>>>    //     Office2010.dll
29232>>>>>>>    //     Windows7.dll
29232>>>>>>>    //
29232>>>>>>>    //   Each Styles Dll contains 1 or more styles:
29232>>>>>>>    //     Office2007.dll
29232>>>>>>>    //          - Office2007Aqua.ini
29232>>>>>>>    //          - Office2007Black.ini
29232>>>>>>>    //          - Office2007Blue.ini
29232>>>>>>>    //          - Office2007Silver.ini
29232>>>>>>>    //     Office2010.dll
29232>>>>>>>    //          - Office2010Black.ini
29232>>>>>>>    //          - Office2010Blue.ini
29232>>>>>>>    //          - Office2010Silver.ini
29232>>>>>>>    //     Windows7.dll
29232>>>>>>>    //          - Windows7Blue.ini
29232>>>>>>>    //
29232>>>>>>>    // If the sFile is passed relateive, it expects the dll to be placed in \Programs
29232>>>>>>>    // which the developer must do.
29232>>>>>>>    // 
29232>>>>>>>    // Normally you'd call this within OnCreateCommandBars as follows:
29232>>>>>>>    //    Procedure OnCreateCommandBars
29232>>>>>>>    //        Boolean bOk
29232>>>>>>>    //        Forward Send OnCreateCommandBars
29232>>>>>>>    //        Get LoadResourceImagesFromFile "Office2010.dll" "Office2010Black.ini" to bOk
29232>>>>>>>    //        Set peVisualTheme to xtpThemeResource
29232>>>>>>>    //    End_Procedure
29232>>>>>>>    
29232>>>>>>>    Function LoadResourceImagesFromFile String sFile String sIni Returns Boolean
29234>>>>>>>        Handle hoGlobal hoRes 
29234>>>>>>>        Variant vGlobal vRes
29234>>>>>>>        Boolean bOk
29234>>>>>>>        String sDir
29234>>>>>>>        Get Create (RefClass(cCJCommandBarsGlobalSettings)) to hoGlobal
29235>>>>>>>        Send CreateComObject of hoGlobal
29236>>>>>>>        If (not(IsFileNameQualified(sFile))) Begin
29238>>>>>>>            Get ResourceImagesPath to sDir
29239>>>>>>>            Move (sDir + "\"+ sFile) to sFile
29240>>>>>>>        End
29240>>>>>>>>
29240>>>>>>>        Get ComResourceImages of hoGlobal to vRes
29241>>>>>>>        Get Create (RefClass(cCJResourceImages)) to hoRes
29242>>>>>>>        Set pvComObject of hoRes to vRes
29243>>>>>>>        Get ComLoadFromFile of hoRes sFile sIni to bOk
29244>>>>>>>        Send Destroy of hoRes
29245>>>>>>>        Send Destroy of hoGlobal
29246>>>>>>>        Function_Return bOk
29247>>>>>>>    End_Function
29248>>>>>>>
29248>>>>>>>End_Class
29249>>>>>>>
29249>>>>>>>Class cCJCommandBarMixin is a Mixin
29250>>>>>>>    
29250>>>>>>>    Procedure Define_cCJCommandBarMixin
29252>>>>>>>        
29252>>>>>>>        Property Integer piBarID            0 
29253>>>>>>>
29253>>>>>>>        Property Boolean pbDockNextTo             True
29254>>>>>>>
29254>>>>>>>        Property Integer peBarPosition xtpBarTop
29255>>>>>>>
29255>>>>>>>        Property Boolean pbEnableDocking           True
29256>>>>>>>        Property Boolean pbHideWrap                False
29257>>>>>>>        Property Integer peStretched               stNoStretch
29258>>>>>>>
29258>>>>>>>        Property Boolean pbPrivateCloseable        True
29259>>>>>>>        Property Boolean pbPrivateCustomizable     True
29260>>>>>>>        Property Boolean pbPrivateEnableAnimation  False
29261>>>>>>>        Property Boolean pbPrivateShowExpandButton True
29262>>>>>>>        Property String  psPrivateTitle            "Toolbar"
29263>>>>>>>        Property Boolean pbPrivateVisible          True
29264>>>>>>>        Property Integer piPrivateWidth            0
29265>>>>>>>        Property Boolean pbPrivateGripper          True
29266>>>>>>>
29266>>>>>>>        Set peNeighborhood to nhNo
29267>>>>>>>
29267>>>>>>>    End_Procedure
29268>>>>>>>
29268>>>>>>>    // Generic Get and Set property that is used to get and set a DF/COM property.
29268>>>>>>>    // can be used by any integer or boolean property
29268>>>>>>>    
29268>>>>>>>    Procedure SetComProperty Handle hmPrivateProperty Handle hmCOMProperty Integer iValue
29270>>>>>>>        Set hmPrivateProperty to iValue
29271>>>>>>>        If (IsComObjectCreated(Self)) Begin
29273>>>>>>>            Set hmCOMProperty to iValue
29274>>>>>>>        End
29274>>>>>>>>
29274>>>>>>>    End_Procedure
29275>>>>>>>    
29275>>>>>>>    Function GetComProperty Handle hmPrivateProperty Handle hmCOMProperty Returns Integer
29277>>>>>>>        Integer iValue
29277>>>>>>>        If (IsComObjectCreated(Self)) Begin
29279>>>>>>>            Get hmCOMProperty to iValue
29280>>>>>>>        End
29280>>>>>>>>
29280>>>>>>>        Else Begin
29281>>>>>>>            Get hmPrivateProperty to iValue
29282>>>>>>>        End
29282>>>>>>>>
29282>>>>>>>        Function_Return iValue
29283>>>>>>>    End_Function
29284>>>>>>>    
29284>>>>>>>    Procedure Set pbCloseable Boolean bValue
29286>>>>>>>        Send SetComProperty set_pbPrivateCloseable set_ComCloseable bValue
29287>>>>>>>    End_Function
29288>>>>>>>
29288>>>>>>>    Function pbCloseable Returns Boolean
29290>>>>>>>        Boolean bValue
29290>>>>>>>        Get GetComProperty get_pbPrivateCloseable get_ComCloseable to bValue
29291>>>>>>>        Function_Return bValue
29292>>>>>>>    End_Function
29293>>>>>>>
29293>>>>>>>    Procedure Set pbCustomizable Boolean bValue
29295>>>>>>>        Send SetComProperty set_pbPrivateCustomizable set_ComCustomizable bValue
29296>>>>>>>    End_Function
29297>>>>>>>
29297>>>>>>>    Function pbCustomizable Returns Boolean
29299>>>>>>>        Boolean bValue
29299>>>>>>>        Get GetComProperty get_pbPrivateCustomizable get_ComCustomizable to bValue
29300>>>>>>>        Function_Return bValue
29301>>>>>>>    End_Function
29302>>>>>>>
29302>>>>>>>    Procedure Set pbEnableAnimation Boolean bValue
29304>>>>>>>        Send SetComProperty set_pbPrivateEnableAnimation set_ComEnableAnimation bValue
29305>>>>>>>    End_Function
29306>>>>>>>
29306>>>>>>>    Function pbEnableAnimation Returns Boolean
29308>>>>>>>        Boolean bValue
29308>>>>>>>        Get GetComProperty get_pbPrivateEnableAnimation get_ComEnableAnimation to bValue
29309>>>>>>>        Function_Return bValue
29310>>>>>>>    End_Function
29311>>>>>>>
29311>>>>>>>    Procedure Set pbShowExpandButton Boolean bValue
29313>>>>>>>        Send SetComProperty set_pbPrivateShowExpandButton set_ComShowExpandButton bValue
29314>>>>>>>    End_Function
29315>>>>>>>
29315>>>>>>>    Function pbShowExpandButton Returns Boolean
29317>>>>>>>        Boolean bValue
29317>>>>>>>        Get GetComProperty get_pbPrivateShowExpandButton get_ComShowExpandButton to bValue
29318>>>>>>>        Function_Return bValue
29319>>>>>>>    End_Function
29320>>>>>>>
29320>>>>>>>    Procedure Set pbVisible Boolean bValue
29322>>>>>>>        Send SetComProperty set_pbPrivateVisible set_ComVisible bValue
29323>>>>>>>    End_Function
29324>>>>>>>
29324>>>>>>>    Function pbVisible Returns Boolean
29326>>>>>>>        Boolean bValue
29326>>>>>>>        Get GetComProperty get_pbPrivateVisible get_ComVisible to bValue
29327>>>>>>>        Function_Return bValue
29328>>>>>>>    End_Function
29329>>>>>>>
29329>>>>>>>    Procedure Set piWidth Integer iValue
29331>>>>>>>        Send SetComProperty set_piPrivateWidth set_ComWidth iValue
29332>>>>>>>    End_Function
29333>>>>>>>
29333>>>>>>>    Function piWidth Returns Integer
29335>>>>>>>        Integer iValue
29335>>>>>>>        Get GetComProperty get_piPrivateWidth get_ComWidth to iValue
29336>>>>>>>        Function_Return iValue
29337>>>>>>>    End_Function
29338>>>>>>>
29338>>>>>>>    Procedure Set pbGripper Boolean bValue
29340>>>>>>>        Set pbPrivateGripper to bValue
29341>>>>>>>        If (IsComObjectCreated(Self)) Begin
29343>>>>>>>            Send ComModifyStyle (If(not(bValue),xtp_CBRS_GRIPPER,0)) (If(bValue,xtp_CBRS_GRIPPER,0))
29344>>>>>>>        End
29344>>>>>>>>
29344>>>>>>>    End_Procedure
29345>>>>>>>    
29345>>>>>>>    Function pbGripper Returns Boolean
29347>>>>>>>        Boolean bValue
29347>>>>>>>        Get pbPrivateGripper to bValue
29348>>>>>>>        Function_Return bValue
29349>>>>>>>    End_Function
29350>>>>>>>
29350>>>>>>>    Procedure Set psTitle String sValue
29352>>>>>>>        Set psPrivateTitle to sValue
29353>>>>>>>        If (IsComObjectCreated(Self)) Begin
29355>>>>>>>            Set ComTitle to sValue
29356>>>>>>>        End
29356>>>>>>>>
29356>>>>>>>    End_Procedure
29357>>>>>>>    
29357>>>>>>>    Function psTitle Returns String
29359>>>>>>>        String sValue
29359>>>>>>>        If (IsComObjectCreated(Self)) Begin
29361>>>>>>>            Get ComTitle to sValue
29362>>>>>>>        End
29362>>>>>>>>
29362>>>>>>>        Else Begin
29363>>>>>>>            Get psPrivateTitle to sValue
29364>>>>>>>        End
29364>>>>>>>>
29364>>>>>>>        Function_Return sValue
29365>>>>>>>    End_Function
29366>>>>>>>   
29366>>>>>>>   // This may not be needed if we can treat commandbar objects as static
29366>>>>>>>    //// use this to find the Commandbar COM control and attach this object to it.
29366>>>>>>>    //// If a COM object cannot be found, this is an error and and error is declared.
29366>>>>>>>    //Procedure AttachComObject
29366>>>>>>>        //Handle hoCommandBars
29366>>>>>>>        //Variant vCommandBar
29366>>>>>>>        //Integer iBarId i iBars iComBarId
29366>>>>>>>        //Get CommandBarSystemObject to hoCommandBars
29366>>>>>>>        //Get piBarID to iBarId
29366>>>>>>>        //Get ComCount of hoCommandBars to iBars
29366>>>>>>>        //For i from 1 to iBars
29366>>>>>>>            //Get ComItem of hoCommandBars i to vCommandBar
29366>>>>>>>            //Set pvComObject to vCommandBar
29366>>>>>>>            //Get ComBarID to iComBarId
29366>>>>>>>            //If (iBarId=iComBarId) Begin
29366>>>>>>>                //Procedure_Return
29366>>>>>>>            //End
29366>>>>>>>        //Loop
29366>>>>>>>        //Send ReleaseComObject
29366>>>>>>>        //Error DFERR_PROGRAM "Assert: AttachComObject failed to attach commandbar"
29366>>>>>>>    //End_Procedure
29366>>>>>>>
29366>>>>>>>    Procedure InitComInstance
29368>>>>>>>        Handle hoCommandBars hoNextTo
29368>>>>>>>        Variant vCommandBar vNextTo
29368>>>>>>>        String sTitle
29368>>>>>>>        Integer iBarId iWidth iDockFgs iBars eBarPosition
29368>>>>>>>        Integer eNextToPosition eNextToType iDockingFlags eStretched
29368>>>>>>>        Boolean bCloseable bCustomizable bEnableAnimation bShowExpandButton
29368>>>>>>>        Boolean bEnableDocking bHideWrap  
29368>>>>>>>        Boolean bGripper bDockNextTo bNextToVisible
29368>>>>>>>        
29368>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29369>>>>>>>        
29369>>>>>>>        Get psPrivateTitle to sTitle
29370>>>>>>>        Get pbPrivateCloseable to bCloseable
29371>>>>>>>        Get pbPrivateCustomizable to bCustomizable
29372>>>>>>>        Get pbPrivateEnableAnimation to bEnableAnimation
29373>>>>>>>        Get pbPrivateShowExpandButton to bShowExpandButton
29374>>>>>>>//        Get pbPrivateVisible to bVisible    // This setting is deferred until later in the menubar creation
29374>>>>>>>        Get piPrivateWidth to iWidth
29375>>>>>>>        Get pbEnableDocking to bEnableDocking
29376>>>>>>>        Get pbHideWrap to bHideWrap
29377>>>>>>>        Get peStretched to eStretched
29378>>>>>>>        
29378>>>>>>>        Get pbPrivateGripper to bGripper
29379>>>>>>>        Get piBarId to iBarId
29380>>>>>>>        Get pbDockNextTo to bDockNextTo
29381>>>>>>>        Get peBarPosition to eBarPosition
29382>>>>>>>        
29382>>>>>>>        
29382>>>>>>>        Get CreateCommandBar to vCommandBar
29383>>>>>>>        
29383>>>>>>>        Set pvComObject to vCommandBar
29384>>>>>>>        Set ComTitle to sTitle
29385>>>>>>>        Set ComCloseable to bCloseable
29386>>>>>>>        Set ComCustomizable to bCustomizable
29387>>>>>>>        Set ComEnableAnimation to bEnableAnimation
29388>>>>>>>        Set ComShowExpandButton to bShowExpandButton
29389>>>>>>>//        Set ComVisible to bVisible   // it is better to do this after commandbars are created!
29389>>>>>>>        
29389>>>>>>>        Send ComModifyStyle (If(not(bGripper),xtp_CBRS_GRIPPER,0)) (If(bGripper,xtp_CBRS_GRIPPER,0))
29390>>>>>>>        
29390>>>>>>>        If (iBarId<>0) Begin
29392>>>>>>>            Set ComBarID to iBarId
29393>>>>>>>        End
29393>>>>>>>>
29393>>>>>>>        Else Begin
29394>>>>>>>            Get ComBarId to iBarId
29395>>>>>>>            Set piBarID to iBarId
29396>>>>>>>        End
29396>>>>>>>>
29396>>>>>>>           
29396>>>>>>>        // enabled docking is determiend by iORing flags. We simplify docking to allow all or 
29396>>>>>>>        // none. In addition we support hidewrap and the two stretched flags.
29396>>>>>>>        If bEnableDocking Begin
29398>>>>>>>            Move (iDockingFlags ior xtpFlagAlignAny ior xtpFlagFloating) to iDockingFlags
29399>>>>>>>        End
29399>>>>>>>>
29399>>>>>>>        If bHideWrap Begin
29401>>>>>>>            Move (iDockingFlags ior xtpFlagHideWrap) to iDockingFlags
29402>>>>>>>        End
29402>>>>>>>>
29402>>>>>>>        If (eStretched=stStretch) Begin
29404>>>>>>>            Move (iDockingFlags ior xtpFlagStretched) to iDockingFlags
29405>>>>>>>        End
29405>>>>>>>>
29405>>>>>>>        Else If (eStretched=stStretchShared) Begin
29408>>>>>>>            Move (iDockingFlags ior xtpFlagStretchedShared) to iDockingFlags
29409>>>>>>>        End
29409>>>>>>>>
29409>>>>>>>        Send ComEnableDocking iDockingFlags
29410>>>>>>>        
29410>>>>>>>        If (iWidth>0) Begin
29412>>>>>>>            Set ComWidth to iWidth
29413>>>>>>>        End
29413>>>>>>>>
29413>>>>>>>        
29413>>>>>>>        // if we DockNextTo we want to doc "next" to the last command bar that is located
29413>>>>>>>        // in the same position (e.g. top, bottom, left, right). "Next" is relative to the position
29413>>>>>>>        // where top/bottom is Right-of and let/right is below. Menubars are excluded from this logic
29413>>>>>>>        // if we DockNextTo we want to doc "next" to the last command bar that is located
29413>>>>>>>        // in the same position (e.g. top, bottom, left, right). "Next" is relative to the position
29413>>>>>>>        // where top/bottom is Right-of and let/right is below. Menubars are excluded from this logic
29413>>>>>>>        If bDockNextTo Begin
29415>>>>>>>            Get ComCount of hoCommandBars to iBars
29416>>>>>>>            Get Create U_cCJCommandBar to hoNextTo
29417>>>>>>>            While (iBars>1) 
29421>>>>>>>                Get ComItem of hoCommandBars (iBars-1) to vNextTo
29422>>>>>>>                Set pvComObject of hoNextTo to vNextTo
29423>>>>>>>                Get ComVisible of hoNextTo to bNextToVisible
29424>>>>>>>                Get ComPosition of hoNextTo to eNextToPosition
29425>>>>>>>                Get ComType of hoNextTo to eNextToType
29426>>>>>>>                If (bNextToVisible and eNextToType=xtpBarTypeNormal and eNextToPosition=eBarPosition) Begin
29428>>>>>>>                    Send DockNextTo vCommandBar vNextTo
29429>>>>>>>                    Move 0 to iBars
29430>>>>>>>                End
29430>>>>>>>>
29430>>>>>>>                Decrement iBars
29431>>>>>>>            Loop
29432>>>>>>>>
29432>>>>>>>            Send Destroy of hoNextTo
29433>>>>>>>        End
29433>>>>>>>>
29433>>>>>>>        
29433>>>>>>>    End_Procedure
29434>>>>>>>    
29434>>>>>>>    // This is called when the commandbar is created and is bound to the commandbar object.
29434>>>>>>>    Procedure OnCreate
29436>>>>>>>    End_Procedure
29437>>>>>>>    
29437>>>>>>>    Procedure End_Construct_Object
29439>>>>>>>        Integer iID
29439>>>>>>>        Handle hoCommandBars
29439>>>>>>>        Get piBarId to iID
29440>>>>>>>        If (iID=0) Begin
29442>>>>>>>            Get CommandBarSystemObject to hoCommandBars
29443>>>>>>>            Get AssignBarId of hoCommandBars to iId
29444>>>>>>>            Set piBarId to iID
29445>>>>>>>        End
29445>>>>>>>>
29445>>>>>>>        Forward Send End_Construct_Object
29447>>>>>>>    End_Procedure
29448>>>>>>>    
29448>>>>>>>End_Class
29449>>>>>>>
29449>>>>>>>
29449>>>>>>>
29449>>>>>>>
29449>>>>>>>
29449>>>>>>>Class cCJAbstractCommandBar is a cCJCommandBar
29450>>>>>>>    
29450>>>>>>>    Import_Class_Protocol cCJCommandBarMixin
29451>>>>>>>    
29451>>>>>>>    Procedure Construct_Object
29453>>>>>>>        Forward Send Construct_Object
29455>>>>>>>        Send Define_cCJCommandBarMixin
29456>>>>>>>    End_Procedure
29457>>>>>>>
29457>>>>>>>    // Must be defined in a sub-class
29457>>>>>>>    Function CreateCommandBar Returns Variant
29459>>>>>>>        Error DFERR_PROGRAM "Assert: CreateCommandBar not defined in superclass"
29460>>>>>>>>
29460>>>>>>>    End_Function
29461>>>>>>>    
29461>>>>>>>    Procedure CreateComInstance
29463>>>>>>>        Handle hoCommandBarControls
29463>>>>>>>        Variant vCommandBarControls
29463>>>>>>>
29463>>>>>>>        Send InitComInstance // creates control and returns it attached
29464>>>>>>>        Send OnCreate
29465>>>>>>>
29465>>>>>>>
29465>>>>>>>        Get Create U_cCJCommandBarControls to hoCommandBarControls
29466>>>>>>>        Get ComControls to vCommandBarControls
29467>>>>>>>        Set pvComObject of hoCommandBarControls to vCommandBarControls
29468>>>>>>>        
29468>>>>>>>        Broadcast Send CreateComInstance hoCommandBarControls
29470>>>>>>>        
29470>>>>>>>        // after this command bar and all its children are created, we set this as the reset point.
29470>>>>>>>        Send ComCreateOriginalControls of hoCommandBarControls
29471>>>>>>>        
29471>>>>>>>        Send Destroy of hoCommandBarControls
29472>>>>>>>
29472>>>>>>>        // JJT: I think Commandbars are static and do not change based on loading and editing
29472>>>>>>>        //      If so, we will keep the objects bound. If this does not work we will need to
29472>>>>>>>        //      use the AttachComObject method.
29472>>>>>>>        // Send ReleaseComObject
29472>>>>>>>        
29472>>>>>>>    End_Procedure
29473>>>>>>>
29473>>>>>>>End_Class
29474>>>>>>>
29474>>>>>>>Class cCJMenuBar is a cCJAbstractCommandBar
29475>>>>>>>    
29475>>>>>>>    Procedure Construct_object
29477>>>>>>>        Forward Send Construct_Object
29479>>>>>>>        Set piBarId to 1 // menu is always 1
29480>>>>>>>        Set psTitle to "Main Menu"
29481>>>>>>>        Set pbCloseable to False
29482>>>>>>>        Set pbGripper to False
29483>>>>>>>        Set pbEnableDocking to False
29484>>>>>>>        Set pbHideWrap to False
29485>>>>>>>        Set peStretched to stStretch
29486>>>>>>>        Set pbCustomizable to False
29487>>>>>>>
29487>>>>>>>    End_Procedure
29488>>>>>>>
29488>>>>>>>    Function CreateCommandBar Returns Variant
29490>>>>>>>        Variant vCommandBar
29490>>>>>>>        Handle hoCommandBars
29490>>>>>>>        Integer eBarPosition
29490>>>>>>>        Get peBarPosition to eBarPosition
29491>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29492>>>>>>>        Get ComActiveMenuBar of hoCommandBars to vCommandBar
29493>>>>>>>        Set pvComObject to vCommandBar
29494>>>>>>>        Set ComPosition to eBarPosition
29495>>>>>>>        Function_Return vCommandBar
29496>>>>>>>    End_Function
29497>>>>>>>    
29497>>>>>>>    
29497>>>>>>>    Procedure CreateComInstance
29499>>>>>>>        // Menubar is invisible by default to allow applications to not force the default menubar on 
29499>>>>>>>        // applications that do not have them declared in their application. Here is where we set 
29499>>>>>>>        // Visible back to true because if this code is executed then the application really does have
29499>>>>>>>        // a menubar. We do this as late as possible in the process because Set ComVisible is a little
29499>>>>>>>        // fragile if the COM controls are not all set up correctly.
29499>>>>>>>        //17.1
29499>>>>>>>        Boolean bVisible
29499>>>>>>>        Forward Send CreateComInstance
29501>>>>>>>        Get pbPrivateVisible to bVisible
29502>>>>>>>        Set ComVisible to bVisible
29503>>>>>>>    End_Procedure
29504>>>>>>>
29504>>>>>>>End_Class
29505>>>>>>>
29505>>>>>>>Class cCJToolbar is a cCJAbstractCommandBar
29506>>>>>>>
29506>>>>>>>    Function CreateCommandBar Returns Variant
29508>>>>>>>        Variant vCommandBar
29508>>>>>>>        Handle hoCommandBars
29508>>>>>>>        Integer eBarPosition
29508>>>>>>>        Get peBarPosition to eBarPosition
29509>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29510>>>>>>>        Get ComAdd of hoCommandBars "Toolbar" eBarPosition to vCommandBar
29511>>>>>>>        Function_Return vCommandBar
29512>>>>>>>    End_Function
29513>>>>>>>
29513>>>>>>>End_Class
29514>>>>>>>
29514>>>>>>>
29514>>>>>>>Class cCJTabToolBar is a cCJComTabToolBar
29515>>>>>>>    
29515>>>>>>>    Import_Class_Protocol cCJCommandBarMixin
29516>>>>>>>    
29516>>>>>>>    Procedure Construct_Object
29518>>>>>>>        Forward Send Construct_Object
29520>>>>>>>        Send Define_cCJCommandBarMixin
29521>>>>>>>        Property Boolean pbPrivateAllowReorder   False
29522>>>>>>>
29522>>>>>>>    End_Procedure
29523>>>>>>>    
29523>>>>>>>    Procedure Set pbAllowReorder Boolean bValue
29525>>>>>>>        Send SetComProperty set_pbPrivateAllowReorder set_ComAllowReorder bValue
29526>>>>>>>    End_Function
29527>>>>>>>
29527>>>>>>>    Function pbAllowReorder Returns Boolean
29529>>>>>>>        Boolean bValue
29529>>>>>>>        Get GetComProperty get_pbPrivateAllowReorder get_ComAllowReorder to bValue
29530>>>>>>>        Function_Return bValue
29531>>>>>>>    End_Function
29532>>>>>>>    
29532>>>>>>>
29532>>>>>>>    Function CreateCommandBar Returns Variant
29534>>>>>>>        Variant vCommandBar
29534>>>>>>>        Handle hoCommandBars
29534>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29535>>>>>>>        Get ComAddTabToolBar of hoCommandBars "TabToolbar" to vCommandBar
29536>>>>>>>        Function_Return vCommandBar
29537>>>>>>>    End_Function
29538>>>>>>>
29538>>>>>>>    Procedure CreateComInstance
29540>>>>>>>        Handle hoCommandBarControls
29540>>>>>>>        Variant vCommandBarControls
29540>>>>>>>        Boolean bAllowReorder
29540>>>>>>>        Get pbPrivateAllowReorder to bAllowReorder
29541>>>>>>>        
29541>>>>>>>        Send InitComInstance // creates control and returns it attached
29542>>>>>>>        
29542>>>>>>>        Set ComAllowReorder to bAllowReorder
29543>>>>>>>        
29543>>>>>>>        Send OnCreate
29544>>>>>>>
29544>>>>>>>
29544>>>>>>>        Get Create U_cCJCommandBarControls to hoCommandBarControls
29545>>>>>>>        Get ComControls to vCommandBarControls
29546>>>>>>>        Set pvComObject of hoCommandBarControls to vCommandBarControls
29547>>>>>>>        
29547>>>>>>>        
29547>>>>>>>        Broadcast Send CreateComInstance Self // we pass attached tabmenubar control to tab children
29549>>>>>>>        
29549>>>>>>>        // after this command bar and all its children are created, we set this as the reset point.
29549>>>>>>>        Send ComCreateOriginalControls of hoCommandBarControls
29550>>>>>>>        Send ComUpdateTabs
29551>>>>>>>        Send ComRedrawBar
29552>>>>>>>        Send ComRecalcLayout
29553>>>>>>>        Send Destroy of hoCommandBarControls
29554>>>>>>>
29554>>>>>>>        // JJT: I think Commandbars are static and do not change based on loading and editing
29554>>>>>>>        //      If so, we will keep the objects bound. If this does not work we will need to
29554>>>>>>>        //      use the AttachComObject method.
29554>>>>>>>        //Send ReleaseComObject
29554>>>>>>>        
29554>>>>>>>    End_Procedure
29555>>>>>>>
29555>>>>>>>    Function FindByCategory String sName Returns Variant
29557>>>>>>>        Boolean bAttached bOk
29557>>>>>>>        Handle hoItem
29557>>>>>>>        Variant vItem
29557>>>>>>>        Integer i iCount
29557>>>>>>>        String sCat
29557>>>>>>>        
29557>>>>>>>        Move (IsComObjectCreated(Self)) to bAttached
29558>>>>>>>        If not bAttached Begin
29560>>>>>>>            Error DFERR_PROGRAM "Assert: Find by Category commandbar not attached"
29561>>>>>>>>
29561>>>>>>>            Function_Return (NullComObject())
29562>>>>>>>            //Send AttachComObject
29562>>>>>>>        End
29562>>>>>>>>
29562>>>>>>>        
29562>>>>>>>        Get Create U_cCJComTabControlItem to hoItem
29563>>>>>>>        Get ComCategoryCount to iCount
29564>>>>>>>        For i from 0 to (iCount-1)
29570>>>>>>>>
29570>>>>>>>            Get ComCategory i to vItem
29571>>>>>>>            Set pvComObject of hoItem to vItem
29572>>>>>>>            Get ComCaption of hoItem to sCat
29573>>>>>>>            Move (sCat=sName) to bOk
29574>>>>>>>            If bOk Break
29577>>>>>>>        Loop
29578>>>>>>>>
29578>>>>>>>        Send destroy of hoItem
29579>>>>>>>        
29579>>>>>>>        //If not bAttached Begin
29579>>>>>>>            //Send ReleaseComObject
29579>>>>>>>        //End
29579>>>>>>>        If not bOk Begin
29581>>>>>>>            Move (NullComObject()) to vItem
29582>>>>>>>        End
29582>>>>>>>>
29582>>>>>>>        Function_Return vItem
29583>>>>>>>    End_Function
29584>>>>>>>
29584>>>>>>>End_Class
29585>>>>>>>
29585>>>>>>>
29585>>>>>>>Class cCJTabControlItem is a cCJComTabControlItem
29586>>>>>>>    
29586>>>>>>>    Procedure Construct_Object
29588>>>>>>>        Forward Send Construct_Object
29590>>>>>>>        Property String psCategory ""
29591>>>>>>>        Property String psToolTip ""
29592>>>>>>>        Property String psImage ""
29593>>>>>>>        Set peNeighborhood to nhNo
29594>>>>>>>    End_Procedure
29595>>>>>>>
29595>>>>>>>   // This may not be needed if we can treat commandbar objects as static
29595>>>>>>>    //// attach this object to its appropriate COM object.
29595>>>>>>>    //Procedure AttachComObject
29595>>>>>>>        //Variant vCat
29595>>>>>>>        //String sName
29595>>>>>>>        //Get psCategory to sName
29595>>>>>>>        //Delegate Get FindByCategory sName to vCat
29595>>>>>>>        //If (IsNullComObject(vCat)) Begin
29595>>>>>>>            //Error DFERR_PROGRAM "Assert: AttachComObject failed to attach tabcontrolitem"
29595>>>>>>>        //End
29595>>>>>>>        //Else Begin
29595>>>>>>>            //Set pvComObject to vCat
29595>>>>>>>        //End
29595>>>>>>>    //End_Procedure
29595>>>>>>>
29595>>>>>>>    Procedure CreateComInstance Handle hoTabToolBar
29597>>>>>>>        Handle hoCommandBars hoCommandBarControls  hoControl
29597>>>>>>>        Variant vCommandBarControls vTab vControl
29597>>>>>>>        String sCategory sTip sImage
29597>>>>>>>        Integer iCount i iNewCount iId
29597>>>>>>>        Boolean bOk
29597>>>>>>>                
29597>>>>>>>        Get psCategory to sCategory
29598>>>>>>>        Get psToolTip to sTip
29599>>>>>>>        Get psImage to sImage
29600>>>>>>>        
29600>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29601>>>>>>>        
29601>>>>>>>        Get ComCategoryCount of hoTabToolBar to iCount
29602>>>>>>>        Get ComInsertCategory of hoTabToolbar iCount sCategory to vTab
29603>>>>>>>        Set pvComObject to vTab
29604>>>>>>>        
29604>>>>>>>        Set ComToolTip to sTip
29605>>>>>>>
29605>>>>>>>        If (sImage<>"") Begin
29607>>>>>>>            Get AddImage of hoCommandBars sImage 0 xtpImageNormal to iId
29608>>>>>>>            Set ComImage to iId
29609>>>>>>>        End
29609>>>>>>>>
29609>>>>>>>
29609>>>>>>>        If (iCount=0) Begin
29611>>>>>>>            Set ComSelected to True        
29612>>>>>>>        End
29612>>>>>>>>
29612>>>>>>>
29612>>>>>>>        Send OnCreate
29613>>>>>>>
29613>>>>>>>        Get Create U_cCJCommandBarControls to hoCommandBarControls
29614>>>>>>>        Get ComControls of hoTabToolBar to vCommandBarControls
29615>>>>>>>        Set pvComObject of hoCommandBarControls to vCommandBarControls
29616>>>>>>>        
29616>>>>>>>        // before creating the child com controls, get the count of controls
29616>>>>>>>        Get ComCount of hoCommandBarControls to iCount
29617>>>>>>>
29617>>>>>>>        Broadcast Send CreateComInstance hoCommandBarControls
29619>>>>>>>        
29619>>>>>>>        // get the new count of controls. The difference are the new controls.
29619>>>>>>>        Get ComCount of hoCommandBarControls to iNewCount
29620>>>>>>>
29620>>>>>>>        Get create U_cCJCommandBarControl to hoControl
29621>>>>>>>        For i from (iCount+1) to iNewCount
29627>>>>>>>>
29627>>>>>>>            Get ComItem of hoCommandBarControls i to vControl
29628>>>>>>>            Set pvComObject of hoControl to vControl
29629>>>>>>>            Set ComCategory of hoControl to sCategory
29630>>>>>>>        Loop
29631>>>>>>>>
29631>>>>>>>        Send Destroy of hoControl
29632>>>>>>>        Send Destroy of hoCommandBarControls
29633>>>>>>>
29633>>>>>>>        // JJT: I think tab bar items are static and do not change based on loading and editing
29633>>>>>>>        //      If so, we will keep the objects bound. If this does not work we will need to
29633>>>>>>>        //      use the AttachComObject method.
29633>>>>>>>        //Send ReleaseComObject
29633>>>>>>>        
29633>>>>>>>    End_Procedure
29634>>>>>>>    
29634>>>>>>>    Procedure OnCreate
29636>>>>>>>    End_Procedure
29637>>>>>>>    
29637>>>>>>>End_Class
29638>>>>>>>
29638>>>>>>>
29638>>>>>>>
29638>>>>>>>Class cCJContextMenu is a cCJCommandBar
29639>>>>>>>    
29639>>>>>>>    Procedure Construct_Object
29641>>>>>>>        Forward Send Construct_Object
29643>>>>>>>        Property Boolean pbEnableAnimation  False
29644>>>>>>>        Property Boolean pbControlDoubleGripper    False
29645>>>>>>>        Property Boolean pbControlPopupToolBar   False
29646>>>>>>>
29646>>>>>>>        Property Handle phoCommandBars 0
29647>>>>>>>
29647>>>>>>>        // this is set using SetPopupLocation.     
29647>>>>>>>        Property tWinPoint pLocation
29648>>>>>>>    End_Procedure
29649>>>>>>>
29649>>>>>>>    
29649>>>>>>>    // context menus use a differnt logic for finding the commandbars. Normally it will just attach to
29649>>>>>>>    // the global commandbars. However, a developer can choose attach this to a different commandbars by
29649>>>>>>>    // setting phoCommandBars.
29649>>>>>>>    Function CommandBarSystemObject Returns Handle
29651>>>>>>>        Handle hoCommandBars
29651>>>>>>>        Get phoCommandBars to hoCommandBars
29652>>>>>>>        If (hoCommandBars=0) Begin
29654>>>>>>>            Move ghoCommandBars to hoCommandBars
29655>>>>>>>        End
29655>>>>>>>>
29655>>>>>>>        Function_Return hoCommandBars
29656>>>>>>>    End_Function
29657>>>>>>> 
29657>>>>>>>    Function CreateCommandBar Returns Variant
29659>>>>>>>        Variant vCommandBar
29659>>>>>>>        Handle hoCommandBars
29659>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29660>>>>>>>        Get ComAdd of hoCommandBars "Context Toolbar" xtpBarPopup to vCommandBar
29661>>>>>>>        Function_Return vCommandBar
29662>>>>>>>    End_Function
29663>>>>>>>     
29663>>>>>>>    Procedure CreatePopupComInstance
29665>>>>>>>        Handle hoCommandBars hoCommandBarControls 
29665>>>>>>>        Variant vCommandBar vCommandBarControls 
29665>>>>>>>        Boolean bEnableAnimation bDoubleGripper bPopupToolBar
29665>>>>>>>
29665>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29666>>>>>>>        Get pbEnableAnimation to bEnableAnimation
29667>>>>>>>        Get pbControlDoubleGripper to bDoubleGripper
29668>>>>>>>        Get pbControlPopupToolBar  to bPopupToolBar
29669>>>>>>>
29669>>>>>>>        Get CreateCommandBar to vCommandBar
29670>>>>>>>        Set pvComObject to vCommandBar
29671>>>>>>>
29671>>>>>>>        Set ComEnableAnimation to bEnableAnimation
29672>>>>>>>        Set ComDoubleGripper to bDoubleGripper
29673>>>>>>>        Send ComSetPopupToolBar bPopupToolBar
29674>>>>>>>        
29674>>>>>>>        Send OnCreate
29675>>>>>>>
29675>>>>>>>        Get Create U_cCJCommandBarControls to hoCommandBarControls
29676>>>>>>>        Get ComControls to vCommandBarControls
29677>>>>>>>        Set pvComObject of hoCommandBarControls to vCommandBarControls
29678>>>>>>>        
29678>>>>>>>        Broadcast Send CreateComInstance hoCommandBarControls
29680>>>>>>>        
29680>>>>>>>        // This does the same thing OnComPopupInit does. 
29680>>>>>>>        
29680>>>>>>>        // this does all of the inital setting of enabled, etc.
29680>>>>>>>        Send PopupInit of hoCommandBars Self hoCommandBarControls
29681>>>>>>>        // user event to do whatever
29681>>>>>>>        Send OnPopupInit vCommandBar hoCommandBarControls 
29682>>>>>>>        
29682>>>>>>>        Send Destroy of hoCommandBarControls
29683>>>>>>>        
29683>>>>>>>        // we keep the control attached with popups or we lose it.
29683>>>>>>>    End_Procedure
29684>>>>>>>    
29684>>>>>>>    
29684>>>>>>>    Procedure Popup
29686>>>>>>>        Handle hoCommandBars
29686>>>>>>>        Integer iLoc iId iRet
29686>>>>>>>        tWinPoint Pt PtZero
29686>>>>>>>        tWinPoint Pt PtZero
29686>>>>>>>
29686>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29687>>>>>>>        If (hoCommandBars=0) Begin
29689>>>>>>>            Error DFERR_PROGRAM "Context menu not attached to commandbars"
29690>>>>>>>>
29690>>>>>>>            Procedure_Return
29691>>>>>>>        End
29691>>>>>>>>
29691>>>>>>>        
29691>>>>>>>        // this will create the context menu and return it attached.
29691>>>>>>>        Send CreatePopupComInstance 
29692>>>>>>>
29692>>>>>>>        // see if location has been set before popup by SetPopupLocation
29692>>>>>>>        Get pLocation to pt
29693>>>>>>>        If (pt.x=0 and Pt.y=0) Begin
29695>>>>>>>            Move (GetCursorPos(addressOf(Pt))) to iRet    // Get the mouse location (this technique supports -ve co-ordinates
29696>>>>>>>        End
29696>>>>>>>>
29696>>>>>>>        Else Begin
29697>>>>>>>            // if set, we use the setting and clear this location for the next popup
29697>>>>>>>            Set pLocation to PtZero
29698>>>>>>>        End
29698>>>>>>>>
29698>>>>>>>        
29698>>>>>>>        Get ComShowPopup OLE_VT_Empty Pt.x Pt.y to iID
29699>>>>>>>
29699>>>>>>>//JVH - This technique does not support -ve screen co-ordinates.
29699>>>>>>>//        Get Absolute_Mouse_Location of Desktop to iLoc  
29699>>>>>>>//        Get ComShowPopup OLE_VT_Empty (low(iLoc)) (hi(iLoc)) to iID 
29699>>>>>>>
29699>>>>>>>        // This releases all actions (which will still exist on the COM side)
29699>>>>>>>        // and controls (controls should already be released on both DF and COM side)
29699>>>>>>>        Broadcast Recursive_up Send ReleaseComObject
29701>>>>>>>        Send ReleaseComObject // after popup CJ deletes the controls, so we release this
29702>>>>>>>    End_Procedure
29703>>>>>>>    
29703>>>>>>>    Procedure OnCreate
29705>>>>>>>    End_Procedure
29706>>>>>>>
29706>>>>>>>    // before called, self and all items IsEnabled, IsChecked and IsVisible are called
29706>>>>>>>    // the first param is of no interest as it is this object which is already attached
29706>>>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hoCommandBarControls
29708>>>>>>>    End_Procedure
29709>>>>>>>
29709>>>>>>>    // This can be called before popup to select a custom popup location. If not called
29709>>>>>>>    // the location is determined in Popup by looking at the mouse position. This must be
29709>>>>>>>    // called before each popup
29709>>>>>>>    Procedure SetPopupLocation Integer iY Integer iX
29711>>>>>>>        tWinPoint pt
29711>>>>>>>        tWinPoint pt
29711>>>>>>>        Move iX to pt.x
29712>>>>>>>        Move iy to pt.y
29713>>>>>>>        Set pLocation to pt
29714>>>>>>>    End_Procedure
29715>>>>>>>    
29715>>>>>>>End_Class
29716>>>>>>>
29716>>>>>>>// used for the Customize dialog
29716>>>>>>>// This provides a way to add controls to the config menu that are not defined
29716>>>>>>>// elsewhere in the menu
29716>>>>>>>
29716>>>>>>>Class cCJDesignerMenu is a cObject
29717>>>>>>>    
29717>>>>>>>    Procedure Construct_Object
29719>>>>>>>        Forward Send Construct_Object
29721>>>>>>>        Set peNeighborhood to nhNo
29722>>>>>>>    End_Procedure
29723>>>>>>>    
29723>>>>>>>    // Get the Controls Collection for the designer and call all children
29723>>>>>>>    Procedure CreateComInstance
29725>>>>>>>        Handle hoCommandBarControls 
29725>>>>>>>        Get DesignerControlsCollection to hoCommandBarControls
29726>>>>>>>        Broadcast Send CreateComInstance hoCommandBarControls
29728>>>>>>>    End_Procedure
29729>>>>>>>
29729>>>>>>>End_Class
29730>>>>>>>
29730>>>>>>>// This creates an action object. It will normally not be directly instanciated but will be used
29730>>>>>>>// as the superclass of the cCJMenuItem class. 
29730>>>>>>>
29730>>>>>>>
29730>>>>>>>Class cCJAction is a cCJCommandBarAction
29731>>>>>>>    
29731>>>>>>>    Procedure Construct_Object
29733>>>>>>>        Forward Send Construct_Object
29735>>>>>>>
29735>>>>>>>         // normally auto assigned. It can be manually assigned.
29735>>>>>>>        Property Integer piId 0
29736>>>>>>>
29736>>>>>>>        // determins if this action should be updated by the timer. You only set this true if
29736>>>>>>>        // the checked state, enabled state or visible state will be changed by other actions
29736>>>>>>>        // within the program.
29736>>>>>>>        Property Boolean pbPrivateActiveUpdate False
29737>>>>>>>
29737>>>>>>>        Property Boolean pbPrivateChecked False
29738>>>>>>>        Property Boolean pbPrivateEnabled True
29739>>>>>>>        Property Boolean pbPrivateVisible True
29740>>>>>>>        Property String  psPrivateCaption ""
29741>>>>>>>        Property String  psPrivateCategory C_$CategoryOther
29742>>>>>>>        Property String  psPrivateDescriptionText ""
29743>>>>>>>        Property String  psPrivateTooltipText ""
29744>>>>>>>        Property String  psPrivateShortcutText ""
29745>>>>>>>        Property Integer piPrivateShortCutKey 0
29746>>>>>>>
29746>>>>>>>        // These are just initial values, if the developer needs to dynamically change
29746>>>>>>>        // images they should use the ComIconId to select the item they need from the image list
29746>>>>>>>        
29746>>>>>>>        // normally only psImage needs to be set
29746>>>>>>>        Property String psImage ""
29747>>>>>>>        Property String psImageDisabled ""
29748>>>>>>>        Property String psImageHot ""
29749>>>>>>>        Property String psImageChecked ""
29750>>>>>>>        Property String psImagePressed ""
29751>>>>>>>
29751>>>>>>>        Property Integer piPrivateIconId 0
29752>>>>>>>
29752>>>>>>>        Set peNeighborhood to nhNo
29753>>>>>>>    End_Procedure
29754>>>>>>>    
29754>>>>>>>
29754>>>>>>>    Procedure Set pbChecked Boolean bValue
29756>>>>>>>        Set pbPrivateChecked to bValue
29757>>>>>>>        If (IsComObjectCreated(Self)) Begin
29759>>>>>>>            Set ComChecked to bValue
29760>>>>>>>        End
29760>>>>>>>>
29760>>>>>>>    End_Procedure
29761>>>>>>>    
29761>>>>>>>    Function pbChecked Returns Boolean
29763>>>>>>>        Boolean bValue
29763>>>>>>>        If (IsComObjectCreated(Self)) Begin
29765>>>>>>>            Get ComChecked to bValue
29766>>>>>>>        End
29766>>>>>>>>
29766>>>>>>>        Else Begin
29767>>>>>>>            Get pbPrivateChecked to bValue
29768>>>>>>>        End
29768>>>>>>>>
29768>>>>>>>        Function_Return bValue
29769>>>>>>>    End_Function
29770>>>>>>>
29770>>>>>>>    Procedure Set pbEnabled Boolean bValue
29772>>>>>>>        Set pbPrivateEnabled to bValue
29773>>>>>>>        If (IsComObjectCreated(Self)) Begin
29775>>>>>>>            Set ComEnabled to bValue
29776>>>>>>>        End
29776>>>>>>>>
29776>>>>>>>    End_Procedure
29777>>>>>>>    
29777>>>>>>>    Function pbEnabled Returns Boolean
29779>>>>>>>        Boolean bValue
29779>>>>>>>        If (IsComObjectCreated(Self)) Begin
29781>>>>>>>            Get ComEnabled to bValue
29782>>>>>>>        End
29782>>>>>>>>
29782>>>>>>>        Else Begin
29783>>>>>>>            Get pbPrivateEnabled to bValue
29784>>>>>>>        End
29784>>>>>>>>
29784>>>>>>>        Function_Return bValue
29785>>>>>>>    End_Function
29786>>>>>>>
29786>>>>>>>    Procedure Set pbVisible Boolean bValue
29788>>>>>>>        Set pbPrivateVisible to bValue
29789>>>>>>>        If (IsComObjectCreated(Self)) Begin
29791>>>>>>>            Set ComVisible to bValue
29792>>>>>>>        End
29792>>>>>>>>
29792>>>>>>>    End_Procedure
29793>>>>>>>    
29793>>>>>>>    Function pbVisible Returns Boolean
29795>>>>>>>        Boolean bValue
29795>>>>>>>        If (IsComObjectCreated(Self)) Begin
29797>>>>>>>            Get ComVisible to bValue
29798>>>>>>>        End
29798>>>>>>>>
29798>>>>>>>        Else Begin
29799>>>>>>>            Get pbPrivateVisible to bValue
29800>>>>>>>        End
29800>>>>>>>>
29800>>>>>>>        Function_Return bValue
29801>>>>>>>    End_Function
29802>>>>>>>
29802>>>>>>>
29802>>>>>>>    Procedure Set psCaption String sValue
29804>>>>>>>        Set psPrivateCaption to sValue
29805>>>>>>>        If (IsComObjectCreated(Self)) Begin
29807>>>>>>>            Set ComCaption to sValue
29808>>>>>>>        End
29808>>>>>>>>
29808>>>>>>>    End_Procedure
29809>>>>>>>    
29809>>>>>>>    Function psCaption Returns String
29811>>>>>>>        String sValue
29811>>>>>>>        If (IsComObjectCreated(Self)) Begin
29813>>>>>>>            Get ComCaption to sValue
29814>>>>>>>        End
29814>>>>>>>>
29814>>>>>>>        Else Begin
29815>>>>>>>            Get psPrivateCaption to sValue
29816>>>>>>>        End
29816>>>>>>>>
29816>>>>>>>        Function_Return sValue
29817>>>>>>>    End_Function
29818>>>>>>>        
29818>>>>>>>    Procedure Set psCategory String sValue
29820>>>>>>>        Set psPrivateCategory to sValue
29821>>>>>>>        If (IsComObjectCreated(Self)) Begin
29823>>>>>>>            Set ComCategory to sValue
29824>>>>>>>        End
29824>>>>>>>>
29824>>>>>>>    End_Procedure
29825>>>>>>>    
29825>>>>>>>    Function psCategory Returns String
29827>>>>>>>        String sValue
29827>>>>>>>        If (IsComObjectCreated(Self)) Begin
29829>>>>>>>            Get ComCategory to sValue
29830>>>>>>>        End
29830>>>>>>>>
29830>>>>>>>        Else Begin
29831>>>>>>>            Get psPrivateCategory to sValue
29832>>>>>>>        End
29832>>>>>>>>
29832>>>>>>>        Function_Return sValue
29833>>>>>>>    End_Function
29834>>>>>>>
29834>>>>>>>    Procedure Set psDescription String sValue
29836>>>>>>>        Set psPrivateDescriptionText to sValue
29837>>>>>>>        If (IsComObjectCreated(Self)) Begin
29839>>>>>>>            Set ComDescriptionText to sValue
29840>>>>>>>        End
29840>>>>>>>>
29840>>>>>>>    End_Procedure
29841>>>>>>>    
29841>>>>>>>    Function psDescription Returns String
29843>>>>>>>        String sValue
29843>>>>>>>        If (IsComObjectCreated(Self)) Begin
29845>>>>>>>            Get ComDescriptionText to sValue
29846>>>>>>>        End
29846>>>>>>>>
29846>>>>>>>        Else Begin
29847>>>>>>>            Get psPrivateDescriptionText to sValue
29848>>>>>>>        End
29848>>>>>>>>
29848>>>>>>>        Function_Return sValue
29849>>>>>>>    End_Function
29850>>>>>>>
29850>>>>>>>    Procedure Set psToolTip String sValue
29852>>>>>>>        Set psPrivateToolTipText to sValue
29853>>>>>>>        If (IsComObjectCreated(Self)) Begin
29855>>>>>>>            Set ComToolTipText to sValue
29856>>>>>>>        End
29856>>>>>>>>
29856>>>>>>>    End_Procedure
29857>>>>>>>    
29857>>>>>>>    Function psToolTip Returns String
29859>>>>>>>        String sValue
29859>>>>>>>        If (IsComObjectCreated(Self)) Begin
29861>>>>>>>            Get ComToolTipText to sValue
29862>>>>>>>        End
29862>>>>>>>>
29862>>>>>>>        Else Begin
29863>>>>>>>            Get psPrivateToolTipText to sValue
29864>>>>>>>        End
29864>>>>>>>>
29864>>>>>>>        Function_Return sValue
29865>>>>>>>    End_Function
29866>>>>>>>
29866>>>>>>>    Procedure Set psShortcut String sValue
29868>>>>>>>        Set psPrivateShortcutText to sValue
29869>>>>>>>        If (IsComObjectCreated(Self)) Begin
29871>>>>>>>            Set ComShortcutText to sValue
29872>>>>>>>        End
29872>>>>>>>>
29872>>>>>>>    End_Procedure
29873>>>>>>>    
29873>>>>>>>    Function psShortcut Returns String
29875>>>>>>>        String sValue
29875>>>>>>>        If (IsComObjectCreated(Self)) Begin
29877>>>>>>>            Get ComShortcutText to sValue
29878>>>>>>>        End
29878>>>>>>>>
29878>>>>>>>        Else Begin
29879>>>>>>>            Get psPrivateShortcutText to sValue
29880>>>>>>>        End
29880>>>>>>>>
29880>>>>>>>        Function_Return sValue
29881>>>>>>>    End_Function
29882>>>>>>>
29882>>>>>>>
29882>>>>>>>    Procedure Set piShortCutKey Integer iExtra Integer iKey 
29884>>>>>>>        Set piPrivateShortCutKey to (iKey + (iExtra*65536))
29885>>>>>>>        If (IsComObjectCreated(Self)) Begin
29887>>>>>>>            Send BindKey iExtra iKey
29888>>>>>>>        End
29888>>>>>>>>
29888>>>>>>>    End_Procedure
29889>>>>>>>    
29889>>>>>>>    Function piShortCutKey Returns Integer
29891>>>>>>>        Integer iValue
29891>>>>>>>        Get piPrivateShortCutKey to iValue
29892>>>>>>>        Function_Return iValue
29893>>>>>>>    End_Function
29894>>>>>>>    
29894>>>>>>>    Procedure BindKey Integer iExtra Integer iKey 
29896>>>>>>>        Integer iId 
29896>>>>>>>        Handle hoKeyBindings hoCommandBars
29896>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29897>>>>>>>        Get piId to iId
29898>>>>>>>        If (iId=0) Begin
29900>>>>>>>            Error DFERR_PROGRAM "Assert: action Id zero in keybinding"
29901>>>>>>>>
29901>>>>>>>            Procedure_Return
29902>>>>>>>        End
29902>>>>>>>>
29902>>>>>>>        Get KeyBindingsCollection of hoCommandBars to hoKeyBindings
29903>>>>>>>
29903>>>>>>>        Send ComAdd of hoKeyBindings iExtra iKey iId
29904>>>>>>>    End_Procedure
29905>>>>>>>    
29905>>>>>>>    Procedure Set pbActiveUpdate Boolean bValue
29907>>>>>>>        Handle hoCommandBars
29907>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29908>>>>>>>        Set pbPrivateActiveUpdate to bValue
29909>>>>>>>        If (IsComObjectCreated(Self)) Begin
29911>>>>>>>            If bValue Begin
29913>>>>>>>                Send AddActiveAction of hoCommandBars Self
29914>>>>>>>            End
29914>>>>>>>>
29914>>>>>>>            Else Begin
29915>>>>>>>                Send RemoveActiveAction of hoCommandBars Self
29916>>>>>>>            End
29916>>>>>>>>
29916>>>>>>>        End
29916>>>>>>>>
29916>>>>>>>    End_Procedure
29917>>>>>>>    
29917>>>>>>>    Function pbActiveUpdate Returns Integer
29919>>>>>>>        Boolean bValue
29919>>>>>>>        Get pbPrivateActiveUpdate to bValue
29920>>>>>>>        Function_Return bValue
29921>>>>>>>    End_Function
29922>>>>>>>
29922>>>>>>>     // normally this is zero and not changed. When zero the imageId used will be
29922>>>>>>>     // the statusbarId and this is the ID that is used when the psImage method is used.
29922>>>>>>>     // Using psImage is preferred as it adds the icon and assigns it to the object.
29922>>>>>>>     // This can be used to change icons. Note 0=use StatusbarId
29922>>>>>>>    Procedure Set piIconId Integer iValue
29924>>>>>>>        Set piPrivateIconId to iValue
29925>>>>>>>        If (IsComObjectCreated(Self)) Begin
29927>>>>>>>            Set ComIconId to iValue
29928>>>>>>>        End
29928>>>>>>>>
29928>>>>>>>    End_Procedure
29929>>>>>>>    
29929>>>>>>>    Function piIconId Returns Integer
29931>>>>>>>        Integer iValue
29931>>>>>>>        If (IsComObjectCreated(Self)) Begin
29933>>>>>>>            Get ComIconId to iValue
29934>>>>>>>        End
29934>>>>>>>>
29934>>>>>>>        Else Begin
29935>>>>>>>            Get piPrivateIconId to iValue
29936>>>>>>>        End
29936>>>>>>>>
29936>>>>>>>        Function_Return iValue
29937>>>>>>>    End_Function
29938>>>>>>>
29938>>>>>>>    
29938>>>>>>>    
29938>>>>>>>    // For augmentation. Return true if the item should be visible
29938>>>>>>>    Function IsVisible Returns Boolean
29940>>>>>>>        Boolean bBool
29940>>>>>>>        Get pbVisible to bBool
29941>>>>>>>        Function_Return bBool
29942>>>>>>>    End_Function
29943>>>>>>>    
29943>>>>>>>    // For augmentation. Return true if the item should be enabled
29943>>>>>>>    Function IsEnabled Returns Boolean
29945>>>>>>>        Boolean bBool
29945>>>>>>>        Get pbEnabled to bBool
29946>>>>>>>        Function_Return bBool
29947>>>>>>>    End_Function
29948>>>>>>>    
29948>>>>>>>    // For augmentation. Return true if the item should be checked
29948>>>>>>>    Function IsChecked Returns Boolean
29950>>>>>>>        Boolean bBool
29950>>>>>>>        Get pbChecked to bBool
29951>>>>>>>        Function_Return bBool
29952>>>>>>>    End_Function
29953>>>>>>>    
29953>>>>>>>    Procedure CreateComAction
29955>>>>>>>        Variant vID vAction
29955>>>>>>>        Handle hoCommandBars hoActions
29955>>>>>>>        Handle[] hoActiveActions
29956>>>>>>>        String sCaption sToolTip sDescriptionText sCategory  sShortCutText
29956>>>>>>>        String sIcon sIconDisabled sIconHot sIconChecked sIconPressed
29956>>>>>>>        Integer iId iShortCut iIconId iAssignedId
29956>>>>>>>        Boolean bVisible bChecked bEnabled bOk
29956>>>>>>>        
29956>>>>>>>        Get CommandBarSystemObject to hoCommandBars
29957>>>>>>>        Get piId to iID
29958>>>>>>>        If (iId=0) Begin
29960>>>>>>>            // this can happen with context menus defined before the Commandbars is created
29960>>>>>>>            Get AssignId of hoCommandBars to iID
29961>>>>>>>            Set piId to iID
29962>>>>>>>        End
29962>>>>>>>>
29962>>>>>>>        
29962>>>>>>>        Get psPrivateCaption to sCaption
29963>>>>>>>        Get psPrivateTooltipText to sToolTip
29964>>>>>>>        Get psPrivateShortcutText to sShortCutText
29965>>>>>>>        Get psPrivateDescriptionText to sDescriptionText
29966>>>>>>>        Get psPrivateCategory to sCategory
29967>>>>>>>        Get pbPrivateVisible to bVisible
29968>>>>>>>        Get pbPrivateChecked to bChecked
29969>>>>>>>        Get pbPrivateEnabled to bEnabled
29970>>>>>>>        Get piPrivateShortCutKey to iShortCut
29971>>>>>>>        Get psImage to sIcon
29972>>>>>>>        Get psImageDisabled to sIconDisabled
29973>>>>>>>        Get psImageHot to sIconHot
29974>>>>>>>        Get psImageChecked to sIconChecked
29975>>>>>>>        Get psImagePressed to sIconPressed
29976>>>>>>>        Get piPrivateIconId to iIconId
29977>>>>>>>        
29977>>>>>>>        Get CommandBarSystemObject to hoCommandBars // via delegation
29978>>>>>>>        Get ActionsCollection of hoCommandBars to hoActions
29979>>>>>>>        Get ComAdd of hoActions iID sCaption sToolTip sDescriptionText sCategory to vAction
29980>>>>>>>        Set pvComObject to vAction
29981>>>>>>>        Set ComEnabled to bEnabled
29982>>>>>>>        Set ComVisible to bVisible
29983>>>>>>>        Set ComChecked to bChecked
29984>>>>>>>        Set ComShortcutText to sShortCutText
29985>>>>>>>        Set piIconId to iIconId
29986>>>>>>>        Set ComTag to Self // used as back pointer from com object to DF object
29987>>>>>>>        
29987>>>>>>>        If (sIcon<>"") Begin
29989>>>>>>>            Get AddImage of hoCommandBars sIcon iId xtpImageNormal to iAssignedId
29990>>>>>>>        End
29990>>>>>>>>
29990>>>>>>>        If (sIconDisabled<>"") Begin
29992>>>>>>>            Get AddImage of hoCommandBars sIconDisabled iId xtpImageDisabled to iAssignedId
29993>>>>>>>        End
29993>>>>>>>>
29993>>>>>>>        If (sIconHot<>"") Begin
29995>>>>>>>            Get AddImage of hoCommandBars sIconHot iId xtpImageHot to iAssignedId
29996>>>>>>>        End
29996>>>>>>>>
29996>>>>>>>        If (sIconChecked<>"") Begin
29998>>>>>>>            Get AddImage of hoCommandBars sIconChecked iId xtpImageChecked to iAssignedId
29999>>>>>>>        End
29999>>>>>>>>
29999>>>>>>>        If (sIconPressed<>"") Begin
30001>>>>>>>            Get AddImage of hoCommandBars sIconPressed iId xtpImagePressed to iAssignedId
30002>>>>>>>        End
30002>>>>>>>>
30002>>>>>>>
30002>>>>>>>        If (iShortCut<>0) Begin
30004>>>>>>>            Send BindKey (hi(iShortCut)) (low(iShortCut))
30005>>>>>>>        End
30005>>>>>>>>
30005>>>>>>>        
30005>>>>>>>        Send OnCreateAction
30006>>>>>>> 
30006>>>>>>>        Send RegisterAction of hoCommandBars Self
30007>>>>>>>        
30007>>>>>>>    End_Procedure
30008>>>>>>>    
30008>>>>>>>    // called during initial activation to set all default actions.
30008>>>>>>>    Procedure CreateComInstance
30010>>>>>>>        Send CreateComAction
30011>>>>>>>        // actions are flat. You don't look for child actions
30011>>>>>>>    End_Procedure
30012>>>>>>>    
30012>>>>>>>    // find the first control that matches this action's ID. This searches the entire
30012>>>>>>>    // commandbar system and "first" is just the first one it happens to find.
30012>>>>>>>    Function FindFirstControl Returns Variant
30014>>>>>>>          Variant vControl
30014>>>>>>>          Integer iId
30014>>>>>>>          Handle hoCommandBars hoCommandBar
30014>>>>>>>          Get CommandBarSystemObject to hoCommandBars
30015>>>>>>>          Get piId to iId
30016>>>>>>>          Get ComFindControl of hoCommandBars xtpControlError iId Nothing True to vControl
30017>>>>>>>          If (IsNullComObject(vControl)) Begin
30019>>>>>>>              // if not found this could be from our context menu. ComFindControl does not search
30019>>>>>>>              // the active context menu. We will test the focused command bar to see if we can
30019>>>>>>>              // find the object in there. This may create a duplicate search but it will not matter.
30019>>>>>>>              Get ComFocusedCommandBar of hoCommandBars to vControl
30020>>>>>>>              If (not(IsNullComObject(vControl))) Begin
30022>>>>>>>                  Get Create U_cCJCommandBar to hoCommandBar
30023>>>>>>>                  Set pvComObject of hoCommandBar to vControl
30024>>>>>>>                  Get ComFindControl of hoCommandBar xtpControlError iId Nothing True to vControl
30025>>>>>>>                  Send Destroy of hoCommandBar
30026>>>>>>>              End
30026>>>>>>>>
30026>>>>>>>          End
30026>>>>>>>>
30026>>>>>>>          Function_Return vControl
30027>>>>>>>      End_Function    
30028>>>>>>>    
30028>>>>>>>    // delete all com controls for this action
30028>>>>>>>    Procedure DeleteAllControlsForAction
30030>>>>>>>        Handle hoCommandBars hoControl
30030>>>>>>>        Variant vControl
30030>>>>>>>        Get Create U_cCJCommandBarControl to hoControl
30031>>>>>>>        Repeat
30031>>>>>>>>
30031>>>>>>>            Get FindFirstControl to vControl
30032>>>>>>>            If not (IsNullComObject(vControl)) Begin
30034>>>>>>>                Set pvComObject of hoControl to vControl
30035>>>>>>>                Send ComDelete to hoControl
30036>>>>>>>            End
30036>>>>>>>>
30036>>>>>>>        Until (IsNullComObject(vControl))
30038>>>>>>>        Send Destroy of hoControl
30039>>>>>>>    End_Procedure
30040>>>>>>>
30040>>>>>>>    // find all controls owned by this action anywhere in the commandbar system
30040>>>>>>>    // returns a variant array. This is only needed if you expect that there will be
30040>>>>>>>    // multiple hits such as could happen if you allow end user editing.
30040>>>>>>>    // This was created because there is no COM message to do this. This is pretty low level
30040>>>>>>>    // (like ComFindControl) and will not be used much.
30040>>>>>>>    Function FindAllControls Returns Variant[]
30042>>>>>>>        Variant[] ArrayofvControls
30043>>>>>>>        Integer iId
30043>>>>>>>        Handle hoCommandBars
30043>>>>>>>        Get CommandBarSystemObject to hoCommandBars
30044>>>>>>>        Get piId to iId
30045>>>>>>>        Get FindControls of hoCommandBars iId to ArrayofvControls
30046>>>>>>>        Function_Return ArrayofvControls
30047>>>>>>>    End_Function
30048>>>>>>>
30048>>>>>>>    // Return the class for the passed control type. Good for augmentation
30048>>>>>>>    Function ClassForControlType Integer eType Returns Integer
30050>>>>>>>        Integer iClass
30050>>>>>>>        Case Begin
30050>>>>>>>            Case (eType=xtpControlButton)     
30052>>>>>>>            Case (eType=xtpControlCheckBox)   
30055>>>>>>>            Case (eType=xtpControlRadioButton)
30058>>>>>>>            Case (eType=xtpControlLabel)      
30061>>>>>>>                 Move U_cCJCommandBarButton to eType
30062>>>>>>>                 Case Break
30063>>>>>>>            Case (eType=xtpControlPopup)      
30066>>>>>>>            Case (eType=xtpControlButtonPopup) 
30069>>>>>>>            Case (eType=xtpControlSplitButtonPopup)
30072>>>>>>>                 Move U_cCJCommandBarPopup to eType
30073>>>>>>>                 Case Break
30074>>>>>>>            Case (eType=xtpControlComboBox)
30077>>>>>>>                 Move U_cCJCommandBarComboBox to eType
30078>>>>>>>                 Case Break
30079>>>>>>>            Case (eType=xtpControlCustom)
30082>>>>>>>                 Move U_cCJCommandBarControlCustom to eType
30083>>>>>>>                 Case Break
30084>>>>>>>            Case (eType=xtpControlEdit)
30087>>>>>>>                 Move U_cCJCommandBarEdit to eType
30088>>>>>>>                 Case Break
30089>>>>>>>            Case (eType=xtpControlGallery)
30092>>>>>>>                 Move U_cCJCommandBarGallery to eType
30093>>>>>>>                 Case Break
30094>>>>>>>            Case Else
30094>>>>>>>                 Move U_cCJCommandBarControl to eType
30095>>>>>>>        Case End
30095>>>>>>>        Function_Return eType
30096>>>>>>>    End_Function
30097>>>>>>>    
30097>>>>>>>    // Creates a DF object of the proper type and binds it to the COM object.
30097>>>>>>>    Function CreateProxyControl Variant vControl Returns Handle
30099>>>>>>>        Handle hoObj
30099>>>>>>>        Integer eType iClass
30099>>>>>>>        Get Create U_cCJCommandBarControl to hoObj
30100>>>>>>>        Set pvComObject of hoObj to vControl
30101>>>>>>>        Get ComType of hoObj to eType
30102>>>>>>>        Send Destroy of hoObj
30103>>>>>>>        Move 0 to hoObj
30104>>>>>>>        Get ClassForControlType eType to iCLass
30105>>>>>>>        If (iClass<>0) Begin
30107>>>>>>>            Get Create iClass to hoObj
30108>>>>>>>            Set pvComObject of hoObj to vControl
30109>>>>>>>        End
30109>>>>>>>>
30109>>>>>>>        Function_Return hoObj
30110>>>>>>>    End_Function
30111>>>>>>>
30111>>>>>>>    // use this to find the COM control and return a DF object. You must call this if
30111>>>>>>>    // you don't already have the control pointer. You should only call this if you know that
30111>>>>>>>    // there will only be one control attached to the action. Make no assumption about what "First" means. It's
30111>>>>>>>    // the first one the COM control finds.  
30111>>>>>>>    Function CreateFirstProxyControl Returns Handle
30113>>>>>>>        Variant vControl
30113>>>>>>>        Handle hoControl
30113>>>>>>>        Get FindFirstControl to vControl
30114>>>>>>>        If (not(IsNullComObject(vControl))) Begin
30116>>>>>>>            Get CreateProxyControl vControl to hoControl
30117>>>>>>>        End
30117>>>>>>>>
30117>>>>>>>        Function_Return hoControl    
30118>>>>>>>    End_Function
30119>>>>>>>
30119>>>>>>>
30119>>>>>>>    // when a manual destroy is sent we need to do some cleanup.
30119>>>>>>>    // If an active action, it must be removed from the active action array
30119>>>>>>>    // All menu controls for this action will be removed, wherever they are within the system
30119>>>>>>>    // The Action Id will be added back to the pool for reuse. This is needed because the com
30119>>>>>>>    // action is not destroyed (there is no interface for this).
30119>>>>>>>    Procedure Destroy
30121>>>>>>>        Handle hoCommandBars 
30121>>>>>>>        Integer iId
30121>>>>>>>        Variant vControl
30121>>>>>>>        
30121>>>>>>>        Get piId to iId
30122>>>>>>>        // if no com object then this never got activated or another action object is
30122>>>>>>>        // used for this (which doesn't really make sense).
30122>>>>>>>        If (iId>0) Begin
30124>>>>>>>            Get CommandBarSystemObject to hoCommandBars
30125>>>>>>>            If (IsComObjectCreated(Self)) Begin
30127>>>>>>>                Send DeleteAllControlsForAction
30128>>>>>>>            End
30128>>>>>>>>
30128>>>>>>>            Send ReleaseId of hoCommandBars (piId(Self))
30129>>>>>>>        End
30129>>>>>>>>
30129>>>>>>>        Forward Send Destroy
30131>>>>>>>    End_Procedure
30132>>>>>>>
30132>>>>>>>    // if the action is being released we must remove it from the action pool. This is needed for 
30132>>>>>>>    // context menus which whose actions get created and released with each invocation. This will also 
30132>>>>>>>    // happen when an object is destroyed. If the com object is created, destroy will send ReleaseComObject
30132>>>>>>>    Procedure ReleaseComObject
30134>>>>>>>        Integer iId
30134>>>>>>>        Handle hoCommandBars
30134>>>>>>>        Get piId to iId
30135>>>>>>>        If (iId>0 and IsComObjectCreated(Self)) Begin
30137>>>>>>>            Get CommandBarSystemObject to hoCommandBars
30138>>>>>>>            Send RemoveRegisteredAction of hoCommandBars Self
30139>>>>>>>        End
30139>>>>>>>>
30139>>>>>>>        Forward Send ReleaseComObject
30141>>>>>>>    End_Procedure
30142>>>>>>>
30142>>>>>>>    
30142>>>>>>>    // called when this action is selected. Only send OnExecute if the
30142>>>>>>>    // action is enabled. 
30142>>>>>>>    Procedure Execute Variant vCommandBarControl
30144>>>>>>>        Boolean bIsEnabled
30144>>>>>>>        Variant vObject
30144>>>>>>>        Get IsEnabled to bIsEnabled
30145>>>>>>>        If bIsEnabled Begin
30147>>>>>>>            // we will allow no parameter being passed. In such a case the developer probably sent
30147>>>>>>>            // execute themselves and did not pass a com pointer (which you don't normally care about)
30147>>>>>>>            // if this happens just pass a null com object to the OnExecute. 
30147>>>>>>>            If (Num_Arguments=0) Begin
30149>>>>>>>                Move (NullComObject()) to vObject
30150>>>>>>>            End
30150>>>>>>>>
30150>>>>>>>            Else Begin
30151>>>>>>>                Move vCommandBarControl to vObject
30152>>>>>>>            End
30152>>>>>>>>
30152>>>>>>>            Send OnExecute vObject
30153>>>>>>>            Send Update
30154>>>>>>>        End
30154>>>>>>>>
30154>>>>>>>    End_Procedure
30155>>>>>>>
30155>>>>>>>    // Updates the action. Can be called by timer when active update or
30155>>>>>>>    // called when a menu pops up
30155>>>>>>>    Procedure Update
30157>>>>>>>        Set pbVisible to (IsVisible(Self))
30158>>>>>>>        Set pbEnabled to (IsEnabled(Self))
30159>>>>>>>        Set pbChecked to (IsChecked(Self))
30160>>>>>>>        Send OnUpdate
30161>>>>>>>    End_Procedure
30162>>>>>>>    
30162>>>>>>>    // Event called to update the action
30162>>>>>>>    Procedure OnUpdate
30164>>>>>>>    End_Procedure
30165>>>>>>>
30165>>>>>>>    // before this is called IsEnabled is called
30165>>>>>>>    Procedure OnExecute Variant vCommandBarControl
30167>>>>>>>    End_Procedure
30168>>>>>>>    
30168>>>>>>>    // when hover over
30168>>>>>>>    Procedure OnSelected Variant vCommandBarControl
30170>>>>>>>    End_Procedure
30171>>>>>>>    
30171>>>>>>>    // creation of action.
30171>>>>>>>    Procedure OnCreateAction
30173>>>>>>>    End_Procedure
30174>>>>>>>    
30174>>>>>>>    // before called, self and all items IsEnabled, IsChecked and IsVisible are called
30174>>>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hoCommandBarControls
30176>>>>>>>    End_Procedure
30177>>>>>>>
30177>>>>>>>    Procedure End_Construct_Object
30179>>>>>>>        Integer iID
30179>>>>>>>        Handle hoCommandBars
30179>>>>>>>        Get piId to iID
30180>>>>>>>        // if the ID is 0, auto-assign it.
30180>>>>>>>        If (iID=0) Begin
30182>>>>>>>            Get CommandBarSystemObject to hoCommandBars
30183>>>>>>>            // context menus may not be able to assign an id until they are created.
30183>>>>>>>            If (hoCommandBars<>0) Begin
30185>>>>>>>                Get AssignId of hoCommandBars to iID
30186>>>>>>>                Set piId to iID
30187>>>>>>>            End
30187>>>>>>>>
30187>>>>>>>        End
30187>>>>>>>>
30187>>>>>>>        Forward Send End_Construct_Object
30189>>>>>>>    End_Procedure
30190>>>>>>>    
30190>>>>>>>
30190>>>>>>>End_Class
30191>>>>>>>
30191>>>>>>>// can be used by all controls. Menu, toolbar and popups.
30191>>>>>>>
30191>>>>>>>
30191>>>>>>>Class cCJMenuItem is a cCJAction
30192>>>>>>>
30192>>>>>>>    Procedure Construct_Object
30194>>>>>>>        Forward Send Construct_Object
30196>>>>>>>        
30196>>>>>>>        // note that these properties are design time and initalize time only properties
30196>>>>>>>        Property Integer peControlType xtpControlButton
30197>>>>>>>
30197>>>>>>>        Property Integer peControlStyle xtpButtonAutomatic
30198>>>>>>>
30198>>>>>>>        Property Boolean pbControlBeginGroup   False
30199>>>>>>>        Property Boolean pbControlCloseSubMenu True
30200>>>>>>>        Property Boolean pbControlFlagRightAlign False
30201>>>>>>>        Property Boolean pbControlFlagLeftPopup  False
30202>>>>>>>        Property Boolean pbControlFlagNoMovable  False
30203>>>>>>>        Property Boolean pbControlFlagControlStretched False
30204>>>>>>>        Property Boolean pbControlFlagShowPopupBarToolTip False
30205>>>>>>>        Property Boolean pbControlFlagWrapRow False
30206>>>>>>>        Property Boolean pbControlDoubleGripper    False
30207>>>>>>>        Property Boolean pbControlPopupToolBar   False
30208>>>>>>>
30208>>>>>>>        Property Boolean pbAddToDesignerMenu False 
30209>>>>>>>        
30209>>>>>>>        // Used to redirect an action to a different object.
30209>>>>>>>        Property Integer phoAction Self
30210>>>>>>>
30210>>>>>>>        Property Boolean pbInCreateTempInstance False
30211>>>>>>>        
30211>>>>>>>    End_Procedure
30212>>>>>>>    
30212>>>>>>>    // returns true if the control is a popup type - i.e., it will have child menu items. Good for Augmentation
30212>>>>>>>    Function IsPopup Returns Boolean
30214>>>>>>>        Integer eType
30214>>>>>>>        Get peControlType to eType
30215>>>>>>>        Function_Return (eType=xtpControlPopup or eType=xtpControlButtonPopup or eType=xtpControlSplitButtonPopup)
30216>>>>>>>    End_Function
30217>>>>>>> 
30217>>>>>>>
30217>>>>>>>
30217>>>>>>>     // must create action and then the visual control
30217>>>>>>>     Procedure CreateComInstance Handle hoControls
30219>>>>>>>        Variant vNewControl vNewControls vCommandBar
30219>>>>>>>        Handle hoNewControl hoNewControls hoCommandBar hoAction hoDesignerControls
30219>>>>>>>        Integer iId
30219>>>>>>>        Boolean bPopup
30219>>>>>>>        
30219>>>>>>>        Send AssignAction
30220>>>>>>>        Get CreateComControl hoControls to vNewControl
30221>>>>>>>        If (IsNullComObject(vNewControl)) Begin
30223>>>>>>>            Procedure_Return
30224>>>>>>>        End
30224>>>>>>>>
30224>>>>>>>        
30224>>>>>>>        Get piId to iId
30225>>>>>>>        
30225>>>>>>>        Get Create U_cCJCommandBarPopup to hoNewControl
30226>>>>>>>        Get Create U_cCJCommandBar to hoCommandbar
30227>>>>>>>        Get Create U_cCJCommandBarControls to hoNewControls
30228>>>>>>>
30228>>>>>>>        Set pvComObject of hoNewControl to vNewControl
30229>>>>>>>
30229>>>>>>>        Get IsPopup to bPopup
30230>>>>>>>        If (bPopup) Begin
30232>>>>>>>            
30232>>>>>>>            Get ComCommandBar of hoNewControl to vCommandBar
30233>>>>>>>            Set pvComObject of hoCommandBar to vCommandBar
30234>>>>>>>            Get ComControls of hoCommandBar to vNewControls
30235>>>>>>>            Set pvComObject of hoNewControls to vNewControls
30236>>>>>>>            
30236>>>>>>>            Broadcast Send CreateComInstance hoNewControls
30238>>>>>>>            
30238>>>>>>>        End
30238>>>>>>>>
30238>>>>>>>        
30238>>>>>>>        // if add to designer, create another instance of this control and add it to the designer
30238>>>>>>>        // controls. This uses the same action as the regular control. We do this after the child controls
30238>>>>>>>        // are created so that menus will contain all of their children.
30238>>>>>>>        If (pbAddToDesignerMenu(Self)) Begin
30240>>>>>>>            Get DesignerControlsCollection to hoDesignerControls
30241>>>>>>>            // if a designer control for this action already exists, we will not add it again.
30241>>>>>>>            Get ComFind of hoDesignerControls xtpControlError iId Nothing True to vNewControl
30242>>>>>>>            If (IsNullComObject(vNewControl)) Begin
30244>>>>>>>                Get CreateComControl hoDesignerControls to vNewControl
30245>>>>>>>                Set pvComObject of hoNewControl to vNewControl
30246>>>>>>>                If (bPopup) Begin
30248>>>>>>>                    Get ComCommandBar of hoNewControl to vCommandBar
30249>>>>>>>                    Set pvComObject of hoCommandBar to vCommandBar
30250>>>>>>>                    Get ComControls of hoCommandBar to vNewControls
30251>>>>>>>                    Set pvComObject of hoNewControls to vNewControls
30252>>>>>>>                    // note that it is safe to do this because the actions will not get
30252>>>>>>>                    // created again. Only the controls will get created.
30252>>>>>>>                    Broadcast Send CreateComInstance hoNewControls
30254>>>>>>>                End
30254>>>>>>>>
30254>>>>>>>            End
30254>>>>>>>>
30254>>>>>>>        End
30254>>>>>>>>
30254>>>>>>>
30254>>>>>>>        Send Destroy of hoNewControls
30255>>>>>>>        Send Destroy of hoCommandBar
30256>>>>>>>        Send Destroy of hoNewControl
30257>>>>>>>
30257>>>>>>>     End_Procedure
30258>>>>>>>     
30258>>>>>>>     // handle action for this menu-item. If the item is the action, make sure a com instance is created
30258>>>>>>>     // if this is not the action, attach to the action which should be created
30258>>>>>>>     // lots of assertions if there is a problem
30258>>>>>>>     Procedure AssignAction
30260>>>>>>>        Handle hoAction
30260>>>>>>>        Integer iId
30260>>>>>>>        
30260>>>>>>>        Get phoAction to hoAction
30261>>>>>>>        
30261>>>>>>>        If not hoAction Begin
30263>>>>>>>            Error DFERR_PROGRAM "Assert: action object is not assigned for menu item"
30264>>>>>>>>
30264>>>>>>>            Procedure_Return
30265>>>>>>>        End
30265>>>>>>>>
30265>>>>>>>        
30265>>>>>>>        // If the action object is self (normal) then we create an action com object if needed.
30265>>>>>>>        // it is possible that the action will already be created. If so, do nothing.
30265>>>>>>>        If (hoAction=Self) Begin
30267>>>>>>>            If not (IsComObjectCreated(Self)) Begin
30269>>>>>>>                Send CreateComAction
30270>>>>>>>            End
30270>>>>>>>>
30270>>>>>>>            Get piId to iId
30271>>>>>>>        End
30271>>>>>>>>
30271>>>>>>>        // if the action is some other object, we will assume it has already been created and just assign
30271>>>>>>>        // its id.
30271>>>>>>>        Else Begin
30272>>>>>>>            Get piId of hoAction to iId
30273>>>>>>>            Set piId to iId
30274>>>>>>>        End
30274>>>>>>>>
30274>>>>>>>        
30274>>>>>>>        If (iId=0) Begin
30276>>>>>>>            Error DFERR_PROGRAM "Assert: Action ID is zero"
30277>>>>>>>>
30277>>>>>>>            Procedure_Return
30278>>>>>>>        End
30278>>>>>>>>
30278>>>>>>>        
30278>>>>>>>        If not (IsComObjectCreated(hoAction)) Begin
30280>>>>>>>            Error  DFERR_PROGRAM "Assert: Action com object not created"
30281>>>>>>>>
30281>>>>>>>            Procedure_Return
30282>>>>>>>        End
30282>>>>>>>>
30282>>>>>>>     End_Procedure
30283>>>>>>>
30283>>>>>>>     Function AddDynamicControl Handle hoControls Returns Variant
30285>>>>>>>        Variant vNewControl vCommandBar vNewControls
30285>>>>>>>        Boolean bOldTemp bPopup
30285>>>>>>>        Handle hoNewControl  hoCommandBar hoNewControls
30285>>>>>>>
30285>>>>>>>        Get pbInCreateTempInstance to bOldTemp
30286>>>>>>>        Set pbInCreateTempInstance to True
30287>>>>>>>
30287>>>>>>>        Send AssignAction
30288>>>>>>>        Get CreateComControl hoControls to vNewControl // if null, an assertion will be declared
30289>>>>>>>
30289>>>>>>>        Get IsPopup to bPopup
30290>>>>>>>        If (bPopup) Begin
30292>>>>>>>            
30292>>>>>>>            Get Create U_cCJCommandBarPopup to hoNewControl
30293>>>>>>>            Get Create U_cCJCommandBar to hoCommandbar
30294>>>>>>>            Get Create U_cCJCommandBarControls to hoNewControls
30295>>>>>>>
30295>>>>>>>            Set pvComObject of hoNewControl to vNewControl
30296>>>>>>>
30296>>>>>>>            Get ComCommandBar of hoNewControl to vCommandBar
30297>>>>>>>            Set pvComObject of hoCommandBar to vCommandBar
30298>>>>>>>            Get ComControls of hoCommandBar to vNewControls
30299>>>>>>>            Set pvComObject of hoNewControls to vNewControls
30300>>>>>>>            
30300>>>>>>>            Broadcast Send CreateComInstance hoNewControls
30302>>>>>>>            
30302>>>>>>>            Send Destroy of hoNewControls
30303>>>>>>>            Send Destroy of hoCommandBar
30304>>>>>>>            Send Destroy of hoNewControl
30305>>>>>>>            
30305>>>>>>>        End
30305>>>>>>>>
30305>>>>>>>
30305>>>>>>>
30305>>>>>>>        Set pbInCreateTempInstance to bOldTemp
30306>>>>>>>
30306>>>>>>>        Function_Return vNewControl
30307>>>>>>>     End_Function
30308>>>>>>> 
30308>>>>>>>     // used to actually create the desired control and add it to the passed commandbars    
30308>>>>>>>     Function CreateCommandBarControl Handle hoControls Integer eType Integer iId Boolean bInCreateTempInstance Returns Variant
30310>>>>>>>        Variant vControl
30310>>>>>>>        Get ComAdd of hoControls eType iId "" Nothing bInCreateTempInstance to vControl
30311>>>>>>>        Function_Return vControl
30312>>>>>>>     End_Function
30313>>>>>>>     
30313>>>>>>>    // create the menu item control. Return a DataFlex object for this control
30313>>>>>>>    // This assumes that an action ID exiss and that a com action object is created.
30313>>>>>>>    
30313>>>>>>>    Function CreateComControl Handle hoControls Returns Variant
30315>>>>>>>        Handle hoObj hoCommandBar hoCommandBars 
30315>>>>>>>        Variant vControl vCommandbar
30315>>>>>>>        Integer iId eType eStyle eFlags iClass
30315>>>>>>>        Boolean bPopup bBegin bClose bDoubleGripper bPopupToolBar
30315>>>>>>>        Boolean bFlagStretch bFlagLeftPopup bFlagNoMove bFlagRightAlign bFlagShowTip bFlagWrap
30315>>>>>>>        Boolean bInCreateTempInstance
30315>>>>>>>        
30315>>>>>>>        
30315>>>>>>>        Get pbInCreateTempInstance to bInCreateTempInstance
30316>>>>>>>
30316>>>>>>>        Get piId to iId
30317>>>>>>>        Get peControlType to eType
30318>>>>>>>        Get peControlStyle to eStyle
30319>>>>>>>        Get pbControlBeginGroup to bBegin
30320>>>>>>>        Get pbControlCloseSubMenu to bClose
30321>>>>>>>        Get pbControlFlagControlStretched to bFlagStretch
30322>>>>>>>        Get pbControlFlagLeftPopup to bFlagLeftPopup
30323>>>>>>>        Get pbControlFlagNoMovable to bFlagNoMove
30324>>>>>>>        Get pbControlFlagRightAlign to bFlagRightAlign
30325>>>>>>>        Get pbControlFlagShowPopupBarToolTip to bFlagShowTip
30326>>>>>>>        Get pbControlDoubleGripper to bDoubleGripper
30327>>>>>>>        Get pbControlPopupToolBar to bPopupToolBar
30328>>>>>>>        Get pbControlFlagWrapRow to bFlagWrap
30329>>>>>>>        // assemble the COMFlags from the flag properties.
30329>>>>>>>        Move (If(bFlagStretch,xtpFlagControlStretched,0) + ;              If(bFlagLeftPopup,xtpFlagLeftPopup,0) +;              If(bFlagNoMove,xtpFlagNoMovable,0) +;              If(bFlagRightAlign,xtpFlagRightAlign,0) +;              If(bFlagShowTip,xtpFlagShowPopupBarTip,0) +;              If(bFlagWrap,xtpFlagWrapRow,0) ) to eFlags
30330>>>>>>>        
30330>>>>>>>        Get CreateCommandBarControl hoControls eType iId bInCreateTempInstance to vControl
30331>>>>>>>        
30331>>>>>>>        If (IsNullComObject(vControl)) Begin
30333>>>>>>>            Error DFERR_PROGRAM ("Assert: could not create com control: Type" - String(eType) - ", iId=" - String(iId))
30334>>>>>>>>
30334>>>>>>>            Function_Return vControl
30335>>>>>>>        End
30335>>>>>>>>
30335>>>>>>>        
30335>>>>>>>        Get IsPopup to bPopup
30336>>>>>>>        Get ClassForControlType eType to iClass
30337>>>>>>>        Get Create iClass to hoObj
30338>>>>>>>        Set pvComObject of hoObj to vControl
30339>>>>>>>        Set ComStyle of hoObj to eStyle
30340>>>>>>>        Set ComBeginGroup of hoObj to bBegin
30341>>>>>>>        Set ComCloseSubMenuOnClick of hoObj to bClose
30342>>>>>>>        Set ComFlags of hoObj to eFlags
30343>>>>>>>        
30343>>>>>>>        If bPopup Begin
30345>>>>>>>            Get Create U_cCJCommandBar to hoCommandbar
30346>>>>>>>            Get ComCommandBar of hoObj to vCommandBar
30347>>>>>>>            
30347>>>>>>>            // it appears that it is possible to have a popup that does not get assigned
30347>>>>>>>            // a commandbar. If that happens we will add a commandbar to the control
30347>>>>>>>            // the hard way.
30347>>>>>>>            If (IsNullComObject(vCommandbar)) Begin
30349>>>>>>>                Get CommandBarSystemObject to hoCommandBars 
30350>>>>>>>                Get ComAdd of hoCommandBars "Popup" xtpBarPopup to vCommandBar
30351>>>>>>>                Set ComCommandBar of hoObj to vCommandBar
30352>>>>>>>            End
30352>>>>>>>>
30352>>>>>>>
30352>>>>>>>            Set pvComObject of hoCommandBar to vCommandBar
30353>>>>>>>
30353>>>>>>>            If (bDoubleGripper) Begin
30355>>>>>>>                Set ComDoubleGripper of hoCommandBar to True
30356>>>>>>>            End
30356>>>>>>>>
30356>>>>>>>            If (bPopupToolBar) Begin
30358>>>>>>>                Send ComSetPopupToolBar of hoCommandBar True
30359>>>>>>>            End
30359>>>>>>>>
30359>>>>>>>
30359>>>>>>>            Send Destroy of hoCommandBar
30360>>>>>>>        End
30360>>>>>>>>
30360>>>>>>>
30360>>>>>>>        Send OnCreateControl hoObj
30361>>>>>>>        
30361>>>>>>>        Send destroy of hoObj
30362>>>>>>>        
30362>>>>>>>        Function_Return vControl
30363>>>>>>>        
30363>>>>>>>    End_Function
30364>>>>>>>    
30364>>>>>>>    Procedure OnCreateControl Handle hoObj
30366>>>>>>>    End_Procedure    
30367>>>>>>>    
30367>>>>>>>End_Class
30368>>>>>>>
30368>>>>>>>
30368>>>>>>>Class cCJStatusBar is a cCJComStatusBar
30369>>>>>>>
30369>>>>>>>    Procedure Construct_Object
30371>>>>>>>        Boolean bMDI
30371>>>>>>>        Handle hoCommandBars
30371>>>>>>>        Forward Send Construct_Object
30373>>>>>>>        
30373>>>>>>>        Property Boolean pbPrivateDrawDisabledText True
30374>>>>>>>        Property String  psPrivateIdleText ''
30375>>>>>>>        Property Boolean pbPrivateVisible True        
30376>>>>>>>        
30376>>>>>>>        Property Integer piStatusBarId ID_StatusBarsAutoStart
30377>>>>>>>
30377>>>>>>>        Property Integer phoViewPane 0
30378>>>>>>>        
30378>>>>>>>        Set peNeighborhood to nhNo
30379>>>>>>>        
30379>>>>>>>       
30379>>>>>>>    End_Procedure
30380>>>>>>>
30380>>>>>>>    // Remove the references to the statusbar when it is about to be destroyed.
30380>>>>>>>    Procedure Destroy_Object          
30382>>>>>>>        Handle hoCommandBars
30382>>>>>>>        Boolean bMDI
30382>>>>>>>        Get CommandBarSystemObject to hoCommandBars
30383>>>>>>>        // if this is an MDI command bar, reset the main Status bar 
30383>>>>>>>        Get pbMDIMenu of hoCommandBars to bMDI
30384>>>>>>>        If bMDI Begin
30386>>>>>>>            Set Statusbar_Id to 0
30387>>>>>>>        End
30387>>>>>>>>
30387>>>>>>>        Set phoStatusBar of hoCommandBars to 0
30388>>>>>>>        Forward Send Destroy_Object
30390>>>>>>>    End_Procedure
30391>>>>>>>    
30391>>>>>>>    Procedure Set pbDrawDisabledText Boolean bValue
30393>>>>>>>        Set pbPrivateDrawDisabledText to bValue
30394>>>>>>>        If (IsComObjectCreated(Self)) Begin
30396>>>>>>>            Set ComDrawDisabledText to bValue
30397>>>>>>>        End
30397>>>>>>>>
30397>>>>>>>    End_Procedure
30398>>>>>>>    
30398>>>>>>>    Function pbDrawDisabledText Returns Boolean
30400>>>>>>>        Boolean bValue
30400>>>>>>>        If (IsComObjectCreated(Self)) Begin
30402>>>>>>>            Get ComDrawDisabledText to bValue
30403>>>>>>>        End
30403>>>>>>>>
30403>>>>>>>        Else Begin
30404>>>>>>>            Get pbPrivateDrawDisabledText to bValue
30405>>>>>>>        End
30405>>>>>>>>
30405>>>>>>>        Function_Return bValue
30406>>>>>>>    End_Function
30407>>>>>>>    
30407>>>>>>>    Procedure Set pbVisible Boolean bValue
30409>>>>>>>        Set pbPrivateVisible to bValue
30410>>>>>>>        If (IsComObjectCreated(Self)) Begin
30412>>>>>>>            Set ComVisible to bValue
30413>>>>>>>        End
30413>>>>>>>>
30413>>>>>>>    End_Procedure
30414>>>>>>>    
30414>>>>>>>    Function pbVisible Returns Boolean
30416>>>>>>>        Boolean bValue
30416>>>>>>>        // for some reason visible state of statusbar is set false when
30416>>>>>>>        // commandbarsystem is not active. So we also check active_state
30416>>>>>>>        If (IsComObjectCreated(Self) and Active_State(Self)) Begin
30418>>>>>>>            Get ComVisible to bValue
30419>>>>>>>        End
30419>>>>>>>>
30419>>>>>>>        Else Begin
30420>>>>>>>            Get pbPrivateVisible to bValue
30421>>>>>>>        End
30421>>>>>>>>
30421>>>>>>>        Function_Return bValue
30422>>>>>>>    End_Function
30423>>>>>>>
30423>>>>>>>    Procedure Set psIdleText String sValue
30425>>>>>>>        Set psPrivateIdleText to sValue
30426>>>>>>>        If (IsComObjectCreated(Self)) Begin
30428>>>>>>>            Set ComIdleText to sValue
30429>>>>>>>        End
30429>>>>>>>>
30429>>>>>>>    End_Procedure
30430>>>>>>>    
30430>>>>>>>    Function psIdleText Returns String
30432>>>>>>>        String sValue
30432>>>>>>>        If (IsComObjectCreated(Self)) Begin
30434>>>>>>>            Get ComIdleText to sValue
30435>>>>>>>        End
30435>>>>>>>>
30435>>>>>>>        Else Begin
30436>>>>>>>            Get psPrivateIdleText to sValue
30437>>>>>>>        End
30437>>>>>>>>
30437>>>>>>>        Function_Return sValue
30438>>>>>>>    End_Function
30439>>>>>>>
30439>>>>>>>
30439>>>>>>>    Procedure CreateComInstance
30441>>>>>>>        Handle hoCommandBars
30441>>>>>>>        Variant vStatusBar
30441>>>>>>>        String sTitle
30441>>>>>>>        Integer iBarId iWidth iDockFgs 
30441>>>>>>>        Boolean bDrawDisabledText bVisible bMDI
30441>>>>>>>        String  sIdleText
30441>>>>>>>        
30441>>>>>>>        // if already created, we don't do anything. This could happen during
30441>>>>>>>        // a restore
30441>>>>>>>        If (IsComObjectCreated(Self)) Begin
30443>>>>>>>            Procedure_Return
30444>>>>>>>        End
30444>>>>>>>>
30444>>>>>>>        
30444>>>>>>>        Get CommandBarSystemObject to hoCommandBars
30445>>>>>>>
30445>>>>>>>        // if this is an MDI command bar, we will define this as the main Status bar 
30445>>>>>>>        Get pbMDIMenu of hoCommandBars to bMDI
30446>>>>>>>        If bMDI Begin
30448>>>>>>>            Set Statusbar_Id to Self
30449>>>>>>>        End
30449>>>>>>>>
30449>>>>>>>        Set phoStatusBar of hoCommandBars to Self
30450>>>>>>>
30450>>>>>>>        Get pbPrivateDrawDisabledText to bDrawDisabledText
30451>>>>>>>        Get pbPrivateVisible to bVisible
30452>>>>>>>        Get psPrivateIdleText to sIdleText
30453>>>>>>>        Get ComStatusBar of hoCommandBars to vStatusBar
30454>>>>>>>        Set pvComObject to vStatusBar
30455>>>>>>>        Set ComDrawDisabledText to bDrawDisabledText
30456>>>>>>>        Set ComVisible to bVisible
30457>>>>>>>        Set ComIdleText to sIdleText
30458>>>>>>>
30458>>>>>>>        Send OnCreate
30459>>>>>>>
30459>>>>>>>        Broadcast Send CreateComInstance Self
30461>>>>>>>
30461>>>>>>>    End_Procedure
30462>>>>>>>    
30462>>>>>>>    // display "main" status help. Usually provided from DD. 
30462>>>>>>>    Procedure Show_Status_Help String sStatusHelp
30464>>>>>>>        Set psIdleText to sStatusHelp
30465>>>>>>>    End_Procedure
30466>>>>>>>
30466>>>>>>>    // show the view name in the pane if a phoViewPane exists
30466>>>>>>>    Procedure Show_View_Name String sName
30468>>>>>>>        Handle hoPane
30468>>>>>>>        Get phoViewPane to hoPane
30469>>>>>>>        If (hoPane) Begin
30471>>>>>>>            Set psText of hoPane to sName
30472>>>>>>>        End
30472>>>>>>>>
30472>>>>>>>    End_Procedure
30473>>>>>>>    
30473>>>>>>>    // legacy from old status bar
30473>>>>>>>    Procedure Exit_Menu
30475>>>>>>>    End_Procedure
30476>>>>>>>    
30476>>>>>>>    // returns an array of all pane objects (these are the DF objects, if additional COM panes were
30476>>>>>>>    // created they are not here)
30476>>>>>>>    Function PaneObjects Returns Handle[]
30478>>>>>>>        Handle[] hoPanes
30479>>>>>>>        Broadcast Send RegisterStatusPaneObject (&hoPanes)
30481>>>>>>>        Function_Return hoPanes
30482>>>>>>>    End_Function
30483>>>>>>>
30483>>>>>>>    // Find the DF object for the passed COM object. Returns 0 if none found
30483>>>>>>>    Function FindPaneObject Variant vPane Returns Handle
30485>>>>>>>        Handle hoPane
30485>>>>>>>        Handle[] hoPanes
30486>>>>>>>        Integer i iPanes iId
30486>>>>>>>        Get Create U_cCJComStatusBarPane to hoPane
30487>>>>>>>        Set pvComObject of hoPane to vPane
30488>>>>>>>        Get ComId of hoPane to iId
30489>>>>>>>        Send destroy of hoPane
30490>>>>>>>        Get PaneObjects to hoPanes // get all df pane objects
30491>>>>>>>        Move (SizeOfArray(hoPanes)) to iPanes
30492>>>>>>>        For i from 0 to (iPanes-1)
30498>>>>>>>>
30498>>>>>>>            If (iId=piId(hoPanes[i])) Begin // search for DF object with same ID as com object
30500>>>>>>>                Function_Return hoPanes[i]  
30501>>>>>>>            End
30501>>>>>>>>
30501>>>>>>>        Loop
30502>>>>>>>>
30502>>>>>>>        Function_Return 0
30503>>>>>>>    End_Function
30504>>>>>>>
30504>>>>>>>    // this returns the width, in pixels, needed to display a string.
30504>>>>>>>    Function PaneTextWidth String sText Returns Integer
30506>>>>>>>        Handle hWnd hDC
30506>>>>>>>        Integer cx bOK
30506>>>>>>>        Pointer lpsText lpsPoint
30506>>>>>>>        String sPoint
30506>>>>>>>
30506>>>>>>>        Get Window_Handle to hWnd
30507>>>>>>>        Move (GetDC(hWnd)) to hDC
30508>>>>>>>
30508>>>>>>>        ZeroType tPoint to sPoint
30509>>>>>>>        GetAddress of sPoint to lpsPoint
30510>>>>>>>        GetAddress of sText  to lpsText
30511>>>>>>>
30511>>>>>>>        Move (GetTextExtent(hDC, lpsText, length(sText), lpsPoint)) to bOk
30512>>>>>>>
30512>>>>>>>        Move (ReleaseDC(hWnd, hDC)) to hDC
30513>>>>>>>
30513>>>>>>>        GetBuff from sPoint At tPoint.x to cx
30514>>>>>>>
30514>>>>>>>        Function_Return cx
30515>>>>>>>    End_Function
30516>>>>>>>    
30516>>>>>>>    Procedure Update
30518>>>>>>>        Send OnUpdate
30519>>>>>>>    End_Procedure
30520>>>>>>>    
30520>>>>>>>    Procedure OnUpdate
30522>>>>>>>    End_Procedure
30523>>>>>>>
30523>>>>>>>    Procedure OnCreate
30525>>>>>>>    End_Procedure
30526>>>>>>>    
30526>>>>>>>    Procedure OnComPaneClick Variant llPane
30528>>>>>>>        Handle hoPane
30528>>>>>>>        Get FindPaneObject llPane to hoPane
30529>>>>>>>        If hoPane Begin
30531>>>>>>>            Send onClick of hoPane
30532>>>>>>>        End
30532>>>>>>>>
30532>>>>>>>    End_Procedure
30533>>>>>>>        
30533>>>>>>>    Procedure OnComPaneDblClick Variant llPane
30535>>>>>>>        Handle hoPane
30535>>>>>>>        Get FindPaneObject llPane to hoPane
30536>>>>>>>        If hoPane Begin
30538>>>>>>>            Send onDblClick of hoPane
30539>>>>>>>        End
30539>>>>>>>>
30539>>>>>>>    End_Procedure
30540>>>>>>>    
30540>>>>>>>End_Class
30541>>>>>>>
30541>>>>>>>
30541>>>>>>>Class cCJStatusBarPane is a cCJComStatusBarPane
30542>>>>>>>    
30542>>>>>>>    Procedure Construct_Object
30544>>>>>>>        Forward Send Construct_Object
30546>>>>>>>        Property Integer pePrivateAlignment xtpAlignmentLeft
30547>>>>>>>        Property Integer piPrivateBackGroundColor clNone
30548>>>>>>>        Property Integer piPrivateTextColor clNone
30549>>>>>>>        Property String  psPrivateText ''
30550>>>>>>>        Property String  psPrivateTooltip ''
30551>>>>>>>        Property Boolean pbPrivateVisible True
30552>>>>>>>        Property Integer piPrivateWidth 0
30553>>>>>>>        Property Integer pbPrivateStyleNoBorders False
30554>>>>>>>        Property Integer pbPrivateStyleDisabled False
30555>>>>>>>        Property Integer pbPrivateStyleStretch False
30556>>>>>>>        Property Integer  piPrivateIconId 0
30557>>>>>>>
30557>>>>>>>        Property String  psImage ''
30558>>>>>>>
30558>>>>>>>        Property Integer piId sbpIDAutoAssign
30559>>>>>>>        
30559>>>>>>>        Set peNeighborhood to nhNo
30560>>>>>>>    End_Procedure
30561>>>>>>>    
30561>>>>>>>    Procedure Set pbVisible Boolean bValue
30563>>>>>>>        Set pbPrivateVisible to bValue
30564>>>>>>>        If (IsComObjectCreated(Self)) Begin
30566>>>>>>>            Set ComVisible to bValue
30567>>>>>>>        End
30567>>>>>>>>
30567>>>>>>>    End_Procedure
30568>>>>>>>    
30568>>>>>>>    Function pbVisible Returns Boolean
30570>>>>>>>        Boolean bValue
30570>>>>>>>        If (IsComObjectCreated(Self)) Begin
30572>>>>>>>            Get ComVisible to bValue
30573>>>>>>>        End
30573>>>>>>>>
30573>>>>>>>        Else Begin
30574>>>>>>>            Get pbPrivateVisible to bValue
30575>>>>>>>        End
30575>>>>>>>>
30575>>>>>>>        Function_Return bValue
30576>>>>>>>    End_Function
30577>>>>>>>    
30577>>>>>>>    Procedure Set piBackgroundColor Integer iValue
30579>>>>>>>        Set piPrivateBackgroundColor to iValue
30580>>>>>>>        If (IsComObjectCreated(Self)) Begin
30582>>>>>>>            Set ComBackgroundColor to iValue
30583>>>>>>>        End
30583>>>>>>>>
30583>>>>>>>    End_Procedure
30584>>>>>>>    
30584>>>>>>>    Function piBackgroundColor Returns Integer
30586>>>>>>>        Integer iValue
30586>>>>>>>        If (IsComObjectCreated(Self)) Begin
30588>>>>>>>            Get ComBackgroundColor to iValue
30589>>>>>>>        End
30589>>>>>>>>
30589>>>>>>>        Else Begin
30590>>>>>>>            Get piPrivateBackgroundColor to iValue
30591>>>>>>>        End
30591>>>>>>>>
30591>>>>>>>        Function_Return iValue
30592>>>>>>>    End_Function
30593>>>>>>>
30593>>>>>>>    Procedure Set piTextColor Integer iValue
30595>>>>>>>        Set piPrivateTextColor to iValue
30596>>>>>>>        If (IsComObjectCreated(Self)) Begin
30598>>>>>>>            Set ComTextColor to iValue
30599>>>>>>>        End
30599>>>>>>>>
30599>>>>>>>    End_Procedure
30600>>>>>>>    
30600>>>>>>>    Function piTextColor Returns Integer
30602>>>>>>>        Integer iValue
30602>>>>>>>        If (IsComObjectCreated(Self)) Begin
30604>>>>>>>            Get ComTextColor to iValue
30605>>>>>>>        End
30605>>>>>>>>
30605>>>>>>>        Else Begin
30606>>>>>>>            Get piPrivateTextColor to iValue
30607>>>>>>>        End
30607>>>>>>>>
30607>>>>>>>        Function_Return iValue
30608>>>>>>>    End_Function
30609>>>>>>>    
30609>>>>>>>    Procedure Set piWidth Integer iValue
30611>>>>>>>        Set piPrivateWidth to iValue
30612>>>>>>>        If (IsComObjectCreated(Self)) Begin
30614>>>>>>>            Set ComWidth to iValue
30615>>>>>>>        End
30615>>>>>>>>
30615>>>>>>>    End_Procedure
30616>>>>>>>    
30616>>>>>>>    Function piWidth Returns Integer
30618>>>>>>>        Integer iValue
30618>>>>>>>        If (IsComObjectCreated(Self)) Begin
30620>>>>>>>            Get ComWidth to iValue
30621>>>>>>>        End
30621>>>>>>>>
30621>>>>>>>        Else Begin
30622>>>>>>>            Get piPrivateWidth to iValue
30623>>>>>>>        End
30623>>>>>>>>
30623>>>>>>>        Function_Return iValue
30624>>>>>>>    End_Function
30625>>>>>>>
30625>>>>>>>    Procedure Set peAlignment Integer eValue
30627>>>>>>>        Set pePrivateAlignment to eValue
30628>>>>>>>        If (IsComObjectCreated(Self)) Begin
30630>>>>>>>            Set ComAlignment to eValue
30631>>>>>>>        End
30631>>>>>>>>
30631>>>>>>>    End_Procedure
30632>>>>>>>    
30632>>>>>>>    Function peAlignment Returns Integer
30634>>>>>>>        Integer eValue
30634>>>>>>>        If (IsComObjectCreated(Self)) Begin
30636>>>>>>>            Get ComAlignment to eValue
30637>>>>>>>        End
30637>>>>>>>>
30637>>>>>>>        Else Begin
30638>>>>>>>            Get pePrivateAlignment to eValue
30639>>>>>>>        End
30639>>>>>>>>
30639>>>>>>>        Function_Return eValue
30640>>>>>>>    End_Function
30641>>>>>>>
30641>>>>>>>    Procedure SetPaneStyle Integer iMask Boolean bValue Handle hmMessage
30643>>>>>>>        Integer eValue
30643>>>>>>>        Set hmMessage to bValue
30644>>>>>>>        If (IsComObjectCreated(Self)) Begin
30646>>>>>>>            Set ComStyle to eValue
30647>>>>>>>            If (bValue) Begin
30649>>>>>>>                Move (AddBitValue(iMask,eValue)) to eValue
30650>>>>>>>            End
30650>>>>>>>>
30650>>>>>>>            Else Begin
30651>>>>>>>                Move (RemoveBitValue(iMask,eValue)) to eValue
30652>>>>>>>            End
30652>>>>>>>>
30652>>>>>>>            Set ComStyle to eValue
30653>>>>>>>        End
30653>>>>>>>>
30653>>>>>>>    End_Procedure
30654>>>>>>>    
30654>>>>>>>    Function GetPaneStyle Integer iMask Handle hmMessage Returns Boolean
30656>>>>>>>        Integer eValue
30656>>>>>>>        Boolean bValue
30656>>>>>>>        If (IsComObjectCreated(Self)) Begin
30658>>>>>>>            Get ComStyle to eValue
30659>>>>>>>            Move (eValue iand iMask) to bValue
30660>>>>>>>        End
30660>>>>>>>>
30660>>>>>>>        Else Begin
30661>>>>>>>            Get hmMessage to bValue
30662>>>>>>>        End
30662>>>>>>>>
30662>>>>>>>        Function_Return bValue
30663>>>>>>>    End_Function
30664>>>>>>>
30664>>>>>>>    Procedure Set pbStyleNoBorders Boolean bValue
30666>>>>>>>        Send SetPaneStyle SBPS_NOBORDERS bValue set_pbPrivateStyleNoBorders
30667>>>>>>>    End_Procedure
30668>>>>>>>    
30668>>>>>>>    Function pbStyleNoBorders Returns Boolean
30670>>>>>>>        Boolean bValue
30670>>>>>>>        Get GetPaneStyle SBPS_NOBORDERS get_pbPrivateStyleNoBorders to bValue
30671>>>>>>>        Function_Return bValue
30672>>>>>>>    End_Function
30673>>>>>>>
30673>>>>>>>    Procedure Set pbStyleDisabled Boolean bValue
30675>>>>>>>        Send SetPaneStyle SBPS_DISABLED bValue set_pbPrivateStyleDisabled
30676>>>>>>>    End_Procedure
30677>>>>>>>    
30677>>>>>>>    Function pbStyleDisabled Returns Boolean
30679>>>>>>>        Boolean bValue
30679>>>>>>>        Get GetPaneStyle SBPS_DISABLED get_pbPrivateStyleDisabled to bValue
30680>>>>>>>        Function_Return bValue
30681>>>>>>>    End_Function
30682>>>>>>>
30682>>>>>>>    Procedure Set pbStyleStretch Boolean bValue
30684>>>>>>>        Send SetPaneStyle SBPS_STRETCH bValue Set_pbPrivateStyleStretch
30685>>>>>>>    End_Procedure
30686>>>>>>>    
30686>>>>>>>    Function pbStyleStretch Returns Boolean
30688>>>>>>>        Boolean bValue
30688>>>>>>>        Get GetPaneStyle SBPS_STRETCH get_pbPrivateStyleStretch to bValue
30689>>>>>>>        Function_Return bValue
30690>>>>>>>    End_Function
30691>>>>>>>
30691>>>>>>>
30691>>>>>>>    Procedure Set psText String sValue
30693>>>>>>>        Set psPrivateText to sValue
30694>>>>>>>        If (IsComObjectCreated(Self)) Begin
30696>>>>>>>            Set ComText to sValue
30697>>>>>>>        End
30697>>>>>>>>
30697>>>>>>>    End_Procedure
30698>>>>>>>    
30698>>>>>>>    Function psText Returns String
30700>>>>>>>        String sValue
30700>>>>>>>        If (IsComObjectCreated(Self)) Begin
30702>>>>>>>            Get ComText to sValue
30703>>>>>>>        End
30703>>>>>>>>
30703>>>>>>>        Else Begin
30704>>>>>>>            Get psPrivateText to sValue
30705>>>>>>>        End
30705>>>>>>>>
30705>>>>>>>        Function_Return sValue
30706>>>>>>>    End_Function
30707>>>>>>>
30707>>>>>>>    Procedure Set psToolTip String sValue
30709>>>>>>>        Set psPrivateToolTip to sValue
30710>>>>>>>        If (IsComObjectCreated(Self)) Begin
30712>>>>>>>            Set ComToolTip to sValue
30713>>>>>>>        End
30713>>>>>>>>
30713>>>>>>>    End_Procedure
30714>>>>>>>    
30714>>>>>>>    Function psToolTip Returns String
30716>>>>>>>        String sValue
30716>>>>>>>        If (IsComObjectCreated(Self)) Begin
30718>>>>>>>            Get ComToolTip to sValue
30719>>>>>>>        End
30719>>>>>>>>
30719>>>>>>>        Else Begin
30720>>>>>>>            Get psPrivateToolTip to sValue
30721>>>>>>>        End
30721>>>>>>>>
30721>>>>>>>        Function_Return sValue
30722>>>>>>>    End_Function
30723>>>>>>>
30723>>>>>>>     // normally this is zero and not changed. When zero the imageId used will be
30723>>>>>>>     // the statusbarId and this is the ID that is used when the psImage method is used.
30723>>>>>>>     // Using psImage is preferred as it adds the icon and assigns it to the object.
30723>>>>>>>     // This can be used to change icons. Note 0=use StatusbarId
30723>>>>>>>    Procedure Set piIconId Integer iValue
30725>>>>>>>        Set piPrivateIconId to iValue
30726>>>>>>>        If (IsComObjectCreated(Self)) Begin
30728>>>>>>>            Set ComIconIndex to iValue
30729>>>>>>>        End
30729>>>>>>>>
30729>>>>>>>    End_Procedure
30730>>>>>>>    
30730>>>>>>>    Function piIconId Returns Integer
30732>>>>>>>        Integer iValue
30732>>>>>>>        If (IsComObjectCreated(Self)) Begin
30734>>>>>>>            Get ComIconIndex to iValue
30735>>>>>>>        End
30735>>>>>>>>
30735>>>>>>>        Else Begin
30736>>>>>>>            Get piPrivateIconId to iValue
30737>>>>>>>        End
30737>>>>>>>>
30737>>>>>>>        Function_Return iValue
30738>>>>>>>    End_Function
30739>>>>>>>
30739>>>>>>>    Procedure CreateComInstance Handle hoStatusBar
30741>>>>>>>        Variant vStatusBarPane
30741>>>>>>>        String sImage sText sToolTip
30741>>>>>>>        Integer iWidth eAlignment eStyle iBackGroundColor iTextColor iId iIconId iNewIconid
30741>>>>>>>        Boolean  bVisible bOk bStyleStretch bStyleDisabled bStyleNoBorders
30741>>>>>>>        Handle hoCommandBars
30741>>>>>>>        
30741>>>>>>>        Get CommandBarSystemObject to hoCommandBars
30742>>>>>>>        
30742>>>>>>>        Get pePrivateAlignment to eAlignment
30743>>>>>>>        Get pbPrivateVisible to bVisible
30744>>>>>>>        Get psPrivateText to sText
30745>>>>>>>        Get psPrivateTooltip to sToolTip
30746>>>>>>>        Get piPrivateBackGroundColor to iBackGroundColor
30747>>>>>>>        Get piPrivateTextColor to iTextColor
30748>>>>>>>        Get psImage to sImage
30749>>>>>>>        Get piPrivateWidth to iWidth
30750>>>>>>>        Get pbPrivateStyleStretch to bStyleStretch
30751>>>>>>>        Get pbPrivateStyleNoBorders to bStyleNoBorders
30752>>>>>>>        Get pbPrivateStyleDisabled to bStyleDisabled
30753>>>>>>>        Get piPrivateIconId to iIconId
30754>>>>>>>
30754>>>>>>>        Get piId to iId
30755>>>>>>>        
30755>>>>>>>        // this check is added because a duplicate ID throws an exception error
30755>>>>>>>        Get ComFindPane of hoStatusBar iId to vStatusBarPane
30756>>>>>>>        If (not(IsNullComObject(vStatusBarPane))) Begin
30758>>>>>>>            Error DFERR_PROGRAM ("Cannot add status pane. Duplicate Id (" - String(iId) - ")")
30759>>>>>>>>
30759>>>>>>>            Procedure_Return
30760>>>>>>>        End
30760>>>>>>>>
30760>>>>>>>        
30760>>>>>>>        Get ComAddPane of hoStatusBar iId to vStatusBarPane
30761>>>>>>>        Set pvComObject to vStatusBarPane
30762>>>>>>>        Set ComAlignment to eAlignment
30763>>>>>>>        If (sText<>"") Begin
30765>>>>>>>            Set ComText to sText
30766>>>>>>>        End
30766>>>>>>>>
30766>>>>>>>        Set ComToolTip to sToolTip
30767>>>>>>>        If (iBackGroundColor<>clNone) Begin
30769>>>>>>>            Set ComBackgroundColor to iBackGroundColor
30770>>>>>>>        End
30770>>>>>>>>
30770>>>>>>>        If (iTextColor<>clNone) Begin
30772>>>>>>>            Set ComTextColor to iTextColor
30773>>>>>>>        End
30773>>>>>>>>
30773>>>>>>>
30773>>>>>>>        Move (If(bStyleDisabled,SBPS_DISABLED,0) + ;              If(bStyleNoBorders,SBPS_NOBORDERS,0) + ;              If(bStyleStretch,SBPS_STRETCH,0)) to eStyle
30774>>>>>>>        Set ComStyle to eStyle
30775>>>>>>>
30775>>>>>>>        If (sImage<>"") Begin
30777>>>>>>>            Get AddImage of hoCommandBars sImage iId xtpImageNormal to iNewIconid
30778>>>>>>>            Set ComIconIndex to iId
30779>>>>>>>        End
30779>>>>>>>>
30779>>>>>>>        If (iIconId<>0) Begin
30781>>>>>>>            Set ComIconIndex to iIconId
30782>>>>>>>        End
30782>>>>>>>>
30782>>>>>>>        
30782>>>>>>>        Set ComVisible to bVisible
30783>>>>>>>        Set ComWidth to iWidth
30784>>>>>>>            
30784>>>>>>>        Send OnCreate
30785>>>>>>>        
30785>>>>>>>    End_Procedure
30786>>>>>>>    
30786>>>>>>>    Procedure RegisterStatusPaneObject Handle[] ByRef hoPanes
30788>>>>>>>        Move Self to hoPanes[SizeOfArray(hoPanes)]
30789>>>>>>>    End_Procedure
30790>>>>>>>
30790>>>>>>>    // auto assign an Id for the status bar. Called in end_construct_object if needed
30790>>>>>>>    Function AssignStatusBarID Returns Integer
30792>>>>>>>        Integer iId
30792>>>>>>>        Get piStatusBarId  to iId
30793>>>>>>>        Set piStatusBarId to (iId + 1)
30794>>>>>>>        Function_Return iId
30795>>>>>>>    End_Function
30796>>>>>>>
30796>>>>>>>    Procedure OnCreate
30798>>>>>>>    End_Procedure
30799>>>>>>>    
30799>>>>>>>    Procedure OnClick
30801>>>>>>>    End_Procedure
30802>>>>>>>        
30802>>>>>>>    Procedure OnDblClick
30804>>>>>>>    End_Procedure
30805>>>>>>>
30805>>>>>>>    Procedure End_Construct_Object
30807>>>>>>>        Integer iID
30807>>>>>>>        Get piId to iID
30808>>>>>>>        If (iID=sbpIDAutoAssign) Begin
30810>>>>>>>            Get AssignStatusBarID to iID
30811>>>>>>>            Set piId to iID
30812>>>>>>>        End
30812>>>>>>>>
30812>>>>>>>        Forward Send End_Construct_Object
30814>>>>>>>    End_Procedure
30815>>>>>>>
30815>>>>>>>End_Class
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>>>
30816>>>>>Use LanguageText.pkg
30816>>>>>
30816>>>>>
30816>>>>>Class cCJUndoMenuItem is a cCJMenuItem
30817>>>>>    
30817>>>>>    Procedure Construct_Object
30819>>>>>        Forward Send Construct_Object
30821>>>>>        Set psCaption   to C_$CaptionUndo
30822>>>>>        Set psToolTip to C_$ToolTipUndo
30823>>>>>        Set psDescription to C_$DescUndo
30824>>>>>        Set psImage to "ActionUndo.ico"
30825>>>>>        Set pbActiveUpdate to True
30826>>>>>        Set psCategory to C_$CategoryEdit
30827>>>>>        Set psShortcut to C_$Key_Ctrl_Z
30828>>>>>    End_Procedure
30829>>>>>
30829>>>>>    Procedure OnExecute Variant vCommandBarControl
30831>>>>>        Send Undo of (focus(Self))
30832>>>>>    End_Procedure
30833>>>>>    
30833>>>>>    Function IsEnabled Returns Boolean
30835>>>>>        Boolean bEnabled
30835>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
30836>>>>>        Function_Return bEnabled
30837>>>>>    End_Function
30838>>>>>         
30838>>>>>End_Class
30839>>>>>
30839>>>>>
30839>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
30840>>>>>    
30840>>>>>    Procedure Construct_Object
30842>>>>>        Forward Send Construct_Object
30844>>>>>        Set psCaption   to C_$CaptionDelete
30845>>>>>        Set psToolTip to C_$ToolTipDelete
30846>>>>>        Set psDescription to C_$DescDelete
30847>>>>>        Set psImage to "actionDelete.ico"
30848>>>>>        Set psShortcut to C_$Key_Delete
30849>>>>>        Set pbActiveUpdate to True
30850>>>>>        Set psCategory to C_$CategoryEdit
30851>>>>>    End_Procedure
30852>>>>>
30852>>>>>
30852>>>>>    Procedure OnExecute Variant vCommandBarControl
30854>>>>>        Send Delete of (focus(Self))
30855>>>>>    End_Procedure
30856>>>>>    
30856>>>>>    Function IsEnabled Returns Boolean
30858>>>>>        Boolean bEnabled
30858>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
30859>>>>>        Function_Return bEnabled
30860>>>>>    End_Function
30861>>>>>         
30861>>>>>End_Class
30862>>>>>
30862>>>>>
30862>>>>>Class cCJCutMenuItem is a cCJMenuItem
30863>>>>>    
30863>>>>>    Procedure Construct_Object
30865>>>>>        Forward Send Construct_Object
30867>>>>>        Set psCaption   to C_$CaptionCut
30868>>>>>        Set psToolTip to C_$TooltipCut
30869>>>>>        Set psDescription to C_$DescCut
30870>>>>>        Set psImage to "actionCut.ico"
30871>>>>>        Set psShortcut to C_$Key_Ctrl_X
30872>>>>>        Set pbActiveUpdate to True
30873>>>>>        Set psCategory to C_$CategoryEdit
30874>>>>>    End_Procedure
30875>>>>>
30875>>>>>
30875>>>>>    Procedure OnExecute Variant vCommandBarControl
30877>>>>>        Send Cut of (focus(Self))
30878>>>>>    End_Procedure
30879>>>>>    
30879>>>>>    Function IsEnabled Returns Boolean
30881>>>>>        Boolean bEnabled
30881>>>>>        Get CanCut of (Focus(Self)) to bEnabled
30882>>>>>        Function_Return bEnabled
30883>>>>>    End_Function
30884>>>>>         
30884>>>>>End_Class
30885>>>>>
30885>>>>>
30885>>>>>Class cCJCopyMenuItem is a cCJMenuItem
30886>>>>>    
30886>>>>>    Procedure Construct_Object
30888>>>>>        Forward Send Construct_Object
30890>>>>>        Set psCaption   to C_$CaptionCopy
30891>>>>>        Set psToolTip to C_$ToolTipCopy
30892>>>>>        Set psDescription to C_$DescCopy
30893>>>>>        Set psImage to "actionCopy.ico"
30894>>>>>        Set psShortcut to C_$Key_Ctrl_C
30895>>>>>        Set pbActiveUpdate to True
30896>>>>>        Set psCategory to C_$CategoryEdit
30897>>>>>    End_Procedure
30898>>>>>
30898>>>>>
30898>>>>>    Procedure OnExecute Variant vCommandBarControl
30900>>>>>        Send Copy of (focus(Self))
30901>>>>>    End_Procedure
30902>>>>>    
30902>>>>>    Function IsEnabled Returns Boolean
30904>>>>>        Boolean bEnabled
30904>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
30905>>>>>        Function_Return bEnabled
30906>>>>>    End_Function
30907>>>>>         
30907>>>>>End_Class
30908>>>>>
30908>>>>>
30908>>>>>Class cCJPasteMenuItem is a cCJMenuItem
30909>>>>>    
30909>>>>>    Procedure Construct_Object
30911>>>>>        Forward Send Construct_Object
30913>>>>>        Set psCaption   to C_$CaptionPaste
30914>>>>>        Set psToolTip to C_$ToolTipPaste
30915>>>>>        Set psDescription to C_$DescPaste
30916>>>>>        Set psImage to "actionPaste.ico"
30917>>>>>        Set pbActiveUpdate to True
30918>>>>>        Set psShortcut to C_$Key_Ctrl_V
30919>>>>>        Set psCategory to C_$CategoryEdit
30920>>>>>    End_Procedure
30921>>>>>
30921>>>>>
30921>>>>>    Procedure OnExecute Variant vCommandBarControl
30923>>>>>        Send Paste of (focus(Self))
30924>>>>>    End_Procedure
30925>>>>>    
30925>>>>>    Function IsEnabled Returns Boolean
30927>>>>>        Boolean bEnabled
30927>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
30928>>>>>        Function_Return bEnabled
30929>>>>>    End_Function
30930>>>>>         
30930>>>>>End_Class
30931>>>>>
30931>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
30932>>>>>    
30932>>>>>    Procedure Construct_Object
30934>>>>>        Forward Send Construct_Object
30936>>>>>        Set psCaption   to C_$CaptionSelectAll
30937>>>>>        Set psToolTip to C_$ToolTipSelectAll
30938>>>>>        Set psDescription to C_$DescSelectAll
30939>>>>>        Set pbActiveUpdate to True
30940>>>>>        Set psShortcut to C_$Key_Ctrl_A
30941>>>>>        Set psCategory to C_$CategoryEdit
30942>>>>>    End_Procedure
30943>>>>>
30943>>>>>
30943>>>>>    Procedure OnExecute Variant vCommandBarControl
30945>>>>>        Send Select_All of (focus(Self))
30946>>>>>    End_Procedure
30947>>>>>    
30947>>>>>    Function IsEnabled Returns Boolean
30949>>>>>        Boolean bEnabled
30949>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
30950>>>>>        Function_Return bEnabled
30951>>>>>    End_Function
30952>>>>>         
30952>>>>>End_Class
30953>>>>>
30953>>>>> 
30953>>>>>Class cCJExitMenuItem is a cCJMenuItem
30954>>>>>
30954>>>>>    Procedure Construct_Object
30956>>>>>        Forward Send Construct_Object
30958>>>>>        Set psCaption to C_$CaptionExit
30959>>>>>        Set psToolTip to C_$ToolTipExit
30960>>>>>        Set psDescription to C_$ToolTipExit
30961>>>>>        Set psShortcut to C_$Key_Alt_F4
30962>>>>>        Set psCategory to C_$CategoryFile
30963>>>>>    End_Procedure
30964>>>>>
30964>>>>>    Procedure OnExecute Variant vCommandBarControl
30966>>>>>        Send Exit_Application of Desktop
30967>>>>>    End_Procedure
30968>>>>>
30968>>>>>End_Class           
30969>>>>>
30969>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
30970>>>>>
30970>>>>>    Procedure Construct_Object
30972>>>>>        Forward Send Construct_Object
30974>>>>>        Set psCaption to C_$CaptionHelp
30975>>>>>        Set psDescription to C_$ToolTipHelp
30976>>>>>        Set psToolTip to C_$DescHelp
30977>>>>>        Set psImage to "ActionHelp.ico"
30978>>>>>        Set psShortcut to "F1"
30979>>>>>        Set psCategory to C_$CategoryHelp
30980>>>>>    End_Procedure
30981>>>>>    
30981>>>>>    Procedure OnExecute Variant vCommandBarControl
30983>>>>>        Send Help of (Focus(Self))
30984>>>>>    End_Procedure
30985>>>>>
30985>>>>>End_Class
30986>>>>>
30986>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
30987>>>>>
30987>>>>>    Procedure Construct_Object
30989>>>>>        Forward Send Construct_Object
30991>>>>>        Set psCaption to C_$CaptionAddStatusbar
30992>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
30993>>>>>        Set psDescription to  C_$DescAddStatusbar
30994>>>>>        Set psCategory to C_$CategoryWindow
30995>>>>>    End_Procedure
30996>>>>>
30996>>>>>    Procedure OnExecute Variant vCommandBarControl
30998>>>>>        Handle hoCommandBars hoClientArea
30998>>>>>        Get CommandBarSystemObject to hoCommandBars
30999>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31000>>>>>        If hoClientArea Begin
31002>>>>>            // the clientarea's parent panel has message
31002>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
31003>>>>>        End
31003>>>>>>
31003>>>>>    End_Procedure
31004>>>>>
31004>>>>>     Function IsChecked Returns Boolean
31006>>>>>        Boolean bOn
31006>>>>>        Handle hoCommandBars hoClientArea
31006>>>>>        Get CommandBarSystemObject to hoCommandBars
31007>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31008>>>>>        If hoClientArea Begin
31010>>>>>            // the clientarea's parent panel has message
31010>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
31011>>>>>        End
31011>>>>>>
31011>>>>>        Function_Return bOn
31012>>>>>     End_Function
31013>>>>>End_Class
31014>>>>>
31014>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
31015>>>>>
31015>>>>>    Procedure Construct_Object
31017>>>>>        Forward Send Construct_Object
31019>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
31020>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
31021>>>>>        Set psDescription to C_$DescAutoArrangeIcons
31022>>>>>        Set psCategory to C_$CategoryWindow
31023>>>>>    End_Procedure
31024>>>>>
31024>>>>>    Procedure OnExecute Variant vCommandBarControl
31026>>>>>        Handle hoCommandBars hoClientArea
31026>>>>>        Get CommandBarSystemObject to hoCommandBars
31027>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31028>>>>>        If hoClientArea Begin
31030>>>>>            // the clientarea's parent panel has message
31030>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
31031>>>>>        End
31031>>>>>>
31031>>>>>    End_Procedure
31032>>>>>    
31032>>>>>     Function IsChecked Returns Boolean
31034>>>>>        Boolean bOn
31034>>>>>        Handle hoCommandBars hoClientArea
31034>>>>>        Get CommandBarSystemObject to hoCommandBars
31035>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31036>>>>>        If hoClientArea Begin
31038>>>>>            // the clientarea's parent panel has message
31038>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
31039>>>>>        End
31039>>>>>>
31039>>>>>        Function_Return bOn
31040>>>>>     End_Function
31041>>>>>End_Class
31042>>>>>
31042>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
31043>>>>>
31043>>>>>    Procedure Construct_Object
31045>>>>>        Forward Send Construct_Object
31047>>>>>        Set psCaption to C_$CaptionRestoreMenus
31048>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
31049>>>>>        Set psDescription to C_$DescRestoreMenus
31050>>>>>        Set psCategory to C_$CategoryWindow
31051>>>>>    End_Procedure
31052>>>>>
31052>>>>>    Procedure OnExecute Variant vCommandBarControl
31054>>>>>        Handle hoCommandBars
31054>>>>>        Get CommandBarSystemObject to hoCommandBars
31055>>>>>        Send RestoreLayout of hoCommandBars
31056>>>>>    End_Procedure
31057>>>>>    
31057>>>>>End_Class
31058>>>>>
31058>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
31059>>>>>
31059>>>>>    Procedure Construct_Object
31061>>>>>        Forward Send Construct_Object
31063>>>>>        Set psCaption to C_$CaptionCascade
31064>>>>>        Set psToolTip to C_$ToolTipCascade
31065>>>>>        Set psDescription to  C_$DescCascade
31066>>>>>        Set psImage to "ActionCascade.ico"
31067>>>>>        Set psCategory to C_$CategoryWindow
31068>>>>>    End_Procedure
31069>>>>>    
31069>>>>>    Procedure OnExecute Variant vCommandBarControl
31071>>>>>        Handle hoCommandBars hoClientArea
31071>>>>>        Get CommandBarSystemObject to hoCommandBars
31072>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31073>>>>>        If hoClientArea Begin
31075>>>>>            Send Cascade_Windows of hoClientArea
31076>>>>>        End
31076>>>>>>
31076>>>>>    End_Procedure
31077>>>>>End_Class
31078>>>>>
31078>>>>>Class cCJTileHorizontally is a cCJMenuItem
31079>>>>>
31079>>>>>    Procedure Construct_Object
31081>>>>>        Forward Send Construct_Object
31083>>>>>        Set psCaption to C_$CaptionTileHorizontally 
31084>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
31085>>>>>        Set psDescription to  C_$DescTileHorizontally
31086>>>>>        Set psImage to "ActionTileHorizontally.ico"
31087>>>>>        Set psCategory to C_$CategoryWindow
31088>>>>>    End_Procedure
31089>>>>>
31089>>>>>    Procedure OnExecute Variant vCommandBarControl
31091>>>>>        Handle hoCommandBars hoClientArea
31091>>>>>        Get CommandBarSystemObject to hoCommandBars
31092>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31093>>>>>        If hoClientArea Begin
31095>>>>>            Send Tile_Windows_Horizontal of hoClientArea
31096>>>>>        End
31096>>>>>>
31096>>>>>    End_Procedure
31097>>>>>End_Class
31098>>>>>
31098>>>>>Class cCJTileVertically is a cCJMenuItem
31099>>>>>
31099>>>>>    Procedure Construct_Object
31101>>>>>        Forward Send Construct_Object
31103>>>>>        Set psCaption to C_$CaptionTileVertically  
31104>>>>>        Set psToolTip to C_$ToolTipTileVertically
31105>>>>>        Set psDescription to  C_$DescTileVertically
31106>>>>>        Set psImage to "ActionTileVertically.ico"
31107>>>>>        Set psCategory to C_$CategoryWindow
31108>>>>>    End_Procedure
31109>>>>>
31109>>>>>    Procedure OnExecute Variant vCommandBarControl
31111>>>>>        Handle hoCommandBars hoClientArea
31111>>>>>        Get CommandBarSystemObject to hoCommandBars
31112>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31113>>>>>        If hoClientArea Begin
31115>>>>>            Send Tile_Windows_Vertical of hoClientArea
31116>>>>>        End
31116>>>>>>
31116>>>>>    End_Procedure
31117>>>>>End_Class
31118>>>>>
31118>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
31119>>>>>
31119>>>>>    Procedure Construct_Object
31121>>>>>        Forward Send Construct_Object
31123>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
31124>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
31125>>>>>        Set psDescription to  C_$DescMinimizeWindows
31126>>>>>        Set psCategory to C_$CategoryWindow
31127>>>>>    End_Procedure
31128>>>>>
31128>>>>>    Procedure OnExecute Variant vCommandBarControl
31130>>>>>        Handle hoCommandBars hoClientArea
31130>>>>>        Get CommandBarSystemObject to hoCommandBars
31131>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31132>>>>>        If hoClientArea Begin
31134>>>>>            // the clientarea's parent panel has message
31134>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
31135>>>>>        End
31135>>>>>>
31135>>>>>    End_Procedure
31136>>>>>End_Class
31137>>>>>
31137>>>>>
31137>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
31138>>>>>
31138>>>>>    Procedure Construct_Object
31140>>>>>        Forward Send Construct_Object
31142>>>>>        Set psCaption to C_$CaptionRestoreWindows
31143>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
31144>>>>>        Set psDescription to  C_$DescRestoreWindows
31145>>>>>        Set psCategory to C_$CategoryWindow
31146>>>>>    End_Procedure
31147>>>>>
31147>>>>>    Procedure OnExecute Variant vCommandBarControl
31149>>>>>        Handle hoCommandBars hoClientArea
31149>>>>>        Get CommandBarSystemObject to hoCommandBars
31150>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31151>>>>>        If hoClientArea Begin
31153>>>>>            // the clientarea's parent panel has message
31153>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
31154>>>>>        End
31154>>>>>>
31154>>>>>    End_Procedure
31155>>>>>End_Class
31156>>>>>
31156>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
31157>>>>>
31157>>>>>    Procedure Construct_Object
31159>>>>>        Forward Send Construct_Object
31161>>>>>        Set psCaption to C_$CaptionArrangeIcons  
31162>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
31163>>>>>        Set psDescription to  C_$DescArrangeIcons
31164>>>>>        Set psCategory to C_$CategoryWindow
31165>>>>>    End_Procedure
31166>>>>>
31166>>>>>    Procedure OnExecute Variant vCommandBarControl
31168>>>>>        Handle hoCommandBars hoClientArea
31168>>>>>        Get CommandBarSystemObject to hoCommandBars
31169>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
31170>>>>>        If hoClientArea Begin
31172>>>>>            Send Arrange_Icons of hoClientArea
31173>>>>>        End
31173>>>>>>
31173>>>>>    End_Procedure
31174>>>>>
31174>>>>>End_Class
31175>>>>>    
31175>>>
31175>>>Object oEditContextMenu is a cCJContextMenu
31177>>>    
31177>>>    Move Self to Default_Form_Floating_Menu_ID
31178>>>    
31178>>>    Object oUndoMenuItem is a cCJUndoMenuItem
31180>>>    End_Object
31181>>>    
31181>>>    Object oCutMenuItem is a cCJCutMenuItem
31183>>>        Set pbControlBeginGroup to True
31184>>>    End_Object
31185>>>    
31185>>>    Object oCopyMenuItem is a cCJCopyMenuItem
31187>>>    End_Object
31188>>>
31188>>>    Object oPasteMenuItem is a cCJPasteMenuItem
31190>>>    End_Object
31191>>>
31191>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
31193>>>    End_Object
31194>>>
31194>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
31196>>>        Set pbControlBeginGroup to True
31197>>>    End_Object
31198>>>
31198>>>End_Object
31199>>>
31199>Use cDbUpdateFunctionLibrary.pkg
Including file: cDbUpdateFunctionLibrary.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cDbUpdateFunctionLibrary.pkg)
31199>>>//****************************************************************************
31199>>>// $Module type: Class
31199>>>// $Module name: cDbUpdateFunctionLibrary
31199>>>// $Author     : Nils G. Svedmyr, RDC Tools International, <mailto:support@rdctools.com>
31199>>>// Web-site    : http://www.rdctools.com
31199>>>// Created     : 2014-09-05 @ 09:50 (Military date format: YY-MM-DD)
31199>>>//
31199>>>// Description : The class consists of a function library for database manipulations, aka make changes to a database.
31199>>>//               It has top level functions that uses the DataFlex db API, _but_ also specialized
31199>>>//               functions to make db changes to Sql databases with the DAW & Mertech drivers,
31199>>>//               with the help of Sql-scripts.
31199>>>//
31199>>>// $Rev History:
31199>>>//    2014-09-05  Module header created
31199>>>//
31199>>>//****************************************************************************
31199>>>Use cApplication.pkg
31199>>>Use seq_chnl.pkg
31199>>>Use GlobalFunctionsProcedures.pkg
31199>>>Use Datadict.pkg                        // Declaration of DF_FILE_SQL_TABLE_NAME
Including file: Datadict.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Datadict.pkg)
31199>>>>>//************************************************************************
31199>>>>>// Confidential Trade Secret.
31199>>>>>// Copyright (c) 1997-2016 Data Access Corporation, Miami Florida
31199>>>>>// as an unpublished work.  All rights reserved.
31199>>>>>// DataFlex is a registered trademark of Data Access Corporation.
31199>>>>>//
31199>>>>>//************************************************************************
31199>>>>>
31199>>>>>Register_Procedure File_Field_Value_Changed
31199>>>>>Register_Procedure File_Field_Mask_Changed
31199>>>>>Register_Procedure File_Field_Label_Changed
31199>>>>>Register_Procedure File_Field_Option_Changed
31199>>>>>Register_Function  Extended_DEO_State returns Integer
31199>>>>>Register_Function  Entry_Refresh_State Returns integer
31199>>>>>//Register_Function  Item_NoPut integer iItem Returns integer
31199>>>>>Register_Procedure set Entry_Refresh_State integer iState
31199>>>>>Register_Function  Allow_Foreign_New_Save_State returns integer
31199>>>>>Register_Function  Server returns integer
31199>>>>>
31199>>>>>use VDFBase.pkg
31199>>>>>Use LanguageText.pkg // language support VDF pkg replacement strings
31199>>>>>
31199>>>>>Define Support$extended$fields
31199>>>>>
31199>>>>>Use Data_Set.pkg
Including file: Data_set.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Data_set.pkg)
31199>>>>>>>//************************************************************************
31199>>>>>>>//
31199>>>>>>>// Confidential Trade Secret.
31199>>>>>>>// Copyright 1987-1997 Data Access Corporation, Miami FL, USA
31199>>>>>>>// All Rights reserved
31199>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
31199>>>>>>>//
31199>>>>>>>//************************************************************************/
31199>>>>>>>
31199>>>>>>>//************************************************************************
31199>>>>>>>//     File Name: Data_Set.Pkg
31199>>>>>>>// Creation Date: January 1, 1991
31199>>>>>>>// Modified Date: April 21, 1992
31199>>>>>>>//     Author(s): Steven A. Lowe
31199>>>>>>>//
31199>>>>>>>// This module contains the Data_Set class definition.
31199>>>>>>>//************************************************************************/
31199>>>>>>>// 4/21/99   JJT Added OnConstrain support
31199>>>>>>>// 11/26/97  JJT Moved data_set_should_save into class from dfclient.pkg
31199>>>>>>>// 04/11/97  JJT Added Refind_DD_Records which is just like Refind_records
31199>>>>>>>//              except it only operates on in_use DDs. Otherwise, non
31199>>>>>>>//              connected not-in-use DDs clear the buffer (very bad for
31199>>>>>>>//              sysfiles).
31199>>>>>>>// 11/05/96 JJT Added Set DDO_Server Message (same as Attach_Server)
31199>>>>>>>// 08/29/96 JJT Item_Find Fix, where send attach_main_File sent to server
31199>>>>>>>// 07/23/96 JJT Renamed to DataSet (Maintain Data_Set as well)
31199>>>>>>>//************************************************************************/
31199>>>>>>>// 2/26/2002  JJT - 8.2 clean up (indirect_file, local, self, etc.)
31199>>>>>>>
31199>>>>>>>
31199>>>>>>>use VDFBase.pkg
31199>>>>>>>use fndmodes.pkg
Including file: fndmodes.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\fndmodes.pkg)
31199>>>>>>>>>//
31199>>>>>>>>>// special find modes
31199>>>>>>>>>//
31199>>>>>>>>>define NEXT_RECORD  for 5 //* find-next   *//
31199>>>>>>>>>define FIRST_RECORD for 6 //* find-first  *//
31199>>>>>>>>>define LAST_RECORD  for 7 //* find-last   *//
31199>>>>>>>use refmodes.pkg
Including file: refmodes.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\refmodes.pkg)
31199>>>>>>>>>//
31199>>>>>>>>>// constants for REFRESH message parameter values
31199>>>>>>>>>//
31199>>>>>>>>>define MODE_CLEAR             for 1  //notification from origin of clear
31199>>>>>>>>>define MODE_FIND_OR_CLEAR_SET for 2  //notification from find or clear
31199>>>>>>>>>define MODE_CLEAR_ALL         for 3  //notification from clear-all
31199>>>>>>>>>define MODE_DELETE            for 4  //notification after successful delete
31199>>>>>>>>>define MODE_SAVE              for 5  //notification after successful save
31199>>>>>>>>>
31199>>>>>>>//use enclient.pkg
31199>>>>>>>
31199>>>>>>>
31199>>>>>>>// removed in 14.1 (These were never used)
31199>>>>>>>// Define defaults (If not previously defined)
31199>>>>>>>//define DEFAULT$SMART$FILEMODE$STATE for FALSE
31199>>>>>>>//define DEFAULT$CASCADE$DELETE$STATE for TRUE
31199>>>>>>>
31199>>>>>>>//
31199>>>>>>>//Global integer status values
31199>>>>>>>//
31199>>>>>>>define OPERATION_MODE   for |VI99  //status of data-sets in application
31199>>>>>>>define OPERATION_ORIGIN for |VI108 //origin of current of data-set operation
31199>>>>>>>
31199>>>>>>>//
31199>>>>>>>//Constants for Operation_Mode global int values
31199>>>>>>>//
31199>>>>>>>define MODE_WAITING  for 0  //wait-mode
31199>>>>>>>define MODE_FINDING  for 1  //find-mode
31199>>>>>>>define MODE_CLEARING for 2  //clear-mode
31199>>>>>>>define MODE_CREATING for 3  //create-mode
31199>>>>>>>define MODE_SAVING   for 4  //save-mode
31199>>>>>>>define MODE_DELETING for 5  //delete-mode
31199>>>>>>>define MODE_ABORTING for 6  //abort-mode
31199>>>>>>>define MODE_VALIDATING for 7  //request_validate-mode : added for VDF7
31199>>>>>>>define MODE_CLEARINGALL for 8 //clear-all mode (added in VDF8)
31199>>>>>>>
31199>>>>>>>//
31199>>>>>>>// Description
31199>>>>>>>//
31199>>>>>>>//   The Data_Set class is implemented as a subclass of Entry_Client, with
31199>>>>>>>//   a C language handler providing the majority of new behavior.  The
31199>>>>>>>//   Data_Set class is intended to be a grouping agent for data-entry objects
31199>>>>>>>//   and a container for subordinate Data_Sets.
31199>>>>>>>//
31199>>>>>>>// Assumptions/Preconditions
31199>>>>>>>//
31199>>>>>>>//   None.
31199>>>>>>>//
31199>>>>>>>// Exceptions
31199>>>>>>>//
31199>>>>>>>//   None.
31199>>>>>>>//
31199>>>>>>>// Notes
31199>>>>>>>//
31199>>>>>>>//  Syntax:
31199>>>>>>>//
31199>>>>>>>//  Object <name> is a DataSet <image> {ACTION_BAR <ActionBar>} {POP_UP}
31199>>>>>>>//      {RING} {MAIN_FILE <Main_File> {BY <Index>} }
31199>>>>>>>//      {UPDATING <File> | <DataSetID> ... } }
31199>>>>>>>//   :
31199>>>>>>>//  End_Object
31199>>>>>>>//
31199>>>>>>>//  Data_Sets may be used to group DEOs as well as other Data_Sets.
31199>>>>>>>//  Note also that a nested (component) Data_Set automatically enforces an
31199>>>>>>>//  UPDATES visibility and a RELATES TO constraint between its main_file and
31199>>>>>>>//  its parent's main_file.
31199>>>>>>>//
31199>>>>>>>
31199>>>>>>>// _Data_Set class deinition, private class layer. (Extra class layer needed
31199>>>>>>>// to augment procedures defined in C class handler.)
31199>>>>>>>//
31199>>>>>>>// _Data_Set class deinition, private class layer. (Extra class layer needed
31199>>>>>>>// to augment procedures defined in C class handler.)
31199>>>>>>>//
31199>>>>>>>//Class _Data_Set is an Entry_Client ;  //_Data_Set inherits from Entry_Client
31199>>>>>>>//    STARTMAC dsStart ;                //dsStart macro is used to handle syntax
31199>>>>>>>//    0 0 ;                             //default colors
31199>>>>>>>//    Data_Set_Handler                  //C-function for base class behavior
31199>>>>>>>
31199>>>>>>>//  !A [] $461 U__DATA_SET              //register C messages
31199>>>>>>>
31199>>>>>>>//#IFDEF IS$WINDOWS
31199>>>>>>>Use BaseData_Set.pkg
31199>>>>>>>
31199>>>>>>>// Data_Set class definition, public class layer. (Extra class layer needed
31199>>>>>>>// to augment C-based (Constrain) procedure(s).)
31199>>>>>>>
31199>>>>>>>Class DataSet is a BaseData_Set
31200>>>>>>>
31200>>>>>>>
31200>>>>>>>   // maintain old name for the time being to maximize compatability
31200>>>>>>>   // between character mode and windows versions. Developers should be
31200>>>>>>>   // able to move DS classes back and forth without changes.
31200>>>>>>>   Replace_Class_Name Data_Set DataSet
31200>>>>>>>
31200>>>>>>>   Procedure Construct_Object //Integer Img#
31202>>>>>>>     Forward Send Construct_Object No_Image //Img#
31204>>>>>>>
31204>>>>>>>     Property Integer Constrain_File 0
31205>>>>>>>     Property Integer Auto_Fill_State False
31206>>>>>>>     Property Integer Change_Disabled_State  False
31207>>>>>>>     // RT sets this inside of Mark_components a part of old entry_client DSO behavior. Now it is never used
31207>>>>>>>     Property Integer Component_State False
31208>>>>>>>
31208>>>>>>>     // just use RT default of False & True
31208>>>>>>>     //Set Smart_Filemode_State to DEFAULT$SMART$FILEMODE$STATE
31208>>>>>>>     //Set Cascade_Delete_State to DEFAULT$CASCADE$DELETE$STATE
31208>>>>>>>     // Set Focus_Mode to NO_ACTIVATE
31208>>>>>>>   End_Procedure  // Construct_Object
31209>>>>>>>
31209>>>>>>>
31209>>>>>>>  //
31209>>>>>>>  // This may be called by legacy DSO and DDO code
31209>>>>>>>  //
31209>>>>>>>  // IMPORTANT NOTE of change for 8.2:
31209>>>>>>>  //         DO NOT call or augment this anymore.
31209>>>>>>>  //
31209>>>>>>>  //         for sending: Find all cases of Field_main_index and change it to File_Field_Index
31209>>>>>>>  //
31209>>>>>>>  //         for augmenting: In DSOs - replace Field_main_index with File_field_index
31209>>>>>>>  //                         In DDOs - replace Field_main_Index with Field_Index and do not pass
31209>>>>>>>  //                                   the file parameter.
31209>>>>>>>  //                                   See DDOs Field_index and File_field_Index for more
31209>>>>>>>  //
31209>>>>>>>  function Field_Main_Index integer file integer field returns integer
31211>>>>>>>    integer dataType fldNdx retval ordr
31211>>>>>>>    move -1 to retval      //field has no main index (default)
31212>>>>>>>    if file ne 0 begin
31214>>>>>>>//      FIELD_DEF file field to dataType fldNdx
31214>>>>>>>      get_attribute DF_FIELD_INDEX of file field to fldNdx // main index field
31217>>>>>>>      if (fldNdx > 0 OR field = 0) move fldNdx to retval //field has main index
31220>>>>>>>    end
31220>>>>>>>>
31220>>>>>>>    if file eq (main_file(self)) begin
31222>>>>>>>      get ordering to ordr
31223>>>>>>>      if ordr ge 0 move ordr to retval  //ordering takes precedence over main index
31226>>>>>>>    end
31226>>>>>>>>
31226>>>>>>>    function_return retval
31227>>>>>>>  end_function
31228>>>>>>>
31228>>>>>>>    // This allows packages that still use data-sets instead of DDOs to use this
31228>>>>>>>    // message syntax.
31228>>>>>>>    // Note that this will never get here if the DD class is used as
31228>>>>>>>    // it has its own handler for this. It only is called if DSOs are used in which
31228>>>>>>>    // case it calls the old message field_main_index above.
31228>>>>>>>    // DDO based objects will NEVER call this code
31228>>>>>>>    //
31228>>>>>>>    function File_Field_Index integer iFile integer iField returns integer
31230>>>>>>>        function_return (Field_main_Index(self,iFile,iField))
31231>>>>>>>    end_function
31232>>>>>>>
31232>>>>>>>
31232>>>>>>>  procedure Item_Find integer eFindMode ;                      integer iFile integer iField ;                      integer bDoEntryUpdate integer bShowFindErr integer bDeferred
31234>>>>>>>
31234>>>>>>>    RowId   riRow
31234>>>>>>>    integer iIndex
31234>>>>>>>    Handle  hoServer
31234>>>>>>>    integer iSegments iSeg iSegFld iSegFldMainIndex
31234>>>>>>>    boolean bChanged bDoCheck bOk
31234>>>>>>>
31234>>>>>>>    //Get Field_Main_Index iFile iField to iIndex
31234>>>>>>>    Get File_Field_Index iFile iField to iIndex
31235>>>>>>>    If (iIndex<>-1) Begin
31237>>>>>>>      // get prior rowId before it get cleared
31237>>>>>>>      Move (GetRowID(iFile)) to riRow
31238>>>>>>>      //  'hold' buffer to prepare for entry_update
31238>>>>>>>      Set_Attribute DF_FILE_STATUS of iFile to DF_FILE_INACTIVE
31241>>>>>>>      if bDoEntryUpdate Begin
31243>>>>>>>        send Request_Entry_Update iFile 1  //entUpdt all DEOs as required
31244>>>>>>>
31244>>>>>>>        // If the buffer is cleared (no record and no changed data) then we want
31244>>>>>>>        // to do a constrained_clear which will force the buffer to get cleared
31244>>>>>>>        // according to the rules of the current constraints.
31244>>>>>>>        //Get_field_value iFile 0 to iRec
31244>>>>>>>        //Move (GetRowID(iFile)) to riRow // 12.1 moved above the set file inactive
31244>>>>>>>
31244>>>>>>>        // If there was an active record to begin with we consider this changed (not cleared)
31244>>>>>>>        If (not(IsNullRowId(riRow))) Begin
31246>>>>>>>            Move True to bChanged
31247>>>>>>>        End
31247>>>>>>>>
31247>>>>>>>        Else Begin
31248>>>>>>>            // or, if the record was already changed or the entry_update created a change
31248>>>>>>>            // we consider this changed
31248>>>>>>>            Get_Attribute DF_FILE_CHANGED of iFile to bChanged
31251>>>>>>>        End
31251>>>>>>>>
31251>>>>>>>
31251>>>>>>>        If not bChanged Begin
31253>>>>>>>            // if buffer is unchanged, do a constrained clear. It is unchanged if there was not
31253>>>>>>>            // active record, the record was unchanged, and the update didn't change anything.
31253>>>>>>>            Constrained_Clear eFindMode iFile by iIndex
31256>>>>>>>        End
31256>>>>>>>>
31256>>>>>>>        Else If (eFindMode=GE or eFindMode=LE and iIndex>0) Begin
31259>>>>>>>
31259>>>>>>>             // If mode is GE or LE we need to do some extra processing. We want to clear
31259>>>>>>>             // all index segemnt fields that occur after this field in the index. This way
31259>>>>>>>             // dbList searches and find ge searches (f9) will always find the first record
31259>>>>>>>             // that matches the data in the field being searched. This was if an index like
31259>>>>>>>             // customer.name x customer.number where you had 10 identical names "john" typing
31259>>>>>>>             // john will find the first record, because customer.number will get cleared.
31259>>>>>>>             // Note we can no do this with GT or LT or you'd get stuck in fields
31259>>>>>>>
31259>>>>>>>             // check all fields for index. Once you find the iField field, clear all
31259>>>>>>>             // fields that follow it. Only do this if the other fields do not use the
31259>>>>>>>             // same index as its primary index (in which case we assume the data is intentional).
31259>>>>>>>             // This should handle most cases.
31259>>>>>>>             get_attribute DF_INDEX_NUMBER_SEGMENTS of iFile iIndex to iSegments
31262>>>>>>>             for iSeg from 1 to iSegments
31268>>>>>>>>
31268>>>>>>>                 get_Attribute DF_INDEX_SEGMENT_FIELD of iFile iIndex iSeg to iSegFld
31271>>>>>>>                 If not bDoCheck begin
31273>>>>>>>                     If (iSegFld=iField) ;                         Move True to bDoCheck // marked after we find the find field in the index
31276>>>>>>>                 end
31276>>>>>>>>
31276>>>>>>>                 else Begin // we get here after we've found the main field segment
31277>>>>>>>                    // if main index if this segment is same as our find index, do nothing
31277>>>>>>>                    Get File_Field_Index iFile iSegFld to iSegFldMainIndex
31278>>>>>>>                    If (iSegFldMainIndex<>iIndex) ;                        set_field_value iFile iSegFld to ''
31283>>>>>>>                end
31283>>>>>>>>
31283>>>>>>>             loop
31284>>>>>>>>
31284>>>>>>>        end
31284>>>>>>>>
31284>>>>>>>
31284>>>>>>>        Get Which_Data_Set iFile to hoServer
31285>>>>>>>        if (hoServer AND iFile=main_file(hoServer)) ;             send Attach_Main_File to hoServer
31288>>>>>>>        else ;             attach iFile
31290>>>>>>>      end
31290>>>>>>>>
31290>>>>>>>
31290>>>>>>>      indicate err false
31291>>>>>>>
31291>>>>>>>      if (Is_SuperFind_Required(self,iFile)) ;          send Request_SuperFind eFindMode iFile iField
31294>>>>>>>      else if bDeferred ;          send Request_Read eFindMode iFile iIndex
31298>>>>>>>      else ;          send Request_Find eFindMode iFile iIndex
31300>>>>>>>
31300>>>>>>>      If (not(found) and not(err)) begin
31302>>>>>>>          // refind original record (or leave it cleared if not record)
31302>>>>>>>          Move (FindByRowId(iFile,riRow)) to bOk
31303>>>>>>>
31303>>>>>>>          if bShowFindErr ;              error (if(eFindMode<2, DFERR_FIND_PRIOR_BEG_OF_FILE, DFERR_FIND_PAST_END_OF_FILE))
31306>>>>>>>          indicate FOUND FALSE
31307>>>>>>>      end
31307>>>>>>>>
31307>>>>>>>    end
31307>>>>>>>>
31307>>>>>>>    else ;        if bShowFindErr error DFERR_FIELD_NOT_INDEXED
31311>>>>>>>  end_procedure
31312>>>>>>>
31312>>>>>>>
31312>>>>>>>  // We only care about should_saves of DEOs and not DSOs when
31312>>>>>>>  // exiting the app. Create a handler for data set class. We still
31312>>>>>>>  // broadcast in case we've got nested deos in the dso (hopefully not).
31312>>>>>>>  //
31312>>>>>>>  Function Exit_Application_Check Returns Integer
31314>>>>>>>    Integer rVal
31314>>>>>>>    BroadCast Get Exit_Application_Check to Rval // check w/ kids
31316>>>>>>>    Function_return rVal
31317>>>>>>>  End_Function
31318>>>>>>>
31318>>>>>>>   Procedure Constrain
31320>>>>>>>     Integer iFile
31320>>>>>>>     Send OnConstrain
31321>>>>>>>     Forward Send Constrain
31323>>>>>>>     Get Constrain_File to iFile
31324>>>>>>>     If iFile ;        Constrain (Main_file(self)) relates to iFile
31327>>>>>>>   End_procedure
31328>>>>>>>
31328>>>>>>>   Procedure OnConstrain
31330>>>>>>>   End_Procedure
31331>>>>>>>
31331>>>>>>>   // Less confusing Message for adding Updating servers
31331>>>>>>>   //
31331>>>>>>>   Procedure Set DDO_Server Handle ObjId
31333>>>>>>>      Send Attach_Server ObjId
31334>>>>>>>   End_Procedure // Set DDO_Server
31335>>>>>>>
31335>>>>>>>   // This is called when a view takes or retakes the
31335>>>>>>>   // focus. If DD not in use, do nothing.
31335>>>>>>>   //
31335>>>>>>>   Procedure Refind_DD_Records
31337>>>>>>>        if (in_use_state(self)) Send refind_records
31340>>>>>>>   end_procedure
31341>>>>>>>
31341>>>>>>>   // this returns true if the data-set is changed AND there are attached
31341>>>>>>>   // DEO objects. Without this you can get "changes exist" condition reported
31341>>>>>>>   // that the user will have no way of saving.
31341>>>>>>>   //
31341>>>>>>>   Function Data_Set_Should_Save returns integer
31343>>>>>>>        Function_Return (Should_Save(self) AND ;                           Data_Set_User_interface_count(self))
31344>>>>>>>   End_Function
31345>>>>>>>
31345>>>>>>>   // returns 0 indicating that this is not DD enabled. DataDictionary objects will return 1.
31345>>>>>>>   // Add DSOs and DDOs must understand this message
31345>>>>>>>
31345>>>>>>>   Function Extended_DSO_State Returns Integer
31347>>>>>>>       Function_return 0
31348>>>>>>>   End_Function // Extended_DSO_State
31349>>>>>>>
31349>>>>>>>
31349>>>>>>>end_class
31350>>>>>>>
31350>>>>>>>//#COMMAND bind_main_file // this should not be used anymore
31350>>>>>>>//  #IF (!0>1)
31350>>>>>>>//    #IFSAME !1 MAIN_FILE
31350>>>>>>>//      #IFDEF !2.RECNUM
31350>>>>>>>//        #PUSH !u
31350>>>>>>>//        #SET U$ !2.RECNUM
31350>>>>>>>//        set main_file to |CI!u
31350>>>>>>>//        #POP u$
31350>>>>>>>//      #ELSE
31350>>>>>>>//        #ERROR DFERR_COMPILE If !2 is a file it is unopened
31350>>>>>>>//      #ENDIF
31350>>>>>>>//    #ELSE
31350>>>>>>>//      bind_main_file !2 !3 !4 !5 !6 !7 !8 !9
31350>>>>>>>//    #ENDIF
31350>>>>>>>//  #ENDIF
31350>>>>>>>//#ENDCOMMAND
31350>>>>>>>
31350>>>>>>>//#COMMAND bind_index
31350>>>>>>>//  #IF (!0>1)
31350>>>>>>>//    #IFSAME !1 BY
31350>>>>>>>//      set ordering to !2
31350>>>>>>>//    #ELSE
31350>>>>>>>//      bind_index !2 !3 !4 !5 !6 !7 !8 !9
31350>>>>>>>//    #ENDIF
31350>>>>>>>//  #ENDIF
31350>>>>>>>//#ENDCOMMAND
31350>>>>>>>
31350>>>>>>>//#COMMAND Bind_Updating
31350>>>>>>>//  #IF (!0>1)
31350>>>>>>>//    #IFSAME !1 UPDATING
31350>>>>>>>//      SetDependents !2 !3 !4 !5 !6 !7 !8 !9
31350>>>>>>>//    #ELSE
31350>>>>>>>//      Bind_Updating !2 !3 !4 !5 !6 !7 !8 !9
31350>>>>>>>//    #ENDIF
31350>>>>>>>//  #ENDIF
31350>>>>>>>//#ENDCOMMAND
31350>>>>>>>
31350>>>>>>>//#COMMAND SetDependents   //<File>|<Server#> [ ... ] ...obsolete
31350>>>>>>>//  #IF (!0>0)
31350>>>>>>>//    #IFDEF !1
31350>>>>>>>//      send Attach_Server !1
31350>>>>>>>//    #ELSE
31350>>>>>>>//      #IFDEF !1.OBJ
31350>>>>>>>//        send attach_Server !1.OBJ
31350>>>>>>>//      #ELSE
31350>>>>>>>//        #IFDEF !1.RECNUM
31350>>>>>>>//          #PUSH !u
31350>>>>>>>//          #SET U$ !1.RECNUM
31350>>>>>>>//          send Add_Parent_File |CI!u
31350>>>>>>>//          #POP U$
31350>>>>>>>//        #ELSE
31350>>>>>>>//          #ERROR DFERR_COMPILE If !1 is a file it is unopened
31350>>>>>>>//        #ENDIF
31350>>>>>>>//      #ENDIF
31350>>>>>>>//    #ENDIF
31350>>>>>>>//    SetDependents !2 !3 !4 !5 !6 !7 !8 !9
31350>>>>>>>//  #ENDIF
31350>>>>>>>//#ENDCOMMAND
31350>>>>>>>
31350>>>>>>>
31350>>>>>Use DDValtbl.pkg  // validation table classes
Including file: Ddvaltbl.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\Ddvaltbl.pkg)
31350>>>>>>>//****************************************************************************//
31350>>>>>>>//                                                                            //
31350>>>>>>>// $File name  : ddvaltbl.pkg                                                 //
31350>>>>>>>// $File title :                                                              //
31350>>>>>>>// Notice      :                                                              //
31350>>>>>>>// $System     : Extended Data Sets 3.1                                       //
31350>>>>>>>// Created     : 03/28/96 04:48 pm                                            //
31350>>>>>>>// $Last Rev   : 03/28/96 04:48 pm41                                          //
31350>>>>>>>//                                                                            //
31350>>>>>>>// $Description                                                               //
31350>>>>>>>//                                                                            //
31350>>>>>>>//                                                                            //
31350>>>>>>>// $Rev History                                                               //
31350>>>>>>>//JT 02/04/97 Changed Validate_value in FileValidationTable to no use the code//
31350>>>>>>>//            DSO if operation mode is busy. In DDOs validtion sets operation_//
31350>>>>>>>//            mode to busy.                                                   //
31350>>>>>>>//JT 12/23/96 Made sure field values are always trimmed!                      //
31350>>>>>>>//JT 07/23/96 New Class names                                                 //
31350>>>>>>>//JT 06/12/96 Modified "indirect-file" finding methods and replaced them with //
31350>>>>>>>//            3.1 API commands                                                //
31350>>>>>>>//JT 05/28/96 Add Public Message Find_Code_Description. Passes Code and       //
31350>>>>>>>//            returns the description. Created properties current_description //
31350>>>>>>>//            current_code and current_Record to speed up this process        //
31350>>>>>>>//JT 02-04-96 Changed Validation_xxx_table to xxx_Validation_Table            //
31350>>>>>>>//JT 28-03-96 File header created                                             //
31350>>>>>>>//                                                                            //
31350>>>>>>>//****************************************************************************//
31350>>>>>>>
31350>>>>>>>
31350>>>>>>>//****************************************************************************//
31350>>>>>>>//  Validation Table Support for Extended Data-Sets. Fields may               //
31350>>>>>>>//  attached to validation tables which can then be used for                  //
31350>>>>>>>//  validation (if Validate_state is true) or list loading.                   //
31350>>>>>>>//  Developers can create their own validation tables as long as they         //
31350>>>>>>>//  conform to the following external interface:                              //
31350>>>>>>>//                                                                            //
31350>>>>>>>// Properties                                                                 //
31350>>>>>>>//   Static_State       - if list must be rebuilt each validation, load       //
31350>>>>>>>//   Allow_Blank_state  - If Blank or 0 is a valid response                   //
31350>>>>>>>//   Validate_State     - should table be used for validation                 //
31350>>>>>>>//   Table_Loaded_State - is the validation table initialized?                //
31350>>>>>>>//                                                                            //
31350>>>>>>>// Methods                                                                    //
31350>>>>>>>//  Get Validate_Value sValue to iVal - if iVal=0, it is legal                //
31350>>>>>>>//  Send Fill_list                    - fills a static list                   //
31350>>>>>>>//  Send Request_Fill_From_List iObject iMessage                              //
31350>>>>>>>//        This is a callback that will fill an external list by sending       //
31350>>>>>>>//        the passed message (iMessage) back to the requesting object         //
31350>>>>>>>//        (iObject). It will send this message for each item in the           //
31350>>>>>>>//        validation table. It always passes back four params. Those are:     //
31350>>>>>>>//                     iItem - Item count being passed back                   //
31350>>>>>>>//                     sData - The Database value of the item                 //
31350>>>>>>>//                     sDesc - The Value's description, "" if none            //
31350>>>>>>>//                     iFile - File number associated with the item (if any)  //
31350>>>>>>>//                     iRec  - Record associated with the item (if any)       //
31350>>>>>>>// Developers can create classes of any complexity to support validation      //
31350>>>>>>>// tables. We have provided the following four classes.                       //
31350>>>>>>>//                                                                            //
31350>>>>>>>//  ValidationTable is an Array                                               //
31350>>>>>>>//           Provides simple one dimensional table support. The table must be //
31350>>>>>>>//           loaded manually by creating fill_list and sending the message    //
31350>>>>>>>//           Add_Table_Value (send Add_Table_Value Value). If list is static      //
31350>>>>>>>//           it is filled once. If non-static it is filled each time it is    //
31350>>>>>>>//           requested to validate or fill a foreign lis.                     //
31350>>>>>>>//                                                                            //
31350>>>>>>>//  DescriptionValidationTable is a ValidationTable                           //
31350>>>>>>>//           Provides a more complex three dimension array allowing the       //
31350>>>>>>>//           object to store a data value, description value and a record     //
31350>>>>>>>//           number. The developer must fill this list using the Add_table_   //
31350>>>>>>>//           value message passing up to three values (data, desc, record).   //
31350>>>>>>>//                                                                            //
31350>>>>>>>//  FileValidationTable is a DescriptionValidationTable                       //
31350>>>>>>>//           Provides a data aware table. This can be used to load data from  //
31350>>>>>>>//           data-files, from data-sets. If you use data-sets you can place   //
31350>>>>>>>//           constraints within the data-set. You must define the file-number,//
31350>>>>>>>//           data-set (if any), the file index, the file's data field, and    //
31350>>>>>>>//           the file's description field. You can also define an optional    //
31350>>>>>>>//           "Type". All records are constrained to this type (with or with-  //
31350>>>>>>>//           data-sets). If is assumed that this file has an optimized finding//
31350>>>>>>>//           index.                                                           //
31350>>>>>>>//                                                                            //
31350>>>>>>>//  CodeValidationTable is a FileValidationTable                              //
31350>>>>>>>//           Used for Code lists. Simply set Type_Value to the "type"         //
31350>>>>>>>//                                                                            //
31350>>>>>>>//                                                                            //
31350>>>>>>>//****************************************************************************//
31350>>>>>>>use VDFBase.pkg
31350>>>>>>>
31350>>>>>>>
31350>>>>>>>Class ValidationTable is an Array
31351>>>>>>>
31351>>>>>>>   Procedure Construct_Object
31353>>>>>>>      Forward Send Construct_Object
31355>>>>>>>      Property Integer Static_State        True
31356>>>>>>>
31356>>>>>>>      Property Integer Table_Loaded_State  False
31357>>>>>>>
31357>>>>>>>      Property Integer Validate_State      True
31358>>>>>>>      Property Integer Allow_Blank_State   False
31359>>>>>>>      Property Integer Main_File           0
31360>>>>>>>      Property String  Table_Title         DD_VALIDATION_LIST_TITLE
31361>>>>>>>
31361>>>>>>>      Property Integer Number_Elements     1
31362>>>>>>>
31362>>>>>>>      // System maintained. Sub-classes use these
31362>>>>>>>      // These are SET by Next_Code_Record. You may GET their values
31362>>>>>>>
31362>>>>>>>      Property String  Current_Code            ''
31363>>>>>>>
31363>>>>>>>      Property String  Current_Description     ''
31364>>>>>>>
31364>>>>>>>      Property RowId Current_RowId
31365>>>>>>>   End_Procedure // Construct_Object
31366>>>>>>>
31366>>>>>>>   Function Data_Item_Count returns integer
31368>>>>>>>     Function_return (Item_Count(Self))
31369>>>>>>>   End_Function
31370>>>>>>>
31370>>>>>>>   Function Data_Value Integer iItem returns string
31372>>>>>>>      Function_return (Value(Self,iItem))
31373>>>>>>>   End_function
31374>>>>>>>
31374>>>>>>>   Procedure Set Data_Value Integer iItem String sValue
31376>>>>>>>      Set Value Item iItem to sValue
31377>>>>>>>   End_Procedure
31378>>>>>>>
31378>>>>>>>   Function Data_Description Integer iItem returns string
31380>>>>>>>      Function_Return ''
31381>>>>>>>   End_function
31382>>>>>>>
31382>>>>>>>   Procedure Set Data_Description Integer iItem String sValue
31384>>>>>>>   End_function
31385>>>>>>>
31385>>>>>>>   Function Data_RowId Integer iItem returns RowId
31387>>>>>>>       Function_return (NullRowId())
31388>>>>>>>   End_function
31389>>>>>>>
31389>>>>>>>   Procedure Set Data_RowId Integer iItem RowId riValue
31391>>>>>>>   End_function
31392>>>>>>>
31392>>>>>>>
31392>>>>>>>   Procedure Add_Table_Value String sValue
31394>>>>>>>     Set Data_Value Item (Data_Item_Count(self)) to sValue
31395>>>>>>>   End_Procedure
31396>>>>>>>
31396>>>>>>>   Function Validate_Value String sCode Returns Integer
31398>>>>>>>      Integer iMax
31398>>>>>>>      Integer iCnt
31398>>>>>>>      If sCode eq '';         Function_Return (not(Allow_Blank_State(Self)))
31401>>>>>>>      If (Table_Loaded_State(Self)=0 or Static_State(Self)=0) Begin
31403>>>>>>>         Send Delete_Data
31404>>>>>>>         Send Fill_list
31405>>>>>>>         Set Table_Loaded_State to TRUE
31406>>>>>>>      End
31406>>>>>>>>
31406>>>>>>>      Get Data_Item_Count to iMax
31407>>>>>>>      Decrement iMax
31408>>>>>>>      For iCnt from 0 to iMax
31414>>>>>>>>
31414>>>>>>>          If (sCode=Data_Value(Self,iCnt)) Begin
31416>>>>>>>             Set Current_Code        to sCode
31417>>>>>>>             Set Current_Description to (Data_Description(Self,iCnt))
31418>>>>>>>             Set Current_RowId       to (Data_RowId(Self,iCnt))
31419>>>>>>>             Function_return 0
31420>>>>>>>          End
31420>>>>>>>>
31420>>>>>>>      Loop
31421>>>>>>>>
31421>>>>>>>      Function_Return 1 // 0=OK
31422>>>>>>>   End_Function
31423>>>>>>>
31423>>>>>>>   Function Find_Code_Description String sCode Returns String
31425>>>>>>>      If (sCode='' OR ;           (sCode<>Current_Code(Self) AND ;            Validate_Value(Self,sCode) ) );                Function_Return ''
31428>>>>>>>      Function_Return (Current_Description(Self))
31429>>>>>>>   End_Function
31430>>>>>>>
31430>>>>>>>
31430>>>>>>>   //  The deveveloper (or a sub-class) must fill this list. It is done
31430>>>>>>>   //  by finding the item and sending the Message:
31430>>>>>>>   //    Send Add_Table_Value sValue {sDescr}
31430>>>>>>>   //
31430>>>>>>>   Procedure Fill_List
31432>>>>>>>      Set Table_Loaded_State to TRUE
31433>>>>>>>   End_Procedure
31434>>>>>>>
31434>>>>>>>   Procedure Request_Fill_From_List integer iObj integer iMsg
31436>>>>>>>      Integer iMax
31436>>>>>>>      Integer iCnt
31436>>>>>>>      Integer iFile
31436>>>>>>>
31436>>>>>>>      If (iObj=0 or iMsg=0) Procedure_return
31439>>>>>>>
31439>>>>>>>      If (Table_Loaded_State(Self)=0 OR Static_State(Self)=0) Begin
31441>>>>>>>         Send Delete_Data
31442>>>>>>>         Send Fill_list
31443>>>>>>>         Set Table_Loaded_State to TRUE
31444>>>>>>>      End
31444>>>>>>>>
31444>>>>>>>      Get Main_File to iFile
31445>>>>>>>      Get Data_Item_Count to iMax
31446>>>>>>>      Decrement iMax
31447>>>>>>>      For iCnt from 0 to iMax
31453>>>>>>>>
31453>>>>>>>          Send iMsg to iObj iCnt (Data_Value(Self,iCnt)) ;                                 (Data_Description(Self,iCnt)) iFile ;                                 (Data_RowId(Self,iCnt))
31454>>>>>>>      Loop
31455>>>>>>>>
31455>>>>>>>   End_Procedure
31456>>>>>>>
31456>>>>>>>
31456>>>>>>>    // returns all data in a two dimension variant array.
31456>>>>>>>    // [i][0] = data
31456>>>>>>>    // [i][1] = description
31456>>>>>>>    // This can be used by Crystal CDO classes (this is why a variant array is used)
31456>>>>>>>    Function TableData returns variant[][]
31458>>>>>>>        Variant[][2] vData
31459>>>>>>>        Integer iMax i
31459>>>>>>>        If (Table_Loaded_State(Self)=0 OR Static_State(Self)=0) Begin
31461>>>>>>>            Send Delete_Data
31462>>>>>>>            Send Fill_list
31463>>>>>>>            Set Table_Loaded_State to TRUE
31464>>>>>>>        End
31464>>>>>>>>
31464>>>>>>>        Get Data_Item_Count to iMax
31465>>>>>>>        For i from 0 to (iMax-1)
31471>>>>>>>>
31471>>>>>>>            Get Data_Value       i to vData[i][0]
31472>>>>>>>            Get Data_Description i to vData[i][1]
31473>>>>>>>        Loop
31474>>>>>>>>
31474>>>>>>>        function_Return vData
31475>>>>>>>    End_Function
31476>>>>>>>
31476>>>>>>>End_Class
31477>>>>>>>
31477>>>>>>>
31477>>>>>>>
31477>>>>>>>Class DescriptionValidationTable is an ValidationTable
31478>>>>>>>
31478>>>>>>>    Procedure Construct_Object
31480>>>>>>>       Forward Send Construct_Object
31482>>>>>>>       Set Number_Elements to 2
31483>>>>>>>    End_Procedure // Construct_Object
31484>>>>>>>
31484>>>>>>>    Function Data_Item_Count returns integer
31486>>>>>>>       function_return (item_count(Self)/3)
31487>>>>>>>    End_Function // Data_item_Count
31488>>>>>>>
31488>>>>>>>    Function Data_Value Integer iItem returns string
31490>>>>>>>       Function_return (Value(Self,iItem*3))
31491>>>>>>>    End_function
31492>>>>>>>
31492>>>>>>>    Procedure Set Data_Value Integer iItem String sValue
31494>>>>>>>       Set Value Item (iItem*3) to sValue
31495>>>>>>>    End_Procedure
31496>>>>>>>
31496>>>>>>>    Function Data_Description Integer iItem returns string
31498>>>>>>>       Function_return (Value(Self,iItem*3+1))
31499>>>>>>>    End_function
31500>>>>>>>
31500>>>>>>>    Procedure Set Data_Description Integer iItem String sValue
31502>>>>>>>       Set Value Item (iItem*3+1) to sValue
31503>>>>>>>    End_function
31504>>>>>>>
31504>>>>>>>    Function Data_RowId Integer iItem returns RowId
31506>>>>>>>       String sRowId
31506>>>>>>>       Get Value (iItem*3+2) to sRowId
31507>>>>>>>       Function_return (DeSerializeRowId(sRowId))
31508>>>>>>>    End_function
31509>>>>>>>
31509>>>>>>>    Procedure Set Data_RowId Integer iItem RowId riValue
31511>>>>>>>       Set Value Item (iItem*3+2) to (SerializeRowId(riValue))
31512>>>>>>>    End_function
31513>>>>>>>
31513>>>>>>>    Procedure Add_Table_Value String sData String sDescr RowId riRec
31515>>>>>>>      String  sVal
31515>>>>>>>      RowId   riRecVal
31515>>>>>>>      Integer iCnt
31515>>>>>>>      Get Data_Item_Count to iCnt
31516>>>>>>>      Set Data_Value iCnt to sData
31517>>>>>>>
31517>>>>>>>      // If one param passed use it for both display and database values
31517>>>>>>>      If num_arguments le 1 Move sData  to sVal
31520>>>>>>>      Else                  Move sDescr to sVal
31522>>>>>>>      Set Data_Description iCnt to sVal
31523>>>>>>>
31523>>>>>>>      If num_arguments le 2 Move (NullRowId()) to riRecVal
31526>>>>>>>      Else                  Move riRec        to riRecVal
31528>>>>>>>      Set Data_RowId iCnt to riRecVal
31529>>>>>>>    End_Procedure
31530>>>>>>>End_Class
31531>>>>>>>
31531>>>>>>>
31531>>>>>>>Class FileValidationTable is an DescriptionValidationTable
31532>>>>>>>
31532>>>>>>>   Procedure Construct_Object
31534>>>>>>>      Forward Send Construct_Object
31536>>>>>>>      Property Integer No_Fill_State     False // this is never used and is obsolete. (JJT)
31537>>>>>>>      Property Integer Ordering          1   // Indx1 is a good guess.
31538>>>>>>>      Property String  Type_Value        ''  // default these two to
31539>>>>>>>      Property Integer Type_Field        0   // Undefined (none).
31540>>>>>>>      Property Integer Code_Field        1   // Fld 1=code, 2=descr
31541>>>>>>>      Property Integer Description_Field 2   // are good guesses.
31542>>>>>>>
31542>>>>>>>      Property Integer Code_Load_Object  0   // or (Code_Loader(Self))
31543>>>>>>>   End_Procedure // Construct_Object
31544>>>>>>>
31544>>>>>>>   Function Table_Loaded_State Returns Integer
31546>>>>>>>      integer iRVal
31546>>>>>>>      Get No_fill_State to iRVal // if true, table always is loaded
31547>>>>>>>      If Not iRval ;         Forward get table_loaded_State to iRVal
31551>>>>>>>      Function_Return iRval
31552>>>>>>>   End_Function
31553>>>>>>>
31553>>>>>>>   Function Validate_Value String sCode Returns Integer
31555>>>>>>>      Integer iRVal
31555>>>>>>>      Integer iDSO
31555>>>>>>>      Get Code_Load_Object  to iDSO
31556>>>>>>>      // we use standard validate, if code is blank, OR if
31556>>>>>>>      //   1. if no code DSO or the code DSO exists but is not busy.
31556>>>>>>>      //   2. AND it is not no-fill
31556>>>>>>>      //   3. AND it is static
31556>>>>>>>      // Else we find the record directly
31556>>>>>>>      // Note that the operation mode is busy during request_validate (the
31556>>>>>>>      // ddo does this). WHen operation mode is busy we must not use
31556>>>>>>>      // the code dso (must find manually).
31556>>>>>>>      If (sCode='' OR ;           ( (iDSO=0 OR Operation_Mode=0)    AND ; // if no code DSO or DSO not busy             No_Fill_State(Self)=0 AND ;             Static_State(Self) ) ) ;               Forward Get Validate_Value sCode to iRVal
31560>>>>>>>      Else If (sCode<>Current_Code(Self)) ;          Get Find_Value sCode to iRVal
31564>>>>>>>      Function_Return iRVal // OK
31565>>>>>>>   End_Function
31566>>>>>>>
31566>>>>>>>   Procedure Initialize_File
31568>>>>>>>      integer iFile iCodeField iDescField iDSO iIndex iTypeField
31568>>>>>>>      Get Code_Load_Object  to iDSO
31569>>>>>>>      Get Main_File         to iFile
31570>>>>>>>      Get Code_Field        to iCodeField
31571>>>>>>>      Get Description_Field to iDescField
31572>>>>>>>      Get Ordering          to iIndex
31573>>>>>>>      Get Type_Field        to iTypeField
31574>>>>>>>      If (iDSO AND Operation_Mode=0) ;         Send Initialize_File to iDSO ;              iFile iIndex iCodeField iDescField ;              iTypeField (Type_Value(Self))
31577>>>>>>>      Else Begin
31578>>>>>>>         Clear iFile
31579>>>>>>>         // if Type exists, seed the type value
31579>>>>>>>         If iTypeField ;            Set_Field_Value iFile iTypeField to (Type_Value(Self))
31584>>>>>>>      End
31584>>>>>>>>
31584>>>>>>>   End_Procedure
31585>>>>>>>
31585>>>>>>>   Function Find_Value string Code returns Integer
31587>>>>>>>     integer iFile iCodeField iDescField iDSO iIndex iTypeField
31587>>>>>>>     Get Code_Load_Object  to iDSO
31588>>>>>>>     Get Main_File         to iFile
31589>>>>>>>     Get Ordering          to iIndex
31590>>>>>>>     Get Code_Field        to iCodeField
31591>>>>>>>     Get Description_Field to iDescField
31592>>>>>>>     Get Type_Field        to iTypeField
31593>>>>>>>     Send Initialize_File
31594>>>>>>>     //
31594>>>>>>>     Set_Field_Value iFile iCodeField to Code
31597>>>>>>>     If (iDSO AND Operation_Mode=0) ;        Send Request_Find to iDSO EQ iFile iIndex
31600>>>>>>>     Else ;        vFind iFile iIndex EQ
31603>>>>>>>     If not (Found) Function_Return 1
31606>>>>>>>     // Set properties Current_code and Current_Description
31606>>>>>>>     Send Store_Current_Data iFile iCodeField iDescField
31607>>>>>>>     Function_Return 0
31608>>>>>>>   End_Function // Function
31609>>>>>>>
31609>>>>>>>   // internal
31609>>>>>>>   Procedure Store_Current_Data Integer iFile Integer iCodeField Integer iDescField
31611>>>>>>>     String sVal
31611>>>>>>>//     Integer iRec
31611>>>>>>>     Get_Field_Value iFile iCodeField to sVal
31614>>>>>>>     Set Current_Code to (trim(sVal))
31615>>>>>>>     If iDescField Begin
31617>>>>>>>        Get_Field_Value iFile iDescField to sVal
31620>>>>>>>        Set Current_Description to (trim(sVal))
31621>>>>>>>     End
31621>>>>>>>>
31621>>>>>>>     Set Current_RowId to (GetRowId(iFile))
31622>>>>>>>//     Get_Field_Value iFile 0 to iRec // recnum
31622>>>>>>>//     Set Current_Record to iRec
31622>>>>>>>   End_Procedure
31623>>>>>>>
31623>>>>>>>   Function Next_Code_Record Returns boolean
31625>>>>>>>     integer iFile iCodeField iDescField iIndex
31625>>>>>>>     Integer iTypeField
31625>>>>>>>     String sTypeValue sFoundTypeValue
31625>>>>>>>     boolean bFound
31625>>>>>>>     handle hoDSO
31625>>>>>>>     Get Code_Load_Object  to hoDSO
31626>>>>>>>     Get Description_Field to iDescField
31627>>>>>>>     Get Code_Field        to iCodeField
31628>>>>>>>     Get Main_File         to iFile
31629>>>>>>>
31629>>>>>>>     If hoDSO begin
31631>>>>>>>        Get Next_Code_record of hoDSO to bFound
31632>>>>>>>     end
31632>>>>>>>>
31632>>>>>>>     Else Begin
31633>>>>>>>        Get Ordering to iIndex
31634>>>>>>>        vFind iFile iIndex GT
31636>>>>>>>        Move (Found) to bFound
31637>>>>>>>        If bFound Begin
31639>>>>>>>            // if found see if we are at the end of the valid list of types
31639>>>>>>>            Get Type_Field To iTypeField
31640>>>>>>>            Get Type_Value To sTypeValue
31641>>>>>>>            If ((iTypeField<>0) And (sTypeValue<>"")) Begin
31643>>>>>>>                Get_Field_Value iFile iTypeField To sFoundTypeValue
31646>>>>>>>                Move (Trim(sTypeValue)=Trim(sFoundTypeValue)) To bFound
31647>>>>>>>             End
31647>>>>>>>>
31647>>>>>>>        End
31647>>>>>>>>
31647>>>>>>>     End
31647>>>>>>>>
31647>>>>>>>     if bFound Begin
31649>>>>>>>        Send Store_Current_Data iFile iCodeField iDescField
31650>>>>>>>     End
31650>>>>>>>>
31650>>>>>>>     Function_Return bFound
31651>>>>>>>   End_Function // next_Code_record
31652>>>>>>>
31652>>>>>>>   Procedure Fill_List
31654>>>>>>>      RowId riId
31654>>>>>>>      boolean bFound
31654>>>>>>>      String sCode sDesc
31654>>>>>>>      If (Static_State(Self)=0 OR No_Fill_State(Self)) ;         Procedure_Return
31657>>>>>>>      //
31657>>>>>>>      Send Delete_Data
31658>>>>>>>      Send Initialize_File
31659>>>>>>>      Get Next_Code_Record to bFound
31660>>>>>>>      While bFound
31664>>>>>>>         Get Current_Code        to sCode
31665>>>>>>>         Get Current_Description to sDesc
31666>>>>>>>         Get Current_RowId       to riId
31667>>>>>>>         Send Add_Table_Value sCode sDesc riId
31668>>>>>>>         Get Next_Code_Record to bFound
31669>>>>>>>      Loop
31670>>>>>>>>
31670>>>>>>>      Set Table_Loaded_State to TRUE
31671>>>>>>>   End_Procedure // Fill_list
31672>>>>>>>
31672>>>>>>>   Procedure Request_Fill_From_List integer iObj integer iMsg
31674>>>>>>>      Integer iItem
31674>>>>>>>      Integer iFile
31674>>>>>>>      RowId   riId
31674>>>>>>>      Boolean bFound
31674>>>>>>>      String sCode sDesc
31674>>>>>>>
31674>>>>>>>      If (iObj=0 or iMsg=0) Procedure_return
31677>>>>>>>
31677>>>>>>>      If (Static_State(Self) AND No_Fill_State(Self)=0 ) ;         Forward Send Request_Fill_From_List iObj iMsg
31681>>>>>>>      Else Begin
31682>>>>>>>         Get Main_File to iFile
31683>>>>>>>         Send Initialize_File
31684>>>>>>>         Get Next_Code_Record to bFound
31685>>>>>>>         While bFound
31689>>>>>>>            Get Current_Code        to sCode
31690>>>>>>>            Get Current_Description to sDesc
31691>>>>>>>            Get Current_RowId       to riId
31692>>>>>>>            Send iMSG to iObj iItem sCode sDesc iFile riId
31693>>>>>>>            Increment iItem
31694>>>>>>>            Get Next_Code_Record to bFound
31695>>>>>>>         Loop
31696>>>>>>>>
31696>>>>>>>      End
31696>>>>>>>>
31696>>>>>>>   End_procedure
31697>>>>>>>End_Class
31698>>>>>>>
31698>>>>>>>use CodeLoad.pkg
Including file: codeload.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\codeload.pkg)
31698>>>>>>>>>//************************************************************************
31698>>>>>>>>>//
31698>>>>>>>>>// Confidential Trade Secret.
31698>>>>>>>>>// Copyright 1987-1995 Data Access Corporation, Miami FL, USA
31698>>>>>>>>>// All Rights reserved
31698>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
31698>>>>>>>>>//
31698>>>>>>>>>//************************************************************************
31698>>>>>>>>>
31698>>>>>>>>>//************************************************************************
31698>>>>>>>>>// CodeLoad.pkg   - Code loading data-set
31698>>>>>>>>>// Version: 1.1
31698>>>>>>>>>//  03/18/94 - created
31698>>>>>>>>>//  04/04/94 - modified and made more general
31698>>>>>>>>>// 2/26/2002  JJT - 8.2 clean up (indirect_file, local, self, etc.)
31698>>>>>>>>>//
31698>>>>>>>>>// Author: John J. Tuohy
31698>>>>>>>>>//
31698>>>>>>>>>//
31698>>>>>>>>>// Interface:
31698>>>>>>>>>//
31698>>>>>>>>>//  Procedure Initialize_File Integer File# Integer Index# Integer Code# ;
31698>>>>>>>>>//                            Integer Desc# Integer Type# String Type
31698>>>>>>>>>//
31698>>>>>>>>>//      This initializes the data-set for finding. You MUST pass all five
31698>>>>>>>>>//      parameters here. They are:
31698>>>>>>>>>//          File#  -  main file to use
31698>>>>>>>>>//         Index#  - Index to use for finding
31698>>>>>>>>>//          Code#  - field number of the code
31698>>>>>>>>>//          Desc#  - field number of the code's description
31698>>>>>>>>>//          Type#  - field number of the constraining Type (0 if none)
31698>>>>>>>>>//           Type  - the constrain type value ('' = allow all records)
31698>>>>>>>>>//
31698>>>>>>>>>//      You MUST send this message before finding records. Alternately,
31698>>>>>>>>>//      you could set the individual properties and send rebuild_constraints
31698>>>>>>>>>//      and CLEAR to initalize the file (see code on how to do this).
31698>>>>>>>>>//
31698>>>>>>>>>//    Get Next_Code_record to ret_Int
31698>>>>>>>>>//
31698>>>>>>>>>//      Returns the next record number. 0 if no more. If record exists it
31698>>>>>>>>>//      sets the value of Current_Code and Crnt_Description.
31698>>>>>>>>>//
31698>>>>>>>>>//    Get Current_Code to Ret_String
31698>>>>>>>>>//    Get Crnt_Description to Ret_String
31698>>>>>>>>>//
31698>>>>>>>>>//      Returns the code and description of the last valid record found
31698>>>>>>>>>//      with the Next_Code_Record Message
31698>>>>>>>>>//
31698>>>>>>>>>//   Sample Usage:  This was created primarily to be used by the
31698>>>>>>>>>//                  radio-entry-form classes. In particular those using
31698>>>>>>>>>//                  the "code" look up file. Look at those packages if
31698>>>>>>>>>//                  you wish to use them yourself.
31698>>>>>>>>>//
31698>>>>>>>>>//
31698>>>>>>>>>//
31698>>>>>>>>>//************************************************************************
31698>>>>>>>>>
31698>>>>>>>>>use Data_Set.pkg
31698>>>>>>>>>
31698>>>>>>>>>Class Code_Loader_Data_Set is a DataSet
31699>>>>>>>>>
31699>>>>>>>>>  Procedure Construct_Object Integer Img#
31701>>>>>>>>>      Forward Send Construct_Object Img#
31703>>>>>>>>>      // These should be set by the Initialize_File message
31703>>>>>>>>>      Property String  Type_Value           '' // assume no defaults.
31704>>>>>>>>>      Property Integer Type_Field           0  // These values should be
31705>>>>>>>>>      Property Integer Code_Field           0  // set by initialize_file
31706>>>>>>>>>      Property Integer Description_Field    0  //
31707>>>>>>>>>
31707>>>>>>>>>      // These are SET by Next_Code_Record. You may GET their values
31707>>>>>>>>>      Property String  Current_Code         ''
31708>>>>>>>>>      Property String  Current_Description  ''
31709>>>>>>>>>  End_Procedure // Construct_Object
31710>>>>>>>>>
31710>>>>>>>>>  // If a Type exists (not a '') and there is a type field and a
31710>>>>>>>>>  // main_file constrain to the type. Else no constraints
31710>>>>>>>>>  Begin_Constraints
31712>>>>>>>>>     String sType
31712>>>>>>>>>     Integer iFile iField
31712>>>>>>>>>     Get Type_Value to sType
31713>>>>>>>>>     Get Main_File  to iFile
31714>>>>>>>>>     Get Type_Field to iField
31715>>>>>>>>>     If (sType<>'' AND iFile<>0 AND iField<>0) ;        VConstrain iFile iField eq sType
31720>>>>>>>>>  End_Constraints
31723>>>>>>>>>
31723>>>>>>>>>  //  This initializes the data-set for finding. You MUST pass all five
31723>>>>>>>>>  //  parameters here. They are:
31723>>>>>>>>>  //     File#  -  main file to use
31723>>>>>>>>>  //    Index#  - Index to use for finding
31723>>>>>>>>>  //     Code#  - field number of the code
31723>>>>>>>>>  //     Desc#  - field number of the code's description
31723>>>>>>>>>  //     Type#  - field number of the constraining Type (0 if none)
31723>>>>>>>>>  //      Type  - the constrain type value ('' = allow all records)
31723>>>>>>>>>  //
31723>>>>>>>>>  Procedure Initialize_File Integer File# Integer Index# Integer Code# ;                            Integer Desc# Integer Type# String Type
31725>>>>>>>>>     // note: all params are required!
31725>>>>>>>>>     Set Main_File         to File#
31726>>>>>>>>>     Set Ordering          to Index#
31727>>>>>>>>>     Set Code_Field        to Code#
31728>>>>>>>>>     Set Description_Field to Desc#
31729>>>>>>>>>     Set Type_Field        to Type#
31730>>>>>>>>>     Set Type_Value        to Type
31731>>>>>>>>>     //
31731>>>>>>>>>     Send Rebuild_Constraints // set up constraints
31732>>>>>>>>>     Send Clear               // initialize the file
31733>>>>>>>>>  End_Procedure
31734>>>>>>>>>
31734>>>>>>>>>  //  Find the next record: Return 0 if no record, 1 if record exists
31734>>>>>>>>>  //   if record exists set Current_Code and Current_Description
31734>>>>>>>>>  //
31734>>>>>>>>>  Function Next_Code_Record Returns boolean
31736>>>>>>>>>     integer iFile iField
31736>>>>>>>>>     string sValue
31736>>>>>>>>>     Send Request_Find GT (Main_File(self)) (Ordering(self))
31737>>>>>>>>>     If not (Found) Function_Return false
31740>>>>>>>>>     // Set properties Current_code and Current_Description
31740>>>>>>>>>     Get Main_File to iFile
31741>>>>>>>>>
31741>>>>>>>>>     Get Code_Field to iField
31742>>>>>>>>>     Get_Field_Value iFile iField to sValue
31745>>>>>>>>>     Set Current_Code to sValue
31746>>>>>>>>>
31746>>>>>>>>>     Get Description_Field to iField
31747>>>>>>>>>     Get_Field_Value iFile iField to sValue
31750>>>>>>>>>     Set Current_Description to sValue
31751>>>>>>>>>     Function_return True
31752>>>>>>>>>  End_Function // Function
31753>>>>>>>>>
31753>>>>>>>>>End_Class
31754>>>>>>>Use cCodeMaintOpen_Mixin.pkg
Including file: cCodeMaintOpen_Mixin.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCodeMaintOpen_Mixin.pkg)
31754>>>>>>>>>// Mixin class to support transistion support for CodeType and CodeMast files.
31754>>>>>>>>>// These files used to be in filelist and they used to reside at 207 and 208 and they
31754>>>>>>>>>// were always opened with "open as"
31754>>>>>>>>>// We want these to be in the filelist at 253 and 254. These open methods will attempt to open these files
31754>>>>>>>>>// as such. If these are old files (not in filelist or wrong number) they will get loaded with the old
31754>>>>>>>>>// open as - thus keeping this backwards compatible.
31754>>>>>>>>>// By adding to filelist, we can sort the files and we can open them as other database sources.
31754>>>>>>>>>use VDFBase.pkg
31754>>>>>>>>>
31754>>>>>>>>>Declare_DataFile CodeType
Including file: CodeType.fd    (C:\Projects\DF18\DbUpdateFramework\DDSrc\CodeType.fd)
31754>>>>>>>>>Declare_DataFile CodeMast
Including file: CodeMast.fd    (C:\Projects\DF18\DbUpdateFramework\DDSrc\CodeMast.fd)
31754>>>>>>>>>Define C_Expected_CodeType_FileNumber for 253  // and the logical name must be CODETYPE
31754>>>>>>>>>Define C_Expected_CodeMast_FileNumber for 254  // and the logical name must be CODEMAST
31754>>>>>>>>>
31754>>>>>>>>>Class cCodeMaintOpen_Mixin is a Mixin
31755>>>>>>>>>
31755>>>>>>>>>    Procedure OpenCodeMast
31757>>>>>>>>>        string sName
31757>>>>>>>>>        If (Codemast.File_number=C_Expected_CodeMast_FileNumber) begin
31759>>>>>>>>>            get_attribute DF_FILE_LOGICAL_NAME of Codemast.File_number to sName
31762>>>>>>>>>            If (uppercase(trim(sName))="CODEMAST") begin
31764>>>>>>>>>                Open CodeMast
31766>>>>>>>>>                Procedure_return
31767>>>>>>>>>            end
31767>>>>>>>>>>
31767>>>>>>>>>        end
31767>>>>>>>>>>
31767>>>>>>>>>        Open "CodeMast" as Codemast.File_number
31769>>>>>>>>>    End_Procedure
31770>>>>>>>>>
31770>>>>>>>>>    Procedure OpenCodeType
31772>>>>>>>>>        string sName
31772>>>>>>>>>        If (Codetype.File_number=C_Expected_CodeType_FileNumber) begin
31774>>>>>>>>>            get_attribute DF_FILE_LOGICAL_NAME of CodeType.File_number to sName
31777>>>>>>>>>            If (uppercase(trim(sName))="CODETYPE") begin
31779>>>>>>>>>                Open CodeType
31781>>>>>>>>>                Procedure_return
31782>>>>>>>>>            end
31782>>>>>>>>>>
31782>>>>>>>>>        end
31782>>>>>>>>>>
31782>>>>>>>>>        Open "CodeType" as CodeType.File_number
31784>>>>>>>>>    End_Procedure
31785>>>>>>>>>
31785>>>>>>>>>End_Class
31786>>>>>>>
31786>>>>>>>  //
31786>>>>>>>  //  This is the object we need for loading files.
31786>>>>>>>  //
31786>>>>>>>  Object Code_loader is a Code_loader_Data_Set no_Image
31788>>>>>>>  End_Object
31789>>>>>>>
31789>>>>>>>
31789>>>>>>>Class CodeValidationTable is an FileValidationTable
31790>>>>>>>
31790>>>>>>>    // supports opening of file in reserved filelist area.
31790>>>>>>>    Import_Class_Protocol cCodeMaintOpen_Mixin
31791>>>>>>>
31791>>>>>>>    Procedure Construct_Object
31793>>>>>>>        Forward Send Construct_Object
31795>>>>>>>
31795>>>>>>>        Send OpenCodeMast                       // methods supports w/ filelist (new) and without (old)
31796>>>>>>>
31796>>>>>>>        Set Main_File to CodeMast.File_Number   // name of file is CODEMAST
31797>>>>>>>        Set Ordering to 1                       // Index 1: Types x Code
31798>>>>>>>        Set Type_Field to 1                     // Fld 1: Type
31799>>>>>>>        Set Code_Field to 2                     // Fld 2: Code
31800>>>>>>>        Set Description_Field to 3              // Fld 3: Description
31801>>>>>>>        Set Code_load_Object to (Code_Loader(self))
31802>>>>>>>    End_Procedure // Construct_Object
31803>>>>>>>
31803>>>>>>>End_Class
31804>>>>>>>
31804>>>>>>>
31804>>>>>
31804>>>>>// Used to by DDOConstraintFindMeta to return constraint expression info in a friendlier fashion
31804>>>>>Struct tDDOConstraintFindMeta
31804>>>>>    Integer iJumpInSegments
31804>>>>>    Boolean bJumpOut
31804>>>>>    Boolean bPreRelate
31804>>>>>    Boolean bPostRelate
31804>>>>>End_Struct
31804>>>>>
31804>>>>>Enum_List
31804>>>>>    Define CONST_EXP_JUMPOUT     for 1
31804>>>>>    Define CONST_EXP_PRE_RELATE  for 2
31804>>>>>    Define CONST_EXP_POST_RELATE for 4
31804>>>>>End_Enum_List
31804>>>>>
31804>>>>>// Constraint Find Types
31804>>>>>Enum_List
31804>>>>>    Define CONST_VALUE for 0    // Constrain File.Field eq sValue
31804>>>>>    Define CONST_CHILD          // Constrain File Relates to iOtherFile
31804>>>>>    Define CONST_FIELD          // Constrain File.field eq OtherFile.OtherField
31804>>>>>    Define CONST_EXP            // Constrain File as (Expression) - expression is internal
31804>>>>>    Define CONST_RELATES        // Sames a CONST_CHILD - should never be used
31804>>>>>End_Enum_List
31804>>>>>
31804>>>>>// Constraint Find Modes
31804>>>>>Enum_List
31804>>>>>    Define CONST_LT for 0
31804>>>>>    Define CONST_LE for 1
31804>>>>>    Define CONST_EQ for 2
31804>>>>>    Define CONST_GE for 3
31804>>>>>    Define CONST_GT for 4
31804>>>>>    Define CONST_NE for 5
31804>>>>>    Define CONST_Matches for 6       // a matches not capable of a jump in e.g., "?A*"
31804>>>>>    Define CONST_Contains for 7      // a contains 
31804>>>>>    Define CONST_MatchesJumpIn for 9 // a matches which is capable of a jump in e.g., "A*"
31804>>>>>    // note that BETWEEN is actually two constraints a GE and LE
31804>>>>>End_Enum_List
31804>>>>>
31804>>>>>// Struct used to DDOConstraints to return current constraints in an array
31804>>>>>Struct tConstraintDef
31804>>>>>    Integer eType // constraint Find type
31804>>>>>    Integer eMode // constrain file mode
31804>>>>>    Integer iFile
31804>>>>>    Integer iField
31804>>>>>    String sValue
31804>>>>>    Integer iOtherFile
31804>>>>>    Integer iOtherField
31804>>>>>End_Struct
31804>>>>>
31804>>>>>
31804>>>>>
31804>>>>>
31804>>>>>// values passed to OnPre/PostFind to indicate the operation type
31804>>>>>Enum_List 
31804>>>>>    Define DDFindRequestFind    // request_find
31804>>>>>    Define DDFindFindByRowRec   // FindByRowId, Find_By_Recnum
31804>>>>>    Define DDFindRequestAssign  // Request_assign  
31804>>>>>    Define DDFindClear          // Clear (note Clear_All doesn't do this)
31804>>>>>End_Enum_List
31804>>>>>
31804>>>>>
31804>>>>>// these are private
31804>>>>>Define DD_RememberLast for "_REMEMBER$LAST_"
31804>>>>>Use tDDRemembered.pkg
Including file: tDDRemembered.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\tDDRemembered.pkg)
31804>>>>>>>// DDRemember Struct used for DataDictionary Class
31804>>>>>>>
31804>>>>>>>// private
31804>>>>>>>
31804>>>>>>>Struct tDDRemembered
31804>>>>>>>    Integer iField // searches are performed on this segement - it must be first
31804>>>>>>>    String sDefault
31804>>>>>>>    String sLastValue
31804>>>>>>>End_Struct
31804>>>>>>>
31804>>>>>
31804>>>>>// Used to assign a global validation_object. This can be used for
31804>>>>>// automatic prompt object on non-relational validations (checks, validation_
31804>>>>>// tables, etc.)
31804>>>>>Integer DD_Global_Validation_Prompt_Object
31804>>>>>Move 0 to DD_Global_Validation_Prompt_Object
31805>>>>>
31805>>>>>// Used for Dso traversal marking - Private (do not use)
31805>>>>>Integer   DD_Current_Mark_Id
31805>>>>>Move 0 to DD_Current_Mark_Id
31806>>>>>
31806>>>>>// Used to validate DSO structures during Save and deletes
31806>>>>>Enumeration_List
31806>>>>>  Define DD_VALIDATE_STRUCTURE_ALWAYS // Validate each save/delete operation.
31806>>>>>  Define DD_VALIDATE_STRUCTURE_NEVER  // Never validate these operations.
31806>>>>>  Define DD_VALIDATE_STRUCTURE_ONCE   // Validate Once (first save or delete).
31806>>>>>End_Enumeration_List
31806>>>>>
31806>>>>>// Used as a start for error handing in DSOs. Only affects errors that go
31806>>>>>// through operation_not_allowed and Field_Error. Used by Error_Report_Mode
31806>>>>>Enumeration_List
31806>>>>>  Define DD_ERROR_REPORT              // Report Error on screen
31806>>>>>  Define DD_ERROR_NO_REPORT           // Show no Error..
31806>>>>>End_Enumeration_List
31806>>>>>
31806>>>>>Enumeration_List
31806>>>>>  Define DD_Lock_on_All             for  7  // 111
31806>>>>>  Define DD_Lock_on_New_Save_Delete for  5  // 101
31806>>>>>  Define DD_Lock_on_Delete          for  4  // 100
31806>>>>>  Define DD_Lock_on_Save            for  2  // 010
31806>>>>>  Define DD_Lock_on_New_Save        for  1  // 001
31806>>>>>End_Enumeration_List
31806>>>>>
31806>>>>>
31806>>>>>Define DD_DEFAULT_ERROR_NUMBER  for 999
31806>>>>>
31806>>>>>
31806>>>>>// This table gives an overview of the Item_Options property of an item.
31806>>>>>//
31806>>>>>// AUTOFIND-------------------------------------------------------------------+
31806>>>>>// FINDREQ------------------------------------------------------------------+ |
31806>>>>>// NOPUT------------------------------------------------------------------+ | |
31806>>>>>// NOENTER--------------------------------------------------------------+ | | |
31806>>>>>//                                                                      | | | |
31806>>>>>// SKIPFOUND---------------------------------------------------------+  | | | |
31806>>>>>// RETAIN----------------------------------------------------------+ |  | | | |
31806>>>>>// RETAINALL-----------------------------------------------------+ | |  | | | |
31806>>>>>// FORCEPUT----------------------------------------------------+ | | |  | | | |
31806>>>>>//                                                             | | | |  | | | |
31806>>>>>// AUTOFIND_GE----------------------------------------------------------------|
31806>>>>>//                                                          |  | | | |  | | | |
31806>>>>>// REQUIRED---------------------------+                     |  | | | |  | | | |
31806>>>>>// CAPSLOCK-------------------------+ |                     |  | | | |  | | | |
31806>>>>>//                                  | |                     |  | | | |  | | | |
31806>>>>>// ZERO_SUPPRESS-----------------+  | |                     |  | | | |  | | | |
31806>>>>>//                               |  | |                     |  | | | |  | | | |
31806>>>>>// AUTORETURN-----------+        |  | |                     |  | | | |  | | | |
31806>>>>>// AUTOBACK-----------+ |        |  | |                     |  | | | |  | | | |
31806>>>>>// COMMIT (NOCALC)+   | |        |  | |                     |  | | | |  | | | |
31806>>>>>// AUTOCLEAR-+    |   | |        |  | |                     |  | | | |  | | | |
31806>>>>>//           |    |   | |        |  | |                     |  | | | |  | | | |
31806>>>>>//      |x|x|||x||||x||||||x|x|x||||||||x|x||x|x|x|x||x|x|x|||||||||||||||||||||
31806>>>>>//      | | | | || | | | || | | | || | | | || | | | || | | | || | | | || | | | |
31806>>>>>//      |3|3|2|2||2|2|2|2||2|2|2|2||1|1|1|1||1|1|1|1||1|1| | || | | | || | | | |
31806>>>>>//      |1|0|9|8||7|6|5|4||3|2|1|0||9|8|7|6||5|4|3|2||1|0|9|8||7|6|5|4||3|2|1|0|
31806>>>>>
31806>>>>>
31806>>>>>
31806>>>>>// The next replaces will be used to indicate default item-options
31806>>>>>// instead of a fieldnumber which is normally used.
31806>>>>>
31806>>>>>// these are the DD bits that pertain to DEO Item options.
31806>>>>>Define DD_DEO_MASK for (DD_NOENTER ior DD_SKIPFOUND ior DD_CAPSLOCK ior DD_ZERO_SUPPRESS ior DD_AUTORETURN ior DD_AUTOBACK ior DD_AUTOCLEAR)
31806>>>>>
31806>>>>>
31806>>>>>// Special parameter options that can get passed to Set Field_Options. The
31806>>>>>// purpose is to clear all fields or the remaining passed parameters. Normally,
31806>>>>>// these are not used so it does not matter if their interface is a bit odd.
31806>>>>>Enumeration_list
31806>>>>>   Define DD_CLEAR_FIELD_OPTIONS      for -1
31806>>>>>   Define DD_CLEAR_ALL_FIELD_OPTIONS  for -2
31806>>>>>End_Enumeration_list
31806>>>>>
31806>>>>>// used to keep track of extra server file information.
31806>>>>>Struct tDDServerInformation
31806>>>>>    Integer iParent             // parent file number
31806>>>>>    Boolean bAllowNullParent    // does this DD (child) allow a null parent
31806>>>>>    Integer bParentNoSwitchIfCommitted // does this DD (child) allow switching committed parents
31806>>>>>    Boolean bNoCascadeDelete           // when a child record exists should cascade delete stop the action
31806>>>>>    Boolean bCascadeDeleteNullTheParent // when a child record exists that is null parent allowed, should we delete or null the parent
31806>>>>>End_Struct
31806>>>>>
31806>>>>>Use DDExtFld.pkg // adds extended field/pointer support
Including file: DDExtFld.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DDExtFld.pkg)
31806>>>>>>>//****************************************************************************//
31806>>>>>>>//                                                                            //
31806>>>>>>>// $File name  : DDExtFld.pkg                                                 //
31806>>>>>>>// $File title : DD extended field objects                                    //
31806>>>>>>>// Notice      :                                                              //
31806>>>>>>>// $Author(s)  : John Tuohy                                                   //
31806>>>>>>>//                                                                            //
31806>>>>>>>//                                                                            //
31806>>>>>>>// Confidential Trade Secret.                                                 //
31806>>>>>>>// Copyright 1998-1999 Data Access Corporation, Miami FL, USA                 //
31806>>>>>>>// All Rights reserved                                                        //
31806>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.             //
31806>>>>>>>//                                                                            //
31806>>>>>>>// $Rev History                                                               //
31806>>>>>>>//                                                                            //
31806>>>>>>>// JJT   10/18/99 Fixed bug where string of lesser length was not updated     //
31806>>>>>>>// JJT   11/9/98  Added !zb code around conditionally created objects         //
31806>>>>>>>// JT   10/26/98 Added Set Field_pValue                                       //
31806>>>>>>>// JT    8/6/98  Added bShowErr to Field_pEntry (currently does nothing)      //
31806>>>>>>>// JW    7/10/98 Changed IF test in Field_pEntry where address type           //
31806>>>>>>>//               was used to integer type. It dose not work with address      //
31806>>>>>>>//               I did also remove some old debug code                        //
31806>>>>>>>//                                                                            //
31806>>>>>>>// JT   7/9/98   Added passed length to set field_pEntry                      //
31806>>>>>>>// JT  6/25/98   Moved into this package.                                     //                                                                           //
31806>>>>>>>//****************************************************************************//
31806>>>>>>>
31806>>>>>>>// This is used by the DataDictionary class and provides a method for
31806>>>>>>>// windows DDs (for now) to support local buffers for text and binary buffers.
31806>>>>>>>// Field objects are created within the DD by sending the message:
31806>>>>>>>// The DD interface is:
31806>>>>>>>//
31806>>>>>>>//      Get  Field_Object iField to hExtFieldObject
31806>>>>>>>//      Send DefineExtendedField iField
31806>>>>>>>//      Send DefineAllExtendedFields
31806>>>>>>>//      Send ExtendedFieldsUpdate bSave
31806>>>>>>>//      Send ExtendedFieldsRefresh bCleared
31806>>>>>>>//      Set  File_Field_Current_Pointer_Value iFile iField iLen to pValue
31806>>>>>>>//      Set  Field_Current_Pointer_Value iField iLen to pValue
31806>>>>>>>//      Set  File_Field_Pointer_Entry iFile iField iLen bShowErr to pValue
31806>>>>>>>//      Set  Field_Pointer_Entry iField iOpts iLen bShowErr to pValue
31806>>>>>>>//      Get  File_Field_Current_Pointer_Value iFile iField to pData
31806>>>>>>>//      Get  Field_Current_Pointer_Value iField to pData
31806>>>>>>>//
31806>>>>>>>// Once object is identified, the following interface can be used
31806>>>>>>>//      Get FieldPointer of hExtFieldObject to iMemoryPointer
31806>>>>>>>//      Get FieldLength  of hExtFieldObject to iLen
31806>>>>>>>//      Get File_Number  of hExtFieldObject to iFile
31806>>>>>>>//      Get Field_Number of hExtFieldObject to iFile
31806>>>>>>>//      Set Update_Save_State of hExtFieldObject to bState         // be careful!
31806>>>>>>>//      Set Update_Find_State of hExtFieldObject to bState         // be careful
31806>>>>>>>//      Set FieldRefresh_Save_State of hExtFieldObject to bState   // be careful
31806>>>>>>>//
31806>>>>>>>
31806>>>>>>>//
31806>>>>>>>//  DD structure:
31806>>>>>>>//       DD Object           (property Field_objects points to child)
31806>>>>>>>//           FieldObjects    (array of field#s and field objs)
31806>>>>>>>//              FieldObject1 (heap alloc for each field)
31806>>>>>>>//              FieldObjectn
31806>>>>>>>//
31806>>>>>>>
31806>>>>>>>//
31806>>>>>>>// This is used to create a single extended field object.
31806>>>>>>>//
31806>>>>>>>// Interface
31806>>>>>>>//      Get FieldPointer to iMemoryPointer
31806>>>>>>>//      Get FieldLength  to iLen
31806>>>>>>>//      Get File_Number  to iFile
31806>>>>>>>//      Get Field_Number to iFile
31806>>>>>>>//      get/Set Update_Save_State to bState         // be careful!
31806>>>>>>>//      get/Set Update_Find_State to bState         // be careful
31806>>>>>>>//      get/Set FieldRefresh_Save_State to bState   // be careful
31806>>>>>>>//      get/set FieldChangedState
31806>>>>>>>//      send defineField  iFile iField
31806>>>>>>>//      Send FieldUpdate  bSave
31806>>>>>>>//      Send FieldRefresh bCleared bClearFieldChange
31806>>>>>>>//      Set  Field_pEntry iOpts iLen to pValue
31806>>>>>>>//      Set  Field_pValue iLen to pValue
31806>>>>>>>//
31806>>>>>>>Use VDFBase.pkg
31806>>>>>>>
31806>>>>>>>Class FieldObject is a cObject
31807>>>>>>>
31807>>>>>>>    Procedure Construct_Object
31809>>>>>>>        Forward Send construct_object
31811>>>>>>>        // these are all set by DefineField and should not be changed
31811>>>>>>>        Property Integer File_Number        0
31812>>>>>>>        Property Integer Field_Number       0
31813>>>>>>>        Property Integer FieldLength        0
31814>>>>>>>        
31814>>>>>>>        // maintained by object
31814>>>>>>>        Property UChar[] pFieldArray
31815>>>>>>>
31815>>>>>>>        // these can be changed, with care, by the developer
31815>>>>>>>        Property Integer Update_Save_State  True
31816>>>>>>>        Property Integer Update_Find_State  False // usually no point for finds
31817>>>>>>>        Property Integer FieldRefresh_State True
31818>>>>>>>
31818>>>>>>>        // hopefully never used
31818>>>>>>>        Property Address pLegacyFieldPointer       0
31819>>>>>>>
31819>>>>>>>    End_Procedure
31820>>>>>>>
31820>>>>>>>    Procedure Set FieldChangedState Integer bState
31822>>>>>>>       Integer iField
31822>>>>>>>       Get Field_Number to iField
31823>>>>>>>       Delegate Set Field_Changed_state iField to bState
31825>>>>>>>    End_Procedure
31826>>>>>>>
31826>>>>>>>    Function FieldChangedState Returns Integer
31828>>>>>>>       Integer iField  bState
31828>>>>>>>       Get Field_Number to iField
31829>>>>>>>       Delegate Get Field_Changed_state iField to bState
31831>>>>>>>       Function_Return bState
31832>>>>>>>    End_Function
31833>>>>>>>
31833>>>>>>>    // return the field option specified
31833>>>>>>>    Function IsSaveNoPut Returns Boolean
31835>>>>>>>       Integer iField
31835>>>>>>>       Boolean  bState
31835>>>>>>>       Get Field_Number to iField
31836>>>>>>>       Delegate Get FieldSaveNoPut iField to bState
31838>>>>>>>       Function_Return bState
31839>>>>>>>    End_Function
31840>>>>>>>
31840>>>>>>>    // for object: define file, field, fieldlength and allocate heap memory
31840>>>>>>>    //             and set memory pointer
31840>>>>>>>    Procedure DefineField Integer iFile Integer iField
31842>>>>>>>        Integer iFldLen
31842>>>>>>>        Set File_Number  to iFile
31843>>>>>>>        Set Field_Number to iField
31844>>>>>>>        Get_Attribute DF_FIELD_LENGTH of iFile iField to iFldLen
31847>>>>>>>        Set FieldLength  to iFldLen
31848>>>>>>>    End_Procedure
31849>>>>>>>    
31849>>>>>>>    // Move from the DD Buffer to the file buffer
31849>>>>>>>    Procedure FieldUpdate Integer bSave
31851>>>>>>>        Integer iFile iField iFieldLen
31851>>>>>>>        UChar[] FieldArray
31852>>>>>>>        Integer iType
31852>>>>>>>        Boolean bNoPut
31852>>>>>>>
31852>>>>>>>        // if bSave, part of save which means only update if changed
31852>>>>>>>        // if not bsave, part of find. You usually would not update this. You
31852>>>>>>>        // don't index on these types of fields
31852>>>>>>>        If ( (bSave and Update_Save_State(Self) and FieldChangedState(Self)) or ;             (not(bSave) and Update_Find_state(Self) ) ) Begin
31854>>>>>>>            // if save, we must respect DD_NoPut
31854>>>>>>>            If (bSave) Begin
31856>>>>>>>                // we are looking at the DD's field buffer itemoptions for, which
31856>>>>>>>                // should be set appropriately before a save. This setting has any
31856>>>>>>>                // changes made to support dd_commit
31856>>>>>>>                Get IsSaveNoPut to bNoPut                
31857>>>>>>>                If bNoPut Begin
31859>>>>>>>                    Procedure_Return
31860>>>>>>>                End
31860>>>>>>>>
31860>>>>>>>            End
31860>>>>>>>>
31860>>>>>>>            Get pFieldArray to FieldArray
31861>>>>>>>            Get File_Number to iFile
31862>>>>>>>            Get Field_Number to iField
31863>>>>>>>            If iFile Begin
31865>>>>>>>                Set_Field_Value iFile iField to FieldArray // LENGTH iFieldLen
31868>>>>>>>            End
31868>>>>>>>>
31868>>>>>>>        End
31868>>>>>>>>
31868>>>>>>>    End_Procedure
31869>>>>>>>
31869>>>>>>>    // Move from File buffer to local DD Buffer
31869>>>>>>>    // bCleared determines if this is a find or a clear.
31869>>>>>>>    // bClearFieldChange determines if we should clear the FieldChangedState.
31869>>>>>>>    Procedure FieldRefresh Boolean bCleared Boolean bClearFieldChange
31871>>>>>>>        Integer iFile iField
31871>>>>>>>        Integer bOk
31871>>>>>>>        UChar[] FieldArray
31872>>>>>>>        If (FieldRefresh_state(Self)) Begin
31874>>>>>>>            //Get FieldPointer to pField
31874>>>>>>>            Get File_Number to iFile
31875>>>>>>>            Get Field_Number to iField
31876>>>>>>>            // move from file buffer to memory pointed to by pField
31876>>>>>>>            If (iFile) Begin
31878>>>>>>>                If not bCleared Begin
31880>>>>>>>                   Get_Field_Value iFile iField to FieldArray
31883>>>>>>>                End
31883>>>>>>>>
31883>>>>>>>                Set Field_UCValue to FieldArray
31884>>>>>>>            End
31884>>>>>>>>
31884>>>>>>>        End
31884>>>>>>>>
31884>>>>>>>        If bClearFieldChange Begin
31886>>>>>>>            Set FieldChangedstate to False
31887>>>>>>>        End
31887>>>>>>>>
31887>>>>>>>    End_Procedure
31888>>>>>>>
31888>>>>>>>    Procedure Set Field_pEntry Integer iOpts Integer iLen Integer bShowErr Address pValue
31890>>>>>>>        Integer iFile iField iFldLen iMemLen
31890>>>>>>>        Integer bChanged
31890>>>>>>>        UChar[] FieldArray
31891>>>>>>>
31891>>>>>>>        // currently we do nothing with bShowErr because we don't checkfor errors!
31891>>>>>>>
31891>>>>>>>        // if No-enter or Displayonly, this shouldn't be changed. For now we will
31891>>>>>>>        // let NoPut through, since a user might need it for finding.
31891>>>>>>>        If (iOpts iand DD_NOENTER) Procedure_Return
31894>>>>>>>
31894>>>>>>>        // maybe in the future
31894>>>>>>>        // Force a caplsock if required
31894>>>>>>>        //If (iOpts IAND DD_CAPSLOCK) Move (Uppercase(sValue)) to sValue
31894>>>>>>>
31894>>>>>>>        Get File_Number  to iFile
31895>>>>>>>        Get Field_Number to iField
31896>>>>>>>        If (iFile) Begin
31898>>>>>>>            Get Is_pValueChanged iLen pValue to bChanged
31899>>>>>>>            If ( bChanged or (iOpts iand DD_FORCEPUT) ) Begin
31901>>>>>>>                Set Field_pValue iLen to pValue
31902>>>>>>>            End
31902>>>>>>>>
31902>>>>>>>
31902>>>>>>>            
31902>>>>>>>            // Set changed state if changed and it is not No_put. This
31902>>>>>>>            // is an improvement on DEOs which would set changed-state for
31902>>>>>>>            // a no-put. This way, finds use the changed value but saves will
31902>>>>>>>            // not trigger a phony data loss
31902>>>>>>>            //If ( bChanged ) ;
31902>>>>>>>            If ( bChanged and not(iOpts iand DD_NOPUT) ) ;                Set FieldChangedState to True
31905>>>>>>>
31905>>>>>>>            // The following is really highly unlikely!!!
31905>>>>>>>            // perform autofinds if needed. Note that required checking will occur as
31905>>>>>>>            // part of validation.
31905>>>>>>>            // We will only autofind if the field value is changed. This is consistent with
31905>>>>>>>            // DEOs which do not autofind on unchanged values. This provides optimizations
31905>>>>>>>            // when a parent record is already loaded.
31905>>>>>>>            If (bChanged or FieldChangedState(Self)) Begin
31907>>>>>>>                If (iOpts iand DD_AUTOFIND)         Delegate Send File_Field_AutoFind iFile iField EQ
31911>>>>>>>                Else If (iOpts iand DD_AUTOFIND_GE) Delegate Send File_Field_AutoFind iFile iField GE
31916>>>>>>>            End
31916>>>>>>>>
31916>>>>>>>        End
31916>>>>>>>>
31916>>>>>>>
31916>>>>>>>    End_Procedure
31917>>>>>>>
31917>>>>>>>    // convert pointer to UChar[]
31917>>>>>>>    Function PointerToUCharArray Address pValue Integer iLen Returns UChar[]
31919>>>>>>>        UChar[] FieldArray
31920>>>>>>>        Boolean bOk
31920>>>>>>>        Move (ResizeArray(FieldArray,iLen)) to FieldArray
31921>>>>>>>        Move (MemCopy(AddressOf(FieldArray),pValue,iLen)) to bOK
31922>>>>>>>        Function_Return FieldArray
31923>>>>>>>    End_Function
31924>>>>>>>
31924>>>>>>>    // Raw update of pValue
31924>>>>>>>    Procedure Set Field_UCValue UChar[] FieldArray
31926>>>>>>>        Set pFieldArray to FieldArray
31927>>>>>>>        Send DestroyLegacyFieldHeap
31928>>>>>>>    End_Procedure
31929>>>>>>>
31929>>>>>>>    // Raw update of pValue
31929>>>>>>>    Procedure Set Field_pValue Integer iLen Address pValue
31931>>>>>>>        UChar[] FieldArray
31932>>>>>>>        Get PointerToUCharArray pValue iLen to FieldArray
31933>>>>>>>        Set Field_UCValue to FieldArray
31934>>>>>>>    End_Procedure
31935>>>>>>>
31935>>>>>>>    Function Is_pValueChanged Integer iLen Address pValue Returns Boolean
31937>>>>>>>        Boolean bChanged
31937>>>>>>>        UChar[] FieldArray
31938>>>>>>>        Integer iFldLen
31938>>>>>>>        Get pFieldArray to FieldArray
31939>>>>>>>        Move (SizeOfArray(FieldArray)) to iFldLen
31940>>>>>>>        If (iLen <> SizeOfArray(FieldArray)) Begin
31942>>>>>>>             Move True to bChanged
31943>>>>>>>        End
31943>>>>>>>>
31943>>>>>>>        Else If (iLen) Begin // check for empty pointer
31946>>>>>>>             Move (MemCompare(AddressOf(FieldArray),pValue,iLen)) to bChanged
31947>>>>>>>        End
31947>>>>>>>>
31947>>>>>>>        Function_Return bChanged
31948>>>>>>>    End_Function
31949>>>>>>>    
31949>>>>>>>    // returns data as UChar array - best way to access the data
31949>>>>>>>    Function FieldArray Returns UChar[]
31951>>>>>>>        UChar[] FieldArray
31952>>>>>>>        Get pFieldArray to FieldArray
31953>>>>>>>        Function_Return FieldArray
31954>>>>>>>    End_Function
31955>>>>>>>
31955>>>>>>>    // legacy method. Hopefully this is never called.
31955>>>>>>>    Function FieldPointer Returns Address
31957>>>>>>>        Address pValue pOldValue
31957>>>>>>>        Integer iLen
31957>>>>>>>        UChar[] FieldArray
31958>>>>>>>        Boolean bOk
31958>>>>>>>        Get pFieldArray to FieldArray
31959>>>>>>>        Move (SizeOfArray(FieldArray)) to iLen
31960>>>>>>>        Move (Alloc(iLen)) to pValue
31961>>>>>>>        Move (MemCopy(pValue,AddressOf(FieldArray),iLen)) to bOk
31962>>>>>>>        Send DestroyLegacyFieldHeap
31963>>>>>>>        Set pLegacyFieldPointer to pValue
31964>>>>>>>        Function_Return pValue   
31965>>>>>>>    End_Function
31966>>>>>>>    
31966>>>>>>>    Procedure DestroyLegacyFieldHeap
31968>>>>>>>        Integer bOK
31968>>>>>>>        Address pField
31968>>>>>>>        Get pLegacyFieldPointer to pField
31969>>>>>>>        If (pField ) Begin
31971>>>>>>>           Move (Free(pField)) to bOk
31972>>>>>>>           Set pLegacyFieldPointer to 0
31973>>>>>>>        End
31973>>>>>>>>
31973>>>>>>>    End_Procedure
31974>>>>>>>
31974>>>>>>>    // augment to release heap allocation
31974>>>>>>>    Procedure Destroy_Object
31976>>>>>>>        Send DestroyLegacyFieldHeap
31977>>>>>>>        Forward Send Destroy_object
31979>>>>>>>    End_Procedure
31980>>>>>>>
31980>>>>>>>End_Class
31981>>>>>>>
31981>>>>>>>// This contains all extended field objects.
31981>>>>>>>// The array contains a list of all objects where item=field#
31981>>>>>>>// and item+1=field object.
31981>>>>>>>//
31981>>>>>>>// Interface is:
31981>>>>>>>//     Get Field_object iField to hFldObj
31981>>>>>>>//     Send DefineFieldObject iField
31981>>>>>>>//     Send ExtendedFieldsUpdate bSave
31981>>>>>>>//     Send ExtendedFieldsRefresh bCleared
31981>>>>>>>//
31981>>>>>>>Class FieldObjects is an Array 
31982>>>>>>>
31982>>>>>>>    // return object Id for iField. 0 if none.
31982>>>>>>>    Function Field_Object Integer iField Returns Integer
31984>>>>>>>        Integer iItm iCnt
31984>>>>>>>        Get Item_Count to iCnt
31985>>>>>>>        Move 0 to iItm
31986>>>>>>>        While iItm lt iCnt
31990>>>>>>>            If (Value(Self,iItm)=iField) ;               Function_Return (Value(Self,iItm+1))
31993>>>>>>>            Increment iItm
31994>>>>>>>            Increment iItm
31995>>>>>>>        Loop
31996>>>>>>>>
31996>>>>>>>        Function_Return 0
31997>>>>>>>    End_Function
31998>>>>>>>
31998>>>>>>>    // define an extended object for field
31998>>>>>>>    Procedure DefineFieldObject Integer iField
32000>>>>>>>        Integer hFld
32000>>>>>>>        Integer iCnt  iFile
32000>>>>>>>        Boolean bInUse
32000>>>>>>>        Boolean bHasRecord
32000>>>>>>>        Delegate Get Main_File to iFile
32002>>>>>>>        Get Field_Object iField to hFld // this shouldn't exist yet
32003>>>>>>>        If not hFld Begin
32005>>>>>>>           Get Create U_FieldObject to hFld
32006>>>>>>>           Send DefineField to hFld iFile iField
32007>>>>>>>           Get Item_Count to iCnt          // add to array
32008>>>>>>>           Set Value item iCnt to iField   // Pos   = field#
32009>>>>>>>           Set Value item (iCnt+1) to hFld // Pos+1 = field object
32010>>>>>>>           Delegate Get In_Use_State to bInUse
32012>>>>>>>           If bInUse Begin
32014>>>>>>>               Delegate Send Refind_Records
32016>>>>>>>               Delegate Get HasRecord to bHasRecord
32018>>>>>>>               // updating the newly created field with the file buffer contents we don't
32018>>>>>>>               // want to change the field's changed state, which might have been set already.
32018>>>>>>>               Send FieldRefresh of hFld (not(bHasRecord)) False
32019>>>>>>>           End
32019>>>>>>>>
32019>>>>>>>        End
32019>>>>>>>>
32019>>>>>>>    End_Procedure
32020>>>>>>>
32020>>>>>>>    // update all extended fields. Field buffer <-- DD buffer
32020>>>>>>>    Procedure ExtendedFieldsUpdate Integer bSave
32022>>>>>>>        Integer iItm iCnt
32022>>>>>>>        Get Item_Count to iCnt
32023>>>>>>>        Move 0 to iItm
32024>>>>>>>        While iItm lt iCnt
32028>>>>>>>            Increment iItm
32029>>>>>>>            Send FieldUpdate to (Value(Self,iItm)) bSave
32030>>>>>>>            Increment iItm
32031>>>>>>>        Loop
32032>>>>>>>>
32032>>>>>>>    End_Procedure
32033>>>>>>>
32033>>>>>>>    // refresh all extended fields. Field buffer --> DD buffer
32033>>>>>>>    Procedure ExtendedFieldsRefresh Boolean bCleared
32035>>>>>>>        Integer iItm iCnt
32035>>>>>>>        Get Item_Count to iCnt
32036>>>>>>>        Move 0 to iItm
32037>>>>>>>        While iItm lt iCnt
32041>>>>>>>            Increment iItm
32042>>>>>>>            Send FieldRefresh to (Value(Self,iItm)) bCleared True
32043>>>>>>>            Increment iItm
32044>>>>>>>        Loop
32045>>>>>>>>
32045>>>>>>>    End_Procedure
32046>>>>>>>
32046>>>>>>>    //
32046>>>>>>>    // these are sent from the child field object. We need to direct them
32046>>>>>>>    // to the DDO (the parent).
32046>>>>>>>    Procedure Set Field_Changed_State Integer iField Integer bState
32048>>>>>>>       Delegate Set Field_Changed_state iField to bState
32050>>>>>>>    End_Procedure
32051>>>>>>>
32051>>>>>>>    Function Field_Changed_State Integer iField Returns Integer
32053>>>>>>>       Integer bState
32053>>>>>>>       Delegate Get Field_Changed_state iField to bState
32055>>>>>>>       Function_Return bState
32056>>>>>>>    End_Function
32057>>>>>>>
32057>>>>>>>    Procedure File_Field_AutoFind Integer iFile Integer iField Integer iMode
32059>>>>>>>       Delegate Send File_field_AutoFind iFile iField iMode
32061>>>>>>>    End_Procedure
32062>>>>>>>
32062>>>>>>>    Function FieldSaveNoPut Integer iField Returns Boolean
32064>>>>>>>        Boolean bIsCommited bNoPut
32064>>>>>>>        Delegate Get IsCommitted to bIsCommited
32066>>>>>>>        // we don't know if this is foreign or not (DDOs never do by themselves). We
32066>>>>>>>        // will test for regular. This should never be an issue as the DEO itself
32066>>>>>>>        // will be DisplayOnly as needed (we don't have indexed NoEnter=T/Noput=F issues)
32066>>>>>>>        Delegate Get FieldNoPut iField bIsCommited False to bNoPut 
32068>>>>>>>        Function_Return bNoPut
32069>>>>>>>    End_Function
32070>>>>>>>
32070>>>>>>>    Procedure Destroy_Object
32072>>>>>>>       Delegate Set Field_Objects to 0
32074>>>>>>>       Forward Send Destroy_object
32076>>>>>>>    End_Procedure
32077>>>>>>>
32077>>>>>>>
32077>>>>>>>End_Class
32078>>>>>                 // for text and binary. Must support Address Type
32078>>>>>
32078>>>>>
32078>>>>>// we need these from CLI.pkg for DAW drivers. These values must match what is defined
32078>>>>>// in cli.pkg
32078>>>>>Define DF_FILE_SQL_FILTER for 611
32078>>>>>Define DF_FILE_SQL_FILTER_ACTIVE for 624
32078>>>>>Define DF_FILE_SQL_FILTER_EQ for 636
32078>>>>>// same a CLI.pkg DF_FILE_TABLE_NAME but with a different name
32078>>>>>// used to avoid naming conflict. Must match cli.pkg df_file_table_name
32078>>>>>Define DF_FILE_SQL_TABLE_NAME for 609
32078>>>>>
32078>>>>>
32078>>>>>// Class helper for SQL/driver assistance. 
32078>>>>>// This can only be used within a DataDictionary Class as it expects that
32078>>>>>// certain properties can be Get and Set via delegation.
32078>>>>>Class cDAWSQLDriverHelper is a cObject
32079>>>>>    
32079>>>>>    Function DriverIndex String sDriver Returns Integer
32081>>>>>        String  sCurrentDriver
32081>>>>>        Integer iNumberOfDrivers iDriver iCount
32081>>>>>        Move 0 to iDriver
32082>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
32085>>>>>        For iCount from 1 to iNumberOfDrivers
32091>>>>>>
32091>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
32094>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
32096>>>>>                Function_Return iCount
32097>>>>>            End
32097>>>>>>
32097>>>>>        Loop
32098>>>>>>
32098>>>>>        Function_Return 0
32099>>>>>    End_Function
32100>>>>>
32100>>>>>
32100>>>>>   // returns true if this table supports SQL filter interface 
32100>>>>>   Function SupportsSQLFilters Returns Boolean
32102>>>>>        String sDriver
32102>>>>>        Integer iFile iDriver iConformance
32102>>>>>        Delegate Get Main_File to iFile
32104>>>>>        Get_Attribute DF_FILE_DRIVER of iFile to sDriver
32107>>>>>        Get DriverIndex sDriver to iDriver
32108>>>>>        If (iDriver) Begin
32110>>>>>            Get_Attribute DF_DRIVER_CONFORMANCE of iDriver to iConformance
32113>>>>>        End
32113>>>>>>
32113>>>>>        Function_Return (iConformance iand 4)
32114>>>>>   End_Function
32115>>>>>   
32115>>>>>   // SQL Helper functions that return SQL Filters strings that can be used in a where clause
32115>>>>>
32115>>>>>    // Escape character to escape LIKE wildcards
32115>>>>>    //#Replace SQL_LIKE_ESC (Character(92))
32115>>>>>    //#Replace SQL_LIKE_ESC (Character(254))
32115>>>>>
32115>>>>>
32115>>>>>   Function SQLEscapedStr String sSQL Returns String
32117>>>>>       String sEscapedSQL
32117>>>>>       // Replace one single quote by 2 single quotes
32117>>>>>       Move (Replaces("'",sSQL,"''")) to sEscapedSQL
32118>>>>>       Function_Return sEscapedSQL        
32119>>>>>   End_Function
32120>>>>>
32120>>>>>
32120>>>>>   Function SQLEscapeLikeWildcards String sSQL Returns String
32122>>>>>
32122>>>>>       // Escape the wildcard characters than can be used in a LIKE
32122>>>>>       If (Pos("%",sSQL)) Move (Replaces("%",sSQL,(SQL_LIKE_ESC + "%"))) to sSQL
32125>>>>>       If (Pos("_",sSQL)) Move (Replaces("_",sSQL,(SQL_LIKE_ESC + "_"))) to sSQL
32128>>>>>        
32128>>>>>       Function_Return sSQL        
32129>>>>>   End_Function
32130>>>>>
32130>>>>>
32130>>>>>
32130>>>>>   // Creates an SQL Like Filter for this field and search target
32130>>>>>   Function SQLStrLike Integer iField String sSearch Returns String
32132>>>>>       String sFilter sOrigFilter sFileField
32132>>>>>       Integer iFile
32132>>>>>       Integer iHasLikeEscape
32132>>>>>       
32132>>>>>       Delegate Get Main_File to iFile
32134>>>>>       Delegate Get psSQLFilter to sOrigFilter
32136>>>>>       Get SQLStrFileFieldName iField to sFileField
32137>>>>>       Get SQLEscapedStr sSearch to sSearch
32138>>>>>       
32138>>>>>       Move (Pos(SQL_LIKE_ESC,sSearch)) to iHasLikeEscape
32139>>>>>       If (not(iHasLikeEscape)) Begin
32141>>>>>           Get SQLEscapeLikeWildcards sSearch to sSearch
32142>>>>>       End
32142>>>>>>
32142>>>>>
32142>>>>>       Move (sFileField + " LIKE '%" + sSearch + "%'") to sFilter
32143>>>>>
32143>>>>>        If (not(iHasLikeEscape)) Begin           
32145>>>>>            If (Pos(SQL_LIKE_ESC,sFilter)) Begin
32147>>>>>               Move (sFilter + " ESCAPE '" + SQL_LIKE_ESC + "' "  ) to sFilter
32148>>>>>            End
32148>>>>>>
32148>>>>>       End
32148>>>>>>
32148>>>>>       
32148>>>>>       Function_Return sFilter
32149>>>>>   End_Function
32150>>>>>       
32150>>>>>   // Appends two Filters with an AND clause. Both or either can be empty
32150>>>>>   Function SQLStrAppend String sOrigFilter String sFilter Returns String
32152>>>>>        If (sOrigFilter<>"" and sFilter<>"") Begin  
32154>>>>>//            Move (SFormat("(%1) AND %2", sOrigFilter, sFilter)) to sFilter
32154>>>>>            Move ( "(" + sOrigFilter + ") AND " + sFilter) to sFilter
32155>>>>>        End
32155>>>>>>
32155>>>>>        Else If (sFilter="") Begin
32158>>>>>            Move sOrigFilter to sFilter
32159>>>>>        End
32159>>>>>>
32159>>>>>        Function_Return sFilter    
32160>>>>>   End_Function
32161>>>>>   
32161>>>>>   // returns the name of the File and Field suitable for an SQL where statement
32161>>>>>   Function SQLStrFileFieldName Integer iField Returns String
32163>>>>>       String sFile sField
32163>>>>>       Integer iFile
32163>>>>>       Get Main_File to iFile
32164>>>>>       Get_Attribute DF_FILE_SQL_TABLE_NAME of iFile to sFile
32167>>>>>       Get_Attribute DF_FIELD_NAME of iFile iField to sField
32170>>>>>       //Function_Return (sFile + "." + sField)                        // Return Table.Column 
32170>>>>>       Function_Return ('"' + sFile + '"' + '.' + '"' + sField + '"' ) // Return "Table"."Column"
32171>>>>>       //Function_Return ('"' + sField + '"' )                         // Return "Column" 
32171>>>>>   End_Function
32172>>>>>
32172>>>>>   // called before an SQL Filter find. Make sure that any global and table attributes are
32172>>>>>   // stored. 
32172>>>>>   Procedure StoreDefaultSQLFilters
32174>>>>>        String sOldFilter
32174>>>>>        Boolean bOldFilterActive bOldFilterEQ
32174>>>>>        Integer iMain
32174>>>>>        Get Main_File to iMain
32175>>>>>        Get_Attribute DF_FILE_SQL_FILTER of iMain to sOldFilter
32178>>>>>        Get_Attribute DF_FILE_SQL_FILTER_ACTIVE of iMain to bOldFilterActive
32181>>>>>        Get_Attribute DF_FILE_SQL_FILTER_EQ of iMain to bOldFilterEQ
32184>>>>>        Delegate Set psOldFilter to sOldFilter
32186>>>>>        Delegate Set pbOldFilterActive to bOldFilterActive
32188>>>>>        Delegate Set pbOldFilterEq to bOldFilterEQ
32190>>>>>   End_Procedure
32191>>>>>    
32191>>>>>   // called after an SQL find. Must restore the global and table SQL filter attributes
32191>>>>>   Procedure RestoreDefaultSQLFilters
32193>>>>>        String sOldFilter
32193>>>>>        Boolean bOldFilterActive bOldFilterEQ
32193>>>>>        Integer iMain
32193>>>>>        Delegate Get Main_File to iMain
32195>>>>>        Delegate Get psOldFilter to sOldFilter
32197>>>>>        Delegate Get pbOldFilterActive to bOldFilterActive
32199>>>>>        Delegate Get pbOldFilterEq to bOldFilterEQ
32201>>>>>        Set_Attribute DF_FILE_SQL_FILTER of iMain to sOldFilter
32204>>>>>        Set_Attribute DF_FILE_SQL_FILTER_ACTIVE of iMain to bOldFilterActive
32207>>>>>        Set_Attribute DF_FILE_SQL_FILTER_EQ of iMain to bOldFilterEQ
32210>>>>>    End_Procedure
32211>>>>>    
32211>>>>>    // applies the passed SQL filter. If empty, it should make sure that no filter
32211>>>>>    // is applied. If non-empty it should set the filter active, set the filter string
32211>>>>>    // and make sure this is applied to all finds (including find EQ)
32211>>>>>    Procedure ApplySQLFilterStr String sFilter
32213>>>>>        Integer iMain
32213>>>>>        Delegate Get Main_File to iMain
32215>>>>>        If (sFilter<>"") Begin
32217>>>>>           Set_Attribute DF_FILE_SQL_FILTER_ACTIVE of iMain to True
32220>>>>>           Set_Attribute DF_FILE_SQL_FILTER of iMain to sFilter
32223>>>>>           Set_Attribute DF_FILE_SQL_FILTER_EQ of iMain to True
32226>>>>>        End
32226>>>>>>
32226>>>>>        Else Begin
32227>>>>>           Set_Attribute DF_FILE_SQL_FILTER_ACTIVE of iMain to False
32230>>>>>        End
32230>>>>>>
32230>>>>>    End_Procedure
32231>>>>>
32231>>>>>End_Class
32232>>>>>
32232>>>>>//**************************************************************************//
32232>>>>>//                                                                          //
32232>>>>>// RECORD_BUFFER                                                            //
32232>>>>>//                                                                          //
32232>>>>>// Every data_set will have a object based on this class. It will hold      //
32232>>>>>// the values for the fields, the entry_options and the messages IDs of the //
32232>>>>>// iEntry, iExit and iValidate messages for each field.                     //
32232>>>>>// It is assumed that an object of this class will always be used as a      //
32232>>>>>// child object of a Data_Set object.                                       //
32232>>>>>//                                                                          //
32232>>>>>// Currently the fieldtypes Overlap, Text and Binary are *not* supported.   //
32232>>>>>//                                                                          //
32232>>>>>// ITEM-PROPERTY   ASSIGNED-FUNCTION                                        //
32232>>>>>//                                                                          //
32232>>>>>// Value           The value of the field. Will be updated whenever the     //
32232>>>>>//                 value of a field changes due to data-entry or a found    //
32232>>>>>//                 record.                                                  //
32232>>>>>// Data_File       Contains the filenumber. Is the same for every item.     //
32232>>>>>// Data_Field      Contains the fieldnumber for the item. Is equal to the   //
32232>>>>>//                 items' itemnumber.                                       //
32232>>>>>// Item_Options    Used to store the standard item-options of a field.      //
32232>>>>>// Aux_Value       Used to store the foreign-item-options of a field.       //
32232>>>>>//                                                                          //
32232>>>>>//**************************************************************************//
32232>>>>>
32232>>>>>Class cRecordBuffer is an cDDBuffer
32233>>>>>
32233>>>>>  //************************************************************************//
32233>>>>>  // Create_Items.                                                          //
32233>>>>>  // This procedure will be called from the Data_Set when the Main_File is  //
32233>>>>>  // being set. It will create an item for each field of the file in this   //
32233>>>>>  // object. Fields of the types DF_OVERLAP, DF_TEXT and DF_BINARY are      //
32233>>>>>  // currently not added.                                                   //
32233>>>>>  //************************************************************************//
32233>>>>>
32233>>>>>  Procedure Create_Items Integer iFile
32235>>>>>    Integer iField_Count iField
32235>>>>>
32235>>>>>    Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iField_Count
32238>>>>>    Set Main_File to iFile
32239>>>>>    Send Delete_Data
32240>>>>>    Set Item_Count to (iField_Count+1)
32241>>>>>    For iField from 0 to iField_Count
32247>>>>>>
32247>>>>>      // will skip recnum (field 0) if non-recnum table
32247>>>>>      // will set to skip if binary, text or overlap  
32247>>>>>      Set Data_Field iField to iField
32248>>>>>    Loop
32249>>>>>>
32249>>>>>  End_Procedure
32250>>>>>  
32250>>>>>  // when an alias is created, we want to clear any values that will not be applied to
32250>>>>>  // this alias DD such as prompt and zoom objects (which would point to the superclass master)
32250>>>>>  Procedure ReDefineAliasItems Integer iFile
32252>>>>>    Integer i iItems
32252>>>>>
32252>>>>>    Set Main_File to iFile
32253>>>>>    Get item_count to iItems
32254>>>>>    For i from 0 to (iItems-1)
32260>>>>>>
32260>>>>>      Set Prompt_Object i to 0
32261>>>>>      Set Zoom_Object i to 0
32262>>>>>    Loop
32263>>>>>>
32263>>>>>  End_Procedure
32264>>>>>  
32264>>>>>
32264>>>>>  //************************************************************************//
32264>>>>>  // New_Current_Record.                                                    //
32264>>>>>  // This procedure will be called from the parent Data_Set whenever the    //
32264>>>>>  // Data_Set changes its Current_Record property, or after a Save, Delete  //
32264>>>>>  // or Clear operation.                                                    //
32264>>>>>  // We use this event to store the values of the fields in our local       //
32264>>>>>  // record buffer.                                                         //
32264>>>>>  //************************************************************************//
32264>>>>>
32264>>>>>  Procedure OnNewCurrentRecord RowID riOld RowID riNew
32266>>>>>    Integer iMain_File
32266>>>>>    Integer iOldState
32266>>>>>    tDDRemembered[] DefaultValues
32266>>>>>    tDDRemembered[] DefaultValues
32267>>>>>    Boolean bRetain bInReSync
32267>>>>>    Integer iFld iFlds iIndex
32267>>>>>    Handle hoDD
32267>>>>>
32267>>>>>    Get Parent to hoDD
32268>>>>>    Delegate Get Main_File to iMain_File
32270>>>>>    
32270>>>>>    If not (IsNullRowId(riNew)) ;      Send Entry_Display
32273>>>>>//      Send Entry_Display iMain_File True // TRUE means DisplayAll
32273>>>>>    Else Begin
32274>>>>>        
32274>>>>>      If (OPERATION_ORIGIN) Begin
32276>>>>>        // this gets set by webapp during a resync. During resyncs you don't want to rely
32276>>>>>        // on the values in the buffers (as they may not be yours) so you cannot do retain
32276>>>>>        // of rememberlast. Fortunately, you don't need to as this information is not
32276>>>>>        // needed during a resync.  
32276>>>>>        Get pbInResync of operation_origin to bInResync
32277>>>>>      End  
32277>>>>>>
32277>>>>>
32277>>>>>      // if we have any 17.0 Remember last value items, we must add those items to our array
32277>>>>>      // only do this if this is the operation origin or a parent (i.e., skip if a child DDO)
32277>>>>>      // Also skip if a resync. See above
32277>>>>>      If ( not(bInReSync) and ;          ( (Operation_Origin=hoDD) or ;             ( OPERATION_ORIGIN and (Which_data_set(Operation_Origin,iMain_File)<>0) ) ) ) Begin
32279>>>>>          Delegate Get pDDDefaults to DefaultValues
32281>>>>>          Move (SizeOfArray(DefaultValues)) to iFlds
32282>>>>>          For iFld from 0 to (iFlds-1)
32288>>>>>>
32288>>>>>              Move (DefaultValues[iFld].sDefault=DD_RememberLast) to bRetain // if this is a dynamically assigned remember-last
32289>>>>>// I don't think this test is needed              
32289>>>>>//              // if a parent DD and not allow-foreign we want to ignore this if this is not an indexed field (for autofind)
32289>>>>>//              If ( bRetain and (Operation_Origin<>hoDD) and not(Allow_Foreign_New_Save_State(hoDD))) Begin
32289>>>>>//                 Get_Attribute DF_FIELD_INDEX of iMain_File DefaultValues[iFld].iField to iIndex
32289>>>>>//                 Move (iIndex<>0) to bRetain
32289>>>>>//              End
32289>>>>>              If bRetain Begin
32291>>>>>                  Get Value DefaultValues[iFld].iField to DefaultValues[iFld].sLastValue
32292>>>>>              End
32292>>>>>>
32292>>>>>              Else Begin
32293>>>>>                  Move '' to DefaultValues[iFld].sLastValue
32294>>>>>              End
32294>>>>>>
32294>>>>>          Loop  
32295>>>>>>
32295>>>>>          Delegate Set pDDDefaults to DefaultValues
32297>>>>>      End
32297>>>>>>
32297>>>>>
32297>>>>>      // we must do this to make retains not set changed_state
32297>>>>>      Delegate Get Change_Disabled_State to iOldState
32299>>>>>      Delegate Set Change_Disabled_State to True
32301>>>>>      // if mode is anything other than clear we do a clear all (clear keeps retains, clear all does not)
32301>>>>>      // also do clear-all if the DDO is foreign.
32301>>>>>      
32301>>>>>      // If bInReSync, we never use retains as the buffer is not ours yet.
32301>>>>>      // The Entry_Clear, Entry_Clear_All parameter is bIgnoreRetains. 
32301>>>>>      // When True retain and retain_all states are ignored and cleared.
32301>>>>>      If (Operation_mode=MODE_CLEARING and ;           ( (Operation_Origin=parent(Self)) or ;             (Which_data_set(Operation_Origin,iMain_File)<>0) ) ) Begin
32303>>>>>          Send Entry_Clear bInReSync
32304>>>>>      End  
32304>>>>>>
32304>>>>>      Else Begin
32305>>>>>          Send Entry_Clear_all bInResync
32306>>>>>      End
32306>>>>>>
32306>>>>>      Delegate Set Change_Disabled_State to iOldState
32308>>>>>      Set Changed_State to False
32309>>>>>    End
32309>>>>>>
32309>>>>>  End_Procedure
32310>>>>>
32310>>>>>
32310>>>>>  //************************************************************************//
32310>>>>>  // Procedure Set Changed_State.                                           //
32310>>>>>  // Make sure to set the Changed_State of the Data_Set to TRUE when a      //
32310>>>>>  // field value changes and it's not during the Setting of the Defaults.   //
32310>>>>>  //************************************************************************//
32310>>>>>
32310>>>>>  Procedure Set Changed_State Integer iState
32312>>>>>    Integer iNoChange
32312>>>>>    // Server.pkg in dso already knows this property
32312>>>>>    Delegate Get Change_disabled_State to iNoChange
32314>>>>>    If not iNoChange Begin
32316>>>>>       Forward Set Changed_State to iState
32318>>>>>       //If iState ; // we should always delegate.
32318>>>>>          Delegate Set Changed_State to iState
32320>>>>>    End
32320>>>>>>
32320>>>>>  End_Procedure
32321>>>>>
32321>>>>>End_Class
32322>>>>>
32322>>>>>
32322>>>>>//**************************************************************************//
32322>>>>>//                                                                          //
32322>>>>>// FIELD_ATTRIBUTES                                                         //
32322>>>>>//                                                                          //
32322>>>>>// Objects of this class will be used to store all kinds of attributes      //
32322>>>>>// which belong to a field.                                                 //
32322>>>>>//                                                                          //
32322>>>>>// FA_MIN_VALUE                                                             //
32322>>>>>// Used to store the mininum value of field.                                //
32322>>>>>//                                                                          //
32322>>>>>// FA_MAX_VALUE                                                             //
32322>>>>>// Used to store the maximum value of a field.                              //
32322>>>>>//                                                                          //
32322>>>>>// FA_CHECK_VALUE                                                           //
32322>>>>>// Used to store a string which contains all possible values of a field.    //
32322>>>>>//                                                                          //
32322>>>>>// FA_CHECKBOX_TRUE                                                         //
32322>>>>>// Used to store the TRUE value for a checkbox field                        //
32322>>>>>//                                                                          //
32322>>>>>// FA_CHECKBOX_FALSE                                                        //
32322>>>>>// Used to store the FALSE value of a checkbox field                        //
32322>>>>>//                                                                          //
32322>>>>>// FA_TABLE_OBJECT                                                          //
32322>>>>>// Stores object Id of a validation table.                                  //
32322>>>>>//                                                                          //
32322>>>>>// FA_ERROR_MESSAGE                                                         //
32322>>>>>// Used to store a error text which will be shown to a user when a fields   //
32322>>>>>// value violates one of the rules defined for it.                          //
32322>>>>>// This field may contain the special strings @MIN, @MAX and @CHECK. When   //
32322>>>>>// these are used, these will be replaced by the actual value of MIN_VALUE, //
32322>>>>>// MAX_VALUE or CHECK_VALUE.                                                //
32322>>>>>//                                                                          //
32322>>>>>//**************************************************************************//
32322>>>>>
32322>>>>>
32322>>>>>//#REPLACE FA_VALIDATION_TYPE           0
32322>>>>>
32322>>>>>// Validation Types
32322>>>>>Enumeration_List
32322>>>>>   Define FA_VALIDATION_TYPE_NONE
32322>>>>>   Define FA_VALIDATION_TYPE_RANGE
32322>>>>>   Define FA_VALIDATION_TYPE_CHECK
32322>>>>>   Define FA_VALIDATION_TYPE_CHECKBOX
32322>>>>>   Define FA_VALIDATION_TYPE_TABLE
32322>>>>>End_Enumeration_List
32322>>>>>
32322>>>>>
32322>>>>>Class Field_Attributes is a Array
32323>>>>>
32323>>>>>  //************************************************************************//
32323>>>>>  // Construct_object ype                                                   //
32323>>>>>  // Define storage for validation types. Access to storage is private.     //
32323>>>>>  //************************************************************************//
32323>>>>>
32323>>>>>  Procedure Construct_Object
32325>>>>>     Forward Send Construct_Object
32327>>>>>     // Private: This replaces the use of arrays to get at this value. This
32327>>>>>     // allows us to find specific validation types (like checkboxes) more
32327>>>>>     // quickly than scanning an array
32327>>>>>     Property String Private.Validation_Types     ''
32328>>>>>  End_Procedure
32329>>>>>
32329>>>>>  //************************************************************************//
32329>>>>>  // Get/Set Field_Validation_Type                                          //
32329>>>>>  // Returns the extended validation type for the passed field.             //
32329>>>>>  //************************************************************************//
32329>>>>>
32329>>>>>  Function Field_Validation_Type Integer iField Returns Integer
32331>>>>>    Integer iType
32331>>>>>    If iField ;       Move (mid(Private.Validation_Types(self),1,iField)) to iType
32334>>>>>    Else ;       Move FA_VALIDATION_TYPE_NONE to iType
32336>>>>>    Function_Return iType
32337>>>>>  End_Function
32338>>>>>
32338>>>>>  Procedure Set Field_Validation_Type Integer iField String sType
32340>>>>>    Integer iType
32340>>>>>    String sTypes
32340>>>>>    If iField Begin
32342>>>>>       Get Private.Validation_Types to sTypes
32343>>>>>       Set Private.Validation_Types to (Overstrike(sType, sTypes, iField))
32344>>>>>    End
32344>>>>>>
32344>>>>>  End_Procedure
32345>>>>>
32345>>>>>  //************************************************************************//
32345>>>>>  // Create_Items.                                                          //
32345>>>>>  // Set any defaults required by this class when the main file is created. //
32345>>>>>  // Create a string which contains all validation types. Set all to        //
32345>>>>>  // No extended validation type.                                           //
32345>>>>>  //************************************************************************//
32345>>>>>
32345>>>>>  Procedure Create_Items
32347>>>>>     String  sType
32347>>>>>     Integer iCount
32347>>>>>     Delegate Get Field_Count to iCOunt
32349>>>>>     Move FA_VALIDATION_TYPE_NONE to sType
32350>>>>>     Set Private.Validation_Types to (Repeat(sType,iCount))
32351>>>>>  End_Procedure // Create_Items
32352>>>>>
32352>>>>>  //************************************************************************//
32352>>>>>  // Next_Validation_Type                                                   //
32352>>>>>  // Return field number of next field matching the passed validation type. //
32352>>>>>  // Pass validation type and last position checked. Return 0 if no match   //
32352>>>>>  //************************************************************************//
32352>>>>>
32352>>>>>  Function Next_Validation_Type String sType Integer iOffset returns integer
32354>>>>>     string sTypes
32354>>>>>     integer iPos
32354>>>>>     Get Private.Validation_Types to sTypes
32355>>>>>     Pos sType in (mid(sTypes,255,iOffset+1)) to iPos
32357>>>>>>
32357>>>>>     If iPos Add iOffset to iPos
32360>>>>>     Function_Return iPos
32361>>>>>  End_Function
32362>>>>>
32362>>>>>
32362>>>>>  //************************************************************************//
32362>>>>>  // Procedure Set Field_Error                                              //
32362>>>>>  // This procedure will be called by the Extended_Data_Set to set the      //
32362>>>>>  // errornumber and message which will be triggered when it needs to.      //
32362>>>>>  //************************************************************************//
32362>>>>>
32362>>>>>  Procedure Set Field_Error Integer iField Integer iErr String sMsg
32364>>>>>    Integer iBase
32364>>>>>    Move (iField * FA_COUNT) to iBase
32365>>>>>    Set Value (iBase + FA_ERROR_NUMBER) to iErr
32366>>>>>    Set Value (iBase + FA_ERROR_MESSAGE) to sMsg
32367>>>>>  End_Procedure
32368>>>>>
32368>>>>>  //************************************************************************//
32368>>>>>  // Get Field_error_Number                                                 //
32368>>>>>  // Get Field_error_Message                                                //
32368>>>>>  // Used to retreive the error number and message for a particular field   //
32368>>>>>  //************************************************************************//
32368>>>>>
32368>>>>>  Function Field_Error_Number Integer iField Returns Integer
32370>>>>>     Integer iErr
32370>>>>>     Get Value (iField*FA_COUNT + FA_ERROR_NUMBER)  to iErr
32371>>>>>     Function_Return iErr
32372>>>>>  End_Function
32373>>>>>
32373>>>>>  Function Field_Error_Message Integer iField Returns String
32375>>>>>     String sValue
32375>>>>>     Get Value (iField*FA_COUNT + FA_ERROR_MESSAGE) to sValue
32376>>>>>     Function_Return sValue
32377>>>>>  End_Function
32378>>>>>
32378>>>>>
32378>>>>>  //************************************************************************//
32378>>>>>  // Validate_Field                                                         //
32378>>>>>  // This function manages the validation of a field against its extended   //
32378>>>>>  // validations.                                                           //
32378>>>>>  //************************************************************************//
32378>>>>>
32378>>>>>  Function Validate_Field Integer iField Returns Integer
32380>>>>>    Integer iType
32380>>>>>    Integer iResult
32380>>>>>    //Get Integer_Value ((iField * FA_COUNT) + FA_VALIDATION_TYPE) to iType
32380>>>>>    //If Not iType ;
32380>>>>>    //  Function_Return
32380>>>>>    Get Field_Validation_Type iField to iType
32381>>>>>    If iType eq FA_VALIDATION_TYPE_RANGE ;       Get Validate_Field_Range iField to iResult
32384>>>>>    Else If iType eq FA_VALIDATION_TYPE_CHECK ;       Get Validate_Field_Check iField to iResult
32388>>>>>    Else If iType eq FA_VALIDATION_TYPE_CHECKBOX ;       Get Validate_Field_Checkbox iField to iResult
32392>>>>>    Else If iType eq FA_VALIDATION_TYPE_TABLE ;       Get Validate_Field_Table iField to iResult
32396>>>>>    Function_Return iResult
32397>>>>>  End_Function
32398>>>>>
32398>>>>>
32398>>>>>  //************************************************************************//
32398>>>>>  // Field_Fill_List                                                        //
32398>>>>>  // All extended validations know how to send callback messages (iMsg) to  //
32398>>>>>  // the calling object (iObj). This allows external lists to get filled w/ //
32398>>>>>  // the contents of a range. Used by combo boxes, spinners, etc.           //
32398>>>>>  //************************************************************************//
32398>>>>>
32398>>>>>  Procedure Field_Fill_List integer iField integer iObj integer iMsg
32400>>>>>    Integer iType
32400>>>>>    Integer iResult
32400>>>>>    //Get Integer_Value ((iField * FA_COUNT) + FA_VALIDATION_TYPE) to iType
32400>>>>>    //If Not iType ;
32400>>>>>    //  Procedure_Return
32400>>>>>    Get Field_Validation_Type iField to iType
32401>>>>>    If iType eq FA_VALIDATION_TYPE_RANGE ;       Send Field_Fill_List_Field_Range iField iObj iMsg
32404>>>>>    Else If iType eq FA_VALIDATION_TYPE_CHECK ;       Send Field_Fill_List_Field_Check iField iObj iMsg
32408>>>>>    Else If iType eq FA_VALIDATION_TYPE_CHECKBOX ;       Send Field_Fill_List_Field_Checkbox iField iObj iMsg
32412>>>>>    Else If iType eq FA_VALIDATION_TYPE_TABLE ;       Send Field_Fill_List_Field_Table iField iObj iMsg
32416>>>>>  End_Procedure
32417>>>>>
32417>>>>>
32417>>>>>  //************************************************************************//
32417>>>>>  // Field_Table_Object                                                     //
32417>>>>>  // Return the id of the validation table if one exists. Otherwise return  //
32417>>>>>  // a zero.                                                                //
32417>>>>>  //************************************************************************//
32417>>>>>
32417>>>>>  Function Field_Table_Object integer iField Returns integer
32419>>>>>    Integer iType
32419>>>>>    Integer iObj
32419>>>>>    Integer iBase
32419>>>>>    Move (iField * FA_COUNT) to iBase
32420>>>>>    //Get Integer_Value iBase to iType
32420>>>>>    Get Field_Validation_Type iField to iType
32421>>>>>    If iType eq FA_VALIDATION_TYPE_TABLE ;       Get Value (iBase + FA_TABLE_OBJECT) to iObj
32424>>>>>    Function_Return iObj
32425>>>>>  End_Function
32426>>>>>
32426>>>>>
32426>>>>>
32426>>>>>  //************************************************************************//
32426>>>>>  // Procedure Set Field_Value_Range                                        //
32426>>>>>  // Procedure to set the range for a field. It will automatically set the  //
32426>>>>>  // validation type of the field as well.                                  //
32426>>>>>  //************************************************************************//
32426>>>>>
32426>>>>>  Procedure Set Field_Value_Range Integer iField String sMin String sMax
32428>>>>>    Integer iBase
32428>>>>>    Move (iField * FA_COUNT) to iBase
32429>>>>>    Set Value (iBase + FA_MIN_VALUE) to sMin
32430>>>>>    Set Value (iBase + FA_MAX_VALUE) to sMax
32431>>>>>    //Set Value iBase to FA_VALIDATION_TYPE_RANGE
32431>>>>>    Set Field_Validation_Type iField to FA_VALIDATION_TYPE_RANGE
32432>>>>>  End_Procedure
32433>>>>>
32433>>>>>  //************************************************************************//
32433>>>>>  // Validate_Field_Range                                                   //
32433>>>>>  // Function to check a fields value agains a given check string.          //
32433>>>>>  //************************************************************************//
32433>>>>>
32433>>>>>  Function Validate_Field_Range Integer iField Returns Integer
32435>>>>>    String  sMin
32435>>>>>    String  sMax
32435>>>>>    String  sValue
32435>>>>>    Integer iField_Type
32435>>>>>    Integer iResult
32435>>>>>    Integer iFile
32435>>>>>    Integer iBase
32435>>>>>    Move (iField * FA_COUNT) to iBase
32436>>>>>    Get Value (iBase + FA_MIN_VALUE) to sMin
32437>>>>>    Get Value (iBase + FA_MAX_VALUE) to sMax
32438>>>>>    Delegate Get Field_Current_Value iField to sValue
32440>>>>>    Delegate Get Main_File to iFile
32442>>>>>    Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
32445>>>>>    Move 0 to iResult
32446>>>>>    If (iField_Type=DF_ASCII) ;      Move (sValue < sMin OR sValue > sMax) to iResult
32449>>>>>    Else If (iField_Type=DF_BCD) ;      Move (Number(sValue) < Number(sMin) OR ;            Number(sValue) > Number(sMax)) to iResult
32453>>>>>    Else If (iField_Type=DF_DATE) ;      Move (Date(sValue) < Date(sMin) OR Date(sValue) > Date(sMax)) to iResult
32457>>>>>    Else If (iField_Type=DF_DATETIME) ;      Move (Cast(sValue,DateTime) < Cast(sMin,DateTime) or Cast(sValue,DateTime) > Cast(sMax,DateTime)) to iResult
32461>>>>>    If iResult Begin
32463>>>>>      Delegate Send Field_Error iField DD_INVALID_RANGE sMin sMax
32465>>>>>      Function_Return 1
32466>>>>>    End
32466>>>>>>
32466>>>>>  End_Function
32467>>>>>
32467>>>>>  //************************************************************************//
32467>>>>>  // Procedure Field_fill_list_Field_Range                                  //
32467>>>>>  // Callback to provide all valid value for this validation.               //
32467>>>>>  // Just call back with the two range values                               //
32467>>>>>  //************************************************************************//
32467>>>>>
32467>>>>>  Procedure Field_Fill_List_Field_Range Integer iField Integer iObj Integer iMsg
32469>>>>>    String  sMin
32469>>>>>    String  sMax
32469>>>>>    Integer iBase
32469>>>>>    Move (iField * FA_COUNT) to iBase
32470>>>>>    Get Value (iBase + FA_MIN_VALUE) to sMin
32471>>>>>    Get Value (iBase + FA_MAX_VALUE) to sMax
32472>>>>>    Send iMsg to iObj 0 sMin '' 0 (NullrowId())
32473>>>>>    Send iMsg to iObj 1 sMax '' 0 (NullrowId())
32474>>>>>  End_Procedure
32475>>>>>
32475>>>>>  //************************************************************************//
32475>>>>>  // Procedure Set Field_Value_Check                                        //
32475>>>>>  // Procedure to set the check for a field. It will automatically set the  //
32475>>>>>  // validation type of the field as well.                                  //
32475>>>>>  //************************************************************************//
32475>>>>>
32475>>>>>  Procedure Set Field_Value_Check Integer iField String sCheck
32477>>>>>    Integer iBase
32477>>>>>    Move (iField * FA_COUNT) to iBase
32478>>>>>    Set Value (iBase + FA_CHECK_VALUE) to sCheck
32479>>>>>    //Set Value iBase to FA_VALIDATION_TYPE_CHECK
32479>>>>>    Set Field_Validation_Type iField to FA_VALIDATION_TYPE_CHECK
32480>>>>>  End_Procedure
32481>>>>>
32481>>>>>
32481>>>>>  //************************************************************************//
32481>>>>>  // Validate_Field_Check                                                   //
32481>>>>>  // Function to check a fields value agains a given check string.          //
32481>>>>>  //************************************************************************//
32481>>>>>
32481>>>>>  Function Validate_Field_Check Integer iField Returns Integer
32483>>>>>    String  sCheck
32483>>>>>    String  sValue
32483>>>>>    Integer iBase
32483>>>>>    Integer iPos
32483>>>>>    Integer iLength
32483>>>>>    Integer iResult
32483>>>>>    Integer iFile
32483>>>>>    Move (iField * FA_COUNT) to iBase
32484>>>>>    Get Value (iBase + FA_CHECK_VALUE) to sCheck
32485>>>>>    Delegate Get Field_Current_Value iField to sValue
32487>>>>>    Delegate Get Main_File to iFile
32489>>>>>    Get_Attribute DF_FIELD_LENGTH of iFile iField to iLength
32492>>>>>    Pad sValue to sValue iLength
32494>>>>>>
32494>>>>>    // Replace the seperation characters with two of them so the user
32494>>>>>    // can't bypass the check by entering a seperation character.
32494>>>>>    Move (Replaces("|", sValue, "||")) to sValue
32495>>>>>    // Report an error if rules are violated.
32495>>>>>    Pos sValue in sCheck to iPos
32497>>>>>>
32497>>>>>    If Not iPos Begin
32499>>>>>      Delegate Send Field_Error iField DD_INVALID_CHECK sCheck
32501>>>>>      Function_Return 1
32502>>>>>    End
32502>>>>>>
32502>>>>>  End_Function
32503>>>>>
32503>>>>>  //************************************************************************//
32503>>>>>  // Procedure Field_fill_list_Field_Check                                  //
32503>>>>>  // Callback to provide all valid value for this validation.               //
32503>>>>>  // Call back with all valid check values                                  //
32503>>>>>  //************************************************************************//
32503>>>>>
32503>>>>>  Procedure Field_Fill_List_Field_Check Integer iField Integer iObj Integer iMsg
32505>>>>>    String  sCheck
32505>>>>>    Integer iBase
32505>>>>>    Integer iPos
32505>>>>>    Integer iItem
32505>>>>>    Move (iField * FA_COUNT) to iBase
32506>>>>>    Get Value (iBase + FA_CHECK_VALUE) to sCheck
32507>>>>>    Append sCheck "|"
32508>>>>>    Pos "|" in sCheck to iPos
32510>>>>>>
32510>>>>>    While iPos
32514>>>>>      If iPos gt 1 Begin
32516>>>>>         Send iMsg to iObj iItem (Left(sCheck,iPos-1)) '' 0 (NullrowId())
32517>>>>>         Increment iItem
32518>>>>>      End
32518>>>>>>
32518>>>>>      Mid sCheck to sCheck 255 (iPos+1)
32521>>>>>>
32521>>>>>      Pos "|" in sCheck to iPos
32523>>>>>>
32523>>>>>    Loop
32524>>>>>>
32524>>>>>  End_Procedure
32525>>>>>
32525>>>>>
32525>>>>>
32525>>>>>  //************************************************************************//
32525>>>>>  // Procedure Set Field_CheckBox_Values                                    //
32525>>>>>  // Procedure to set up a checkbox field. We will store the TRUE and FALSE //
32525>>>>>  // Values in the extended array.                                          //
32525>>>>>  //************************************************************************//
32525>>>>>
32525>>>>>  Procedure Set Field_CheckBox_Values Integer iField String sTrue String sFalse
32527>>>>>    Integer iBase
32527>>>>>    Move (iField * FA_COUNT) to iBase
32528>>>>>    Set Value (iBase + FA_CHECKBOX_TRUE) to sTrue
32529>>>>>    Set Value (iBase + FA_CHECKBOX_FALSE) to sFalse
32530>>>>>    //Set Value iBase to FA_VALIDATION_TYPE_CHECKBOX
32530>>>>>    Set Field_Validation_Type iField to FA_VALIDATION_TYPE_CHECKBOX
32531>>>>>  End_Procedure
32532>>>>>
32532>>>>>
32532>>>>>  //************************************************************************//
32532>>>>>  // Function Field_CheckBox_Value                                          //
32532>>>>>  // Return the Value associated with the field and its select-state.       //
32532>>>>>  //************************************************************************//
32532>>>>>
32532>>>>>  Function Field_CheckBox_Value Integer iField Integer iState returns String
32534>>>>>    Integer iBase
32534>>>>>    Integer iType
32534>>>>>    String sValue
32534>>>>>    Move (iField * FA_COUNT) to iBase
32535>>>>>    //Get Value iBase to iType
32535>>>>>    Get Field_Validation_Type iField to iType
32536>>>>>    If iType ne FA_VALIDATION_TYPE_CHECKBOX ;       Move iState to sValue
32539>>>>>    Else ;       Get Value (iBase + If(iState,FA_CHECKBOX_TRUE,FA_CHECKBOX_FALSE));           to sValue
32541>>>>>    Function_Return sValue
32542>>>>>  End_Function
32543>>>>>
32543>>>>>
32543>>>>>  //************************************************************************//
32543>>>>>  // Function Field_Value_Select_State                                      //
32543>>>>>  // Return the select_state based on the passed value and field            //
32543>>>>>  //************************************************************************//
32543>>>>>
32543>>>>>  Function Field_Value_Select_State Integer iField String sValue Returns integer
32545>>>>>    Integer iBase
32545>>>>>    Integer iType
32545>>>>>    String  sTrue
32545>>>>>    Integer iState
32545>>>>>    Integer iFile
32545>>>>>    Integer iField_Type
32545>>>>>    Move (iField * FA_COUNT) to iBase
32546>>>>>    Get Field_Validation_Type iField to iType
32547>>>>>    Get Value (iBase + FA_CHECKBOX_TRUE) to sTrue
32548>>>>>    If iType ne FA_VALIDATION_TYPE_CHECKBOX ;      Move (Not(sValue=0 OR sValue='')) to iState
32551>>>>>    Else Begin
32552>>>>>      Delegate Get Main_File to iFile
32554>>>>>      Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
32557>>>>>      If iField_Type EQ DF_BCD ;         Move (number(sValue)=number(sTrue)) to iState
32560>>>>>      Else ; // DF_ASCII         Move (sValue=sTrue) to iState
32562>>>>>    End
32562>>>>>>
32562>>>>>    Function_Return iState
32563>>>>>  End_Function
32564>>>>>
32564>>>>>
32564>>>>>  //************************************************************************//
32564>>>>>  // Validate_Field_Checkbox
32564>>>>>  // Check that the buffer value is one of the two checkbox values.         //
32564>>>>>  //************************************************************************//
32564>>>>>
32564>>>>>  Function Validate_Field_Checkbox Integer iField Returns Integer
32566>>>>>    String  sTrue
32566>>>>>    String  sFalse
32566>>>>>    String  sValue
32566>>>>>    Integer iField_Type
32566>>>>>    Integer iResult
32566>>>>>    Integer iFile
32566>>>>>    Integer iBase
32566>>>>>    Move (iField * FA_COUNT) to iBase
32567>>>>>    Get Value (iBase + FA_CHECKBOX_TRUE) to sTrue
32568>>>>>    Get Value (iBase + FA_CHECKBOX_FALSE) to sFalse
32569>>>>>    Delegate Get Field_Current_Value iField to sValue
32571>>>>>    Delegate Get Main_File to iFile
32573>>>>>    Get_Attribute DF_FIELD_TYPE of iFile iField to iField_Type
32576>>>>>    Move 0 to iResult
32577>>>>>    If iField_Type EQ DF_BCD ;      Move (Number(sValue)=Number(sTrue) OR ;            Number(sValue)=Number(sFalse)) to iResult
32580>>>>>    Else ; // DF_ASCII      Move (sValue=sTrue OR sValue=sFalse) to iResult
32582>>>>>    If Not iResult Begin
32584>>>>>      Delegate Send Field_Error iField DD_INVALID_CHECKBOX sTrue sFalse
32586>>>>>      Function_Return 1
32587>>>>>    End
32587>>>>>>
32587>>>>>  End_Function
32588>>>>>
32588>>>>>  //************************************************************************//
32588>>>>>  // Procedure Field_fill_list_Field_Checkbox                               //
32588>>>>>  // Callback to provide all valid value for this validation.               //
32588>>>>>  // Just call back with the two true and false values                      //
32588>>>>>  //************************************************************************//
32588>>>>>
32588>>>>>  Procedure Field_Fill_List_Field_Checkbox Integer iField Integer iObj Integer iMsg
32590>>>>>    String  sTrue
32590>>>>>    String  sFalse
32590>>>>>    Integer iBase
32590>>>>>    Move (iField * FA_COUNT) to iBase
32591>>>>>    Get Value (iBase + FA_CHECKBOX_TRUE) to sTrue
32592>>>>>    Get Value (iBase + FA_CHECKBOX_FALSE) to sFalse
32593>>>>>    Send iMsg to iObj 0 sTrue '' 0 (NullrowId())
32594>>>>>    Send iMsg to iObj 1 sFalse '' 0 (NullrowId())
32595>>>>>  End_Procedure
32596>>>>>
32596>>>>>  //************************************************************************//
32596>>>>>  // Procedure Set Field_Value_Table                                        //
32596>>>>>  // The object keeps track of a validation table object. This table object //
32596>>>>>  // can be any type of object must at a minimum understand a small message //
32596>>>>>  // protocol (see xvaltbl.pkg for info)                                    //
32596>>>>>  //************************************************************************//
32596>>>>>
32596>>>>>  Procedure Set Field_Value_Table Integer iField Integer iObj
32598>>>>>    Integer iBase
32598>>>>>    Move (iField * FA_COUNT) to iBase
32599>>>>>    Set Value (iBase + FA_TABLE_OBJECT) to iObj
32600>>>>>    //Set Value iBase to FA_VALIDATION_TYPE_TABLE
32600>>>>>    Set Field_Validation_Type iField to FA_VALIDATION_TYPE_TABLE
32601>>>>>  End_Procedure
32602>>>>>
32602>>>>>  //************************************************************************//
32602>>>>>  // Validate_Field_Table                                                   //
32602>>>>>  // This valdates against a validation table if appropriate (if a table    //
32602>>>>>  // exists and the table's validate_State is T). It validates by passing   //
32602>>>>>  // the message validate_value to the validation table object              //
32602>>>>>  //************************************************************************//
32602>>>>>
32602>>>>>  Function Validate_Field_Table Integer iField Returns Integer
32604>>>>>    integer iBase
32604>>>>>    integer iTableObj
32604>>>>>    String  sValue
32604>>>>>    Integer iResult
32604>>>>>    Move (iField * FA_COUNT) to iBase
32605>>>>>    Get Value (iBase + FA_TABLE_OBJECT) to iTableObj
32606>>>>>    If (iTableObj AND Validate_State(iTableObj) ) Begin
32608>>>>>       Delegate Get Field_Current_Value iField to sValue
32610>>>>>       Get Validate_Value of iTableOBj sValue to iResult
32611>>>>>       If iResult ;          Delegate Send Field_Error iField DD_INVALID_VALUE_TABLE
32615>>>>>    End
32615>>>>>>
32615>>>>>    Function_Return iResult
32616>>>>>  End_Function
32617>>>>>
32617>>>>>
32617>>>>>  //************************************************************************//
32617>>>>>  // Procedure Field_fill_list_Field_table                                  //
32617>>>>>  // Callback to provide all valid value for this validation.               //
32617>>>>>  // Pass the request on to the validation table. This is the most common   //
32617>>>>>  // use of this.                                                           //
32617>>>>>  //************************************************************************//
32617>>>>>
32617>>>>>  Procedure Field_Fill_List_Field_Table Integer iField Integer iObj Integer iMsg
32619>>>>>    integer iBase
32619>>>>>    integer iTableObj
32619>>>>>    Move (iField * FA_COUNT) to iBase
32620>>>>>    Get Value (iBase + FA_TABLE_OBJECT) to iTableObj
32621>>>>>    If iTableObj ;       Send Request_Fill_From_List to iTableObj iObj iMsg
32624>>>>>  End_Procedure
32625>>>>>
32625>>>>>  //************************************************************************//
32625>>>>>  // Procedure Prompt_Object                                                //
32625>>>>>  // Often extended valditation types can provide automatic prompt          //
32625>>>>>  // objects. If the extended type supports a prompt object and there is    //
32625>>>>>  // a global validation_list object, we will use it                        //
32625>>>>>  //************************************************************************//
32625>>>>>
32625>>>>>  Function Prompt_Object Integer iField Returns Integer
32627>>>>>    Integer iType
32627>>>>>    Integer iObj
32627>>>>>    //Get Integer_Value ((iField * FA_COUNT) + FA_VALIDATION_TYPE) to iType
32627>>>>>    Get Field_Validation_Type iField to iType
32628>>>>>    If Not (iType=FA_VALIDATION_TYPE_NONE OR iType=FA_VALIDATION_TYPE_RANGE) ;       Move DD_Global_Validation_Prompt_Object to iObj
32631>>>>>    Function_Return iObj
32632>>>>>  End_Function
32633>>>>>
32633>>>>>
32633>>>>>End_Class
32634>>>>>
32634>>>>>
32634>>>>>
32634>>>>>// use to keep track of file field pairs such as system file file/field
32634>>>>>Struct tDDFileField
32634>>>>>    Integer iFile
32634>>>>>    Integer iField
32634>>>>>End_Struct
32634>>>>>
32634>>>>>Class Field_Mask_Array is an Array
32635>>>>>
32635>>>>>  //************************************************************************//
32635>>>>>  // Get Array_Name: returns string value (and checks for 0)                //
32635>>>>>  //************************************************************************//
32635>>>>>
32635>>>>>  Function Array_Name integer iField integer iType Returns String
32637>>>>>     String sName
32637>>>>>     Move (iField*FMA_COUNT+iType) to iField
32638>>>>>     if (Item_Count(self)>iField) ;        Get value iField to sName
32641>>>>>     // sometimes an array value that is undefined returns a 0, we must change this to ''
32641>>>>>     If sName eq '0' Move '' to sName
32644>>>>>     function_return sName
32645>>>>>  End_Function
32646>>>>>
32646>>>>>
32646>>>>>  //************************************************************************//
32646>>>>>  // Get/Set Field_Mask_Type                                                //
32646>>>>>  //************************************************************************//
32646>>>>>
32646>>>>>  Procedure Set Field_Mask_Type Integer iField integer iType
32648>>>>>     Set Value (iField*FMA_COUNT+FMA_MASK_TYPE) to iType
32649>>>>>  End_procedure
32650>>>>>
32650>>>>>  Function Field_Mask_Type integer iField returns integer
32652>>>>>     integer iType
32652>>>>>     Move (iField*FMA_COUNT+FMA_MASK_TYPE) to iField
32653>>>>>     if (Item_Count(self)>iField) ;        Get value iField to iType
32656>>>>>     function_return iType
32657>>>>>  End_Function
32658>>>>>
32658>>>>>  //************************************************************************//
32658>>>>>  // Get/Set Field_Mask_Value_state                                         //
32658>>>>>  //************************************************************************//
32658>>>>>
32658>>>>>  Procedure Set Field_Mask_Value_State Integer iField integer iState
32660>>>>>     Set Value (iField*FMA_COUNT+FMA_MASK_VALUE_STATE) to iState
32661>>>>>  End_procedure
32662>>>>>
32662>>>>>  Function Field_Mask_Value_State integer iField returns integer
32664>>>>>     integer iState
32664>>>>>     Move (iField*FMA_COUNT+FMA_MASK_VALUE_STATE) to iField
32665>>>>>     if (Item_Count(self)>iField) ;        Get value iField to iState
32668>>>>>     function_return iState
32669>>>>>  End_Function
32670>>>>>
32670>>>>>  //************************************************************************//
32670>>>>>  // Get/Set Field_Mask                                                     //
32670>>>>>  //************************************************************************//
32670>>>>>
32670>>>>>  Procedure Set Field_Mask Integer iField string sMask
32672>>>>>     Set Value (iField*FMA_COUNT+FMA_MASK) to sMask
32673>>>>>  End_procedure
32674>>>>>
32674>>>>>  Function Field_Mask integer iField returns string
32676>>>>>     Function_Return (Array_Name(self,iField,FMA_MASK))
32677>>>>>  End_Function
32678>>>>>
32678>>>>>  //************************************************************************//
32678>>>>>  // Get/Set Field_Label_Short                                               //
32678>>>>>  //************************************************************************//
32678>>>>>
32678>>>>>  Procedure Set Field_Label_Short Integer iField string sName
32680>>>>>     Set Value (iField*FMA_COUNT+FMA_SHORT_NAME) to sName
32681>>>>>  End_procedure
32682>>>>>
32682>>>>>  Function Field_Label_Short integer iField returns string
32684>>>>>     Function_Return (Array_Name(self,iField,FMA_SHORT_NAME))
32685>>>>>  End_Function
32686>>>>>
32686>>>>>  //************************************************************************//
32686>>>>>  // Get/Set Field_Label_Long                                                //
32686>>>>>  //************************************************************************//
32686>>>>>
32686>>>>>  Procedure Set Field_Label_Long Integer iField string sName
32688>>>>>     Set Value (iField*FMA_COUNT+FMA_LONG_NAME) to sName
32689>>>>>  End_procedure
32690>>>>>
32690>>>>>  Function Field_Label_Long integer iField returns string
32692>>>>>     Function_Return (Array_Name(self,iField,FMA_LONG_NAME))
32693>>>>>  End_Function
32694>>>>>
32694>>>>>  //************************************************************************//
32694>>>>>  // Get/Set Field_Class_Name                                               //
32694>>>>>  //************************************************************************//
32694>>>>>
32694>>>>>  Procedure Set Field_Class_Name Integer iField string sName
32696>>>>>     Set Value (iField*FMA_COUNT+FMA_CLASS_NAME) to sName
32697>>>>>  End_procedure
32698>>>>>
32698>>>>>  Function Field_Class_Name integer iField returns string
32700>>>>>     Function_Return (Array_Name(self,iField,FMA_CLASS_NAME))
32701>>>>>  End_Function
32702>>>>>
32702>>>>>
32702>>>>>  //************************************************************************//
32702>>>>>  // Get/Set Field_WebPrompt_Object
32702>>>>>  //************************************************************************//
32702>>>>>
32702>>>>>  Procedure Set Field_WebPrompt_Object Integer iField Handle hoPrompt   
32704>>>>>     Set Value (iField*FMA_COUNT+FMA_WEBPROMPTOBJECT) to hoPrompt
32705>>>>>  End_Procedure
32706>>>>>
32706>>>>>  Function Field_WebPrompt_Object Integer iField Returns Handle
32708>>>>>     Function_Return (Array_Name(Self,iField,FMA_WEBPROMPTOBJECT))
32709>>>>>  End_Function
32710>>>>>
32710>>>>>End_Class
32711>>>>>
32711>>>>>//************************************************************************//
32711>>>>>// This image is used when creating the Record_Buffer object.             //
32711>>>>>// Because the Record_Buffer is based on an Entrylist, it needs to have   //
32711>>>>>// an image.                                                              //
32711>>>>>//************************************************************************//
32711>>>>>
/RECORD_BUFFER
Image 1, RECORD_BUFFER
__
/*
32711>>>>>
32711>>>>>
32711>>>>>//**************************************************************************//
32711>>>>>//                                                                          //
32711>>>>>// EXTENDED_DATA_SET                                                        //
32711>>>>>//                                                                          //
32711>>>>>// This is the extended version of the Data_Set class.                      //
32711>>>>>//                                                                          //
32711>>>>>// It provides the following extra's to the standard Data_Set class:        //
32711>>>>>//                                                                          //
32711>>>>>// - SETTING ITEM-OPTIONS PER FIELD                                         //
32711>>>>>//   These item-options will be used automatically when an DEO is used      //
32711>>>>>//   which recognizes the Extended_Data_Set. You can specify two types of   //
32711>>>>>//   item-options.                                                          //
32711>>>>>//   1. The ones that will be used when the Server of the DEO is the same   //
32711>>>>>//      as the Data_File of the item. We call those the stadard-item-       //
32711>>>>>//      options.                                                            //
32711>>>>>//   2. The ones that will be used when the Server of the DEO is different  //
32711>>>>>//      from the Data_File of the item. We call those options Foreign-      //
32711>>>>>//      item-options.                                                       //
32711>>>>>//                                                                          //
32711>>>>>// - PROTECTING KEY FIELDS                                                  //
32711>>>>>//   You can set the Key_Field_State of a field to true to identify Key-    //
32711>>>>>//   fields. When the property Protect_Key_State is TRUE (Default) then     //
32711>>>>>//   a user will not be able to change the value of a field which has been  //
32711>>>>>//   marked as Key-field from an existing record.                           //
32711>>>>>//                                                                          //
32711>>>>>// - VALIDATING FIELDS                                                      //
32711>>>>>//   A validation message can be set per field. This message will be        //
32711>>>>>//   executed when the Data_Set needs to validate all fields. The message   //
32711>>>>>//   will also be send when a DEO need to validate an item.                 //
32711>>>>>//                                                                          //
32711>>>>>// - FIELD ENTRY AND EXITS MESSAGES                                         //
32711>>>>>//   One can specify a message which has to be send to the Data_Set when    //
32711>>>>>//   a item of a DEO is being entered or exited.                            //
32711>>>>>//                                                                          //
32711>>>>>// Currently the fieldtypes Overlap, Text and Binary are *not* supported.   //
32711>>>>>//                                                                          //
32711>>>>>// PROPERTIES                                                               //
32711>>>>>//                                                                          //
32711>>>>>//   EXISTING_KEY_VALUE                                                     //
32711>>>>>//   This property will hold the complete value of all the fields which     //
32711>>>>>//   have been flagged to be a key-field. It is used to check if a user     //
32711>>>>>//   has changed one of the fields which make up the key for a record.      //
32711>>>>>//                                                                          //
32711>>>>>//   PROTECT_KEY_STATE                                                      //
32711>>>>>//   When this property is TRUE, is will force a key to be read-only. A     //
32711>>>>>//   transaction will be aborted when this Data_Set detects that a key      //
32711>>>>>//   value for an existing record has been changed.                         //
32711>>>>>//                                                                          //
32711>>>>>//   KEY_FIELDS                                                             //
32711>>>>>//   This property contains a comma separated list of all fieldnumbers      //
32711>>>>>//   which have been marked to be part of a key. This list is not sorted    //
32711>>>>>//   and should be considered read-only.                                    //
32711>>>>>//                                                                          //
32711>>>>>//   FOREIGN_FIELD_OPTIONS PRIVATE                                          //
32711>>>>>//   This property hold the fields' item-options which are copied to a      //
32711>>>>>//   DEO item when this field is used as a foreign (related) field.         //
32711>>>>>//   These options will be applied for fields which are not part of an      //
32711>>>>>//   index.                                                                 //
32711>>>>>//                                                                          //
32711>>>>>//   FOREIGN_KEY_FIELD_OPTIONS PRIVATE                                      //
32711>>>>>//   See Foreign_Field_Options.                                             //
32711>>>>>//   These options will be applied for fields which are part of the key.    //
32711>>>>>//                                                                          //
32711>>>>>//   FOREIGN_INDEX_FIELD_OPTIONS PRIVATE                                    //
32711>>>>>//   See Foreign_Field_Options.                                             //
32711>>>>>//   These options will be applied for fields which are part of an index,   //
32711>>>>>//   but not of a key.                                                      //
32711>>>>>//                                                                          //
32711>>>>>//**************************************************************************//
32711>>>>>
32711>>>>>Class DataDictionary is a DataSet
32712>>>>>
32712>>>>>  //************************************************************************//
32712>>>>>  // Construct_Object.                                                      //
32712>>>>>  // Augmented to set the Focus_Mode to NO_ACTIVATE. If we don't do this,   //
32712>>>>>  // the object might try to take the focus.                                //
32712>>>>>  //************************************************************************//
32712>>>>>
32712>>>>>  Procedure Construct_Object Integer iImage
32714>>>>>    Forward Send Construct_Object No_Image //iImage
32716>>>>>
32716>>>>>    Property String  Existing_Key_Value                           ""
32717>>>>>    Property Integer Protect_Key_State                            True
32718>>>>>
32718>>>>>    Property String  Key_Fields                                   ""
32719>>>>>
32719>>>>>    // These are added to support the checking of DSO connections
32719>>>>>    // during deletes and saves. Only the first two properties are Public
32719>>>>>    Property Integer Validate_Save_Structure_Mode   DD_Validate_Structure_Once
32720>>>>>    Property Integer Validate_Delete_Structure_Mode DD_Validate_Structure_Once
32721>>>>>    Property Integer Save_Structure_Validated_State              False
32722>>>>>    Property Integer Cascade_Delete_Structure_Validated_State    False
32723>>>>>    Property Integer No_Cascade_Delete_Structure_Validated_State False
32724>>>>>
32724>>>>>    Property Integer Last_Mark_Sequence_Id                       0
32725>>>>>
32725>>>>>    // These are added for optimized traversal of
32725>>>>>    // entry-update and validation and maybe more
32725>>>>>    Property String  Visited_Fields          ""
32726>>>>>    Property Integer Visited_State           False
32727>>>>>    // means will be part of a downward delete (cascade deletable). This only has meaning
32727>>>>>    // when cascade_delete_state is True
32727>>>>>    Property Boolean DownDelete_State        False 
32728>>>>>
32728>>>>>    // these are set by the define_auto_increment, which is obsolete and has been replaced
32728>>>>>    // the Set Field_auto_increment method. 
32728>>>>>    Property Integer Auto_Increment_Source_File  0
32729>>>>>    Property Integer Auto_Increment_Source_Field 0
32730>>>>>    Property Integer Auto_Increment_Dest_Field   0
32731>>>>>    
32731>>>>>    // used by the set Field_auto_increment method
32731>>>>>    // these are split into two arrays to make searching for the field easier
32731>>>>>    // the arrays should always be synched.
32731>>>>>    Property Integer[] pAutoIncrementFields
32732>>>>>    Property tDDFileField[] pAutoIncrementSysFileFields
32733>>>>>
32733>>>>>    // Error Reporting Related
32733>>>>>    // If DD_Error_No_Report errors would be supressed (only ERR gets set)
32733>>>>>    Property Integer Error_Report_Mode           DD_Error_Report
32734>>>>>
32734>>>>>    // During validation, this is the field being validated.
32734>>>>>    Property integer Current_Validate_Field      0
32735>>>>>
32735>>>>>    // when errors are redirected locally this maintains the original handler.
32735>>>>>    Property integer Old_Error_Object_Id         0
32736>>>>>
32736>>>>>    // Must be provided if local error handler is to be created
32736>>>>>    Property integer Error_Processing_State      0
32737>>>>>
32737>>>>>    // These should be changed most carefully and possible only and the
32737>>>>>    // DSO level. These allow you to defeat full field validation which
32737>>>>>    // makes it easier to corrupt data! Validate_DEO_Only_State limits
32737>>>>>    // save validation to DEOs (which is what data-sets have always done).
32737>>>>>    // Validate_foreign_File_State will skip validation under the following
32737>>>>>    // conditions: 1) DSO if for a parent (it did not originate the save).
32737>>>>>    //
32737>>>>>    Property Integer Validate_DEOs_Only_State    False
32738>>>>>    Property Integer Validate_Foreign_File_State True
32739>>>>>    // if set true, a field validation requested started with this
32739>>>>>    // DD will check all fields, even in an error is encountered
32739>>>>>    Property Integer Validate_All_Fields_State   False
32740>>>>>
32740>>>>>    // If true, all entry updates will occur through the DD. Else
32740>>>>>    // saves occur through the DD and find occur through the DEOs
32740>>>>>    Property Integer EntryUpdateLocalState True // changed from false to true in 17.0
32741>>>>>
32741>>>>>    // can be used by Refind_records method (remote refind of recs). Obsolete. Use Find_RowId
32741>>>>>    Property integer Find_Record_Id 0
32742>>>>>
32742>>>>>    // can be used by Refind_records method (remote refind of recs)
32742>>>>>    Property RowID Find_RowId (NullRowId())
32743>>>>>// currently not used
32743>>>>>//    // can be used by Refind_records method (remote refind of recs)
32743>>>>>//    { Visibility=Private }
32743>>>>>//    Property Boolean Find_ParentChanged False
32743>>>>>
32743>>>>>    // Private: Id of field_objects container. This is not created until needed
32743>>>>>    Property Integer Field_Objects 0
32744>>>>>
32744>>>>>    // Public: If set the DDO will never be foreign, allowing
32744>>>>>    // you to create new parents when a child is saved. This would
32744>>>>>    // normally only be set within the DDO and not the class. This would be
32744>>>>>    // used where a child table wants to save the parent (header) when the
32744>>>>>    // first child is saved. It would disable the foreign key and index
32744>>>>>    // find_Req and required settings (as well as any displayonly).
32744>>>>>    Property Integer Allow_Foreign_New_Save_State False
32745>>>>>
32745>>>>>    Set pbDDAttach to True // set false to get (very) old attach_main_file_behavior
32746>>>>>    Set pbSmartRelate to True // Only relate if parent is attached via a DDO
32747>>>>>
32747>>>>>    // If this is an alias file, this is the master file it is based on
32747>>>>>    Property Handle piMasterTable 0
32748>>>>>
32748>>>>>    Property tDDServerInformation[] pServerInformation
32749>>>>>
32749>>>>>    Property tDDRemembered[] pDDDefaults
32750>>>>>
32750>>>>>    Property Boolean pbInSuperFind False
32751>>>>>
32751>>>>>    // Create the local buffer.
32751>>>>>    Object Record_Buffer is a cRecordBuffer
32753>>>>>    End_Object
32754>>>>>
32754>>>>>    // Create the extended field attributes array.
32754>>>>>    Object Field_Attributes is a Field_Attributes
32756>>>>>    End_Object
32757>>>>>
32757>>>>>    // Create an array to maintain Status help values for each field
32757>>>>>    Object Statushelp_Array is an array
32759>>>>>    end_object
32760>>>>>
32760>>>>>    Object FieldMask_Array is an Field_Mask_array
32762>>>>>    end_object
32763>>>>>
32763>>>>>
32763>>>>>    // keep track of all system/unknown files that must be set to
32763>>>>>    // default for smart file mode to work right.
32763>>>>>    Object System_File_obj is an Array
32765>>>>>    End_Object
32766>>>>>    
32766>>>>>    // used during Request_Validate
32766>>>>>    Property Handle[] pDDsWithFindReqErrors
32767>>>>>
32767>>>>>    // Apply SQL filters in constrained finds    
32767>>>>>    Property Boolean pbUseDDSQLFilters False
32768>>>>>    // If pbUseDDSQLFilters is true, this determines if the table global filter should be applied as well
32768>>>>>    Property Boolean pbApplyGlobalSQLFilters False
32769>>>>>    // Filter which will get applied before each DDO constrained find. If "", no filter is applied
32769>>>>>    Property String psSQLFilter ""
32770>>>>>
32770>>>>>    // Old values for SQL Filters which are pushed and popped by StoreSQLDefaultFilters and RestoreSQLDefaultFilters
32770>>>>>    Property String psOldFilter ""
32771>>>>>    Property Boolean pbOldFilterActive 
32772>>>>>    Property Boolean pbOldFilterEq 
32773>>>>>    
32773>>>>>    // used to point to the composite child object that provides the SQL
32773>>>>>    // interfaces for a driver. This can be used with DAW drivers. Other drivers may require
32773>>>>>    // that you sub-class your DD and create a different object based on a custom class 
32773>>>>>    Property Handle phoSQLHelper (Create(Self,RefClass(cDAWSQLDriverHelper)))    
32774>>>>>
32774>>>>>
32774>>>>>    Property Handle pbInResync False    
32775>>>>>
32775>>>>>    //Set Focus_Mode to NO_ACTIVATE
32775>>>>>
32775>>>>>    Set Smart_FileMode_State to True  // extended DSOs should default to
32776>>>>>                                      // true
32776>>>>>    Send Define_Fields // Developer Hook - define all field rules
32777>>>>>  End_Procedure
32778>>>>>
32778>>>>>//  // NEW: Returns true if record is active in DD. This is more intuitive than using the current record/rowid
32778>>>>>//  //Doc/ Visibility=Public
32778>>>>>//  Function HasRecord Returns Boolean
32778>>>>>//      Function_Return (Not(IsNullRowId(CurrentRowId(self))))
32778>>>>>//  End_Function
32778>>>>>
32778>>>>>  //************************************************************************//
32778>>>>>  // Extended_DSO_State                                                     //
32778>>>>>  // Returns 1 to indicate that this is a DD class.                         //
32778>>>>>  //************************************************************************//
32778>>>>>
32778>>>>>  Function Extended_DSO_State Returns Integer
32780>>>>>     Function_Return 1
32781>>>>>  End_Function // Extended_DSO_State
32782>>>>>
32782>>>>>
32782>>>>>  //************************************************************************//
32782>>>>>  // Define_Fields                                                          //
32782>>>>>  // Used to set up all XDS functions and rules. Called by construct_object //
32782>>>>>  // and considered a bit more user friendly.                               //
32782>>>>>  //************************************************************************//
32782>>>>>
32782>>>>>  Procedure Define_Fields
32784>>>>>  End_Procedure
32785>>>>>
32785>>>>>
32785>>>>>
32785>>>>>  //************************************************************************//
32785>>>>>  // Set Main_File.                                                         //
32785>>>>>  // This message has been augmented to create a local recordbuffer for a   //
32785>>>>>  // file. We cannot do this earlier because we need the file to count the  //
32785>>>>>  // number of necessary fields.                                            //
32785>>>>>  //************************************************************************//
32785>>>>>
32785>>>>>  Procedure Set Main_File Integer iFile
32787>>>>>    Integer iCurrent_File iMaster
32787>>>>>    Get piMasterTable to iMaster
32788>>>>>    If iMaster Begin
32790>>>>>        // is an alias condition
32790>>>>>        Forward Set Main_File to iFile
32792>>>>>        Send ReDefineAliasItems to (Record_Buffer(Self)) iFile
32793>>>>>    End
32793>>>>>>
32793>>>>>    Else If iFile Begin
32796>>>>>      Get Main_File to iCurrent_File
32797>>>>>      If (iCurrent_File AND iCurrent_File <> iFile) Begin
32799>>>>>        Send Data_Set_Error -1 DFERR_PROGRAM DD_CANNOT_CHANGE_MAIN_FILE
32800>>>>>        Procedure_Return
32801>>>>>      End
32801>>>>>>
32801>>>>>      Forward Set Main_File to iFile
32803>>>>>      Send Create_Items to (Record_Buffer(self)) iFile
32804>>>>>      Send Create_Items to (Field_Attributes(self))
32805>>>>>    End
32805>>>>>>
32805>>>>>  End_Procedure
32806>>>>>
32806>>>>>
32806>>>>>
32806>>>>>  //************************************************************************//
32806>>>>>  // Set Key_Field_State                                                    //
32806>>>>>  // This procedure will update the Key_Fields property to include or       //
32806>>>>>  // excluded the fieldnumber passed in the list of fieldnumbers which make //
32806>>>>>  // up an keyvalue.                                                        //
32806>>>>>  //************************************************************************//
32806>>>>>
32806>>>>>  Procedure Set Key_Field_State Integer iField Integer iState
32808>>>>>    String  sKeys
32808>>>>>    Set Key_Field_State of Record_Buffer iField to iState
32809>>>>>    Get Key_Fields to sKeys
32810>>>>>    Set Key_Fields to (Overstrike(If(iState, "X", " "), sKeys, iField))
32811>>>>>  End_Procedure
32812>>>>>
32812>>>>>
32812>>>>>
32812>>>>>  //************************************************************************//
32812>>>>>  // Function Key_Field_State                                               //
32812>>>>>  // Will return TRUE if the field passed has been defined as a key.        //
32812>>>>>  //************************************************************************//
32812>>>>>
32812>>>>>  Function Key_Field_State Integer iField Returns Integer
32814>>>>>    Integer iState
32814>>>>>    Get Key_Field_State of Record_Buffer iField to iState
32815>>>>>    Function_Return iState
32816>>>>>  End_Function
32817>>>>>
32817>>>>>  //************************************************************************//
32817>>>>>  // Function Key_Value                                                     //
32817>>>>>  // Returns complete key value.                                            //
32817>>>>>  //************************************************************************//
32817>>>>>
32817>>>>>  Function Key_Value Returns String
32819>>>>>    String  sKeys
32819>>>>>    String  sKey_Value
32819>>>>>    String  sValue
32819>>>>>    Integer iField
32819>>>>>    Get Key_Fields to sKeys
32820>>>>>    Move "" to sKey_Value
32821>>>>>    Repeat
32821>>>>>>
32821>>>>>      Pos "X" in sKeys to iField
32823>>>>>>
32823>>>>>      If iField Begin
32825>>>>>        Get Field_Current_Value iField to sValue
32826>>>>>        Append sKey_Value sValue
32827>>>>>        Move (Overstrike(" ", sKeys, iField)) to sKeys
32828>>>>>      End
32828>>>>>>
32828>>>>>    Until Not iField
32830>>>>>    Function_Return sKey_Value
32831>>>>>  End_Function
32832>>>>>
32832>>>>>  //************************************************************************//
32832>>>>>  // New_Current_Record.                                                    //
32832>>>>>  // This procedure will be called whenever the Data_Set changes its        //
32832>>>>>  // Current_Record property, or after a Save, Delete or Clear operation.   //
32832>>>>>  // We send this message to the Record_Buffer object to update its values. //
32832>>>>>  //************************************************************************//
32832>>>>>
32832>>>>>  Procedure New_Current_Record integer iOld integer iNew
32834>>>>>     // does nothing, but exists if developer is using this for some purpose. Is called after
32834>>>>>     // OnNewCurrentRecord (if recnum based table)
32834>>>>>  End_Procedure
32835>>>>>
32835>>>>>  Procedure OnNewCurrentRecord RowId riOld RowId riNew
32837>>>>>    Integer iObj
32837>>>>>    Integer iOldst
32837>>>>>    Integer iFoc
32837>>>>>    Integer iIsExt
32837>>>>>    Forward Send OnNewCurrentRecord riOld riNew
32839>>>>>    Move (Record_Buffer(self)) to iObj
32840>>>>>    If iObj Begin
32842>>>>>       Send OnNewCurrentRecord of iObj riOld riNew
32843>>>>>       // must also refresh all defined extended fields
32843>>>>>       Send ExtendedFieldsRefresh (IsNullRowId(riNew)) // pass bCleared (true if a clear)
32844>>>>>       Get Focus of Desktop to iFoc
32845>>>>>       Get Extended_DEO_State of iFoc to iIsExt     // if focus is deo item
32846>>>>>       If iIsExt Begin                               // disable the state so
32848>>>>>          Get Entry_Refresh_State of iFoc to iOldSt // value will come
32849>>>>>          set Entry_Refresh_State of iFoc to True   // from Local buffer.
32850>>>>>       End
32850>>>>>>
32850>>>>>       Set Existing_Key_Value to (Key_Value(self))
32851>>>>>       If iIsExt ;          Set Entry_Refresh_State of iFoc to iOldSt
32854>>>>>       // Only set defaults when the record is new
32854>>>>>       If (IsNullRowId(riNew)) Send Prepare_Default_Values
32857>>>>>    End
32857>>>>>>
32857>>>>>  End_Procedure
32858>>>>>
32858>>>>>  //************************************************************************//
32858>>>>>  // Procedure Prepare_Default_Values                                       //
32858>>>>>  // Shuts off change mode and sends initialize_default_values which is     //
32858>>>>>  // a user hook routine.                                                   //
32858>>>>>  //************************************************************************//
32858>>>>>
32858>>>>>    Procedure Prepare_Default_Values
32860>>>>>        Integer iOldState
32860>>>>>        Get Change_disabled_State to iOldState
32861>>>>>        Set Change_disabled_State to True
32862>>>>>        Send Private_Field_Defaults
32863>>>>>        // set defaults if this is the main DDO or the DDO is
32863>>>>>        // flagged as supporting saving new records when foreign (a parent)
32863>>>>>        If (Operation_Origin=Self or ;         Allow_Foreign_New_Save_State(Self)) ;           Send Field_Defaults
32866>>>>>        Send AssignDynamicDefaults
32867>>>>>        Set Change_disabled_State to iOldState
32868>>>>>    End_Procedure
32869>>>>>    
32869>>>>>
32869>>>>>  //************************************************************************//
32869>>>>>  // Private_Field_Defaults                                                 //
32869>>>>>  // Set all checkbox fields to default to False data value.                //
32869>>>>>  //************************************************************************//
32869>>>>>
32869>>>>>  Procedure Private_Field_Defaults
32871>>>>>    Integer iField
32871>>>>>    Repeat
32871>>>>>>
32871>>>>>       Get Next_Validation_Type of (Field_Attributes(self)) ;               FA_VALIDATION_TYPE_CHECKBOX iField to iField
32872>>>>>       If iField eq 0 Procedure_Return
32875>>>>>       Set Field_Select_State  iField to False
32876>>>>>       Set Field_Changed_State iField to True
32877>>>>>    Loop
32878>>>>>>
32878>>>>>  End_Procedure
32879>>>>>
32879>>>>>
32879>>>>>  //************************************************************************//
32879>>>>>  // Procedure Field_Defaults                                               //
32879>>>>>  // Will be called after a clear operation to let the application          //
32879>>>>>  // programmer set the default values for the record. This should be done  //
32879>>>>>  // by sending SET Field_Current_Value.                                    //
32879>>>>>  //************************************************************************//
32879>>>>>
32879>>>>>  Procedure Field_Defaults
32881>>>>>  End_Procedure
32882>>>>>
32882>>>>>  //************************************************************************//
32882>>>>>  // Function IsDataInvalid                                                 //
32882>>>>>  // Pass type and string value and see if this is valid data for this      //
32882>>>>>  // type. Currently we check for numbers and dates. Return non-zero        //
32882>>>>>  // if invalid.                                                            //
32882>>>>>  //************************************************************************//
32882>>>>>
32882>>>>>  Function IsDataInvalid integer iType String sValue Returns integer
32884>>>>>    Date    dVal
32884>>>>>    DateTime dtVal
32884>>>>>    Number  nVal
32884>>>>>    Integer bOK
32884>>>>>    Boolean bInvalid
32884>>>>>    
32884>>>>>    Move False to bInvalid
32885>>>>>    If (iType=DF_BCD or iType=DF_DATE or iType=DF_DATETIME) Begin
32887>>>>>       If (iType=DF_DATE) Begin
32889>>>>>          MoveTrapErr sValue to dVal
32890>>>>>          Move (Err) to bInvalid
32891>>>>>       End
32891>>>>>>
32891>>>>>       Else If (iType=DF_DATETIME) Begin
32894>>>>>          MoveTrapErr sValue to dtVal
32895>>>>>          Move (Err) to bInvalid
32896>>>>>//          Move (not(IsDateValid(dtVal))) to bInvalid //jjt-uncomment when working
32896>>>>>       End
32896>>>>>>
32896>>>>>       Else Begin
32897>>>>>         MoveTrapErr sValue to nVal // this may gen an error.
32898>>>>>         Move (Err) to bInvalid
32899>>>>>       End
32899>>>>>>
32899>>>>>       Indicate Err False
32900>>>>>    End
32900>>>>>>
32900>>>>>    Function_Return bInvalid
32901>>>>>  End_Function
32902>>>>>
32902>>>>>  //************************************************************************//
32902>>>>>  // Function IsDeoOwned                                                    //
32902>>>>>  // Return 1 if the passed DEO is part of the DDs list of connected DEOs   //
32902>>>>>  // First check if server of DEO is this DD. If so, we are owned. If not   //
32902>>>>>  // we must check the DD's UI DEO list.                                    //
32902>>>>>  // The passed object MUST be a valid DEO or an error will occur.          //
32902>>>>>  //************************************************************************//
32902>>>>>
32902>>>>>  Function IsDEOOwned integer iDEO Returns integer
32904>>>>>    integer iMax iCount
32904>>>>>    // if DEOs server is same as current DD it is owned. This is the
32904>>>>>    // fast check
32904>>>>>    If (Server(iDEO)=self) Function_return 1
32907>>>>>    // else see if the DEO is in the DD's DEO list
32907>>>>>    Get Data_Set_User_Interface_Count to iMax
32908>>>>>    Decrement iMax
32909>>>>>    For iCount from 0 to iMax
32915>>>>>>
32915>>>>>      If (Data_Set_User_Interface(self,iCount)=iDEO) ;         Function_return 1
32918>>>>>    Loop
32919>>>>>>
32919>>>>>    Function_Return 0
32920>>>>>  End_Function
32921>>>>>
32921>>>>>  //************************************************************************//
32921>>>>>  // Procedure Set Field_Current_Value                                      //
32921>>>>>  // This procedure changes the field value of the given field in the       //
32921>>>>>  // record-buffer object.                                                  //
32921>>>>>  // It also sends Field_Value_Changed to notify every the attached DEOs.   //
32921>>>>>  // This has been optimized so this message is only sent when data is      //
32921>>>>>  // actually changed.                                                      //
32921>>>>>  //************************************************************************//
32921>>>>>
32921>>>>>  Procedure Set Field_Current_Value Integer iField String sValue
32923>>>>>    Integer iObj
32923>>>>>    String sOldVal
32923>>>>>    Integer iChanged
32923>>>>>    Integer iType
32923>>>>>    Integer iFile
32923>>>>>    Integer iFocObj
32923>>>>>    Integer iCrnt
32923>>>>>    Integer bInvalid
32923>>>>>    integer iIdentity
32923>>>>>    Address pData
32923>>>>>    Integer iLen
32923>>>>>
32923>>>>>    Get Main_File to iFile
32924>>>>>    Get_Attribute DF_FIELD_TYPE of iFile iField to iType
32927>>>>>
32927>>>>>    // Overlap fields are not supported directly in DDs. It is expected
32927>>>>>    // that you will use the underlying fields instead
32927>>>>>    If iType EQ DF_OVERLAP Begin
32929>>>>>        Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_OVERLAP_ERROR
32930>>>>>        Procedure_return
32931>>>>>    End
32931>>>>>>
32931>>>>>
32931>>>>>    If (iType=DF_TEXT or iType=DF_BINARY) Begin // if text or binary direct to pointer
32933>>>>>        Move sValue to sValue // intentional code: make sure passed sValue is a really string
32934>>>>>        Move (Length(sValue)) to iLen // length to copy
32935>>>>>        Move (AddressOf(sValue)) to pData   // first byte of string
32936>>>>>        // will gen error if ext. field does not exist
32936>>>>>        Set Field_Current_Pointer_Value iField iLen to pData
32937>>>>>        Procedure_Return
32938>>>>>    end
32938>>>>>>
32938>>>>>
32938>>>>>
32938>>>>>    // If date or number, force conversion so any error is detected before
32938>>>>>    // the buffer is updated. We don't want the record buffer to contain
32938>>>>>    // invalid data
32938>>>>>    Get IsDataInvalid iType sValue to bInvalid
32939>>>>>    If bInvalid ;         // If an error occurred we have        Procedure_return  // a bad number or a bad date. Do no more!
32942>>>>>
32942>>>>>    Move (Record_Buffer(self)) to iObj
32943>>>>>    Get Value of iObj iField to sOldVal
32944>>>>>
32944>>>>>    Set Value of iObj iField to sValue
32945>>>>>
32945>>>>>    // Augmented to handle non DF databases JJT-11/14/2001
32945>>>>>    // Some tables may use some field other then recnum for their record identity.
32945>>>>>    // This will be dfrecnum or some other numeric field. When this happens the DD have
32945>>>>>    // to field buffers for the same value. When an update occurs from the DD to the DB buffer
32945>>>>>    // an update can occur twice. If the values are the same, this does not matter. Else the highest
32945>>>>>    // field value will get the update (not recnum). So if someone changes recnum but not its real field
32945>>>>>    // finding may not work right. The DD is updated when a record is found and the API keeps the two values
32945>>>>>    // the same. If the user changes recnum, the real field does not get changed. That is what we are fixing
32945>>>>>    // here. Note that: 1) this has no effect on Dataflex databases (or any DB that has a 0 field recnum).
32945>>>>>    // 2) this type of update is rarely seen anyway (you have to change just the recnum and perform an entry_update).
32945>>>>>    //
32945>>>>>    // if field is recnum and record identity is not 0, we must also update the other field.
32945>>>>>    If (iField=0) Begin
32947>>>>>        Get_Attribute DF_FILE_RECORD_IDENTITY of iFile to iIdentity
32950>>>>>        If (iIdentity>0) ;            Set Value of iObj iIdentity to sValue
32953>>>>>    End
32953>>>>>>
32953>>>>>
32953>>>>>    //Set Item_Changed_State of iObj iField to TRUE
32953>>>>>    //Set Changed_State of iObj to TRUE
32953>>>>>    // When data-sets are working they should not update the
32953>>>>>    // DEOs.
32953>>>>>
32953>>>>>    // prior to vdf7, we stopped all operation modes of non-zero. We now allow
32953>>>>>    // validates to pass through and we have a new operation mode for this. This
32953>>>>>    // should be ok, since we already allowed navigation validation through - we just
32953>>>>>    // stopped request_validate validations.
32953>>>>>    If (Operation_Mode=0 OR Operation_Mode=MODE_VALIDATING) Begin
32955>>>>>       If (iType=DF_BCD) ;          Move (Number(sValue)<>Number(sOldVal)) to iChanged
32958>>>>>       Else If (iType=DF_DATE) ;          Move (Date(sValue)<>Date(sOldVal)) to iChanged
32962>>>>>       Else If (iType=DF_DATETIME) ;          Move (Cast(sValue,DateTime)<>Cast(sOldVal,DateTime)) to iChanged
32966>>>>>       Else ;          Move (sValue<>sOldVal) to iChanged
32968>>>>>       // if changed, notify all DEOs of this change
32968>>>>>       If iChanged ;          Send Field_Value_Changed iField sValue
32971>>>>>       Else Begin
32972>>>>>          // If here the set value did not change the contents of the DD.
32972>>>>>          // However, it is possible that the current focus DEO may contain
32972>>>>>          // a different value than the one we are setting. In such a case
32972>>>>>          // we must re-synchronize the DEO. Only the one DEO can be affected
32972>>>>>          // because it is the current focus deo/item that can contain a value
32972>>>>>          // that is not yet updated in the DD. This fixes a bug where the
32972>>>>>          // iexit was setting a value which was different from what was in
32972>>>>>          // the DEO but was the same as the old DD value (iExit is called
32972>>>>>          // before the DD is re-synched with the DEO). This could happen
32972>>>>>          // also by sending this message directly with a different value in
32972>>>>>          // the DEO focus item.
32972>>>>>          Get Focus of Desktop to iFocObj
32973>>>>>          // similar logic to Get Field_Current_Value. We check that the DEO
32973>>>>>          // is extended, that entry_refresh is not disabled and that the
32973>>>>>          // DEO's server is this DD.
32973>>>>>          If ( Extended_DEO_State(iFocObj) AND ;               (Entry_Refresh_State(iFocObj)=0)) Begin
32975>>>>>             Get Current_item of iFocObj to iCrnt
32976>>>>>             // If Focus DEO has same file and field and it is not checkbox
32976>>>>>             // we must set its value. Set local value directly sets the value
32976>>>>>             // in the DEO item. If we used value we'd get recursion!
32976>>>>>             If ( Data_File(iFocObj,iCrnt)=iFile AND ;                  Data_Field(iFocObj,iCrnt)=iField AND ;                  IsDEOOwned(self,iFocObj) AND ;                  Checkbox_item_State(iFocObj,iCrnt)=0 ) ;                     Send File_Field_Value_Changed to iFocObj iFile iField sValue TRUE
32979>>>>>                     //Set Local_Value of iFocObj iCrnt to sValue
32979>>>>>          End
32979>>>>>>
32979>>>>>       End
32979>>>>>>
32979>>>>>    End
32979>>>>>>
32979>>>>>  End_Procedure
32980>>>>>
32980>>>>>  //************************************************************************//
32980>>>>>  // Procedure Set Field_Changed_Value                                      //
32980>>>>>  // Sets Field_Current_Value and Sets Field_Changed_State for passed field.//
32980>>>>>  //************************************************************************//
32980>>>>>
32980>>>>>  Procedure Set Field_Changed_Value Integer iField String sValue
32982>>>>>    Set Field_Changed_State iField to TRUE
32983>>>>>    Set Field_Current_Value iField to sValue
32984>>>>>  End_Procedure
32985>>>>>
32985>>>>>
32985>>>>>  // This should only be set by a DEO that is changing a NoPut value. This should only happen when NoEnter=F
32985>>>>>  // for indexed findable noput deos. With foreign-field noputs we may store the value and update them
32985>>>>>  // for finds but we don't want them for saves. The cDDBuffer class handles this but it needs to
32985>>>>>  // know if this was a DEO NoPut update. DDOs have always allowed you to directly update foreign NoPut
32985>>>>>  // fields when the change did not come from a DEO. 
32985>>>>>  Procedure Set Field_NoPutValueChangedByDeo Integer iField Boolean bChange
32987>>>>>    Set Item_ChangedByDeo of Record_Buffer iField to bChange
32988>>>>>  End_Procedure
32989>>>>>
32989>>>>>  Procedure Set File_Field_NoPutValueChangedByDeo Integer iFile Integer iField Boolean bChange
32991>>>>>    Integer iDSO
32991>>>>>    Get Data_set iFile to iDSO
32992>>>>>    If iDSO Begin
32994>>>>>       Set Field_NoPutValueChangedByDeo of iDSO iField to bChange
32995>>>>>    End
32995>>>>>>
32995>>>>>  End_Procedure
32996>>>>>  
32996>>>>>  //************************************************************************//
32996>>>>>  // Function Field_Current_Value                                           //
32996>>>>>  // Returns the value from the record buffer for the field of which the    //
32996>>>>>  // fieldnumber has been passed.                                           //
32996>>>>>  // If the file/field requested is the focus file/field the use the DEO's  //
32996>>>>>  // value.                                                                 //
32996>>>>>  //*************************************************************************//
32996>>>>>
32996>>>>>  Function Field_Current_Value Integer iField Returns String
32998>>>>>    Integer iType
32998>>>>>    Integer iFile
32998>>>>>    String  sValue
32998>>>>>    Integer iFoc
32998>>>>>    Integer iCrnt
32998>>>>>    Integer iStrSize
32998>>>>>    Integer iFldSize iVoid
32998>>>>>    UChar[] UCData
32999>>>>>
32999>>>>>    Get Focus of desktop to iFoc
33000>>>>>    Get Main_File to iFile
33001>>>>>    Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33004>>>>>
33004>>>>>    // Overlap fields are not supported directly in DDs. It is expected
33004>>>>>    // that you will use the underlying fields instead
33004>>>>>    If (iType=DF_OVERLAP) Begin
33006>>>>>        Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_OVERLAP_ERROR
33007>>>>>        Function_Return ''
33008>>>>>    End
33008>>>>>>
33008>>>>>
33008>>>>>    If (iType=DF_TEXT or iType=DF_BINARY) Begin // if overlap, text or binary direct to pointer
33010>>>>>       Get Field_Current_UCAValue iField to UCData
33011>>>>>
33011>>>>>       // we assume a string is passed here. If we return to a string the
33011>>>>>       // pointer message will convert this to a string. First check that max string
33011>>>>>       // length is ok for this field.
33011>>>>>       Get_Argument_Size to iStrSize
33012>>>>>       Move (SizeOfArray(UCData)) to iFldSize
33013>>>>>       // check that the string size is large enough to hold the value
33013>>>>>       If (iStrSize < iFldSize) Begin
33015>>>>>          Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_FIELD_TOO_BIG
33016>>>>>       End
33016>>>>>>
33016>>>>>       Else Begin
33017>>>>>          Move (UCharArrayToString(UCData)) to sValue 
33018>>>>>       End
33018>>>>>>
33018>>>>>       // This function has always returned the value as a 0 delimited string.
33018>>>>>       // Therefore trim at first zero. This means that you should not use this method
33018>>>>>       // with Binary types as embedded zeros will cause a truncation.
33018>>>>>       Move (CString(sValue)) to sValue
33019>>>>>       Function_Return sValue
33020>>>>>    End
33020>>>>>>
33020>>>>>
33020>>>>>    // This was extended to also make sure that the focus's server
33020>>>>>    // is this DD. This prevent the (very unlikely) case of a focus
33020>>>>>    // file/field being the right file/field but for a different view.
33020>>>>>    // 12.1: Also check operation mode, if within an operation assume that the
33020>>>>>    // ddos have the information they need from the deos. During a refresh we don't
33020>>>>>    // the data to be taken from a DEO - the DD buffer has the information you want. Note that
33020>>>>>    // we also changed all methods that set operation_mode to update the DD with the current
33020>>>>>    // DEO field, so the buffer is always correct.
33020>>>>>    If ( (OPERATION_MODE=MODE_WAITING) and ;         Extended_DEO_State(iFoc) and (Entry_Refresh_State(iFoc)=0) ) Begin
33022>>>>>       Get Current_item of iFoc to iCrnt
33023>>>>>       If ( Data_File(iFoc,iCrnt)=iFile and Data_Field(iFoc,iCrnt)=iField and ;            IsDEOOwned(Self,iFoc) and ;            (Checkbox_item_State(iFoc,iCrnt)=0) ) Begin
33025>>>>>               Get Data_Value of iFoc iCrnt to sValue
33026>>>>>       End
33026>>>>>>
33026>>>>>//       If ( Data_File(iFoc,iCrnt)=iFile and Data_Field(iFoc,iCrnt)=iField and ;
33026>>>>>//            IsDEOOwned(Self,iFoc) and ;
33026>>>>>//            (Checkbox_item_State(iFoc,iCrnt)=0) and ;
33026>>>>>//            (Item_NoPut(iFoc,iCrnt)=0) ) Begin
33026>>>>>//               Get Data_Value of iFoc iCrnt to sValue
33026>>>>>//       End
33026>>>>>       Else Begin
33027>>>>>          Get Value of (Record_Buffer(Self)) iField to sValue
33028>>>>>       End
33028>>>>>>
33028>>>>>    End
33028>>>>>>
33028>>>>>    Else Begin
33029>>>>>       Get Value of (Record_Buffer(Self)) iField to sValue
33030>>>>>    End
33030>>>>>>
33030>>>>>    
33030>>>>>    // cast value to the proper datatype
33030>>>>>    If (iType=DF_BCD) Begin
33032>>>>>       Function_Return (Number(sValue))
33033>>>>>    End
33033>>>>>>
33033>>>>>    Else If (iType=DF_DATE) Begin
33036>>>>>       Function_Return (Date(sValue))
33037>>>>>    End
33037>>>>>>
33037>>>>>    Else If (iType=DF_DATETIME) Begin
33040>>>>>       Function_Return (Cast(sValue,DateTime))
33041>>>>>    End
33041>>>>>>
33041>>>>>    // else return as string
33041>>>>>    Function_Return sValue
33042>>>>>  End_Function
33043>>>>>
33043>>>>>  //************************************************************************//
33043>>>>>  // Procedure Set Field_Default_Value                                      //
33043>>>>>  // Procedure Set File_Field_Default_Value                                 //
33043>>>>>  // This sets a default value without setting the DSO's changed_State      //
33043>>>>>  //************************************************************************//
33043>>>>>
33043>>>>>  Procedure Set Field_Default_Value Integer iField String sValue
33045>>>>>    integer iOldState
33045>>>>>    Get Change_disabled_State to iOldState
33046>>>>>    Set Change_disabled_State to TRUE
33047>>>>>    Set Field_Changed_Value iField to sValue
33048>>>>>    Set Change_disabled_State to iOldState
33049>>>>>  End_Procedure
33050>>>>>
33050>>>>>  procedure Set File_Field_default_Value integer iFile integer iField string sValue
33052>>>>>    integer iDSO
33052>>>>>    Get Data_set iFile to iDSO
33053>>>>>    If iDSO ;       Set Field_default_Value of iDSO iField to sValue
33056>>>>>  End_Procedure
33057>>>>>
33057>>>>>  //************************************************************************//
33057>>>>>  // Get/Set File_Field_Current_Value                                       //
33057>>>>>  // Set     File_Field_Changed_Value                                       //
33057>>>>>  // Methods to set and get the value of a field. When set all DSOs and     //
33057>>>>>  // DEOs are notified.                                                     //
33057>>>>>  //************************************************************************//
33057>>>>>
33057>>>>>  Procedure Set File_Field_Current_Value Integer iFile Integer iField String sValue
33059>>>>>    integer iDSO
33059>>>>>    Get Data_set iFile to iDSO
33060>>>>>    If iDSO ;      Set Field_Current_Value of iDSO iField to sValue
33063>>>>>  End_Procedure
33064>>>>>
33064>>>>>  Procedure Set File_Field_Changed_Value Integer iFile Integer iField String sValue
33066>>>>>    integer iDSO
33066>>>>>    Get Data_set iFile to iDSO
33067>>>>>    If iDSO ;      Set Field_Changed_Value of iDSO iField to sValue
33070>>>>>  End_Procedure
33071>>>>>
33071>>>>>  Function File_Field_Current_Value Integer iFile Integer iField returns string
33073>>>>>    integer iDSO
33073>>>>>    String sValue
33073>>>>>    Get Data_set iFile to iDSO
33074>>>>>    If iDSO ;      Get Field_Current_Value of iDSO iField to sValue
33077>>>>>    Function_Return sValue
33078>>>>>  End_Function
33079>>>>>
33079>>>>>
33079>>>>>  //************************************************************************//
33079>>>>>  // Procedure Field_Value_Changed                                          //
33079>>>>>  // This procedure will notify every attached DEO that the value of a      //
33079>>>>>  // field has been changed. Every DEO needs to update its value to reflect //
33079>>>>>  // the new value.                                                         //
33079>>>>>  //************************************************************************//
33079>>>>>
33079>>>>>  Procedure Field_Value_Changed Integer iField String sValue
33081>>>>>    Integer iMax
33081>>>>>    Integer iCount
33081>>>>>    Integer iDEO
33081>>>>>    Integer iMain_File
33081>>>>>    Integer iNoChange
33081>>>>>    Get Change_Disabled_State to iNoChange
33082>>>>>    Get Main_File to iMain_File
33083>>>>>    Get Data_Set_User_Interface_Count to iMax
33084>>>>>    Decrement iMax
33085>>>>>    For iCount from 0 to iMax
33091>>>>>>
33091>>>>>      Get Data_Set_User_Interface iCount to iDEO
33092>>>>>      If (Extended_DEO_State(iDEO) ) Begin
33094>>>>>         Send File_Field_Value_Changed to iDEO iMain_File iField sValue iNoChange
33095>>>>>      End
33095>>>>>>
33095>>>>>    Loop
33096>>>>>>
33096>>>>>  End_Procedure
33097>>>>>
33097>>>>>
33097>>>>>  //************************************************************************//
33097>>>>>  // Get/Set Field_Changed_State                                            //
33097>>>>>  // Gets/Sets Field_Changed_State of the passed field. Will Set Changed_   //
33097>>>>>  // state if appropriate (if change_disabled_state is false)               //
33097>>>>>  //************************************************************************//
33097>>>>>
33097>>>>>
33097>>>>>  Function Field_Changed_State Integer iField Returns Integer
33099>>>>>    Function_Return ;        (Item_Changed_State(Record_Buffer(self), iField))
33100>>>>>  End_Function
33101>>>>>
33101>>>>>
33101>>>>>  // Handle NoPut here. If the field is noput set the field_changed_State but do not set the
33101>>>>>  // DD's changed_state. As of 17.0, we changed the rule so that noput DEOs always update the DD.
33101>>>>>  // They set the field_Current_value and they set the field_changed_state. If noput they will
33101>>>>>  // not set changed_state. This now makes windows and web consistent.
33101>>>>>
33101>>>>>  Procedure Set Field_Changed_State Integer iField Integer iState
33103>>>>>    Boolean bNoPut bOldSt bIsCommitted
33103>>>>>    
33103>>>>>    Get Field_Option iField DD_NOPUT to bNoPut
33104>>>>>    If not bNoPut Begin // if not noput, see if this is a committed and therefore noput
33106>>>>>        Get IsCommitted iField to bIsCommitted
33107>>>>>        If bIsCommitted Begin
33109>>>>>           Get IsFieldCommitted iField to bNoPut
33110>>>>>        End
33110>>>>>>
33110>>>>>    End
33110>>>>>>
33110>>>>>
33110>>>>>    If bNoPut Begin
33112>>>>>         Get Change_disabled_State to bOldSt
33113>>>>>         Set Change_disabled_State to True
33114>>>>>    End
33114>>>>>>
33114>>>>>    
33114>>>>>    Set Item_Changed_State of (Record_Buffer(Self)) iField to iState
33115>>>>>    // the cDDBuffer class item_changed_state does not attempt to set
33115>>>>>    // changed_state, so we do it here. This will allow for future
33115>>>>>    // greater flexibilities.
33115>>>>>    If (iState) Begin
33117>>>>>        Set Changed_State of (Record_Buffer(Self)) to True
33118>>>>>    End
33118>>>>>>
33118>>>>>    If bNoPut Begin
33120>>>>>         Set Change_disabled_State to bOldSt
33121>>>>>    End
33121>>>>>>
33121>>>>>
33121>>>>>  End_Function
33122>>>>>
33122>>>>>
33122>>>>>  //************************************************************************//
33122>>>>>  // Get/Set File_Field_Changed_State                                       //
33122>>>>>  // As above, but passes both file and field                               //
33122>>>>>  //************************************************************************//
33122>>>>>
33122>>>>>  Function File_Field_Changed_State Integer iFile Integer iField Returns Integer
33124>>>>>    Integer iDSO
33124>>>>>    Get Data_Set iFile to iDSO
33125>>>>>    If iDSO ;      Function_Return (Field_Changed_State(iDSO, iField))
33128>>>>>  End_Function
33129>>>>>
33129>>>>>  Procedure Set File_Field_Changed_State Integer iFile Integer iField Integer iState
33131>>>>>    Integer iDSO
33131>>>>>    Get Data_Set iFile to iDSO
33132>>>>>    If iDSO ;       Set Field_Changed_State of iDSO iField to iState
33135>>>>>  End_Function
33136>>>>>
33136>>>>>  //************************************************************************//
33136>>>>>  // This simulates entering a value into a field from a keyboard. Pass the //
33136>>>>>  // Field and DD Options and the value. It is up to you to pass the proper //
33136>>>>>  // DD options. This is normally sent by File_Field_Entry and you are      //
33136>>>>>  // advised to use that message and not this one.                          //
33136>>>>>  //************************************************************************//
33136>>>>>
33136>>>>>  Procedure set Field_Entry integer iField integer iOpts integer bShowErr String sValue
33138>>>>>      integer iFile
33138>>>>>      Integer iType
33138>>>>>      Integer bChanged
33138>>>>>      Integer bInvalid
33138>>>>>      Integer hObj
33138>>>>>      String sOldVal
33138>>>>>      Address pData
33138>>>>>      Integer iLen
33138>>>>>
33138>>>>>      Get Main_File to iFile
33139>>>>>
33139>>>>>      // if No-enter or Displayonly, this shouldn't be changed. We will
33139>>>>>      // let NoPut through, since a user might need it for finding.
33139>>>>>      If (iOpts IAND DD_NOENTER) Procedure_Return
33142>>>>>
33142>>>>>      // Force a caplsock if required
33142>>>>>      If (iOpts IAND DD_CAPSLOCK) Move (Uppercase(sValue)) to sValue
33145>>>>>
33145>>>>>      // If date or number, force conversion so any error is detected before
33145>>>>>      // the buffer is updated. We don't want the record buffer to contain
33145>>>>>      // invalid data
33145>>>>>      Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33148>>>>>
33148>>>>>      // Overlap fields are not supported directly in DDs. It is expected
33148>>>>>      // that you will use the underlying fields instead
33148>>>>>      If iType EQ DF_OVERLAP Begin
33150>>>>>          Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_OVERLAP_ERROR
33151>>>>>          Procedure_return
33152>>>>>      End
33152>>>>>>
33152>>>>>
33152>>>>>      If (iType=DF_TEXT or iType=DF_BINARY) Begin // if text or binary direct to pointer
33154>>>>>          Move sValue to sValue // intentional code: make sure passed sValue is a really string
33155>>>>>          Move (Length(sValue)) to iLen // length to copy
33156>>>>>          Move (AddressOf(sValue)) to pData   // first byte of string
33157>>>>>          // will gen error if ext. field does not exist
33157>>>>>          Set Field_Pointer_Entry iField iOpts iLen bShowErr to pData
33158>>>>>          Procedure_Return
33159>>>>>      end
33159>>>>>>
33159>>>>>
33159>>>>>      Get IsDataInvalid iType sValue to bInvalid
33160>>>>>      If bInvalid begin     // If an error occurred we have
33162>>>>>         If bShowErr ;            Send Data_set_error iField (If(iType=DF_DATE or iType=DF_DATETIME, DFERR_ENTER_VALID_DATE, DFERR_BAD_ENTRY)) ;                   (" ("-sValue-")")
33165>>>>>         Procedure_return  // a bad number or a bad date. Do no more!
33166>>>>>      end
33166>>>>>>
33166>>>>>      // update the value only if the value is changed.
33166>>>>>      Move (Record_Buffer(self)) to hObj
33167>>>>>      Get Value of hObj iField to sOldVal
33168>>>>>      If (iType=DF_BCD) ;         Move (Number(sValue)<>Number(sOldVal)) to bChanged
33171>>>>>      Else If (iType=DF_DATE) ;         Move (Date(sValue)<>Date(sOldVal)) to bChanged
33175>>>>>      Else If (iType=DF_DATETIME) ;         Move (Cast(sValue,DateTime)<>Cast(sOldVal,DateTime)) to bChanged
33179>>>>>      Else ;         Move (sValue<>sOldVal) to bChanged
33181>>>>>
33181>>>>>      // if changed or force put, update the value.
33181>>>>>      If ( bChanged or (iOpts IAND DD_FORCEPUT) ) ;         Set Field_Current_Value iField to sValue
33184>>>>>
33184>>>>>      // Set changed state if changed. This is an improvement on DEOs which would set changed-state for
33184>>>>>      // a no-put. Set Field_Changed_State will not set Changed_state if it is noput
33184>>>>>      If ( bChanged) Begin
33186>>>>>         Set Field_Changed_State iField to True
33187>>>>>         // if noput (but not noenter) we must tell the DDO that this should not be
33187>>>>>         // updated during a save.
33187>>>>>         If (iOpts iand DD_NOPUT) Begin
33189>>>>>             Set Field_NoPutValueChangedByDeo iField to True
33190>>>>>         End
33190>>>>>>
33190>>>>>      End
33190>>>>>>
33190>>>>>
33190>>>>>      // perform autofinds if needed. Note that required checking will occur as
33190>>>>>      // part of validation.
33190>>>>>      // We will only autofind if the field value is changed. This is consistent with
33190>>>>>      // DEOs which do not autofind on unchanged values. This provides optimizations
33190>>>>>      // when a parent record is already loaded.
33190>>>>>      If (bChanged OR Field_Changed_state(self,iField)) Begin
33192>>>>>         // note that autofind is 1 and _ge is 100000001 (8th bit set). So order of
33192>>>>>         // testing is important and make sure we test for exact bit match. Must first
33192>>>>>         // test _GE and the EQ (because EQ bit is part of GE)
33192>>>>>         If ((iOpts IAND DD_AUTOFIND_GE)=DD_AUTOFIND_GE) Send File_Field_AutoFind iFile iField GE
33195>>>>>         else If ((iOpts IAND DD_AUTOFIND)=DD_AUTOFIND)  Send File_Field_AutoFind iFile iField EQ
33199>>>>>      End
33199>>>>>>
33199>>>>>
33199>>>>>  End_Procedure
33200>>>>>
33200>>>>>  // **********************************************************************
33200>>>>>  // Private: This returns file-field options for a Field_Entry type of environment.
33200>>>>>  // It will strip autofind from main-file DDs but leave foreign field alone.
33200>>>>>  // This is needed for Field_entry. Otherwise adding a field value to an autofind
33200>>>>>  // for save or find causes an autofind to trigger first which either causes the
33200>>>>>  // wrong rec to save or for a double find.
33200>>>>>  // **********************************************************************
33200>>>>>
33200>>>>>  Function File_Field_Entry_Options integer iFile integer iField returns integer
33202>>>>>       integer iOpts
33202>>>>>       // this will get the appropriate field and foreign field opts
33202>>>>>       Get File_Field_Options iFile iField to iOpts
33203>>>>>       // If the main file (not foreign) we will strip autofind. Autofind should not
33203>>>>>       // be an automatic part of main file entry while it should with foreign fields.
33203>>>>>       If (iFile=Main_File(Self)) Begin
33205>>>>>          // note that autofind is 1 and _ge is 100000001 (8th bit set). So order of
33205>>>>>          // testing is important and make sure we test for exact bit match. Must first
33205>>>>>          // test _GE and the EQ (because EQ bit is part of GE)
33205>>>>>          If ((iOpts IAND DD_AUTOFIND_GE)=DD_AUTOFIND_GE) Move (iOpts - DD_AUTOFIND_GE) to iOpts
33208>>>>>          else If ((iOpts IAND DD_AUTOFIND)=DD_AUTOFIND)  Move (iOpts - DD_AUTOFIND)    to iOpts
33212>>>>>       end
33212>>>>>>
33212>>>>>       Function_Return iOpts
33213>>>>>   End_Function
33214>>>>>
33214>>>>>
33214>>>>>
33214>>>>>  //************************************************************************//
33214>>>>>  // This simulates entering a value into a field from a keyboard. The DD   //
33214>>>>>  // receiving this message determines if it is Main or Foreign (just like  //
33214>>>>>  // server). It will do an uppercase, will respect No_Enter and DisplayOnly//
33214>>>>>  // and will do a autofind if required. It does not do a field validation. //
33214>>>>>  //************************************************************************//
33214>>>>>
33214>>>>>  Procedure set File_Field_Entry integer iFile integer iField integer bShowErr string sValue
33216>>>>>      integer iOpts
33216>>>>>      integer hDD
33216>>>>>      Get Data_Set iFile to hDD
33217>>>>>      If hDD Begin
33219>>>>>         // this will get the appropriate field and foreign field opts
33219>>>>>         Get File_Field_Entry_Options iFile iField to iOpts
33220>>>>>         Set Field_Entry of hDD iField iOpts bShowErr to sValue
33221>>>>>      End
33221>>>>>>
33221>>>>>  End_Procedure
33222>>>>>
33222>>>>>
33222>>>>>
33222>>>>>  //************************************************************************//
33222>>>>>  // return object ID of extended field, 0 if none                          //
33222>>>>>  //************************************************************************//
33222>>>>>
33222>>>>>  Function Field_Object integer iField Returns integer
33224>>>>>      Integer hoFlds hoField
33224>>>>>      Boolean bAutoAssign
33224>>>>>      Get Field_Objects to hoFlds
33225>>>>>      If hoFlds Begin
33227>>>>>          Get Field_Object of hoFlds iField to hoField
33228>>>>>      End
33228>>>>>>
33228>>>>>      If not hoField Begin
33230>>>>>         Send DefineExtendedField iField // will create field_objects and Field_Object as needed
33231>>>>>         Get Field_Objects to hoFlds
33232>>>>>         Get Field_Object of hoFlds iField to hoField
33233>>>>>      End
33233>>>>>>
33233>>>>>      Function_Return hoField
33234>>>>>  End_Function
33235>>>>>
33235>>>>>  //************************************************************************//
33235>>>>>  // This is the same as Field_entry except the value is passed via a       //
33235>>>>>  // pointer. If data-type is extended (text/binary) it will use and an     //
33235>>>>>  // extended field object to handle this. If date/number/string we will    //
33235>>>>>  // convert this to a string and use Field_Entry. It is the caller's       //
33235>>>>>  // responsibility to pass a valid pointer to valid data...else !@#$%^&^   //
33235>>>>>  // If an extended Field object is needed and not defined, an error is     //
33235>>>>>  // returned. If pointer is null, assume empty string passed (this is a    //
33235>>>>>  // change as of 8.3 - it used to ignore null pointers)                    //
33235>>>>>  //************************************************************************//
33235>>>>>
33235>>>>>  Procedure Set Field_Pointer_Entry integer iField integer iOpts integer iLen integer bShowErr Address pData
33237>>>>>      integer hFld
33237>>>>>      string  sValue
33237>>>>>      integer iFile
33237>>>>>      integer iType
33237>>>>>
33237>>>>>      Get Main_file to iFile
33238>>>>>      Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33241>>>>>
33241>>>>>      // Overlap fields are not supported directly in DDs. It is expected
33241>>>>>      // that you will use the underlying fields instead
33241>>>>>      If iType EQ DF_OVERLAP ;         Send Data_set_Error iField DFERR_PROGRAM  DD_EXTENDED_OVERLAP_ERROR
33244>>>>>      Else If (iType=DF_TEXT or iType=DF_BINARY) Begin
33247>>>>>         Get Field_Object iField to hFld // the object that handles this large text
33248>>>>>         If hFld ;            Set Field_pEntry of hFld iOpts iLen bShowErr to pData
33251>>>>>         Else ;            Send Data_set_Error iField DFERR_PROGRAM  DD_EXTENDED_FIELD_NOT_DEFINED
33253>>>>>      end
33253>>>>>>
33253>>>>>      Else Begin
33254>>>>>         // if number,date or string convert the pointer data to
33254>>>>>         // string data and do a normal entry with it.
33254>>>>>         Move pData to sValue // create string from pointer data
33255>>>>>         Set Field_Entry iField iOpts bShowErr to sValue
33256>>>>>      End
33256>>>>>>
33256>>>>>  End_procedure
33257>>>>>
33257>>>>>  //************************************************************************//
33257>>>>>  // This is the same as File_Field_entry except the value is passed via a  //
33257>>>>>  // pointer. See Field_Pointer_Entry for more on this                      //
33257>>>>>  //************************************************************************//
33257>>>>>
33257>>>>>  Procedure Set File_Field_Pointer_Entry integer iFile integer iField integer iLen integer bShowErr Address pData
33259>>>>>      integer iOpts
33259>>>>>      integer hDD
33259>>>>>      Get Data_Set iFile to hDD
33260>>>>>      If hDD Begin
33262>>>>>         // this will get the appropriate field and foreign field opts
33262>>>>>         Get File_Field_Entry_Options iFile iField to iOpts
33263>>>>>         Set Field_Pointer_Entry of hDD iField iOpts iLen bShowErr to pData
33264>>>>>      End
33264>>>>>>
33264>>>>>  End_procedure
33265>>>>>
33265>>>>>  //************************************************************************//
33265>>>>>  // This is the same as Field_Current_Value except the value is passed via //
33265>>>>>  // a pointer. If data-type is extended (text/binary) it will use and an   //
33265>>>>>  // extended field object to handle this. If date/number/string we will    //
33265>>>>>  // convert this to a string and use Field_Entry. It is the caller's       //
33265>>>>>  // responsibility to pass a valid pointer to valid data...else !@#$%^&^   //
33265>>>>>  // If an extended Field object is needed and not defined, an error is     //
33265>>>>>  // returned. If pointer is null, assume empty string passed (this is a    //
33265>>>>>  // change as of 8.3 - it used to ignore null pointers)                    //
33265>>>>>  //************************************************************************//
33265>>>>>
33265>>>>>  Procedure Set Field_Current_Pointer_Value integer iField integer iLen Address pData
33267>>>>>      integer hFld
33267>>>>>      string  sValue
33267>>>>>      Integer iFile iType iCrnt
33267>>>>>      Handle iFocObj
33267>>>>>      Boolean bChanged
33267>>>>>
33267>>>>>      Get Main_file to iFile
33268>>>>>      Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33271>>>>>
33271>>>>>      // Overlap fields are not supported directly in DDs. It is expected
33271>>>>>      // that you will use the underlying fields instead
33271>>>>>      If iType EQ DF_OVERLAP Begin
33273>>>>>         Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_OVERLAP_ERROR
33274>>>>>         Procedure_Return
33275>>>>>      End
33275>>>>>>
33275>>>>>
33275>>>>>      If (iType<>DF_TEXT and iType<>DF_BINARY) Begin
33277>>>>>         // if number,date or string convert the pointer data to
33277>>>>>         // string data and do a normal entry with it.
33277>>>>>         Move pData to sValue // create string from pointer data
33278>>>>>         Set Field_Current_Value iField to sValue
33279>>>>>         Procedure_Return
33280>>>>>      End
33280>>>>>>
33280>>>>>
33280>>>>>     Get Field_Object iField to hFld // the object that handles this large text
33281>>>>>     If not hFld Begin
33283>>>>>        Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_FIELD_NOT_DEFINED
33284>>>>>        Procedure_Return
33285>>>>>     End
33285>>>>>>
33285>>>>>
33285>>>>>        Get Is_pValueChanged of hFld iLen pData to bChanged
33286>>>>>        If bChanged Begin
33288>>>>>          Set Field_pValue of hFld iLen to pData
33289>>>>>          Send Field_Pointer_Value_Changed iField pData
33290>>>>>        End
33290>>>>>>
33290>>>>>       Else Begin
33291>>>>>          // If here the set value did not change the contents of the DD.
33291>>>>>          // However, it is possible that the current focus DEO may contain
33291>>>>>          // a different value than the one we are setting. In such a case
33291>>>>>          // we must re-synchronize the DEO. Only the one DEO can be affected
33291>>>>>          // because it is the current focus deo/item that can contain a value
33291>>>>>          // that is not yet updated in the DD. This fixes a bug where the
33291>>>>>          // iexit was setting a value which was different from what was in
33291>>>>>          // the DEO but was the same as the old DD value (iExit is called
33291>>>>>          // before the DD is re-synched with the DEO). This could happen
33291>>>>>          // also by sending this message directly with a different value in
33291>>>>>          // the DEO focus item.
33291>>>>>          Get Focus of Desktop to iFocObj
33292>>>>>          // similar logic to Get Field_Pointer_Current_Value. We check that the DEO
33292>>>>>          // is extended, that entry_refresh is not disabled and that the
33292>>>>>          // DEO's server is this DD.
33292>>>>>          If ( Extended_DEO_State(iFocObj) and (Entry_Refresh_State(iFocObj)=0)) Begin
33294>>>>>             // If Focus DEO has same file and field and it is not checkbox
33294>>>>>             // we must set its value. Set local value directly sets the value
33294>>>>>             // in the DEO item. If we used value we'd get recursion!
33294>>>>>             Get Current_item of iFocObj to iCrnt
33295>>>>>             If ( Data_File(iFocObj,iCrnt)=iFile and ;                  Data_Field(iFocObj,iCrnt)=iField and ;                  IsDEOOwned(Self,iFocObj) ) Begin
33297>>>>>                     Send File_Field_Pointer_Value_Changed to iFocObj iFile iField pData True
33298>>>>>                  End
33298>>>>>>
33298>>>>>          End
33298>>>>>>
33298>>>>>       End
33298>>>>>>
33298>>>>>  End_Procedure
33299>>>>>
33299>>>>>  // This is never called but it needed for the compiler. Required for apps DDs that don't compile in a DEO interface
33299>>>>>  Procedure File_Field_Pointer_Value_Changed Integer iFile Integer iField Address pValue Integer iChangeDisabled
33301>>>>>  End_Procedure
33302>>>>>
33302>>>>>  Procedure Field_Pointer_Value_Changed Integer iField Address pValue
33304>>>>>    Integer iMax
33304>>>>>    Integer iCount
33304>>>>>    Integer iDEO
33304>>>>>    Integer iMain_File
33304>>>>>    Integer iNoChange
33304>>>>>    Get Change_Disabled_State to iNoChange
33305>>>>>    Get Main_File to iMain_File
33306>>>>>    Get Data_Set_User_Interface_Count to iMax
33307>>>>>    Decrement iMax
33308>>>>>    For iCount from 0 to iMax
33314>>>>>>
33314>>>>>      Get Data_Set_User_Interface iCount to iDEO
33315>>>>>      If (Extended_DEO_State(iDEO) ) Begin
33317>>>>>         Send File_Field_Pointer_Value_Changed to iDEO iMain_File iField pValue iNoChange
33318>>>>>      End
33318>>>>>>
33318>>>>>    Loop
33319>>>>>>
33319>>>>>  End_Procedure
33320>>>>>
33320>>>>>
33320>>>>>  //************************************************************************//
33320>>>>>  // This is the same as File_Field_Current_Value except the value is passed//
33320>>>>>  // via a pointer. See Field_current_Pointer_Value for more on this        //
33320>>>>>  //************************************************************************//
33320>>>>>
33320>>>>>  Procedure Set File_Field_Current_Pointer_Value integer iFile integer iField integer iLen Address pData
33322>>>>>      integer hDD
33322>>>>>      Get Data_Set iFile to hDD
33323>>>>>      If hDD ;         Set Field_Current_Pointer_Value of hDD iField iLen to pData
33326>>>>>  End_procedure
33327>>>>>
33327>>>>>
33327>>>>>  //************************************************************************//
33327>>>>>  // Field_Current_Pointer_Value                                            //
33327>>>>>  // File_Field_Current_Pointer_Value                                       //
33327>>>>>  // This returns the data pointer to the extended field. At this point     //
33327>>>>>  // this is the data. Be careful if you change the data, be even more      //
33327>>>>>  // careful if you change the pointer (don't do it!!!!)                    //
33327>>>>>  //************************************************************************//
33327>>>>>
33327>>>>>  Function Field_Current_Pointer_Value integer iField returns Address
33329>>>>>      Integer hFld
33329>>>>>      Handle iFoc
33329>>>>>
33329>>>>>      Get Field_Object iField to hFld // the object that handles this large text
33330>>>>>      If not hFld Begin
33332>>>>>          Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_FIELD_NOT_DEFINED
33333>>>>>          Function_Return 0
33334>>>>>      End
33334>>>>>>
33334>>>>>
33334>>>>>
33334>>>>>    // This was extended to also make sure that the focus's server
33334>>>>>    // is this DD. This prevent the (very unlikely) case of a focus
33334>>>>>    // file/field being the right file/field but for a different view.
33334>>>>>    // 12.1: Also check operation mode, if within an operation assume that the
33334>>>>>    // ddos have the information they need from the deos. During a refresh we don't
33334>>>>>    // the data to be taken from a DEO - the DD buffer has the information you want. Note that
33334>>>>>    // we also changed all methods that set operation_mode to update the DD with the current
33334>>>>>    // DEO field, so the buffer is always correct.
33334>>>>>    Get Focus of Desktop to iFoc
33335>>>>>    If ( (OPERATION_MODE=MODE_WAITING) and ;         Extended_DEO_State(iFoc) and (Entry_Refresh_State(iFoc)=0) ) Begin
33337>>>>>       If ( Data_File(iFoc,0)=Main_File(Self) and Data_Field(iFoc,0)=iField and ;            IsDEOOwned(Self,iFoc) ) Begin
33339>>>>>               Send Update_Focus_Field
33340>>>>>            End
33340>>>>>>
33340>>>>>    End
33340>>>>>>
33340>>>>>            
33340>>>>>    Function_Return (FieldPointer(hFld))
33341>>>>>  End_function
33342>>>>>
33342>>>>>
33342>>>>>  Function Field_Current_UCAValue Integer iField Returns UChar[]
33344>>>>>      Integer hFld
33344>>>>>      Handle iFoc
33344>>>>>      UChar[] Data
33345>>>>>
33345>>>>>      Get Field_Object iField to hFld // the object that handles this large text
33346>>>>>      If not hFld Begin
33348>>>>>          Send Data_set_Error iField DFERR_PROGRAM DD_EXTENDED_FIELD_NOT_DEFINED
33349>>>>>          Function_Return 0
33350>>>>>      End
33350>>>>>>
33350>>>>>
33350>>>>>
33350>>>>>    // This was extended to also make sure that the focus's server
33350>>>>>    // is this DD. This prevent the (very unlikely) case of a focus
33350>>>>>    // file/field being the right file/field but for a different view.
33350>>>>>    // 12.1: Also check operation mode, if within an operation assume that the
33350>>>>>    // ddos have the information they need from the deos. During a refresh we don't
33350>>>>>    // the data to be taken from a DEO - the DD buffer has the information you want. Note that
33350>>>>>    // we also changed all methods that set operation_mode to update the DD with the current
33350>>>>>    // DEO field, so the buffer is always correct.
33350>>>>>    Get Focus of Desktop to iFoc
33351>>>>>    If ( (OPERATION_MODE=MODE_WAITING) and ;         Extended_DEO_State(iFoc) and (Entry_Refresh_State(iFoc)=0) ) Begin
33353>>>>>       If ( Data_File(iFoc,0)=Main_File(Self) and Data_Field(iFoc,0)=iField and ;            IsDEOOwned(Self,iFoc) ) Begin
33355>>>>>               Send Update_Focus_Field
33356>>>>>            End
33356>>>>>>
33356>>>>>    End
33356>>>>>>
33356>>>>>    Get FieldArray of hFld to Data
33357>>>>>    Function_Return Data
33358>>>>>  End_Function
33359>>>>>
33359>>>>>  Function File_Field_Current_Pointer_Value Integer iFile Integer iField Returns Address
33361>>>>>      Address pValue
33361>>>>>      Integer hDD
33361>>>>>      Get Data_Set iFile to hDD
33362>>>>>      If hDD Begin
33364>>>>>         Get Field_Current_Pointer_Value of hDD iField to pValue // return pointer to first byte of
33365>>>>>         Function_Return pValue                                  // data
33366>>>>>      End
33366>>>>>>
33366>>>>>  End_Function
33367>>>>>
33367>>>>>  Procedure Set Field_Current_UCAValue Integer iField UChar[] Data
33369>>>>>      Set Field_Current_Pointer_Value iField (SizeOfArray(Data)) to (AddressOf(Data))
33370>>>>>  End_Procedure
33371>>>>>
33371>>>>>  Procedure Set File_Field_Current_UCAValue Integer iFile Integer iField UChar[] Data
33373>>>>>      Integer hDD
33373>>>>>      Get Data_Set iFile to hDD
33374>>>>>      If hDD Begin
33376>>>>>         Set Field_Current_UCAValue of hDD iField to Data
33377>>>>>      End
33377>>>>>>
33377>>>>>  End_Procedure
33378>>>>>  
33378>>>>>  Function File_Field_Current_UCAValue Integer iFile Integer iField Returns UChar[]
33380>>>>>      UChar[] UCValue
33381>>>>>      Handle hDD
33381>>>>>      Get Data_Set iFile to hDD
33382>>>>>      If hDD Begin
33384>>>>>         Get Field_Current_UCAValue of hDD iField to UCValue // return pointer to first byte of
33385>>>>>         Function_Return UCValue                              // data
33386>>>>>      End
33386>>>>>>
33386>>>>>  End_Function
33387>>>>>
33387>>>>>  //************************************************************************//
33387>>>>>  // Create an extended field object for the passed field. .                //
33387>>>>>  // If field already exists, do nothing. This should only be used with     //
33387>>>>>  // text and binary fields.                                                //
33387>>>>>  //************************************************************************//
33387>>>>>
33387>>>>>  Procedure DefineExtendedField integer iField
33389>>>>>      integer hFlds
33389>>>>>      Get Field_Objects to hFlds // this may not be created yet.
33390>>>>>      If not hFlds Begin         // if not created, create extended-fields wrapper
33392>>>>>          Object ExtendedFieldObjects Is A FieldObjects
33394>>>>>              Move self to hFlds
33395>>>>>          End_Object
33396>>>>>          Set Field_Objects to hFlds
33397>>>>>      End
33397>>>>>>
33397>>>>>      Send DefineFieldObject to hFlds iField
33398>>>>>  End_Procedure
33399>>>>>
33399>>>>>  //************************************************************************//
33399>>>>>  // create extended DD fields for all text and binary files                //
33399>>>>>  //************************************************************************//
33399>>>>>
33399>>>>>  Procedure DefineAllExtendedFields
33401>>>>>    Integer iCount iType iField iFile
33401>>>>>    get Main_file to iFile
33402>>>>>    Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iCount
33405>>>>>    For iField from 1 to iCount
33411>>>>>>
33411>>>>>      Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33414>>>>>      If (iType=DF_TEXT or iType=DF_BINARY) ; // if text or binary         Send DefineExtendedField iField
33417>>>>>    Loop
33418>>>>>>
33418>>>>>  End_Procedure
33419>>>>>
33419>>>>>  //************************************************************************//
33419>>>>>  // Update Extended fields to FileBuffer.  DD-Fields ---> FileBuffer       //
33419>>>>>  // Private                                                                //
33419>>>>>  //************************************************************************//
33419>>>>>
33419>>>>>  Procedure ExtendedFieldsUpdate integer bSave
33421>>>>>      integer hFlds
33421>>>>>      Get Field_Objects to hFlds
33422>>>>>      If hFlds ;          Send ExtendedFieldsUpdate to hFlds bSave
33425>>>>>  End_procedure
33426>>>>>
33426>>>>>  //************************************************************************//
33426>>>>>  // Refresh Extended field from FileBuffer.  DD-Fields <--- FileBuffer     //
33426>>>>>  // Private                                                                //
33426>>>>>  //************************************************************************//
33426>>>>>
33426>>>>>  Procedure ExtendedFieldsRefresh Boolean bCleared
33428>>>>>      integer hFlds
33428>>>>>      Get Field_Objects to hFlds
33429>>>>>      If hFlds ;          Send ExtendedFieldsRefresh to hFlds bCleared
33432>>>>>  End_procedure
33433>>>>>
33433>>>>>  //************************************************************************//
33433>>>>>  // Procedure Set Field_Options                                            //
33433>>>>>  // This procedure can be used to set the Item_Options of a field. This can//
33433>>>>>  // be passed any number of arguments.                                     //
33433>>>>>  // Support the following special first parameters:                        //
33433>>>>>  //      DD_CLEAR_FIELD_OPTIONS     - clear all following passed otpions   //
33433>>>>>  //      DD_CLEAR_ALL_FIELD_OPTIONS - clear all options                    //
33433>>>>>  //************************************************************************//
33433>>>>>
33433>>>>>  Procedure Set Field_Options Integer iField Integer iArg1 // plus unknown arguments
33435>>>>>    Integer iObj
33435>>>>>    Integer iOptions
33435>>>>>    Integer iOption
33435>>>>>    Integer iArg
33435>>>>>    Integer iClear
33435>>>>>    integer iType
33435>>>>>    Move (Record_Buffer(self)) to iObj
33436>>>>>    Get Item_Options of iObj iField to iOptions
33437>>>>>    //
33437>>>>>    For iArg from 2 to Num_Arguments
33443>>>>>>
33443>>>>>        MoveStr iArg& to iOption // tricky way to parse passed arguments
33444>>>>>>
33444>>>>>        if iOption eq DD_CLEAR_ALL_FIELD_OPTIONS ;           Move 0 to iOptions
33447>>>>>        Else if iOption eq DD_CLEAR_FIELD_OPTIONS ;           Move 1 to iClear
33451>>>>>        Else if Not iClear ;           Move (iOptions IOR iOption) to iOptions
33455>>>>>        Else ; // only unset bits already set! Note multiple bits can be passed           Move (iOptions - (iOptions IAND iOption)) to iOptions
33457>>>>>    Loop
33458>>>>>>
33458>>>>>    //
33458>>>>>    //Get_Attribute DF_FIELD_TYPE of (Main_File(self)) iField to iType
33458>>>>>    //If (iType=DF_TEXT or iType=DF_BINARY) ;            // if text of binary
33458>>>>>    //    Move (iOptions iOR DD_DISPLAYONLY) to iOptions // make sure DO is set
33458>>>>>
33458>>>>>    Set Item_Options of iObj iField to iOptions
33459>>>>>  End_Procedure
33460>>>>>
33460>>>>>  //************************************************************************//
33460>>>>>  // Function Field_Options                                                  //
33460>>>>>  // This function returns all the item_options which have been set for     //
33460>>>>>  // a field. The value from the Record_Buffer object will be binary or'ed  //
33460>>>>>  // with constand Default_Item_Options and the DD_AUTOCLEAR constants when //
33460>>>>>  // the Autoclear_State of the field has been set.                         //
33460>>>>>  // Keep in mind that Autoclear is *not* kept in the Item_Options          //
33460>>>>>  // property.                                                              //
33460>>>>>  //************************************************************************//
33460>>>>>
33460>>>>>  Function Field_Options Integer iField Returns Integer
33462>>>>>    Function_Return (Item_Options(Record_Buffer(self), iField))
33463>>>>>  End_Function
33464>>>>>
33464>>>>>  Function Field_Option Integer iField Integer iOption returns integer
33466>>>>>    Integer iOptions
33466>>>>>    Integer iState
33466>>>>>    Get Item_Options of (Record_Buffer(Self)) iField to iOptions
33467>>>>>    // All bits must match for it to be True (e.g., displayonly requires noput & noenter)
33467>>>>>    Move ((iOptions iand iOption)=iOption) to iState
33468>>>>>    Function_Return iState
33469>>>>>  End_Function
33470>>>>>
33470>>>>>
33470>>>>>  Procedure Set Foreign_Field_Options Integer iField Integer iArg1 // Integer iOption
33472>>>>>    Integer iObj
33472>>>>>    Integer iOptions
33472>>>>>    Integer iOption
33472>>>>>    Integer iArg
33472>>>>>    Integer iClear
33472>>>>>    
33472>>>>>    
33472>>>>>   Move (Record_Buffer(Self)) to iObj
33473>>>>>   Get Aux_Value of iObj iField to iOptions
33474>>>>>    //
33474>>>>>    For iArg from 2 to Num_Arguments
33480>>>>>>
33480>>>>>        MoveStr iArg& to iOption // tricky way to parse passed arguments
33481>>>>>>
33481>>>>>        if iOption eq DD_CLEAR_ALL_FIELD_OPTIONS ;           Move 0 to iOptions
33484>>>>>        Else if iOption eq DD_CLEAR_FIELD_OPTIONS ;           Move 1 to iClear
33488>>>>>        Else if Not iClear ;           Move (iOptions IOR iOption) to iOptions
33492>>>>>        Else ; // only unset bits already set! Note multiple bits can be passed           Move (iOptions - (iOptions IAND iOption)) to iOptions
33494>>>>>    Loop
33495>>>>>>
33495>>>>>    //
33495>>>>>    Set Aux_Value of iObj iField to iOptions
33496>>>>>  End_Procedure
33497>>>>>
33497>>>>>  Function Foreign_Field_Options Integer iField Returns Integer
33499>>>>>    Integer iOpts
33499>>>>>    Get ForeignFieldOptions of Record_Buffer iField to iOpts
33500>>>>>    Function_Return iOpts
33501>>>>>  End_Function
33502>>>>>  
33502>>>>>  Procedure Set Foreign_Field_Option Integer iField Integer iOption Integer bSet
33504>>>>>      If bSet Begin
33506>>>>>          Set Foreign_Field_Options iField to iOption
33507>>>>>      End
33507>>>>>>
33507>>>>>      Else Begin
33508>>>>>          Set Foreign_Field_Options iField to DD_CLEAR_FIELD_OPTIONS iOption
33509>>>>>      End
33509>>>>>>
33509>>>>>  End_Procedure
33510>>>>>
33510>>>>>  Function Foreign_Field_Option Integer iField Integer iOption Returns Integer
33512>>>>>    Integer iOptions
33512>>>>>    Integer iState
33512>>>>>    Get Foreign_Field_Options iField to iOptions
33513>>>>>    Move ((iOptions iand iOption)=iOption) to iState
33514>>>>>    Function_Return iState
33515>>>>>  End_Function
33516>>>>>
33516>>>>>  //************************************************************************//
33516>>>>>  // Function File_Field_Options                                            //
33516>>>>>  // This procedure is being used by DEOs when they need to copy the item-  //
33516>>>>>  // options from the Data_Set. When the filenumber being passed is not     //
33516>>>>>  // equal to the Main_File of this Data_Set, then the Foreign_Field_Options//
33516>>>>>  // will be applied.                                                       //
33516>>>>>  //************************************************************************//
33516>>>>>  
33516>>>>>  Function File_Field_Options Integer iFile Integer iField Returns Integer
33518>>>>>    Integer iDSO
33518>>>>>    Integer iMain_File
33518>>>>>    Integer iOpts
33518>>>>>    Integer iRB
33518>>>>>    integer iType
33518>>>>>    Get Main_File to iMain_File
33519>>>>>    If iFile NE iMain_File ;      Get Data_Set iFile to iDSO
33522>>>>>    Else ;      Move self to iDSO
33524>>>>>    If iDSO Begin
33526>>>>>      Get Field_Options of iDSO iField to iOpts
33527>>>>>      // if data-type is Text or Binary we must remove the DisplayOnly
33527>>>>>      // attributes since these have to be set in the entrylist. This is
33527>>>>>      // a compromise that means that text/binary cannot be primarily
33527>>>>>      // no-enter or no-put. Foreign settings can still be applied
33527>>>>>      //Get_Attribute DF_FIELD_TYPE of iFile iField to iType
33527>>>>>      // this assumes that text and binary are set to displayonly which is what
33527>>>>>      // the DD does.
33527>>>>>      //If (iType=DF_TEXT OR iType=DF_BINARY) Subtract DD_DISPLAYONLY from iOpts
33527>>>>>      // we consider the item to be foreign if the DDO main file is different than the one
33527>>>>>      // passed and we do not allow foreign (parent) new records to be saved.
33527>>>>>      If (iFile<>iMain_File and Allow_Foreign_New_Save_State(iDSO)=0) ; // Add Foreign_Field_Options        Move (iOpts ior Foreign_Field_Options(iDSO, iField)) to iOpts
33530>>>>>      Function_Return iOpts
33531>>>>>    End
33531>>>>>>
33531>>>>>  End_Function
33532>>>>>
33532>>>>>
33532>>>>>  //************************************************************************//
33532>>>>>  // Procedure to set the message to be send on item entry.                 //
33532>>>>>  //************************************************************************//
33532>>>>>
33532>>>>>  Procedure Set Field_Entry_msg Integer iField Integer iMsg
33534>>>>>    Set Item_Entry_MSG of (Record_Buffer(Self)) iField to iMsg
33535>>>>>  End_Procedure
33536>>>>>
33536>>>>>  //************************************************************************//
33536>>>>>  // Function to return the message to be send on item entry.               //
33536>>>>>  //************************************************************************//
33536>>>>>
33536>>>>>  Function Field_Entry_msg Integer iField returns integer
33538>>>>>    Function_Return (Item_Entry_MSG(Record_Buffer(self), iField))
33539>>>>>  End_Function
33540>>>>>
33540>>>>>
33540>>>>>
33540>>>>>  //************************************************************************//
33540>>>>>  // Procedure to sent the message to be send on item exit.                 //
33540>>>>>  //************************************************************************//
33540>>>>>
33540>>>>>  Procedure Set Field_Exit_msg Integer iField Integer iMsg
33542>>>>>    Set Item_Exit_MSG of (Record_Buffer(Self)) iField to iMsg
33543>>>>>  End_Procedure
33544>>>>>
33544>>>>>  //************************************************************************//
33544>>>>>  // Function to return the message to be send on item exit.                //
33544>>>>>  //************************************************************************//
33544>>>>>
33544>>>>>  Function Field_Exit_msg Integer iField Returns Integer
33546>>>>>    Function_Return (Item_Exit_MSG(Record_Buffer(self), iField))
33547>>>>>  End_Function
33548>>>>>
33548>>>>>
33548>>>>>
33548>>>>>  //************************************************************************//
33548>>>>>  // Procedure to set the message to be send on item validation.            //
33548>>>>>  //************************************************************************//
33548>>>>>
33548>>>>>  Procedure Set Field_Validate_msg Integer iField Integer iMsg
33550>>>>>    Set Item_Validate_MSG of (Record_Buffer(Self)) iField to iMsg
33551>>>>>  End_Procedure
33552>>>>>
33552>>>>>  //************************************************************************//
33552>>>>>  // Function to return the message to be send on item validation.          //
33552>>>>>  //************************************************************************//
33552>>>>>
33552>>>>>  Function Field_Validate_msg Integer iField Returns Integer
33554>>>>>    Function_Return (Item_Validate_MSG(Record_Buffer(self), iField))
33555>>>>>  End_Function
33556>>>>>
33556>>>>>
33556>>>>>
33556>>>>>  //************************************************************************//
33556>>>>>  // Set/Get Field_Prompt_Object                                            //
33556>>>>>  // Set/Get Field_Zoom_Object                                              //
33556>>>>>  // Used to Get/Set the Prompt_Object for a Field.                         //
33556>>>>>  //************************************************************************//
33556>>>>>
33556>>>>>  Procedure Set Field_Prompt_Object Integer iField Integer iObj
33558>>>>>    Set Prompt_Object of (Record_Buffer(self)) iField to iObj
33559>>>>>  End_Procedure
33560>>>>>
33560>>>>>  Function Field_Prompt_Object Integer iField Returns Integer
33562>>>>>    integer iObj
33562>>>>>    Get Prompt_Object of (Record_Buffer(self)) iField to iObj
33563>>>>>    If iObj eq 0 ;       Get Prompt_Object of (Field_Attributes(Self)) iField to iObj
33566>>>>>    Function_Return iObj
33567>>>>>  End_Function
33568>>>>>
33568>>>>>  Procedure Set Field_Zoom_Object Integer iField Integer iObj
33570>>>>>    Set Zoom_Object of (Record_Buffer(Self)) iField to iObj
33571>>>>>  End_Procedure
33572>>>>>
33572>>>>>  Function Field_Zoom_Object Integer iField Returns Integer
33574>>>>>    Function_Return (Zoom_Object(Record_Buffer(self), iField))
33575>>>>>  End_Function
33576>>>>>
33576>>>>>
33576>>>>>  Procedure Set Field_WebPrompt_Object Integer iField Handle hoObj
33578>>>>>      Set Field_WebPrompt_Object of FieldMask_Array iField to hoObj
33579>>>>>  End_Procedure
33580>>>>>
33580>>>>>  Function Field_WebPrompt_Object Integer iField Returns Handle
33582>>>>>    Handle hoPrompt
33582>>>>>    Get Field_WebPrompt_Object of FieldMask_Array iField to hoPrompt
33583>>>>>    Function_Return hoPrompt
33584>>>>>  End_Function
33585>>>>>
33585>>>>>
33585>>>>>  //************************************************************************//
33585>>>>>  // Set/Get File_Field_Prompt_Object                                       //
33585>>>>>  // Set/Get File_Field_Zoom_Object                                         //
33585>>>>>  // Used to Get/Set the Prompt_Object for a Field.                         //
33585>>>>>  //************************************************************************//
33585>>>>>
33585>>>>>  Function File_Field_Prompt_Object Integer iFile Integer iField Returns Integer
33587>>>>>    Integer iObj
33587>>>>>    Get File_Field_Property iFile iField GET_Field_Prompt_Object to iObj
33588>>>>>    Function_Return iObj
33589>>>>>  End_Function
33590>>>>>
33590>>>>>  Function File_Field_Zoom_Object Integer iFile Integer iField Returns Integer
33592>>>>>    Integer iObj
33592>>>>>    Get File_Field_Property iFile iField GET_Field_Zoom_Object to iObj
33593>>>>>    Function_Return iObj
33594>>>>>  End_Function
33595>>>>>
33595>>>>>  Function File_Field_WebPrompt_Object Integer iFile Integer iField Returns Handle
33597>>>>>    Handle hoPrompt
33597>>>>>    Get File_Field_Property iFile iField GET_Field_WebPrompt_Object to hoPrompt
33598>>>>>    Function_Return hoPrompt
33599>>>>>  End_Function
33600>>>>>
33600>>>>>  //************************************************************************//
33600>>>>>  // Get Field_Validation_Type                                              //
33600>>>>>  // Return the extended validation type for this field.                    //
33600>>>>>  //************************************************************************//
33600>>>>>
33600>>>>>  Function Field_Validation_Type Integer iField Returns Integer
33602>>>>>    Integer iType
33602>>>>>    Get Field_Validation_Type of (Field_Attributes(self)) iField ;        to iType
33603>>>>>    Function_Return iType
33604>>>>>  End_Function
33605>>>>>
33605>>>>>  //************************************************************************//
33605>>>>>  // Procedure Set Field_Value_Range                                        //
33605>>>>>  // Procedure to define a valid value range for a field.                   //
33605>>>>>  //************************************************************************//
33605>>>>>
33605>>>>>  Procedure Set Field_Value_Range Integer iField String sMin String sMax
33607>>>>>    Set Field_Value_Range of (Field_Attributes(self)) iField ;        to sMin sMax
33608>>>>>  End_Procedure
33609>>>>>
33609>>>>>
33609>>>>>  //************************************************************************//
33609>>>>>  // Required Messaging to Support Validation Tables                        //
33609>>>>>  //************************************************************************//
33609>>>>>
33609>>>>>  //************************************************************************//
33609>>>>>  // Procedure Set Field_Value_Table                                        //
33609>>>>>  // Procedure to define a validate table for a field.                      //
33609>>>>>  //************************************************************************//
33609>>>>>
33609>>>>>  Procedure Set Field_Value_Table Integer iField integer iObj
33611>>>>>    Set Field_Value_Table of (Field_Attributes(self)) iField ;        to iObj
33612>>>>>  End_Procedure
33613>>>>>
33613>>>>>  //************************************************************************//
33613>>>>>  // File_Field_Fill_List                                                   //
33613>>>>>  // Field_Fill_List                                                        //
33613>>>>>  // This provides a callback to the calling object (iObj) by passing this  //
33613>>>>>  // object the message iMsg for each item in the table. Note this works for//
33613>>>>>  // all extended validation types (range, check, etc.)                     //
33613>>>>>  //************************************************************************//
33613>>>>>
33613>>>>>  Procedure Field_Fill_List integer iField integer iObj integer iMsg
33615>>>>>    Send Field_Fill_list to (Field_Attributes(self)) ;                               iField iObj iMsg
33616>>>>>  End_Procedure
33617>>>>>
33617>>>>>  Procedure File_Field_Fill_List integer iFile integer iField ;                                 integer iObj integer iMsg
33619>>>>>    integer iDSO
33619>>>>>    Get Data_set iFile to iDSO
33620>>>>>    If iDSO ;      Send Field_Fill_list to iDSO iField iObj iMsg
33623>>>>>  End_Procedure
33624>>>>>
33624>>>>>  //************************************************************************//
33624>>>>>  // Get Field_table_Object                                                 //
33624>>>>>  // Get File_Field_table_object                                            //
33624>>>>>  // Returns the ID if any of the validation table for this object.         //
33624>>>>>  //************************************************************************//
33624>>>>>
33624>>>>>  Function Field_Table_Object integer iField Returns integer
33626>>>>>      integer iRval
33626>>>>>      Get Field_Table_Object of (Field_Attributes(self)) iField to iRVal
33627>>>>>      Function_Return iRVal
33628>>>>>  End_Function
33629>>>>>
33629>>>>>  Function File_Field_Table_Object integer iFile integer iField Returns integer
33631>>>>>    integer iDSO
33631>>>>>    Get Data_set iFile to iDSO
33632>>>>>    If iDSO ;      Function_Return (Field_Table_Object(iDSO,iField))
33635>>>>>  End_Function
33636>>>>>
33636>>>>>  //************************************************************************//
33636>>>>>  // Get Field_table_Descripton                                             //
33636>>>>>  // Returns code description value for the passed string for the           //
33636>>>>>  // passed validation table object. Normally use field_value_description   //
33636>>>>>  //************************************************************************//
33636>>>>>
33636>>>>>  Function Validation_Table_Description integer iObj String sVal Returns string
33638>>>>>    string sDesc
33638>>>>>    If iObj get Find_Code_Description of iObj sVal to sDesc
33641>>>>>    Function_Return sDesc
33642>>>>>  End_Function
33643>>>>>
33643>>>>>  //************************************************************************//
33643>>>>>  // Get Field_Current_description                                          //
33643>>>>>  // Get File_Field_Current_description                                     //
33643>>>>>  // Returns the description value for the field's code value. This only    //
33643>>>>>  // works if you have a validation table - else it returns the field value //
33643>>>>>  //************************************************************************//
33643>>>>>
33643>>>>>  Function Field_Current_Description integer iField Returns string
33645>>>>>    string sDesc
33645>>>>>    string sVal
33645>>>>>    integer iObj
33645>>>>>    Get Field_Current_Value iField to sVal
33646>>>>>    Get Field_Table_Object iField to iObj
33647>>>>>    If iObj Begin
33649>>>>>       get Validation_Table_Description iObj sVal to sDesc
33650>>>>>       if (sDesc="") Move sVal to sDesc // if desc is blank, use value
33653>>>>>    End
33653>>>>>>
33653>>>>>    Else ;       Move sVal to sDesc
33655>>>>>    Function_Return sDesc
33656>>>>>  End_Function
33657>>>>>
33657>>>>>  Function File_Field_Current_Description integer iFile integer iField Returns string
33659>>>>>    integer iDSO
33659>>>>>    Get Data_set iFile to iDSO
33660>>>>>    If iDSO ;      Function_Return (Field_Current_Description(iDSO,iField))
33663>>>>>  End_Function
33664>>>>>
33664>>>>>
33664>>>>>  //************************************************************************//
33664>>>>>  // Required Messaging to Support Checkbox items in DEOs                   //
33664>>>>>  //************************************************************************//
33664>>>>>
33664>>>>>  //************************************************************************//
33664>>>>>  // Procedure Set Field_Checkbox_Values                                    //
33664>>>>>  //  Defines a field as a two item field and defines True and False values //
33664>>>>>  //************************************************************************//
33664>>>>>
33664>>>>>  Procedure Set Field_CheckBox_Values Integer iField String sTrue String sFalse
33666>>>>>    Set Field_CheckBox_Values of (Field_Attributes(self)) iField ;        to sTrue sFalse
33667>>>>>  End_Procedure
33668>>>>>
33668>>>>>  //************************************************************************//
33668>>>>>  // Function Field_Value_select_State                                      //
33668>>>>>  //    Returns a field's select_State based on the pased value             //
33668>>>>>  // Function Field_select_State                                            //
33668>>>>>  //    Returns a field's select_State based on the DD buffer contents      //
33668>>>>>  //************************************************************************//
33668>>>>>
33668>>>>>  Function Field_Value_Select_State Integer iField String sValue returns integer
33670>>>>>    Function_Return (Field_Value_Select_State(Field_Attributes(self),iField,sValue))
33671>>>>>  End_Function // File_Value_Field_Select_State
33672>>>>>
33672>>>>>  Function Field_Select_State Integer iField returns integer
33674>>>>>    String sValue
33674>>>>>    Get Field_Current_Value iField to sValue
33675>>>>>    Function_Return (Field_Value_Select_State(self,iField,sValue))
33676>>>>>  End_Function // File_Field_Select_State
33677>>>>>
33677>>>>>  //************************************************************************//
33677>>>>>  // Function File_Field_select_State                                       //
33677>>>>>  //   Returns a file/field' select_State based on contents of DD buffer    //
33677>>>>>  // Function File_Field_Value_select_State                                 //
33677>>>>>  //   Returns a file/field' select_State based on passed value             //
33677>>>>>  //************************************************************************//
33677>>>>>
33677>>>>>  Function File_Field_Select_State Integer iFile integer iField returns integer
33679>>>>>    integer iDSO
33679>>>>>    Get Data_set iFile to iDSO
33680>>>>>    If iDSO ;       Function_Return (Field_Select_State(iDSO,iField))
33683>>>>>  End_Function // File_Field_Select_State
33684>>>>>
33684>>>>>  Function File_Field_Value_Select_State Integer iFile integer iField ;                                         String sValue returns integer
33686>>>>>    integer iDSO
33686>>>>>    Get Data_set iFile to iDSO
33687>>>>>    If iDSO ;       Function_Return (Field_Value_Select_State(iDSO,iField,sValue))
33690>>>>>  End_Function // File_Field_Select_State
33691>>>>>
33691>>>>>  //************************************************************************//
33691>>>>>  // Function Field_Checkbox_Value                                          //
33691>>>>>  // Function File_Field_Checkbox_Value                                     //
33691>>>>>  // get the actual database value that corresponds to the boolean value    //
33691>>>>>  // passed.                                                                //
33691>>>>>  //************************************************************************//
33691>>>>>
33691>>>>>  Function Field_CheckBox_Value Integer iField Integer iState returns String
33693>>>>>    Function_Return (Field_Checkbox_Value(Field_Attributes(self),iField,iState))
33694>>>>>  End_Function
33695>>>>>
33695>>>>>  Function File_Field_CheckBox_Value Integer iFile Integer iField Integer iState returns String
33697>>>>>    integer iDSO
33697>>>>>    Get Data_set iFile to iDSO
33698>>>>>    If iDSO ;       Function_Return (Field_Checkbox_Value(iDSO,iField,iState))
33701>>>>>  End_Function
33702>>>>>
33702>>>>>  //************************************************************************//
33702>>>>>  // Procedure Set Field_select_State                                       //
33702>>>>>  // Set the buffer's value based on the state passed. This notifies DEOs   //
33702>>>>>  // if needed (set Field_Current_Value does this)                          //
33702>>>>>  //************************************************************************//
33702>>>>>
33702>>>>>  Procedure Set Field_Select_State integer iField integer iState
33704>>>>>    string sValue
33704>>>>>    Get Field_Checkbox_Value iField iState to sValue
33705>>>>>    Set Field_Current_Value iField to sValue
33706>>>>>  End_Procedure // Set Field_Select_State
33707>>>>>
33707>>>>>  //************************************************************************//
33707>>>>>  // Procedure Set File_Field_select_State                                  //
33707>>>>>  // Set the buffer's value based on the state passed. This notifies DEOs   //
33707>>>>>  // if needed (set Field_Current_Value does this). First finds proper file //
33707>>>>>  // DSO                                                                    //
33707>>>>>  //************************************************************************//
33707>>>>>
33707>>>>>  Procedure Set File_Field_Select_State Integer iFile Integer iField Integer iState
33709>>>>>    integer iDSO
33709>>>>>    Get Data_set iFile to iDSO
33710>>>>>    If iDSO ;      Set Field_Select_State of iDSO iField to iState
33713>>>>>  End_Procedure // Set File_Field_Select_State
33714>>>>>
33714>>>>>
33714>>>>>  //************************************************************************//
33714>>>>>  // Procedure Set Field_Value_Check                                        //
33714>>>>>  // Procedure to define a check string for a field.                        //
33714>>>>>  //************************************************************************//
33714>>>>>
33714>>>>>  Procedure Set Field_Value_Check Integer iField String sCheck
33716>>>>>    Set Field_Value_Check of (Field_Attributes(self)) iField ;        to sCheck
33717>>>>>  End_Procedure
33718>>>>>
33718>>>>>
33718>>>>>
33718>>>>>  //************************************************************************//
33718>>>>>  // Function Exec_Field_Message                                            //
33718>>>>>  // This function will be called indirectly by DEOs when an item is being  //
33718>>>>>  // entered, exited or needs validation. The first argument holds the      //
33718>>>>>  // fieldnumber for the field and the second holds the id of the message   //
33718>>>>>  // which can be send to retrieve the message which needs to be send for   //
33718>>>>>  // this Field/Event combination. The value of the second argument can be  //
33718>>>>>  // GET_Field_Entry_MSG, GET_Field_Exit_MSG or GET_Field_Validate_MSG.     //
33718>>>>>  //************************************************************************//
33718>>>>>
33718>>>>>  Function Exec_Field_Message Integer iField Integer iMsg_ID returns integer
33720>>>>>    Integer iMsg
33720>>>>>    Integer iResult
33720>>>>>    String  sValue
33720>>>>>    Get iMsg_ID iField to iMsg
33721>>>>>    If iMsg Begin
33723>>>>>      Get Field_Current_Value iField to sValue
33724>>>>>      Get iMsg iField sValue to iResult
33725>>>>>    End
33725>>>>>>
33725>>>>>    Function_Return iResult
33726>>>>>  End_Function
33727>>>>>
33727>>>>>
33727>>>>>
33727>>>>>  //************************************************************************//
33727>>>>>  // Function Exec_File_Field_Message                                       //
33727>>>>>  // This function will be called from within DEOs when an item is being    //
33727>>>>>  // entered, exited or needs validation. The first argument holds the      //
33727>>>>>  // file number, the second argument holds the field and the third         //
33727>>>>>  // holds the id of the message  which can be send to retrieve the message //
33727>>>>>  // which needs to be send for this File/Field/Event combination.          //
33727>>>>>  // The value of the second argument can be  GET_Field_Entry_MSG,          //
33727>>>>>  // GET_Field_Exit_MSG or GET_Field_Validate_MSG.                          //
33727>>>>>  // This will redirect to the proper data-set object.                      //
33727>>>>>  //************************************************************************//
33727>>>>>
33727>>>>>  Function Exec_File_Field_Message Integer iFile Integer iField Integer iMsg_ID returns integer
33729>>>>>    Integer iDSO
33729>>>>>    Integer iResult
33729>>>>>    Get Data_set iFile to iDSO
33730>>>>>    If iDSO ;      Get Exec_Field_Message of iDSO iField iMsg_ID to iResult
33733>>>>>    Function_Return iResult
33734>>>>>  End_Function
33735>>>>>
33735>>>>>
33735>>>>>
33735>>>>>  //************************************************************************//
33735>>>>>  // Function Data_Set                                                      //
33735>>>>>  // Find the data-set whose main_file is the same as File#. The message    //
33735>>>>>  // Which_data_set includes updating parent files, we will throw those out.//
33735>>>>>  // This has been augmented to search down the DDO tree if we do not find  //
33735>>>>>  // the DD with our quick C Which_Data_set search                          //
33735>>>>>  //************************************************************************//
33735>>>>>
33735>>>>>  Function Data_Set Integer iFile Returns Integer
33737>>>>>     Integer iTmp
33737>>>>>     Integer iDSO
33737>>>>>     Get Main_File to iTmp
33738>>>>>     If iTmp EQ iFile ;         Function_Return self
33741>>>>>     Get Which_Data_Set iFile to iDSO
33742>>>>>     If iDSO Begin
33744>>>>>         // check that DS's main-file is the File (and not a parent file)
33744>>>>>         Get Main_File of iDSO to iTmp
33745>>>>>         If iTmp EQ iFile ;            Function_Return iDSO
33748>>>>>     End
33748>>>>>>
33748>>>>>
33748>>>>>     // This really should have succeeded by now. If not we need to do a
33748>>>>>     // downward sweep looking for DD. This will be a slower process since it
33748>>>>>     // involves flex level DDO structure traversal. We should very rarely ever
33748>>>>>     // get to this point. If we do, it takes longer!
33748>>>>>
33748>>>>>     // Unlike other traversals we will mark and check in a single
33748>>>>>     // step.
33748>>>>>     // This Mark_Id creates a sequence Id for this clear. This way
33748>>>>>     // DSOs only get cleared one time during this process.
33748>>>>>     Send IncrementCurrentMarkId   
33749>>>>>     Get Private.Data_set iFile to iDSO // this does the recursive downward search
33750>>>>>     Function_Return iDSO
33751>>>>>  End_Function
33752>>>>>
33752>>>>>  Function Private.Data_Set integer iFile Returns Integer
33754>>>>>     Integer iMax
33754>>>>>     Integer iDSO hDD
33754>>>>>     Integer iCount
33754>>>>>
33754>>>>>     If (iFile=Main_file(self)) Function_return self
33757>>>>>
33757>>>>>     // We are only looking at sequence ID.
33757>>>>>     Set Last_Mark_Sequence_id to DD_Current_mark_id
33758>>>>>
33758>>>>>     // recurse Down first, since we already tried upward direction.
33758>>>>>     Get Data_Set_Client_Count to iMax
33759>>>>>     Decrement iMax
33760>>>>>     For iCount from 0 to iMax
33766>>>>>>
33766>>>>>          Get Data_Set_Client iCount to iDSO
33767>>>>>          // If already cleared during this sequence...do nothing
33767>>>>>          If (Last_Mark_Sequence_id(iDSO)<>DD_Current_mark_id) Begin
33769>>>>>              Get Private.Data_Set of iDSO iFile to hDD
33770>>>>>              If hDD Function_return hDD // when found...get out
33773>>>>>          End
33773>>>>>>
33773>>>>>     Loop
33774>>>>>>
33774>>>>>     // recurse up server list next. We do this 2nd because it is
33774>>>>>     // the less likely path for success.
33774>>>>>     Get Data_Set_Server_Count to iMax
33775>>>>>     Decrement iMax
33776>>>>>     For iCount from 0 to iMax
33782>>>>>>
33782>>>>>          Get Data_Set_Server iCount to iDSO
33783>>>>>          // If already cleared during this sequence...do nothing
33783>>>>>          If (Last_Mark_Sequence_id(iDSO)<>DD_Current_mark_id) Begin
33785>>>>>              Get Private.Data_Set of iDSO iFile to hDD
33786>>>>>              If hDD Function_return hDD // when found...get out
33789>>>>>          End
33789>>>>>>
33789>>>>>     Loop
33790>>>>>>
33790>>>>>     Function_Return 0 // if here, our traversal has failed.
33791>>>>>  End_Function // Private.Data_set
33792>>>>>
33792>>>>>  //************************************************************************//
33792>>>>>  // Function File_Field_Property                                           //
33792>>>>>  // Procedure Set File_Field_Property                                      //
33792>>>>>  // These methods can be used to set/get a field property in a flexible    //
33792>>>>>  // way. The first two argument are the file- and fieldnumber followed by  //
33792>>>>>  // the ID of the message that should be send. The last argument should    //
33792>>>>>  // be the value to set or the variable to store the value in.             //
33792>>>>>  //************************************************************************//
33792>>>>>
33792>>>>>  Procedure Set File_Field_Property Integer iFile Integer iField Integer iMsg String sValue
33794>>>>>    Integer iDSO
33794>>>>>    Get Data_Set iFile to iDSO
33795>>>>>    If iDSO Begin
33797>>>>>      Set iMsg of iDSO iField to sValue
33798>>>>>      Function_Return sValue
33799>>>>>    End
33799>>>>>>
33799>>>>>  End_Procedure
33800>>>>>
33800>>>>>  Function File_Field_Property Integer iFile Integer iField Integer iMsg returns integer
33802>>>>>    Integer iDSO
33802>>>>>    String  sValue
33802>>>>>    Get Data_Set iFile to iDSO
33803>>>>>    If iDSO Begin
33805>>>>>      Get iMsg of iDSO iField to sValue
33806>>>>>      Function_Return sValue
33807>>>>>    End
33807>>>>>>
33807>>>>>  End_Function
33808>>>>>
33808>>>>>
33808>>>>>
33808>>>>>  //************************************************************************//
33808>>>>>  // This procedure will return the number of fields in the object          //
33808>>>>>  //************************************************************************//
33808>>>>>
33808>>>>>  Function Field_Count Returns Integer
33810>>>>>     Function_Return (Item_Count(Record_Buffer(self)) - 1)
33811>>>>>  End_Function // Field_Count
33812>>>>>
33812>>>>>  //************************************************************************//
33812>>>>>  // This procedure will clear all flags in the visited_fields string so    //
33812>>>>>  // that all field will be validated on the next requests.                 //
33812>>>>>  //************************************************************************//
33812>>>>>
33812>>>>>  Procedure Clear_Visited_Fields
33814>>>>>    // this clears field visitation marks
33814>>>>>    Set Visited_Fields To (Repeat(" ", Field_Count(self)))
33815>>>>>  End_Procedure // Clear_Viisted_Fields
33816>>>>>
33816>>>>>
33816>>>>>  //************************************************************************//
33816>>>>>  // Private.Initialize_Visited                                             //
33816>>>>>  // This procedure will be called when validations (and perhaps other      //
33816>>>>>  // events) is requested. It clears the visited marks and then proceeds    //
33816>>>>>  // to clear the marks up the server tree.                                 //
33816>>>>>  // This is passed two parameters: Up_and_down, If true upward and downward//
33816>>>>>  // initialize. If Clear_Fields also clear the field string                //
33816>>>>>  //************************************************************************//
33816>>>>>
33816>>>>>  Procedure Private.Initialize_Visited integer Up_and_Down integer Clear_Fields
33818>>>>>    Integer iMax
33818>>>>>    Integer iDSO
33818>>>>>    Integer iCount
33818>>>>>
33818>>>>>    // recurse up server list first. Only recurse up
33818>>>>>    Get Data_Set_Server_Count to iMax
33819>>>>>    Decrement iMax
33820>>>>>    For iCount from 0 to iMax
33826>>>>>>
33826>>>>>        Get Data_Set_Server iCount to iDSO
33827>>>>>        // If already cleared during this sequence...do nothing
33827>>>>>        If (Last_Mark_Sequence_id(iDSO)<>DD_Current_mark_id) ;           Send Private.Initialize_Visited to iDSO FALSE Clear_Fields
33830>>>>>    Loop
33831>>>>>>
33831>>>>>
33831>>>>>    If Clear_Fields Send Clear_Visited_Fields // clear all markers in this object
33834>>>>>    // this clears the visited mark for the entire object
33834>>>>>    Set Visited_State to False
33835>>>>>    Set DownDelete_State to False
33836>>>>>    Set Last_Mark_Sequence_id to DD_Current_mark_id
33837>>>>>
33837>>>>>    // If Up_and_Down recurse Down server list
33837>>>>>    If Up_and_Down Begin
33839>>>>>       Get Data_Set_Client_Count to iMax
33840>>>>>       Decrement iMax // **EK** This line was missing
33841>>>>>       For iCount from 0 to iMax
33847>>>>>>
33847>>>>>           Get Data_Set_Client iCount to iDSO
33848>>>>>           // If already cleared during this sequence...do nothing
33848>>>>>           If (Last_Mark_Sequence_id(iDSO)<>DD_Current_mark_id) ;              Send Private.Initialize_Visited to iDSO TRUE Clear_Fields
33851>>>>>       Loop
33852>>>>>>
33852>>>>>    End
33852>>>>>>
33852>>>>>  End_Procedure // Private.Initialize_Visited
33853>>>>>
33853>>>>>
33853>>>>>
33853>>>>>
33853>>>>>  //************************************************************************//
33853>>>>>  // Initialize_Visted                                                      //
33853>>>>>  // Clears Visited marks and (maybe) field visited marks in all required   //
33853>>>>>  // DSOs. If Up_and_Down is TRUE DSOs are marked up and Down (delete style)//
33853>>>>>  // propagation. If False, DSOs are marked up (save style). This does not  //
33853>>>>>  // have a mode to mark ALL DSOs in a structure. (Not needed so far).      //
33853>>>>>  // If Clear_Fields is T the field string marker is also cleared.          //
33853>>>>>  // The method of using the global integer DD_Current_Mark_ID is an opt-   //
33853>>>>>  // imizer. This is private - do not tamper with it!                       //
33853>>>>>  //************************************************************************//
33853>>>>>  
33853>>>>>  // Note that Intialize_Visited does not always Clear all DDOs in the structure. When
33853>>>>>  // Up_and_Down is true, it is marking all DDOs that will participate in a cascade delete
33853>>>>>  // which may not be all DDOs in the structure. If you want to initialize all DDOs use InitializeAllVisited
33853>>>>>  Procedure Initialize_Visited integer Up_and_Down integer Clear_Fields
33855>>>>>     Send IncrementCurrentMarkId
33856>>>>>     Send Private.Initialize_Visited Up_and_Down Clear_Fields
33857>>>>>  End_Procedure // Initialize_Visited
33858>>>>>  
33858>>>>>    Procedure InitializeAllVisited2
33860>>>>>        Integer iMax iCount
33860>>>>>        Handle hoDSO
33860>>>>>
33860>>>>>        Set Visited_State to False
33861>>>>>        Set Last_Mark_Sequence_id to DD_Current_mark_id // marks this as visited
33862>>>>>        
33862>>>>>        // recurse up server list.
33862>>>>>        Get Data_Set_Server_Count to iMax
33863>>>>>        For iCount from 0 to (iMax-1)
33869>>>>>>
33869>>>>>            Get Data_Set_Server iCount to hoDSO
33870>>>>>            // If already cleared during this sequence...do nothing
33870>>>>>            If (Last_Mark_Sequence_id(hoDSO)<>DD_Current_mark_id) ;               Send InitializeAllVisited2 of hoDSO
33873>>>>>        Loop
33874>>>>>>
33874>>>>>        
33874>>>>>        // recurse down client list.
33874>>>>>        Get Data_Set_Client_Count to iMax
33875>>>>>        For iCount from 0 to (iMax-1)
33881>>>>>>
33881>>>>>           Get Data_Set_Client iCount to hoDSO
33882>>>>>           // If already cleared during this sequence...do nothing
33882>>>>>           If (Last_Mark_Sequence_id(hoDSO)<>DD_Current_mark_id) ;               Send InitializeAllVisited2 to hoDSO
33885>>>>>        Loop
33886>>>>>>
33886>>>>>    End_Procedure
33887>>>>>  
33887>>>>>    // clears visited flag for *all* ddos in the structure.
33887>>>>>    Procedure InitializeAllVisited
33889>>>>>        Send IncrementCurrentMarkId
33890>>>>>        Send InitializeAllVisited2
33891>>>>>    End_Procedure
33892>>>>>
33892>>>>>
33892>>>>>  //************************************************************************//
33892>>>>>  // Private.Valid_Structure                                                //
33892>>>>>  // Internal recursive message to check file connections. Called from      //
33892>>>>>  // Valid_connections only. Private message                                //
33892>>>>>  //************************************************************************//
33892>>>>>
33892>>>>>  Function Private.Valid_Structure Integer Up_And_Down Returns Integer
33894>>>>>      Integer iRval iCount iMax
33894>>>>>      Handle iDSO iPDSO
33894>>>>>      Integer iPMax iPCount iPMain
33894>>>>>      Boolean bUpDown bNull bCascadeNull bDown
33894>>>>>
33894>>>>>      // Check Current Connections
33894>>>>>      Get Valid_Servers to iRval           // always check servers
33895>>>>>      If (iRval=0 and Up_and_Down) ;       // check Clients if required         Get Valid_Clients to iRval
33898>>>>>      Set Visited_State to TRUE
33899>>>>>
33899>>>>>      // Ask Server data-sets to check their server connections
33899>>>>>      If Not iRval Begin // check up
33901>>>>>         Get Data_Set_Server_Count to iMax
33902>>>>>         Decrement iMax
33903>>>>>         For iCount from 0 to iMax
33909>>>>>>
33909>>>>>             Get Data_Set_Server iCount to iDSO
33910>>>>>             If Not (Visited_state(iDSO)) ;                Get Private.Valid_Structure of iDSO False to iRVal
33913>>>>>         Until iRval
33915>>>>>      End
33915>>>>>>
33915>>>>>
33915>>>>>      // If required, Ask Clients to check their server and client connections
33915>>>>>      // 
33915>>>>>      If (iRval=0 AND Up_and_Down) Begin // check down
33917>>>>>         Get Data_Set_Client_Count to iMax
33918>>>>>         Decrement iMax
33919>>>>>         For iCount from 0 to iMax
33925>>>>>>
33925>>>>>             Get Data_Set_Client iCount to iDSO
33926>>>>>             If not (Visited_state(iDSO)) Begin
33928>>>>>                 Get Data_Set_Server_Count of iDSO to iPMax
33929>>>>>                 // test if all deletable parents for a non parent null allowed/cascade delete null 
33929>>>>>                 For iPCount from 0 to (iPMax-1)
33935>>>>>>
33935>>>>>                     Get Data_Set_Server of iDSO iPCount to iPDSO
33936>>>>>                     Get DownDelete_State of iPDSO to bDown
33937>>>>>                     If (bDown) Begin
33939>>>>>                        Get Main_File of iPDSO to iPMain
33940>>>>>                        Get IsNullParentAllowed of iDSO iPMain to bNull
33941>>>>>                        Get IsCascadeDeleteNull of iDSO iPMain to bCascadeNull
33942>>>>>                        Move (not(bNull) or not(bCascadeNull)) to bUpDown
33943>>>>>                     End
33943>>>>>>
33943>>>>>                 Until bUpDown
33945>>>>>                 Get Private.Valid_Structure of iDSO bUpDown to iRVal
33946>>>>>             End
33946>>>>>>
33946>>>>>         Until iRval
33948>>>>>      End
33948>>>>>>
33948>>>>>
33948>>>>>      Function_return iRVal
33949>>>>>
33949>>>>>  End_Function
33950>>>>>
33950>>>>>
33950>>>>>  //************************************************************************//
33950>>>>>  // Valid_Structure                                                        //
33950>>>>>  // Validate data-set updating connections against required connections    //
33950>>>>>  // Pass: Up_and_down=T if we should check Server and Client connections   //
33950>>>>>  //                  =F is we only check servers                           //
33950>>>>>  // Ret: 0 if ok, Missing File# if not ok.                                 //
33950>>>>>  //************************************************************************//
33950>>>>>  // Up_And_Down should be true when testing for cascade delete structures and
33950>>>>>  // false when testing for save / delete-no-cascade structures
33950>>>>>  Function Valid_Structure Integer Up_And_Down Returns Integer
33952>>>>>    Send Initialize_Visited Up_and_Down False // False=don't clear field marks
33953>>>>>    If (Up_And_Down) Begin
33955>>>>>        Send MarkDDOsForCascadeDelete
33956>>>>>    End
33956>>>>>>
33956>>>>>    Function_Return (Private.Valid_Structure(self,Up_and_Down))
33957>>>>>  End_Function
33958>>>>>
33958>>>>>  // mark all DDOs which are part of this deletes cascade delete tree 
33958>>>>>  // mark this and all clients as Downward deletable. This includes
33958>>>>>  // cacscade delete and cascade set to null (not for cascade_delete_state=F)
33958>>>>>  Procedure MarkDDOsForCascadeDelete
33960>>>>>       Integer iMax  iCount
33960>>>>>       Boolean bDown
33960>>>>>       Handle hoDDO
33960>>>>>       Set DownDelete_State to True
33961>>>>>       Get Data_Set_Client_Count to iMax
33962>>>>>       For iCount from 0 to (iMax-1)
33968>>>>>>
33968>>>>>           Get Data_Set_Client iCount to hoDDO
33969>>>>>           Get DownDelete_State of hoDDO to bDown
33970>>>>>           If not bDown Begin // circular DDO test - never do this
33972>>>>>               Send MarkDDOsForCascadeDelete of hoDDO
33973>>>>>           End
33973>>>>>>
33973>>>>>       Loop
33974>>>>>>
33974>>>>>  End_Procedure  
33975>>>>>
33975>>>>>
33975>>>>>  //************************************************************************//
33975>>>>>  // Validate_Fields                                                        //
33975>>>>>  // This function will execute the validation message for each field within//
33975>>>>>  // this object. If DoAllFG is true all items are validated. If false      //
33975>>>>>  // only unvisited items are checked.                                      //
33975>>>>>  // Added bNoStop, If true, all items are validated. It is up to you to    //
33975>>>>>  // do something with the possible cascade of errors                       //
33975>>>>>  // if the err returns DFERR_ENTER_VALID_REC_ID we will not continue       //
33975>>>>>  // the validation (the other fields will be bad). This works best if the  //
33975>>>>>  // findreq appears as one of the first fields in the file (which is almost//
33975>>>>>  // always the case                                                        //
33975>>>>>  //************************************************************************//
33975>>>>>
33975>>>>>  Function Validate_Fields integer DoAllFg integer bNoStop Returns Integer
33977>>>>>    Integer iRetval
33977>>>>>    Integer iMax
33977>>>>>    Integer iCount
33977>>>>>    Integer iFile
33977>>>>>    integer iErr
33977>>>>>    String  sVS
33977>>>>>    Get Visited_Fields To sVS
33978>>>>>    Get Field_Count To iMax
33979>>>>>    Get Main_File to iFile
33980>>>>>    For iCount From 1 To iMax
33986>>>>>>
33986>>>>>      If (DoAllFG OR Mid(sVS, 1, iCount)=" ") Begin
33988>>>>>        Get Validate_Field iCount to iErr
33989>>>>>        If iErr Begin
33991>>>>>           Move iErr to iRetVal
33992>>>>>           // error occured. If not no-stop or the error is
33992>>>>>           // a findreq error - we are done.
33992>>>>>           If (not(bNoStop) OR iRetVal=DFERR_ENTER_VALID_REC_ID) ;               Function_return iRetVal
33995>>>>>        end
33995>>>>>>
33995>>>>>      end
33995>>>>>>
33995>>>>>    Loop
33996>>>>>>
33996>>>>>    Function_Return iRetval
33997>>>>>  End_Function
33998>>>>>
33998>>>>>  //************************************************************************//
33998>>>>>  // Function Validate_Required                                             //
33998>>>>>  //************************************************************************//
33998>>>>>
33998>>>>>  // 17.0 - added support for null-parents. If null parents allowed, req lets it through
33998>>>>>  Function Validate_Required Integer iField Returns Integer
34000>>>>>    Boolean bNull bErr
34000>>>>>//    Handle[] hoDDs
34000>>>>>//    Integer iMain
34000>>>>>    
34000>>>>>    Move (trim(Field_Current_Value(Self,iField))='') to bErr
34001>>>>>    
34001>>>>>//    // if blank we must check if an exception is made for a null parent.
34001>>>>>//    If (bErr  and OPERATION_ORIGIN<>Self and not(HasRecord(Self)) and not(field_changed_state(Self,iField))) Begin
34001>>>>>//        // we must find the child that points to this DD, starting with operation_origin. If a child
34001>>>>>//        // is found, it will be in array position 1 (0 is self, 1 is child)
34001>>>>>//        Send DDOServerPath of operation_origin Self (&hoDDs) 
34001>>>>>//        If (SizeOfArray(hoDDs)) Begin
34001>>>>>//           Get Main_File to iMain
34001>>>>>//           Get IsNullParentAllowed of hoDDs[1] iMain to bNull
34001>>>>>//           Move (not(bNull)) to bErr
34001>>>>>//        End
34001>>>>>//    End
34001>>>>>
34001>>>>>    If bErr ;        Send Data_set_Error iField DFERR_ENTRY_REQUIRED ""
34004>>>>>    Function_Return bErr
34005>>>>>  End_Function
34006>>>>>
34006>>>>>  //************************************************************************//
34006>>>>>  // Function Validate_FindReq                                              //
34006>>>>>  //************************************************************************//
34006>>>>>
34006>>>>>    
34006>>>>>     // return true if we should skip validation for this field. This can happen with Null allowed parents.
34006>>>>>     // if this is foreign, new and has no changes and is null allowed we will skip. 
34006>>>>>    Function SkipValidate Integer iField Returns Boolean
34008>>>>>        Boolean bSkip bFieldChanged bEmpty
34008>>>>>        String sValue
34008>>>>>
34008>>>>>        If (OPERATION_ORIGIN<>Self and not(HasRecord(Self)) and not(changed_state(Self))) Begin
34010>>>>>            // We must also check field_changed_state and only skip if this is not changed.
34010>>>>>            Get Field_Changed_State iField to bFieldChanged
34011>>>>>            // Retain and remember may set field_changed_state to true even when empty. If this field is changed
34011>>>>>            // but its value is empty we assume it is a candidate for Null checking, so we will set field-changed to false
34011>>>>>            If bFieldChanged Begin
34013>>>>>                Get Field_Current_Value iField to sValue
34014>>>>>                Get IsEmptyField iField sValue to bEmpty
34015>>>>>                If bEmpty Begin
34017>>>>>                    Move False to bFieldChanged
34018>>>>>                End
34018>>>>>>
34018>>>>>            End
34018>>>>>>
34018>>>>>            If (not(bFieldChanged)) Begin    
34020>>>>>                // we must find the child that points to this DD, starting with operation_origin. If a child
34020>>>>>                // is found, it will be in array position 1 (0 is self, 1 is child)
34020>>>>>                Get IsNullParentOrAncestor to bSkip
34021>>>>>            End
34021>>>>>>
34021>>>>>        End
34021>>>>>>
34021>>>>>        Function_Return bSkip
34022>>>>>    End_Function
34023>>>>>    
34023>>>>>    
34023>>>>>    // This will tell us if this DD can be treated as either a null parent
34023>>>>>    // or an ancestor of a null parent. This should only be called for a DD
34023>>>>>    // that is a candidate for this meaning that it does not have a change. 
34023>>>>>    // We will test if its child allows this parent to be null or if this
34023>>>>>    // is in the path of an allowed null parent. We assume that parents of
34023>>>>>    // null parents will also be null. This is used to test if validations are
34023>>>>>    // needed.
34023>>>>>    Function IsNullParentOrAncestor Returns Boolean 
34025>>>>>        Handle[] hoDDs
34026>>>>>        Integer i iSize iMain
34026>>>>>        Boolean bNullAllowed
34026>>>>>        // gets an array where 0 is self, 1 is parent, 2 is grandparent, and the
34026>>>>>        // last item is the operation_origin.
34026>>>>>        Send DDOServerPath of operation_origin Self (&hoDDs) 
34027>>>>>        Move (SizeOfArray(hoDDs)) to iSize
34028>>>>>        If (iSize) Begin
34030>>>>>           // see if the immediate child allows this to be null. 
34030>>>>>           Get Main_File to iMain
34031>>>>>           Get IsNullParentAllowed of hoDDs[1] iMain to bNullAllowed
34032>>>>>           
34032>>>>>           // if null not allowed, see if this is an ancestor to a null allowed
34032>>>>>           // parent where all DDs in this path are unchanged. For example:
34032>>>>>           // G.DD <- P.DD <- C.DD where we C.DD allows P.DD to be null and we
34032>>>>>           // want to test if G.DD needs validation
34032>>>>>           Move 1 to i
34033>>>>>           While (not(bNullAllowed) and (i+1<iSize) and not(changed_state(hoDDs[i])) )
34037>>>>>               Get Main_File of hoDDs[i] to iMain
34038>>>>>               Get IsNullParentAllowed of hoDDs[i+1] iMain to bNullAllowed
34039>>>>>               Increment i
34040>>>>>           Loop
34041>>>>>>
34041>>>>>           
34041>>>>>        End
34041>>>>>>
34041>>>>>        Function_Return bNullAllowed
34042>>>>>    End_Function
34043>>>>>    
34043>>>>>
34043>>>>>  Function Validate_FindReq Integer iField Returns Integer
34045>>>>>    Integer bErr iOpts
34045>>>>>    // if no current record, we have not found the required record.
34045>>>>>    Move (not(HasRecord(Self))) to bErr
34046>>>>>    // We also need to check if the field is changed. If the field is changed and this
34046>>>>>    // is an autofind field, this indicates that an autofind was attempted and failed. We
34046>>>>>    // can't jut rely on current_record because a failed autofind restores the old current
34046>>>>>    // record. For this to work, DEOs must set the DD field's changed_state to true on
34046>>>>>    // no-put fields (dd_deomx.pkg was changed to do this).
34046>>>>>    If (not(bErr) and field_changed_state(Self,iField)) Begin
34048>>>>>       Get Field_Options iField to iOpts
34049>>>>>       Move ( ((iOpts iand DD_AUTOFIND)=DD_AUTOFIND) or ;              ((iOpts iand DD_AUTOFIND_GE)=DD_AUTOFIND_GE) ) ;                to bErr
34050>>>>>    End
34050>>>>>>
34050>>>>>    If bErr ;        Send Data_set_Error iField DFERR_ENTER_VALID_REC_ID ""
34053>>>>>    Function_Return bErr
34054>>>>>  End_Function
34055>>>>>
34055>>>>>  //************************************************************************//
34055>>>>>  // Function Validate_Field                                                //
34055>>>>>  // This function will be called to validate a field.                      //
34055>>>>>  // mark field currently being validated                                   //
34055>>>>>  // Altered to Check DD options (required, findreq)                        //
34055>>>>>  //************************************************************************//
34055>>>>>  
34055>>>>>  Function Validate_Field Integer iField Returns Integer
34057>>>>>    Integer iResult
34057>>>>>    Integer iMsg
34057>>>>>    Integer iObj
34057>>>>>    String  sValue
34057>>>>>    integer iFile
34057>>>>>    Integer iOpts iMain
34057>>>>>    Boolean bSkipValidate
34057>>>>>    Handle[] hoDDs
34058>>>>>
34058>>>>>    Set Current_Validate_Field to iField
34059>>>>>
34059>>>>>    // test if we should skip validation on this field
34059>>>>>    Get SkipValidate iField to bSkipValidate
34060>>>>>    
34060>>>>>    If (not(bSkipValidate)) Begin
34062>>>>>        
34062>>>>>        Move (Record_Buffer(Self)) to iObj
34063>>>>>        Get Main_File to iFile
34064>>>>>    
34064>>>>>        // Check for DD option failures: required, find_required
34064>>>>>        // "File_field" gets regular and foreign fields as needed
34064>>>>>        //Get File_Field_Options iFile iField to iOpts
34064>>>>>        Get Field_Options iField to iOpts  // get reg options
34065>>>>>        // if this is not the DDO that started the validation, we will assume that
34065>>>>>        // this is foreign. Operation_origin is set in Request_Validate
34065>>>>>        // If foreign (as defined above) and we do not allow new saves when
34065>>>>>        // foreign, we will consider this to be foreign and add foreign options
34065>>>>>        If (Operation_Origin<>Self and ;            Allow_Foreign_New_Save_State(Self)=0)  ;            Move (iOpts ior Foreign_Field_Options(Self, iField)) to iOpts
34068>>>>>
34068>>>>>
34068>>>>>        // Check for FindReq first. If it fails, set iResult to DFERR_ENTER_VALID_REC_ID so
34068>>>>>        // the calling function knows that a findreq failed. Always do this validation first
34068>>>>>        If (iOpts iand DD_FINDREQ)  Get Validate_FindReq  iField to iResult
34071>>>>>        If iResult Begin
34073>>>>>            Send AddDDHasFindReqError
34074>>>>>            Move DFERR_ENTER_VALID_REC_ID to iResult
34075>>>>>        End
34075>>>>>>
34075>>>>>        Else Begin
34076>>>>>            
34076>>>>>            If (iOpts iand DD_REQUIRED) Get Validate_Required iField to iResult
34079>>>>>        
34079>>>>>            If (iResult=0) Begin
34081>>>>>              // First execute the user defined validation message
34081>>>>>              Get Item_Validate_MSG of iObj iField to iMsg
34082>>>>>              If iMsg Begin
34084>>>>>                Get Field_Current_Value iField to sValue
34085>>>>>                Get iMsg iField sValue to iResult
34086>>>>>              End
34086>>>>>>
34086>>>>>            End
34086>>>>>>
34086>>>>>        
34086>>>>>            // Check for keys
34086>>>>>            If (iResult=0 and Key_Field_State(Self, iField)) ;              Get Validate_Key_Field iField to iResult
34089>>>>>        
34089>>>>>            // Do extended validations
34089>>>>>            If (iResult=0) ;               Get Validate_Field of (Field_Attributes(Self)) iField to iResult
34092>>>>>        End
34092>>>>>>
34092>>>>>    End
34092>>>>>>
34092>>>>>
34092>>>>>    Set Current_Validate_Field to 0
34093>>>>>    // Mark this field being validated
34093>>>>>    Get Visited_Fields to sValue
34094>>>>>    Set Visited_Fields to (Overstrike("X", sValue, iField))
34095>>>>>
34095>>>>>    Function_Return iResult
34096>>>>>
34096>>>>>  End_Function
34097>>>>>
34097>>>>>
34097>>>>>
34097>>>>>  //************************************************************************//
34097>>>>>  // Function File_Field_Validate_Field                                     //
34097>>>>>  // This function will be called to validate a field.                      //
34097>>>>>  //************************************************************************//
34097>>>>>
34097>>>>>  Function File_Field_Validate_Field Integer iFile Integer iField Returns Integer
34099>>>>>    Integer iDSO
34099>>>>>    Integer iResult
34099>>>>>    integer hOldOrigin
34099>>>>>    Get Data_Set iFile to iDSO
34100>>>>>    If Not iDSO ;      Function_Return 0
34103>>>>>
34103>>>>>    // This function is only called by the DEOs.
34103>>>>>    // It is possible for validate_item when called as part of
34103>>>>>    // request_validate to get called more than once
34103>>>>>    // when a field is foreign (it is attached to both its DDO and the
34103>>>>>    // child-main ddo). This makes sure the validation is only called once.
34103>>>>>    // (vdf7 change: previously we set OpMode to Mode_Saving and checked that, now we have
34103>>>>>    // a mode just for request_validate).
34103>>>>>    If (Operation_Mode=MODE_VALIDATING AND ;         // if from request_validate        Mid(Visited_Fields(iDSO), 1, iField)="X" ) ; // and already marked           Function_return 0                         // skip it
34106>>>>>
34106>>>>>    Move Operation_origin to hOldOrigin
34107>>>>>
34107>>>>>    // if from request_validate operation_origin will be set and should not 
34107>>>>>    // be reset here.
34107>>>>>    If (OPERATION_ORIGIN=0) Begin
34109>>>>>        Move Self to Operation_Origin
34110>>>>>    End
34110>>>>>>
34110>>>>>
34110>>>>>    Get Validate_Field of iDSO iField to iResult
34111>>>>>    Move hOldOrigin to Operation_Origin
34112>>>>>    Function_Return iResult
34113>>>>>  End_Function
34114>>>>>
34114>>>>>
34114>>>>>
34114>>>>>  //************************************************************************//
34114>>>>>  // Function Validate_Key_Field                                            //
34114>>>>>  // This function will be called to check if a key has been changed.       //
34114>>>>>  //************************************************************************//
34114>>>>>
34114>>>>>  Function Validate_Key_Field Integer iField Returns Integer
34116>>>>>    String  sOld_Value
34116>>>>>    String  sNew_Value
34116>>>>>    String  sKeys
34116>>>>>    Integer iState
34116>>>>>    Boolean bMultiKeys
34116>>>>>    Get Protect_Key_State to iState
34117>>>>>    If iState Begin
34119>>>>>      Get Key_Value to sNew_Value
34120>>>>>      // Only check existing records.
34120>>>>>      If (HasRecord(self)) begin
34122>>>>>        Get Existing_Key_Value to sOld_Value
34123>>>>>        If sNew_Value NE sOld_Value Begin
34125>>>>>            // we have an error. If there is only one key field we know
34125>>>>>            // where the field is and we can report that field. If we have
34125>>>>>            // multiple key fields, we don't really know where the offending key change
34125>>>>>            // is, so we will not report a field.
34125>>>>>            Get Key_Fields to sKeys
34126>>>>>            Move (Pos("X",sKeys)<>RightPos("X",sKeys)) to bMultiKeys
34127>>>>>            Send Data_set_Error (If(bMultiKeys, -1, iField)) 0 DD_TEXT_NO_KEY_CHANGE_ALLOWED
34128>>>>>            Function_Return 1
34129>>>>>        End
34129>>>>>>
34129>>>>>      End
34129>>>>>>
34129>>>>>    End
34129>>>>>>
34129>>>>>  End_Function
34130>>>>>
34130>>>>>
34130>>>>>    // During request_validate process tell us if this DD has had a find_request error. This
34130>>>>>    // is handled by the DD that originated the request_validate. Very private
34130>>>>>    Function DDHasFindReqError Returns Boolean
34132>>>>>        Handle[] DDsWithFindReqErrors
34133>>>>>        Integer iIndex
34133>>>>>        If (OPERATION_ORIGIN) Begin
34135>>>>>            Get pDDsWithFindReqErrors of OPERATION_ORIGIN to DDsWithFindReqErrors
34136>>>>>            Move (SearchArray(Self,DDsWithFindReqErrors)) to iIndex
34137>>>>>            Function_Return (iIndex<>-1)
34138>>>>>        End
34138>>>>>>
34138>>>>>    End_Function
34139>>>>>    
34139>>>>>    // During a request_validate a find_request error has occurred. Add this DD
34139>>>>>    // to list of DDs that have this error. This is handled by the DD that
34139>>>>>    // originated the request_validate.  Very private
34139>>>>>    Procedure AddDDHasFindReqError
34141>>>>>        Handle[] DDsWithFindReqErrors
34142>>>>>        If (OPERATION_ORIGIN) Begin
34144>>>>>            Get pDDsWithFindReqErrors of OPERATION_ORIGIN to DDsWithFindReqErrors
34145>>>>>            Move Self to DDsWithFindReqErrors[SizeOfArray(DDsWithFindReqErrors)]
34146>>>>>            Set pDDsWithFindReqErrors of OPERATION_ORIGIN to DDsWithFindReqErrors
34147>>>>>        End
34147>>>>>>
34147>>>>>    End_Procedure
34148>>>>>
34148>>>>>
34148>>>>>  //************************************************************************//
34148>>>>>  // Validate_Data_Sets                                                     //
34148>>>>>  // This function will execute the validation message for each field of the//
34148>>>>>  // data set and all of its parents in parent first order.                 //
34148>>>>>  // Pass: DoALLFg bNoStop                                                  //
34148>>>>>  // Added bNoStop, If true, all items are validated. It is up to you to    //
34148>>>>>  // do something with the possible cascade of errors                       //
34148>>>>>  //************************************************************************//
34148>>>>>  
34148>>>>>  Function Validate_Data_Sets integer DoAllFg integer bNoStop Returns Integer
34150>>>>>    Integer iDSO
34150>>>>>    Integer iRetval
34150>>>>>    Integer iCount
34150>>>>>    Integer iMax
34150>>>>>    Integer bErr
34150>>>>>    Boolean bDDHasFindReqError
34150>>>>>    // ShowLn "Validate_Data_Sets in Data_Set in " (Name(self))
34150>>>>>    // Validate if not foreign, or foreign new saves allowed, or
34150>>>>>    // foreign validation is supported (it normally is)
34150>>>>>    If (Operation_Origin=self OR ;        Allow_Foreign_New_Save_State(self) OR ;        Validate_Foreign_File_State(Self)) Begin
34152>>>>>            
34152>>>>>      If (bNoStop) Begin
34154>>>>>          // if do all, it is possible that this DD as a find-req error. If so there is no
34154>>>>>          // need to look for more errors in this DD or its parents. This makes the do all checking
34154>>>>>          // a little more intelligent and doesn't return a bunch of errors when it is not needed
34154>>>>>          Get DDHasFindReqError to bDDHasFindReqError
34155>>>>>      End
34155>>>>>>
34155>>>>>      
34155>>>>>      If (not(bDDHasFindReqError)) Begin
34157>>>>>          Get Data_Set_Server_Count to iMax
34158>>>>>          Decrement iMax
34159>>>>>          For iCount from 0 to iMax
34165>>>>>>
34165>>>>>            Get Data_Set_Server iCount to iDSO
34166>>>>>            If not (Visited_state(iDSO)) Begin
34168>>>>>               Get Validate_Data_Sets of iDSO DoAllFg bNoStop to bErr
34169>>>>>               If bErr Begin
34171>>>>>                   Move bErr to iRetVal
34172>>>>>                   If bNoStop Move 0 to bErr
34175>>>>>               End
34175>>>>>>
34175>>>>>            End
34175>>>>>>
34175>>>>>          Until bErr
34177>>>>>          If not bErr Begin
34179>>>>>             Get Validate_Fields DoAllFg bNoStop to bErr
34180>>>>>             If bErr Move bErr to iRetVal
34183>>>>>          End
34183>>>>>>
34183>>>>>      End
34183>>>>>>
34183>>>>>    End
34183>>>>>>
34183>>>>>    Set Visited_State to TRUE
34184>>>>>    Function_Return iRetval
34185>>>>>  End_Function // Validate_Data_Sets
34186>>>>>  
34186>>>>>// This tests the DDO and all "up" DDOs to see if a switched parent / commit test even needs to be
34186>>>>>// tested. This is called by the top ValidateSwitchedCommittedParents to see if a switch parent test
34186>>>>>// even needs to be applied before it has to refinds records.
34186>>>>>// Return true is there is nothing to test (i.e., the shortcut worked). 
34186>>>>>Function IsCommittedRecursiveUpParentChangeAllowed Returns Boolean
34188>>>>>  Boolean bAllowed bCommitted bVisited bHasRecord
34188>>>>>  Integer iServers iSrvr iParent
34188>>>>>  Handle hoSrvr
34188>>>>>
34188>>>>>
34188>>>>>  // optimization. We only test committed parents if one parent does not allow changing committed records.
34188>>>>>  // This avoids extra finds and relates when not needed
34188>>>>>  Set Visited_State to True
34189>>>>>  Get Data_Set_Server_Count to iServers
34190>>>>>  Get IsCommitted to bCommitted
34191>>>>>  Move 0 to iSrvr
34192>>>>>  Move True to bAllowed
34193>>>>>  While (iSrvr<iServers and bAllowed) 
34197>>>>>      Get Data_Set_Server iSrvr to hoSrvr
34198>>>>>      Get Main_File of hoSrvr to iParent
34199>>>>>      // if committed and parent change not allowed, we are done
34199>>>>>      If (bCommitted) Begin
34201>>>>>          Get IsCommittedParentChangeAllowed iParent to bAllowed
34202>>>>>      End
34202>>>>>>
34202>>>>>      // if still allowed, check all parents
34202>>>>>      If (bAllowed) Begin
34204>>>>>        Get Visited_State of hoSrvr to bVisited
34205>>>>>        If not bVisited Begin
34207>>>>>            Get IsCommittedRecursiveUpParentChangeAllowed of hoSrvr to bAllowed
34208>>>>>        End
34208>>>>>>
34208>>>>>      End
34208>>>>>>
34208>>>>>      Increment iSrvr
34209>>>>>  Loop
34210>>>>>>
34210>>>>>  Function_Return bAllowed  
34211>>>>>End_Function
34212>>>>>
34212>>>>>
34212>>>>>// special validate-save check for changed committed parent. If the record is committed
34212>>>>>// and it has a switched parent and this is not allowed, we have an error. This should rarely happen because the
34212>>>>>// DEOs should guard aginst this. This is a recursive routine that requires special attention the first time through.
34212>>>>>// When called from the we must refind the original record and all original parents. This way we can compare these parent
34212>>>>>// rowids to the DD row id (if different, they've changed). At the end we must restore the DD records. Because this takes time
34212>>>>>// we only even do this if this is committed and there is a chance that there are changed parents
34212>>>>>
34212>>>>>Function ValidateSwitchedCommittedParents Boolean bTop Returns Boolean
34214>>>>>      Integer iServers iSrvr iMain iParent iPMain
34214>>>>>      Handle hoSrvr
34214>>>>>      RowID riCrnt riParent riPCrnt
34214>>>>>      Boolean bChanged bCommitted bAllowed bErr bParentChanged bVisited 
34214>>>>>      Boolean bHasRecord bPHasRecord bFound
34214>>>>>
34214>>>>>      
34214>>>>>      // Shortcut optimization. This tests for any committed DDO with a parent that doesn't allow a switch 
34214>>>>>      // return true if there is any reason to actually test any DDO up the tree for a parent change
34214>>>>>      If bTop Begin
34216>>>>>          // init visited nodes, these will be tested and set in IsCommittedRecursiveUpParentChangeAllowed
34216>>>>>          Send Initialize_Visited False False //false=up only, true=clear fields
34217>>>>>          Get IsCommittedRecursiveUpParentChangeAllowed to bAllowed
34218>>>>>          If bAllowed Begin
34220>>>>>              Function_Return False // if all are allowed, we have nothing to test - its ok
34221>>>>>          End
34221>>>>>>
34221>>>>>      End
34221>>>>>>
34221>>>>>      
34221>>>>>      Get Main_File to iMain
34222>>>>>      Get CurrentRowId to riCrnt
34223>>>>>      Get Data_Set_Server_Count to iServers
34224>>>>>      Get HasRecord to bHasRecord  
34225>>>>>      
34225>>>>>      If (bHasRecord and (bTop or not(IsSameRowID(GetRowID(iMain),riCrnt))) ) Begin
34227>>>>>          // this refinds the main record and, most importantly, relates all original parents on up
34227>>>>>          // We now have the original parents which we can test to see if they are changed.
34227>>>>>          Get ReadByRowIdEx iMain riCrnt to bFound
34228>>>>>          If not bFound Begin
34230>>>>>            Error DFERR_CANT_REFIND_RECORD
34231>>>>>>
34231>>>>>            Function_Return True
34232>>>>>          End
34232>>>>>>
34232>>>>>      End
34232>>>>>>
34232>>>>>
34232>>>>>      If (bTop) Begin
34234>>>>>          // If at start, init visited nodes, these will be tested and set during recursive calls to this function
34234>>>>>          Send Initialize_Visited False False // false=up only, true=clear fields
34235>>>>>      End
34235>>>>>>
34235>>>>>      
34235>>>>>      Set Visited_State to True
34236>>>>>      Get IsCommitted to bCommitted
34237>>>>>      If bCommitted Begin
34239>>>>>          // Parent_Changed_State tells us a parent is changed but not which one. Look at each child to see if it is changed.
34239>>>>>          // First see any any of the parents are changed.
34239>>>>>          Get Parent_Changed_State to bChanged
34240>>>>>          If bChanged Begin
34242>>>>>              // Parent_Changed_State tells us a parent is changed but not which one. Look at each child to see if it is changed.
34242>>>>>              Move 0 to iSrvr
34243>>>>>              While (iSrvr<iServers and not(bErr))
34247>>>>>                  Get Data_Set_Server iSrvr to hoSrvr
34248>>>>>                  Get Main_File of hoSrvr to iParent
34249>>>>>                  Get CurrentRowId of hoSrvr to riParent
34250>>>>>                  Move (not(IsSameRowID(GetRowID(iParent),riParent))) to bParentChanged // is parent changed?
34251>>>>>                  If bParentChanged Begin
34253>>>>>                      Get IsCommittedParentChangeAllowed iParent to bAllowed // is changing committed parent allowed?
34254>>>>>                      If not bAllowed Begin
34256>>>>>                          Move True to bErr
34257>>>>>                          If bErr Begin
34259>>>>>                              Send Data_Set_Error of hoSrvr -1 0 DD_CANNOT_SWITCH_PARENT
34260>>>>>                          End
34260>>>>>>
34260>>>>>                      End
34260>>>>>>
34260>>>>>                  End
34260>>>>>>
34260>>>>>                  Increment iSrvr
34261>>>>>              Loop
34262>>>>>>
34262>>>>>          End
34262>>>>>>
34262>>>>>      End
34262>>>>>>
34262>>>>>      
34262>>>>>      // no error in immediate we must continue this check up the parent tree.
34262>>>>>      Move 0 to iSrvr
34263>>>>>      While (iSrvr<iServers and not(bErr))
34267>>>>>          Get Data_Set_Server iSrvr to hoSrvr
34268>>>>>          Get Visited_State of hoSrvr to bVisited
34269>>>>>          If (not(bVisited)) Begin   
34271>>>>>              
34271>>>>>              // if new record, we need to refind parent records from here since you cannot
34271>>>>>              // have done a find/relate on a new record.
34271>>>>>              If (not(bHasRecord)) Begin
34273>>>>>                 Get HasRecord of hoSrvr to bPHasRecord  
34274>>>>>                 If (bPHasRecord) Begin
34276>>>>>                     Get Main_File of hoSrvr to iPMain
34277>>>>>                     Get CurrentRowId of hoSrvr to riPCrnt
34278>>>>>                     If (not(IsNullRowID(riPCrnt))) Begin
34280>>>>>                         Get ReadByRowIdEx of hoSrvr iPMain riPCrnt to bFound
34281>>>>>                         If not bFound Begin
34283>>>>>                            Error DFERR_CANT_REFIND_RECORD
34284>>>>>>
34284>>>>>                            Function_Return True
34285>>>>>                         End
34285>>>>>>
34285>>>>>                     End
34285>>>>>>
34285>>>>>                 End
34285>>>>>>
34285>>>>>              End
34285>>>>>>
34285>>>>>              
34285>>>>>              Get ValidateSwitchedCommittedParents of hoSrvr False to bErr // call recursively up the parent tree
34286>>>>>          End
34286>>>>>>
34286>>>>>          Increment iSrvr
34287>>>>>      Loop
34288>>>>>>
34288>>>>>      
34288>>>>>      If bTop Begin // if back to the top, make sure our buffers are correct.
34290>>>>>          Send Refind_Records
34291>>>>>      End
34291>>>>>>
34291>>>>>      
34291>>>>>      Function_Return bErr
34292>>>>>End_Function
34293>>>>>
34293>>>>>  //************************************************************************//
34293>>>>>  // Entry_Update_Data_Sets                                                 //
34293>>>>>  // This sends entry_update to all server data-sets and itself             //
34293>>>>>  //************************************************************************//
34293>>>>>
34293>>>>>    Procedure Entry_Update_Data_Sets Integer iFile Integer iAll
34295>>>>>
34295>>>>>        Handle hoBuff hoDSO
34295>>>>>        Boolean bCommit bIsFind bVisited bIsForeign
34295>>>>>        Integer iMax iCount iItems iOpts iChanges 
34295>>>>>        
34295>>>>>        
34295>>>>>        Move record_buffer to hoBuff
34296>>>>>        Move (OPERATION_MODE<>MODE_SAVING) to bIsFind
34297>>>>>                
34297>>>>>        // first recurse to all parent ddos
34297>>>>>        Get Data_Set_Server_Count to iMax
34298>>>>>        Decrement iMax
34299>>>>>        For iCount from 0 to iMax
34305>>>>>>
34305>>>>>            Get Data_Set_Server iCount to hoDSO
34306>>>>>            Get Visited_State of hoDSO to bVisited
34307>>>>>            If not (bVisited) Begin
34309>>>>>               Send Entry_Update_Data_Sets to hoDSO iFile iAll
34310>>>>>            End
34310>>>>>>
34310>>>>>        Loop
34311>>>>>>
34311>>>>>        
34311>>>>>        // if find, we only do this if the main file is the same as the find file
34311>>>>>        If (not(bIsFind) or iFile=Main_File(Self)) Begin
34313>>>>>            If (not(bIsFind)) Begin
34315>>>>>                // if a save, we care if it is committed.
34315>>>>>                Get IsCommitted to bCommit
34316>>>>>            End
34316>>>>>>
34316>>>>>            
34316>>>>>            // pass if Find (True) or save (False). We only care about commit on saves
34316>>>>>            // The setting of bIsForeign is an approximation. Foreign is really a DEO and and not
34316>>>>>            // a DD concept - in fact, at this point we don't really know. For example, a save in a header/dtl 
34316>>>>>            // detail DEO (ordrdtl grid)has header DEOs that are not really foreign. This test errs on the side
34316>>>>>            // of assuming it's foreign. This would cause problems with incorrect parent NoPuts except we also
34316>>>>>            // set a flag, Field_NoPutValueChangedByDeo, when a field is changed via a NoPut DEO. The DD will still update
34316>>>>>            // foreign NoPuts unless this field flag is set.
34316>>>>>            Move (OPERATION_ORIGIN<>Self and Allow_Foreign_New_Save_State(Self)=0) to bIsForeign
34317>>>>>            Send Entry_Update of hoBuff bIsFind (If(bCommit,1,0) + If(bIsForeign,2,0))
34318>>>>>            
34318>>>>>            // also move data from extended dd fields to buffer
34318>>>>>            Send ExtendedFieldsUpdate (not(bIsFind))
34319>>>>>        End    
34319>>>>>>
34319>>>>>        Set Visited_State to True
34320>>>>>        
34320>>>>>    End_Procedure
34321>>>>>    
34321>>>>>    // is this field NoPut based passed Commit and Foreign flags.
34321>>>>>    Function FieldNoPut Integer iField Boolean bIsCommited Boolean bIsForeign Returns Boolean 
34323>>>>>        Boolean bNoPut
34323>>>>>        // this uses runtime logic - the same use for moving DD Buffer to Field Buffer
34323>>>>>        Get IsFieldDDNoPut of Record_Buffer iField (If(bIsCommited,1,0) + If(bIsForeign,2,0)) to bNoPut 
34324>>>>>        Function_Return bNoPut
34325>>>>>    End_Function
34326>>>>>
34326>>>>>
34326>>>>>  //************************************************************************//
34326>>>>>  // Valid_Servers                                                          //
34326>>>>>  // Check that Server data-sets exist for all required server file numbers //
34326>>>>>  //************************************************************************//
34326>>>>>
34326>>>>>  Function Valid_Servers returns integer
34328>>>>>      integer iRval
34328>>>>>      integer iCount
34328>>>>>      integer iMax
34328>>>>>      integer iDSO
34328>>>>>      integer iPos
34328>>>>>      integer iFile
34328>>>>>      String  sFiles
34328>>>>>
34328>>>>>      // First assemble a string of all server file#s in ','##',' format
34328>>>>>      Move ',' to sFiles
34329>>>>>      Get Data_Set_Server_Count to iMax
34330>>>>>      Decrement iMax
34331>>>>>      For iCount from 0 to iMax
34337>>>>>>
34337>>>>>          Get Data_Set_Server iCount to iDSO
34338>>>>>          Move ( sFiles + string(Main_file(iDSO)) + ",") to sFiles
34339>>>>>      Loop
34340>>>>>>
34340>>>>>
34340>>>>>      // Make sure each required File exists
34340>>>>>      Get Server_File_Count to iMax
34341>>>>>      Decrement iMax
34342>>>>>      For iCount from 0 to iMax
34348>>>>>>
34348>>>>>          Get Server_File iCount to iFile
34349>>>>>          Pos (','+string(iFile)+',') in sFiles to iPos
34351>>>>>>
34351>>>>>          If iPos eq 0 Move iFile to iRVal
34354>>>>>      Until iRval
34356>>>>>      Function_Return iRVal
34357>>>>>  End_Function
34358>>>>>
34358>>>>>
34358>>>>>  //************************************************************************//
34358>>>>>  // Valid_Clients                                                          //
34358>>>>>  // Check that Client data-sets exist for all required Client file numbers //
34358>>>>>  //************************************************************************//
34358>>>>>
34358>>>>>  Function Valid_Clients returns integer
34360>>>>>      integer iRval
34360>>>>>      integer iCount
34360>>>>>      integer iMax
34360>>>>>      integer iDSO
34360>>>>>      integer iPos
34360>>>>>      integer iFile
34360>>>>>      String  sFiles
34360>>>>>
34360>>>>>      // First assemble a string of all Client file#s in ','##',' format
34360>>>>>      Move ',' to sFiles
34361>>>>>      Get Data_Set_Client_Count to iMax
34362>>>>>      Decrement iMax
34363>>>>>      For iCount from 0 to iMax
34369>>>>>>
34369>>>>>          Get Data_Set_Client iCount to iDSO
34370>>>>>          Move ( sFiles + string(Main_file(iDSO))+",") to sFiles
34371>>>>>      Loop
34372>>>>>>
34372>>>>>
34372>>>>>      // Make sure each required File exists
34372>>>>>      Get Client_File_Count to iMax
34373>>>>>      Decrement iMax
34374>>>>>      For iCount from 0 to iMax
34380>>>>>>
34380>>>>>          Get Client_File iCount to iFile
34381>>>>>          Pos (','+string(iFile)+',') in sFiles to iPos
34383>>>>>>
34383>>>>>          If iPos eq 0 Move iFile to iRVal
34386>>>>>      Until iRval
34388>>>>>      Function_Return iRVal
34389>>>>>  End_Function
34390>>>>>
34390>>>>>
34390>>>>>  //************************************************************************//
34390>>>>>  // Function Validate_Save_Structure                                       //
34390>>>>>  // Validates save updating connections. If error returns file# that is    //
34390>>>>>  // expected and missing. If no error Set Validated_Save_connectio_State   //
34390>>>>>  // indicating that the connection validation has occurred and is ok       //
34390>>>>>  //************************************************************************//
34390>>>>>
34390>>>>>  Function Validate_Save_Structure Integer ForceFg returns Integer
34392>>>>>    Integer iRval
34392>>>>>    Integer iMode
34392>>>>>    If Not ForceFg Begin
34394>>>>>       Get Validate_Save_Structure_Mode to iMode
34395>>>>>       Move ( iMode=DD_VALIDATE_STRUCTURE_ALWAYS OR ;              (iMode=DD_VALIDATE_STRUCTURE_ONCE AND ;                Save_Structure_Validated_state(self)=0 ) ) ;                  to ForceFg
34396>>>>>    End
34396>>>>>>
34396>>>>>    If ForceFg Begin
34398>>>>>       Get Valid_Structure False to iRval
34399>>>>>       if iRVal eq 0 ;          Set Save_Structure_Validated_State to TRUE
34402>>>>>    End
34402>>>>>>
34402>>>>>    Function_Return iRVal
34403>>>>>  End_Function
34404>>>>>
34404>>>>>
34404>>>>>  //************************************************************************//
34404>>>>>  // Function Validate_delete_Structure                                     //
34404>>>>>  // Validates Delete Structure. If cascade_state is true this must check   //
34404>>>>>  // up and down the tree. If no cascade_state just check up the tree.  If  //
34404>>>>>  // Ok, set Validated_Delete_no_Cascade_Connection_State and and or        //
34404>>>>>  // Validated_Delete_Cascade_Connection_State                              //
34404>>>>>  // Pass: ForceFg - if TRUE force the validation.                          //
34404>>>>>  //************************************************************************//
34404>>>>>
34404>>>>>  Function Validate_Delete_Structure Integer ForceFg Returns Integer
34406>>>>>     Integer iCascade
34406>>>>>     Integer iMode
34406>>>>>     Integer iSt
34406>>>>>     Integer iRval
34406>>>>>     Get Cascade_delete_State to iCascade
34407>>>>>     If Not ForceFg Begin
34409>>>>>        Get Validate_Delete_Structure_Mode to iMode
34410>>>>>        If (iMode=DD_VALIDATE_STRUCTURE_ONCE AND iCascade );           Get Cascade_Delete_Structure_Validated_state to iSt
34413>>>>>        Else ;           Get No_Cascade_Delete_Structure_Validated_state to iSt
34415>>>>>        Move ( iMode=DD_VALIDATE_STRUCTURE_ALWAYS OR ;               (iMode=DD_VALIDATE_STRUCTURE_ONCE AND iSt=0) ) to ForceFg
34416>>>>>     End
34416>>>>>>
34416>>>>>
34416>>>>>     If ForceFg Begin
34418>>>>>        Get Valid_Structure iCascade to iRval
34419>>>>>        If iRval eq 0 Begin
34421>>>>>           Set No_Cascade_Delete_Structure_Validated_State to TRUE
34422>>>>>           If iCascade ;              Set Cascade_Delete_Structure_Validated_State to TRUE
34425>>>>>        End
34425>>>>>>
34425>>>>>     End
34425>>>>>>
34425>>>>>     Function_return iRval
34426>>>>>  End_Function
34427>>>>>
34427>>>>>
34427>>>>>  //************************************************************************//
34427>>>>>  // Request_Entry_Update.                                                  //
34427>>>>>  // This procedure will be called whenever the Data_Set wants its DEOs to  //
34427>>>>>  // write their values to the record buffer. The value of OPERATION_MODE   //
34427>>>>>  // determines if this is for finding an record or before saving a record. //
34427>>>>>  // We use this event to tell our Record_Buffer to update the              //
34427>>>>>  // global record buffer.                                                  //
34427>>>>>  // Modified to visit all server DSOs                                      //
34427>>>>>  // Note that this is only sent to the DSO starting the operation.         //
34427>>>>>  // We must manually send this to all server data-sets ourselves           //
34427>>>>>  // Note that during a DSO save this will get passed iFile=0 and iAll=3    //
34427>>>>>  // Changed to Support EntryUpdateLocalState (private)                     //
34427>>>>>  //************************************************************************//
34427>>>>>  // as of 17.0, EntryUpdateLocalState is True which means that entry_updates
34427>>>>>  // for finds now through the DD Buffer (saves always did).
34427>>>>>
34427>>>>>  Procedure Request_Entry_Update Integer iFile Integer iAll
34429>>>>>    If ((Operation_Mode=MODE_SAVING and iAll=3) or (EntryUpdateLocalState(Self)) ) Begin //3=dso save
34431>>>>>      If (OPERATION_MODE=MODE_WAITING) Begin
34433>>>>>          // we will only not be in an operation if we are doing a find with EntryUpdateLocalState
34433>>>>>          // set to true. In such a case make this a finding. I am not this is actually needed
34433>>>>>          Send Update_Focus_Field_For_Operation MODE_FINDING
34434>>>>>      End
34434>>>>>>
34434>>>>>      Else Begin
34435>>>>>          // if here we already have an operation_mode so there is no need to do anything special       
34435>>>>>          Send Update_Focus_Field // Make sure buffer has latest focus item changes
34436>>>>>      End
34436>>>>>>
34436>>>>>      Send Initialize_Visited False False // Clear up, do not clear fields
34437>>>>>      Send Entry_Update_Data_Sets iFile iAll
34438>>>>>    End
34438>>>>>>
34438>>>>>    Forward Send Request_Entry_Update iFile iAll
34440>>>>>  End_Procedure
34441>>>>>
34441>>>>>
34441>>>>>
34441>>>>>  //************************************************************************//
34441>>>>>  // Update_Focus_Field                                                     //
34441>>>>>  // Forces the focus field to get update its value with the data-set.      //
34441>>>>>  // This insures that the DSO and DEO contain the same values.             //
34441>>>>>  //************************************************************************//
34441>>>>>
34441>>>>>  Procedure Update_Focus_Field
34443>>>>>    Integer iFocObj
34443>>>>>    Get Focus of desktop to iFocObj
34444>>>>>    If (Extended_DEO_State(iFocObj)) ;        Send Update_Focus_Field to iFocObj
34447>>>>>  End_Procedure
34448>>>>>  
34448>>>>>  // very internal. Used to set Operation_mode and Operation_origin before the
34448>>>>>  // update. A developer can use this in the DEO to know what state the update is in.
34448>>>>>  // This was created because a DEO value change will trigger an OnChange event and you 
34448>>>>>  //can look at this and know that this is part of a DD operation.
34448>>>>>  // This is *only* called by the DD operations in this class and the change is made for as
34448>>>>>  // small of a period as possible.
34448>>>>>  Procedure Update_Focus_Field_For_Operation Integer iOperationMode
34450>>>>>    Integer iOldMode iOldOrigin
34450>>>>>    
34450>>>>>    Move OPERATION_MODE to iOldMode
34451>>>>>    Move OPERATION_ORIGIN to iOldOrigin
34452>>>>>    Move iOperationMode to OPERATION_MODE
34453>>>>>    Move Self to OPERATION_ORIGIN
34454>>>>>    Send Update_Focus_Field
34455>>>>>    Move iOldMode to OPERATION_MODE
34456>>>>>    Move iOldOrigin to OPERATION_ORIGIN
34457>>>>>  End_Procedure
34458>>>>>  
34458>>>>>
34458>>>>>  //************************************************************************//
34458>>>>>  // Request_validate                                                       //
34458>>>>>  // Augment to validate all field values that do not get                   //
34458>>>>>  // validated as part of the item validation process. The advantage        //
34458>>>>>  // of item validation (over only field validation) is that an error       //
34458>>>>>  // returns you to the offending item.                                     //
34458>>>>>  //************************************************************************//
34458>>>>>
34458>>>>>  Function Request_Validate Returns Integer
34460>>>>>    Integer iRetval iOldOrigin iOldMode iRetVal2
34460>>>>>    Handle[] DDsWithFindReqErrors
34461>>>>>    
34461>>>>>    If (OPERATION_MODE=MODE_WAITING) Begin
34463>>>>>        Send Update_Focus_Field_For_Operation MODE_VALIDATING // added 12.1/15.1
34464>>>>>    End
34464>>>>>>
34464>>>>>    Move Operation_Origin to iOldOrigin
34465>>>>>    Move self to Operation_Origin
34466>>>>>    Move Operation_Mode to iOldMode
34467>>>>>    // clear all find req DD markers at the origin of the validate request. When request validates occur
34467>>>>>    // they will get added to this array and can be tested to see of such an error has occurred.
34467>>>>>    Set pDDsWithFindReqErrors to DDsWithFindReqErrors
34468>>>>>    // Prior to VDF7, we set this to Mode_Saving. We now have a special mode just for request_validate.
34468>>>>>    // We do this because:
34468>>>>>    //   1) because it is useful (more detail never hurts) and
34468>>>>>    //   2) we will allow set_field_current_value to update when mode_validation is set
34468>>>>>    Move MODE_VALIDATING to Operation_Mode
34469>>>>>    Send Initialize_Visited FALSE TRUE //false=up only, true=clear fields
34470>>>>>    Forward Get Request_Validate to iRetval // normal deo validate
34472>>>>>    // If DEO validation failed, do not validate other fields unless Validate_All_Fields is set
34472>>>>>    If ( (iRetval=0 or (Validate_All_Fields_State(Self))) and Validate_DEOs_Only_State(Self)=0) Begin
34474>>>>>       Get Validate_Data_Sets False (Validate_All_Fields_State(Self)) to iRetval2
34475>>>>>       Move (iRetval or iRetVal2) to iRetval         
34476>>>>>    End
34476>>>>>>
34476>>>>>       
34476>>>>>    If (iRetval=0) Begin
34478>>>>>         Get ValidateSwitchedCommittedParents True to iRetval
34479>>>>>    End
34479>>>>>>
34479>>>>>    
34479>>>>>    Move iOldMode   to Operation_Mode
34480>>>>>    Move iOldOrigin to Operation_Origin
34481>>>>>    Function_Return iRetval
34482>>>>>  End_Function // Request_Validate
34483>>>>>
34483>>>>>  Function Request_Validate_All Returns Integer
34485>>>>>    Integer bOld iRetVal
34485>>>>>    Get Validate_All_Fields_State to bOld
34486>>>>>    Set Validate_All_Fields_State to True
34487>>>>>    Get request_validate to iretVal
34488>>>>>    Set Validate_All_Fields_State to bOld
34489>>>>>    Function_Return iRetval
34490>>>>>  End_Function // Request_Validate_All
34491>>>>>
34491>>>>>
34491>>>>>
34491>>>>>  //************************************************************************//
34491>>>>>  // File_Field_Find                                                        //
34491>>>>>  // Like Item_find except entry-update is forced through the DD, not DEO   //
34491>>>>>  //************************************************************************//
34491>>>>>
34491>>>>>  procedure File_Field_Find integer iFindMode integer iFile integer iField ;                            integer bEntUpdt  integer bShowErr integer bDfrd
34493>>>>>     Integer bOld
34493>>>>>     Get EntryUpdateLocalState to bOld
34494>>>>>     Set EntryUpdateLocalState to True
34495>>>>>     Send Item_Find iFindMode iFile iField bEntUpdt bShowErr bDfrd
34496>>>>>     Set EntryUpdateLocalState to bOld
34497>>>>>  End_Procedure
34498>>>>>
34498>>>>>  //************************************************************************//
34498>>>>>  // File_Field_AutoFind                                                    //
34498>>>>>  // Autofind for requestd file, field and mode.                            //
34498>>>>>  //    If mode not passed, EQ is assummed                                  //
34498>>>>>  //************************************************************************//
34498>>>>>
34498>>>>>  Procedure File_Field_AutoFind integer iFile integer iField integer iFindMode
34500>>>>>     integer eMode
34500>>>>>     if iFile  Begin
34502>>>>>        // if no 3rd argument, default to autofind
34502>>>>>        Move (If(Num_Arguments<3,EQ,iFindMode)) to eMode
34503>>>>>        send File_Field_Find eMode iFile iField True False False
34504>>>>>     end
34504>>>>>>
34504>>>>>  End_Procedure
34505>>>>>
34505>>>>>  //************************************************************************//
34505>>>>>  // File_Field_Default_AutoFind                                            //
34505>>>>>  // Autofind in default mode (does not set changed states). Can be used    //
34505>>>>>  // within Clear and Clear_all to autofind parents. Parent values can be   //
34505>>>>>  // maintained using retainAll option                                      //
34505>>>>>  //************************************************************************//
34505>>>>>
34505>>>>>  Procedure File_Field_Default_AutoFind integer iFile integer iField
34507>>>>>     integer iOldState
34507>>>>>     Handle  hoDD
34507>>>>>     Get Data_set iFile to hoDD
34508>>>>>     if hoDD Begin
34510>>>>>         Get Change_disabled_State of hoDD to iOldState
34511>>>>>         Set Change_disabled_State of hoDD to TRUE
34512>>>>>         Send File_Field_AutoFind  of hoDD iFile iField EQ
34513>>>>>         Set Change_disabled_State of hoDD to iOldState
34514>>>>>         set changed_state to false
34515>>>>>     end
34515>>>>>>
34515>>>>>  End_Procedure
34516>>>>>
34516>>>>>  //************************************************************************//
34516>>>>>  // File_Index_find                                                        //
34516>>>>>  // Like item_find except you pass the index you want to find with and     //
34516>>>>>  // ent-update occurs through DDO buffers not deo buffers.                 //
34516>>>>>  // This is currently private and is only used by web-applications         //
34516>>>>>  //************************************************************************//
34516>>>>>  procedure File_Index_Find integer iFindMode integer iFile integer iIndex ;                            integer bEntUpdt  integer bShowErr integer bDfrd
34518>>>>>      Integer bOld
34518>>>>>      rowId riRec
34518>>>>>      integer wasChanged hDD iOldStat
34518>>>>>      Boolean bOk
34518>>>>>
34518>>>>>      Get Data_Set iFile to hDD
34519>>>>>      if (hDD=0) Begin
34521>>>>>          error DFERR_PROGRAM C_$CannotFindDD
34522>>>>>>
34522>>>>>          Procedure_return
34523>>>>>      end
34523>>>>>>
34523>>>>>
34523>>>>>      Get EntryUpdateLocalState to bOld
34524>>>>>      Set EntryUpdateLocalState to True
34525>>>>>
34525>>>>>      //  'hold' buffer to prepare for entry_update
34525>>>>>      Move (getRowId(iFile)) to riRec
34526>>>>>      Get_Attribute DF_FILE_STATUS of iFile to iOldStat
34529>>>>>      Set_Attribute DF_FILE_STATUS of iFile to DF_FILE_INACTIVE
34532>>>>>
34532>>>>>      if bEntUpdt begin
34534>>>>>          send Request_Entry_Update to hDD iFile 1  //entUpdt all DEOs as required
34535>>>>>
34535>>>>>          //
34535>>>>>          // we really only need to know if any segment of the index changed
34535>>>>>          // but since we don't have field-changed flags, we look at the
34535>>>>>          // whole recbuf - this is consistent with 2.3b and 3.0 non-dataset
34535>>>>>          // behavior.
34535>>>>>          //
34535>>>>>          move (iOldStat<>DF_FILE_INACTIVE) to wasChanged
34536>>>>>          if not wasChanged ;              Get_Attribute DF_FILE_CHANGED of iFile to wasChanged
34541>>>>>          if not wasChanged ;              constrained_clear iFindMode iFile by iIndex
34546>>>>>
34546>>>>>          //send Attach_Main_File to hDD // not needed, gets called by the find
34546>>>>>      end
34546>>>>>>
34546>>>>>      indicate err false
34547>>>>>      if bDfrd ;          send Request_Read iFindMode iFile iIndex
34550>>>>>      else ;          send Request_Find iFindMode iFile iIndex
34552>>>>>      If (not(found) and  not(err)) begin
34554>>>>>          // refind original record (or leave it cleared if not record)
34554>>>>>          Move (FindByRowId(iFile,riRec)) to bOk
34555>>>>>
34555>>>>>          if bShowErr ;             error (if(iFindMode<2, DFERR_FIND_PRIOR_BEG_OF_FILE, DFERR_FIND_PAST_END_OF_FILE))
34558>>>>>          indicate Found False
34559>>>>>      end
34559>>>>>>
34559>>>>>      Set EntryUpdateLocalState to bOld
34560>>>>>  End_Procedure
34561>>>>>
34561>>>>>
34561>>>>>  //************************************************************************//
34561>>>>>  // Find_Records                                                           //
34561>>>>>  // This does a refind of all records based on the contents of the         //
34561>>>>>  // refine_record_id property.                                             //
34561>>>>>  // This would be used after clearing the DDs and loading the local rencum //
34561>>>>>  // buffer with recnums. This can be used by remote DEOs (BPOs).           //
34561>>>>>  //                                                                        //
34561>>>>>  // Find all existing records. This must be done in bottom-up, breadth     //
34561>>>>>  // first order. i.e., Start with the passed DD, find it and then find for //
34561>>>>>  // parents. Only find if the record is non-zero and it is different than  //
34561>>>>>  // the current_record.                                                    //
34561>>>>>  // This order will allow us to support changed parents.                   //
34561>>>>>  // Don't use this if you do not understand what it does.                  //
34561>>>>>  // Private.Find_Records is a helper. We will keep this private because    //
34561>>>>>  // it is rather specialized and only used by WebApp.                      //
34561>>>>>  //************************************************************************//
34561>>>>>
34561>>>>>  Procedure Find_Records
34563>>>>>     Send Initialize_Visited False False // Clear up, do not clear fields
34564>>>>>     Send Private.Find_Records           // refind all records in upward sweep
34565>>>>>  End_Procedure
34566>>>>>
34566>>>>>
34566>>>>>  Procedure Private.Find_Records
34568>>>>>     Integer hPrnt
34568>>>>>     integer iMax
34568>>>>>     integer iCount
34568>>>>>     RowId riRec
34568>>>>>     Integer iRec iMain
34568>>>>>     // works with both recId and rowId. Only one should ever be set.
34568>>>>>     // find(clear) record, if needed
34568>>>>>     Get Main_File to iMain
34569>>>>>     // assume that either Find_rowId or Find_record_id has a value - never both
34569>>>>>     // also assume Find_record_id only has values when you are using a recnum table
34569>>>>>     Get Find_RowId to riRec
34570>>>>>     If not (IsNullRowId(riRec)) begin
34572>>>>>         If not (IsSameRowId(riRec, CurrentRowId(self) ) ) begin
34574>>>>>             Send FindByRowId iMain riRec // find an Relate all parents
34575>>>>>         end
34575>>>>>>
34575>>>>>         Set Find_rowid to (NullRowId())  // reset refind rec back to zero.
34576>>>>>     end
34576>>>>>>
34576>>>>>     else begin
34577>>>>>         // if this has a recnum, it better be a recnum table or an error will occur.
34577>>>>>         // This is not being tested for a recnum table on purpose. If someone is setting Find_record_id
34577>>>>>         // on a non-recnum table, they doing something wrong. An Error will be a good thing.
34577>>>>>         Get Find_Record_Id to iRec
34578>>>>>         If iRec begin
34580>>>>>            If (iRec<>Current_record(self)) begin
34582>>>>>                Send Find_By_Recnum iMain iRec // find an Relate all parents
34583>>>>>            end
34583>>>>>>
34583>>>>>            Set Find_record_id to 0 // reset refind rec back to zero.
34584>>>>>         end
34584>>>>>>
34584>>>>>     end
34584>>>>>>
34584>>>>>     Set Visited_State to True
34585>>>>>
34585>>>>>     // recurse and do the same to all parent files
34585>>>>>     // in almost all cases, there will be no new finding here since the relate has
34585>>>>>     // found the records. If the record is different than the relate, we have
34585>>>>>     // a switched parent state (should_save will be set appropriately).
34585>>>>>     Get Data_Set_Server_Count to iMax
34586>>>>>     Decrement iMax
34587>>>>>     For iCount from 0 to iMax
34593>>>>>>
34593>>>>>        Get Data_Set_Server iCount to hPrnt
34594>>>>>        If Not (Visited_state(hPrnt)) ;           Send Private.Find_Records to hPrnt
34597>>>>>     Loop
34598>>>>>>
34598>>>>>  End_Procedure
34599>>>>>  
34599>>>>>// This Mark_Id creates a sequence Id for this clear. This way
34599>>>>>// DDOs only get cleared one time during this process.
34599>>>>>Procedure IncrementCurrentMarkId  
34601>>>>>    If (DD_Current_Mark_ID>65536) Begin
34603>>>>>        Move 0 to DD_Current_Mark_id
34604>>>>>    End
34604>>>>>>
34604>>>>>    Increment DD_Current_Mark_id
34605>>>>>End_Procedure
34606>>>>>
34606>>>>>
34606>>>>>  // private use by new webapp framework as of 18.2.
34606>>>>>  // pass bStart as True if this is the start of the resynch.
34606>>>>>  Function ReSyncRecords Boolean bStart Returns Handle
34608>>>>>     RowID riRowId riCrnt
34608>>>>>     Boolean bOk bOldReSync bVisited
34608>>>>>     Handle hoOtherDDO hoBadDDO hoBadPrntDDO
34608>>>>>     Integer iMax iCount iMain 
34608>>>>>     
34608>>>>>     If bStart Begin
34610>>>>>       Send InitializeAllVisited
34611>>>>>     End
34611>>>>>>
34611>>>>>     
34611>>>>>     // we want depth first traversal. Make sure children are handled before parents 
34611>>>>>     // Recursively traverse Children, Find by RowId, Recursively traverse Parents
34611>>>>>     // Use visited_state logic to avoid multiple visits caused by diamond DDO strutures 
34611>>>>>
34611>>>>>     //mark first so we don't visit this coming back up.
34611>>>>>     Set Visited_State to True
34612>>>>>
34612>>>>>     // traverse downward first
34612>>>>>     Get Data_Set_Client_Count to iMax
34613>>>>>     For iCount from 0 to (iMax-1)
34619>>>>>>
34619>>>>>        Get Data_Set_Client iCount to hoOtherDDO
34620>>>>>        Get Visited_State of hoOtherDDO to bVisited
34621>>>>>        If not bVisited Begin
34623>>>>>           Get ReSyncRecords of hoOtherDDO False to hoBadPrntDDO
34624>>>>>           If (hoBadPrntDDO and not(hoBadDDO)) Begin
34626>>>>>              Move hoBadPrntDDO to hoBadDDO  
34627>>>>>           End
34627>>>>>>
34627>>>>>        End
34627>>>>>>
34627>>>>>     Loop
34628>>>>>>
34628>>>>>
34628>>>>>     // Find record for DD. It might already be correct if child has already
34628>>>>>     // related it in. If not correct after a relate, this has been switched by this
34628>>>>>     // user or switched by another user, in which case it will be swtitched back
34628>>>>>     // (DDOs have always worked this way).
34628>>>>>     Get Find_RowId to riRowId
34629>>>>>     Get Main_File to iMain
34630>>>>>     Get CurrentRowId to riCrnt
34631>>>>>     If ( not(IsSameRowId(riRowID, riCrnt)) ) Begin
34633>>>>>         Get pbInReSync to bOldReSync
34634>>>>>         Set pbInReSync to True
34635>>>>>         
34635>>>>>         If (IsNullRowId(riRowID)) Begin
34637>>>>>           Send Clear
34638>>>>>         End
34638>>>>>>
34638>>>>>         Else Begin
34639>>>>>            Get FindByRowIdExNoAutoFill iMain riRowId to bOk
34640>>>>>            If not bOk Begin
34642>>>>>               Move Self to hoBadDDO 
34643>>>>>            End
34643>>>>>>
34643>>>>>         End
34643>>>>>>
34643>>>>>         Set pbInReSync to bOldReSync
34644>>>>>     End
34644>>>>>>
34644>>>>>     
34644>>>>>     // finally traverse to parents
34644>>>>>     Get Data_Set_Server_Count to iMax
34645>>>>>     For iCount from 0 to (iMax-1)
34651>>>>>>
34651>>>>>        Get Data_Set_Server iCount to hoOtherDDO
34652>>>>>        Get Visited_State of hoOtherDDO to bVisited
34653>>>>>        If not bVisited Begin
34655>>>>>           Get ReSyncRecords of hoOtherDDO False to hoBadPrntDDO
34656>>>>>           If (hoBadPrntDDO and not(hoBadDDO)) Begin
34658>>>>>              Move hoBadPrntDDO to hoBadDDO  
34659>>>>>           End
34659>>>>>>
34659>>>>>        End
34659>>>>>>
34659>>>>>     Loop
34660>>>>>>
34660>>>>>     
34660>>>>>     Function_Return hoBadDDO            
34661>>>>>  End_Function
34662>>>>>
34662>>>>>  // private use by new webapp framework (pre 18.2)
34662>>>>>  Function ReSyncRecord Returns Boolean
34664>>>>>     RowID riRowId
34664>>>>>//     Boolean bParentChanged
34664>>>>>     Boolean bOk bOldReSync
34664>>>>>     Handle hPrnt
34664>>>>>     Integer iMax iCount iMain
34664>>>>>     
34664>>>>>     Get pbInReSync to bOldReSync
34665>>>>>     
34665>>>>>     Get Find_RowId to riRowId
34666>>>>>// currently not needed. Developer can use DD-remember options, which is a better solution
34666>>>>>//     Get Find_ParentChanged to bParentChanged
34666>>>>>     Get Main_File to iMain
34667>>>>>     If not (IsSameRowId(riRowID, CurrentRowId(Self) ) ) Begin
34669>>>>>         If (IsNullRowId(riRowID)) Begin
34671>>>>>           Set pbInReSync to True
34672>>>>>           Send Clear
34673>>>>>           Set pbInReSync to bOldReSync
34674>>>>>         End
34674>>>>>>
34674>>>>>         Else Begin
34675>>>>>            Set pbInReSync to True
34676>>>>>            Get FindByRowIdExNoAutoFill iMain riRowId to bOk
34677>>>>>            Set pbInReSync to bOldReSync
34678>>>>>            If not bOk Begin
34680>>>>>               Function_Return False 
34681>>>>>            End
34681>>>>>>
34681>>>>>         End
34681>>>>>>
34681>>>>>         
34681>>>>>         // check that the relate found all the parent records we expect. 
34681>>>>>         // This should be correct unless a parent has been switched. Constrained
34681>>>>>         // parents, by definition, should already be correct. See **Note** below
34681>>>>>         Get Data_Set_Server_Count to iMax
34682>>>>>         For iCount from 0 to (iMax-1)
34688>>>>>>
34688>>>>>            Get Data_Set_Server iCount to hPrnt
34689>>>>>            If (Constrain_File(Self)<>Main_File(hPrnt) and ;                not (IsSameRowID(Find_RowId(hPrnt),CurrentRowId(hPrnt)))) Begin
34691>>>>>               // the parent is either wrong or not processed yet. Either way
34691>>>>>               // make it right.
34691>>>>>               Get ReSyncRecord of hPrnt to bOk
34692>>>>>               If not bOk Begin
34694>>>>>                  Function_Return False
34695>>>>>               End
34695>>>>>>
34695>>>>>            End
34695>>>>>>
34695>>>>>         Loop
34696>>>>>>
34696>>>>>     End
34696>>>>>>
34696>>>>>
34696>>>>>//     // we reset this in case a developer has manually created a parent default and 
34696>>>>>//     // set the child's parent_changed_state to false, by setting changed_state
34696>>>>>//     Set Changed_State to bParentChanged
34696>>>>>
34696>>>>>     Function_Return True            
34697>>>>>  End_Function
34698>>>>>
34698>>>>>   // **Note** - dealing with changed parents and diamonds during a resync. 
34698>>>>>   // If there is not a relates-to contraint between DD and child it is possible 
34698>>>>>   // that the child find's relate will change the just found parent DD. 
34698>>>>>   // Assuming this is not a structure bug, it means the parent is changed parent and that
34698>>>>>   // change must occur after the child record has been found and related. Therefore we add
34698>>>>>   // check after each child find to see if an parent is incorrect. If it is, either it is a
34698>>>>>   // switched parent or we haven't processed it yet. If the record is fine it
34698>>>>>   // just does nothing. For example (where *=relates-to):
34698>>>>>   //     W
34698>>>>>   //   */  \*
34698>>>>>   //   X    Y
34698>>>>>   //    \  /*
34698>>>>>   //     Z
34698>>>>>   // Assume you found a Z and changed its parent X.
34698>>>>>   // The refind order can be: WXZY or WYZX
34698>>>>>   // If WXZY the refound parent will be lost because Z will relate after the X
34698>>>>>   // find and replace it with the original parent. To control this we add this check
34698>>>>>   // after child Z has done its work. We only need to do this when child DDOs exist
34698>>>>>   // that are not constrained. This can change the order that DDOs are resynced but it
34698>>>>>   // should not matter.  
34698>>>>>
34698>>>>>
34698>>>>>
34698>>>>>  // Private use by new webapp framework
34698>>>>>  Procedure ReSyncClearAll
34700>>>>>       Boolean bOldReSync
34700>>>>>       Get pbInReSync to bOldReSync
34701>>>>>       // we need this to stop RememberLast and retains. We don't want those during a resyc clear 
34701>>>>>       Set pbInReSync to True
34702>>>>>       Send Clear_All
34703>>>>>       Set pbInReSync to bOldReSync
34704>>>>>  End_Procedure
34705>>>>>
34705>>>>>  // returns table name for error display. By default it returns the logical name
34705>>>>>  // can be augmented to return other information 
34705>>>>>  Function ErrorMessageTableName Integer iTable Returns String
34707>>>>>    String sTable
34707>>>>>    Get_Attribute DF_FILE_LOGICAL_NAME of iTable to sTable
34710>>>>>    Function_Return sTable
34711>>>>>  End_Function
34712>>>>>
34712>>>>>
34712>>>>>
34712>>>>>  //************************************************************************//
34712>>>>>  // Request_Save                                                           //
34712>>>>>  // Augmented to test updating connections.                                //
34712>>>>>  // If error report it.                                                    //
34712>>>>>  //************************************************************************//
34712>>>>>
34712>>>>>  Procedure Request_Save
34714>>>>>     Integer iRval
34714>>>>>     String sTable
34714>>>>>     If (OPERATION_MODE=MODE_WAITING) Begin
34716>>>>>         Send Update_Focus_Field_For_Operation MODE_SAVING // added in 12.1/15.1
34717>>>>>         Get Validate_Save_Structure False to iRval
34718>>>>>         If iRval Begin
34720>>>>>            Get ErrorMessageTableName iRval to sTable
34721>>>>>            Move (String(iRval) * "(" - sTable -")") to sTable
34722>>>>>            Send Data_Set_Error -1 DFERR_PROGRAM DD_INVALID_SAVE_STRUCTURE sTable
34723>>>>>            Procedure_Return
34724>>>>>         End
34724>>>>>>
34724>>>>>     End
34724>>>>>>
34724>>>>>     Forward Send Request_Save
34726>>>>>  End_Procedure // Request_Save
34727>>>>>
34727>>>>>  //************************************************************************//
34727>>>>>  // Request_Delete                                                         //
34727>>>>>  // Augmented to test updating connections.                                //
34727>>>>>  // If error report it.                                                    //
34727>>>>>  //************************************************************************//
34727>>>>>
34727>>>>>  Procedure Request_Delete
34729>>>>>     Integer iRval
34729>>>>>     String sTable
34729>>>>>     If (OPERATION_MODE=MODE_WAITING) Begin
34731>>>>>         Send Update_Focus_Field_For_Operation MODE_DELETING // added to 12.1/15.1
34732>>>>>         Get Validate_Delete_Structure False to iRval
34733>>>>>         If iRval Begin
34735>>>>>            Get ErrorMessageTableName iRval to sTable
34736>>>>>            Move (String(iRval) * "(" - sTable -")") to sTable
34737>>>>>            Send data_Set_Error -1 DFERR_PROGRAM DD_INVALID_DELETE_STRUCTURE sTable
34738>>>>>            Procedure_Return
34739>>>>>         End
34739>>>>>>
34739>>>>>     End            
34739>>>>>>
34739>>>>>     Forward Send Request_Delete
34741>>>>>  End_Procedure // Request_Delete
34742>>>>>
34742>>>>>  //************************************************************************//
34742>>>>>  //                    Status Help Support                                 //
34742>>>>>  //************************************************************************//
34742>>>>>
34742>>>>>  //************************************************************************//
34742>>>>>  // Set Status_Help                                                        //
34742>>>>>  // Set status-line help for the passed field. This could have been named  //
34742>>>>>  // Set Field_Status_Help but this keeps this message interface consistent //
34742>>>>>  // with the rest of DF for windows.                                       //
34742>>>>>  //************************************************************************//
34742>>>>>
34742>>>>>  Procedure Set Status_Help Integer iField string sVal
34744>>>>>     Set Value of (StatusHelp_Array(self)) iField to sVal
34745>>>>>  End_procedure
34746>>>>>
34746>>>>>  //************************************************************************//
34746>>>>>  // Get Status_Help                                                        //
34746>>>>>  // Get status-line help for the passed field. This could have been named  //
34746>>>>>  // Get Field_Status_Help but this keeps this message interface consistent //
34746>>>>>  // with the rest of DF for windows.                                       //
34746>>>>>  //************************************************************************//
34746>>>>>
34746>>>>>  Function Status_Help integer iField returns string
34748>>>>>     string sHelp
34748>>>>>     Integer iObj
34748>>>>>     Move (StatusHelp_Array(self)) to iObj
34749>>>>>     if (Item_Count(iObj)>iField) Begin
34751>>>>>        Get value of iObj iField to sHelp
34752>>>>>        if sHelp eq '0' move '' to shelp
34755>>>>>     end
34755>>>>>>
34755>>>>>     function_return shelp
34756>>>>>  End_Function // StatusHelp_Value
34757>>>>>
34757>>>>>  //************************************************************************//
34757>>>>>  // Get File_Field_status_Help                                             //
34757>>>>>  // Get status-line help for the passed file and field. This is called     //
34757>>>>>  // by DEOs (or any other object) that needs help for a particular file    //
34757>>>>>  // and field.                                                             //
34757>>>>>  //************************************************************************//
34757>>>>>
34757>>>>>  Function File_Field_Status_Help Integer iFile Integer iField returns string
34759>>>>>    integer iDSO
34759>>>>>    string sValue
34759>>>>>    Get Data_set iFile to iDSO
34760>>>>>    If iDSO ;      Get Status_Help of iDSO iField to sValue
34763>>>>>    Function_Return sValue
34764>>>>>  End_Function
34765>>>>>
34765>>>>>  //************************************************************************//
34765>>>>>  //                    Field Mask  Support                                 //
34765>>>>>  //************************************************************************//
34765>>>>>
34765>>>>>  //************************************************************************//
34765>>>>>  // Get/Set Field_Mask_Type                                                //
34765>>>>>  // Get     File_Field_Mask_Type                                           //
34765>>>>>  // Allows user to set a mask type. Legal value is any of the current mask //
34765>>>>>  // window types. 0 Means undefined.                                       //
34765>>>>>  //************************************************************************//
34765>>>>>
34765>>>>>  Procedure Set Field_Mask_Type Integer iField integer iType
34767>>>>>     Set Field_Mask_Type of (FieldMask_Array(Self)) iField to iType
34768>>>>>  End_procedure
34769>>>>>
34769>>>>>  Function Field_Mask_Type integer iField returns integer
34771>>>>>     Function_Return (Field_Mask_Type(FieldMask_Array(self),iField))
34772>>>>>  End_Function
34773>>>>>
34773>>>>>  Function File_Field_Mask_Type Integer iFile Integer iField returns integer
34775>>>>>    integer iDSO
34775>>>>>    Get Data_set iFile to iDSO
34776>>>>>    If iDSO ;      Function_Return (Field_Mask_Type(iDSO,iField))
34779>>>>>  End_Procedure
34780>>>>>
34780>>>>>  //************************************************************************//
34780>>>>>  // Get/Set Field_Mask_Value_State                                         //
34780>>>>>  // Get     File_Field_Mask_Value_state                                    //
34780>>>>>  // If TRUE the value returned by DEO will contain mask characters.        //
34780>>>>>  // Currently not supported.                                               //
34780>>>>>  //************************************************************************//
34780>>>>>
34780>>>>>  Procedure Set Field_Mask_Value_State Integer iField integer iState
34782>>>>>     Set Field_Mask_Value_State of (FieldMask_Array(Self)) iField to iState
34783>>>>>  End_procedure
34784>>>>>
34784>>>>>  Function Field_Mask_Value_State integer iField returns integer
34786>>>>>     Function_Return (Field_Mask_Value_State(FieldMask_Array(self),iField))
34787>>>>>  End_Function
34788>>>>>
34788>>>>>  Function File_Field_Mask_Value_State Integer iFile Integer iField returns integer
34790>>>>>    integer iDSO
34790>>>>>    Get Data_set iFile to iDSO
34791>>>>>    If iDSO ;      Function_Return (Field_Mask_Value_State(iDSO,iField))
34794>>>>>  End_Procedure
34795>>>>>
34795>>>>>  //************************************************************************//
34795>>>>>  // Get/Set Field_Mask                                                     //
34795>>>>>  // Get     File_Field_Mask                                                //
34795>>>>>  // Allows user to set a mask strinng. Legal value is any of the current   //
34795>>>>>  // masks. Note an empty string with a valid mask type implies that the    //
34795>>>>>  // system should figure it out by itself.                                 //
34795>>>>>  //************************************************************************//
34795>>>>>
34795>>>>>  Procedure Set Field_Mask Integer iField string sMask
34797>>>>>     Set Field_Mask of (FieldMask_Array(Self)) iField to sMask
34798>>>>>     If (Data_Set_User_Interface_Count(self)) ;          Send Field_Mask_Changed iField sMask
34801>>>>>  End_procedure
34802>>>>>
34802>>>>>  Function Field_Mask integer iField returns string
34804>>>>>     Function_Return (Field_Mask(FieldMask_Array(self),iField))
34805>>>>>  End_Function
34806>>>>>
34806>>>>>  Function File_Field_Mask Integer iFile Integer iField returns string
34808>>>>>    integer iDSO
34808>>>>>    string sValue
34808>>>>>    Get Data_set iFile to iDSO
34809>>>>>    If iDSO ;       Get Field_Mask of iDSO iField to sValue
34812>>>>>    Function_Return sValue
34813>>>>>  End_Function
34814>>>>>
34814>>>>>  //************************************************************************//
34814>>>>>  // Get/Set Field_Label_Short                                               //
34814>>>>>  // Get     File_Field_Label_Short                                          //
34814>>>>>  // Short for field. This is normally used by grid headers.                //
34814>>>>>  //************************************************************************//
34814>>>>>
34814>>>>>  Procedure Set Field_Label_Short Integer iField string sName
34816>>>>>     Set Field_Label_Short of (FieldMask_Array(Self)) iField to sName
34817>>>>>     If (Data_Set_User_Interface_Count(self)) ;          Send Field_Label_Changed iField 0 sName
34820>>>>>  End_procedure
34821>>>>>
34821>>>>>  Function Field_Label_Short integer iField returns string
34823>>>>>     Function_Return (Field_Label_Short(FieldMask_Array(self),iField))
34824>>>>>  End_Function
34825>>>>>
34825>>>>>  Function File_Field_Label_Short Integer iFile Integer iField returns string
34827>>>>>    integer iDSO
34827>>>>>    string sValue
34827>>>>>    Get Data_set iFile to iDSO
34828>>>>>    If iDSO ;       Get Field_Label_Short of iDSO iField to sValue
34831>>>>>    Function_Return sValue
34832>>>>>  End_Function
34833>>>>>
34833>>>>>  //************************************************************************//
34833>>>>>  // Get/Set Field_Label_Long                                                //
34833>>>>>  // Get     File_Field_Label_Long                                           //
34833>>>>>  // Full Name for field. This is normally used by form labels              //
34833>>>>>  //************************************************************************//
34833>>>>>
34833>>>>>  Procedure Set Field_Label_Long Integer iField string sName
34835>>>>>     Set Field_Label_Long of (FieldMask_Array(Self)) iField to sName
34836>>>>>     If (Data_Set_User_Interface_Count(self)) ;          Send Field_Label_Changed iField 1 sName
34839>>>>>  End_procedure
34840>>>>>
34840>>>>>  Function Field_Label_Long integer iField returns string
34842>>>>>     Function_Return (Field_Label_Long(FieldMask_Array(self),iField))
34843>>>>>  End_Function
34844>>>>>
34844>>>>>  Function File_Field_Label_Long Integer iFile Integer iField returns string
34846>>>>>    integer iDSO
34846>>>>>    string sValue
34846>>>>>    Get Data_set iFile to iDSO
34847>>>>>    If iDSO ;       Get Field_Label_Long of iDSO iField to sValue
34850>>>>>    Function_Return sValue
34851>>>>>  End_Function
34852>>>>>
34852>>>>>  //************************************************************************//
34852>>>>>  // Get Field_Label_Tag                                                     //
34852>>>>>  // This is not really a DD attribute (it is in the API) but it is         //
34852>>>>>  // appropriate to be accessed from the DD                                 //
34852>>>>>  //************************************************************************//
34852>>>>>
34852>>>>>  Function Field_Label_Tag integer iField returns string
34854>>>>>     String sName
34854>>>>>     Integer iFile
34854>>>>>     Get Main_File to iFile
34855>>>>>     If iFile ;        Get_Attribute DF_FIELD_NAME of iFile iField to sName
34860>>>>>     Function_Return sName
34861>>>>>  End_Function
34862>>>>>
34862>>>>>  function SmartCase string sName returns string
34864>>>>>    integer iPos iNewPos
34864>>>>>    string sRight
34864>>>>>    Move (Replaces("_",lowercase(sName)," ")) to sName
34865>>>>>    Trim (Replaces(".",sName," ")) to sName
34866>>>>>>
34866>>>>>    Move 1 to iPos
34867>>>>>    Repeat
34867>>>>>>
34867>>>>>        Move (mid(sName,255,iPos+1)) to sRight
34868>>>>>        Move (left(sName,iPos-1) + Uppercase(mid(sName,1,iPos)) + sRight) to sName
34869>>>>>        Pos " " in sRight to iNewPos
34871>>>>>>
34871>>>>>        If iNewPos eq 0 break
34874>>>>>        Add (iNewPos+1) to iPos
34875>>>>>    Loop
34876>>>>>>
34876>>>>>    Function_Return sName
34877>>>>>  end_function
34878>>>>>
34878>>>>>  Enumeration_List
34878>>>>>     Define DD_LABEL_SHORT
34878>>>>>     Define DD_LABEL_LONG
34878>>>>>     Define DD_LABEL_TAG
34878>>>>>  End_Enumeration_List
34878>>>>>
34878>>>>>  //************************************************************************//
34878>>>>>  // Get Field_Label                                                        //
34878>>>>>  // Get File_Field_Label                                                   //
34878>>>>>  // Handy function to get the label for a field. Three "types" are         //
34878>>>>>  // supported:                                                             //
34878>>>>>  // DD_LABEL_SHORT  use short, if none use long, if none use smart tag     //
34878>>>>>  // DD_LABEL_LONG   use long, if none use smart tag                        //
34878>>>>>  // DD_LABEL_TAG    use smart tag                                          //
34878>>>>>  // If you want an explicit field name use oneof the other messages.       //
34878>>>>>  //************************************************************************//
34878>>>>>
34878>>>>>  Function Field_Label Integer iField Integer iType returns string
34880>>>>>    Integer iServer
34880>>>>>    string sValue
34880>>>>>    If iType eq DD_LABEL_SHORT ;  // 0 = Short       Get Field_Label_Short iField to sValue
34883>>>>>    If (iType eq DD_LABEL_LONG OR (iType=DD_LABEL_SHORT and sValue='')) ;       Get Field_Label_Long iField to sValue
34886>>>>>    If (iType eq DD_LABEL_TAG OR sValue="") Begin
34888>>>>>       Get Field_Label_Tag iField to sValue
34889>>>>>       Get SmartCase sValue to sValue
34890>>>>>    End
34890>>>>>>
34890>>>>>    Function_Return sValue
34891>>>>>  End_Function // Field_Label
34892>>>>>
34892>>>>>  Function File_Field_Label Integer iFile Integer iField Integer iType returns string
34894>>>>>    integer iDSO
34894>>>>>    string sValue
34894>>>>>    Get Data_set iFile to iDSO
34895>>>>>    If iDSO ;       Get Field_Label of iDSO iField iType to sValue
34898>>>>>    Function_Return sValue
34899>>>>>  End_Function // File_Field_Label
34900>>>>>
34900>>>>>
34900>>>>>  //************************************************************************//
34900>>>>>  // Get/Set Field_Class_Name                                               //
34900>>>>>  // Normally this will not be used by a running program. However, it       //
34900>>>>>  // could be possible to create classes dynamically at runtime, in which   //
34900>>>>>  // case these messages could be useful. No File_Field is provided. If the //
34900>>>>>  // person knows enough to create dynamic classes they can find the DD.    //
34900>>>>>  //************************************************************************//
34900>>>>>
34900>>>>>  Procedure Set Field_Class_Name Integer iField string sName
34902>>>>>     Set Field_Class_Name of (FieldMask_Array(Self)) iField to sName
34903>>>>>  End_procedure
34904>>>>>
34904>>>>>  Function Field_Class_Name integer iField returns string
34906>>>>>     Function_Return (Field_Class_Name(FieldMask_Array(self),iField))
34907>>>>>  End_Function
34908>>>>>
34908>>>>>  //************************************************************************//
34908>>>>>  //                    Field and General Data-Set Error Support            //
34908>>>>>  //************************************************************************//
34908>>>>>
34908>>>>>  //************************************************************************//
34908>>>>>  // Set Field_Error                                                        //
34908>>>>>  // This procedure should be used to set a specific error number and       //
34908>>>>>  // message for a particular field. This can be used with the Field_error  //
34908>>>>>  // message to generate this error during a validation.                    //
34908>>>>>  //************************************************************************//
34908>>>>>
34908>>>>>  Procedure Set Field_Error Integer iField Integer iErr String sMsg
34910>>>>>    Set Field_Error of (Field_Attributes(self)) iField to iErr sMsg
34911>>>>>  End_Procedure
34912>>>>>
34912>>>>>  //************************************************************************//
34912>>>>>  // Get Field_error_Number                                                 //
34912>>>>>  // Get Field_error_Message                                                //
34912>>>>>  // Used to retreive the error number and message for a particular field   //
34912>>>>>  //************************************************************************//
34912>>>>>
34912>>>>>  Function Field_Error_Number Integer iField Returns Integer
34914>>>>>      Function_Return (Field_Error_Number(Field_Attributes(self),iField))
34915>>>>>  End_Function
34916>>>>>
34916>>>>>  Function Field_Error_Message Integer iField Returns String
34918>>>>>      Function_Return (Field_Error_Message(Field_Attributes(self),iField))
34919>>>>>  End_Function
34920>>>>>
34920>>>>>  //************************************************************************//
34920>>>>>  // Procedure Field_Error                                                  //
34920>>>>>  // This procedure is used to declare an error on a standard field         //
34920>>>>>  // validation violation like Range or Check.                              //
34920>>>>>  // Can pass 1 to 4 params:                                                //
34920>>>>>  // iField -                  Standard usage. Generates field as defined   //
34920>>>>>  //                           for this field. If field=-1, General error   //
34920>>>>>  // iField SDefault           If no field error mess (or field=-1) use     //
34920>>>>>  //                           the default message                          //
34920>>>>>  // iField sDefault sParam1 {sParam2} Replace occurances of @PARAM1 and    //
34920>>>>>  //                           @PARAM2 in text with these values            //
34920>>>>>  //************************************************************************//
34920>>>>>
34920>>>>>  Procedure Field_Error Integer iField String sDefault ;                        String sParam1 String sParam2
34922>>>>>     Integer iErr
34922>>>>>     String  sMess
34922>>>>>     If iField ge 0 Begin
34924>>>>>        Get Field_Error_Number  iField to iErr
34925>>>>>        Get Field_Error_Message iField to sMess
34926>>>>>     End
34926>>>>>>
34926>>>>>     If (sMess="" And Num_Arguments>1) ;        Move sDefault to sMess
34929>>>>>     If Num_Arguments eq 4 ;        Send Data_Set_Error iField iErr sMess sParam1 sParam2
34932>>>>>     else If Num_Arguments eq 3 ;        Send Data_Set_Error iField iErr sMess sParam1
34936>>>>>     Else ;        Send Data_Set_Error iField iErr sMess
34938>>>>>  End_procedure
34939>>>>>
34939>>>>>
34939>>>>>  //************************************************************************//
34939>>>>>  // Procedure Data_Set_Error                                               //
34939>>>>>  // This procedure is used to declare a data-set error. Pass error number  //
34939>>>>>  // and optional error message text.                                       //
34939>>>>>  // If iErr is 0, use the default error number.                            //
34939>>>>>  // sParam1 and sParam2 are optional. If passed they are used as text      //
34939>>>>>  // replacements for @PARAM1 and @PARAM2.                                  //
34939>>>>>  // We pass iField (even though we don't use it) so that augmentations     //
34939>>>>>  // could support error logging down to a field level. If a non-field error//
34939>>>>>  // is required the developer should pass negative values (e.g., -1)       //
34939>>>>>  // This will redirect errors locally if not already redirected            //
34939>>>>>  //                                                                        //
34939>>>>>  // Altered to additionally support %1 %2 replacements as well as          //
34939>>>>>  // replacements for @PARAM1 and @PARAM2. (vdf8.2)                         //
34939>>>>>  //************************************************************************//
34939>>>>>
34939>>>>>
34939>>>>>  Procedure Data_set_error Integer iField Integer iErr String sMess ;                           String sParam1 String sParam2
34941>>>>>    integer iOldField
34941>>>>>    Get Current_validate_field to iOldField
34942>>>>>    If iField ne 0 Set Current_Validate_field to iField
34945>>>>>
34945>>>>>    If iErr eq 0 ; // if no error is passes, used a default error       Move DD_DEFAULT_ERROR_NUMBER to iErr
34948>>>>>
34948>>>>>    If sMess GT "" Begin
34950>>>>>
34950>>>>>       // Support message replacements.. Up to two values
34950>>>>>       // altered to support @Param1/2 and %1 %2 messages
34950>>>>>       If (Num_Arguments>3) begin
34952>>>>>          Move (Replaces("@PARAM1", sMess, sParam1)) to sMess
34953>>>>>          If (Num_Arguments>4) begin
34955>>>>>              Move (Replaces("@PARAM2", sMess, sParam2)) to sMess
34956>>>>>              Move (SFormat(sMess,sParam1,sParam2)) to sMess
34957>>>>>          end
34957>>>>>>
34957>>>>>          else begin
34958>>>>>              Move (SFormat(sMess,sParam1)) to sMess
34959>>>>>          end
34959>>>>>>
34959>>>>>       end
34959>>>>>>
34959>>>>>       Move self to ghoErrorSource
34960>>>>>       Error iErr sMess
34961>>>>>>
34961>>>>>       Move 0 to ghoErrorSource
34962>>>>>    End
34962>>>>>>
34962>>>>>    Else ;      Send Operation_Not_Allowed iErr
34964>>>>>    Set Current_validate_field to iOldField
34965>>>>>    Move True to Err // make sure Err is still set
34966>>>>>  End_Procedure
34967>>>>>
34967>>>>>  //************************************************************************//
34967>>>>>  // Procedure Operation_not_allowed                                        //
34967>>>>>  // Augment to support Error_Report_Mode. Allows errors without error mess //
34967>>>>>  // This will redirect errors locally if not already redirected            //
34967>>>>>  //************************************************************************//
34967>>>>>
34967>>>>>  Procedure Operation_Not_Allowed integer iErr
34969>>>>>       integer bOK
34969>>>>>       Move self to ghoErrorSource
34970>>>>>       Forward Send Operation_Not_Allowed iErr
34972>>>>>       Move 0 to ghoErrorSource
34973>>>>>  End_Procedure
34974>>>>>
34974>>>>>  //************************************************************************//
34974>>>>>  // Procedure Error_report                                                 //
34974>>>>>  // Local error handler. When errors are redirected to the DD this proce-  //
34974>>>>>  // dure handles the errors. If error_report_mode is NO-report it sets     //
34974>>>>>  // the err indicator and returns. Else it redirects the error to the      //
34974>>>>>  // main error handler first moving its ID to ghoErrorSource. This way the //
34974>>>>>  // handler knows who sent this message and will get additional error info //
34974>>>>>  // by calling Get Extended_error_message                                  //
34974>>>>>  //************************************************************************//
34974>>>>>
34974>>>>>  Procedure Error_Report integer iError integer iLine string ErrMsg
34976>>>>>    integer hoErrId
34976>>>>>    integer bRedirect
34976>>>>>    If (Error_Processing_State(self)) ;  // this prevents recursion        Procedure_Return
34979>>>>>    Set Error_Processing_State to True
34980>>>>>
34980>>>>>    // if no report mode, just set the err indicator to true.
34980>>>>>    If (Error_Report_Mode(self)=DD_ERROR_NO_REPORT) ;        Indicate Err True
34983>>>>>    else begin
34984>>>>>        get Old_error_object_id to hoErrId  // the original error handler
34985>>>>>        If hoErrId Begin
34987>>>>>            Move (ghoErrorSource=0) to bRedirect
34988>>>>>            if bRedirect move self to ghoErrorSource // error handler can use this
34991>>>>>            move hoErrID to Error_object_id
34992>>>>>            Send Error_Report to hoErrId iError iLine ErrMsg
34993>>>>>            Move self to Error_object_id
34994>>>>>            if bRedirect move 0 to ghoErrorSource
34997>>>>>        end
34997>>>>>>
34997>>>>>        else send error_report of desktop iError iLine ErrMsg
34999>>>>>        //else forward send error_report iError iLine ErrMsg
34999>>>>>    end
34999>>>>>>
34999>>>>>    Set Error_Processing_State to False
35000>>>>>  End_Procedure
35001>>>>>
35001>>>>>  //************************************************************************//
35001>>>>>  // Function Extended_error_message                                        //
35001>>>>>  // This is called (by the system error handler) to get additional informa-//
35001>>>>>  // tion about the error. Returns a multi line string with each line       //
35001>>>>>  // separated by a "\n". Return the file number, name, and if possible     //
35001>>>>>  // the field number and name.                                             //
35001>>>>>  //************************************************************************//
35001>>>>>  
35001>>>>>  Function Extended_Error_Message returns string
35003>>>>>    string sExtMess
35003>>>>>    string sFile
35003>>>>>    integer iFile iField
35003>>>>>    Get main_file to iFile
35004>>>>>    Get Current_Validate_Field to iField
35005>>>>>    Get ErrorMessageTableName iFile to sFile
35006>>>>>    Move (DD_FILE_TEXT* string(iFile) * "-" * sFile) to sExtMess
35007>>>>>    If iField GT 0;       Append sExtMess "\n" ;            (DD_FIELD_TEXT* string(iField) * "-" * Field_Label(self,iField,DD_LABEL_LONG))
35011>>>>>    Set Current_Validate_Field to 0
35012>>>>>    function_return sExtMess
35013>>>>>  End_Function
35014>>>>>
35014>>>>>  Function Extended_Error_File Returns Integer
35016>>>>>    Function_Return (Main_File(self))
35017>>>>>  End_Function
35018>>>>>
35018>>>>>  Function Extended_Error_Field Returns Integer
35020>>>>>    Function_Return (Current_Validate_Field(self))
35021>>>>>  End_Function
35022>>>>>
35022>>>>>
35022>>>>>  //************************************************************************//
35022>>>>>  // The following messages are used to control smart file mode exception   //
35022>>>>>  // handling. The message "Send Add_system_File file# Fg" allows you to    //
35022>>>>>  // add system files (or any other files not known to the dso structure)   //
35022>>>>>  // within define_fields. This allows you to not have to augment the msg   //
35022>>>>>  // reset_filemodes_for_lock. The only truly public messages here are      //
35022>>>>>  // Add_system_file and Remove_system_File (which s/b rarely used).        //
35022>>>>>  //************************************************************************//
35022>>>>>
35022>>>>>  //************************************************************************//
35022>>>>>  // Procedure Add_System_File                                              //
35022>>>>>  // Adds a system file for smart_file_mode handling. A second optional     //
35022>>>>>  // parameter may be passed to determine of the sys file should only be    //
35022>>>>>  // locked during a new save (and not during a delete or a save of an      //
35022>>>>>  // existing record). It is expected that this will be the only public     //
35022>>>>>  // message used to control smart filemode. All of the remaining sys file  //
35022>>>>>  // messages are considered advanced.                                      //
35022>>>>>  //************************************************************************//
35022>>>>>
35022>>>>>  Procedure Add_System_File integer iFile integer iLock_Mode
35024>>>>>    integer iobj iCnt iMode
35024>>>>>    If Num_arguments eq 1 Move DD_Lock_on_All to iMode
35027>>>>>    Else                  Move iLock_Mode     to iMode
35029>>>>>    Move (system_file_obj(self)) to iObj
35030>>>>>    Get Item_Count  of iObj to iCnt
35031>>>>>    Set Array_Value of iObj iCnt to iFile
35032>>>>>    Increment iCnt
35033>>>>>    Set Array_Value of iObj iCnt to iMode
35034>>>>>  End_procedure
35035>>>>>
35035>>>>>  //************************************************************************//
35035>>>>>  // Function System_File_Count                                             //
35035>>>>>  // Return number of system files                                          //
35035>>>>>  //************************************************************************//
35035>>>>>
35035>>>>>  Function System_File_Count returns integer
35037>>>>>    Function_Return (Item_Count(System_File_Obj(self))/2)
35038>>>>>  End_Function // System_File_Count
35039>>>>>
35039>>>>>  //************************************************************************//
35039>>>>>  // Function System_File_Number                                            //
35039>>>>>  // Returns system file number for passed item.                            //
35039>>>>>  //************************************************************************//
35039>>>>>
35039>>>>>  Function System_File_Number Integer iItem returns Integer
35041>>>>>    Function_Return (Integer_Value(System_File_Obj(self),iItem*2))
35042>>>>>  End_Function
35043>>>>>
35043>>>>>  //************************************************************************//
35043>>>>>  // Function System_File_Lock_Mode                                         //
35043>>>>>  // Returns system flag to determine if file is only used during a new     //
35043>>>>>  // save (and not during an exiting save or a delete).                     //
35043>>>>>  //************************************************************************//
35043>>>>>
35043>>>>>  Function System_File_Lock_Mode integer iItem returns integer
35045>>>>>    Function_Return (Integer_Value(System_File_Obj(self),iItem*2+1))
35046>>>>>  End_Function
35047>>>>>
35047>>>>>  //************************************************************************//
35047>>>>>  // Procedure Remove_System_File                                           //
35047>>>>>  // Removes a system_file for smart_file_Mode handling. This remvoes the   //
35047>>>>>  // first occurance of the file (S/b the only occurance). We assume that   //
35047>>>>>  // this will be rarely used.                                              //
35047>>>>>  //************************************************************************//
35047>>>>>
35047>>>>>  Procedure Remove_System_File integer iFile
35049>>>>>    integer iobj iCnt iItmCnt
35049>>>>>    Get System_file_Count to iItmCnt
35050>>>>>    Decrement iItmCnt
35051>>>>>    For iCnt from 0 to iItmCnt
35057>>>>>>
35057>>>>>        If (System_File_Number(self,iCnt)=iFile) Begin
35059>>>>>           Move (system_file_obj(self)) to iObj
35060>>>>>           Move (iCnt*2) to iCnt
35061>>>>>           Send Delete_Item to iObj iCnt
35062>>>>>           Send Delete_Item to iObj iCnt
35063>>>>>           Procedure_Return
35064>>>>>        End
35064>>>>>>
35064>>>>>    Loop
35065>>>>>>
35065>>>>>  End_Procedure
35066>>>>>  
35066>>>>>  // These set messages, add_client_file, add_server_file and add_system_file 
35066>>>>>  // were added to more easily support visual DD class modeling. They do the
35066>>>>>  // same thing the Send counterpart messages do
35066>>>>>
35066>>>>>  Procedure Set Add_Client_File Integer iFile
35068>>>>>      Send Add_Client_File iFile
35069>>>>>  End_Procedure
35070>>>>>  
35070>>>>>  Procedure Set Add_Server_File Integer iFile
35072>>>>>      Send Add_Server_File iFile
35073>>>>>  End_Procedure
35074>>>>>
35074>>>>>  Procedure Set Add_System_File Integer iFile Integer iLock_Mode
35076>>>>>      // allow no arguments because the old message allowed this
35076>>>>>      If (Num_arguments=1) Begin
35078>>>>>          Send Add_System_File iFile
35079>>>>>      End
35079>>>>>>
35079>>>>>      Else Begin
35080>>>>>          Send Add_System_File iFile iLock_Mode
35081>>>>>      End
35081>>>>>>
35081>>>>>  End_Procedure
35082>>>>>  
35082>>>>>  // The Set Field_Auto_Increment method replaces the need to use the Define_Auto_Incrmement
35082>>>>>  // command. This models more easily and it supports multiple auto-increment fields
35082>>>>>  Procedure Set Field_Auto_Increment Integer iField Integer iSysFile Integer iSysField
35084>>>>>      Integer[] AutoIncFields
35085>>>>>      tDDFileField[] SysFileFields
35085>>>>>      tDDFileField[] SysFileFields
35086>>>>>      Integer iIndex
35086>>>>>
35086>>>>>      If (iField=0 or (iSysFile<>0 and iSysField=0)) Begin
35088>>>>>          Error DFERR_PROGRAM "Auto-increment source or destination field is 0"
35089>>>>>>
35089>>>>>          Procedure_Return
35090>>>>>      End
35090>>>>>>
35090>>>>>      // setting the sysfile to 0 is valid. It can be used to clear an existing sysfile       
35090>>>>>      If (iSysFile=0) Begin
35092>>>>>          Move 0 to iSysField
35093>>>>>      End
35093>>>>>>
35093>>>>>      Get pAutoIncrementFields to AutoIncFields
35094>>>>>      Get pAutoIncrementSysFileFields to SysFileFields
35095>>>>>      // the destination field array is a list of fields that have auto-incr info. There
35095>>>>>      // can only be zero or one entry per field arranged in no defined order.
35095>>>>>      // see if field is already defined. If not add this to the end.
35095>>>>>      Move (SearchArray(iField,AutoIncFields)) to iIndex
35096>>>>>      If (iIndex=-1) Begin
35098>>>>>          Move (SizeOfArray(SysFileFields)) to iIndex
35099>>>>>      End
35099>>>>>>
35099>>>>>      Move iField    to AutoIncFields[iIndex]      
35100>>>>>      Move iSysFile  to SysFileFields[iIndex].iFile
35101>>>>>      Move iSysField to SysFileFields[iIndex].iField
35102>>>>>      Set pAutoIncrementFields to AutoIncFields
35103>>>>>      Set pAutoIncrementSysFileFields to SysFileFields
35104>>>>>  End_Procedure
35105>>>>>  
35105>>>>>  // Get auto-increment system file/field value for a field. There really should be no
35105>>>>>  // reason to ever need this. Field is returned byref
35105>>>>>  Function Field_Auto_Increment Integer iField Integer ByRef iSysField Returns Integer 
35107>>>>>      Integer iSysFile
35107>>>>>      Integer[] AutoIncFields
35108>>>>>      tDDFileField[] SysFileFields
35108>>>>>      tDDFileField[] SysFileFields
35109>>>>>      Integer iIndex
35109>>>>>
35109>>>>>      Get pAutoIncrementFields to AutoIncFields
35110>>>>>      Move (SearchArray(iField,AutoIncFields)) to iIndex
35111>>>>>      If (iIndex>-1) Begin
35113>>>>>          Get pAutoIncrementSysFileFields to SysFileFields
35114>>>>>          Move SysFileFields[iIndex].iFile to iSysFile
35115>>>>>          Move SysFileFields[iIndex].iField to iSysField
35116>>>>>      End
35116>>>>>>
35116>>>>>      Else Begin
35117>>>>>          Move 0 to iSysFile
35118>>>>>          Move 0 to iSysField
35119>>>>>      End
35119>>>>>>
35119>>>>>      Function_Return iSysFile
35120>>>>>  End_Procedure
35121>>>>>  
35121>>>>>   
35121>>>>>
35121>>>>>  //************************************************************************//
35121>>>>>  // Procedure Reset_FileModes_for_Lock                                     //
35121>>>>>  // Augmented to set any system files defined via the Add_System_file      //
35121>>>>>  // message. This allows us to hide this procedure for the vast majority   //
35121>>>>>  // of cases.                                                              //
35121>>>>>  //************************************************************************//
35121>>>>>
35121>>>>>    Procedure Reset_Filemodes_For_Lock
35123>>>>>        Boolean bNewRec
35123>>>>>        Integer  iItmCnt iCnt iMode iFile
35123>>>>>        Integer iMain iMaster iOpts
35123>>>>>        Handle hoDD
35123>>>>>        
35123>>>>>        Forward Send Reset_Filemodes_for_lock
35125>>>>>        
35125>>>>>        Get System_File_Count to iItmCnt
35126>>>>>        If iItmCnt Begin
35128>>>>>            Move (not(HasRecord(Self))) to bNewRec
35129>>>>>            Decrement iItmCnt
35130>>>>>            For iCnt from 0 to iItmCnt
35136>>>>>>
35136>>>>>                Get System_File_Number         iCnt to iFile
35137>>>>>                Get System_File_Lock_Mode iCnt to iMode
35138>>>>>                If ( (iMode=DD_Lock_on_All) or ;                (Operation_Mode=MODE_DELETING and (iMode iand DD_Lock_on_Delete) ) or ;                (Operation_Mode=MODE_SAVING and ( (iMode iand DD_Lock_on_Save) or ;                ( (iMode iand DD_Lock_on_New_Save) and bNewRec) ) ) ) Begin
35140>>>>>                    Set_Attribute DF_FILE_MODE of iFile to DF_FILEMODE_DEFAULT
35143>>>>>                End
35143>>>>>>
35143>>>>>            Loop
35144>>>>>>
35144>>>>>        End
35144>>>>>>
35144>>>>>        
35144>>>>>        // augment to support DD magnaged alias tables.
35144>>>>>        // If an alias, set the alias to the proper alias no locks only if 
35144>>>>>        // the master file is actually part of this DDO structure. This allows you
35144>>>>>        // to use alias files without the master being present (or even open). This will work without needing
35144>>>>>        // to set the Master|Alias DF_FILE_ALIAS attributes. If the file is master and part of the DDO structure
35144>>>>>        // it will already have its No_locks attribute cleared. If not part of the DD, its not needed.
35144>>>>>        // 
35144>>>>>        Get MasterForAlias to iMaster
35145>>>>>        If iMaster Begin
35147>>>>>            Get Main_File to iMain
35148>>>>>            Get Data_Set iMaster to hoDD // is the master in the DD structure
35149>>>>>            If hoDD Begin
35151>>>>>                Get_Attribute DF_FILE_MODE of iMain to iOpts            
35154>>>>>                Set_Attribute DF_FILE_MODE of iMain to (iOpts ior DF_FILEMODE_NO_LOCKS)           
35157>>>>>                // note this will be reset to what it was when the transaction ends
35157>>>>>            End
35157>>>>>>
35157>>>>>        End
35157>>>>>>
35157>>>>>    
35157>>>>>    End_Procedure
35158>>>>>
35158>>>>>  //************************************************************************//
35158>>>>>  // Procedure AutoIncrement                                                //
35158>>>>>  // Augmented to handle auto-increment fields if defined. The value from   //
35158>>>>>  // the auto-incre sys file is incremented, saved and moved to the new     //
35158>>>>>  // record. As of 17.0 this is no longer in Creating, which is called after//
35158>>>>>  // AutoIncrement.                                                         //
35158>>>>>  //************************************************************************//
35158>>>>>
35158>>>>>  Procedure AutoIncrement
35160>>>>>    Integer iSrcFile iSrcField i iAutoFields
35160>>>>>    integer iDestFile iDestField
35160>>>>>    Number nNum
35160>>>>>    Integer[] AutoIncFields
35161>>>>>    tDDFileField[] AutoIncSysFileFields
35161>>>>>    tDDFileField[] AutoIncSysFileFields
35162>>>>>    Handle hoOwner
35162>>>>>    
35162>>>>>    Forward Send AutoIncrement
35164>>>>>
35164>>>>>    // this supports the older Define_Auto_Increment logic. Only one is supported
35164>>>>>    // this is exists for backwards compatibility
35164>>>>>    Get Auto_Increment_Source_File to iSrcFile
35165>>>>>    If iSrcFile Begin // do we have auto increment?
35167>>>>>       Get Auto_Increment_Source_Field  to iSrcField
35168>>>>>       Get Auto_Increment_Dest_Field    to iDestField
35169>>>>>       If (iSrcField AND iDestField) Begin  // just in case of error
35171>>>>>          Get Main_file to iDestFile
35172>>>>>          Get_Field_Value iSrcFile iSrcField to nNum
35175>>>>>          Move (nNum+1) to nNum
35176>>>>>          Set_Field_Value iSrcFile  iSrcField  to nNum
35179>>>>>          Set_Field_Value iDestFile iDestField to nNum
35182>>>>>          // if the file's DD is a parent file in the structure, this will get saved as part of normal operations
35182>>>>>          // if the DD is not a parent file, it is a sysfile and we must save it
35182>>>>>          Get Which_Data_Set iSrcFile to hoOwner
35183>>>>>          If not hoOwner Begin
35185>>>>>              SaveRecord iSrcFile
35186>>>>>          End
35186>>>>>>
35186>>>>>       End
35186>>>>>>
35186>>>>>    End
35186>>>>>>
35186>>>>>    // this supports the newer set syntax which support multiple fields. It is expected that you will
35186>>>>>    // use one syntax of the other, not both. If you use the old syntax, you cannot use the new one
35186>>>>>    Else Begin
35187>>>>>        Get pAutoIncrementFields to AutoIncFields
35188>>>>>        Move (SizeOfArray(AutoIncFields)) to iAutoFields
35189>>>>>        If (iAutoFields>0) Begin
35191>>>>>            Get pAutoIncrementSysFileFields to AutoIncSysFileFields
35192>>>>>            Get Main_file to iDestFile
35193>>>>>            For i from 0 to (iAutoFields-1)
35199>>>>>>
35199>>>>>               // it is legal to set the sysfile to 0, this means it has been cleared and is not used 
35199>>>>>               If (AutoIncSysFileFields[i].iFile>0) Begin
35201>>>>>                   // we assume both the fields are valid and that they've already been tested when added
35201>>>>>                   Get_Field_Value AutoIncSysFileFields[i].iFile AutoIncSysFileFields[i].iField to nNum
35204>>>>>                   Move (nNum+1) to nNum
35205>>>>>                   Set_Field_Value AutoIncSysFileFields[i].iFile AutoIncSysFileFields[i].iField to nNum
35208>>>>>                   Set_Field_Value iDestFile AutoIncFields[i] to nNum
35211>>>>>                   // if the file's DD is a parent file in the structure, this will get saved as part of normal operations
35211>>>>>                   // if the DD is not a parent file, it is a sysfile and we must save it
35211>>>>>                   Get Which_Data_Set AutoIncSysFileFields[i].iFile to hoOwner
35212>>>>>                   If not hoOwner Begin
35214>>>>>                       SaveRecord AutoIncSysFileFields[i].iFile
35215>>>>>                   End
35215>>>>>>
35215>>>>>               End
35215>>>>>>
35215>>>>>            Loop
35216>>>>>>
35216>>>>>        End
35216>>>>>>
35216>>>>>    End
35216>>>>>>
35216>>>>>
35216>>>>>  End_Procedure
35217>>>>>
35217>>>>> //************************************************************************//
35217>>>>>  // Procedure Save_main_File                                               //
35217>>>>>  // Augmented to fix a bug in the data-set C code. When a record is saved  //
35217>>>>>  // as part of a delete operation OnNewCurrentRecord is not called. It     //
35217>>>>>  // should be. We will do this in flex code for now.                       //
35217>>>>>  //************************************************************************//
35217>>>>>  Procedure Save_Main_File
35219>>>>>    RowID riRec
35219>>>>>    Integer iRec iMain
35219>>>>>    Boolean bRecnumTable bChanged
35219>>>>>
35219>>>>>    Get Main_File to iMain
35220>>>>>    Get_Attribute DF_FILE_CHANGED of iMain to bChanged
35223>>>>>    If bChanged Begin
35225>>>>>        Send OnSaveRecord // OnSaveRecord sent if there is something to save
35226>>>>>    End
35226>>>>>>
35226>>>>>
35226>>>>>    Forward Send Save_Main_File
35228>>>>>
35228>>>>>    If Operation_Mode eq MODE_DELETING Begin  // during a delete the crnt
35230>>>>>       Get CurrentRowId to riRec             // rec of parents do not change
35231>>>>>       Send OnNewCurrentRecord riRec riRec  // so old and new are the same.
35232>>>>>       // for backwards compatibility reasons, we also send new_current_record if appropriate
35232>>>>>       Get_Attribute DF_FILE_RECNUM_TABLE of iMain to bRecnumTable
35235>>>>>       If (bRecnumTable) Begin
35237>>>>>           Get_Field_Value iMain 0 to iRec
35240>>>>>           Send New_Current_Record iRec iRec
35241>>>>>       End
35241>>>>>>
35241>>>>>    End
35241>>>>>>
35241>>>>>  End_Procedure // Save_main_File
35242>>>>>
35242>>>>>
35242>>>>>  //************************************************************************//
35242>>>>>  // Procedure Clear_main_File                                               //
35242>>>>>  // Augmented to not clear if a system-file. The auto-latching of views    //
35242>>>>>  // may cause a sys file DD to get cleared. This corrects this. This really//
35242>>>>>  // belongs in Data_set (C) but we will not risk this for now.             //
35242>>>>>  //************************************************************************//
35242>>>>>
35242>>>>>  Procedure Clear_Main_File
35244>>>>>      Integer iFile iIsSys
35244>>>>>      Get Main_File to iFile
35245>>>>>      If iFile Begin
35247>>>>>         Get_Attribute DF_FILE_IS_SYSTEM_FILE of iFile to iIsSys
35250>>>>>         If iIsSys Procedure_Return
35253>>>>>      End
35253>>>>>>
35253>>>>>      Forward Send Clear_main_file
35255>>>>>  End_Procedure // Clear_main_file
35256>>>>>
35256>>>>>  //************************************************************************//
35256>>>>>  // Procedure Find Mode Index                                              //
35256>>>>>  // Executes a request_find on the mainfile. This is easier that having to //
35256>>>>>  // pass file number all the time. Useful for batch operations.            //
35256>>>>>  // If Index is 0, use find_by_recnum (it handles a recnum of 0 better)    //
35256>>>>>  //************************************************************************//
35256>>>>>
35256>>>>>  Procedure Find integer iMode integer iIndex
35258>>>>>     integer iFile
35258>>>>>     Integer iRec
35258>>>>>     get Main_file to iFile
35259>>>>>     if (iIndex<>0 OR iMode<>EQ) ;        Send request_find iMode iFile iIndex
35262>>>>>     else begin
35263>>>>>        // this would never happen with row ID
35263>>>>>        Get_Field_Value iFile 0 to iRec // get recnum value
35266>>>>>        Send find_by_recnum iFile iRec
35267>>>>>     end
35267>>>>>>
35267>>>>>  End_procedure
35268>>>>>
35268>>>>>  //************************************************************************//
35268>>>>>  // Procedure Request_Clear                                                //
35268>>>>>  // Procedure Request_Clear_All                                            //
35268>>>>>  // So many people make the mistake of using requeset_clear and request_   //
35268>>>>>  // clear_all that will support these are alteratives to clear and         //
35268>>>>>  // clear_all. The preferred messages remain Clear and Clear_all.          //
35268>>>>>  // This would not work if you nested DEOs within DSOs (no-one does).      //
35268>>>>>  //************************************************************************//
35268>>>>>
35268>>>>>  Procedure Request_Clear
35270>>>>>    Send Clear
35271>>>>>  End_Procedure
35272>>>>>
35272>>>>>  Procedure Request_Clear_All
35274>>>>>    Send Clear_All
35275>>>>>  End_Procedure
35276>>>>>
35276>>>>>  // *****************************************************//
35276>>>>>  // we want changed_state to always go through the
35276>>>>>  // Record_buffer object. From there it is sent to
35276>>>>>  // here. So if state or RB does not match we must
35276>>>>>  // send to the RB object...it will delegate to here
35276>>>>>  // *****************************************************//
35276>>>>>
35276>>>>>  Procedure set Changed_State Integer bState
35278>>>>>      integer hRB
35278>>>>>      Move (record_buffer(self)) to hRB
35279>>>>>      if (hRB AND changed_state(hRB)<>bState) ;          set changed_state of hRB to bState
35282>>>>>      else ;          forward set changed_state to bState
35285>>>>>  End_Procedure
35286>>>>>
35286>>>>>    // **********************************************//
35286>>>>>    // this lets us use the new attach logic
35286>>>>>    // **********************************************//
35286>>>>>
35286>>>>>    // This is a smarter attach than the normal attach command. It only attaches data from a parent
35286>>>>>    // if 1) the DDO parent is connected to the structure and 2) if there is a record to attach. It will
35286>>>>>    // not attach empty records into a child. This should make the finding (and saving) more sensible when
35286>>>>>    // partial DD structures are used. For example, often a report does not all of the parent DDOs - however if
35286>>>>>    // they are not provided, finding can get messed up because blank data is being moved into the child before a
35286>>>>>    // find. This has been a problem since 3.0. This should just make it go away.
35286>>>>>    // as of 17.0, we get the related field info through the local DSO if needed
35286>>>>>
35286>>>>>    // as if 18.1 this is only called when there is an attachable relationship. This gives us a chance to do any
35286>>>>>    // customizations and to cancel the attach. We've left this to the flex level so we can fine tune attaches.
35286>>>>>    Function ShouldFieldAttach Integer iField Handle hoRelDD Returns Boolean
35288>>>>>        Boolean bDoAttach bChanged
35288>>>>>        Integer iFile iStat iRelFile iType
35288>>>>>        String sValue
35288>>>>>         
35288>>>>>        Get Main_File to iFile
35289>>>>>        Get Main_File of hoRelDD to iRelFile
35290>>>>>        
35290>>>>>        // before we attach check if Find mode and relfile is new and unchanged..if so skip.
35290>>>>>        // If operation_mode is 0, this is probably a Find (item_find sends attach_main_file for some reason).
35290>>>>>        Move True to bDoAttach
35291>>>>>        If (Operation_mode=MODE_FINDING or OPERATION_MODE=0) Begin
35293>>>>>            // we can test the file status to see if we have a record or not. If we have a record, we attach
35293>>>>>            Get_Attribute DF_FILE_STATUS  of iRelFile to iStat
35296>>>>>            If (iStat=DF_FILE_INACTIVE) Begin
35298>>>>>                // if no record, we need to look for changes. We can't just look at the file's changed state because the DD
35298>>>>>                // may have set defaults, which have been moved to the buffer. We should be able to check the DD's changed state
35298>>>>>                // because this is not set with default values. When doing a find entry_update this should be ok. If this were
35298>>>>>                // a save, this would cause problems (but this is not a save). Prior to 17.0 this was not an issue with windows
35298>>>>>                // applications because find entry_updates were done at the DEO level (unlike web applications). 
35298>>>>>                Get Changed_State of hoRelDD to bChanged
35299>>>>>                Move bChanged to bDoAttach
35300>>>>>                
35300>>>>>                // special Triumph workaround for Item_Find with blank inner segment. They were counting on the item_find attach_main_file
35300>>>>>                // which would slip through the "no-attach on find when parent is empty optimization". This was needed to force a string segment
35300>>>>>                // that was "" to get filled with spaces from the parent field. The child field was set to "" because of a constrained_clear
35300>>>>>                // in Item_find. This workaround is as narrow as possible. If an item_find attach_main_file (operation_mode=0) and this is
35300>>>>>                // an empty parent (bOk was just set to False), and the field is DF_Ascii and the child value is empty (no trailing spaces)
35300>>>>>                // then force an attach. Since the parent should be "", we can just Set_Field_value to "", which fills the field buffer.
35300>>>>>                // There is no real logic as to why this is being done other than to make it work like it used to with the least
35300>>>>>                // amount of side-effects.
35300>>>>>                If (not(bDoAttach) and OPERATION_MODE=0) Begin
35302>>>>>                    Get_Attribute DF_FIELD_TYPE of iFile iField to iType
35305>>>>>                    If (iType=DF_ASCII) Begin
35307>>>>>                        Get_Field_Value iFile iField to sValue
35310>>>>>                        // if no spaces, this probably was cleared via constrained_clear in Item_Find. We should update
35310>>>>>                        If (Ascii(Left(sValue,1))=0) Begin 
35312>>>>>                            Set_Field_Value iFile iField to ""
35315>>>>>                        End
35315>>>>>>
35315>>>>>                    End
35315>>>>>>
35315>>>>>                End
35315>>>>>>
35315>>>>>                
35315>>>>>            End
35315>>>>>>
35315>>>>>        End
35315>>>>>>
35315>>>>>        Function_Return bDoAttach       
35316>>>>>    End_Function
35317>>>>>
35317>>>>>    //************************************************************************//
35317>>>>>    // Procedure Field_Mask_Changed                                           //
35317>>>>>    // Notify all DEOs that a mask has changed.                               //
35317>>>>>    //        this message is sent by set Field_Mask                          //
35317>>>>>    //************************************************************************//
35317>>>>>
35317>>>>>    Procedure Field_Mask_Changed Integer iField string sMask
35319>>>>>        Integer i iDEOs iDEO
35319>>>>>        Integer iMain_File
35319>>>>>        Get Main_File to iMain_File
35320>>>>>        Get Data_Set_User_Interface_Count to iDEOs
35321>>>>>        Decrement iDEOs
35322>>>>>        For i from 0 to iDEOs
35328>>>>>>
35328>>>>>            Get Data_Set_User_Interface i to iDEO
35329>>>>>            If (Extended_DEO_State(iDEO)) ;                Send File_Field_Mask_Changed to iDEO ;                    iMain_File iField sMask
35332>>>>>        Loop
35333>>>>>>
35333>>>>>    End_Procedure
35334>>>>>
35334>>>>>    //************************************************************************//
35334>>>>>    // Procedure Field_Label_Changed                                          //
35334>>>>>    // Notify all DEOs that a label has changed.                              //
35334>>>>>    //   This message is sent by Set Field_Label_long & Field_Label_Short     //
35334>>>>>    //************************************************************************//
35334>>>>>
35334>>>>>    Procedure Field_label_Changed Integer iField boolean bLong string sLabel
35336>>>>>        Integer i iDEOs iDEO
35336>>>>>        Integer iMain_File
35336>>>>>        Get Main_File to iMain_File
35337>>>>>        Get Data_Set_User_Interface_Count to iDEOs
35338>>>>>        Decrement iDEOs
35339>>>>>        For i from 0 to iDEOs
35345>>>>>>
35345>>>>>            Get Data_Set_User_Interface i to iDEO
35346>>>>>            If (Extended_DEO_State(iDEO)) ;                Send File_Field_Label_Changed to iDEO ;                    iMain_File iField bLong sLabel
35349>>>>>        Loop
35350>>>>>>
35350>>>>>    End_Procedure
35351>>>>>
35351>>>>>    //************************************************************************//
35351>>>>>    // Procedure Field_Options_Changed                                        //
35351>>>>>    // Notify all DEOs that a field option has changed.                       //
35351>>>>>    //   This message is sent by Set Field_Option                             //
35351>>>>>    //************************************************************************//
35351>>>>>
35351>>>>>    Procedure Field_Option_Changed Integer iField Integer iOptions Boolean bClear
35353>>>>>        Integer i iDEOs iDEO
35353>>>>>        Integer iMain_File
35353>>>>>        Get Main_File to iMain_File
35354>>>>>        Get Data_Set_User_Interface_Count to iDEOs
35355>>>>>        Decrement iDEOs
35356>>>>>        For i from 0 to iDEOs
35362>>>>>>
35362>>>>>            Get Data_Set_User_Interface i to iDEO
35363>>>>>            If (Extended_DEO_State(iDEO)) ;                Send File_Field_Option_Changed of iDEO ;                       iMain_File iField iOptions bClear
35366>>>>>        Loop
35367>>>>>>
35367>>>>>    End_Procedure
35368>>>>>
35368>>>>>
35368>>>>>    //************************************************************************//
35368>>>>>    // Procedure Set Field_option and File_Field_Option                       //
35368>>>>>    // Procedure Set Field_option_clear and File_Field_Option_Clear           //
35368>>>>>    // Procedure Set Field_option_toggle and File_Field_Option_toggle         //
35368>>>>>    //                                                                        //
35368>>>>>    //   Set, clear or toggle a field option                                  //
35368>>>>>    //   Multiple options can be passed as an expression                      //
35368>>>>>    //   (e.g. Set Field_option 2 (dd_Retain IOR dd_NoEnter).                 //
35368>>>>>    //   Unlike set Field_options this notifies DEOs of changes               //
35368>>>>>    //************************************************************************//
35368>>>>>
35368>>>>>    // supports setting and clearing. e.g.:
35368>>>>>    //    Set Field_Option Field Customer.Name DD_NoEnter to True
35368>>>>>    // This new syntax is now the recommended syntax but the older syntax without
35368>>>>>    // the last parameter is supported (where true is the default). The old syntax is
35368>>>>>    // only supported for compatibility. This means that Field_Option_Clear should 
35368>>>>>    // also be replaced with Field_Option
35368>>>>>    Procedure Set Field_Option Integer iField Integer iOption Boolean bSet
35370>>>>>        Boolean bSetTrue
35370>>>>>        Move (If(num_arguments>2, bSet, True)) to bSetTrue // support for old deprecated syntax
35371>>>>>        If bSetTrue Begin
35373>>>>>            Set Field_options iField to iOption
35374>>>>>        End
35374>>>>>>
35374>>>>>        Else Begin
35375>>>>>            Set Field_options iField to DD_CLEAR_FIELD_OPTIONS iOption
35376>>>>>        End
35376>>>>>>
35376>>>>>        If (Data_Set_User_Interface_Count(Self)) Begin
35378>>>>>            Send Field_Option_Changed iField iOption (not(bSetTrue))
35379>>>>>        End
35379>>>>>>
35379>>>>>    end_procedure
35380>>>>>
35380>>>>>    Procedure Set File_Field_Option Integer iFile Integer iField Integer iOption Boolean bSet
35382>>>>>        handle hoDD
35382>>>>>        Boolean bSetTrue
35382>>>>>        Move (If(num_arguments>3, bSet, True)) to bSetTrue // support for old deprecated syntax
35383>>>>>        Get Data_set iFile to hoDD
35384>>>>>        If hoDD Begin
35386>>>>>            Set Field_Option of hoDD iField iOption to bSetTrue
35387>>>>>        End
35387>>>>>>
35387>>>>>            
35387>>>>>    end_procedure
35388>>>>>
35388>>>>>    Procedure Set Field_Option_Clear Integer iField Integer iOptions
35390>>>>>        Set Field_Option iField iOptions to False
35391>>>>>        //Set Field_options iField to DD_CLEAR_FIELD_OPTIONS iOptions
35391>>>>>        //If (Data_Set_User_Interface_Count(self)) ;
35391>>>>>        //    Send Field_Option_Changed iField iOptions 1
35391>>>>>    end_procedure
35392>>>>>
35392>>>>>    Procedure Set File_Field_Option_Clear Integer iFile Integer iField Integer iOptions
35394>>>>>        Set File_Field_Option iFile iField iOptions to False
35395>>>>>        //handle hoDD
35395>>>>>        //Get Data_set iFile to hoDD
35395>>>>>        //If hoDD ;
35395>>>>>        //    Set Field_Option_Clear of hoDD iField to iOptions
35395>>>>>    end_procedure
35396>>>>>
35396>>>>>    Procedure Set Field_Option_Toggle integer iField Integer iOption
35398>>>>>        Integer iOldOption
35398>>>>>        Get Field_Options iField to iOldOption
35399>>>>>        // if old and new have overlapping bits, we assume clear
35399>>>>>        Set Field_Option iField iOption to ((iOldOption iand iOption)=0)
35400>>>>>        //If (iOldOption IAND iOption) ; // if the old and new have overlapping bits, we assume we will clear
35400>>>>>        //    Set Field_Option_Clear iField to iOption  // old and new are same, so we clear
35400>>>>>        //else ;
35400>>>>>        //    Set Field_Option iField to iOption        // old and new are not same, so we set
35400>>>>>    end_procedure
35401>>>>>
35401>>>>>    Procedure Set File_Field_Option_Toggle Integer iFile Integer iField Integer iOption
35403>>>>>        handle hoDD
35403>>>>>        Get Data_set iFile to hoDD
35404>>>>>        If hoDD ;            Set Field_Option_Toggle of hoDD iField to iOption
35407>>>>>    end_procedure
35408>>>>>
35408>>>>>    // Field_Index
35408>>>>>    // File_Field_Index
35408>>>>>    //
35408>>>>>    // This returns the main index for a field. This replaces the DSO message Field_Main_index which
35408>>>>>    // should no longer be used by DDOs. The old message has the problem that the DDO or DSO using
35408>>>>>    // this message may not be the owner of the field. So augmenting the owner DDO did not insure that
35408>>>>>    // all requests for this index would go through it. Now you can augment Field_Index and always
35408>>>>>    // be sure that any DDO requesting an index for a file (via file_field_index) will always go to
35408>>>>>    // the owner object.
35408>>>>>
35408>>>>>    function Field_Index integer iField returns integer
35410>>>>>        integer iFile iIndex iOrder
35410>>>>>        // ordering takes precendence
35410>>>>>        get ordering to iOrder
35411>>>>>        if (iOrder>=0);            move iOrder to iIndex  //ordering takes precedence over main index
35414>>>>>        Else Begin
35415>>>>>            Get Main_file to iFile
35416>>>>>            get_attribute DF_FIELD_INDEX of iFile iField to iIndex // main index field
35419>>>>>            if (iIndex=0 AND iField>0) ; // If field is not recnum and there is no index, the                move -1 to iIndex        // field has no main index
35422>>>>>        end
35422>>>>>>
35422>>>>>        function_return iIndex
35423>>>>>    end_function
35424>>>>>
35424>>>>>    // In all cases, this message should be sent instead of Field_Main_Index. If
35424>>>>>    // augmentation was used in Field_Main_Index, use Field_Index to insure the owner object
35424>>>>>    // is called.
35424>>>>>
35424>>>>>    function File_Field_Index integer iFile integer iField returns integer
35426>>>>>        integer iIndex
35426>>>>>        handle hoDD
35426>>>>>        Get Data_set iFile to hoDD
35427>>>>>        If (hoDD) ;            Get Field_Index of hoDD iField to iIndex
35430>>>>>        else ;            Move -1 to iIndex
35432>>>>>        function_return iIndex
35433>>>>>    End_Function
35434>>>>>    
35434>>>>>    // 12/1 change: Make sure all of the major DD operations update the DD with the value in
35434>>>>>    // the focus field. After the actual find, save, clar or delete, the DD buffer contains information that
35434>>>>>    // is not yet reflected in the DEOs (before refresh is called) we want to make sure that we
35434>>>>>    // don't try to get data from the DEO. Get Field_Current_Value now checks if operation_mode is
35434>>>>>    // non-zero. If it is, it always gets from the DD buffer.
35434>>>>>    
35434>>>>>    Procedure Clear
35436>>>>>         Boolean bOpOk
35436>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35437>>>>>         If (OPERATION_MODE=MODE_WAITING) Begin
35439>>>>>            Send Update_Focus_Field_For_Operation MODE_CLEARING
35440>>>>>         End
35440>>>>>>
35440>>>>>         If (bOpOk) Begin
35442>>>>>            Send OnPreFind DDFindClear
35443>>>>>         End
35443>>>>>>
35443>>>>>         Forward Send Clear
35445>>>>>         If (bOpOk) Begin
35447>>>>>            Send DefaultParentAutofinds
35448>>>>>            Send OnPostFind DDFindClear True
35449>>>>>         End
35449>>>>>>
35449>>>>>    End_Procedure
35450>>>>>    
35450>>>>>    Procedure Clear_All
35452>>>>>         Boolean bOpOk
35452>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35453>>>>>         If (OPERATION_MODE=MODE_WAITING) Begin
35455>>>>>            Send Update_Focus_Field_For_Operation MODE_CLEARINGALL
35456>>>>>         End
35456>>>>>>
35456>>>>>         Forward Send clear_all
35458>>>>>         If (bOpOk) Begin
35460>>>>>            Send DefaultParentAutofinds
35461>>>>>         End
35461>>>>>>
35461>>>>>     End_Procedure
35462>>>>>    
35462>>>>>    Procedure Request_Assign Integer iFile
35464>>>>>        Handle hoDD
35464>>>>>        Boolean bFound
35464>>>>>        Boolean bOpOk
35464>>>>>        Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35465>>>>>        If (OPERATION_MODE=MODE_WAITING) Begin
35467>>>>>            Send Update_Focus_Field_For_Operation MODE_FINDING
35468>>>>>        End
35468>>>>>>
35468>>>>>            
35468>>>>>        If (bOpOk) Begin
35470>>>>>            If (num_arguments=0 or iFile=0) Begin
35472>>>>>                Move Self to hoDD
35473>>>>>            End
35473>>>>>>
35473>>>>>            Else Begin
35474>>>>>                Get Data_Set iFile to hoDD
35475>>>>>            End
35475>>>>>>
35475>>>>>            If hoDD Begin
35477>>>>>                Send OnPreFind of hoDD DDFindRequestAssign
35478>>>>>            End
35478>>>>>>
35478>>>>>        End
35478>>>>>>
35478>>>>>        
35478>>>>>        If (num_arguments=0) Begin
35480>>>>>            Forward Send Request_Assign
35482>>>>>        End
35482>>>>>>
35482>>>>>        Else Begin
35483>>>>>            Forward Send Request_Assign iFile
35485>>>>>        End
35485>>>>>>
35485>>>>>        
35485>>>>>        If (bOpOk) Begin
35487>>>>>            If (hoDD) Begin
35489>>>>>                Move (Found) to bFound
35490>>>>>                Send OnPostFind of hoDD DDFindRequestAssign bFound 
35491>>>>>                Move bFound to Found
35492>>>>>            End
35492>>>>>>
35492>>>>>        End
35492>>>>>>
35492>>>>>    End_Procedure
35493>>>>>    
35493>>>>>    
35493>>>>>    Procedure Find_By_Recnum Integer iFile Integer iRecord
35495>>>>>         Handle hoDD
35495>>>>>         Boolean bFound
35495>>>>>         Boolean bOpOk
35495>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35496>>>>>         Send Update_Focus_Field_For_Operation MODE_FINDING
35497>>>>>            
35497>>>>>        If (bOpOk) Begin
35499>>>>>            Get Data_Set iFile to hoDD
35500>>>>>            If hoDD Begin
35502>>>>>                Send OnPreFind of hoDD DDFindFindByRowRec
35503>>>>>            End
35503>>>>>>
35503>>>>>        End
35503>>>>>>
35503>>>>>            
35503>>>>>        Forward Send Find_By_Recnum iFile iRecord
35505>>>>>            
35505>>>>>        If (bOpOk) Begin
35507>>>>>            If (hoDD) Begin
35509>>>>>                Move (Found) to bFound
35510>>>>>                Send OnPostFind of hoDD DDFindFindByRowRec bFound 
35511>>>>>                Move bFound to Found
35512>>>>>            End
35512>>>>>>
35512>>>>>        End
35512>>>>>>
35512>>>>>    End_Procedure
35513>>>>>
35513>>>>>    Procedure FindByRowId Integer iFile RowID riRowId
35515>>>>>         Handle hoDD
35515>>>>>         Boolean bFound
35515>>>>>         Boolean bOpOk
35515>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35516>>>>>         Send Update_Focus_Field_For_Operation MODE_FINDING
35517>>>>>            
35517>>>>>        If (bOpOk) Begin
35519>>>>>            Get Data_Set iFile to hoDD
35520>>>>>            If hoDD Begin
35522>>>>>                Send OnPreFind of hoDD DDFindFindByRowRec
35523>>>>>            End
35523>>>>>>
35523>>>>>        End
35523>>>>>>
35523>>>>>            
35523>>>>>        Forward Send FindByRowId iFile riRowId
35525>>>>>            
35525>>>>>        If (bOpOk) Begin
35527>>>>>            If (hoDD) Begin
35529>>>>>                Move (Found) to bFound
35530>>>>>                Send OnPostFind of hoDD DDFindFindByRowRec bFound 
35531>>>>>                Move bFound to Found
35532>>>>>            End
35532>>>>>>
35532>>>>>        End
35532>>>>>>
35532>>>>>    End_Procedure
35533>>>>>
35533>>>>>    Function FindByRowIdEx Integer iFile RowID riRowId Returns Boolean
35535>>>>>         Handle hoDD
35535>>>>>         Boolean bFound bSuccess
35535>>>>>         Boolean bOpOk
35535>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35536>>>>>         Send Update_Focus_Field_For_Operation MODE_FINDING
35537>>>>>            
35537>>>>>        If (bOpOk) Begin
35539>>>>>            Get Data_Set iFile to hoDD
35540>>>>>            If hoDD Begin
35542>>>>>                Send OnPreFind of hoDD DDFindFindByRowRec
35543>>>>>            End
35543>>>>>>
35543>>>>>        End
35543>>>>>>
35543>>>>>            
35543>>>>>        Forward Get FindByRowIdEx iFile riRowId to bSuccess
35545>>>>>            
35545>>>>>        If (bOpOk) Begin
35547>>>>>            If (hoDD) Begin
35549>>>>>                Move (Found) to bFound
35550>>>>>                Send OnPostFind of hoDD DDFindFindByRowRec bFound 
35551>>>>>                Move bFound to Found
35552>>>>>            End
35552>>>>>>
35552>>>>>        End
35552>>>>>>
35552>>>>>        Function_Return bSuccess
35553>>>>>    End_Function
35554>>>>>
35554>>>>>    Function FindByRowIdExNoAutoFill Integer iFile RowID riRowId Returns Boolean
35556>>>>>         Handle hoDD
35556>>>>>         Boolean bFound bSuccess
35556>>>>>         Boolean bOpOk
35556>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35557>>>>>         Send Update_Focus_Field_For_Operation MODE_FINDING
35558>>>>>            
35558>>>>>        If (bOpOk) Begin
35560>>>>>            Get Data_Set iFile to hoDD
35561>>>>>            If hoDD Begin
35563>>>>>                Send OnPreFind of hoDD DDFindFindByRowRec
35564>>>>>            End
35564>>>>>>
35564>>>>>        End
35564>>>>>>
35564>>>>>            
35564>>>>>        Forward Get FindByRowIdExNoAutoFill iFile riRowId to bSuccess
35566>>>>>            
35566>>>>>        If (bOpOk) Begin
35568>>>>>            If (hoDD) Begin
35570>>>>>                Move (Found) to bFound
35571>>>>>                Send OnPostFind of hoDD DDFindFindByRowRec bFound 
35572>>>>>                Move bFound to Found
35573>>>>>            End
35573>>>>>>
35573>>>>>        End
35573>>>>>>
35573>>>>>        Function_Return bSuccess
35574>>>>>    End_Function
35575>>>>>
35575>>>>>    
35575>>>>>    Procedure Request_Find Integer eFindMode Integer iFile Integer iIndex
35577>>>>>         Handle hoDD
35577>>>>>         Boolean bFound
35577>>>>>         Boolean bOpOk
35577>>>>>         Move (OPERATION_MODE=MODE_WAITING or OPERATION_MODE=MODE_VALIDATING) to bOpOk
35578>>>>>         If (OPERATION_MODE=MODE_WAITING) Begin
35580>>>>>            Send Update_Focus_Field_For_Operation MODE_FINDING
35581>>>>>         End
35581>>>>>>
35581>>>>>            
35581>>>>>         If (bOpOk) Begin
35583>>>>>            Get Data_Set iFile to hoDD
35584>>>>>            If hoDD Begin
35586>>>>>                Send OnPreFind of hoDD DDFindRequestFind
35587>>>>>            End
35587>>>>>>
35587>>>>>         End
35587>>>>>>
35587>>>>>            
35587>>>>>         Forward Send Request_Find eFindMode iFile iIndex
35589>>>>>            
35589>>>>>         If (bOpOk) Begin
35591>>>>>            If (hoDD) Begin
35593>>>>>                Move (Found) to bFound
35594>>>>>                Send OnPostFind of hoDD DDFindRequestFind bFound 
35595>>>>>                Move bFound to Found
35596>>>>>            End
35596>>>>>>
35596>>>>>         End
35596>>>>>>
35596>>>>>    End_Procedure
35597>>>>>    
35597>>>>>    Procedure OnPreFind Integer eMessage
35599>>>>>    End_procedure
35600>>>>>    
35600>>>>>    Procedure OnPostFind Integer eMessage Boolean bFound
35602>>>>>    End_Procedure
35603>>>>>
35603>>>>>    
35603>>>>>    
35603>>>>>    Procedure Request_Superfind Integer eFindMode Integer iFile Integer iField
35605>>>>>         Boolean bInSuperFind
35605>>>>>         // we need to set pbInSuperFind so Entry_update in the DEOs will know that
35605>>>>>         // they should perform an entry_update. Superfind entry_updates have never gone through
35605>>>>>         // the DD's field buffer.
35605>>>>>         Get pbInSuperFind to bInSuperFind
35606>>>>>         Set pbInSuperFind to True
35607>>>>>         If (OPERATION_MODE=MODE_WAITING) Begin
35609>>>>>            Send Update_Focus_Field_For_Operation MODE_FINDING
35610>>>>>         End
35610>>>>>>
35610>>>>>         Forward Send Request_Superfind eFindMode iFile iField
35612>>>>>         Set pbInSuperFind to bInSuperFind
35613>>>>>    End_Procedure
35614>>>>>    
35614>>>>>    // Augmented to return true if a non-constrained parent DD has a change. This way
35614>>>>>    // Should_Save_row only filters changes in a consrained parent.
35614>>>>>
35614>>>>>    Function Should_Save_Row Returns Boolean
35616>>>>>        Boolean bShouldSaveRow bShouldSave bRelatesToConstraint
35616>>>>>        Integer iServers iServer iServerFile
35616>>>>>        Handle hoServerDD
35616>>>>>        Forward Get Should_Save_Row to bShouldSaveRow // will be true if this DD is changed or has a changed parent.
35618>>>>>        Get Should_Save to bShouldSave // will be true if there is a change anywhere up the entire save structure
35619>>>>>        If (not(bShouldSaveRow) and bShouldSave) Begin
35621>>>>>            // If here we have a changed in an server but not the this DD. We need a further refinement. If the server
35621>>>>>            // change is in a constrained server, we don't consider this a change because you can switch rows without losing
35621>>>>>            // data (with RT changes made for 17.0).
35621>>>>>            Get Data_Set_Server_Count to iServers
35622>>>>>            For iServer from 0 to (iServers-1)
35628>>>>>>
35628>>>>>                Get Data_Set_Server iServer to hoServerDD
35629>>>>>                Get Should_Save of hoServerDD to bShouldSave
35630>>>>>                If bShouldSave Begin
35632>>>>>                    Get Main_File of hoServerDD to iServerFile
35633>>>>>                    Get IsRelatesToConstrained iServerFile to bRelatesToConstraint
35634>>>>>                    If not bRelatesToConstraint Begin
35636>>>>>                        Function_Return True
35637>>>>>                    End
35637>>>>>>
35637>>>>>                End
35637>>>>>>
35637>>>>>            Loop
35638>>>>>>
35638>>>>>        End
35638>>>>>>
35638>>>>>        Function_Return bShouldSaveRow
35639>>>>>    End_Function
35640>>>>>
35640>>>>>    // returns true if any relates-to constraining server needs a save. Normally there will be
35640>>>>>    // one or zero related-to parents. If Should_Save_Row returns false it is possible that there
35640>>>>>    // is a change up the relates-to constrained branch. If so, this will return True. This can be
35640>>>>>    // used to better determine the changed status of your DDO sructure
35640>>>>>    Function ShouldSaveConstrainedToServer Returns Boolean
35642>>>>>        Boolean bShouldSave bRelatesToConstraint
35642>>>>>        Integer iServers iServer iServerFile
35642>>>>>        Handle hoServerDD
35642>>>>>        Get Data_Set_Server_Count to iServers
35643>>>>>        For iServer from 0 to (iServers-1)
35649>>>>>>
35649>>>>>            Get Data_Set_Server iServer to hoServerDD
35650>>>>>            Get Main_File of hoServerDD to iServerFile
35651>>>>>            Get IsRelatesToConstrained iServerFile to bRelatesToConstraint
35652>>>>>            If bRelatesToConstraint Begin
35654>>>>>                Get Should_Save of hoServerDD to bShouldSave
35655>>>>>                If bShouldSave Begin
35657>>>>>                    Function_Return True
35658>>>>>                End
35658>>>>>>
35658>>>>>            End
35658>>>>>>
35658>>>>>        Loop
35659>>>>>>
35659>>>>>        Function_Return False
35660>>>>>    End_Function
35661>>>>>    
35661>>>>>    Function FindServerInformationElement Integer iFile Returns Integer         
35663>>>>>        tDDServerInformation[] ServerInformation
35663>>>>>        tDDServerInformation[] ServerInformation
35664>>>>>        tDDServerInformation ServerSearch
35664>>>>>        tDDServerInformation ServerSearch
35664>>>>>        Integer iIndex
35664>>>>>        Move iFile to ServerSearch.iParent
35665>>>>>        Get pServerInformation to ServerInformation
35666>>>>>        Function_Return (SearchArray(ServerSearch,ServerInformation))
35667>>>>>//        For iIndex from 0 to (SizeOfArray(ServerInformation)-1)
35667>>>>>//            If (iFile=ServerInformation[iIndex].iParent) Begin
35667>>>>>//                Function_Return iIndex
35667>>>>>//            End
35667>>>>>//        Loop
35667>>>>>//        Function_Return -1
35667>>>>>    End_Function
35668>>>>>    
35668>>>>>    Procedure AddServerData Integer iFile Integer eParam Boolean bValue
35670>>>>>        tDDServerInformation[] ServerInformation
35670>>>>>        tDDServerInformation[] ServerInformation
35671>>>>>        Integer iIndex
35671>>>>>        Handle hoDDO
35671>>>>>        
35671>>>>>        Get pServerInformation to ServerInformation
35672>>>>>        Get FindServerInformationElement iFile to iIndex
35673>>>>>        If (iIndex=-1) Begin
35675>>>>>            Move (SizeOfArray(ServerInformation)) to iIndex
35676>>>>>            Move iFile to ServerInformation[iIndex].iParent
35677>>>>>            // defaults must always be false!
35677>>>>>            Move False to ServerInformation[iIndex].bParentNoSwitchIfCommitted
35678>>>>>            Move False to ServerInformation[iIndex].bAllowNullParent
35679>>>>>            Move False to ServerInformation[iIndex].bNoCascadeDelete
35680>>>>>            Move False to ServerInformation[iIndex].bCascadeDeleteNullTheParent
35681>>>>>        End
35681>>>>>>
35681>>>>>        
35681>>>>>        If (eParam=0) Begin
35683>>>>>            If (bValue<>ServerInformation[iIndex].bAllowNullParent) Begin
35685>>>>>                Move bValue to ServerInformation[iIndex].bAllowNullParent
35686>>>>>                Send AdjustDeleteValidateStructure iFile
35687>>>>>            End
35687>>>>>>
35687>>>>>        End
35687>>>>>>
35687>>>>>        Else If (eParam=1) Begin
35690>>>>>            Move bValue to ServerInformation[iIndex].bParentNoSwitchIfCommitted
35691>>>>>        End
35691>>>>>>
35691>>>>>        Else If (eParam=2) Begin
35694>>>>>            Move bValue to ServerInformation[iIndex].bNoCascadeDelete
35695>>>>>        End
35695>>>>>>
35695>>>>>        Else Begin // (3)
35696>>>>>            If (bValue<>ServerInformation[iIndex].bCascadeDeleteNullTheParent) Begin
35698>>>>>                Move bValue to ServerInformation[iIndex].bCascadeDeleteNullTheParent
35699>>>>>                Send AdjustDeleteValidateStructure iFile
35700>>>>>            End
35700>>>>>>
35700>>>>>        End
35700>>>>>>
35700>>>>>        Set pServerInformation to ServerInformation
35701>>>>>    End_Procedure
35702>>>>>    
35702>>>>>    Function GetServerData Integer iFile Integer eParam Returns Boolean
35704>>>>>        Boolean bValue
35704>>>>>        tDDServerInformation[] ServerInformation
35704>>>>>        tDDServerInformation[] ServerInformation
35705>>>>>        Integer iIndex
35705>>>>>        Get pServerInformation to ServerInformation
35706>>>>>        Get FindServerInformationElement iFile to iIndex
35707>>>>>        // when not found in array, we want to make sure that we return false. Therefore
35707>>>>>        // false should always be the default. 
35707>>>>>        If (iIndex<>-1) Begin
35709>>>>>            If (eParam=0) Begin
35711>>>>>                Move ServerInformation[iIndex].bAllowNullParent to bValue
35712>>>>>            End
35712>>>>>>
35712>>>>>            Else If (eParam=1) Begin
35715>>>>>                Move ServerInformation[iIndex].bParentNoSwitchIfCommitted to bValue
35716>>>>>            End
35716>>>>>>
35716>>>>>            Else If (eParam=2) Begin
35719>>>>>                Move ServerInformation[iIndex].bNoCascadeDelete to bValue
35720>>>>>            End
35720>>>>>>
35720>>>>>            Else Begin
35721>>>>>                Move ServerInformation[iIndex].bCascadeDeleteNullTheParent to bValue
35722>>>>>            End
35722>>>>>>
35722>>>>>        End
35722>>>>>>
35722>>>>>        Function_Return bValue
35723>>>>>    End_Function
35724>>>>>    
35724>>>>>    Procedure AdjustDeleteValidateStructure2
35726>>>>>        Integer iCount i
35726>>>>>        Handle hoDDO
35726>>>>>        Boolean bVisited
35726>>>>>        Set Visited_State to True
35727>>>>>        Set Cascade_Delete_Structure_Validated_State to False
35728>>>>>        Get Data_Set_Server_Count to iCount
35729>>>>>        For i from 0 to (iCount-1)
35735>>>>>>
35735>>>>>            Get Data_Set_Server i to hoDDO
35736>>>>>            Get Visited_State of hoDDO to bVisited
35737>>>>>            If (not(bVisited)) Begin
35739>>>>>                Send AdjustDeleteValidateStructure2 of hoDDO
35740>>>>>            End
35740>>>>>>
35740>>>>>        Loop
35741>>>>>>
35741>>>>>    End_Procedure
35742>>>>>    
35742>>>>>    // This is called in the unlikely case that NullParent/CascadeNull are set dynamically. It
35742>>>>>    // tells the parent DDO to recheck its validate-delete structure and it tells all ancestors of
35742>>>>>    // this parent to do the same. If called while DDOs are being created (via a class setting) there
35742>>>>>    // will not be a connected parent for iFile, which is fine.
35742>>>>>    Procedure AdjustDeleteValidateStructure Integer iFile
35744>>>>>        Handle hoDDO
35744>>>>>        Get Which_Data_Set iFile to hoDDO
35745>>>>>        If hoDDO Begin
35747>>>>>            Send Initialize_Visited of hoDDO False False
35748>>>>>            Send AdjustDeleteValidateStructure2 of hoDDO 
35749>>>>>        End
35749>>>>>>
35749>>>>>    End_Procedure
35750>>>>>    
35750>>>>>    // Used to add a null parent to the list of parents that allow this
35750>>>>>    Procedure Set ParentNullAllowed Integer iParent Boolean bAllowed
35752>>>>>        Send AddServerData iParent 0 bAllowed    
35753>>>>>    End_Procedure
35754>>>>>    
35754>>>>>    // returns true if null parent allowed for this parent file
35754>>>>>    Function ParentNullAllowed Integer iParent Returns Boolean
35756>>>>>        Boolean bValue
35756>>>>>        Get GetServerData iParent 0 to bValue
35757>>>>>        Function_Return bValue
35758>>>>>    End_Function
35759>>>>>
35759>>>>>    // returns true if null parent allowed for this parent file. This is the function
35759>>>>>    // that can be used for augmentation. This is the methid that is called by the runtime
35759>>>>>    // to determine if a null parent is allowed
35759>>>>>    Function IsNullParentAllowed Integer iServer Returns Boolean
35761>>>>>        Boolean bAllowed
35761>>>>>        Get ParentNullAllowed iServer to bAllowed
35762>>>>>        Function_Return bAllowed
35763>>>>>    End_Function
35764>>>>>
35764>>>>>    Procedure Set ParentNoSwitchIfCommitted Integer iParent Boolean bAllowed
35766>>>>>        Send AddServerData iParent 1 bAllowed    
35767>>>>>    End_Procedure
35768>>>>>
35768>>>>>    Function ParentNoSwitchIfCommitted Integer iParent Returns Boolean
35770>>>>>        Boolean bValue
35770>>>>>        Get GetServerData iParent 1 to bValue
35771>>>>>        Function_Return bValue
35772>>>>>    End_Function
35773>>>>>
35773>>>>>
35773>>>>>    Procedure Set CascadeDeleteAllowed Integer iParent Boolean bAllowed
35775>>>>>        Send AddServerData iParent 2 (not(bAllowed))    
35776>>>>>    End_Procedure
35777>>>>>
35777>>>>>    Function CascadeDeleteAllowed Integer iParent Returns Boolean
35779>>>>>        Boolean bValue
35779>>>>>        Get GetServerData iParent 2 to bValue // note that False=allowed
35780>>>>>        Function_Return (not(bValue))
35781>>>>>    End_Function
35782>>>>>
35782>>>>>    Function IsCascadeDeleteAllowed Integer iServer Returns Boolean
35784>>>>>        Boolean bAllowed
35784>>>>>        Get CascadeDeleteAllowed iServer to bAllowed
35785>>>>>        Function_Return bAllowed
35786>>>>>    End_Function
35787>>>>>
35787>>>>>    Procedure Set CascadeDeleteNull Integer iParent Boolean bAllowed
35789>>>>>        Send AddServerData iParent 3 bAllowed    
35790>>>>>    End_Procedure
35791>>>>>
35791>>>>>    Function CascadeDeleteNull Integer iParent Returns Boolean
35793>>>>>        Boolean bValue
35793>>>>>        Get GetServerData iParent 3 to bValue
35794>>>>>        Function_Return bValue
35795>>>>>    End_Function
35796>>>>>
35796>>>>>    Function IsCascadeDeleteNull Integer iServer Returns Boolean
35798>>>>>        Boolean bAllowed
35798>>>>>        Get CascadeDeleteNull iServer to bAllowed
35799>>>>>        Function_Return bAllowed
35800>>>>>    End_Function
35801>>>>>
35801>>>>>    // return an array with the server path from this DD to passed top. The top will be
35801>>>>>    // in 0 and its child in 1, grand-child in 2, etc. If empty, no path was found. To start
35801>>>>>    // this process the byref hoDDs array MUST be empty
35801>>>>>    Procedure DDOServerPath Handle hoTop Handle[] ByRef hoDDs
35803>>>>>        Handle hoServer
35803>>>>>        Integer iServers iServer
35803>>>>>        If (hoTop=Self) Begin
35805>>>>>            Move Self to hoDDs[SizeOfArray(hoDDs)]
35806>>>>>            Procedure_Return
35807>>>>>        End
35807>>>>>>
35807>>>>>        Get Data_Set_Server_Count to iServers
35808>>>>>        For iServer from 0 to (iServers-1)
35814>>>>>>
35814>>>>>            Get Data_Set_Server iServer to hoServer
35815>>>>>            Send DDOServerPath of hoServer hoTop (&hoDDs)
35816>>>>>            If (SizeOfArray(hoDDs)) Begin
35818>>>>>                Move Self to hoDDs[SizeOfArray(hoDDs)]
35819>>>>>                Procedure_Return
35820>>>>>            End
35820>>>>>>
35820>>>>>        Loop
35821>>>>>>
35821>>>>>    End_Procedure
35822>>>>>    
35822>>>>>    // returns True if the value passed can be considered empty for this field.
35822>>>>>    Function IsEmptyField Integer iField String sValue Returns Boolean
35824>>>>>        Integer iFile iDataType iValidationType
35824>>>>>        Number nNum
35824>>>>>        Boolean bInvalid bChecked
35824>>>>>        Get Main_File to iFile
35825>>>>>        Get_Attribute DF_FIELD_TYPE of iFile iField to iDataType
35828>>>>>        Get IsDataInvalid iDataType sValue to bInvalid
35829>>>>>        If bInvalid Begin
35831>>>>>            Function_Return True
35832>>>>>        End
35832>>>>>>
35832>>>>>        
35832>>>>>        // DDs set checkbox fields to the False value as default. We must test its select_state
35832>>>>>        Get Field_Validation_Type of (Field_Attributes(Self)) iField to iValidationType
35833>>>>>        If (iValidationType=FA_VALIDATION_TYPE_CHECKBOX) Begin
35835>>>>>            Get Field_Select_State iField to bChecked
35836>>>>>            If not bChecked Begin
35838>>>>>                Function_Return True
35839>>>>>            End
35839>>>>>>
35839>>>>>        End
35839>>>>>>
35839>>>>>        
35839>>>>>        If ((iDataType=DF_BCD or iDataType=DF_DATE) and (Number(sValue)=0)) Begin
35841>>>>>             Move "" to sValue
35842>>>>>        End
35842>>>>>>
35842>>>>>        Else If (iDataType=DF_DATETIME and IsNullDateTime(cast(sValue,DateTime))) Begin
35845>>>>>             Move "" to sValue
35846>>>>>        End
35846>>>>>>
35846>>>>>        Function_Return (sValue="")
35847>>>>>    End_Function
35848>>>>>    
35848>>>>>
35848>>>>>    // is the record committed
35848>>>>>    Function IsCommitted Returns Boolean
35850>>>>>        Boolean bHasRecord
35850>>>>>        Get HasRecord to bHasRecord
35851>>>>>        Function_Return bHasRecord
35852>>>>>    End_Function
35853>>>>>    
35853>>>>>    // is the field committed. It assumes the record is already committed
35853>>>>>    Function IsFieldCommitted Integer iField Returns Boolean
35855>>>>>        Boolean bIsCommitted
35855>>>>>        Get Field_Option iField DD_COMMIT to bIsCommitted
35856>>>>>        Function_Return bIsCommitted
35857>>>>>    End_Function
35858>>>>>    
35858>>>>>    // is a parent change allowed for this parent server.
35858>>>>>    Function IsCommittedParentChangeAllowed Integer iServer Returns Boolean
35860>>>>>        Boolean bNoSwitch
35860>>>>>        Get ParentNoSwitchIfCommitted iServer to bNoSwitch
35861>>>>>        Function_Return (not(bNoSwitch))
35862>>>>>    End_Function
35863>>>>>    
35863>>>>>    // Are we allowed to find with this file when it is used as a parent?
35863>>>>>    // Check all child DDOs and see if any are committed and do not allow switching parents when committed.
35863>>>>>    //  The rules for each child are switching is ok If:
35863>>>>>    // 1. the child is not committed,
35863>>>>>    // 2. it has a relates-to constraint (Find will change child which is ok)
35863>>>>>    // 3. if IsCommittedParentChangeAllowed allowed.
35863>>>>>    //
35863>>>>>    Function AllowParentFind Returns Boolean
35865>>>>>        Integer iClients iClient iMain
35865>>>>>        Handle hoChild     
35865>>>>>        Boolean bIsCommitted   
35865>>>>>        Get Data_Set_Client_Count to iClients
35866>>>>>        For iClient from 0 to (iClients-1)
35872>>>>>>
35872>>>>>            Get Data_Set_Client iClient to hoChild
35873>>>>>            Get IsCommitted of hoChild to bIsCommitted
35874>>>>>            If bIsCommitted Begin
35876>>>>>                Get Main_File to iMain
35877>>>>>                Get IsRelatesToConstrained of hoChild iMain to bIsCommitted
35878>>>>>                If not bIsCommitted Begin
35880>>>>>                    Get IsCommittedParentChangeAllowed of hoChild iMain to bIsCommitted
35881>>>>>                    If (not(bIsCommitted)) Begin
35883>>>>>                       Function_Return False
35884>>>>>                    End
35884>>>>>>
35884>>>>>                End
35884>>>>>>
35884>>>>>            End
35884>>>>>>
35884>>>>>        End
35885>>>>>>
35885>>>>>        Function_Return True
35886>>>>>    End_Function
35887>>>>>    
35887>>>>>    // aumgented to do nothing if there is no index (instead of annoying error message) and
35887>>>>>    // to do nothing if a find is not allowed because it is a no switch parent of a committed child.
35887>>>>>    Procedure Item_Find Integer eFindMode ;            Integer iFile Integer iField ;            Integer bDoEntryUpdate Integer bShowFindErr Integer bDeferred
35889>>>>>    
35889>>>>>        Integer iIndex iMain
35889>>>>>        Handle  hoOwner
35889>>>>>        Boolean bOk
35889>>>>>        
35889>>>>>        Get File_Field_Index iFile iField to iIndex
35890>>>>>        If (iIndex=-1)  Begin
35892>>>>>            Procedure_Return
35893>>>>>        End
35893>>>>>>
35893>>>>>        Get Main_File to iMain
35894>>>>>        If (iMain<>iFile) Begin
35896>>>>>            Get Which_Data_Set iFile to hoOwner
35897>>>>>            If hoOwner Begin
35899>>>>>                Get AllowParentFind of hoOwner to bOk
35900>>>>>                If not bOk Begin
35902>>>>>                    Procedure_Return
35903>>>>>                End
35903>>>>>>
35903>>>>>            End
35903>>>>>>
35903>>>>>        End
35903>>>>>>
35903>>>>>        
35903>>>>>        If not bDeferred Begin
35905>>>>>            Send Refind_Records // make sure the buffers are correct before the find
35906>>>>>        End
35906>>>>>>
35906>>>>>        
35906>>>>>        Forward Send Item_Find eFindMode iFile iField bDoEntryUpdate bShowFindErr bDeferred
35908>>>>>    End_Procedure
35909>>>>>    
35909>>>>>    
35909>>>>>    Function Field_CommitNoEnterOnIndex Integer iField Returns Boolean
35911>>>>>        Function_Return False
35912>>>>>    End_Function
35913>>>>>    
35913>>>>>    // Return the committed options for this field based on the committed status or this record,
35913>>>>>    // the committed status of the field and whether, if committed, it should be noput or noput+noenter
35913>>>>>    Function File_Field_Committed_Options Integer iFile Integer iField Returns Integer
35915>>>>>        Boolean bIsCommitted bNoEnter
35915>>>>>        Integer iNewOpts iIndex
35915>>>>>        Handle hoOwner
35915>>>>>        
35915>>>>>        Get Which_Data_Set iFile to hoOwner
35916>>>>>        If not hoOwner Function_Return 0
35919>>>>>        
35919>>>>>        Get File_Field_Index iFile iField to iIndex
35920>>>>>        Get IsCommitted of hoOwner iField to bIsCommitted
35921>>>>>        If bIsCommitted Begin
35923>>>>>            Get IsFieldCommitted of hoOwner iField to bIsCommitted
35924>>>>>            If bIsCommitted Begin
35926>>>>>                Move True to bNoEnter
35927>>>>>                If (iIndex<>-1) Begin
35929>>>>>                    Get Field_CommitNoEnterOnIndex iField to bNoEnter
35930>>>>>                End
35930>>>>>>
35930>>>>>                // if committed, it is noput and, if non-indexed, also noenter
35930>>>>>                Move (If(bNoEnter,DD_DISPLAYONLY,DD_NOPUT)) to iNewOpts
35931>>>>>            End
35931>>>>>>
35931>>>>>        End
35931>>>>>>
35931>>>>>        // if a finding parent field, we want to know if you are allowed to switch parents as we will assume
35931>>>>>        // that this field is used for finding.        
35931>>>>>        If (hoOwner<>Self and iIndex>-1) Begin
35933>>>>>            Get AllowParentFind of hoOwner to bIsCommitted
35934>>>>>            If not bIsCommitted Begin
35936>>>>>               Move DD_DISPLAYONLY to iNewOpts
35937>>>>>            End
35937>>>>>>
35937>>>>>        End
35937>>>>>>
35937>>>>>    
35937>>>>>        Function_Return iNewOpts
35938>>>>>    End_Function
35939>>>>>    
35939>>>>>    // Returns the current field-field options based on regular options, foreign field status
35939>>>>>    // plus committed record status
35939>>>>>    Function File_Field_DynamicEntryOptions Integer iFile Integer iField Returns Integer
35941>>>>>        Integer iCOpts iFOpts
35941>>>>>        If (iFile=0) Begin
35943>>>>>            Function_Return 0
35944>>>>>        End
35944>>>>>>
35944>>>>>        Get File_Field_Options iFile iField to iFOpts            // regular options (handles regular and foreign)
35945>>>>>        Get File_Field_Committed_Options iFile iField to iCOpts  // possible NoPut, NoEnter additions
35946>>>>>        Function_Return (iFOpts ior iCOpts)
35947>>>>>    End_Function
35948>>>>>    
35948>>>>>    Function DDRememberedFieldIndex Integer iField Returns Integer
35950>>>>>        tDDRemembered[] DefaultValues
35950>>>>>        tDDRemembered[] DefaultValues
35951>>>>>        tDDRemembered SearchItem
35951>>>>>        tDDRemembered SearchItem
35951>>>>>        Integer iIndex
35951>>>>>        Get pDDDefaults to DefaultValues
35952>>>>>        Move iField to SearchItem.iField
35953>>>>>        Move (SearchArray(SearchItem,DefaultValues)) to iIndex
35954>>>>>        Function_Return iIndex
35955>>>>>    End_Function
35956>>>>>    
35956>>>>>    // Interface used to set or clear a dynamic default (remembered) value for a DD field. If the
35956>>>>>    // value passed is empty ("" or as empty as defined by the data-type) it is cleared. If the value
35956>>>>>    // is DD_RememberLast, it will use the last value before a clear as the default, else it uses the
35956>>>>>    // passed value as the default
35956>>>>>    Procedure Set Field_RememberedValue Integer iField String sValue
35958>>>>>        tDDRemembered[] DefaultValues
35958>>>>>        tDDRemembered[] DefaultValues
35959>>>>>        Integer iIndex
35959>>>>>        Boolean bNull 
35959>>>>>        Get DDRememberedFieldIndex iField to iIndex
35960>>>>>        Get pDDDefaults to DefaultValues
35961>>>>>        If (sValue<>DD_RememberLast) Begin // if it is rememberlast, we know it is not null
35963>>>>>            Get IsEmptyField iField sValue to bNull
35964>>>>>        End
35964>>>>>>
35964>>>>>        If (not(bNull)) Begin
35966>>>>>            If (iIndex=-1) Begin
35968>>>>>                Move (SizeOfArray(DefaultValues)) to iIndex
35969>>>>>                Move iField to DefaultValues[iIndex].iField
35970>>>>>            End
35970>>>>>>
35970>>>>>            Move sValue to DefaultValues[iIndex].sDefault
35971>>>>>            Set pDDDefaults to DefaultValues
35972>>>>>        End
35972>>>>>>
35972>>>>>        Else If  (iIndex<>-1) Begin
35975>>>>>            Set pDDDefaults to (RemoveFromArray(DefaultValues,iIndex))
35976>>>>>        End
35976>>>>>>
35976>>>>>    End_Procedure
35977>>>>>    
35977>>>>>    // get the remembered value as per rules above
35977>>>>>    Function Field_RememberedValue Integer iField Returns String
35979>>>>>        tDDRemembered[] DefaultValues
35979>>>>>        tDDRemembered[] DefaultValues
35980>>>>>        Integer iIndex
35980>>>>>        Get DDRememberedFieldIndex iField to iIndex
35981>>>>>        If (iIndex<>-1) Begin
35983>>>>>            Get pDDDefaults to DefaultValues
35984>>>>>            Function_Return DefaultValues[iIndex].sDefault
35985>>>>>        End
35985>>>>>>
35985>>>>>        Function_Return ''
35986>>>>>    End_Function
35987>>>>>    
35987>>>>>    Procedure AssignDynamicDefaults
35989>>>>>        Integer iField iFields iFile
35989>>>>>        tDDRemembered[] DefaultValues
35989>>>>>        tDDRemembered[] DefaultValues
35990>>>>>        Boolean bMain
35990>>>>>        String sValue
35990>>>>>        
35990>>>>>        Get Main_File to iFile
35991>>>>>        Get pDDDefaults to DefaultValues
35992>>>>>        Move (SizeOfArray(DefaultValues)) to iFields
35993>>>>>        For iField from 0 to (iFields-1)
35999>>>>>>
35999>>>>>            If ( DefaultValues[iField].sDefault<>"") Begin
36001>>>>>               If (DefaultValues[iField].sDefault=DD_RememberLast) Begin
36003>>>>>                    Move DefaultValues[iField].sLastValue to sValue                 
36004>>>>>               End
36004>>>>>>
36004>>>>>               Else Begin
36005>>>>>                    Move DefaultValues[iField].sDefault to sValue                 
36006>>>>>               End
36006>>>>>>
36006>>>>>               Set Field_Changed_Value DefaultValues[iField].iField to sValue
36007>>>>>            End
36007>>>>>>
36007>>>>>        Loop
36008>>>>>>
36008>>>>>    End_Procedure
36009>>>>>    
36009>>>>>    // Clears all remembered defaults for this DD.
36009>>>>>    Procedure ClearRememberedDefaults
36011>>>>>        tDDRemembered[] DefaultValues
36011>>>>>        tDDRemembered[] DefaultValues
36012>>>>>        Set pDDDefaults to DefaultValues
36013>>>>>    End_Procedure
36014>>>>>
36014>>>>>    Procedure PrivateClearAllRememberedDefaults
36016>>>>>        Integer iCount iMax
36016>>>>>        Handle hoDD
36016>>>>>        Boolean bVisisted
36016>>>>>        
36016>>>>>        Set Visited_State to True
36017>>>>>        
36017>>>>>        Get Data_Set_Server_Count to iMax
36018>>>>>        Decrement iMax
36019>>>>>        For iCount from 0 to iMax
36025>>>>>>
36025>>>>>            Get Data_Set_Server iCount to hoDD
36026>>>>>            Get Visited_State of hoDD to bVisisted
36027>>>>>            If not (bVisisted) Begin
36029>>>>>                Send PrivateClearAllRememberedDefaults of hoDD
36030>>>>>            End
36030>>>>>>
36030>>>>>        Loop
36031>>>>>>
36031>>>>>        
36031>>>>>        Send ClearRememberedDefaults
36032>>>>>        
36032>>>>>        Get Data_Set_Client_Count to iMax
36033>>>>>        Decrement iMax
36034>>>>>        For iCount from 0 to iMax
36040>>>>>>
36040>>>>>            Get Data_Set_Client iCount to hoDD
36041>>>>>            Get Visited_State of hoDD to bVisisted
36042>>>>>            If not (bVisisted) Begin
36044>>>>>                Send PrivateClearAllRememberedDefaults of hoDD
36045>>>>>        End
36045>>>>>>
36045>>>>>        Loop
36046>>>>>>
36046>>>>>    
36046>>>>>    End_Procedure 
36047>>>>>
36047>>>>>    // Clears all remembered defaults for all DDs in this structure.
36047>>>>>    Procedure ClearAllRememberedDefaults
36049>>>>>        Send InitializeAllVisited
36050>>>>>        Send PrivateClearAllRememberedDefaults
36051>>>>>    End_Function
36052>>>>>    
36052>>>>>    // This is called after a clear or clear all is sent to this DD. It does autofinds as needed
36052>>>>>    // for any parent DDs. It does this if the parent is not a relates to contraining parent, if
36052>>>>>    // a field has an index, it has a changed value and it is autofind or autofind_ge.
36052>>>>>    Procedure DefaultParentAutofinds
36054>>>>>        Integer i iServers iField iFields iFile iIndex iOpts
36054>>>>>        Boolean bDoAutoFind bRelates bIsEmptyField
36054>>>>>        String sValue
36054>>>>>        Handle hoServer
36054>>>>>        Get Data_Set_Server_Count to iServers
36055>>>>>        For i from 0 to (iServers-1)
36061>>>>>>
36061>>>>>            Get Data_Set_Server i to hoServer
36062>>>>>            Get Main_File of hoServer to iFile
36063>>>>>            Get IsRelatesToConstrained iFile to bRelates
36064>>>>>            // never autofind on a relates-to constraining parent
36064>>>>>            If not (bRelates) Begin
36066>>>>>
36066>>>>>                Get Field_Count of hoServer to iFields
36067>>>>>                Move False to bDoAutoFind
36068>>>>>                Move 1 to iField
36069>>>>>                While (not(bDoAutoFind) and (iField<=iFields))
36073>>>>>                    Get_Attribute DF_FIELD_INDEX of iFile iField to iIndex
36076>>>>>                    If (iIndex>0) Begin
36078>>>>>                        Get Field_Changed_State of hoServer iField to bDoAutoFind
36079>>>>>                        If bDoAutoFind Begin
36081>>>>>                            Get Field_Current_Value of hoServer iField to sValue
36082>>>>>                            Get IsEmptyField of hoServer iField sValue to bIsEmptyField
36083>>>>>                            Move (not(bIsEmptyField)) to bDoAutoFind
36084>>>>>                            If bDoAutoFind Begin
36086>>>>>                                Get File_Field_Options iFile iField to iOpts
36087>>>>>                                // if this is a retain or retainall we don't do this because we want
36087>>>>>                                // to maintain backwards compatibility
36087>>>>>                                Move ( (iOpts iand DD_AUTOFIND or iOpts iand DD_AUTOFIND_GE) and ;                                        not( iOpts iand DD_RETAIN or iOpts iand DD_RETAINALL) ) to bDoAutoFind
36088>>>>>                                If bDoAutoFind Begin
36090>>>>>                                    Send File_Field_Default_AutoFind iFile iField
36091>>>>>                                    Set Changed_State to False // clears parent changed state
36092>>>>>                                End
36092>>>>>>
36092>>>>>                            End
36092>>>>>>
36092>>>>>                        End
36092>>>>>>
36092>>>>>                    End
36092>>>>>>
36092>>>>>                    Increment iField
36093>>>>>                Loop
36094>>>>>>
36094>>>>>                
36094>>>>>                // Only check for grandparent autofinds if this parent did not do a an autofind
36094>>>>>                // Doing an autofind on an autofind parent's parent is just too confusing
36094>>>>>                If not bDoAutoFind Begin
36096>>>>>                    Send DefaultParentAutofinds of hoServer
36097>>>>>                End
36097>>>>>>
36097>>>>>            End
36097>>>>>>
36097>>>>>        Loop
36098>>>>>>
36098>>>>>    End_Procedure
36099>>>>>    
36099>>>>>    // Set this DD to be an alias, passing the file number of the alias
36099>>>>>    // This can only be called once per instance and the Main_File must already have been set
36099>>>>>    // most likely in a superclass.
36099>>>>>    // This sets Main_File to the alias, stores the original master file (accessed via MasterForAlias).
36099>>>>>    // It also clears all existing relatonships. Normally we expect the alias class to set
36099>>>>>    // sets pbUseDDRelates and pbNoCascadeDeleteStrict to true. We don't do that automatically so that
36099>>>>>    // the Studio's property panel will show the correct values. When an alias is defined using the
36099>>>>>    // studio it will set these two properties.
36099>>>>>    // This means you must set any required relationships yourself
36099>>>>>    Procedure Set Alias_File Integer iTable
36101>>>>>        Integer iMain iMaster iFieldsM iFieldsA
36101>>>>>        Get Main_File to iMain
36102>>>>>        Get MasterForAlias to iMaster
36103>>>>>        
36103>>>>>        If (iTable=0 and iMaster) Begin
36105>>>>>            Error DFERR_PROGRAM "Cannot unset alias table"
36106>>>>>>
36106>>>>>            Procedure_Return
36107>>>>>        End
36107>>>>>>
36107>>>>>        If (iTable=iMain) Begin
36109>>>>>            Error DFERR_PROGRAM "Cannot set alias table to self"
36110>>>>>>
36110>>>>>            Procedure_Return
36111>>>>>        End
36111>>>>>>
36111>>>>>        If (iMaster) Begin
36113>>>>>            Error DFERR_PROGRAM "Cannot redefine alias table"
36114>>>>>>
36114>>>>>            Procedure_Return
36115>>>>>        End
36115>>>>>>
36115>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of iMain to iFieldsM
36118>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of iTable to iFieldsA
36121>>>>>        If (iFieldsA<>iFieldsM) Begin
36123>>>>>            Error DFERR_PROGRAM "Alias and Master file are not based on the same table"
36124>>>>>>
36124>>>>>            Procedure_Return
36125>>>>>        End
36125>>>>>>
36125>>>>>
36125>>>>>        Set piMasterTable to iMain 
36126>>>>>        Set Main_File to iTable
36127>>>>>        Send DefineAsAlias
36128>>>>>    End_Procedure
36129>>>>>    
36129>>>>>    Procedure DefineAsAlias
36131>>>>>        Integer i iFile
36131>>>>>        
36131>>>>>        // We expect he developer to set these properties to True
36131>>>>>        //Set pbUseDDRelates to True
36131>>>>>        //Set pbNoCascadeDeleteStrict to True
36131>>>>>        
36131>>>>>        Send ClearDDRelates
36132>>>>>        Get Client_File_Count to i
36133>>>>>        While i
36137>>>>>            Decrement i
36138>>>>>            Get Client_File i to iFile
36139>>>>>            Send Remove_Client_File iFile
36140>>>>>        Loop
36141>>>>>>
36141>>>>>        Get Server_File_Count to i
36142>>>>>        While i
36146>>>>>            Decrement i
36147>>>>>            Get Server_File i to iFile
36148>>>>>            Send Remove_Server_File iFile
36149>>>>>        Loop
36150>>>>>>
36150>>>>>    End_Procedure
36151>>>>>
36151>>>>>    Function MasterForAlias Returns Integer
36153>>>>>        Integer iMaster
36153>>>>>        Get piMasterTable to iMaster
36154>>>>>        Function_Return iMaster
36155>>>>>    End_Function
36156>>>>>    
36156>>>>>    Function IsAlias Returns Boolean
36158>>>>>        Integer iMaster
36158>>>>>        Get piMasterTable to iMaster
36159>>>>>        Function_Return (iMaster<>0)
36160>>>>>    End_Function
36161>>>>>    
36161>>>>>    
36161>>>>>//    Procedure ClearMasterRelationships 
36161>>>>>//        Integer iCount iFields iMain
36161>>>>>//        tRelationship[] MasterRelationships
36161>>>>>//        tRelationship Relationship
36161>>>>>//        Get Main_File to iMain
36161>>>>>//        Get Field_Count to iFields
36161>>>>>//        For i from 0 to iFields
36161>>>>>//            Get_Attribute DF_FIELD_RELATED_FILE of iMain i to Relationship.iParentFile
36161>>>>>//            If iRelFile Begin
36161>>>>>//                Get_Attribute DF_FIELD_RELATED_FIELD of iMaster i to Relationship.iParentField
36161>>>>>//                Move i to MasterRelationships[iCount].iChildField
36161>>>>>//                Set_Attribute DF_FIELD_RELATED_FILE of iMaster i to 0
36161>>>>>//                Set_Attribute DF_FIELD_RELATED_FIELD of iMaster i to 0
36161>>>>>//                Increment iCount
36161>>>>>//            End
36161>>>>>//        Loop
36161>>>>>//        Set pMasterRelatonships to MasterRelationships
36161>>>>>//    End_Procedure
36161>>>>>//    
36161>>>>>//    Procedure DefineAliasRelationship Integer iMasterParent Integer iAliasParent
36161>>>>>//        Integer i iRels iMain
36161>>>>>//        tRelationship[] MasterRelationships
36161>>>>>//        Get pMasterRelatonships to MasterRelationships
36161>>>>>//        Get Main_File to iMain
36161>>>>>//        Move (SizeOfArray(MasterRelationships)) to iRels
36161>>>>>//        For i from 0 to (iRels-1)
36161>>>>>//            If (MasterRelationships[i].iParentFile=iMasterParent) Begin
36161>>>>>//                Set_Attribute DF_FIELD_RELATED_FILE  of iMain i to iAliasParent
36161>>>>>//                Set_Attribute DF_FIELD_RELATED_FIELD of iMain i to MasterRelationships[i].iParentField
36161>>>>>//            End
36161>>>>>//        Loop
36161>>>>>//    End_Procedure
36161>>>>>//
36161>>>>>////    Procedure RestoreMasterRelationship Integer iMasterParent
36161>>>>>////        Integer i iRels iMain
36161>>>>>////        tRelationship[] MasterRelationships
36161>>>>>////        Get pMasterRelatonships to MasterRelationships
36161>>>>>////        Get Main_File to iMain
36161>>>>>////        Move (SizeOfArray(MasterRelationships)) to iRels
36161>>>>>////        For i from 0 to (iRels-1)
36161>>>>>////            Set_Attribute DF_FIELD_RELATED_FILE  of iMain i to MasterRelationships[i].iParentFile
36161>>>>>////            Set_Attribute DF_FIELD_RELATED_FIELD of iMain i to MasterRelationships[i].iParentField
36161>>>>>////        Loop
36161>>>>>////    End_Procedure
36161>>>>>
36161>>>>>    Procedure OnSaveRecord
36163>>>>>    End_Procedure
36164>>>>>    
36164>>>>>    Procedure StoreDefaultSQLFilters
36166>>>>>        Handle hoSQLHelper 
36166>>>>>        Get phoSQLHelper to hoSQLHelper
36167>>>>>        Send StoreDefaultSQLFilters of hoSQLHelper
36168>>>>>    End_Procedure
36169>>>>>    
36169>>>>>    Procedure RestoreDefaultSQLFilters
36171>>>>>        Handle hoSQLHelper 
36171>>>>>        Get phoSQLHelper to hoSQLHelper
36172>>>>>        Send RestoreDefaultSQLFilters of hoSQLHelper
36173>>>>>    End_Procedure
36174>>>>>    
36174>>>>>    Procedure ApplySQLFilterStr String sFilter
36176>>>>>        Handle hoSQLHelper 
36176>>>>>        Get phoSQLHelper to hoSQLHelper
36177>>>>>        Send ApplySQLFilterStr of hoSQLHelper sFilter
36178>>>>>    End_Procedure
36179>>>>>
36179>>>>>
36179>>>>>    Procedure ApplySQLFilter
36181>>>>>        String sNewFilter sOldFilter
36181>>>>>        Boolean bApplyGlobalSQLFilters bOldFilterActive
36181>>>>>        Handle hoSQLHelper
36181>>>>>        Get phoSQLHelper to hoSQLHelper
36182>>>>>        Get psSQLFilter to sNewFilter
36183>>>>>        // if we have am active  table filter we can either ignore it or and it to the where clause
36183>>>>>        // pbApplyGlobalSQLFilters determines what to do.
36183>>>>>        Get pbApplyGlobalSQLFilters to bApplyGlobalSQLFilters
36184>>>>>        Get pbOldFilterActive to bOldFilterActive
36185>>>>>        If (bApplyGlobalSQLFilters and bOldFilterActive) Begin
36187>>>>>            Get psOldFilter to sOldFilter
36188>>>>>            Get SQLStrAppend sOldFilter sNewFilter to sNewFilter
36189>>>>>        End
36189>>>>>>
36189>>>>>        Send ApplySQLFilterStr of hoSQLHelper sNewFilter
36190>>>>>    End_Procedure
36191>>>>>    
36191>>>>>    Procedure Data_Set_PreFind
36193>>>>>        Boolean bUseDDSQLFilters
36193>>>>>        String sOldDDFilter
36193>>>>>        Get pbUseDDSQLFilters to bUseDDSQLFilters
36194>>>>>        If bUseDDSQLFilters Begin
36196>>>>>
36196>>>>>            Send StoreDefaultSQLFilters
36197>>>>>
36197>>>>>            // this can get called during cascade deletes. In such a case we will
36197>>>>>            // never explicitly not apply an SQL filters because it could violate relational integrity
36197>>>>>            If (OPERATION_MODE=MODE_DELETING) Begin
36199>>>>>                Get psSQLFilter to sOldDDFilter
36200>>>>>                Set psSQLFilter to "" // make sure there is no filter applied
36201>>>>>            End
36201>>>>>>
36201>>>>>
36201>>>>>            Send ApplySQLFilter 
36202>>>>>
36202>>>>>            If (OPERATION_MODE=MODE_DELETING) Begin
36204>>>>>                Set psSQLFilter to sOldDDFilter
36205>>>>>            End
36205>>>>>>
36205>>>>>        End
36205>>>>>>
36205>>>>>    End_Procedure
36206>>>>>    
36206>>>>>    Procedure Data_Set_PostFind
36208>>>>>        Boolean bUseDDSQLFilters
36208>>>>>        Get pbUseDDSQLFilters to bUseDDSQLFilters
36209>>>>>        If bUseDDSQLFilters Begin
36211>>>>>          Send RestoreDefaultSQLFilters
36212>>>>>        End
36212>>>>>>
36212>>>>>    End_Procedure
36213>>>>>
36213>>>>>  
36213>>>>>    // returns active constraints in atConstraintDef array.
36213>>>>>    // Should be called after constraints are built
36213>>>>>    // typically right after Rebuild_Constraints
36213>>>>>
36213>>>>>    Function DDOConstraints Returns tConstraintDef[]
36215>>>>>        tConstraintDef[] Constraints
36215>>>>>        tConstraintDef[] Constraints
36216>>>>>        Integer i iCount i1
36216>>>>>        Get DATA_SET_CONSTRAINT_COUNT to iCount
36217>>>>>        For i from 0 to (iCount-1)
36223>>>>>>
36223>>>>>            Get DATA_SET_CONSTRAINT_INFO i 0 to i1 // type / mode
36224>>>>>            Move (Hi(i1)) to  Constraints[i].eType
36225>>>>>            Move (Low(i1)) to  Constraints[i].eMode
36226>>>>>            Get DATA_SET_CONSTRAINT_INFO i 1 to i1 // file / field
36227>>>>>            Move (Hi(i1)) to  Constraints[i].iFile
36228>>>>>            Move (Low(i1)) to  Constraints[i].iField
36229>>>>>            Get DATA_SET_CONSTRAINT_INFO i 2 to i1 // other file /field
36230>>>>>            Move (Hi(i1)) to  Constraints[i].iOtherFile
36231>>>>>            Move (Low(i1)) to  Constraints[i].iOtherField
36232>>>>>            Get DATA_SET_CONSTRAINT_INFO_Value i  to Constraints[i].sValue
36233>>>>>        Loop
36234>>>>>>
36234>>>>>        Function_Return Constraints
36235>>>>>    End_Function
36236>>>>>
36236>>>>>    // returns constraint finding information about the current find. This tells us what kinds
36236>>>>>    // of constraint find "expressions" are used. This will actually do a cosntrained find
36236>>>>>    // initialization much like Establish_Find_Direction, which means it can change the values in
36236>>>>>    // the file buffer to assist with a jump-in.
36236>>>>>    Function DDOConstraintFindMeta Integer eMode Integer iOrder Returns tDDOConstraintFindMeta
36238>>>>>       tDDOConstraintFindMeta FindMeta
36238>>>>>       tDDOConstraintFindMeta FindMeta
36238>>>>>       Integer i
36238>>>>>       Get Data_Set_Constraint_Exps eMode iOrder to i
36239>>>>>       Move (Hi(i)) to FindMeta.iJumpInSegments
36240>>>>>       Move (i iand CONST_EXP_JUMPOUT) to FindMeta.bJumpOut
36241>>>>>       Move (i iand CONST_EXP_PRE_RELATE) to FindMeta.bPreRelate
36242>>>>>       Move (i iand CONST_EXP_POST_RELATE) to FindMeta.bPostRelate
36243>>>>>       Function_Return FindMeta
36244>>>>>    End_Function 
36245>>>>>    
36245>>>>>    // this tells you if the current find or read requires a relate to evaluate the DF constraint.
36245>>>>>    // If false you could use this to set no_relate_state to false for the find/read process and then
36245>>>>>    // restore it when complete. Be careful using this.
36245>>>>>    Function DDOConstraintNeedsRelate Integer iOrder Returns Boolean
36247>>>>>       tDDOConstraintFindMeta FindMeta
36247>>>>>       tDDOConstraintFindMeta FindMeta
36247>>>>>       Get DDOConstraintFindMeta (GE) iOrder to FindMeta
36248>>>>>       Function_Return FindMeta.bPostRelate
36249>>>>>    End_Function
36250>>>>>
36250>>>>>   // returns true if this table supports SQL filter interface 
36250>>>>>   Function SupportsSQLFilters Returns Boolean
36252>>>>>       Boolean bSupports
36252>>>>>       Handle hoSQLHelper 
36252>>>>>       Get phoSQLHelper to hoSQLHelper
36253>>>>>       Get SupportsSQLFilters of hoSQLHelper to bSupports
36254>>>>>       Function_Return bSupports
36255>>>>>   End_Function
36256>>>>>   
36256>>>>>   // SQL Helper functions that return SQL Filters strings that can be used in a where clause
36256>>>>>
36256>>>>>   // Creates an SQL Like Filter for this field and search target
36256>>>>>   Function SQLStrLike Integer iField String sSearch Returns String
36258>>>>>       String sFilter
36258>>>>>       Handle hoSQLHelper 
36258>>>>>       Get phoSQLHelper to hoSQLHelper
36259>>>>>       Get SQLStrLike of hoSQLHelper iField sSearch to sFilter
36260>>>>>       Function_Return sFilter    
36261>>>>>   End_Function
36262>>>>>
36262>>>>>   // Appends two Filters with an AND clause. Both or either can be empty
36262>>>>>   Function SQLStrAppend String sOrigFilter String sFilter Returns String
36264>>>>>        Handle hoSQLHelper 
36264>>>>>        Get phoSQLHelper to hoSQLHelper
36265>>>>>        Get SQLStrAppend of hoSQLHelper sOrigFilter sFilter to sFilter
36266>>>>>        Function_Return sFilter    
36267>>>>>   End_Function
36268>>>>>   
36268>>>>>   // returns the name of the File and Field suitable for an SQL where statement
36268>>>>>   Function SQLStrFileFieldName Integer iField Returns String
36270>>>>>        String sName
36270>>>>>        Handle hoSQLHelper 
36270>>>>>        Get phoSQLHelper to hoSQLHelper
36271>>>>>        Get SQLStrFileFieldName of hoSQLHelper iField to sName
36272>>>>>        Function_Return sName
36273>>>>>   End_Function
36274>>>>>
36274>>>>>   // creates escaped SQL string by replacing single quote with two single quotes
36274>>>>>   Function SQLEscapedStr String sSQL Returns String
36276>>>>>        Handle hoSQLHelper 
36276>>>>>        Get phoSQLHelper to hoSQLHelper
36277>>>>>        Get SQLEscapedStr of hoSQLHelper sSQL to sSQL
36278>>>>>        Function_Return sSQL
36279>>>>>   End_Function
36280>>>>>       
36280>>>>>End_Class
36281>>>>>
36281>>>>>//************************************************************************//
36281>>>>>// This message will be send as a notification message from an            //
36281>>>>>// Extended_Data_Set whenever a fieldvalue has been changed.              //
36281>>>>>// It has been defined FOR cUIObject or Desktop  here so that attached    //
36281>>>>>// DEO which do not know anything about Extended_Data_Sets don't get      //
36281>>>>>// frustrated.                                                            //
36281>>>>>// All focusable objects and DEOs must understand this. This should be    //
36281>>>>>// changed at some point in the future.                                   //
36281>>>>>//************************************************************************//
36281>>>>>
36281>>>>>Function Extended_DEO_State for cUIObject Returns Integer
36283>>>>>End_function
36284>>>>>
36284>>>>>
36284>>>>>// this command is now obsolete. use Set Field_auto_increment
36284>>>Use DUFStatusPanel.pkg
Including file: DUFStatusPanel.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\DUFStatusPanel.pkg)
36284>>>>>// StatPnl.pkg - creates the standard status_panel object.
36284>>>>>//
36284>>>>>//
36284>>>>>// This is the default Status Panel object used by any of the Visual DataFlex classes that
36284>>>>>// invoke the standard status panel. The standard has always been that the package name
36284>>>>>// is StatPnl.pkg and the name of the object is Status_Panel. As of 12.0, there are major
36284>>>>>// changes in the way the status panel operates The Sentinel based external status panel used in
36284>>>>>// prior revisions has been replace with status panel that is part of the application.
36284>>>>>// This should work much better and faster than the old sentinel based solution.
36284>>>>>// While the way this operates has changed, the interface has not and therefore this should work
36284>>>>>// with most applications.
36284>>>>>//
36284>>>>>// As of 12.0, we have added a global handle that contains the object ID of this status panel.
36284>>>>>// This variable ghoStatusPanel can be used in place of the object name Status_Panel. This provides
36284>>>>>// a cleaner more robust interface.
36284>>>>>//
36284>>>>>//
36284>>>>>// Compatibility Note:
36284>>>>>//
36284>>>>>// When used in the standard way, this change will require no changes. A developer will only need to
36284>>>>>// change their code if they've modified the sentinel program, which was a difficult thing to do.
36284>>>>>//
36284>>>>>// If for some reason you application will not work using this as a replacement for the old status
36284>>>>>// panel, you've probably done something special with the old status-panel. If you don't want to
36284>>>>>// figure out how to use the new one and you want to continue using the old one you are going to need
36284>>>>>// to add some code to include the old status panel in your application. Add the following to your project (your src).
36284>>>>>//
36284>>>>>// Use StatPnl.pkg    // Make sure you load the new status panel object first. this is not optional!
36284>>>>>// Use OldStatPnl.pkg // load the old status panel. Status_Panel is now this old object
36284>>>>>//
36284>>>>>// If you do this, you will lose access to the new status-panel via Status_Panel. However, you
36284>>>>>// can still access the new object via the ghoStatusPanel handle.
36284>>>>>//
36284>>>>>//
36284>>>>>// Creating your own Status Panel objects
36284>>>>>//
36284>>>>>// If a developer wishes to create a custom panel, they should use this package as their template.
36284>>>>>// This panel can be visually modeled and changed any way you wish. Just save your new custom panel
36284>>>>>// with a different file and object name and direct your status panel request to the new object.
36284>>>>>//
36284>>>>>// If the new panel changes the interface and updates objects that are not currently defined, you
36284>>>>>// want to make sure you send the message ProcessEvents after you've updated the object. This allows
36284>>>>>// the object to paint when inside of a tight loop. For example, if you wanted to add a progress
36284>>>>>// bar (cProgressBar) you would want to Send ProcessEvents after you update the progress bar.
36284>>>>>// e.g.
36284>>>>>//       Procedure UpdateStatusBar
36284>>>>>//           Send DoAdvance of oProgressBar
36284>>>>>//           Send ProcessEvents
36284>>>>>//       End_Procedure
36284>>>>>//
36284>>>>>// of course, if you use the standard interfaces in status bar and your forward send these
36284>>>>>// messages this will be done for you.
36284>>>>>//
36284>>>>>// the standard Interface for status panels are:
36284>>>>>//
36284>>>>>// Send Initialize_StatusPanel - initializes values for caption, title & message
36284>>>>>// Send Start_StatusPanel      - start the status panel
36284>>>>>// Send Stop_StatusPanel       - stop the status panel
36284>>>>>// Send Update_StatusPanel     - update the status panel's action area
36284>>>>>// Get  Check_StatusPanel      - check for cancel (if cancel or pbCancel is set, close the panel)
36284>>>>>//
36284>>>>>// Get/Set Caption_Text - updates the caption bar
36284>>>>>// Get/Set Title_Text   - updates the title area
36284>>>>>// Get/Set Message_Text - updates the Message area
36284>>>>>// Get/Set Action_Text  - updates the action area
36284>>>>>// Get/Set Button_Text  - updates the button area
36284>>>>>//
36284>>>>>// Get/Set Allow_cancel_state - determines if panel can be canceled
36284>>>>>// Send EnableCancelButton - code you should provide to enable/disable cancel button
36284>>>>>//
36284>>>>>// ghoStatusPanel - global handle that points to the standard status panel.
36284>>>>>Use cProcessStatusPanel.pkg
36284>>>>>Use cCJSkinFramework.pkg
Including file: cCJSkinFramework.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJSkinFramework.pkg)
36284>>>>>>>Use windows.pkg
36284>>>>>>>Use cCJComSkinFramework.pkg
Including file: cCJComSkinFramework.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCJComSkinFramework.pkg)
36284>>>>>>>>>// DataFlex COM proxy classes generated from C:\Program Files (x86)\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v17.3.0\Bin\Codejock.SkinFramework.v17.3.0.ocx
36284>>>>>>>>>Use FlexCom20.pkg
36284>>>>>>>>>
36284>>>>>>>>>// Changes to Imported package
36284>>>>>>>>>//     OLEXTPxx to XTPxx
36284>>>>>>>>>//     OLExtpxx to xtpxx
36284>>>>>>>>>//     OLESkinFramework to SkinFramework
36284>>>>>>>>>//     OLESTDxxx and OLEXPxxxx to STD/XP
36284>>>>>>>>>//     cCom classes to cCJ
36284>>>>>>>>>//     cCJAutomationObject back to cComAutomationObject
36284>>>>>>>>>//     cCJActiveXControl back to cComActiveXControl
36284>>>>>>>>>//     cCJSkinFramework to cCJComSkinFramework
36284>>>>>>>>>//     Use statements as noted below (classes moved to these files)
36284>>>>>>>>>//     Set classlibrary of all cComAutomation objects to Windows (for class doc)
36284>>>>>>>>>
36284>>>>>>>>>// These have been extracted from this class and moved into seperate packages
36284>>>>>>>>>// because other Codejock classes use these.
36284>>>>>>>>>Use cCJColorManager.pkg     // cCJColorManager
36284>>>>>>>>>
36284>>>>>>>>>Define SkinFrameworkApplyOptions for Integer
36284>>>>>>>>>    Define xtpSkinApplyMetrics for 1
36284>>>>>>>>>    Define xtpSkinApplyFrame for 2
36284>>>>>>>>>    Define xtpSkinApplyColors for 4
36284>>>>>>>>>    Define xtpSkinApplyMenus for 8
36284>>>>>>>>>
36284>>>>>>>>>// CLSID: {AFA0E6A1-28D7-4F2C-87A7-7266367B4655}
36284>>>>>>>>>// Dispatch interface for SkinFramework Control
36284>>>>>>>>>Class cCJ_DSkinFramework is a Mixin
36285>>>>>>>>>
36285>>>>>>>>>    Function ComApplyOptions Returns SkinFrameworkApplyOptions
36287>>>>>>>>>        SkinFrameworkApplyOptions retVal
36287>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
36288>>>>>>>>>        Function_Return retVal
36289>>>>>>>>>    End_Function
36290>>>>>>>>>
36290>>>>>>>>>    Procedure Set ComApplyOptions SkinFrameworkApplyOptions value
36292>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
36293>>>>>>>>>    End_Procedure
36294>>>>>>>>>
36294>>>>>>>>>    Function ComAutoApplyNewWindows Returns Boolean
36296>>>>>>>>>        Boolean retVal
36296>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
36297>>>>>>>>>        Function_Return retVal
36298>>>>>>>>>    End_Function
36299>>>>>>>>>
36299>>>>>>>>>    Procedure Set ComAutoApplyNewWindows Boolean value
36301>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
36302>>>>>>>>>    End_Procedure
36303>>>>>>>>>
36303>>>>>>>>>    Function ComAutoApplyNewThreads Returns Boolean
36305>>>>>>>>>        Boolean retVal
36305>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
36306>>>>>>>>>        Function_Return retVal
36307>>>>>>>>>    End_Function
36308>>>>>>>>>
36308>>>>>>>>>    Procedure Set ComAutoApplyNewThreads Boolean value
36310>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
36311>>>>>>>>>    End_Procedure
36312>>>>>>>>>
36312>>>>>>>>>    Function ComLoadSkin String llResourcePath String llIniFileName Returns Boolean
36314>>>>>>>>>        Handle hDispatchDriver
36314>>>>>>>>>        Boolean retVal
36314>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36315>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36316>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llResourcePath
36317>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llIniFileName
36318>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BOOL to retVal
36319>>>>>>>>>        Function_Return retVal
36320>>>>>>>>>    End_Function
36321>>>>>>>>>
36321>>>>>>>>>    Procedure ComApplyWindow OLE_HANDLE llhWnd
36323>>>>>>>>>        Handle hDispatchDriver
36323>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36324>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36325>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
36326>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
36327>>>>>>>>>    End_Procedure
36328>>>>>>>>>
36328>>>>>>>>>    Procedure ComEnableThemeDialogTexture OLE_HANDLE llhWnd Integer llFlags
36330>>>>>>>>>        Handle hDispatchDriver
36330>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36331>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36332>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
36333>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llFlags
36334>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
36335>>>>>>>>>    End_Procedure
36336>>>>>>>>>
36336>>>>>>>>>    Procedure ComRemoveWindow OLE_HANDLE llhWnd
36338>>>>>>>>>        Handle hDispatchDriver
36338>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36339>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36340>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
36341>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
36342>>>>>>>>>    End_Procedure
36343>>>>>>>>>
36343>>>>>>>>>    Procedure ComRemoveAllWindows
36345>>>>>>>>>        Handle hDispatchDriver
36345>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36346>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
36347>>>>>>>>>    End_Procedure
36348>>>>>>>>>
36348>>>>>>>>>    Procedure ComAddWindowClass String llClassName String llBaseClassName
36350>>>>>>>>>        Handle hDispatchDriver
36350>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36351>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36352>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
36353>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llBaseClassName
36354>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
36355>>>>>>>>>    End_Procedure
36356>>>>>>>>>
36356>>>>>>>>>    Procedure ComRemoveWindowClass String llClassName
36358>>>>>>>>>        Handle hDispatchDriver
36358>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36359>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36360>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
36361>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
36362>>>>>>>>>    End_Procedure
36363>>>>>>>>>
36363>>>>>>>>>    Function ComEnumerateSkinDirectory String llPath Boolean llRecursive Returns Variant
36365>>>>>>>>>        Handle hDispatchDriver
36365>>>>>>>>>        Variant retVal
36365>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36366>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36367>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
36368>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRecursive
36369>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
36370>>>>>>>>>        Function_Return retVal
36371>>>>>>>>>    End_Function
36372>>>>>>>>>
36372>>>>>>>>>    Function ComEnumerateSkinFile String llPath Returns Variant
36374>>>>>>>>>        Handle hDispatchDriver
36374>>>>>>>>>        Variant retVal
36374>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36375>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36376>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
36377>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
36378>>>>>>>>>        Function_Return retVal
36379>>>>>>>>>    End_Function
36380>>>>>>>>>
36380>>>>>>>>>    Function ComGetColor XTPColorManagerColor llIndex Returns OLE_COLOR
36382>>>>>>>>>        Handle hDispatchDriver
36382>>>>>>>>>        OLE_COLOR retVal
36382>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36383>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36384>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
36385>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_I4 to retVal
36386>>>>>>>>>        Function_Return retVal
36387>>>>>>>>>    End_Function
36388>>>>>>>>>
36388>>>>>>>>>    Procedure ComExcludeModule String llModuleName
36390>>>>>>>>>        Handle hDispatchDriver
36390>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36391>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36392>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llModuleName
36393>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
36394>>>>>>>>>    End_Procedure
36395>>>>>>>>>
36395>>>>>>>>>    Function ComCreateSchema String llResourcePath String llIniFileName Returns Variant
36397>>>>>>>>>        Handle hDispatchDriver
36397>>>>>>>>>        Variant retVal
36397>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36398>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36399>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llResourcePath
36400>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llIniFileName
36401>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
36402>>>>>>>>>        Function_Return retVal
36403>>>>>>>>>    End_Function
36404>>>>>>>>>
36404>>>>>>>>>    Procedure ComSetWindowTheme OLE_HANDLE llhWnd Variant llSchema
36406>>>>>>>>>        Handle hDispatchDriver
36406>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36407>>>>>>>>>        Send PrepareParams to hDispatchDriver 2
36408>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
36409>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llSchema
36410>>>>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
36411>>>>>>>>>    End_Procedure
36412>>>>>>>>>
36412>>>>>>>>>    Procedure ComAboutBox
36414>>>>>>>>>        Handle hDispatchDriver
36414>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36415>>>>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
36416>>>>>>>>>    End_Procedure
36417>>>>>>>>>End_Class
36418>>>>>>>>>
36418>>>>>>>>>// CLSID: {40217CB8-4463-4030-B324-AC6A8075FEC8}
36418>>>>>>>>>// Event interface for SkinFramework Control
36418>>>>>>>>>Class cCJ_DSkinFrameworkEvents is a Mixin
36419>>>>>>>>>
36419>>>>>>>>>    Procedure RegisterComEvents
36421>>>>>>>>>    End_Procedure
36422>>>>>>>>>End_Class
36423>>>>>>>>>
36423>>>>>>>>>// CoClass
36423>>>>>>>>>// ProgID: Codejock.SkinFramework.17.3.0
36423>>>>>>>>>// CLSID: {DE67160B-9A3E-4EA6-846E-8C9A72F9F203}
36423>>>>>>>>>// SkinFramework Control
36423>>>>>>>>>Class cCJComSkinFramework is a cComActiveXControl
36424>>>>>>>>>    Import_Class_Protocol cCJ_DSkinFramework
36425>>>>>>>>>    Import_Class_Protocol cCJ_DSkinFrameworkEvents
36426>>>>>>>>>
36426>>>>>>>>>    Procedure Construct_Object
36428>>>>>>>>>        Forward Send Construct_Object
36430>>>>>>>>>        Set psProgID to "{DE67160B-9A3E-4EA6-846E-8C9A72F9F203}"
36431>>>>>>>>>        Set psEventId to "{40217CB8-4463-4030-B324-AC6A8075FEC8}"
36432>>>>>>>>>        Set psLicenseKey to ("Skin Framework Control Copyright (c) 1998-2016 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.SkinFramework.ActiveX.v17.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: GGE-OLD-QQR-EJS")
36433>>>>>>>>>        Set peAutoCreate to acAutoCreate
36434>>>>>>>>>    End_Procedure
36435>>>>>>>>>End_Class
36436>>>>>>>>>
36436>>>>>>>>>// CLSID: {06E8A85B-70E4-4F71-A0FC-D1D5658C7E17}
36436>>>>>>>>>// SkinFramework Global Settings
36436>>>>>>>>>Class cCJISkinFrameworkGlobalSettings is a Mixin
36437>>>>>>>>>
36437>>>>>>>>>    Function ComLicense Returns String
36439>>>>>>>>>        String retVal
36439>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to retVal
36440>>>>>>>>>        Function_Return retVal
36441>>>>>>>>>    End_Function
36442>>>>>>>>>
36442>>>>>>>>>    Procedure Set ComLicense String value
36444>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to value
36445>>>>>>>>>    End_Procedure
36446>>>>>>>>>
36446>>>>>>>>>    Function ComTitle Returns String
36448>>>>>>>>>        String retVal
36448>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to retVal
36449>>>>>>>>>        Function_Return retVal
36450>>>>>>>>>    End_Function
36451>>>>>>>>>
36451>>>>>>>>>    Procedure Set ComTitle String value
36453>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to value
36454>>>>>>>>>    End_Procedure
36455>>>>>>>>>
36455>>>>>>>>>    Function ComVersion Returns String
36457>>>>>>>>>        Handle hDispatchDriver
36457>>>>>>>>>        String retVal
36457>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36458>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 104 OLE_VT_BSTR to retVal
36459>>>>>>>>>        Function_Return retVal
36460>>>>>>>>>    End_Function
36461>>>>>>>>>
36461>>>>>>>>>    Function ComUnicode Returns Boolean
36463>>>>>>>>>        Handle hDispatchDriver
36463>>>>>>>>>        Boolean retVal
36463>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36464>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_BOOL to retVal
36465>>>>>>>>>        Function_Return retVal
36466>>>>>>>>>    End_Function
36467>>>>>>>>>
36467>>>>>>>>>    Function ComOcxPath Returns String
36469>>>>>>>>>        Handle hDispatchDriver
36469>>>>>>>>>        String retVal
36469>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36470>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 106 OLE_VT_BSTR to retVal
36471>>>>>>>>>        Function_Return retVal
36472>>>>>>>>>    End_Function
36473>>>>>>>>>End_Class
36474>>>>>>>>>
36474>>>>>>>>>// CoClass
36474>>>>>>>>>// ProgID: Codejock.SkinFrameworkGlobalSettings.17.3.0
36474>>>>>>>>>// CLSID: {C4136A4A-67FD-4FC1-BA62-A715B4D60808}
36474>>>>>>>>>// SkinFramework Global Settings
36474>>>>>>>>>Class cCJComSkinFrameworkGlobalSettings is a cComAutomationObject
36475>>>>>>>>>    Import_Class_Protocol cCJISkinFrameworkGlobalSettings
36476>>>>>>>>>
36476>>>>>>>>>    Procedure Construct_Object
36478>>>>>>>>>        Forward Send Construct_Object
36480>>>>>>>>>        Set psProgID to "{C4136A4A-67FD-4FC1-BA62-A715B4D60808}"
36481>>>>>>>>>        Set peAutoCreate to acNoAutoCreate
36482>>>>>>>>>    End_Procedure
36483>>>>>>>>>End_Class
36484>>>>>>>>>
36484>>>>>>>>>// CLSID: {27E4AC9B-4A2D-4FBB-A782-BD76BEFA4345}
36484>>>>>>>>>Class cCJSkinIniFile is a cComAutomationObject
36485>>>>>>>>>
36485>>>>>>>>>    Function ComColorScheme Returns String
36487>>>>>>>>>        String retVal
36487>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
36488>>>>>>>>>        Function_Return retVal
36489>>>>>>>>>    End_Function
36490>>>>>>>>>
36490>>>>>>>>>    Procedure Set ComColorScheme String value
36492>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
36493>>>>>>>>>    End_Procedure
36494>>>>>>>>>
36494>>>>>>>>>    Function ComFontSize Returns String
36496>>>>>>>>>        String retVal
36496>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
36497>>>>>>>>>        Function_Return retVal
36498>>>>>>>>>    End_Function
36499>>>>>>>>>
36499>>>>>>>>>    Procedure Set ComFontSize String value
36501>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
36502>>>>>>>>>    End_Procedure
36503>>>>>>>>>
36503>>>>>>>>>    Function ComIniFileName Returns String
36505>>>>>>>>>        String retVal
36505>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to retVal
36506>>>>>>>>>        Function_Return retVal
36507>>>>>>>>>    End_Function
36508>>>>>>>>>
36508>>>>>>>>>    Procedure Set ComIniFileName String value
36510>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to value
36511>>>>>>>>>    End_Procedure
36512>>>>>>>>>End_Class
36513>>>>>>>>>
36513>>>>>>>>>// CLSID: {5005F22B-A30E-4B12-B142-E97F62A927A6}
36513>>>>>>>>>Class cCJSkinDescription is a cComAutomationObject
36514>>>>>>>>>
36514>>>>>>>>>    Function ComName Returns String
36516>>>>>>>>>        String retVal
36516>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
36517>>>>>>>>>        Function_Return retVal
36518>>>>>>>>>    End_Function
36519>>>>>>>>>
36519>>>>>>>>>    Procedure Set ComName String value
36521>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
36522>>>>>>>>>    End_Procedure
36523>>>>>>>>>
36523>>>>>>>>>    Function ComPath Returns String
36525>>>>>>>>>        String retVal
36525>>>>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
36526>>>>>>>>>        Function_Return retVal
36527>>>>>>>>>    End_Function
36528>>>>>>>>>
36528>>>>>>>>>    Procedure Set ComPath String value
36530>>>>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
36531>>>>>>>>>    End_Procedure
36532>>>>>>>>>
36532>>>>>>>>>    Function ComCount Returns Integer
36534>>>>>>>>>        Handle hDispatchDriver
36534>>>>>>>>>        Integer retVal
36534>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36535>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
36536>>>>>>>>>        Function_Return retVal
36537>>>>>>>>>    End_Function
36538>>>>>>>>>
36538>>>>>>>>>    Function ComIniFile Integer llIndex Returns Variant
36540>>>>>>>>>        Handle hDispatchDriver
36540>>>>>>>>>        Variant retVal
36540>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36541>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36542>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
36543>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
36544>>>>>>>>>        Function_Return retVal
36545>>>>>>>>>    End_Function
36546>>>>>>>>>
36546>>>>>>>>>    Function Com_NewEnum Returns Variant
36548>>>>>>>>>        Handle hDispatchDriver
36548>>>>>>>>>        Variant retVal
36548>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36549>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
36550>>>>>>>>>        Function_Return retVal
36551>>>>>>>>>    End_Function
36552>>>>>>>>>End_Class
36553>>>>>>>>>
36553>>>>>>>>>// CLSID: {C4367A33-2A7C-4CC6-BF0C-C50383B34B51}
36553>>>>>>>>>Class cCJSkinDescriptions is a cComAutomationObject
36554>>>>>>>>>
36554>>>>>>>>>    Function ComCount Returns Integer
36556>>>>>>>>>        Handle hDispatchDriver
36556>>>>>>>>>        Integer retVal
36556>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36557>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
36558>>>>>>>>>        Function_Return retVal
36559>>>>>>>>>    End_Function
36560>>>>>>>>>
36560>>>>>>>>>    Function ComSkin Integer llIndex Returns Variant
36562>>>>>>>>>        Handle hDispatchDriver
36562>>>>>>>>>        Variant retVal
36562>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36563>>>>>>>>>        Send PrepareParams to hDispatchDriver 1
36564>>>>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
36565>>>>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
36566>>>>>>>>>        Function_Return retVal
36567>>>>>>>>>    End_Function
36568>>>>>>>>>
36568>>>>>>>>>    Function Com_NewEnum Returns Variant
36570>>>>>>>>>        Handle hDispatchDriver
36570>>>>>>>>>        Variant retVal
36570>>>>>>>>>        Get phDispatchDriver to hDispatchDriver
36571>>>>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
36572>>>>>>>>>        Function_Return retVal
36573>>>>>>>>>    End_Function
36574>>>>>>>>>End_Class
36575>>>>>>>>>
36575>>>>>>>>>// CLSID: {128507E0-C56F-43C0-BCF1-8193B35FE4C4}
36575>>>>>>>>>Class cCJSkinSchema is a cComAutomationObject
36576>>>>>>>>>End_Class
36577>>>>>>>Use cApplication.pkg
36577>>>>>>>
36577>>>>>>>Struct tSkinInformation
36577>>>>>>>    String sName     // description of the skin
36577>>>>>>>    String sSkinfile // file path. Can be relative or full
36577>>>>>>>    String sSkinIni  // section name
36577>>>>>>>End_Struct
36577>>>>>>>
36577>>>>>>>
36577>>>>>>>Class cCJSkinFramework is a cCJComSkinFramework
36578>>>>>>>    
36578>>>>>>>    Procedure Construct_Object
36580>>>>>>>        Forward Send Construct_Object
36582>>>>>>>        
36582>>>>>>>        Property String psSkinFile ""
36583>>>>>>>        Property String psSkinIni ""
36584>>>>>>>        Property Boolean pbLoadPreference False
36585>>>>>>>        
36585>>>>>>>        Set peAutoCreate to acAutoCreate
36586>>>>>>>        
36586>>>>>>>        Move Self to ghoSkinFramework
36587>>>>>>>    End_Procedure
36588>>>>>>>    
36588>>>>>>>    // return the default skin path, which is the programs directory.
36588>>>>>>>    // This requires an application object.
36588>>>>>>>    // If you want to different skin path, override this.
36588>>>>>>>    Function SkinPath Returns String
36590>>>>>>>        String sPath sPaths
36590>>>>>>>        Handle hoWorkspace
36590>>>>>>>        If ghoApplication Begin
36592>>>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
36593>>>>>>>            Get psProgramPath of hoWorkspace to sPaths
36594>>>>>>>            Get PathAtIndex of hoWorkspace sPaths 1 to sPath
36595>>>>>>>        End
36595>>>>>>>>
36595>>>>>>>        Else Begin
36596>>>>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
36597>>>>>>>>
36597>>>>>>>        End
36597>>>>>>>>
36597>>>>>>>        Function_Return sPath
36598>>>>>>>    End_Function
36599>>>>>>>    
36599>>>>>>>    // Returns the Qualified name of psSkinFile. If the file is already qualified it just
36599>>>>>>>    // returns itself. If it is not, it uses SkinPath to get the path.
36599>>>>>>>    Function SkinQFile Returns String
36601>>>>>>>        String sFile sPath sSep
36601>>>>>>>        Boolean bQualified
36601>>>>>>>        Get psSkinFile to sFile
36602>>>>>>>        If not (IsFileNameQualified(sFile)) Begin
36604>>>>>>>            Get SkinPath to sPath
36605>>>>>>>            Move (SysConf(SYSCONF_DIR_SEPARATOR)) to sSep
36606>>>>>>>            Move (sPath - sSep - sFile) to sFile
36607>>>>>>>        End
36607>>>>>>>>
36607>>>>>>>        Function_Return sFile
36608>>>>>>>    End_Function
36609>>>>>>>        
36609>>>>>>>    // defines the default VDF window class mapping.    
36609>>>>>>>    Procedure OnAddVDFWindowClasses
36611>>>>>>>        Send ComAddWindowClass "DFlistbox"               "ListBox"
36612>>>>>>>        Send ComAddWindowClass "DFentry"                 "Edit"
36613>>>>>>>        Send ComAddWindowClass "DFtextbox"               "Edit"
36614>>>>>>>        Send ComAddWindowClass "DFRichEditCtrl"          "Edit"
36615>>>>>>>        Send ComAddWindowClass "DFcombobox"              "ComboBox"
36616>>>>>>>        Send ComAddWindowClass "DFformlist"              "Edit"
36617>>>>>>>        Send ComAddWindowClass "DFFormListHeader"        "SysHeader32"
36618>>>>>>>        Send ComAddWindowClass "DFbutton"                "Button"
36619>>>>>>>        Send ComAddWindowClass "HPromptBtn"              "Button"
36620>>>>>>>        Send ComAddWindowClass "Hspinbtn"                "msctls_updown32"
36621>>>>>>>        Send ComAddWindowClass "DFSysTabControl32"       "SysTabControl32"
36622>>>>>>>        Send ComAddWindowClass "DFMDIClient"             "MDIClient" 
36623>>>>>>>        Send ComAddWindowClass "DFedit"                  "edit"
36624>>>>>>>        Send ComAddWindowClass "DFlistedit"              "edit"
36625>>>>>>>        Send ComAddWindowClass "DFscrollbar"             "scrollbar"
36626>>>>>>>        Send ComAddWindowClass "DFgroup"                 "Button"
36627>>>>>>>        Send ComAddWindowClass "DFComboGrid"             "ComboBox"
36628>>>>>>>        // External class
36628>>>>>>>        Send ComAddWindowClass "cVdfAnimation"           "SysAnimate32"
36629>>>>>>>        Send ComAddWindowClass "cVdfProgressBar"         "msctls_progress32"
36630>>>>>>>        Send ComAddWindowClass "cVdfStatusBar"           "msctls_statusbar32"
36631>>>>>>>        Send ComAddWindowClass "cVdfToolbar"             "ToolbarWindow32"
36632>>>>>>>        Send ComAddWindowClass "cObsoleteVdfProgressBar" "msctls_progress32"
36633>>>>>>>        Send ComAddWindowClass "cVdfTrackBar"            "msctls_trackbar32"
36634>>>>>>>        Send ComAddWindowClass "cObsoleteBasicStatusBar" "msctls_statusbar32"
36635>>>>>>>        Send ComAddWindowClass "cVdfTreeView"            "SysTreeView32"
36636>>>>>>>    End_Procedure
36637>>>>>>>    
36637>>>>>>>    // Used to support developer designed class mappings (e.g. COM controls)
36637>>>>>>>    Procedure OnAddCustomWindowClasses
36639>>>>>>>    End_Procedure
36640>>>>>>>
36640>>>>>>>    // called when object is created during end_construct_object.
36640>>>>>>>    Procedure OnCreate
36642>>>>>>>        Integer iOpts
36642>>>>>>>        Boolean bUseWindowsFont
36642>>>>>>>        Forward Send OnCreate
36644>>>>>>>        
36644>>>>>>>        // if we are using the windows fonts we will disable the apply metrics which
36644>>>>>>>        // never really looked good anyway. This test only exists or legacy purposes
36644>>>>>>>        Get pbUseWindowsFont of Desktop to bUseWindowsFont
36645>>>>>>>        If bUseWindowsFont Begin
36647>>>>>>>            Get ComApplyOptions to iOpts
36648>>>>>>>            Set ComApplyOptions to (RemoveBitValue(xtpSkinApplyMetrics, iOpts))
36649>>>>>>>        End
36649>>>>>>>>
36649>>>>>>>
36649>>>>>>>        // this works around a CJ issue where skins applied to other threads causes an exception upon close down. 
36649>>>>>>>        // We saw this with our mssql driver but it could occur elsewhere. This has been reported in the CJ newsgroup
36649>>>>>>>        // and this was the suggested workaround.
36649>>>>>>>        Set ComAutoApplyNewThreads to False
36650>>>>>>>
36650>>>>>>>        Send OnAddVDFWindowClasses
36651>>>>>>>        Send OnAddCustomWindowClasses
36652>>>>>>>        
36652>>>>>>>        // if preferences are used, it will set psSkinFile and psSkinIni
36652>>>>>>>        If (pbLoadPreference(Self)) Begin
36654>>>>>>>            Send LoadSkinPreference
36655>>>>>>>        End
36655>>>>>>>>
36655>>>>>>>        // if a skin file name exists, we apply the skin.    
36655>>>>>>>        If (psSkinFile(Self)<>"") Begin
36657>>>>>>>            Send ApplySkin
36658>>>>>>>        End        
36658>>>>>>>>
36658>>>>>>>    End_Procedure
36659>>>>>>>    
36659>>>>>>>    // called by framework as part of application exit.
36659>>>>>>>    Procedure Broadcast_Notify_Exit_Application
36661>>>>>>>        Send Notify_Exit_Application
36662>>>>>>>    End_Procedure // Notify_Exit_Application
36663>>>>>>>
36663>>>>>>>    Procedure Notify_Exit_Application
36665>>>>>>>        If (pbLoadPreference(Self)) Begin
36667>>>>>>>            Send SaveSkinPreference
36668>>>>>>>        End
36668>>>>>>>>
36668>>>>>>>    End_Procedure
36669>>>>>>>
36669>>>>>>>    Procedure NotifyPreApplySkin
36671>>>>>>>        Broadcast Send OnPreApplySkin of Desktop True       
36673>>>>>>>    End_Procedure
36674>>>>>>>
36674>>>>>>>    Procedure NotifyPostApplySkin
36676>>>>>>>        Broadcast Send OnPostApplySkin of Desktop True       
36678>>>>>>>    End_Procedure
36679>>>>>>>    
36679>>>>>>>    // returns an array of all skins in the path. If path is "", use the default path.
36679>>>>>>>    // If the default path is used, returns the file names as relative names, else use full path.
36679>>>>>>>    Function EnumerateSkins String sPath Boolean bRecursive Returns tSkinInformation[]
36681>>>>>>>        tSkinInformation[] Skins
36681>>>>>>>        tSkinInformation[] Skins
36682>>>>>>>        String sSkinName sSkinFile sDefaultPath sSep
36682>>>>>>>        Variant vSkinDescriptions vSkinDescription vSkinIniFile
36682>>>>>>>        Handle hSkinDescriptions hSkinDescription hSkinIniFile
36682>>>>>>>        Integer iSkinsCount iSkinFilesCount iNumSkins iNumSkinFiles iArrayItem
36682>>>>>>>        Integer iPos iDfltLen
36682>>>>>>>        Boolean bUseRelativePath
36682>>>>>>>        
36682>>>>>>>        Move (SysConf(SYSCONF_DIR_SEPARATOR)) to sSep
36683>>>>>>>        
36683>>>>>>>        Get SkinPath to sDefaultPath
36684>>>>>>>        If (sPath="") Begin
36686>>>>>>>            Move sDefaultPath to sPath
36687>>>>>>>        End
36687>>>>>>>>
36687>>>>>>>        Move (Uppercase(sDefaultPath)) to sDefaultPath
36688>>>>>>>        Move (Length(sDefaultPath)) to iDfltLen
36689>>>>>>>        Move (sDefaultPath=Uppercase(sPath)) to bUseRelativePath
36690>>>>>>>
36690>>>>>>>        Get ComEnumerateSkinDirectory sPath bRecursive to vSkinDescriptions
36691>>>>>>>        If (not(IsNullComObject(vSkinDescriptions))) Begin
36693>>>>>>>
36693>>>>>>>            Get Create U_cCJSkinDescriptions to hSkinDescriptions
36694>>>>>>>            Get Create U_cCJSkinDescription to hSkinDescription
36695>>>>>>>            Get Create U_cCJSkinIniFile to hSkinIniFile
36696>>>>>>>            
36696>>>>>>>            Set pvComObject of hSkinDescriptions to vSkinDescriptions
36697>>>>>>>            Get ComCount of hSkinDescriptions to iNumSkinFiles
36698>>>>>>>            
36698>>>>>>>            For iSkinFilesCount from 0 to (iNumSkinFiles-1)
36704>>>>>>>>
36704>>>>>>>                Get ComSkin of hSkinDescriptions iSkinFilesCount to vSkinDescription
36705>>>>>>>                Set pvComObject of hSkinDescription to vSkinDescription
36706>>>>>>>
36706>>>>>>>                Get ComCount of hSkinDescription to iNumSkins
36707>>>>>>>                    
36707>>>>>>>                For iSkinsCount from 0 to (iNumSkins-1)
36713>>>>>>>>
36713>>>>>>>                    Get ComIniFile of hSkinDescription iSkinsCount to vSkinIniFile
36714>>>>>>>                    Set pvComObject of hSkinIniFile to vSkinIniFile
36715>>>>>>>
36715>>>>>>>                    Get ComName of hSkinDescription to Skins[iArrayItem].sName
36716>>>>>>>                    Get ComPath of hSkinDescription to sSkinFile
36717>>>>>>>                    If bUseRelativePath Begin
36719>>>>>>>                        Move (pos(sDefaultPath,uppercase(sSkinFile))) to iPos
36720>>>>>>>                        If iPos Begin
36722>>>>>>>                            Move (Remove(sSkinFile,iPos,iDfltLen)) to sSkinFile   
36723>>>>>>>                            While (Left(sSkinFile,1)=sSep)
36727>>>>>>>                                Move (Remove(sSkinFile,1,1)) to sSkinFile   
36728>>>>>>>                            Loop                         
36729>>>>>>>>
36729>>>>>>>                        End
36729>>>>>>>>
36729>>>>>>>                    End
36729>>>>>>>>
36729>>>>>>>                    Move sSkinFile to Skins[iArrayItem].sSkinfile
36730>>>>>>>                    Get ComIniFileName of hSkinIniFile to Skins[iArrayItem].sSkinIni
36731>>>>>>>
36731>>>>>>>                    Increment iArrayItem
36732>>>>>>>                Loop
36733>>>>>>>>
36733>>>>>>>            Loop
36734>>>>>>>>
36734>>>>>>>                            
36734>>>>>>>            Send Destroy of hSkinDescriptions
36735>>>>>>>            Send Destroy of hSkinDescription
36736>>>>>>>            Send Destroy of hSkinIniFile
36737>>>>>>>                
36737>>>>>>>        End
36737>>>>>>>>
36737>>>>>>>        Function_Return Skins
36738>>>>>>>    End_Function 
36739>>>>>>>    
36739>>>>>>>    // Save the skin preference. This requires an application object.
36739>>>>>>>    // Only do this if the application object allows it. 
36739>>>>>>>    // This is called during startup if pbLoadPreference is True
36739>>>>>>>    // Suitable for override
36739>>>>>>>    Procedure SaveSkinPreference 
36741>>>>>>>        String sSkin sIni
36741>>>>>>>        If ghoApplication Begin
36743>>>>>>>            If (pbPreserveEnvironment(ghoApplication)) Begin
36745>>>>>>>                Get psSkinFile to sSkin
36746>>>>>>>                Get psSkinIni to sIni
36747>>>>>>>                Send WriteString of ghoApplication "Preferences" "SkinFile" sSkin
36748>>>>>>>                Send WriteString of ghoApplication "Preferences" "SkinIni" sIni
36749>>>>>>>            End
36749>>>>>>>>
36749>>>>>>>        End
36749>>>>>>>>
36749>>>>>>>        Else Begin
36750>>>>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
36751>>>>>>>>
36751>>>>>>>        End
36751>>>>>>>>
36751>>>>>>>    End_Procedure
36752>>>>>>>
36752>>>>>>>    // Load the skin preference. This requires an application object.
36752>>>>>>>    // Only do this if the application object allows it. 
36752>>>>>>>    // This is called during startup if pbLoadPreference is True
36752>>>>>>>    // Suitable for override
36752>>>>>>>    Procedure LoadSkinPreference 
36754>>>>>>>        String sSkin sIni
36754>>>>>>>        Boolean bExists
36754>>>>>>>        If ghoApplication Begin
36756>>>>>>>            If (pbPreserveEnvironment(ghoApplication)) Begin
36758>>>>>>>                Get ValueExists of ghoApplication "Preferences" "SkinFile" to bExists
36759>>>>>>>                If bExists Begin
36761>>>>>>>                    Get ReadString of ghoApplication "Preferences" "SkinFile" "" to sSkin
36762>>>>>>>                    Get ReadString of ghoApplication "Preferences" "SkinIni" "" to sIni
36763>>>>>>>                    Set psSkinFile to sSkin
36764>>>>>>>                    Set psSkinIni to sIni
36765>>>>>>>                End
36765>>>>>>>>
36765>>>>>>>            End
36765>>>>>>>>
36765>>>>>>>        End
36765>>>>>>>>
36765>>>>>>>        Else Begin
36766>>>>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
36767>>>>>>>>
36767>>>>>>>        End
36767>>>>>>>>
36767>>>>>>>    End_Procedure
36768>>>>>>>
36768>>>>>>>    // Can be called to apply the current skin.
36768>>>>>>>    Procedure ApplySkin
36770>>>>>>>        Boolean bOk
36770>>>>>>>        String sSkin sIni
36770>>>>>>>        If (IsComObjectCreated(Self)) Begin
36772>>>>>>>            Get SkinQFile to sSkin
36773>>>>>>>            Get psSkinIni to sIni
36774>>>>>>>            
36774>>>>>>>            Send NotifyPreApplySkin
36775>>>>>>>            // when skins are used we don't want to use built in Visual Styles
36775>>>>>>>            Send EnableVisualStyles of Desktop (sSkin="")
36776>>>>>>>            Get ComLoadSkin sSkin sIni to bOK
36777>>>>>>>            If (sSkin<>"" and not(bOk)) Begin
36779>>>>>>>                // if not ok, no skin was appied. Enable visual styles
36779>>>>>>>                Send EnableVisualStyles of Desktop True
36780>>>>>>>            End
36780>>>>>>>>
36780>>>>>>>            Send NotifyPostApplySkin
36781>>>>>>>        End
36781>>>>>>>>
36781>>>>>>>    End_Procedure
36782>>>>>>>
36782>>>>>>>
36782>>>>>>>End_Class
36783>>>>>Use cProgressBar.pkg
Including file: cProgressBar.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cProgressBar.pkg)
36783>>>>>>>Use Windows.pkg
36783>>>>>>>Use cWinControl.pkg
Including file: cWinControl.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cWinControl.pkg)
36783>>>>>>>>>Use Windows.pkg
36783>>>>>>>>>
36783>>>>>>>>>// Key State Masks for Mouse Messages
36783>>>>>>>>>
36783>>>>>>>>>Define MK_LBUTTON  for |CI$0001
36783>>>>>>>>>Define MK_RBUTTON  for |CI$0002
36783>>>>>>>>>Define MK_SHIFT    for |CI$0004
36783>>>>>>>>>Define MK_CONTROL  for |CI$0008
36783>>>>>>>>>Define MK_MBUTTON  for |CI$0010
36783>>>>>>>>>Define MK_XBUTTON1 for |CI$0020
36783>>>>>>>>>Define MK_XBUTTON2 for |CI$0040
36783>>>>>>>>>
36783>>>>>>>>>Enum_List // Mouse Key Flags
36783>>>>>>>>>    Define mkLeft    for MK_LBUTTON
36783>>>>>>>>>    Define mkMiddle  for MK_MBUTTON
36783>>>>>>>>>    Define mkRight   for MK_RBUTTON
36783>>>>>>>>>    Define mkX1      for MK_XBUTTON1
36783>>>>>>>>>    Define mkX2      for MK_XBUTTON2
36783>>>>>>>>>    Define mkShift   for MK_SHIFT
36783>>>>>>>>>    Define mkControl for MK_CONTROL
36783>>>>>>>>>End_Enum_List
36783>>>>>>>>>
36783>>>>>>>>>Enum_List // Mouse Buttons. Used in OnMouseXXX messages
36783>>>>>>>>>    Define mbLeft
36783>>>>>>>>>    Define mbMiddle
36783>>>>>>>>>    Define mbRight
36783>>>>>>>>>    Define mbX1
36783>>>>>>>>>    Define mbX2
36783>>>>>>>>>End_Enum_List
36783>>>>>>>>>
36783>>>>>>>>>Class cWinControl is a DfBaseControl
36784>>>>>>>>>    Procedure Construct_Object
36786>>>>>>>>>        Forward Send Construct_Object
36788>>>>>>>>>        Property Integer private_pbEnabled True
36789>>>>>>>>>        Property Integer private_pbVisible True
36790>>>>>>>>>    End_Procedure
36791>>>>>>>>>
36791>>>>>>>>>    Procedure End_Construct_Object
36793>>>>>>>>>        Forward Send End_Construct_Object
36795>>>>>>>>>
36795>>>>>>>>>        Set External_Message WM_LBUTTONDOWN   To msg_OnWmLButtonDown
36796>>>>>>>>>        Set External_Message WM_MBUTTONDOWN   To msg_OnWmMButtonDown
36797>>>>>>>>>        Set External_Message WM_RBUTTONDOWN   To msg_OnWmRButtonDown
36798>>>>>>>>>        Set External_Message WM_LBUTTONUP     To msg_OnWmLButtonUp
36799>>>>>>>>>        Set External_Message WM_MBUTTONUP     To msg_OnWmMButtonUp
36800>>>>>>>>>        Set External_Message WM_RBUTTONUP     To msg_OnWmRButtonUp
36801>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK To msg_OnWmLButtonDblClk
36802>>>>>>>>>        Set External_Message WM_MBUTTONDBLCLK To msg_OnWmMButtonDblClk
36803>>>>>>>>>        Set External_Message WM_RBUTTONDBLCLK To msg_OnWmRButtonDblClk
36804>>>>>>>>>        Set External_Message WM_MOUSEMOVE     To msg_OnWmMouseMove
36805>>>>>>>>>    End_Procedure
36806>>>>>>>>>
36806>>>>>>>>>    Procedure Notify Integer wParam Integer lParam
36808>>>>>>>>>        //Intentionally cancelled
36808>>>>>>>>>    End_Procedure
36809>>>>>>>>>
36809>>>>>>>>>    Procedure Command Integer wParam Integer lParam
36811>>>>>>>>>        //Intentionally cancelled
36811>>>>>>>>>    End_Procedure
36812>>>>>>>>>
36812>>>>>>>>>    Procedure DoRecreateWindow
36814>>>>>>>>>        // Recreates the window
36814>>>>>>>>>        If (Window_Handle(self)) Begin
36816>>>>>>>>>            // attempt to do this without disturbing the focus tree.
36816>>>>>>>>>            Send Page_delete // prior to 8.3 this was Send Page_Object 0
36817>>>>>>>>>            Send Page 1      //                       Send Page_Object 1
36818>>>>>>>>>        End
36818>>>>>>>>>>
36818>>>>>>>>>    End_Procedure
36819>>>>>>>>>
36819>>>>>>>>>    Procedure DoUpdateWindow
36821>>>>>>>>>        // Forces windows to update the window by bypassing WM_PAINT
36821>>>>>>>>>        Handle hWnd
36821>>>>>>>>>
36821>>>>>>>>>        Get Window_Handle To hWnd
36822>>>>>>>>>        If hWnd Move (UpdateWindow(hWnd)) To hWnd
36825>>>>>>>>>    End_Procedure
36826>>>>>>>>>
36826>>>>>>>>>    Procedure Page Integer iState
36828>>>>>>>>>        Set Window_Style To WS_DISABLED (private_pbEnabled(self) =False)
36829>>>>>>>>>        Set Window_Style To WS_VISIBLE (private_pbVisible(self))
36830>>>>>>>>>        Forward Send Page iState
36832>>>>>>>>>    End_Procedure
36833>>>>>>>>>
36833>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
36835>>>>>>>>>        Integer x y eButton
36835>>>>>>>>>
36835>>>>>>>>>        Move (Hi(lParam))  To y
36836>>>>>>>>>        Move (Low(lParam)) To x
36837>>>>>>>>>
36837>>>>>>>>>        Send OnMouseUp mbLeft x y wParam
36838>>>>>>>>>    End_Procedure
36839>>>>>>>>>
36839>>>>>>>>>    Procedure OnWmMButtonUp Integer wParam Integer lParam
36841>>>>>>>>>        Integer x y eButton
36841>>>>>>>>>
36841>>>>>>>>>        Move (Hi(lParam))  To y
36842>>>>>>>>>        Move (Low(lParam)) To x
36843>>>>>>>>>
36843>>>>>>>>>        Send OnMouseUp mbMiddle x y wParam
36844>>>>>>>>>    End_Procedure
36845>>>>>>>>>
36845>>>>>>>>>    Procedure OnWmRButtonUp Integer wParam Integer lParam
36847>>>>>>>>>        Integer x y eButton
36847>>>>>>>>>
36847>>>>>>>>>        Move (Hi(lParam))  To y
36848>>>>>>>>>        Move (Low(lParam)) To x
36849>>>>>>>>>
36849>>>>>>>>>        Send OnMouseUp mbRight x y wParam
36850>>>>>>>>>    End_Procedure
36851>>>>>>>>>
36851>>>>>>>>>    Procedure OnWmLButtonDown Integer wParam Integer lParam
36853>>>>>>>>>        Integer x y eButton fKeys
36853>>>>>>>>>
36853>>>>>>>>>        Move (Hi(lParam))  To y
36854>>>>>>>>>        Move (Low(lParam)) To x
36855>>>>>>>>>
36855>>>>>>>>>        Send OnMouseDown mbLeft x y wParam
36856>>>>>>>>>    End_Procedure
36857>>>>>>>>>    Procedure OnWmMButtonDown Integer wParam Integer lParam
36859>>>>>>>>>        Integer x y eButton
36859>>>>>>>>>
36859>>>>>>>>>        Move (Hi(lParam))  To y
36860>>>>>>>>>        Move (Low(lParam)) To x
36861>>>>>>>>>
36861>>>>>>>>>        Send OnMouseDown mbMiddle x y wParam
36862>>>>>>>>>    End_Procedure
36863>>>>>>>>>    Procedure OnWmRButtonDown Integer wParam Integer lParam
36865>>>>>>>>>        Integer x y eButton
36865>>>>>>>>>
36865>>>>>>>>>        Move (Hi(lParam))  To y
36866>>>>>>>>>        Move (Low(lParam)) To x
36867>>>>>>>>>
36867>>>>>>>>>        Send OnMouseDown mbRight x y wParam
36868>>>>>>>>>    End_Procedure
36869>>>>>>>>>
36869>>>>>>>>>    Procedure OnWmLButtonDblClk Integer wParam Integer lParam
36871>>>>>>>>>        Integer x y eButton
36871>>>>>>>>>
36871>>>>>>>>>        Move (Hi(lParam))  To y
36872>>>>>>>>>        Move (Low(lParam)) To x
36873>>>>>>>>>
36873>>>>>>>>>        Send OnMouseDoubleClick mbLeft x y wParam
36874>>>>>>>>>    End_Procedure
36875>>>>>>>>>    Procedure OnWmMButtonDblClk Integer wParam Integer lParam
36877>>>>>>>>>        Integer x y eButton
36877>>>>>>>>>
36877>>>>>>>>>        Move (Hi(lParam))  To y
36878>>>>>>>>>        Move (Low(lParam)) To x
36879>>>>>>>>>
36879>>>>>>>>>        Send OnMouseDoubleClick mbMiddle x y wParam
36880>>>>>>>>>    End_Procedure
36881>>>>>>>>>    Procedure OnWmRButtonDblClk Integer wParam Integer lParam
36883>>>>>>>>>        Integer x y eButton
36883>>>>>>>>>
36883>>>>>>>>>        Move (Hi(lParam))  To y
36884>>>>>>>>>        Move (Low(lParam)) To x
36885>>>>>>>>>
36885>>>>>>>>>        Send OnMouseDoubleClick mbRight x y wParam
36886>>>>>>>>>    End_Procedure
36887>>>>>>>>>
36887>>>>>>>>>    Procedure OnWmMouseMove Integer wParam Integer lParam
36889>>>>>>>>>        Integer x y eButton
36889>>>>>>>>>
36889>>>>>>>>>        Move (Hi(lParam))  To y
36890>>>>>>>>>        Move (Low(lParam)) To x
36891>>>>>>>>>
36891>>>>>>>>>        Send OnMouseMove x y wParam
36892>>>>>>>>>    End_Procedure
36893>>>>>>>>>
36893>>>>>>>>>    Procedure OnMouseDown Integer eButton Integer x Integer y Integer fKeys
36895>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
36895>>>>>>>>>        //String sButton
36895>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
36895>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
36895>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
36895>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
36895>>>>>>>>>
36895>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
36895>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
36895>>>>>>>>>        //Showln 'OnMouseDown ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
36895>>>>>>>>>    End_Procedure
36896>>>>>>>>>
36896>>>>>>>>>    Procedure OnMouseUp Integer eButton Integer x Integer y Integer fKeys
36898>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
36898>>>>>>>>>        //String sButton
36898>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
36898>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
36898>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
36898>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
36898>>>>>>>>>
36898>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
36898>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
36898>>>>>>>>>        //Showln 'OnMouseUp ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
36898>>>>>>>>>    End_Procedure
36899>>>>>>>>>
36899>>>>>>>>>    Procedure OnMouseDoubleClick Integer eButton Integer x Integer y Integer fKeys
36901>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
36901>>>>>>>>>        //String sButton
36901>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
36901>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
36901>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
36901>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
36901>>>>>>>>>
36901>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
36901>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
36901>>>>>>>>>        //Showln 'OnMouseDblClk ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
36901>>>>>>>>>    End_Procedure
36902>>>>>>>>>
36902>>>>>>>>>    Procedure OnMouseMove Integer x Integer y Integer fKeys
36904>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
36904>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
36904>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
36904>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
36904>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
36904>>>>>>>>>
36904>>>>>>>>>        //Showln 'OnMouseMove ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
36904>>>>>>>>>    End_Procedure
36905>>>>>>>>>
36905>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
36907>>>>>>>>>        Handle hWnd
36907>>>>>>>>>
36907>>>>>>>>>        If (bEnabled <> private_pbEnabled(self)) Begin
36909>>>>>>>>>            Set private_pbEnabled To bEnabled
36910>>>>>>>>>            Get Window_Handle to hWnd
36911>>>>>>>>>            If hWnd Move (EnableWindow(hWnd, bEnabled)) To hWnd
36914>>>>>>>>>        End
36914>>>>>>>>>>
36914>>>>>>>>>    End_Procedure
36915>>>>>>>>>    Function pbEnabled Returns Boolean
36917>>>>>>>>>        Function_Return (private_pbEnabled(self))
36918>>>>>>>>>    End_Function
36919>>>>>>>>>
36919>>>>>>>>>    Procedure Set pbVisible Boolean bVisible
36921>>>>>>>>>        Handle  hWnd
36921>>>>>>>>>        Integer iVoid
36921>>>>>>>>>
36921>>>>>>>>>        If (bVisible <> private_pbVisible(self)) Begin
36923>>>>>>>>>            Set private_pbVisible To bVisible
36924>>>>>>>>>            Get Window_Handle to hWnd
36925>>>>>>>>>            If hWnd Move (ShowWindow(hWnd, If (bVisible, SW_SHOWNA, SW_HIDE))) To iVoid
36928>>>>>>>>>        End
36928>>>>>>>>>>
36928>>>>>>>>>    End_Procedure
36929>>>>>>>>>    Function pbVisible Returns Boolean
36931>>>>>>>>>        Function_Return (private_pbVisible(self))
36932>>>>>>>>>    End_Function
36933>>>>>>>>>
36933>>>>>>>>>End_Class
36934>>>>>>>Use CommCtrl.pkg
36934>>>>>>>
36934>>>>>>>Type tPbRange
36934>>>>>>>    Field tPbRange.iLow  as DWord
36934>>>>>>>    Field tPbRange.iHigh as DWord
36934>>>>>>>End_Type
36934>>>>>>>
36934>>>>>>>//{ OverrideProperty=pbEnabled DesignTime=False }
36934>>>>>>>Class cProgressBar is a cWinControl
36935>>>>>>>
36935>>>>>>>    Procedure Construct_Object
36937>>>>>>>        Forward Send Construct_Object
36939>>>>>>>        Property Integer private_piMinimum
36940>>>>>>>        Property Integer private_piMaximum   100
36941>>>>>>>        Property Integer private_piAdvanceBy 10
36942>>>>>>>        Property Integer private_piPosition
36943>>>>>>>        Property Integer private_pbVertical  False
36944>>>>>>>        Property Integer private_pbSmooth    False
36945>>>>>>>        Property Integer private_piBackColor clDefault
36946>>>>>>>        Property Integer private_piBarColor  clDefault
36947>>>>>>>
36947>>>>>>>        Send Define_ToolTip_Support_Mixin
36948>>>>>>>
36948>>>>>>>        Set External_Class_Name 'cVdfProgressBar' To 'msctls_progress32'
36949>>>>>>>        Set Focus_Mode to NonFocusable
36950>>>>>>>        Set Skip_State to True
36951>>>>>>>        Set pbUseFormWindowHandle to False     // Must come after Define_ToolTip_Support_Mixin
36952>>>>>>>    End_Procedure
36953>>>>>>>
36953>>>>>>>    Import_Class_Protocol ToolTip_Support_Mixin
36954>>>>>>>
36954>>>>>>>    Procedure Set piMinimum Integer iMin
36956>>>>>>>        Integer iMax
36956>>>>>>>
36956>>>>>>>        Set private_piMinimum to iMin
36957>>>>>>>        Get private_piMaximum To iMax
36958>>>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
36959>>>>>>>    End_Procedure
36960>>>>>>>    Function piMinimum Returns Integer
36962>>>>>>>        If (Window_Handle(self)) Function_Return (WindowsMessage(PBM_GETRANGE, 1, 0))
36965>>>>>>>        Else Function_Return (private_piMinimum(self))
36967>>>>>>>    End_Function
36968>>>>>>>
36968>>>>>>>    Procedure Set piMaximum Integer iMax
36970>>>>>>>        Integer iMin
36970>>>>>>>
36970>>>>>>>        Set private_piMaximum to iMax
36971>>>>>>>        Get private_piMinimum To iMin
36972>>>>>>>        Send Windows_Message PBM_SETRANGE32 iMin iMax
36973>>>>>>>    End_Procedure
36974>>>>>>>    Function piMaximum Returns Integer
36976>>>>>>>        If (Window_Handle(self)) Function_Return (WindowsMessage(PBM_GETRANGE, 0, 0))
36979>>>>>>>        Else Function_Return (private_piMaximum(self))
36981>>>>>>>    End_Function
36982>>>>>>>
36982>>>>>>>    Procedure Set piAdvanceBy Integer iAdvanceBy
36984>>>>>>>        Set private_piAdvanceBy To iAdvanceBy
36985>>>>>>>        Send Windows_Message PBM_SETSTEP iAdvanceBy 0
36986>>>>>>>    End_Procedure
36987>>>>>>>    Function piAdvanceBy Returns Integer
36989>>>>>>>        Function_Return (private_piAdvanceBy(self))
36990>>>>>>>    End_Function
36991>>>>>>>
36991>>>>>>>    Procedure Set piPosition Integer iPos
36993>>>>>>>        Set private_piPosition To iPos
36994>>>>>>>        Send Windows_Message PBM_SETPOS iPos 0
36995>>>>>>>    End_Procedure
36996>>>>>>>
36996>>>>>>>    Function piPosition Returns Integer
36998>>>>>>>        If (Window_Handle(self)) Function_Return (WindowsMessage(PBM_GETPOS, 0, 0))
37001>>>>>>>        Else Function_Return (private_piPosition(self))
37003>>>>>>>    End_Function
37004>>>>>>>
37004>>>>>>>    Procedure Set pbVertical Boolean bVertical
37006>>>>>>>        If (private_pbVertical(self) <> bVertical) Begin
37008>>>>>>>            Set private_pbVertical To bVertical
37009>>>>>>>           Send DoRecreateWindow
37010>>>>>>>        End
37010>>>>>>>>
37010>>>>>>>    End_Procedure
37011>>>>>>>
37011>>>>>>>    Function pbVertical Returns Boolean
37013>>>>>>>        Function_Return (private_pbVertical(self))
37014>>>>>>>    End_Function
37015>>>>>>>
37015>>>>>>>    Procedure Set pbSmooth Boolean bSmooth
37017>>>>>>>        If (private_pbSmooth(self) <> bSmooth) Begin
37019>>>>>>>           Set private_pbSmooth To bSmooth
37020>>>>>>>           Send DoRecreateWindow
37021>>>>>>>        End
37021>>>>>>>>
37021>>>>>>>    End_Procedure
37022>>>>>>>    Function pbSmooth Returns Boolean
37024>>>>>>>        Function_Return (private_pbSmooth(self))
37025>>>>>>>    End_Function
37026>>>>>>>
37026>>>>>>>    Procedure Set piBackColor Integer rgbColor
37028>>>>>>>        Set private_piBackColor To rgbColor
37029>>>>>>>        Send Windows_Message PBM_SETBKCOLOR 0 rgbColor
37030>>>>>>>    End_Procedure
37031>>>>>>>    Function piBackColor Returns Integer
37033>>>>>>>        Function_Return (private_piBackColor(self))
37034>>>>>>>    End_Function
37035>>>>>>>
37035>>>>>>>    Procedure Set piBarColor Integer rgbColor
37037>>>>>>>        Set private_piBarColor To rgbColor
37038>>>>>>>        Send Windows_Message PBM_SETBARCOLOR 0 rgbColor
37039>>>>>>>    End_Procedure
37040>>>>>>>    Function piBarColor Returns Integer
37042>>>>>>>        Function_Return (private_piBarColor(self))
37043>>>>>>>    End_Function
37044>>>>>>>
37044>>>>>>>    Procedure DoAdvance
37046>>>>>>>        Send Windows_Message PBM_STEPIT 0 0
37047>>>>>>>    End_procedure
37048>>>>>>>
37048>>>>>>>    Procedure DoAdvanceBy  Integer iAdvanceBy
37050>>>>>>>        Send Windows_Message PBM_DELTAPOS iAdvanceBy 0
37051>>>>>>>    End_procedure
37052>>>>>>>
37052>>>>>>>    Procedure private_DoInitWindow
37054>>>>>>>        Set piBarColor  To (private_piBarColor(self))
37055>>>>>>>        Set piBackColor To (private_piBackColor(self))
37056>>>>>>>        Set piAdvanceBy To (private_piAdvanceBy(self))
37057>>>>>>>        Set piMinimum   To (private_piMinimum(self))
37058>>>>>>>        Set piMaximum   To (private_piMaximum(self))
37059>>>>>>>        Set piPosition  To (private_piPosition(self))
37060>>>>>>>    End_Procedure
37061>>>>>>>
37061>>>>>>>    Procedure Page_Object Integer iState
37063>>>>>>>        Handle hWnd
37063>>>>>>>
37063>>>>>>>        Get Window_Handle To hWnd
37064>>>>>>>        If (hWnd=0 and iState) Begin
37066>>>>>>>            Set Window_Style To PBS_VERTICAL (private_pbVertical(self))
37067>>>>>>>            Set Window_Style To PBS_SMOOTH   (private_pbSmooth(self))
37068>>>>>>>            Forward Send Page_Object True
37070>>>>>>>        End
37070>>>>>>>>
37070>>>>>>>        Else Forward Send Page_Object iState
37073>>>>>>>     
37073>>>>>>>        // Handle tooltip support....
37073>>>>>>>        If (iState = 0) Begin
37075>>>>>>>            Send RequestDeleteToolTip
37076>>>>>>>        End 
37076>>>>>>>>
37076>>>>>>>        Else Begin
37077>>>>>>>            Send RequestAddToolTip
37078>>>>>>>        End
37078>>>>>>>>
37078>>>>>>>    End_Procedure
37079>>>>>>>
37079>>>>>>>    Procedure Page Integer iState
37081>>>>>>>        Forward Send Page iState
37083>>>>>>>        If (iState =1) Send private_DoInitWindow
37086>>>>>>>    End_Procedure
37087>>>>>>>
37087>>>>>>>    // Called by Page_Object. Handles tooltip creation. We use a dedicated
37087>>>>>>>    // method to perform AddToolTip because it is often the case that Page_Object
37087>>>>>>>    // is implemented in a mixin class.
37087>>>>>>>    Procedure RequestAddToolTip
37089>>>>>>>        Send AddToolTip
37090>>>>>>>    End_Procedure  // RequestAddToolTip
37091>>>>>>>
37091>>>>>>>
37091>>>>>>>    // Called by Page_Object. Handles tooltip removal. 
37091>>>>>>>    Procedure RequestDeleteToolTip
37093>>>>>>>        Send DeleteToolTip
37094>>>>>>>    End_Procedure // RequestDeleteToolTip
37095>>>>>>>End_Class
37096>>>>>Use Windows.pkg
37096>>>>>
37096>>>>>
37096>>>>>    Global_Variable Handle ghoProgressBar // will contain the ID of the embedded progress bar.
37096>>>>>
37096>>>>>    Global_Variable Handle ghoProgressBarOverall // will contain the ID of the embedded progress bar with overall results
37096>>>>>
37096>>>>>Object Status_Panel is a cProcessStatusPanel
37098>>>>>    Set Size to 148 222
37099>>>>>    Set Border_Style to Border_Dialog
37100>>>>>//    Set Sysmenu_Icon to False
37100>>>>>//    Set Icon to "DbUpdateFrameworkdf19.ico" 
37100>>>>>    Set Icon to "Default.ico"
37101>>>>>    Move Self to ghoStatusPanel // this can be used throughout the applicaton to access this object
37102>>>>>
37102>>>>>    Property Boolean Cancel_Button_Visible_State True
37104>>>>>
37104>>>>>    Procedure Activate
37107>>>>>        Integer iSizeBefore
37107>>>>>        Get GuiSize to iSizeBefore
37108>>>>>        Forward Send Activate
37110>>>>>        Set GuiSize to (Hi(iSizeBefore)) (Low(iSizeBefore))
37111>>>>>    End_Procedure
37112>>>>>
37112>>>>>    Procedure End_Construct_Object
37115>>>>>        Forward Send End_Construct_Object
37117>>>>>        Set Label of oTitleTxt      to ""
37118>>>>>        Set Label of oTableNameTxt  to ""
37119>>>>>        Set Label of oMessageTxt    to ""
37120>>>>>        Set Label of oActionTxt     to ""
37121>>>>>    End_Procedure
37122>>>>>
37122>>>>>    Object oTitleTxt is a TextBox
37124>>>>>        Set Location to 5 21
37125>>>>>        Set Size to 8 179
37126>>>>>        Set Auto_Size_State to False
37127>>>>>        Set Justification_Mode  to jMode_Center
37128>>>>>        Set Label to "This is the Title Text"
37129>>>>>    End_Object
37130>>>>>
37130>>>>>    Object oTableNameTxt is a TextBox
37132>>>>>        Set Size to 19 204
37133>>>>>        Set Location to 18 9
37134>>>>>        Set Auto_Size_State to False
37135>>>>>        Set Justification_Mode to JMode_Left
37136>>>>>        Set Label to "This is the TableName Text"
37137>>>>>    End_Object
37138>>>>>
37138>>>>>    Object oMessageTxt is a TextBox
37140>>>>>        Set Location to 39 9
37141>>>>>        Set Size to 19 204
37142>>>>>        Set Auto_Size_State to False
37143>>>>>        Set Justification_Mode to JMode_Left
37144>>>>>        Set Label to "This is the Message text"
37145>>>>>    End_Object
37146>>>>>
37146>>>>>    Object oActionTxt is a TextBox
37148>>>>>        Set Size to 16 204
37149>>>>>        Set Location to 60 9
37150>>>>>        Set Auto_Size_State to False
37151>>>>>        Set Justification_Mode to JMode_Left
37152>>>>>        Set Label to "This is the Action Text"
37153>>>>>    End_Object
37154>>>>>
37154>>>>>    Object oStopButton is a Button
37156>>>>>        Set Location to 120 82
37157>>>>>        Set Label to C_$Cancel
37158>>>>>
37158>>>>>        Procedure OnClick
37161>>>>>            Send Close_panel
37162>>>>>        End_Procedure
37163>>>>>
37163>>>>>    End_Object
37164>>>>>
37164>>>>>    Object oPercentage_tb is a TextBox
37166>>>>>        Set Location to 74 196
37167>>>>>        Set Size to 10 25
37168>>>>>//        Set Label to "% Done"
37168>>>>>    End_Object
37169>>>>>
37169>>>>>    Object oCopyRight is a TextBox
37171>>>>>        Set Location to 137 21
37172>>>>>        Set Size to 9 197
37173>>>>>        Set FontPointHeight to 8
37174>>>>>        Set Auto_Size_State to False
37175>>>>>        Set Justification_Mode  to jMode_Center
37176>>>>>        Set Label to "Copyright 2001-2018 RDC Tools International"
37177>>>>>    End_Object
37178>>>>>
37178>>>>>    Object oProgressBar is a cProgressBar
37180>>>>>        Set Size to 10 179
37181>>>>>        Set Location to 83 22
37182>>>>>        Set pbVisible to True // default
37183>>>>>        Move Self to ghoProgressBar // this can be used throughout your application to access the progress bar
37184>>>>>    End_Object
37185>>>>>
37185>>>>>    Procedure Set Progress_Bar_Visible_State Boolean bVisible
37188>>>>>        Set pbVisible of ghoProgressBar to bVisible
37189>>>>>    End_Procedure
37190>>>>>
37190>>>>>    Function Progress_Bar_Visible_State Returns Boolean
37193>>>>>        Boolean bVisible
37193>>>>>        Get pbVisible of ghoProgressBar to bVisible
37194>>>>>        Function_Return (bVisible)
37195>>>>>    End_Function
37196>>>>>
37196>>>>>    Object oProgressBarOverall is a cProgressBar
37198>>>>>        Set Size to 10 179
37199>>>>>        Set Location to 104 22
37200>>>>>        Set pbVisible to True // default
37201>>>>>        Move Self to ghoProgressBarOverall // this can be used throughout your application to access the progress bar
37202>>>>>    End_Object
37203>>>>>
37203>>>>>    Object oOverallProgress_tb is a TextBox
37205>>>>>        Set Size to 10 65
37206>>>>>        Set Location to 95 24
37207>>>>>        Set Label to "Overall Progress"
37208>>>>>    End_Object
37209>>>>>
37209>>>>>    Procedure Set Progress_Bar_Overall_Visible_State Boolean bVisible
37212>>>>>        Set pbVisible of ghoProgressBarOverall to bVisible
37213>>>>>    End_Procedure
37214>>>>>
37214>>>>>    Function Progress_Bar_Overall_Visible_State Returns Boolean
37217>>>>>        Boolean bVisible
37217>>>>>        Get pbVisible of ghoProgressBarOverall to bVisible
37218>>>>>        Function_Return (bVisible)
37219>>>>>    End_Function
37220>>>>>
37220>>>>>    // These messages bind the standard cProcessStatusPanel interface to the actual
37220>>>>>    // objects defined within this instance of the status panel.
37220>>>>>
37220>>>>>    // note: all of the messages that change text should be forwarded
37220>>>>>    // as the forwarded messages allows the panel to paint when in a tight loop
37220>>>>>
37220>>>>>    Procedure Set Message_Text String sText
37223>>>>>        Set Label of oMessageTxt to sText
37224>>>>>        Forward Set Message_Text to sText
37226>>>>>    End_Procedure
37227>>>>>
37227>>>>>    Function Message_Text Returns String
37230>>>>>        Function_Return (Label(oMessageTxt))
37231>>>>>    End_Function
37232>>>>>
37232>>>>>    Procedure Set Action_Text String sText
37235>>>>>        Set Label of oActionTxt to sText
37236>>>>>        Forward Set Action_Text to sText
37238>>>>>    End_Procedure
37239>>>>>
37239>>>>>    Function Action_Text Returns String
37242>>>>>        Function_Return (Label(oActionTxt))
37243>>>>>    End_Function
37244>>>>>
37244>>>>>    Procedure Set Button_Text String sText
37247>>>>>        Set Label of oStopButton to sText
37248>>>>>        Forward Set Button_Text to sText
37250>>>>>    End_Procedure
37251>>>>>
37251>>>>>    Function Button_Text Returns String
37254>>>>>        Function_Return (Label(oStopButton))
37255>>>>>    End_Function
37256>>>>>
37256>>>>>    Procedure Set Title_Text String sText
37259>>>>>        Set Label of oTitleTxt to sText
37260>>>>>        Forward Set Title_Text to sText
37262>>>>>    End_Procedure
37263>>>>>
37263>>>>>    Function Title_Text Returns String
37266>>>>>        Function_Return (Label(oTitleTxt))
37267>>>>>    End_Function
37268>>>>>
37268>>>>>    Procedure Set TableName_Text String sText
37271>>>>>        Set Label of oTableNameTxt to sText
37272>>>>>    End_Procedure
37273>>>>>
37273>>>>>    Function TableName_Text Returns String
37276>>>>>        Function_Return (Label(oTableNameTxt))
37277>>>>>    End_Function
37278>>>>>
37278>>>>>    Procedure Set License_Text String sText
37281>>>>>//        Set Label of oLicense_txt to sText
37281>>>>>    End_Procedure
37282>>>>>
37282>>>>>    // gets called when status panel is activated passing whether a button
37282>>>>>    // should appear
37282>>>>>    Procedure EnableCancelButton Boolean bEnable
37285>>>>>        Boolean bVisible
37285>>>>>        Get Cancel_Button_Visible_State to bVisible
37286>>>>>        If (bEnable = False) Begin
37288>>>>>            Set Visible_State of oStopButton to bVisible
37289>>>>>        End
37289>>>>>>
37289>>>>>        Set Enabled_State of oStopButton to bEnable
37290>>>>>    End_Procedure
37291>>>>>
37291>>>>>    Procedure Reset_StatusPanel
37294>>>>>        Set Allow_Cancel_State of ghoStatusPanel to True
37295>>>>>        Set Cancel_Button_Visible_State of ghoStatusPanel to True
37296>>>>>        Set Progress_Bar_Visible_State  of ghoStatusPanel to True
37297>>>>>        Set Progress_Bar_Overall_Visible_State of ghoProgressBarOverall to False
37298>>>>>    End_Procedure
37299>>>>>
37299>>>>>//    Object oProgressBar is a cProgressBar
37299>>>>>//        Move Self to ghoProgressBar
37299>>>>>//        Set Location to 1 25
37299>>>>>//        Set Size to 9 173
37299>>>>>//        Set piMinimum        to 0
37299>>>>>//        Set piMaximum        to 2000
37299>>>>>//        Set piAdvanceBy      to 100
37299>>>>>//        Set pbSmooth to True
37299>>>>>//
37299>>>>>//        // For some weird reason the application skin makes the coloring of the progressbar
37299>>>>>//        // to malfunction. By telling the CodeJock SkinFramework to skip this object, the
37299>>>>>//        // color will show correctly.
37299>>>>>//        Procedure Page Integer iPageObject
37299>>>>>//            Handle hWin
37299>>>>>//            Forward Send Page iPageObject
37299>>>>>//            If (ghoSkinFramework <> 0) Begin
37299>>>>>//                Get Window_Handle to hWin
37299>>>>>//                Send ComRemoveWindow of ghoSkinFramework hWin
37299>>>>>//            End
37299>>>>>//        End_Procedure
37299>>>>>//    End_Object
37299>>>>>
37299>>>>>End_Object
37300>>>>>
37300>>>Use cDbUpdateFunctionLibrary.inc        // Various constant definitions, structs etc.
Including file: cDbUpdateFunctionLibrary.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cDbUpdateFunctionLibrary.inc)
37300>>>>>Use DUFLanguageConstants.inc
Including file: DUFLanguageConstants.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\DUFLanguageConstants.inc)
37300>>>>>>>//
37300>>>>>>>// *** The Database Update Framework Include file ***
37300>>>>>>>// Language constant declarations for all classes included in "DUF - The Database Update Framework"
37300>>>>>>>// They have all been placed in this central spot to make translations to various languages more convenient.
37300>>>>>>>//
37300>>>>>>>//
37300>>>>>>>Use LanguageText.Pkg
37300>>>>>>>
37300>>>>>>>// *** cSQLConnectionsIniFile Class Language Constants ***
37300>>>>>>>//
37300>>>>>>>    Define CS_DUF_DuplicateConnectionIDPre  for "Cannot register connection ID"
37300>>>>>>>    Define CS_DUF_DuplicateConnectionIDPost for "This ID already exists."
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>// *** cSQLConnectionsHandler Class Language Constants ***
37300>>>>>>>//
37300>>>>>>>    Define CS_DUF_SetupErrorcConnection  for "Cannot login to the database server as the cConnection hasn't been setup properly. Can't continue. Program will now exit."
37300>>>>>>>    Define CS_DUF_CannotLoginToServer    for "Could not login to the database server. Can't continue. Program will now exit."
37300>>>>>>>    Define CS_DUF_ErrorText              for "\n\nError Text:"
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>// *** cDbUpdateFunctionLibrary Class Language Constants ***
37300>>>>>>>//
37300>>>>>>>    Define CS_SQLConnectError       for "SQL error. Could not connect to the SQL database manager"
37300>>>>>>>    Define CS_SQLAttachError        for "Could not attach to the database:"
37300>>>>>>>    Define CS_SQLDeletingIndex      for "Deleting index"
37300>>>>>>>    Define CS_SQLCopyingData        for "Copying data"
37300>>>>>>>    Define CS_SQLCreatingIndex      for "Creating index"
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>// *** cDbUpdateVersion Class Language Constants ***
37300>>>>>>>//
37300>>>>>>>    Define CS_UpdateVersion     for "Updating database"
37300>>>>>>>    Define CS_UpdateFromVersion for "from version"
37300>>>>>>>    Define CS_UpdateToVersion   for "to version:"
37300>>>>>>>    Define CS_DbUpdateTableMissing for "Cannot open the 'DbVersion' table that is used when updating the database! Cannot continue!"
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>// *** cDbUpdateHandler.inc Class Language Constants ***
37300>>>>>>>//
37300>>>>>>>    Define CS_DatabaseInUseShort  for "There are others using the application/database. Are you sure you still want to update the database?"
37300>>>>>>>    Define CS_DatabaseNeedsUpdate for ("The database needs to be updated." + "\n\nATTENTION! The database may not be in use while this work is performed. Make sure that nobody else is using the application before clicking 'Yes' below.\n\n" + "Start update now?")
37300>>>>>>>    Define CS_HeaderUpdateText    for "Important!"
37300>>>>>>>    Define CS_DatabaseInUseText   for "There are others using the application/database or at least one table could NOT be opened exclusively. Please close all other applications using the database and try again. The Application will now close."
37300>>>>>>>    Define CS_WorkingHeaderText   for "Working!"
37300>>>>>>>    Define CS_WorkingUpdateText   for "The database is being updated. Please wait..."
37300>>>>>>>    Define CS_DatabaseUpdatedText for "Ready! The database was updated."
37300>>>>>>>    Define CS_DatabaseCheckedText for "Ready! The database was checked but no updates was needed."
37300>>>>>>>    Define CS_DbUpdatedErrorText  for "One or more errors occured while the database was updated. Please check the logfile.\n\nThe program will now close."
37300>>>>>>>    Define CS_UpdateInProgressTxt for ("System locked!\n\nThe database is being updated. Please try again later...\n\n" * "The program will now close.")
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>>>
37300>>>>>
37300>>>>>Register_Function paSQLQueryMessages Returns String[]
37300>>>>>Register_Procedure Set paSQLQueryMessages String[] aSQLQueryMessages
37300>>>>>
37300>>>>>// Global handle to a cDatabaseUpdateHandler object
37300>>>>>    Global_Variable Handle ghoDbUpdateHandler
37300>>>>>
37300>>>>>    Define CS_DatabaseUpdateFramework for " ***  The Database Update Framework (DUF) ***"
37300>>>>>
37300>>>>>    Define DATAFLEX_ID for "DATAFLEX"
37300>>>>>
37300>>>>>    Define CS_OEM_Txt for "OEM"
37300>>>>>
37300>>>>>    Define CS_ANSI_Txt for "ANSI"
37300>>>>>
37300>>>>>    Define CS_DFCONNID for "DFCONNID"
37300>>>>>
37300>>>>>    Define CS_SERVER for "SERVER"
37300>>>>>
37300>>>>>    Define CS_SERVER_NAME for "SERVER_NAME"
37300>>>>>
37300>>>>>    Define CS_DRIVER_NAME for "DRIVER_NAME"
37300>>>>>
37300>>>>>    Define CS_DATABASE_NAME for "DATABASE_NAME"
37300>>>>>
37300>>>>>    Define CS_SCHEMA_NAME for "SCHEMA_NAME"
37300>>>>>
37300>>>>>    Define CS_TABLE_CHARACTER_FORMAT for "TABLE_CHARACTER_FORMAT"
37300>>>>>
37300>>>>>    Define CS_USE_DUMMY_ZERO_DATE for "USE_DUMMY_ZERO_DATE"
37300>>>>>
37300>>>>>    Define CS_SYSTEM_FILE for "SYSTEM_FILE"
37300>>>>>
37300>>>>>    Define CS_RECNUM_TABLE for "RECNUM_TABLE"
37300>>>>>
37300>>>>>    Define CS_PRIMARY_INDEX for "PRIMARY_INDEX"
37300>>>>>
37300>>>>>    Define CS_INDEX_NUMBER for "INDEX_NUMBER"
37300>>>>>
37300>>>>>    Define CS_INDEX_NAME for "INDEX_NAME"
37300>>>>>
37300>>>>>    Define CS_DUFLowestAllowedDateValue for "01/01/1753"
37300>>>>>    Define CS_DUFLowestSQLDateValue     for "1753-01-01"
37300>>>>>
37300>>>>>
37300>>>>>    Global_Variable Handle ghoDbUpdateFunctionLibrary
37300>>>>>
37300>>>>>Struct tSQLScriptArray
37300>>>>>    Boolean bError
37300>>>>>    Boolean bArgumentSizeChanged
37300>>>>>    Integer iOrgArgumentSize
37300>>>>>    String[] sSQLScriptArray
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tSqlErrorArray
37300>>>>>    String[]  sSqlErrorArray
37300>>>>>    String[]  sSqlStatementArray
37300>>>>>    Integer[] iSqlErrorArray
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tSqlColumnNew
37300>>>>>    String  sBaseColumnName
37300>>>>>    String  sBaseTableName
37300>>>>>    String  sLabel
37300>>>>>    Integer iSqlType
37300>>>>>    Integer iSize
37300>>>>>    Integer iPrecision
37300>>>>>    Integer iDFType
37300>>>>>    Integer iDFNativeType
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tColumnType
37300>>>>>    String  sSQLType
37300>>>>>    Integer iSQLType
37300>>>>>    Boolean bCanEditSize
37300>>>>>    Integer iDefaultSize
37300>>>>>    Integer iMinSize
37300>>>>>    Number  nMaxSize
37300>>>>>    String  sDataFlexType
37300>>>>>    Integer iDataFlexType
37300>>>>>    Boolean bNativeDataType
37300>>>>>    String  sPrecision
37300>>>>>End_Struct
37300>>>>>
37300>>>>>// Used to store/retreive SQL keywords in a struct array.
37300>>>>>// Various SQL back-ends can have slightly different
37300>>>>>// keywords.
37300>>>>>Struct tSQLKeyWords
37300>>>>>    Integer iSQLWord
37300>>>>>    Integer iSQLDbType
37300>>>>>    String  sSQLPhrase // Can be more than one word.
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tSQLRelation
37300>>>>>    Integer iFileNumber
37300>>>>>    Integer iFieldNumber
37300>>>>>    String  sFileName
37300>>>>>    String  sFieldName
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tSQLLoggedInUser
37300>>>>>    String sUser
37300>>>>>    String sProgram
37300>>>>>End_Struct
37300>>>>>
37300>>>>>// Used as a start for error handing. Used by Error_Report_Mode property
37300>>>>>Enumeration_List
37300>>>>>    Define DUF_ERROR_REPORT    // Report Error on screen
37300>>>>>    Define DUF_ERROR_NO_REPORT // Show no Error..
37300>>>>>End_Enumeration_List
37300>>>>>
37300>>>>>// SQL Back-ends (iSQLDbType in the tSQLKeywords struct).
37300>>>>>// They can have slightly different SQL keywords.
37300>>>>>// Note: If a new type is added to the list,
37300>>>>>//       the struct array xxx must be adjusted
37300>>>>>//       so that it is filled with all SQL
37300>>>>>//       keywords for that new type.
37300>>>>>Enum_List
37300>>>>>    Define EN_DbTypeMSSQL
37300>>>>>    Define EN_DbTypeMySQL
37300>>>>>    Define EN_DbTypeOracle
37300>>>>>    Define EN_DbTypeDB2
37300>>>>>    Define EN_DbTypePostgre
37300>>>>>    Define EN_DbTypeDataFlex // Embedded database.
37300>>>>>End_Enum_List
37300>>>>>
37300>>>>>// We need to have our "own" constants for the standard DataFlex data types.
37300>>>>>// These can be used with SQL functions such as e.g. SQLColumnAdd, instead
37300>>>>>// of using one of the driver specific integer constants such as e.g. "SQL_VARCHAR".
37300>>>>>Define CS_DbTypeMSSQL       for "Microsoft SQL Server"
37300>>>>>Define CS_DbTypeMySQL       for "MySQL"
37300>>>>>Define CS_DbTypeOracle      for "Oracle"
37300>>>>>Define CS_DbTypeDB2         for "IBM DB2"
37300>>>>>Define CS_DbTypePostgre     for "PostgreSQL"
37300>>>>>Define CS_DbTypeDataFlex    for "DataFlex Embedded"
37300>>>>>
37300>>>>>// We need to re-define the standard constants because several driver constants
37300>>>>>// have the same value and we need to be able to distinguish which data type to use when
37300>>>>>// e.g. creating a column with embedded SQL (ESQL).
37300>>>>>Enum_List
37300>>>>>    Define DF_ASCII_DUF     for -1500 // All of these are DF_xxx constant values - 1500
37300>>>>>    Define DF_BCD_DUF       for -1499
37300>>>>>    Define DF_DATE_DUF      for -1498
37300>>>>>    Define DF_TEXT_DUF      for -1495
37300>>>>>    Define DF_BINARY_DUF    for -1494
37300>>>>>    Define DF_DATETIME_DUF  for -1493
37300>>>>>End_Enum_List
37300>>>>>
37300>>>>>    Define SQL_TEXT for (DF_TEXT + 1024)
37300>>>>>
37300>>>>>Define SQL_CHARBIT          for (DF_BINARY + 1024)
37300>>>>>Define SQL_LONGVARCHARBIT   for (DF_BINARY + 1025)
37300>>>>>Define SQL_VARCHARBIT       for (DF_BINARY + 1026)
37300>>>>>
37300>>>>>// These are not defined pre DF 18:
37300>>>>>    Define SQL_VARCHARMAX for (-201)
37300>>>>>    Define SQL_TYPE_MONEY for (-204)
37300>>>>>    Define SQL_TYPE_SMALLMONEY for (-205)
37300>>>>>    Define SQL_TYPE_SMALLDATETIME for (-206)
37300>>>>>
37300>>>>>Struct tSQLIntTableInfo
37300>>>>>    String sDriverName
37300>>>>>    String sServerName
37300>>>>>    String sDatabaseName
37300>>>>>    String sSchemaName
37300>>>>>    Boolean bRecnumTable
37300>>>>>    Integer iPrimaryIndex
37300>>>>>    Integer iGenerateRecordIdMethod  // RIM_NONE, RIM_IDENTITY_COLUMN,  RIM_DISPENSER_TABLE, RIM_EXTERNAL
37300>>>>>    String sTableCharacterFormat
37300>>>>>    Boolean bUseDummyZeroDate
37300>>>>>    Integer iFileDummyUpdateColumn // Init value to -1 if not exists (value can be in range 1 - number of columns)
37300>>>>>    Integer iFileBlockSize         // Init value to -1 if not exists
37300>>>>>    Integer iFileMaxRowsFetched    // Init value to -1 if not exists
37300>>>>>    Integer iFileGetRidAfterCreate // Init value to -1. But is boolean!
37300>>>>>    Integer iFileJitBinding        // Init value to -1. But is boolean!
37300>>>>>    String sRefindAfterSave        // Yes or No (how to handle?)
37300>>>>>    String sSystemFile             // Yes or No (how to handle?)
37300>>>>>    String sFileIndexTablespace
37300>>>>>    String sFileLongTablespace
37300>>>>>    String sTableTablespace
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tSQLIntColumnInfo
37300>>>>>    Integer iFieldNumber
37300>>>>>    Integer iFieldIndex
37300>>>>>    Integer iFieldRelatedFile
37300>>>>>    Integer iFieldRelatedField
37300>>>>>    Integer iIndexNumber
37300>>>>>    Integer iIndexNumberSegments
37300>>>>>    Integer iIndexSegmentField1
37300>>>>>    Integer iIndexSegmentField2
37300>>>>>    Integer iIndexSegmentFieldn
37300>>>>>    String  sIndexName
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIColumn
37300>>>>>    Integer iFieldNumber
37300>>>>>    String  sFieldName
37300>>>>>    Integer iType
37300>>>>>    String  sType
37300>>>>>    Integer iLength
37300>>>>>    Integer iPrecision
37300>>>>>    Integer iOptions
37300>>>>>    Boolean bIsSQLType
37300>>>>>    Boolean bAllowNULL 
37300>>>>>    String  sDefaultValue
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIColumnCompare
37300>>>>>    Integer iFieldNumber
37300>>>>>    // FROM database:
37300>>>>>    Boolean bExistsFrom
37300>>>>>    String  sFieldNameFrom
37300>>>>>    Integer iTypeFrom
37300>>>>>    String  sTypeFrom
37300>>>>>    Integer iLengthFrom
37300>>>>>    Integer iPrecisionFrom
37300>>>>>    Integer iOptionsFrom
37300>>>>>    Boolean bIsSQLTypeFrom
37300>>>>>    Boolean bAllowNULLFrom
37300>>>>>    String  sDefaultValueFrom
37300>>>>>    Boolean bShouldChangeFrom
37300>>>>>    Boolean bCancelFrom
37300>>>>>    Boolean bErrorFrom 
37300>>>>>    // TO database:
37300>>>>>    Boolean bExistsTo
37300>>>>>    Integer iFieldNumberTo
37300>>>>>    String  sFieldNameTo
37300>>>>>    Integer iTypeTo
37300>>>>>    String  sTypeTo
37300>>>>>    Integer iLengthTo
37300>>>>>    Integer iPrecisionTo
37300>>>>>    Integer iOptionsTo
37300>>>>>    Boolean bIsSQLTypeTo
37300>>>>>    Boolean bAllowNULLTo
37300>>>>>    String  sDefaultValueTo
37300>>>>>    Boolean bShouldChangeTo
37300>>>>>    Boolean bCancelTo
37300>>>>>    Boolean bErrorTo
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIRelation
37300>>>>>    Handle  hTableFrom
37300>>>>>    Integer iColumnFrom
37300>>>>>    Handle  hTableTo
37300>>>>>    Integer iColumnTo
37300>>>>>    String  sLogicalNameFrom
37300>>>>>    String  sLogicalNameTo
37300>>>>>    String  sFieldNameFrom
37300>>>>>    String  sFieldNameTo
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIRelationCompare
37300>>>>>    // Common:
37300>>>>>    Handle  hTableFrom
37300>>>>>    Integer iColumnFrom
37300>>>>>    Handle  hTableTo
37300>>>>>    Integer iColumnTo
37300>>>>>    // FROM database:
37300>>>>>    Boolean bExistsFrom
37300>>>>>    String  sLogicalNameFrom_From
37300>>>>>    String  sLogicalNameTo_From
37300>>>>>    String  sFieldNameFrom_From
37300>>>>>    String  sFieldNameTo_From
37300>>>>>    Boolean bShouldChange_From
37300>>>>>    Boolean bCancel_From
37300>>>>>    Boolean bError_From
37300>>>>>    // TO database:
37300>>>>>    Boolean bExistsTo
37300>>>>>    String  sLogicalNameFrom_To
37300>>>>>    String  sLogicalNameTo_To
37300>>>>>    String  sFieldNameFrom_To
37300>>>>>    String  sFieldNameTo_To
37300>>>>>    Boolean bShouldChange_To
37300>>>>>    Boolean bCancel_To
37300>>>>>    Boolean bError_To
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIIndexSegment
37300>>>>>    Integer iFieldNumber
37300>>>>>    String  sFieldName
37300>>>>>    Boolean bUppercase
37300>>>>>    Boolean bAscending
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIIndex
37300>>>>>    Integer iIndexNumber
37300>>>>>    Integer iPrimaryIndex
37300>>>>>    String  sSQLIndexName
37300>>>>>    Integer iSQLIndexType
37300>>>>>    Boolean bIsSQLClustered
37300>>>>>    Boolean bIsSQLPrimaryKey
37300>>>>>    tAPIIndexSegment[] IndexSegmentArray
37300>>>>>    tAPIIndexSegment[] IndexSegmentArray
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPIIndexCompare
37300>>>>>    // Common:
37300>>>>>    Integer iIndexNumber
37300>>>>>    // FROM database:
37300>>>>>    Boolean bExistsFrom
37300>>>>>    Integer iPrimaryIndexFrom
37300>>>>>    String  sSQLIndexNameFrom
37300>>>>>    Integer iSQLIndexTypeFrom
37300>>>>>    Boolean bIsSQLClusteredFrom
37300>>>>>    Boolean bIsSQLPrimaryKeyFrom
37300>>>>>    tAPIIndexSegment[] IndexSegmentArrayFrom
37300>>>>>    tAPIIndexSegment[] IndexSegmentArrayFrom
37300>>>>>    Boolean bShouldChangeFrom
37300>>>>>    Boolean bCancelFrom
37300>>>>>    Boolean bErrorFrom
37300>>>>>    // TO database:
37300>>>>>    Boolean bExistsTo
37300>>>>>    Integer iPrimaryIndexTo
37300>>>>>    String  sSQLIndexNameTo
37300>>>>>    Integer iSQLIndexTypeTo
37300>>>>>    Boolean bIsSQLClusteredTo
37300>>>>>    Boolean bIsSQLPrimaryKeyTo
37300>>>>>    tAPIIndexSegment[] IndexSegmentArrayTo
37300>>>>>    tAPIIndexSegment[] IndexSegmentArrayTo
37300>>>>>    Boolean bShouldChangeTo
37300>>>>>    Boolean bCancelTo
37300>>>>>    Boolean bErrorTo
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPITableNameInfo
37300>>>>>    Integer iTableNumber
37300>>>>>    String  sRootName
37300>>>>>    String  sLogicalName
37300>>>>>    String  sDisplayName
37300>>>>>    String  sDriverID
37300>>>>>    Boolean bIsAlias
37300>>>>>    Boolean bIsSQL  
37300>>>>>    Boolean bIsSystemFile
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPITableNameInfoCompare
37300>>>>>    Integer iTableNumber
37300>>>>>    // FROM
37300>>>>>    Boolean bExistsFrom
37300>>>>>    String  sRootNameFrom
37300>>>>>    String  sLogicalNameFrom
37300>>>>>    String  sDisplayNameFrom
37300>>>>>    String  sDriverIDFrom
37300>>>>>    Boolean bIsAliasFrom
37300>>>>>    Boolean bIsSQLFrom
37300>>>>>    Boolean bIsSystemFileFrom
37300>>>>>    // TO database:
37300>>>>>    Boolean bExistsTo
37300>>>>>    String  sRootNameTo
37300>>>>>    String  sLogicalNameTo
37300>>>>>    String  sDisplayNameTo
37300>>>>>    String  sDriverIDTo
37300>>>>>    Boolean bIsAliasTo
37300>>>>>    Boolean bIsSQLTo
37300>>>>>    Boolean bIsSystemFileTo // *** Implement!
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPITable
37300>>>>>    Handle hTable
37300>>>>>    Boolean bFromTable
37300>>>>>    Boolean bToTable
37300>>>>>    tAPITableNameInfo ApiTableInfo
37300>>>>>    tAPITableNameInfo ApiTableInfo
37300>>>>>    tAPIColumn[]      aApiColumns
37300>>>>>    tAPIColumn[]      aApiColumns
37300>>>>>    tAPIIndex[]       aApiIndexes
37300>>>>>    tAPIIndex[]       aApiIndexes
37300>>>>>    tAPIRelation[]    aApiRelations
37300>>>>>    tAPIRelation[]    aApiRelations
37300>>>>>    Boolean bShouldChange
37300>>>>>    Boolean bCancel
37300>>>>>    Boolean bError
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Struct tAPITableCompare
37300>>>>>    Handle hTable
37300>>>>>    // FROM database:
37300>>>>>    Boolean bExistsFrom
37300>>>>>    // TO database:
37300>>>>>    Boolean bExistsTo
37300>>>>>    // Both:
37300>>>>>    tAPITableNameInfoCompare APITableNameInfoCompare
37300>>>>>    tAPITableNameInfoCompare APITableNameInfoCompare
37300>>>>>    tAPIColumnCompare[]     aAPIColumnsCompare
37300>>>>>    tAPIColumnCompare[]     aAPIColumnsCompare
37300>>>>>    tAPIIndexCompare[]      aAPIIndexesCompare
37300>>>>>    tAPIIndexCompare[]      aAPIIndexesCompare
37300>>>>>    tAPIRelationCompare[]   aAPIRelationsCompare
37300>>>>>    tAPIRelationCompare[]   aAPIRelationsCompare
37300>>>>>    Boolean bShouldChange   // Not implemented yet (!)
37300>>>>>    Boolean bCancel         // User cancel
37300>>>>>    Boolean bError          // Error occured while collecting data
37300>>>>>End_Struct
37300>>>>>
37300>>>>>
37300>>>>>Struct tAPITableBooleans  
37300>>>>>    Boolean bApiTableUpdateAuto
37300>>>>>    Boolean bCompareDate_DateTime
37300>>>>>    Boolean bCompareIndexAscending
37300>>>>>    Boolean bCompareIndexUppercase
37300>>>>>    Boolean bCompareFilelistUppercase
37300>>>>>End_Struct
37300>>>>>
37300>>>>>Define C_tAPIColumn_None for 0
37300>>>>>Define C_tAPIColumn_Identity for 1
37300>>>>>
37300>>>>>// SQL Key-Word Constants:
37300>>>>>// Used by the _SqlFindKeyWord function to return a proper keyword depending on the backend SQL,
37300>>>>>// i.e. one of the EN_DbTypeXXX members from the Enum_list above.
37300>>>>>// E.g. the CI_SQLAlterTable is only defined once, but the _SqlFindKeyWord function can return
37300>>>>>// different wording content depending on the EN_xxx value also passed to the function.
37300>>>>>Enum_List
37300>>>>>    Define CI_SQLAlterDatabase         //for "ALTER DATABASE"          
37300>>>>>    Define CI_SQLSingle_User           //for "SINGLE_USER"
37300>>>>>    Define CI_SQLMulti_User            //for "USER_USER"
37300>>>>>    Define CI_SQLRollback              //for "ROLLBACK"
37300>>>>>    Define CI_SQLIMMEDIATE             //for "IMMEDIATE"
37300>>>>>    Define CI_SQLAlterTable            //for "ALTER TABLE"
37300>>>>>    Define CI_SQLAlterColumn           //for "ALTER COLUMN"
37300>>>>>    Define CI_SQLRenameColumn          //for "RENAME COLUMN"
37300>>>>>    Define CI_SQLColumn                //for "COLUMN"
37300>>>>>    Define CI_SQLSelect                //for "SELECT"
37300>>>>>    Define CI_SQLWhere                 //for "WHERE"
37300>>>>>    Define CI_SQLInfoSchema            //for "INFORMATION_SCHEMA.COLUMNS"
37300>>>>>    Define CI_SQLTable_Name            //for "TABLE_NAME"
37300>>>>>    Define CI_SQLTable                 //for "TABLE"
37300>>>>>    Define CI_SQLSys                   //for "SYS"
37300>>>>>    Define CI_SQLSp_Help               //for "SP_HELP"
37300>>>>>    Define CI_SQLFrom                  //for "FROM"
37300>>>>>    Define CI_SQLAdd                   //for "ADD"
37300>>>>>    Define CI_SQLDropColumn            //for "DROP"
37300>>>>>    Define CI_SQLCreateDatabase        //for "CREATE DATABASE"
37300>>>>>    Define CI_SQLDatabaseCollation     //for "COLLATE"
37300>>>>>    Define CI_SQLCreateTable           //for "CREATE TABLE"
37300>>>>>    Define CI_SQLDropTable             //for "DROP TABLE"
37300>>>>>    Define CI_SQLCreateView            //for "CREATE VIEW"
37300>>>>>    Define CI_SQLRenameTable           //for "RENAME TABLE"
37300>>>>>//    Define CI_SQLSelectFromWhereName   //for "SELECT name from [master].[dbo].[sysdatabases] where name"
37300>>>>>    Define CI_SQLDropView              //for "DROP VIEW"
37300>>>>>    Define CI_SQLSetNoCountOn          //for "SET NOCOUNT ON"
37300>>>>>    Define CI_SQLTo                    //for "TO"
37300>>>>>    Define CI_SQLGO                    //for "GO"
37300>>>>>    Define CI_SQLUse                   //for "USE"
37300>>>>>    Define CI_SQLDBO                   //for "DBO"
37300>>>>>
37300>>>>>    Define CI_SQLName                  //for "NAME"
37300>>>>>    Define CI_SQLMaster                //for "MASTER"
37300>>>>>    Define CI_SQLDatabases             //for "DATABASES"
37300>>>>>    Define CI_SQLSysIndexes            //for "SYS.INDEXES"
37300>>>>>    Define CI_SQLObjectID              //for "OBJECT_ID"
37300>>>>>    Define CI_SQLID                    //for "ID"
37300>>>>>    Define CI_SQLAND                   //for "AND"
37300>>>>>    Define CI_SQLUpdate                //for "UPDATE"
37300>>>>>    Define CI_SQLSet                   //for "SET"
37300>>>>>    Define CI_SQLWith                  //for "WITH"
37300>>>>>    Define CI_SQLNotNull               //for "NOT NULL"
37300>>>>>End_Enum_List
37300>>>>>
37300>>>Use cDbUpdateFunctionLibrary_Mixin.pkg  // Properties used by the cDbUpdateFunctionLibrary class.
Including file: cDbUpdateFunctionLibrary_Mixin.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cDbUpdateFunctionLibrary_Mixin.pkg)
37300>>>>>// *** Mixin Class For the cDbUpdateFunctionLibrary Class ***
37300>>>>>//
37300>>>>>// We need to create a mixin class for the library.
37300>>>>>// Why? Because we import the library to the cDbUpdateVersion class; that imports
37300>>>>>// all messages (functions & procedures) but all Properties are "lost", aka not imported by
37300>>>>>// the Import_Class_Protocol command. So we need a way to create our properties somewhere else...
37300>>>>>// Note: This class should _not_ have a construct_object defined.
37300>>>>>//
37300>>>>>Use VdfBase.pkg
37300>>>>>Use WinUuid.pkg
Including file: WinUuid.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\WinUuid.pkg)
37300>>>>>>>External_Function WinAPI_UuidCreate "UuidCreate" Rpcrt4.dll Address Uuid Returns Integer
37301>>>>>>>External_Function WinAPI_UuidToString  "UuidToStringA" Rpcrt4.dll Address aUuid Address lpUUIDString Returns Integer
37302>>>>>>>External_Function WinAPI_UuidCreateSequential "UuidCreateSequential" Rpcrt4.dll Address aUuid Returns Integer
37303>>>>>>>External_Function WinAPI_RpcStringFree "RpcStringFreeA" Rpcrt4.dll Address pStr Returns Integer
37304>>>>>>>
37304>>>>>>>// RandomHexUUID:
37304>>>>>>>
37304>>>>>>>// Returns a 'random' Universally Unique Identifier string as a 32 digit hex number.
37304>>>>>>>Function RandomHexUUID Global Returns String
37306>>>>>>>    Address pUUID pUUIDStr
37306>>>>>>>    Integer iRetval iOffset iChar
37306>>>>>>>    String sUUID sKey
37306>>>>>>>    
37306>>>>>>>    Move (Alloc(16)) to pUUID
37307>>>>>>>    
37307>>>>>>>    Move (WinAPI_UuidCreate (pUUID)) to iRetval
37308>>>>>>>    
37308>>>>>>>    If (iRetval = 0) Begin
37310>>>>>>>        Move 0 to pUUIDStr
37311>>>>>>>        
37311>>>>>>>        Move (WinAPI_UuidToString (pUUID, AddressOf(pUUIDStr))) to iRetval
37312>>>>>>>        If (iRetval = 0) Begin
37314>>>>>>>            Move pUUIDStr to sUUID
37315>>>>>>>            Move (WinAPI_RpcStringFree (AddressOf (pUUIDStr))) to iRetval
37316>>>>>>> 
37316>>>>>>>            Move (Uppercase (sUUID)) to sUUID
37317>>>>>>>        End
37317>>>>>>>>
37317>>>>>>>    End
37317>>>>>>>>
37317>>>>>>>    
37317>>>>>>>    Move (Free(pUUID)) to iRetval 
37318>>>>>>>    
37318>>>>>>>    Function_Return sUUID
37319>>>>>>>End_Function
37320>>>>>>>
37320>>>>>>>
37320>>>>>>>// SeqHexUUID:
37320>>>>>>>
37320>>>>>>>// Returns a sequential Universally Unique Identifier string as a 32 digit hex number.
37320>>>>>>>Function SeqHexUUID Global Returns String    
37322>>>>>>>    Address pUUID pUUIDStr
37322>>>>>>>    Integer iRetval iOffset iChar
37322>>>>>>>    String sUUID sKey
37322>>>>>>>    
37322>>>>>>>    Move (Alloc(16)) to pUUID
37323>>>>>>>    
37323>>>>>>>    Move (WinAPI_UuidCreateSequential (pUUID)) to iRetval
37324>>>>>>>    
37324>>>>>>>    If (iRetval = 0) Begin
37326>>>>>>>        Move 0 to pUUIDStr
37327>>>>>>>        
37327>>>>>>>        Move (WinAPI_UuidToString (pUUID, AddressOf(pUUIDStr))) to iRetval
37328>>>>>>>        If (iRetval = 0) Begin
37330>>>>>>>            Move pUUIDStr to sUUID
37331>>>>>>>            Move (WinAPI_RpcStringFree (AddressOf (pUUIDStr))) to iRetval
37332>>>>>>> 
37332>>>>>>>            Move (Uppercase (sUUID)) to sUUID
37333>>>>>>>        End
37333>>>>>>>>
37333>>>>>>>    End
37333>>>>>>>>
37333>>>>>>>    
37333>>>>>>>    Move (Free(pUUID)) to iRetval 
37334>>>>>>>    
37334>>>>>>>    Function_Return sUUID
37335>>>>>>>End_Function
37336>>>>>Use cli.pkg
37336>>>>>Use sql.pkg
Including file: sql.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\sql.pkg)
37336>>>>>>>//*****************************************************************************
37336>>>>>>>//*** SQL.pkg                                                               ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** Author: Ben Weijers                                                   ***
37336>>>>>>>//***         Data Access Wordwide                                          ***
37336>>>>>>>//***         14 February 2000                                              ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** Purpose:                                                              ***
37336>>>>>>>//***       Embedded SQL classes for use with Data Access Worldwide CLI     ***
37336>>>>>>>//***       Connectivty Kits.                                               ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** Last update:                                                          ***
37336>>>>>>>//***       February 2014. Current CLI Connectivity Kit 6.0.0.28            ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** !! Please Note !!                                                     ***
37336>>>>>>>//***       -This version of sql.pkg will only work with CLI Connectivity   ***
37336>>>>>>>//***        Kits 6.0.0.28 or later.                                        ***
37336>>>>>>>//***       -This version of sql.pkg will no longer function with DataFlex  ***
37336>>>>>>>//***        character mode (DataFlex 3.2). To use embedded SQL with        ***
37336>>>>>>>//**         DataFlex character mode, use sqlold.pkg.                       ***
37336>>>>>>>//***       -This version of sql.pkg no longer contains the embedded SQL    ***
37336>>>>>>>//***        command interface. The command interface is still available    ***
37336>>>>>>>//***        in sqlold.pkg                                                  ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** Changes:                                                              ***
37336>>>>>>>//***       February 2014. CLI Connectivity Kit 6.0.0.28                    ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//***       Several performances improvements to speed up SQLColumnValue    ***
37336>>>>>>>//***       and SQLGetData                                                  ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//***       New functions:                                                  ***
37336>>>>>>>//***           Function SQLFetchRowValues Returns String[]                 ***
37336>>>>>>>//***               Fetches a row and returns all columns in an array.      ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//***           Function SQLFetchResultsetValues Returns String[][]         ***
37336>>>>>>>//***               Fetches all rows of a result set and returns the        ***
37336>>>>>>>//***               result set as a 2-dimensial array.                      ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//***
37336>>>>>>>//***       July 2016. CLI Connectivity Kit 6.2.0.12
37336>>>>>>>//***            
37336>>>>>>>//***       New function:    
37336>>>>>>>//***           Function SQLConnectionConnect String sDrvrID String sConnectString Returns Integer
37336>>>>>>>//***               Establish an embedded SQL connection that uses an
37336>>>>>>>//***               existing connection from an earlier Login or Open.
37336>>>>>>>//*** 
37336>>>>>>>//*****************************************************************************
37336>>>>>>>
37336>>>>>>>Use CLI.pkg
37336>>>>>>>
37336>>>>>>>//*** Global storage for results
37336>>>>>>>Integer SQLResult
37336>>>>>>>
37336>>>>>>>//*** Embedded SQL function constants
37336>>>>>>>Define FUNC_SQLCONNECT             For 1000000
37336>>>>>>>Define FUNC_SQLFILECONNECT         For 1000001
37336>>>>>>>Define FUNC_SQLDISCONNECT          For 1000002
37336>>>>>>>Define FUNC_SQLOPEN                For 1000003
37336>>>>>>>Define FUNC_SQLCLOSE               For 1000004
37336>>>>>>>Define FUNC_SQLPREPARE             For 1000005
37336>>>>>>>Define FUNC_SQLEXECUTE             For 1000006
37336>>>>>>>Define FUNC_SQLEXECDIRECT          For 1000007
37336>>>>>>>Define FUNC_SQLFETCH               For 1000008
37336>>>>>>>Define FUNC_SQLCOLUMNINFO          For 1000009
37336>>>>>>>Define FUNC_SQLCOLUMNVALUE         For 1000010
37336>>>>>>>Define FUNC_SQLBINDFILE            For 1000011
37336>>>>>>>Define FUNC_SQLGETDATA             For 1000012
37336>>>>>>>Define FUNC_SQLCOLSTRINGATTRIBLEN  For 1000013
37336>>>>>>>Define FUNC_SQLCOLSTRINGATTRIB     For 1000014
37336>>>>>>>Define FUNC_SQLCOLINTATTRIB        For 1000015
37336>>>>>>>Define FUNC_SQLSTMTINTATTRIB       For 1000016
37336>>>>>>>Define FUNC_SQLSETPROCNAME         For 1000017
37336>>>>>>>DEfine FUNC_SQLSETPROCARG          For 1000018
37336>>>>>>>Define FUNC_SQLCALL                For 1000019
37336>>>>>>>Define FUNC_SQLGETPROCARGLEN       For 1000020
37336>>>>>>>Define FUNC_SQLGETPROCARG          For 1000021
37336>>>>>>>Define FUNC_SQLGETPROCRETVALLEN    For 1000022
37336>>>>>>>Define FUNC_SQLGETPROCRETVAL       For 1000023
37336>>>>>>>Define FUNC_SQLNEXTRESULTSET       For 1000024
37336>>>>>>>Define FUNC_SQLBUFFERSTATUS        For 1000025
37336>>>>>>>Define FUNC_SQLSETPROCSCHEMA       For 1000026
37336>>>>>>>Define FUNC_SQLGETMESSAGE          For 1000027
37336>>>>>>>
37336>>>>>>>//*** Embedded SQL statement attribute constants
37336>>>>>>>Define SQLSTMTATTRIB_COLUMNCOUNT    For 1
37336>>>>>>>Define SQLSTMTATTRIB_ROWCOUNT       For 2
37336>>>>>>>Define SQLSTMTATTRIB_ROWCOUNT_TYPE  For 3
37336>>>>>>>Define SQLSTMTATTRIB_NUMMESSAGES    For 4
37336>>>>>>>
37336>>>>>>>//*** Embedded SQL column attribute constants
37336>>>>>>>Define SQLCOLATTRIB_SIZE           For 1
37336>>>>>>>Define SQLCOLATTRIB_LENGTH         For 1
37336>>>>>>>Define SQLCOLATTRIB_PRECISION      For 2
37336>>>>>>>Define SQLCOLATTRIB_LABEL          For 3
37336>>>>>>>Define SQLCOLATTRIB_BASECOLUMNNAME For 4
37336>>>>>>>Define SQLCOLATTRIB_BASETABLENAME  For 5
37336>>>>>>>Define SQLCOLATTRIB_SQLTYPE        For 6
37336>>>>>>>Define SQLCOLATTRIB_NULLABLE       For 7
37336>>>>>>>Define SQLCOLATTRIB_DFTYPE         For 8
37336>>>>>>>
37336>>>>>>>
37336>>>>>>>
37336>>>>>>>//*****************************************************************************
37336>>>>>>>//*** Class  : cSQLStatement                                                ***
37336>>>>>>>//*** Purpose: Statement object for embedded sql                            ***
37336>>>>>>>//***                                                                       ***
37336>>>>>>>//*** Description:                                                          ***
37336>>>>>>>//***   An object is created for each statement. These will be children     ***
37336>>>>>>>//***   of cSQLConnection objects which manage the create and destruction   ***
37336>>>>>>>//***   of these.                                                           ***
37336>>>>>>>//*****************************************************************************
37336>>>>>>>
37336>>>>>>>// Global variables holding last executed embedded SQL connection and statement handles.
37336>>>>>>>Integer giLastSQLhdbc
37336>>>>>>>Integer giLastSQLhstmt
37336>>>>>>>
37336>>>>>>>Move -1 to giLastSQLhdbc
37337>>>>>>>Move -1 to giLastSQLhstmt
37338>>>>>>>
37338>>>>>>>Struct tSQLColumn
37338>>>>>>>    Integer iSQLType
37338>>>>>>>    Integer iSQLSize
37338>>>>>>>    Integer iSQLPrecision
37338>>>>>>>    Integer iVariableDataType
37338>>>>>>>End_Struct
37338>>>>>>>
37338>>>>>>>Class cSQLStatement is a cObject
37339>>>>>>>
37339>>>>>>>    Procedure Construct_object 
37341>>>>>>>        Forward Send Construct_object 
37343>>>>>>>
37343>>>>>>>        Property Handle  phCLIStatementHandle   0
37344>>>>>>>        Property Handle  phCLIConnectionHandle  0
37345>>>>>>>        Property String  psDriverID             ""
37346>>>>>>>        
37346>>>>>>>        Property Integer piLastColumn      0
37347>>>>>>>        Property Integer piLastArgument    0
37348>>>>>>>        Property Integer piBindFile        0
37349>>>>>>>        Property Integer piColumnCount     0
37350>>>>>>>
37350>>>>>>>        // Allocated buffer for SQLColumnValue. 
37350>>>>>>>        // Allocated size is size of the largest (not variable length) column
37350>>>>>>>        Property String  psMaxColValue     ""
37351>>>>>>>
37351>>>>>>>        // True if there is at least 1 column with a variable length data type                 
37351>>>>>>>        Property Integer piHasVariableDataType  0
37352>>>>>>>
37352>>>>>>>        // Max size of buffer for variable length data. Default 16000        
37352>>>>>>>        Property Integer piMaxVariableBufferLength 16000  
37353>>>>>>>
37353>>>>>>>        // Allocated buffer for SQLGetData. 
37353>>>>>>>        Property String  psVariableBuffer  ""
37354>>>>>>>
37354>>>>>>>        // Allocated size of psVariableBuffer
37354>>>>>>>        Property Integer piVariableBufferLength 0
37355>>>>>>>
37355>>>>>>>        // Stores column properties of a result set.
37355>>>>>>>        Property tSQLColumn[] paSQLColumns
37356>>>>>>>        
37356>>>>>>>        // piFetchResult is set by SQLFetchRowValues and SQLFetchResultSetValues
37356>>>>>>>        //               0    = Fetch returned no data.
37356>>>>>>>        //               <> 0 = Row fetched
37356>>>>>>>        Property Integer piFetchResult     0
37357>>>>>>>
37357>>>>>>>
37357>>>>>>>        Property String psDummyZeroDate              '0001-01-01'
37358>>>>>>>        Property String psDummyZeroDateMssqlDatetime '1753-01-01'        
37359>>>>>>>
37359>>>>>>>    End_Procedure 
37360>>>>>>>
37360>>>>>>>    //***
37360>>>>>>>    //*** Procedure: StoreStatementInfo
37360>>>>>>>    //*** Purpose  : Store basic information about the statement.
37360>>>>>>>    //***
37360>>>>>>>    Procedure StoreStatementInfo Handle hCLIStatementHandle String sDrvrId Handle hCLIConnectionHandle
37362>>>>>>>        
37362>>>>>>>        Set phCLIStatementHandle   to hCLIStatementHandle
37363>>>>>>>        Set phCLIConnectionHandle  to hCLIConnectionHandle
37364>>>>>>>        Set psDriverID             to sDrvrId
37365>>>>>>>        
37365>>>>>>>    End_Procedure 
37366>>>>>>>
37366>>>>>>>
37366>>>>>>>    //***
37366>>>>>>>    //*** Procedure: DestroySQLStatement
37366>>>>>>>    //*** Purpose  : Destroy the cSQLStatement object
37366>>>>>>>    //***
37366>>>>>>>    Procedure DestroySQLStatement
37368>>>>>>>        Send Destroy
37369>>>>>>>    End_Procedure 
37370>>>>>>>
37370>>>>>>>    //***
37370>>>>>>>    //*** Procedure: HandleError
37370>>>>>>>    //*** Puprose  : Handle an error that has occured while checking properties.
37370>>>>>>>    //***
37370>>>>>>>
37370>>>>>>>    Procedure HandleError Integer ihstmt Integer ihdbc String sDrvrId String sOriginMsg
37372>>>>>>>        Integer iErrHandle
37372>>>>>>>        Integer iErrNum
37372>>>>>>>        String  sLocationInfo
37372>>>>>>>
37372>>>>>>>        //*** Get the DataFlex statement identifier
37372>>>>>>>        Move Self To iErrHandle
37373>>>>>>>
37373>>>>>>>        //*** Determine error number
37373>>>>>>>        If (ihstmt = 0) ;            Move CLIERR_SQLINVALID_CLI_STMT_HANDLE To iErrNum
37376>>>>>>>        Else If (ihdbc = 0) ;            Move CLIERR_SQLINVALID_CLI_CONN_HANDLE To iErrNum
37380>>>>>>>        Else If (sDrvrId = "") ;            Move CLIERR_SQLINVALID_DRIVER_ID To iErrNum
37384>>>>>>>        Else ;            Move CLIERR_SQL_ERROR To iErrNum
37386>>>>>>>
37386>>>>>>>        //*** Create location ifnormation
37386>>>>>>>        Move "[" To sLocationInfo
37387>>>>>>>        If (sOriginMsg <> "") Begin
37389>>>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
37390>>>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
37391>>>>>>>        End
37391>>>>>>>>
37391>>>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
37392>>>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
37393>>>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
37394>>>>>>>
37394>>>>>>>        //*** Generate the error
37394>>>>>>>        Error iErrNum sLocationInfo
37395>>>>>>>>
37395>>>>>>>    End_Procedure
37396>>>>>>>
37396>>>>>>>
37396>>>>>>>
37396>>>>>>>    //***
37396>>>>>>>    //*** Procedure: StmtError
37396>>>>>>>    //*** Purpose  : Handle general error not related to the properties
37396>>>>>>>    //***
37396>>>>>>>
37396>>>>>>>    Procedure StmtError Integer iErrNum String sErrText String sOriginMsg
37398>>>>>>>        Integer iErrHandle
37398>>>>>>>        String  sLocationInfo
37398>>>>>>>
37398>>>>>>>        //*** Get the DataFlex statement identifier
37398>>>>>>>        Move Self to iErrHandle
37399>>>>>>>
37399>>>>>>>        //*** Create location information
37399>>>>>>>        Move "[" To sLocationInfo
37400>>>>>>>        If (sOriginMsg <> "") Begin
37402>>>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
37403>>>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
37404>>>>>>>        End
37404>>>>>>>>
37404>>>>>>>        If (sErrtext <> "") Begin
37406>>>>>>>            Move (Append(sLocationInfo, sErrtext)) To sLocationInfo
37407>>>>>>>            Move (Append(sLocationInfo, ", "))     To sLocationInfo
37408>>>>>>>        End
37408>>>>>>>>
37408>>>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
37409>>>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
37410>>>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
37411>>>>>>>
37411>>>>>>>        //*** Generate the error
37411>>>>>>>        Error iErrNum sLocationInfo
37412>>>>>>>>
37412>>>>>>>    End_Procedure 
37413>>>>>>>
37413>>>>>>>
37413>>>>>>>
37413>>>>>>>    //***
37413>>>>>>>    //*** Procedure: SQLIllegalAttribute
37413>>>>>>>    //*** Purpose  : Handle an illegal attribute error
37413>>>>>>>    //***
37413>>>>>>>
37413>>>>>>>    Procedure SQLIllegalAttribute String sErrText String sOriginMsg
37415>>>>>>>        Integer bReport
37415>>>>>>>
37415>>>>>>>        Get_attribute DF_REPORT_UNSUPPORTED_ATTRIBUTES To bReport
37418>>>>>>>        If (bReport) ;            Send StmtError CLIERR_SQLINVALID_ATTRIBUTE sErrtext sOriginMsg
37421>>>>>>>    End_Procedure 
37422>>>>>>>
37422>>>>>>>
37422>>>>>>>
37422>>>>>>>    //***
37422>>>>>>>    //*** Function: SQLPrivateColumnIsLegal
37422>>>>>>>    //*** Purpose : Check if a column number is legal
37422>>>>>>>    //***
37422>>>>>>>
37422>>>>>>>    Function SQLPrivateColumnIsLegal Integer ihdbc String sDrvrId Integer ihstmt Integer iCol Returns Integer
37424>>>>>>>        Integer bLegal
37424>>>>>>>        Integer iNumColumns
37424>>>>>>>
37424>>>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
37425>>>>>>>        If (iCol > 0 And iCol <= iNumColumns) ;            Move DFTRUE To bLegal
37428>>>>>>>        Else ;            Move DFFALSE To bLegal
37430>>>>>>>
37430>>>>>>>        Function_Return bLegal
37431>>>>>>>    End_Function 
37432>>>>>>>
37432>>>>>>>
37432>>>>>>>
37432>>>>>>>    //***
37432>>>>>>>    //*** Procedure: SQLClose
37432>>>>>>>    //*** Purpose  : Close a statement and free all alllocated resources
37432>>>>>>>    //***
37432>>>>>>>
37432>>>>>>>    Procedure SQLClose
37434>>>>>>>        Integer ihdbc
37434>>>>>>>        Integer ihstmt
37434>>>>>>>        Integer iVoid
37434>>>>>>>        String  sDrvrId
37434>>>>>>>        String  sEmpty
37434>>>>>>>
37434>>>>>>>        //*** Initialize
37434>>>>>>>        Move "" To sEmpty
37435>>>>>>>
37435>>>>>>>        //*** Get the cli handles
37435>>>>>>>        Get phCLIStatementHandle  to ihstmt
37436>>>>>>>        Get phCLIConnectionHandle to ihdbc
37437>>>>>>>        Get psDriverId            to sDrvrId
37438>>>>>>>
37438>>>>>>>        //*** Free the CLI handle
37438>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37440>>>>>>>            //*** Call the driver function to close
37440>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCLOSE ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
37445>>>>>>>
37445>>>>>>>            Move -1 to giLastSQLhstmt
37446>>>>>>>            //*** Free the DataFlex handle
37446>>>>>>>            Send DestroySQLStatement
37447>>>>>>>        End
37447>>>>>>>>
37447>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLClose"
37449>>>>>>>    End_Procedure
37450>>>>>>>
37450>>>>>>>
37450>>>>>>>
37450>>>>>>>    //***
37450>>>>>>>    //*** Procedure: SQLPrepare
37450>>>>>>>    //*** Purpose  : Prepare a statement for execution
37450>>>>>>>    //***
37450>>>>>>>
37450>>>>>>>    Procedure SQLPrepare String sStatement
37452>>>>>>>        Integer ihdbc
37452>>>>>>>        Integer ihstmt
37452>>>>>>>        Integer iVoid
37452>>>>>>>        String  sDrvrId
37452>>>>>>>
37452>>>>>>>        //*** Get the cli handles
37452>>>>>>>        Get phCLIStatementHandle  to ihstmt
37453>>>>>>>        Get phCLIConnectionHandle to ihdbc
37454>>>>>>>        Get psDriverId            to sDrvrId
37455>>>>>>>
37455>>>>>>>        //*** Prepare
37455>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37457>>>>>>>            //*** Call the driver function to prepare
37457>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLPREPARE ;                        Callback Self ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
37462>>>>>>>        End
37462>>>>>>>>
37462>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrepare"
37464>>>>>>>    End_Procedure
37465>>>>>>>
37465>>>>>>>    Procedure SQLGetStatementAttributes
37467>>>>>>>        Integer ihdbc ihstmt iNumColumns iCol iMaxSize
37467>>>>>>>        String sMaxValue
37467>>>>>>>        tSQLColumn[] aSQLColumns
37467>>>>>>>        tSQLColumn[] aSQLColumns
37468>>>>>>>        
37468>>>>>>>        Integer iSqlType
37468>>>>>>>        Integer iSQLSize
37468>>>>>>>        Integer iSQLprecision
37468>>>>>>>        Integer iVariableDataType
37468>>>>>>>        
37468>>>>>>>        String  sDrvrId
37468>>>>>>>
37468>>>>>>>        Integer iHasVariableDataType
37468>>>>>>>
37468>>>>>>>        Move 0 to iHasVariableDataType
37469>>>>>>>
37469>>>>>>>
37469>>>>>>>        //*** Get the cli handles
37469>>>>>>>        Get phCLIStatementHandle  to ihstmt
37470>>>>>>>        Get phCLIConnectionHandle to ihdbc
37471>>>>>>>        Get psDriverId            to sDrvrId
37472>>>>>>>
37472>>>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt to iNumColumns
37473>>>>>>>        
37473>>>>>>>        Set piColumnCount to iNumColumns
37474>>>>>>>        
37474>>>>>>>        // Fill columns array
37474>>>>>>>        For iCol from 1 to iNumColumns
37480>>>>>>>>
37480>>>>>>>            Move 0 to iVariableDataType
37481>>>>>>>            
37481>>>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SQLTYPE ihdbc sDrvrId ihstmt to iSQLType
37482>>>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SIZE ihdbc sDrvrId ihstmt to iSQLSize
37483>>>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_PRECISION ihdbc sDrvrId ihstmt to iSQLPrecision
37484>>>>>>>            
37484>>>>>>>            If ( (iSQLType = SQL_LONGVARCHAR) or (iSQLType = SQL_WLONGVARCHAR) ) Begin
37486>>>>>>>                 // text type 
37486>>>>>>>                Move 1 to iVariableDataType
37487>>>>>>>            End
37487>>>>>>>>
37487>>>>>>>            Else Begin
37488>>>>>>>                If (sDrvrId = "MSSQLDRV") Begin
37490>>>>>>>                    // SQL Server varchar(max) and nvarchar(max) types return Size = 0                   
37490>>>>>>>                    If ( ((iSQLType = SQL_VARCHAR) and (iSQLSize = 0) ) or ;                         ((iSQLType = SQL_WVARCHAR) and (iSQLSize = 0) ) ) Begin
37492>>>>>>>                            
37492>>>>>>>                        Move 1 to iVariableDataType     
37493>>>>>>>                    End
37493>>>>>>>>
37493>>>>>>>                End
37493>>>>>>>>
37493>>>>>>>            End
37493>>>>>>>>
37493>>>>>>>
37493>>>>>>>            Move iSqlType           to aSQLColumns[iCol].iSQLType            
37494>>>>>>>            Move iSQLSize           to aSQLColumns[iCol].iSQLSize
37495>>>>>>>            Move iSQLPrecision      to aSQLColumns[iCol].iSQLPrecision
37496>>>>>>>            Move iVariableDataType  to aSQLColumns[iCol].iVariableDataType
37497>>>>>>>            
37497>>>>>>>            If (not(iVariableDataType)) Begin
37499>>>>>>>                If (iSQLSize > iMaxSize) Begin
37501>>>>>>>                    Move iSQLSize to iMaxSize
37502>>>>>>>                End
37502>>>>>>>>
37502>>>>>>>            End
37502>>>>>>>>
37502>>>>>>>            Else Begin
37503>>>>>>>                Move 1 to iHasVariableDataType
37504>>>>>>>            End
37504>>>>>>>>
37504>>>>>>>            
37504>>>>>>>        Loop
37505>>>>>>>>
37505>>>>>>>        
37505>>>>>>>        Move (Repeat(' ', iMaxSize + 3)) to sMaxValue
37506>>>>>>>        Set psMaxColValue to sMaxValue
37507>>>>>>>        
37507>>>>>>>        Set paSQLColumns   to aSQLColumns        
37508>>>>>>>        Set piHasVariableDataType to iHasVariableDataType
37509>>>>>>>        
37509>>>>>>>    End_Procedure
37510>>>>>>>
37510>>>>>>>    //***
37510>>>>>>>    //*** Procedure: SQLExecute
37510>>>>>>>    //*** Purpose  : Execute a prepared statement
37510>>>>>>>    //***
37510>>>>>>>
37510>>>>>>>    Procedure SQLExecute
37512>>>>>>>        Integer ihdbc
37512>>>>>>>        Integer ihstmt
37512>>>>>>>        Integer iVoid
37512>>>>>>>        String  sDrvrId
37512>>>>>>>        String  sEmpty
37512>>>>>>>
37512>>>>>>>        //*** Initialize
37512>>>>>>>        Move "" To sEmpty
37513>>>>>>>
37513>>>>>>>        //*** Get the cli handles
37513>>>>>>>        Get phCLIStatementHandle  to ihstmt
37514>>>>>>>        Get phCLIConnectionHandle to ihdbc
37515>>>>>>>        Get psDriverId            to sDrvrId
37516>>>>>>>
37516>>>>>>>        //*** Execute
37516>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37518>>>>>>>            //*** Call the driver function to execute
37518>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECUTE ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
37523>>>>>>>            Send SQLGetStatementAttributes
37524>>>>>>>        End
37524>>>>>>>>
37524>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecute"
37526>>>>>>>    End_Procedure
37527>>>>>>>
37527>>>>>>>
37527>>>>>>>
37527>>>>>>>    //***
37527>>>>>>>    //*** Procedure: SQLExecDirect
37527>>>>>>>    //*** Purpose  : Prepare and execute a statement
37527>>>>>>>    //***
37527>>>>>>>
37527>>>>>>>    Procedure SQLExecDirect String sStatement
37529>>>>>>>        Integer ihdbc
37529>>>>>>>        Integer ihstmt
37529>>>>>>>        Integer iVoid
37529>>>>>>>        String  sDrvrId
37529>>>>>>>
37529>>>>>>>        //*** Get the cli handles
37529>>>>>>>        Get phCLIStatementHandle  to ihstmt
37530>>>>>>>        Get phCLIConnectionHandle to ihdbc
37531>>>>>>>        Get psDriverId            to sDrvrId
37532>>>>>>>
37532>>>>>>>        //*** ExecDirect
37532>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37534>>>>>>>            //*** Call the driver function to execdirect
37534>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECDIRECT ;                        Callback Self ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
37539>>>>>>>            Send SQLGetStatementAttributes
37540>>>>>>>        End
37540>>>>>>>>
37540>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecDirect"
37542>>>>>>>    End_Procedure
37543>>>>>>>
37543>>>>>>>
37543>>>>>>>
37543>>>>>>>    //***
37543>>>>>>>    //*** Procedure: SQLFetch
37543>>>>>>>    //*** Purpose  : Fetch the next row
37543>>>>>>>    //*** Returns  : 0   = No more data
37543>>>>>>>    //***            <>0 = Success
37543>>>>>>>    //***
37543>>>>>>>    Function SQLFetch Returns Integer
37545>>>>>>>        Integer ihdbc
37545>>>>>>>        Integer ihstmt
37545>>>>>>>        Integer iResult
37545>>>>>>>        String  sDrvrId
37545>>>>>>>        String  sEmpty
37545>>>>>>>
37545>>>>>>>        //*** Initialize
37545>>>>>>>        Move "" To sEmpty
37546>>>>>>>        Move 0  To iResult
37547>>>>>>>
37547>>>>>>>        //*** Get the cli handles
37547>>>>>>>        Get phCLIStatementHandle  to ihstmt
37548>>>>>>>        Get phCLIConnectionHandle to ihdbc
37549>>>>>>>        Get psDriverId            to sDrvrId
37550>>>>>>>
37550>>>>>>>        //*** Fetch
37550>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37552>>>>>>>            Indicate Err False
37553>>>>>>>
37553>>>>>>>            //*** Call the driver function to fetch
37553>>>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
37558>>>>>>>
37558>>>>>>>            //*** If something went wrong, adjust the result
37558>>>>>>>            If (Err) Move 0 to iResult
37561>>>>>>>
37561>>>>>>>            Set piLastcolumn To 0
37562>>>>>>>        End
37562>>>>>>>>
37562>>>>>>>        Else Send HandleError ihstmt ihdbc sDrvrId "SQLFetch"
37564>>>>>>>
37564>>>>>>>        Function_return iResult
37565>>>>>>>    End_Function
37566>>>>>>>
37566>>>>>>>
37566>>>>>>>    //***
37566>>>>>>>    //*** Procedure: SQLFetchRowValues
37566>>>>>>>    //*** Purpose  : Fetch the next row and return an array with all column values
37566>>>>>>>    //*** Returns  : Array of strings with all column values
37566>>>>>>>    //***            Sets piFetchResult property 
37566>>>>>>>    //***               0    = No more data
37566>>>>>>>    //***               <> 0 = Success
37566>>>>>>>    //***
37566>>>>>>>    Function SQLFetchRowValues Returns String[] 
37568>>>>>>>      
37568>>>>>>>        String[] asValues
37569>>>>>>>
37569>>>>>>>        tSQLColumn[] aSQLColumns        
37569>>>>>>>        tSQLColumn[] aSQLColumns        
37570>>>>>>>        
37570>>>>>>>        Integer ihdbc
37570>>>>>>>        Integer ihstmt
37570>>>>>>>        Integer iResult iVoid
37570>>>>>>>        Integer iColCount iCol
37570>>>>>>>        String  sDrvrId
37570>>>>>>>        String  sEmpty 
37570>>>>>>>        String  sResult
37570>>>>>>>        String  sVariableResult
37570>>>>>>>        Integer iHasVariableDataType
37570>>>>>>>        Integer iLen
37570>>>>>>>        Integer iVariableBufferLength
37570>>>>>>>
37570>>>>>>>        //*** Initialize
37570>>>>>>>        Move "" to sEmpty
37571>>>>>>>        Move 0  to iResult
37572>>>>>>>
37572>>>>>>>        //*** Get the cli handles
37572>>>>>>>        Get phCLIStatementHandle  to ihstmt
37573>>>>>>>        Get phCLIConnectionHandle to ihdbc
37574>>>>>>>        Get psDriverId            to sDrvrId
37575>>>>>>>        
37575>>>>>>>        Get paSQLColumns to aSQLColumns
37576>>>>>>>        Get piColumnCount to iColCount
37577>>>>>>>        Get piHasVariableDataType to iHasVariableDataType
37578>>>>>>>        
37578>>>>>>>        If (iHasVariableDataType) Begin
37580>>>>>>>            
37580>>>>>>>            Get piVariableBufferLength      to iVariableBufferLength
37581>>>>>>>            Get piMaxVariableBufferLength   to iLen
37582>>>>>>>            
37582>>>>>>>            If (iLen > iVariableBufferLength) Begin
37584>>>>>>>                //*** Allocate
37584>>>>>>>                Move (Repeat(' ', iLen)) to sVariableResult
37585>>>>>>>               
37585>>>>>>>                Set piVariableBufferLength to iLen
37586>>>>>>>                Set psVariableBuffer       to sVariableResult
37587>>>>>>>                
37587>>>>>>>                Get piVariableBufferLength to iVariableBufferLength                
37588>>>>>>>            End
37588>>>>>>>>
37588>>>>>>>        End
37588>>>>>>>>
37588>>>>>>>
37588>>>>>>>        //*** Fetch
37588>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37590>>>>>>>            Move (False) to Err
37591>>>>>>>
37591>>>>>>>            // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
37591>>>>>>>            // in the next FUNC_SQLCOLUMNVALUE call.
37591>>>>>>>            // If hdbc and hstmt have not changed since the last call we don't have to set it.
37591>>>>>>>            If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
37593>>>>>>>                //*** Setup function arguments
37593>>>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO Callback 0 Passing ihdbc iCol ihstmt Result iVoid
37598>>>>>>>                Move ihstmt to giLastSQLhstmt
37599>>>>>>>                Move ihdbc to giLastSQLhdbc
37600>>>>>>>            End
37600>>>>>>>>
37600>>>>>>>
37600>>>>>>>            //*** Call the driver function to fetch
37600>>>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback 0 Passing ihdbc sEmpty ihstmt Result iResult
37605>>>>>>>
37605>>>>>>>            //*** If something went wrong, adjust the result
37605>>>>>>>            If (Err) Move 0 to iResult
37608>>>>>>>            
37608>>>>>>>            If (iResult) Begin
37610>>>>>>>                For iCol from 1 to iColCount
37616>>>>>>>>
37616>>>>>>>                    
37616>>>>>>>                    If (not(aSQLColumns[iCol].iVariableDataType)) Begin
37618>>>>>>>                        Get psMaxColValue to sResult
37619>>>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE Callback 0 Passing sResult sEmpty iCol Result iVoid
37624>>>>>>>
37624>>>>>>>                        Move sResult to asValues[iCol - 1]
37625>>>>>>>                    End
37625>>>>>>>>
37625>>>>>>>                    Else Begin
37626>>>>>>>                        Get psVariableBuffer       to sVariableResult
37627>>>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                    Callback 0 ;                                    Passing sVariableResult iCol iVariableBufferLength ;                                    Result iVoid
37632>>>>>>>                                    
37632>>>>>>>                        Move sVariableResult to asValues[iCol - 1]
37633>>>>>>>                    End
37633>>>>>>>>
37633>>>>>>>                    
37633>>>>>>>                Loop
37634>>>>>>>>
37634>>>>>>>            End
37634>>>>>>>>
37634>>>>>>>        End
37634>>>>>>>>
37634>>>>>>>        Else Begin    
37635>>>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLFetchRowValues"
37636>>>>>>>        End
37636>>>>>>>>
37636>>>>>>>
37636>>>>>>>        Set piFetchResult to iResult
37637>>>>>>>
37637>>>>>>>        Function_Return asValues
37638>>>>>>>        
37638>>>>>>>    End_Function 
37639>>>>>>>
37639>>>>>>>    //***
37639>>>>>>>    //*** Procedure: SQLFetchResultsetValues
37639>>>>>>>    //*** Purpose  : Fetch a complete result set. 
37639>>>>>>>    //*** Returns  : 2-dimensional array of strings with result set
37639>>>>>>>    //***            Sets piFetchResult property 
37639>>>>>>>    //***               0    = No more data
37639>>>>>>>    //***               <> 0 = Success
37639>>>>>>>    //***
37639>>>>>>>    Function SQLFetchResultsetValues Returns String[][] 
37641>>>>>>>        
37641>>>>>>>        String[][] asValues 
37642>>>>>>>        
37642>>>>>>>        Integer ihdbc ihstmt iResult iVoid iColCount iCol iRow
37642>>>>>>>        String sDrvrId sEmpty sResult sMax
37642>>>>>>>
37642>>>>>>>        tSQLColumn[] aSQLColumns        
37642>>>>>>>        tSQLColumn[] aSQLColumns        
37643>>>>>>>        String  sVariableResult
37643>>>>>>>        Integer iHasVariableDataType
37643>>>>>>>        Integer iLen
37643>>>>>>>        Integer iVariableBufferLength
37643>>>>>>>
37643>>>>>>>        //*** Initialize
37643>>>>>>>        Move "" to sEmpty
37644>>>>>>>        Move 0  to iResult
37645>>>>>>>
37645>>>>>>>        //*** Get the cli handles
37645>>>>>>>        Get phCLIStatementHandle  to ihstmt
37646>>>>>>>        Get phCLIConnectionHandle to ihdbc
37647>>>>>>>        Get psDriverId            to sDrvrId
37648>>>>>>>
37648>>>>>>>        //*** Fetch
37648>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37650>>>>>>>            Indicate Err False
37651>>>>>>>            
37651>>>>>>>            // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
37651>>>>>>>            // in the next FUNC_SQLCOLUMNVALUE call.
37651>>>>>>>            // If hdbc and hstmt have not changed since the last call we don't have to set it.
37651>>>>>>>            If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
37653>>>>>>>                //*** Setup function arguments
37653>>>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO Callback 0 Passing ihdbc iCol ihstmt Result iVoid
37658>>>>>>>                Move ihstmt to giLastSQLhstmt
37659>>>>>>>                Move ihdbc to giLastSQLhdbc
37660>>>>>>>            End
37660>>>>>>>>
37660>>>>>>>
37660>>>>>>>
37660>>>>>>>            Get paSQLColumns to aSQLColumns
37661>>>>>>>            Get piColumnCount to iColCount
37662>>>>>>>            Get piHasVariableDataType to iHasVariableDataType
37663>>>>>>>            If (iHasVariableDataType) Begin
37665>>>>>>>                Get piVariableBufferLength      to iVariableBufferLength
37666>>>>>>>                Get piMaxVariableBufferLength   to iLen
37667>>>>>>>                If (iLen > iVariableBufferLength) Begin
37669>>>>>>>                    //*** Allocate
37669>>>>>>>                    Move (Repeat(' ', iLen)) to sVariableResult
37670>>>>>>>                   
37670>>>>>>>                    Set piVariableBufferLength to iLen
37671>>>>>>>                    Set psVariableBuffer       to sVariableResult
37672>>>>>>>                    
37672>>>>>>>                    Get piVariableBufferLength to iVariableBufferLength                
37673>>>>>>>                End
37673>>>>>>>>
37673>>>>>>>                Else Begin
37674>>>>>>>                   Set psVariableBuffer       to sVariableResult
37675>>>>>>>                End
37675>>>>>>>>
37675>>>>>>>            End
37675>>>>>>>>
37675>>>>>>>
37675>>>>>>>            Get psMaxColValue to sMax
37676>>>>>>>
37676>>>>>>>            //*** Call the driver function to fetch
37676>>>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
37681>>>>>>>            If (Err) Move 0 to iResult
37684>>>>>>>
37684>>>>>>>            While (iResult <> 0)
37688>>>>>>>
37688>>>>>>>                For iCol from 1 to (iColCount)
37694>>>>>>>>
37694>>>>>>>                    
37694>>>>>>>                    If (not(aSQLColumns[iCol].iVariableDataType)) Begin
37696>>>>>>>                        Move sMax to sResult
37697>>>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                                    Callback 0 ;                                    Passing sResult sEmpty iCol ;                                    Result iVoid
37702>>>>>>>                        Move sResult to asValues[iRow][iCol - 1]
37703>>>>>>>                    End
37703>>>>>>>>
37703>>>>>>>                    Else Begin
37704>>>>>>>                        //Variable data    
37704>>>>>>>                        Move sVariableResult to sResult
37705>>>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                    Callback 0 ;                                    Passing sResult iCol iVariableBufferLength ;                                    Result iVoid
37710>>>>>>>                                    
37710>>>>>>>                        Move sResult to asValues[iRow][iCol - 1]
37711>>>>>>>                    End
37711>>>>>>>>
37711>>>>>>>                Loop
37712>>>>>>>>
37712>>>>>>>
37712>>>>>>>                Increment iRow
37713>>>>>>>
37713>>>>>>>                //*** Call the driver function to fetch
37713>>>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
37718>>>>>>>                If (Err) Move 0 to iResult
37721>>>>>>>
37721>>>>>>>            Loop
37722>>>>>>>>
37722>>>>>>>
37722>>>>>>>        End
37722>>>>>>>>
37722>>>>>>>        Else Send HandleError ihstmt ihdbc sDrvrId "SQLFetchResultsetValues"
37724>>>>>>>
37724>>>>>>>        Set piFetchResult to iResult
37725>>>>>>>
37725>>>>>>>        Function_Return asValues
37726>>>>>>>    End_Function 
37727>>>>>>>
37727>>>>>>>
37727>>>>>>>
37727>>>>>>>    //***
37727>>>>>>>    //*** Function: SQLNextColumn
37727>>>>>>>    //*** Purpose : Get the next column
37727>>>>>>>    //***
37727>>>>>>>
37727>>>>>>>    Function SQLNextColumn Returns String
37729>>>>>>>        Integer iCol
37729>>>>>>>        String  sResult
37729>>>>>>>
37729>>>>>>>        Get piLastColumn To iCol
37730>>>>>>>        Increment iCol
37731>>>>>>>        Get SQLColumnValue iCol To sResult
37732>>>>>>>        Set piLastColumn To iCol
37733>>>>>>>
37733>>>>>>>        Function_return sResult
37734>>>>>>>    End_Function 
37735>>>>>>>
37735>>>>>>>
37735>>>>>>>    //***
37735>>>>>>>    //*** Function: SQLColumnType
37735>>>>>>>    //*** Purpose : Returns the native type of a column
37735>>>>>>>    //***
37735>>>>>>>    Function SQLColumnType Integer iCol Returns Integer
37737>>>>>>>        Integer ihdbc
37737>>>>>>>        Integer ihstmt
37737>>>>>>>        String  sDrvrId
37737>>>>>>>        Integer iSQLType
37737>>>>>>>        Integer iColumns
37737>>>>>>>        
37737>>>>>>>        tSQLColumn[] aSQLColumns
37737>>>>>>>        tSQLColumn[] aSQLColumns
37738>>>>>>>        
37738>>>>>>>        //*** Get the cli handles
37738>>>>>>>        Get phCLIStatementHandle  to ihstmt
37739>>>>>>>        Get phCLIConnectionHandle to ihdbc
37740>>>>>>>        Get psDriverId            to sDrvrId
37741>>>>>>>
37741>>>>>>>        //*** Get the value
37741>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37743>>>>>>>        
37743>>>>>>>            Get paSQLColumns   to aSQLColumns        
37744>>>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
37745>>>>>>>            
37745>>>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
37747>>>>>>>                Move aSQLColumns[iCol].iSQLType to iSQLType
37748>>>>>>>            End
37748>>>>>>>>
37748>>>>>>>            Else Begin
37749>>>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnType"        
37750>>>>>>>            End
37750>>>>>>>>
37750>>>>>>>        End
37750>>>>>>>>
37750>>>>>>>        Else Begin
37751>>>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnType"
37752>>>>>>>        End
37752>>>>>>>>
37752>>>>>>>
37752>>>>>>>        Function_Return iSQLType
37753>>>>>>>    End_Function 
37754>>>>>>>
37754>>>>>>>    //***
37754>>>>>>>    //*** Function: SQLColumnSize
37754>>>>>>>    //*** Purpose : Returns the size (max length) of a column
37754>>>>>>>    //***
37754>>>>>>>    Function SQLColumnSize Integer iCol Returns Integer
37756>>>>>>>        Integer ihdbc
37756>>>>>>>        Integer ihstmt
37756>>>>>>>        String  sDrvrId
37756>>>>>>>        Integer iSQLSize
37756>>>>>>>        Integer iColumns
37756>>>>>>>        
37756>>>>>>>        tSQLColumn[] aSQLColumns
37756>>>>>>>        tSQLColumn[] aSQLColumns
37757>>>>>>>        
37757>>>>>>>        //*** Get the cli handles
37757>>>>>>>        Get phCLIStatementHandle  to ihstmt
37758>>>>>>>        Get phCLIConnectionHandle to ihdbc
37759>>>>>>>        Get psDriverId            to sDrvrId
37760>>>>>>>
37760>>>>>>>        //*** Get the value
37760>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37762>>>>>>>        
37762>>>>>>>            Get paSQLColumns   to aSQLColumns        
37763>>>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
37764>>>>>>>            
37764>>>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
37766>>>>>>>                Move aSQLColumns[iCol].iSQLSize to iSQLSize
37767>>>>>>>            End
37767>>>>>>>>
37767>>>>>>>            Else Begin
37768>>>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnSize"        
37769>>>>>>>            End
37769>>>>>>>>
37769>>>>>>>        End
37769>>>>>>>>
37769>>>>>>>        Else Begin
37770>>>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnSize"
37771>>>>>>>        End
37771>>>>>>>>
37771>>>>>>>
37771>>>>>>>        Function_Return iSQLSize
37772>>>>>>>    End_Function 
37773>>>>>>>
37773>>>>>>>    //***
37773>>>>>>>    //*** Function: SQLColumnVariableDatatype
37773>>>>>>>    //*** Purpose : Returns 1 for variable length datatypes. 
37773>>>>>>>    //***           For example SQL Server varchar(max) or text type
37773>>>>>>>    //***           The data of variable length datatype columns should be retrieved with SQLGetData 
37773>>>>>>>    Function SQLColumnVariableDatatype Integer iCol Returns Integer
37775>>>>>>>        Integer ihdbc
37775>>>>>>>        Integer ihstmt
37775>>>>>>>        String  sDrvrId
37775>>>>>>>        Integer iVariableDataType
37775>>>>>>>        Integer iColumns
37775>>>>>>>        
37775>>>>>>>        tSQLColumn[] aSQLColumns
37775>>>>>>>        tSQLColumn[] aSQLColumns
37776>>>>>>>        
37776>>>>>>>        //*** Get the cli handles
37776>>>>>>>        Get phCLIStatementHandle  to ihstmt
37777>>>>>>>        Get phCLIConnectionHandle to ihdbc
37778>>>>>>>        Get psDriverId            to sDrvrId
37779>>>>>>>
37779>>>>>>>        //*** Get the value
37779>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37781>>>>>>>        
37781>>>>>>>            Get paSQLColumns   to aSQLColumns        
37782>>>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
37783>>>>>>>            
37783>>>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
37785>>>>>>>                Move aSQLColumns[iCol].iVariableDataType to iVariableDataType
37786>>>>>>>            End
37786>>>>>>>>
37786>>>>>>>            Else Begin
37787>>>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnVariableDatatype"        
37788>>>>>>>            End
37788>>>>>>>>
37788>>>>>>>        End
37788>>>>>>>>
37788>>>>>>>        Else Begin
37789>>>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnVariableDatatype"
37790>>>>>>>        End
37790>>>>>>>>
37790>>>>>>>
37790>>>>>>>        Function_Return iVariableDataType
37791>>>>>>>    End_Function 
37792>>>>>>>
37792>>>>>>>
37792>>>>>>>
37792>>>>>>>
37792>>>>>>>    //***
37792>>>>>>>    //*** Function: SQLColumnValue
37792>>>>>>>    //*** Purpose : Return the value of a column in a fetched row of a given
37792>>>>>>>    //***           statement.
37792>>>>>>>    //***
37792>>>>>>>    Function SQLColumnValue Integer iCol Returns String
37794>>>>>>>        Integer ihdbc
37794>>>>>>>        Integer ihstmt
37794>>>>>>>        String  sDrvrId
37794>>>>>>>        String  sResult
37794>>>>>>>
37794>>>>>>>        Integer iVoid
37794>>>>>>>        Integer iColSize
37794>>>>>>>        Integer iColPrecision
37794>>>>>>>        String  sEmpty
37794>>>>>>>        Integer bLegalColumn
37794>>>>>>>
37794>>>>>>>        //*** Initialize
37794>>>>>>>        Move "" To sResult
37795>>>>>>>
37795>>>>>>>        //*** Get the cli handles
37795>>>>>>>        Get phCLIStatementHandle  to ihstmt
37796>>>>>>>        Get phCLIConnectionHandle to ihdbc
37797>>>>>>>        Get psDriverId            to sDrvrId
37798>>>>>>>
37798>>>>>>>        // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
37798>>>>>>>        // in the next FUNC_SQLCOLUMNVALUE call.
37798>>>>>>>        // If hdbc and hstmt have not changed since the last call we don't have to set it.
37798>>>>>>>        If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
37800>>>>>>>            //*** Setup function arguments
37800>>>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback 0 ;                        Passing ihdbc iCol ihstmt ;                        Result iVoid
37805>>>>>>>            Move ihstmt to giLastSQLhstmt
37806>>>>>>>            Move ihdbc to giLastSQLhdbc
37807>>>>>>>        End
37807>>>>>>>>
37807>>>>>>>
37807>>>>>>>        If (iCol >= 1 and iCol <= piColumnCount(Self)) Begin
37809>>>>>>>            Get psMaxColValue to sResult
37810>>>>>>>            //*** Call the driver function to get the value
37810>>>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                        Callback 0 ;                        Passing sResult sEmpty iCol ;                        Result iVoid
37815>>>>>>>        End
37815>>>>>>>>
37815>>>>>>>        Else Begin
37816>>>>>>>            Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnValue"
37817>>>>>>>        End
37817>>>>>>>>
37817>>>>>>>
37817>>>>>>>        Function_Return sResult
37818>>>>>>>        
37818>>>>>>>    End_Function
37819>>>>>>>
37819>>>>>>>
37819>>>>>>>
37819>>>>>>>    //***
37819>>>>>>>    //*** Procedure: SQLBindFile
37819>>>>>>>    //*** Purpose  : Add a file to the files used to place the statement result in.
37819>>>>>>>    //***
37819>>>>>>>
37819>>>>>>>    Procedure SQLBindFile Integer iFileNum
37821>>>>>>>        Integer ihdbc
37821>>>>>>>        Integer ihstmt
37821>>>>>>>        Integer iVoid
37821>>>>>>>        String  sDrvrId
37821>>>>>>>        String  sFileType
37821>>>>>>>        Integer bIsOpen
37821>>>>>>>
37821>>>>>>>        //*** Get the cli handles
37821>>>>>>>        Get phCLIStatementHandle  to ihstmt
37822>>>>>>>        Get phCLIConnectionHandle to ihdbc
37823>>>>>>>        Get psDriverId            to sDrvrId
37824>>>>>>>
37824>>>>>>>        //*** If a file number is not passed see if we can use the statement's
37824>>>>>>>        //*** default file number which is usually set with SetFileConnection
37824>>>>>>>        If (iFileNum = 0) Begin
37826>>>>>>>            Get piBindFile To iFileNum
37827>>>>>>>            If (iFileNum = 0) Begin
37829>>>>>>>                //*** Logic error, if 0 is passed as filenumber, piBindFile should be set.
37829>>>>>>>                Send StmtError CLIERR_SQLINVALID_BIND_FILE "piBindFile should be set" "SQLBindFile"
37830>>>>>>>
37830>>>>>>>                Move 0 to SQLResult
37831>>>>>>>                Procedure_Return
37832>>>>>>>            End
37832>>>>>>>>
37832>>>>>>>        End
37832>>>>>>>>
37832>>>>>>>
37832>>>>>>>        //*** Bind the file
37832>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37834>>>>>>>            //*** Chek if the file is open
37834>>>>>>>            Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
37837>>>>>>>            If (bIsOpen) Begin
37839>>>>>>>                //*** Check if the file has the correct type
37839>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
37842>>>>>>>                If (sFileType = sDrvrId) Begin
37844>>>>>>>                    //*** Call the driver function to add a file to a statement
37844>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLBINDFILE ;                                Callback Self ;                                Passing ihdbc iFileNum ihstmt ;                                Result iVoid
37849>>>>>>>                End
37849>>>>>>>>
37849>>>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
37851>>>>>>>            End
37851>>>>>>>>
37851>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File not open (number =" * String(iFileNum) + ")") "SQLBindFile"
37853>>>>>>>        End
37853>>>>>>>>
37853>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLBindFile"
37855>>>>>>>    End_Procedure 
37856>>>>>>>
37856>>>>>>>
37856>>>>>>>
37856>>>>>>>    //*************************************************************************
37856>>>>>>>    //*** Function: SQLGetData                                              ***
37856>>>>>>>    //*** Purpose : Get data of a column.                                   ***
37856>>>>>>>    //*************************************************************************
37856>>>>>>>
37856>>>>>>>    Function SQLGetData Integer iCol Integer iLen Returns String
37858>>>>>>>        Integer ihdbc
37858>>>>>>>        Integer ihstmt
37858>>>>>>>        Integer iVoid
37858>>>>>>>        Integer iColSize
37858>>>>>>>        Integer iResult
37858>>>>>>>        String  sDrvrId
37858>>>>>>>        String  sResult
37858>>>>>>>        String  sEmpty
37858>>>>>>>        Integer bLegalColumn
37858>>>>>>>        
37858>>>>>>>        Integer iVariableBufferLength
37858>>>>>>>
37858>>>>>>>        //*** Initialize
37858>>>>>>>        Move "" To sEmpty
37859>>>>>>>        Move 0 To iResult
37860>>>>>>>
37860>>>>>>>        //*** Get the cli handles
37860>>>>>>>        Get phCLIStatementHandle  to ihstmt
37861>>>>>>>        Get phCLIConnectionHandle to ihdbc
37862>>>>>>>        Get psDriverId            to sDrvrId
37863>>>>>>>
37863>>>>>>>        //*** Get the data
37863>>>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
37865>>>>>>>            //*** Check if the column exists
37865>>>>>>>            If (iCol >= 1 and iCol <= piColumnCount(Self)) Begin
37867>>>>>>>                If (iLen = 0) Begin
37869>>>>>>>                    Get SQLColumnValue iCol to sResult
37870>>>>>>>                End
37870>>>>>>>>
37870>>>>>>>                Else Begin
37871>>>>>>>                    // Add 1 for string terminator
37871>>>>>>>                    Move (iLen + 1) to iLen
37872>>>>>>>
37872>>>>>>>                    Get piVariableBufferLength to iVariableBufferLength
37873>>>>>>>                    If (iLen > iVariableBufferLength) Begin
37875>>>>>>>                        //*** Allocate
37875>>>>>>>                        Move (Repeat(' ', iLen)) to sResult
37876>>>>>>>                       
37876>>>>>>>                        Set piVariableBufferLength to iLen
37877>>>>>>>                        Set psVariableBuffer       to sResult
37878>>>>>>>                    End
37878>>>>>>>>
37878>>>>>>>                    Else Begin
37879>>>>>>>                        Get psVariableBuffer       to sResult
37880>>>>>>>                    End
37880>>>>>>>>
37880>>>>>>>
37880>>>>>>>
37880>>>>>>>                    // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
37880>>>>>>>                    // in the next FUNC_SQLCOLUMNVALUE call.
37880>>>>>>>                    // If hdbc and hstmt have not changed since the last call we don't have to set it.
37880>>>>>>>                    If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
37882>>>>>>>                        //*** Setup function arguments
37882>>>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                    Callback 0 ;                                    Passing ihdbc iCol ihstmt ;                                    Result iVoid
37887>>>>>>>                        Move ihstmt to giLastSQLhstmt
37888>>>>>>>                        Move ihdbc to giLastSQLhdbc
37889>>>>>>>                    End
37889>>>>>>>>
37889>>>>>>>
37889>>>>>>>                    Indicate Err False
37890>>>>>>>                    //*** Call the driver function to get the data
37890>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                Callback Self ;                                Passing sResult iCol iLen ;                                Result iResult
37895>>>>>>>
37895>>>>>>>                    //*** If something went wrong, adjust the result
37895>>>>>>>                    If (Err) Begin
37897>>>>>>>                        Move 0 to iResult
37898>>>>>>>                    End
37898>>>>>>>>
37898>>>>>>>                End
37898>>>>>>>>
37898>>>>>>>            End
37898>>>>>>>>
37898>>>>>>>            Else Begin
37899>>>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLGetData"
37900>>>>>>>            End
37900>>>>>>>>
37900>>>>>>>        End
37900>>>>>>>>
37900>>>>>>>        Else Begin
37901>>>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLGetData"
37902>>>>>>>        End
37902>>>>>>>>
37902>>>>>>>
37902>>>>>>>        //*** Fill global result
37902>>>>>>>        Move iResult To SQLResult
37903>>>>>>>
37903>>>>>>>        Function_Return sResult
37904>>>>>>>    End_Function 
37905>>>>>>>
37905>>>>>>>
37905>>>>>>>
37905>>>>>>>    //***
37905>>>>>>>    //*** Function: SQLColumnMap
37905>>>>>>>    //*** Purpose : Map a column name to a number, if the name id not found no
37905>>>>>>>    //***           error is generated the returned number will be 0 (zero) in
37905>>>>>>>    //***           that case
37905>>>>>>>    //***
37905>>>>>>>
37905>>>>>>>    Function SQLColumnMap String sColname Returns Integer
37907>>>>>>>        Integer ihdbc
37907>>>>>>>        Integer ihstmt
37907>>>>>>>        Integer iNumColumns
37907>>>>>>>        Integer iColCount
37907>>>>>>>        Integer iColNum
37907>>>>>>>        String  sDrvrId
37907>>>>>>>        String  sCurColName
37907>>>>>>>
37907>>>>>>>        //*** Get the cli handles
37907>>>>>>>        Get phCLIStatementHandle  to ihstmt
37908>>>>>>>        Get phCLIConnectionHandle to ihdbc
37909>>>>>>>        Get psDriverId            to sDrvrId
37910>>>>>>>
37910>>>>>>>        //*** Get the number by looping through the column names
37910>>>>>>>        Move 0 To iColNum
37911>>>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
37912>>>>>>>        For iColCount From 1 To iNumColumns
37918>>>>>>>>
37918>>>>>>>            Get SQLPrivateColAttribute iColCount SQLCOLATTRIB_LABEL ihdbc sDrvrId ihstmt To sCurColName
37919>>>>>>>            If (Uppercase(Trim(sColName)) = Uppercase(Trim(sCurColName))) ;                Move iColCount To iColNum
37922>>>>>>>
37922>>>>>>>            If (iColNum) ;                Break
37925>>>>>>>        Loop
37926>>>>>>>>
37926>>>>>>>
37926>>>>>>>        Function_return iColNum
37927>>>>>>>    End_Function 
37928>>>>>>>
37928>>>>>>>
37928>>>>>>>
37928>>>>>>>    //***
37928>>>>>>>    //*** Function: SQLStmtAttribute
37928>>>>>>>    //*** Purpose : Get a statement attribute
37928>>>>>>>    //***
37928>>>>>>>
37928>>>>>>>    Function SQLStmtAttribute Integer iAttribId Returns String
37930>>>>>>>        Integer ihdbc
37930>>>>>>>        Integer ihstmt
37930>>>>>>>        String  sResult
37930>>>>>>>        String  sDrvrId
37930>>>>>>>
37930>>>>>>>        //*** Initialize
37930>>>>>>>        Move "" To sResult
37931>>>>>>>
37931>>>>>>>        //*** Get the cli handles
37931>>>>>>>        Get phCLIStatementHandle  to ihstmt
37932>>>>>>>        Get phCLIConnectionHandle to ihdbc
37933>>>>>>>        Get psDriverId            to sDrvrId
37934>>>>>>>
37934>>>>>>>        //*** Get the attribute
37934>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateStmtAttribute iAttribId ihdbc sDrvrId ihstmt To sResult
37937>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLStmtAttribute"
37939>>>>>>>
37939>>>>>>>        Function_Return sResult
37940>>>>>>>    End_Function 
37941>>>>>>>
37941>>>>>>>    Function SQLPrivateStmtAttribute Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
37943>>>>>>>        String  sResult
37943>>>>>>>        Integer iLen
37943>>>>>>>        Integer bLegalAttrib
37943>>>>>>>
37943>>>>>>>        //*** Initialize
37943>>>>>>>        Move ""     To sResult
37944>>>>>>>
37944>>>>>>>        //*** Get the attribute
37944>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37946>>>>>>>            Case Begin
37946>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_COLUMNCOUNT)
37948>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT)
37951>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT_TYPE)
37954>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_NUMMESSAGES)
37957>>>>>>>                    Move DFTRUE To bLegalAttrib
37958>>>>>>>                    Break
37959>>>>>>>
37959>>>>>>>                Case Else
37959>>>>>>>                    Move DFFALSE To bLegalAttrib
37960>>>>>>>                    Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateStmtAttribute"
37961>>>>>>>            Case End
37961>>>>>>>
37961>>>>>>>            If (bLegalAttrib) Begin
37963>>>>>>>                //*** Setup function arguments
37963>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSTMTINTATTRIB ;                            Callback Self ;                            Passing ihdbc iAttribId ihstmt ;                            Result sResult
37968>>>>>>>            End
37968>>>>>>>>
37968>>>>>>>        End
37968>>>>>>>>
37968>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateStmtAttribute"
37970>>>>>>>
37970>>>>>>>        Function_Return sResult
37971>>>>>>>    End_Function 
37972>>>>>>>
37972>>>>>>>
37972>>>>>>>
37972>>>>>>>    //***
37972>>>>>>>    //*** Function: SQLColAttribute
37972>>>>>>>    //*** Purpose : Get a column's attribute
37972>>>>>>>    //***
37972>>>>>>>
37972>>>>>>>    Function SQLColAttribute Integer iCol Integer iAttribId Returns String
37974>>>>>>>        Integer ihdbc
37974>>>>>>>        Integer ihstmt
37974>>>>>>>        String  sResult
37974>>>>>>>        String  sDrvrId
37974>>>>>>>
37974>>>>>>>        //*** Initialize
37974>>>>>>>        Move "" To sResult
37975>>>>>>>
37975>>>>>>>        //*** Get the cli handles
37975>>>>>>>        Get phCLIStatementHandle  to ihstmt
37976>>>>>>>        Get phCLIConnectionHandle to ihdbc
37977>>>>>>>        Get psDriverId            to sDrvrId
37978>>>>>>>
37978>>>>>>>        //*** Get the attribute
37978>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColAttribute iCol iAttribId ihdbc sDrvrId ihstmt To sResult
37981>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColAttribute"
37983>>>>>>>
37983>>>>>>>        Function_Return sResult
37984>>>>>>>    End_Function 
37985>>>>>>>
37985>>>>>>>    Function SQLPrivateColAttribute Integer iCol Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
37987>>>>>>>        String  sResult
37987>>>>>>>        String  sEmpty
37987>>>>>>>        Integer bIsStringAttribute
37987>>>>>>>        Integer iLen
37987>>>>>>>        Integer iVoid
37987>>>>>>>        Integer bLegalAttrib
37987>>>>>>>        Integer bLegalColumn
37987>>>>>>>
37987>>>>>>>        //*** Initialize
37987>>>>>>>        Move "" To sResult
37988>>>>>>>        Move "" To sEmpty
37989>>>>>>>        MOve 0  To iLen
37990>>>>>>>
37990>>>>>>>        //*** Get the attribute
37990>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
37992>>>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
37993>>>>>>>            If (bLegalColumn) Begin
37995>>>>>>>                //*** Determine the atributes type
37995>>>>>>>                Case Begin
37995>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_SIZE)
37997>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_LENGTH)
38000>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_PRECISION)
38003>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_SQLTYPE)
38006>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_NULLABLE)
38009>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_DFTYPE)
38012>>>>>>>                        Move DFFALSE To bIsStringAttribute
38013>>>>>>>                        Move DFTRUE To bLegalAttrib
38014>>>>>>>                        Break
38015>>>>>>>
38015>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_LABEL)
38018>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASECOLUMNNAME)
38021>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASETABLENAME)
38024>>>>>>>                        Move DFTRUE To bIsStringAttribute
38025>>>>>>>                        Move DFTRUE To bLegalAttrib
38026>>>>>>>                        Break
38027>>>>>>>
38027>>>>>>>                    Case Else
38027>>>>>>>                        Move DFFALSE To bLegalAttrib
38028>>>>>>>                        Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateColAttribute"
38029>>>>>>>                Case End
38029>>>>>>>
38029>>>>>>>                If (bLegalAttrib) Begin
38031>>>>>>>                    //*** Setup function arguments
38031>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Self ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
38036>>>>>>>
38036>>>>>>>                    If (bIsStringAttribute) Begin
38038>>>>>>>                        //*** Call the driver function to get the data length
38038>>>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIBLEN ;                                    Callback Self ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result iLen
38043>>>>>>>
38043>>>>>>>                        If (iLen) Begin
38045>>>>>>>                            //*** Allocate
38045>>>>>>>                            Move (Repeat(' ', iLen)) To sResult
38046>>>>>>>
38046>>>>>>>                            //*** Call the driver function to get the name
38046>>>>>>>                            Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIB ;                                        Callback Self ;                                        Passing sResult sEmpty iAttribId ;                                        Result iVoid
38051>>>>>>>                        End
38051>>>>>>>>
38051>>>>>>>                    End
38051>>>>>>>>
38051>>>>>>>                    Else Begin
38052>>>>>>>                        //*** get the attribute
38052>>>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLINTATTRIB ;                                    Callback Self ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result sResult
38057>>>>>>>                    End
38057>>>>>>>>
38057>>>>>>>                End
38057>>>>>>>>
38057>>>>>>>            End
38057>>>>>>>>
38057>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColAttribute"
38059>>>>>>>        End
38059>>>>>>>>
38059>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColAttribute"
38061>>>>>>>
38061>>>>>>>        Function_Return sResult
38062>>>>>>>    End_Function 
38063>>>>>>>
38063>>>>>>>
38063>>>>>>>
38063>>>>>>>    //***
38063>>>>>>>    //*** Procedure: SQLSetProcedureName
38063>>>>>>>    //*** Purpsoe  : Preapre for calling a stored procedure, pass the procedure name.
38063>>>>>>>    //***
38063>>>>>>>
38063>>>>>>>    Procedure SQLSetProcedureName String sProcName String sSchemaArg
38065>>>>>>>        Integer ihdbc
38065>>>>>>>        Integer ihstmt
38065>>>>>>>        String  sDrvrId
38065>>>>>>>        Integer iVoid
38065>>>>>>>        String  sSchema
38065>>>>>>>        String  sEmpty
38065>>>>>>>
38065>>>>>>>        //*** Initialize
38065>>>>>>>        Move "" To sEmpty
38066>>>>>>>
38066>>>>>>>        //*** Get the cli handles
38066>>>>>>>        Get phCLIStatementHandle  to ihstmt
38067>>>>>>>        Get phCLIConnectionHandle to ihdbc
38068>>>>>>>        Get psDriverId            to sDrvrId
38069>>>>>>>
38069>>>>>>>        //*** Call the procedure
38069>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38071>>>>>>>            If (Num_Arguments >= 2) ;                Move sSchemaArg To sSchema
38074>>>>>>>            Else ;                Move "" To sSchema
38076>>>>>>>
38076>>>>>>>            If (sSchema <> "") Begin
38078>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSETPROCSCHEMA ;                            Callback Self ;                            Passing ihdbc sSchema ihstmt ;                            Result iVoid
38083>>>>>>>            End
38083>>>>>>>>
38083>>>>>>>
38083>>>>>>>            //*** Call the procedure
38083>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCNAME ;                        Callback Self ;                        Passing ihdbc sProcName ihstmt ;                        Result iVoid
38088>>>>>>>
38088>>>>>>>            Set piLastArgument To 0
38089>>>>>>>        End
38089>>>>>>>>
38089>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetProcedurename"
38091>>>>>>>    End_Procedure 
38092>>>>>>>
38092>>>>>>>
38092>>>>>>>
38092>>>>>>>    //***
38092>>>>>>>    //*** Function: SQLSetNextArgument
38092>>>>>>>    //*** Purpose : Pass the next argument
38092>>>>>>>    //***
38092>>>>>>>
38092>>>>>>>    Procedure SQLSetNextArgument String sArgument
38094>>>>>>>        Integer iArgnum
38094>>>>>>>
38094>>>>>>>        Get piLastArgument To iArgnum
38095>>>>>>>        Increment iArgnum
38096>>>>>>>        Send SQLSetArgument iArgnum sArgument
38097>>>>>>>        Set piLastArgument To iArgnum
38098>>>>>>>    End_Procedure 
38099>>>>>>>
38099>>>>>>>
38099>>>>>>>
38099>>>>>>>    //***
38099>>>>>>>    //*** Procedure: SQLSetArgument
38099>>>>>>>    //*** Purpose  : Set the next argument
38099>>>>>>>    //***
38099>>>>>>>
38099>>>>>>>    Procedure SQLSetArgument Integer iArgnum String sArgument
38101>>>>>>>        Integer ihdbc
38101>>>>>>>        Integer ihstmt
38101>>>>>>>        String  sDrvrId
38101>>>>>>>        Integer iVoid
38101>>>>>>>        String  sEmpty
38101>>>>>>>
38101>>>>>>>        //*** Initialize
38101>>>>>>>        Move "" To sEmpty
38102>>>>>>>
38102>>>>>>>        //*** Get the cli handles
38102>>>>>>>        Get phCLIStatementHandle  to ihstmt
38103>>>>>>>        Get phCLIConnectionHandle to ihdbc
38104>>>>>>>        Get psDriverId            to sDrvrId
38105>>>>>>>
38105>>>>>>>        //*** Call the procedure
38105>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38107>>>>>>>            //*** Pass the information
38107>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
38112>>>>>>>
38112>>>>>>>            //*** Pass the argument
38112>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCARG ;                        Callback Self ;                        Passing sArgument sEmpty 0 ;                        Result iVoid
38117>>>>>>>        End
38117>>>>>>>>
38117>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetArgument"
38119>>>>>>>    End_Procedure
38120>>>>>>>
38120>>>>>>>
38120>>>>>>>
38120>>>>>>>    //***
38120>>>>>>>    //*** Procedure: SQLCall
38120>>>>>>>    //*** Purpose  : Call a stored procedure
38120>>>>>>>    //***
38120>>>>>>>
38120>>>>>>>    Procedure SQLCall
38122>>>>>>>        Integer ihdbc
38122>>>>>>>        Integer ihstmt
38122>>>>>>>        String  sDrvrId
38122>>>>>>>        Integer iVoid
38122>>>>>>>        String  sEmpty
38122>>>>>>>
38122>>>>>>>        //*** Initialize
38122>>>>>>>        Move "" To sEmpty
38123>>>>>>>
38123>>>>>>>        //*** Get the cli handles
38123>>>>>>>        Get phCLIStatementHandle  to ihstmt
38124>>>>>>>        Get phCLIConnectionHandle to ihdbc
38125>>>>>>>        Get psDriverId            to sDrvrId
38126>>>>>>>
38126>>>>>>>        //*** Call the procedure
38126>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38128>>>>>>>            //*** Call the procedure
38128>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCALL ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
38133>>>>>>>                        
38133>>>>>>>            Send SQLGetStatementAttributes
38134>>>>>>>            Set piLastArgument To 0
38135>>>>>>>        End
38135>>>>>>>>
38135>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLCall"
38137>>>>>>>    End_Procedure 
38138>>>>>>>
38138>>>>>>>
38138>>>>>>>
38138>>>>>>>    //***
38138>>>>>>>    //*** Function: SQLGetNextArgument
38138>>>>>>>    //*** Purpose : Get the next argument
38138>>>>>>>    //***
38138>>>>>>>
38138>>>>>>>    Function SQLGetNextArgument Returns String
38140>>>>>>>        Integer iArgnum
38140>>>>>>>        String  sResult
38140>>>>>>>
38140>>>>>>>        Get piLastArgument To iArgnum
38141>>>>>>>        Increment iArgnum
38142>>>>>>>        Get SQLGetArgument iArgnum To sResult
38143>>>>>>>        Set piLastArgument To iArgnum
38144>>>>>>>
38144>>>>>>>        Function_return sResult
38145>>>>>>>    End_Function 
38146>>>>>>>
38146>>>>>>>
38146>>>>>>>
38146>>>>>>>    //***
38146>>>>>>>    //*** Function: SQLGetArgument
38146>>>>>>>    //*** Purpose : Get the specified argument from a procedure
38146>>>>>>>    //***
38146>>>>>>>
38146>>>>>>>    Function SQLGetArgument Integer iArgnum Returns String
38148>>>>>>>        Integer ihdbc
38148>>>>>>>        Integer ihstmt
38148>>>>>>>        String  sDrvrId
38148>>>>>>>        Integer iVoid
38148>>>>>>>        String  sEmpty
38148>>>>>>>        String  sArgument
38148>>>>>>>        Integer iLen
38148>>>>>>>
38148>>>>>>>        //*** Initialize
38148>>>>>>>        Move "" To sEmpty
38149>>>>>>>        Move "" To sArgument
38150>>>>>>>
38150>>>>>>>        //*** Get the cli handles
38150>>>>>>>        Get phCLIStatementHandle  to ihstmt
38151>>>>>>>        Get phCLIConnectionHandle to ihdbc
38152>>>>>>>        Get psDriverId            to sDrvrId
38153>>>>>>>
38153>>>>>>>        //*** Call the procedure
38153>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38155>>>>>>>            //*** Pass the information
38155>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
38160>>>>>>>
38160>>>>>>>            //*** Get the length
38160>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARGLEN ;                        Callback Self ;                        Passing sEmpty sEmpty 0 ;                        Result iLen
38165>>>>>>>
38165>>>>>>>            If (iLen) Begin
38167>>>>>>>                //*** Allocate
38167>>>>>>>                Move (Repeat(' ', iLen)) To sArgument
38168>>>>>>>
38168>>>>>>>                //*** Pass the argument
38168>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARG ;                            Callback Self ;                            Passing sArgument sEmpty 0 ;                            Result iVoid
38173>>>>>>>            End
38173>>>>>>>>
38173>>>>>>>        End
38173>>>>>>>>
38173>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetArgument"
38175>>>>>>>
38175>>>>>>>        Function_Return sArgument
38176>>>>>>>    End_Function 
38177>>>>>>>
38177>>>>>>>
38177>>>>>>>
38177>>>>>>>    //***
38177>>>>>>>    //*** Function: SQLReturnValue
38177>>>>>>>    //*** Purpose : Get the return value of a stored function
38177>>>>>>>    //***
38177>>>>>>>
38177>>>>>>>    Function SQLReturnValue Returns String
38179>>>>>>>        Integer ihdbc
38179>>>>>>>        Integer ihstmt
38179>>>>>>>        String  sDrvrId
38179>>>>>>>        Integer iVoid
38179>>>>>>>        String  sEmpty
38179>>>>>>>        String  sRetval
38179>>>>>>>        Integer iLen
38179>>>>>>>
38179>>>>>>>        //*** Initialize
38179>>>>>>>        Move "" To sEmpty
38180>>>>>>>        Move "" To sRetval
38181>>>>>>>
38181>>>>>>>        //*** Get the cli handles
38181>>>>>>>        Get phCLIStatementHandle  to ihstmt
38182>>>>>>>        Get phCLIConnectionHandle to ihdbc
38183>>>>>>>        Get psDriverId            to sDrvrId
38184>>>>>>>
38184>>>>>>>        //*** Call the procedure
38184>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38186>>>>>>>            //*** Get the length
38186>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVALLEN ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iLen
38191>>>>>>>
38191>>>>>>>            If (iLen) Begin
38193>>>>>>>                //*** Allocate
38193>>>>>>>                Move (Repeat(' ', iLen)) To sRetval
38194>>>>>>>
38194>>>>>>>                //*** Pass the argument
38194>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVAL ;                            Callback Self ;                            Passing ihdbc sRetval ihstmt ;                            Result iVoid
38199>>>>>>>            End
38199>>>>>>>>
38199>>>>>>>        End
38199>>>>>>>>
38199>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLReturnValue"
38201>>>>>>>
38201>>>>>>>        Function_Return sRetval
38202>>>>>>>    End_Function 
38203>>>>>>>
38203>>>>>>>
38203>>>>>>>
38203>>>>>>>    //***
38203>>>>>>>    //*** Function: SQLNextResultSet
38203>>>>>>>    //*** Purpose : Switch to the next set
38203>>>>>>>    //*** Returns : 0   = No more result sets
38203>>>>>>>    //***           <>0 = Switched to next set
38203>>>>>>>    //***
38203>>>>>>>
38203>>>>>>>    Function SQLNextResultSet Returns Integer
38205>>>>>>>        Integer ihdbc
38205>>>>>>>        Integer ihstmt
38205>>>>>>>        String  sDrvrId
38205>>>>>>>        Integer iResult
38205>>>>>>>        String  sEmpty
38205>>>>>>>
38205>>>>>>>        //*** Initialize
38205>>>>>>>        Move "" To sEmpty
38206>>>>>>>        Move 0  To iResult
38207>>>>>>>
38207>>>>>>>        //*** Get the cli handles
38207>>>>>>>        Get phCLIStatementHandle  to ihstmt
38208>>>>>>>        Get phCLIConnectionHandle to ihdbc
38209>>>>>>>        Get psDriverId            to sDrvrId
38210>>>>>>>
38210>>>>>>>        //*** Call the procedure
38210>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38212>>>>>>>            //*** Get the length
38212>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLNEXTRESULTSET ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iResult
38217>>>>>>>                        
38217>>>>>>>            Send SQLGetStatementAttributes
38218>>>>>>>            Set piLastArgument to 0
38219>>>>>>>        End
38219>>>>>>>>
38219>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLNextResultSet"
38221>>>>>>>
38221>>>>>>>        Function_Return iResult
38222>>>>>>>    End_Function
38223>>>>>>>
38223>>>>>>>
38223>>>>>>>
38223>>>>>>>    //***
38223>>>>>>>    //*** Procedure: SQLFetchActivatesBuffer
38223>>>>>>>    //*** Purpose  : Setup a file that will be acivated after a succesfull
38223>>>>>>>    //***            fetch on the statement
38223>>>>>>>    //***
38223>>>>>>>
38223>>>>>>>    Procedure SQLFetchActivatesBuffer Integer iFileNum Integer bState
38225>>>>>>>        Integer ihdbc
38225>>>>>>>        Integer ihstmt
38225>>>>>>>        String  sDrvrId
38225>>>>>>>        Integer iResult
38225>>>>>>>        Integer bIsOpen
38225>>>>>>>        Integer iVoid
38225>>>>>>>        String  sFileType
38225>>>>>>>
38225>>>>>>>        //*** Check if file is open
38225>>>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
38228>>>>>>>        If (bIsOpen) Begin
38230>>>>>>>            //*** Get the cli handles
38230>>>>>>>            Get phCLIStatementHandle  to ihstmt
38231>>>>>>>            Get phCLIConnectionHandle to ihdbc
38232>>>>>>>            Get psDriverId            to sDrvrId
38233>>>>>>>
38233>>>>>>>            //*** Call the procedure
38233>>>>>>>            If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38235>>>>>>>                //*** Check if the file has the correct type
38235>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
38238>>>>>>>                If (sFileType = sDrvrId) Begin
38240>>>>>>>                    //*** Setup the buffer
38240>>>>>>>                    Call_driver iFileNum sDrvrId Function FUNC_SQLBUFFERSTATUS ;                                Callback Self ;                                Passing ihdbc bState ihstmt  ;                                Result iVoid
38245>>>>>>>                End
38245>>>>>>>>
38245>>>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
38247>>>>>>>            End
38247>>>>>>>>
38247>>>>>>>            Else ;                Send HandleError ihstmt ihdbc sDrvrId "SQLFetchActivatesBuffer"
38249>>>>>>>        End
38249>>>>>>>>
38249>>>>>>>        Else ;            Send StmtError CLIERR_SQLINVALID_BUFFER ("File not open (number =" * String(iFileNum) + ")") "SQLFetchActivatesBuffer"
38251>>>>>>>    End_Procedure 
38252>>>>>>>
38252>>>>>>>
38252>>>>>>>
38252>>>>>>>    Function SQLGetMessage Integer iMessageNum Returns String
38254>>>>>>>        Integer ihdbc
38254>>>>>>>        Integer ihstmt
38254>>>>>>>        String  sDrvrId
38254>>>>>>>        String  sMessage
38254>>>>>>>        Integer iVoid
38254>>>>>>>
38254>>>>>>>        //*** Initialize
38254>>>>>>>        Move "" To sMessage
38255>>>>>>>
38255>>>>>>>        //*** Get the cli handles
38255>>>>>>>        Get phCLIStatementHandle  to ihstmt
38256>>>>>>>        Get phCLIConnectionHandle to ihdbc
38257>>>>>>>        Get psDriverId            to sDrvrId
38258>>>>>>>
38258>>>>>>>        //*** Call the procedure
38258>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
38260>>>>>>>            //*** Setup function arguments
38260>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iMessageNum ihstmt ;                        Result iVoid
38265>>>>>>>
38265>>>>>>>            Move (Repeat(' ', 1024)) To sMessage
38266>>>>>>>            //*** Get the length
38266>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETMESSAGE ;                        Callback Self ;                        Passing iVoid sMessage iVoid ;                        Result iVoid
38271>>>>>>>        End
38271>>>>>>>>
38271>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetDiagRec"
38273>>>>>>>
38273>>>>>>>        Function_Return sMessage
38274>>>>>>>    End_Function 
38275>>>>>>>
38275>>>>>>>
38275>>>>>>>
38275>>>>>>>    //***
38275>>>>>>>    //*** Function: RemoveComponentIdentifier
38275>>>>>>>    //*** Purpose : Remove the component identifier from a diagnostic message
38275>>>>>>>    //***
38275>>>>>>>
38275>>>>>>>    Function RemoveComponentIdentifier String sDiagMessage Returns String
38277>>>>>>>        While (Left(sDiagMessage, 1) = "[")
38281>>>>>>>            Move (Right(sDiagMessage, Length(sDiagMessage) - Pos("]", sDiagMessage))) To sDiagMessage
38282>>>>>>>        End
38283>>>>>>>>
38283>>>>>>>
38283>>>>>>>        Function_Return sDiagMessage
38284>>>>>>>    End_Function
38285>>>>>>>
38285>>>>>>>
38285>>>>>>>
38285>>>>>>>    //***
38285>>>>>>>    //*** Function: DFDateToSQLDate
38285>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL Date. Use dummy zero dates.
38285>>>>>>>    //***
38285>>>>>>>    Function DFDateToSQLDate Date dDFDate Integer iSQLType Returns String
38287>>>>>>>        
38287>>>>>>>        Integer iType
38287>>>>>>>        String  sSQLDate
38287>>>>>>>        Integer iOrgDateFmt
38287>>>>>>>        Integer iOrgDateSep
38287>>>>>>>
38287>>>>>>>        String sDriverId
38287>>>>>>>        String sDummyZeroDate
38287>>>>>>>        String sDummyZeroDateMssqlDatetime
38287>>>>>>>
38287>>>>>>>        //*** Change date format to military, SQL dates are military dates
38287>>>>>>>        Get_Attribute DF_DATE_FORMAT to iOrgDateFmt
38290>>>>>>>        Get_Attribute DF_DATE_SEPARATOR to iOrgDateSep
38293>>>>>>>        Set_Attribute DF_DATE_FORMAT to DF_DATE_MILITARY
38296>>>>>>>        Set_Attribute DF_DATE_SEPARATOR to (Ascii('-'))
38299>>>>>>>
38299>>>>>>>        //*** We only need to convert if the date is 0
38299>>>>>>>        If (Integer(dDFDate = 0)) Begin
38301>>>>>>>
38301>>>>>>>            If (num_arguments < 2) Begin
38303>>>>>>>                Move SQL_TYPE_TIMESTAMP to iType
38304>>>>>>>            End
38304>>>>>>>>
38304>>>>>>>            Else Begin
38305>>>>>>>                Move iSQLType to iType
38306>>>>>>>            End
38306>>>>>>>>
38306>>>>>>>
38306>>>>>>>            
38306>>>>>>>            Get psDriverID to sDriverId
38307>>>>>>>            Get psDummyZeroDate to sDummyZeroDate
38308>>>>>>>                
38308>>>>>>>            If ( (iType = SQL_TYPE_TIMESTAMP) and (sDriverID = 'MSSQLDRV') ) Begin
38310>>>>>>>                Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
38311>>>>>>>                Move sDummyZeroDateMssqlDatetime to sSQLDate
38312>>>>>>>            End
38312>>>>>>>>
38312>>>>>>>            Else Begin
38313>>>>>>>                Move sDummyZeroDate to sSQLDate
38314>>>>>>>            End
38314>>>>>>>>
38314>>>>>>>            
38314>>>>>>>            //CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE to sSQLDate
38314>>>>>>>        End
38314>>>>>>>>
38314>>>>>>>        Else Begin
38315>>>>>>>            Move dDFDate to sSQLDate
38316>>>>>>>        End
38316>>>>>>>>
38316>>>>>>>
38316>>>>>>>        //*** Change date format back to original
38316>>>>>>>        Set_Attribute DF_DATE_FORMAT to iOrgDateFmt
38319>>>>>>>        Set_Attribute DF_DATE_SEPARATOR to iOrgDateSep
38322>>>>>>>
38322>>>>>>>        Function_Return sSQLDate
38323>>>>>>>    End_Function 
38324>>>>>>>
38324>>>>>>>
38324>>>>>>>    //***
38324>>>>>>>    //*** Function: SQLDateToDFDate
38324>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex Date. Use dummy zero dates.
38324>>>>>>>    //***
38324>>>>>>>    Function SQLDateToDFDate String sSQLDate Returns Date
38326>>>>>>>        
38326>>>>>>>        Integer iType
38326>>>>>>>        Date    dDFDate
38326>>>>>>>        Integer iOrgDateFmt
38326>>>>>>>        Integer iOrgDateSep
38326>>>>>>>        
38326>>>>>>>        String  sDriverId
38326>>>>>>>        String  sDummyZeroDate
38326>>>>>>>        String  sDummyZeroDateMssqlDatetime
38326>>>>>>>        
38326>>>>>>>        Get psDriverID to sDriverId
38327>>>>>>>        
38327>>>>>>>        Get psDummyZeroDate to sDummyZeroDate
38328>>>>>>>        Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
38329>>>>>>>        
38329>>>>>>>        Get_Attribute DF_DATE_FORMAT to iOrgDateFmt
38332>>>>>>>        Get_Attribute DF_DATE_SEPARATOR to iOrgDateSep
38335>>>>>>>        Set_Attribute DF_DATE_FORMAT to DF_DATE_MILITARY
38338>>>>>>>        Set_Attribute DF_DATE_SEPARATOR to (Ascii('-'))
38341>>>>>>>        
38341>>>>>>>        Move (Left(sSQLDate,10)) to sSQLDate 
38342>>>>>>>
38342>>>>>>>        If ( (sSQLDate = sDummyZeroDate) or ;             ( (sDriverId = 'MSSQLDRV') and (sSQLDate = sDummyZeroDateMssqlDatetime) ) )  Begin
38344>>>>>>>            Move 0 to dDFDate
38345>>>>>>>        End
38345>>>>>>>>
38345>>>>>>>        Else Begin
38346>>>>>>>            Move sSQLDate to dDFDate
38347>>>>>>>        End
38347>>>>>>>>
38347>>>>>>>
38347>>>>>>>        //*** Change date format back to original
38347>>>>>>>        Set_Attribute DF_DATE_FORMAT to iOrgDateFmt
38350>>>>>>>        Set_Attribute DF_DATE_SEPARATOR to iOrgDateSep
38353>>>>>>>
38353>>>>>>>        Function_Return dDFDate
38354>>>>>>>    End_Function 
38355>>>>>>>
38355>>>>>>>End_Class 
38356>>>>>>>
38356>>>>>>>
38356>>>>>>>//*****************************************************************************
38356>>>>>>>//*** Class  : cSQLConnection                                               ***
38356>>>>>>>//*** Purpose: Connection object for embedded SQL                           ***
38356>>>>>>>//***                                                                       ***
38356>>>>>>>//*** Description:                                                          ***
38356>>>>>>>//***   This provides the ability to create a connection for a driver.      ***
38356>>>>>>>//***   It will contain child statement objects                             ***
38356>>>>>>>//*****************************************************************************
38356>>>>>>>
38356>>>>>>>Class cSQLConnection is a cObject
38357>>>>>>>
38357>>>>>>>    Procedure Construct_object 
38359>>>>>>>        Forward Send Construct_object 
38361>>>>>>>
38361>>>>>>>        Property Integer phCLIConnectionHandle       0
38362>>>>>>>        
38362>>>>>>>        Property String  psDriverID        ""
38363>>>>>>>        Property Integer piBindFile        0
38364>>>>>>>        
38364>>>>>>>        Property String psDummyZeroDate              '0001-01-01'
38365>>>>>>>        Property String psDummyZeroDateMssqlDatetime '1753-01-01'        
38366>>>>>>>
38366>>>>>>>    End_Procedure
38367>>>>>>>
38367>>>>>>>
38367>>>>>>>
38367>>>>>>>    //***
38367>>>>>>>    //*** Procedure: StoreConnectionInfo
38367>>>>>>>    //*** Purpose  : Store basic information about the connection
38367>>>>>>>    //***
38367>>>>>>>    Procedure StoreConnectionInfo Handle hCLIConnectionHandle String sDrvrId 
38369>>>>>>>        
38369>>>>>>>        String sDummyZeroDate
38369>>>>>>>        
38369>>>>>>>        Set phCLIConnectionHandle to hCLIConnectionHandle
38370>>>>>>>        Set psDriverID            to sDrvrId
38371>>>>>>>        
38371>>>>>>>        Case Begin
38371>>>>>>>            Case (sDrvrId = "MSSQLDRV")
38373>>>>>>>                Set psDummyZeroDate to '0001-01-01'
38374>>>>>>>                Set psDummyZeroDateMssqlDatetime to '1753-01-01'
38375>>>>>>>                Break
38376>>>>>>>            Case (sDrvrId = "DB2_DRV")
38379>>>>>>>                Set psDummyZeroDate to '0001-01-01'
38380>>>>>>>                Break
38381>>>>>>>            Case (sDrvrId = "ODBC_DRV")
38384>>>>>>>                CLI_Get_Driver_Attribute sDrvrId DRVR_DUMMY_ZERO_DATE_VALUE to sDummyZeroDate
38391>>>>>>>                Set psDummyZeroDate to sDummyZeroDate
38392>>>>>>>                Break
38393>>>>>>>        Case End
38393>>>>>>>        
38393>>>>>>>    End_Procedure 
38394>>>>>>>
38394>>>>>>>
38394>>>>>>>    //***
38394>>>>>>>    //*** Procedure: DestroySQLConnection
38394>>>>>>>    //*** Purpose : Destroy the SQLConnection object
38394>>>>>>>    //***
38394>>>>>>>    Procedure DestroySQLConnection
38396>>>>>>>        Send Destroy
38397>>>>>>>    End_Procedure 
38398>>>>>>>
38398>>>>>>>
38398>>>>>>>    //***
38398>>>>>>>    //*** Function: SQLConnect
38398>>>>>>>    //*** Purpose : Connect to a database server
38398>>>>>>>    //*** Returns : 1 Succesfully connected
38398>>>>>>>    //***           0 Not connected
38398>>>>>>>    Function SQLConnect String sDrvrID String sConnect Returns Integer
38400>>>>>>>        Integer ihdbc
38400>>>>>>>        String  sEmpty
38400>>>>>>>
38400>>>>>>>        //*** Initialize
38400>>>>>>>        Move "" To sEmpty
38401>>>>>>>        Move 0  To ihdbc
38402>>>>>>>
38402>>>>>>>        Indicate Err False
38403>>>>>>>
38403>>>>>>>        //*** Call the driver function to connect
38403>>>>>>>        Call_driver 0 sDrvrId Function FUNC_SQLCONNECT ;                    Callback Self ;                    Passing sConnect sEmpty Self ;                    Result ihdbc
38408>>>>>>>
38408>>>>>>>        //*** If there was an error, make result invalid
38408>>>>>>>        If (Err) ;            Move 0 To ihdbc
38411>>>>>>>
38411>>>>>>>        //*** Check result and store it
38411>>>>>>>        If (ihdbc <> 0) ;            Send StoreConnectionInfo ihdbc sDrvrId
38414>>>>>>>
38414>>>>>>>        //*** Return success status
38414>>>>>>>        Function_Return (ihdbc <> 0)
38415>>>>>>>    End_Function 
38416>>>>>>>
38416>>>>>>>
38416>>>>>>>
38416>>>>>>>    //***
38416>>>>>>>    //*** Function: SQLFileConnect
38416>>>>>>>    //*** Purpose : Use a connection of an already open file
38416>>>>>>>    //***
38416>>>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
38418>>>>>>>        Integer ihdbc
38418>>>>>>>        Integer bIsOpen
38418>>>>>>>        String  sDrvrId
38418>>>>>>>        String  sEmpty
38418>>>>>>>
38418>>>>>>>        //*** Initialize
38418>>>>>>>        Move "" To sEmpty
38419>>>>>>>        Move 0  To ihdbc
38420>>>>>>>
38420>>>>>>>        //*** Check if file is open
38420>>>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
38423>>>>>>>        If (bIsOpen) Begin
38425>>>>>>>            //*** Fill the driver id, assume longest is 255 characters
38425>>>>>>>            Move (Repeat(' ', 255)) To sDrvrId
38426>>>>>>>            Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
38429>>>>>>>
38429>>>>>>>            Indicate Err False
38430>>>>>>>
38430>>>>>>>            //*** Call the driver function to connect
38430>>>>>>>            Call_driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                        Callback Self ;                        Passing sEmpty sEmpty 0 ;                        Result ihdbc
38435>>>>>>>
38435>>>>>>>            //*** If there was an error, make result invalid
38435>>>>>>>            If (Err) ;                Move 0 To ihdbc
38438>>>>>>>
38438>>>>>>>            //*** Check result and store it
38438>>>>>>>            If (ihdbc <> 0) Begin
38440>>>>>>>                //*** Somehow Call_driver overwrites the sDrvrId variable, restore it here
38440>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
38443>>>>>>>                Send StoreConnectionInfo ihdbc sDrvrId
38444>>>>>>>
38444>>>>>>>                //*** Set filenum so it can be used for fetching
38444>>>>>>>                Set piBindFile To iFileNum
38445>>>>>>>            End
38445>>>>>>>>
38445>>>>>>>        End
38445>>>>>>>>
38445>>>>>>>
38445>>>>>>>        //*** Return success status
38445>>>>>>>        Function_Return (ihdbc <> 0)
38446>>>>>>>    End_Function
38447>>>>>>>
38447>>>>>>>
38447>>>>>>>    //*** Function: SQLConnectionConnect
38447>>>>>>>    //*** Purpose : Establish an embedded SQL connection that uses an existing connection from an earlier login or open.
38447>>>>>>>    //***           Existing connections are identified by there connectstring. (can be obtained with DF_DRIVER_SERVER_NAME attribute) 
38447>>>>>>>    //***           If sConnectString exist in the list of existing connections, that connection will be used for embedded SQL.
38447>>>>>>>    //***           The connectstring must be an exact match, but can be case insensitive
38447>>>>>>>    //***           The connectstring can contain a connection id. For example: "DFCONNID=MyConnectionID"
38447>>>>>>>    //***           If no matching connectstring is found, this function will return 0
38447>>>>>>>    //***           This function will only work with CLI connectivity kits 6.2 or later
38447>>>>>>>    Function SQLConnectionConnect String sDrvrID String sConnectString Returns Integer
38449>>>>>>>        Integer ihdbc
38449>>>>>>>        String  sEmpty
38449>>>>>>>        Integer iFileNum
38449>>>>>>>
38449>>>>>>>        //*** Initialize
38449>>>>>>>        Move "" to sEmpty
38450>>>>>>>        Move 0  to ihdbc
38451>>>>>>>
38451>>>>>>>        Indicate Err False
38452>>>>>>>
38452>>>>>>>        //*** Call the driver function 
38452>>>>>>>        //***   Note we call FUNC_SQLFILECONNECT with iFileNum = 0. 
38452>>>>>>>        //***   This will perform SQLConnectionConnect instead of SQLFileConnect   
38452>>>>>>>        Move 0 to iFileNum
38453>>>>>>>        Call_Driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                    Callback Self ;                    Passing sConnectString sEmpty Self ;                    Result ihdbc
38458>>>>>>>
38458>>>>>>>        //*** If there was an error, make result invalid
38458>>>>>>>        If (Err) ;            Move 0 to ihdbc
38461>>>>>>>
38461>>>>>>>        //*** Check result and store it
38461>>>>>>>        If (ihdbc <> 0) ;            Send StoreConnectionInfo ihdbc sDrvrId
38464>>>>>>>
38464>>>>>>>        //*** Return success status
38464>>>>>>>        Function_Return (ihdbc <> 0)
38465>>>>>>>    End_Function 
38466>>>>>>>
38466>>>>>>>
38466>>>>>>>
38466>>>>>>>
38466>>>>>>>    //***
38466>>>>>>>    //*** Procedure: SQLDisconnect
38466>>>>>>>    //*** Purpose  : Disconnect from an embedded SQL server and free allocated
38466>>>>>>>    //***            resources
38466>>>>>>>    //***
38466>>>>>>>    Procedure SQLDisconnect
38468>>>>>>>        Integer ihdbc
38468>>>>>>>        Integer iVoid
38468>>>>>>>        String  sDrvrId
38468>>>>>>>        String  sEmpty
38468>>>>>>>
38468>>>>>>>        //*** Initialize
38468>>>>>>>        Move "" To sEmpty
38469>>>>>>>
38469>>>>>>>        //*** Get the cli handle
38469>>>>>>>        Get phCLIConnectionHandle to ihdbc
38470>>>>>>>        Get psDriverId To sDrvrId
38471>>>>>>>
38471>>>>>>>        //*** Free the CLI handle
38471>>>>>>>        If (ihdbc <> 0) Begin
38473>>>>>>>            //*** Call the driver function to disconnect
38473>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLDISCONNECT ;                        Callback Self ;                        Passing sEmpty sEmpty ihdbc ;                        Result iVoid
38478>>>>>>>
38478>>>>>>>            Move -1 to giLastSQLhdbc
38479>>>>>>>
38479>>>>>>>            //*** Free the DataFlex handle
38479>>>>>>>            Send DestroySQLConnection
38480>>>>>>>        End
38480>>>>>>>>
38480>>>>>>>    End_Procedure 
38481>>>>>>>
38481>>>>>>>
38481>>>>>>>
38481>>>>>>>    //***
38481>>>>>>>    //*** Function: CreateSQLStatement
38481>>>>>>>    //*** Purpose : Create a cSQLStatement object
38481>>>>>>>    //***
38481>>>>>>>    Function CreateSQLStatement Returns Handle
38483>>>>>>>        
38483>>>>>>>        Handle hoSQLStatement
38483>>>>>>>        Get Create (RefClass(cSQLStatement)) to hoSQLStatement
38484>>>>>>>        
38484>>>>>>>        //*** If the connection has a default Bind File, assign it to the
38484>>>>>>>        //*** statement object. The default is set when you open a file with a
38484>>>>>>>        //*** SetFileConnection command.
38484>>>>>>>        Set piBindFile of hoSQLStatement to (piBindFile(Self))
38485>>>>>>>        
38485>>>>>>>        Function_Return hoSQLStatement
38486>>>>>>>    End_Function 
38487>>>>>>>
38487>>>>>>>
38487>>>>>>>    //***
38487>>>>>>>    //*** Function: SQLOpen
38487>>>>>>>    //*** Prupose : Open a statement for use
38487>>>>>>>    //***
38487>>>>>>>    Function SQLOpen Returns Handle
38489>>>>>>>        Handle  hoSQLStatement
38489>>>>>>>        Integer ihdbc
38489>>>>>>>        Integer ihstmt
38489>>>>>>>        Integer iVoid
38489>>>>>>>        String  sDrvrId
38489>>>>>>>        String  sEmpty
38489>>>>>>>        String  sDummyZeroDate
38489>>>>>>>        String  sDummyZeroDateMssqlDatetime 
38489>>>>>>>
38489>>>>>>>        //*** Initialize
38489>>>>>>>        Move "" To sEmpty
38490>>>>>>>
38490>>>>>>>        //*** Get the cli handle to the connection
38490>>>>>>>        Get phCLIConnectionHandle to ihdbc
38491>>>>>>>        Get psDriverId  To sDrvrId
38492>>>>>>>
38492>>>>>>>        //*** Allocate a new handle and populate it
38492>>>>>>>        If (ihdbc <> 0) Begin
38494>>>>>>>            //**** Create a new cSQLStatement object
38494>>>>>>>            Get CreateSQLStatement to hoSQLStatement
38495>>>>>>>
38495>>>>>>>            //*** Call the driver function to allocate a cli statement handle
38495>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLOPEN ;                        Callback Self ;                        Passing hoSQLStatement sEmpty ihdbc ;                        Result ihstmt
38500>>>>>>>
38500>>>>>>>            //*** If unsuccessful destroy hoSQLStatement
38500>>>>>>>            If (ihstmt = 0) Begin
38502>>>>>>>                Send DestroySQLStatement of hoSQLStatement
38503>>>>>>>                Move 0 to hoSQLStatement
38504>>>>>>>            End
38504>>>>>>>>
38504>>>>>>>            Else Begin
38505>>>>>>>                Send StoreStatementInfo of hoSQLStatement ihstmt sDrvrId ihdbc
38506>>>>>>>
38506>>>>>>>                // Store DummyZeroDate of hoSQLConnection in hoSQLStatement
38506>>>>>>>                Get psDummyZeroDate              to sDummyZeroDate
38507>>>>>>>                Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
38508>>>>>>>                
38508>>>>>>>                Set psDummyZeroDate              of hoSQLStatement to sDummyZeroDate
38509>>>>>>>                Set psDummyZeroDateMssqlDatetime of hoSQLStatement to sDummyZeroDateMssqlDatetime
38510>>>>>>>                
38510>>>>>>>            End
38510>>>>>>>>
38510>>>>>>>        End
38510>>>>>>>>
38510>>>>>>>
38510>>>>>>>        Function_Return hoSQLStatement
38511>>>>>>>    End_Function 
38512>>>>>>>
38512>>>>>>>End_Class 
38513>>>>>>>
38513>>>>>>>
38513>>>>>>>
38513>>>>>>>//*****************************************************************************
38513>>>>>>>//*** Class  : cSQLHandlemanager                                            ***
38513>>>>>>>//*** Purpose: Manager for embedded SQL handles.                            ***
38513>>>>>>>//***                                                                       ***
38513>>>>>>>//*** Description:                                                          ***
38513>>>>>>>//***   We want to be able to use multiple drivers and multiple             ***
38513>>>>>>>//***   connections within a driver and multiple statements within a        ***
38513>>>>>>>//***   connection. To allow this we have placed our own handle logic on    ***
38513>>>>>>>//***   top of the driver handle logic. This way we can handle the          ***
38513>>>>>>>//***   situation where two driver handles may be equal.                    ***
38513>>>>>>>//*****************************************************************************
38513>>>>>>>
38513>>>>>>>Class cSQLHandleManager is a cObject
38514>>>>>>>
38514>>>>>>>    Procedure Construct_object 
38516>>>>>>>        Forward Send Construct_object 
38518>>>>>>>
38518>>>>>>>        Property String  psDefaultDriver      ""
38519>>>>>>>        Property String  psDefaultConnection  ""
38520>>>>>>>
38520>>>>>>>    End_Procedure 
38521>>>>>>>
38521>>>>>>>    //***
38521>>>>>>>    //*** Function: CreateSQLConnection
38521>>>>>>>    //*** Purpose : Create a cSQLConnection object
38521>>>>>>>    //***
38521>>>>>>>    Function CreateSQLConnection Returns Handle
38523>>>>>>>        Handle hoSQLConnection
38523>>>>>>>        Get Create (RefClass(cSQLConnection)) to hoSQLConnection
38524>>>>>>>        Function_Return hoSQLConnection
38525>>>>>>>    End_Function 
38526>>>>>>>
38526>>>>>>>
38526>>>>>>>    //***
38526>>>>>>>    //*** Procedure: SQLSetConnect
38526>>>>>>>    //*** Purpose  : Store default connection information
38526>>>>>>>    //***
38526>>>>>>>
38526>>>>>>>    Procedure SQLSetConnect String sDriver String sConnect
38528>>>>>>>        Set psDefaultDriver      To sDriver
38529>>>>>>>        Set psDefaultConnection  To sConnect
38530>>>>>>>    End_Procedure 
38531>>>>>>>
38531>>>>>>>
38531>>>>>>>
38531>>>>>>>    //***
38531>>>>>>>    //*** Function: SQLConnect
38531>>>>>>>    //*** Purpose : Make a connection to an embedded SQL server
38531>>>>>>>    //*** Returns : The DataFlex handle to the connection
38531>>>>>>>    //***
38531>>>>>>>    Function SQLConnect String sDrvrID String sConnect Returns integer
38533>>>>>>>        Handle hoSQLConnection
38533>>>>>>>        Integer bOK
38533>>>>>>>
38533>>>>>>>        //*** Check arguments
38533>>>>>>>        If (sDrvrID = "" And sConnect = "") Begin
38535>>>>>>>            Get psDefaultDriver      To sDrvrId
38536>>>>>>>            Get psDefaultConnection  To sConnect
38537>>>>>>>        End
38537>>>>>>>>
38537>>>>>>>
38537>>>>>>>        //*** Create a cSQLConnection object
38537>>>>>>>        Get CreateSQLConnection to hoSQLConnection
38538>>>>>>>        //*** Connect to the database 
38538>>>>>>>        Get SQLConnect of hoSQLConnection sDrvrID sConnect to bOK
38539>>>>>>>
38539>>>>>>>        //*** If connection to the database failed, destroy the cSQLConnection object and return a 0 handle
38539>>>>>>>        If (not(bOK)) Begin
38541>>>>>>>            Send DestroySQLConnection of hoSQLConnection
38542>>>>>>>            Move 0 to hoSQLConnection
38543>>>>>>>        End
38543>>>>>>>>
38543>>>>>>>
38543>>>>>>>        Function_Return hoSQLConnection
38544>>>>>>>    End_Function 
38545>>>>>>>
38545>>>>>>>
38545>>>>>>>
38545>>>>>>>    //***
38545>>>>>>>    //*** Function: SQLFileConnect
38545>>>>>>>    //*** Purpose : Make an existing connection available for use with Embedded SQL.
38545>>>>>>>    //***           The connection is identified by the number of a file
38545>>>>>>>    //***           that is open for that connection.
38545>>>>>>>    //***
38545>>>>>>>
38545>>>>>>>    Function SQLFileConnect Integer iFileNum Returns Handle
38547>>>>>>>        Handle hoSQLConnection
38547>>>>>>>        Integer bOK
38547>>>>>>>
38547>>>>>>>        //*** Create a cSQLConnection object
38547>>>>>>>        Get CreateSQLConnection to hoSQLConnection
38548>>>>>>>        Get SQLFileConnect of hoSQLConnection iFileNum To bOK
38549>>>>>>>
38549>>>>>>>        //*** If connection to the database failed, destroy the cSQLConnection object and return a 0 handle
38549>>>>>>>        If (not(bOK)) Begin
38551>>>>>>>            Send DestroySQLConnection of hoSQLConnection
38552>>>>>>>            Move 0 to hoSQLConnection
38553>>>>>>>        End
38553>>>>>>>>
38553>>>>>>>
38553>>>>>>>        Function_Return hoSQLConnection
38554>>>>>>>    End_Function 
38555>>>>>>>
38555>>>>>>>    //***
38555>>>>>>>    //*** Function: SQLConnectionConnect
38555>>>>>>>    //*** Purpose : Establish an embedded SQL connection that uses an existing connection from an earlier login or open.
38555>>>>>>>    //***           Existing connections are identified by there connectstring. (can be obtained with DF_DRIVER_SERVER_NAME attribute) 
38555>>>>>>>    //***           If sConnectString exist in the list of existing connections, that connection will be used for embedded SQL.
38555>>>>>>>    //***           The connectstrings must be an exact match, but can be case insensitive
38555>>>>>>>    //***           If no matching connectstring is found, this function will return 0
38555>>>>>>>    //***           This function will only work with CLI connectivity kits 6.2 or later
38555>>>>>>>    Function SQLConnectionConnect String sDrvrID String sConnectString Returns Integer
38557>>>>>>>        Handle hoSQLConnection
38557>>>>>>>        Integer bOK
38557>>>>>>>
38557>>>>>>>        //*** Check arguments
38557>>>>>>>        If (sDrvrID = "" and sConnectString = "") Begin
38559>>>>>>>            Get psDefaultDriver      to sDrvrId
38560>>>>>>>            Get psDefaultConnection  to sConnectString
38561>>>>>>>        End
38561>>>>>>>>
38561>>>>>>>
38561>>>>>>>        //*** Create a cSQLConnection object
38561>>>>>>>        Get CreateSQLConnection to hoSQLConnection
38562>>>>>>>        //*** Connect to the database 
38562>>>>>>>        Get SQLConnectionConnect of hoSQLConnection sDrvrID sConnectString to bOK
38563>>>>>>>
38563>>>>>>>        //*** If connection to the database failed, destroy the cSQLConnection object and return a 0 handle
38563>>>>>>>        If (not(bOK)) Begin
38565>>>>>>>            Send DestroySQLConnection of hoSQLConnection
38566>>>>>>>            Move 0 to hoSQLConnection
38567>>>>>>>        End
38567>>>>>>>>
38567>>>>>>>
38567>>>>>>>        Function_Return hoSQLConnection
38568>>>>>>>    End_Function 
38569>>>>>>>
38569>>>>>>>
38569>>>>>>>End_Class 
38570>>>>>>>
38570>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\MSSqldrv.pkg)
38570>>>>>>>//*****************************************************************************
38570>>>>>>>//*** MSSQLDRV.PKG                                                          ***
38570>>>>>>>//***                                                                       ***
38570>>>>>>>//*** Author: Ben Weijers                                                   ***
38570>>>>>>>//***         Data Access Nederland                                         ***
38570>>>>>>>//***         29 June 1998                                                  ***
38570>>>>>>>//***                                                                       ***
38570>>>>>>>//***                                                                       ***
38570>>>>>>>//*** Purpose:                                                              ***
38570>>>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
38570>>>>>>>//****                                                                      ***
38570>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
38570>>>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
38570>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
38570>>>>>>>//***             Changed EnumerateServers function to use the highest      ***
38570>>>>>>>//***             available SQL Server client driver.                       ***
38570>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
38570>>>>>>>//***             mssqldrv.pkg                                              ***
38570>>>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
38570>>>>>>>//***             Added constants for SQL Server specific native types      ***
38570>>>>>>>//***             ( var...(max) types, money types, datetime types)         ***
38570>>>>>>>//*****************************************************************************
38570>>>>>>>
38570>>>>>>>Use Cli.pkg
38570>>>>>>>Use SQL.pkg
38570>>>>>>>
38570>>>>>>>//*** Driver Indentification
38570>>>>>>>
38570>>>>>>>//*** Error number constants
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>// SQL Server spcific types. 
38570>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
38570>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
38570>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
38570>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
38570>>>>>>>
38570>>>>>>>// SQL Server spcific types. 
38570>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
38570>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
38570>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
38570>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
38570>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
38570>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
38570>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>//*****************************************************************************
38570>>>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
38570>>>>>>>//***                                                                       ***
38570>>>>>>>//***   Setup a constraint for a file.                                      ***
38570>>>>>>>//*****************************************************************************
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>
38570>>>>>>>Class cMSSQLHandler Is A cCLIHandler
38571>>>>>>>
38571>>>>>>>    Procedure Construct_Object
38573>>>>>>>        Forward Send Construct_Object
38575>>>>>>>
38575>>>>>>>        Set psDriverID To MSSQLDRV_ID
38576>>>>>>>    End_Procedure // Construct_Object
38577>>>>>>>
38577>>>>>>>
38577>>>>>>>
38577>>>>>>>    //***
38577>>>>>>>    //*** Function: ExtractList
38577>>>>>>>    //*** Purpose : Extract the list from the out connect string.
38577>>>>>>>    //***
38577>>>>>>>
38577>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
38579>>>>>>>        Local String  sItem
38579>>>>>>>        Local Integer iStart
38579>>>>>>>        Local Integer iEnd
38579>>>>>>>
38579>>>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
38582>>>>>>>
38582>>>>>>>        Send Delete_Data To hoStore
38583>>>>>>>        Move (Pos("{", sOutConnStr)) To iStart
38584>>>>>>>        While (iStart > 0)
38588>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
38589>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
38592>>>>>>>            Else Begin
38593>>>>>>>                Move (Pos(",", sOutConnStr)) To iStart
38594>>>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
38595>>>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
38598>>>>>>>
38598>>>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
38601>>>>>>>
38601>>>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
38604>>>>>>>            End
38604>>>>>>>>
38604>>>>>>>        Loop
38605>>>>>>>>
38605>>>>>>>
38605>>>>>>>        Function_Return (Item_Count(hoStore))
38606>>>>>>>    End_Procedure // ExtractList
38607>>>>>>>
38607>>>>>>>
38607>>>>>>>
38607>>>>>>>    //***
38607>>>>>>>    //*** Function: BrowseConnect
38607>>>>>>>    //*** Purpose : Call the driver's browse connect function
38607>>>>>>>    //***
38607>>>>>>>
38607>>>>>>>    Function BrowseConnect String sInConnStr Returns String
38609>>>>>>>        Local String  sDriver
38609>>>>>>>        Local String  sOutConnStr
38609>>>>>>>        Local Integer iArg
38609>>>>>>>        Local Integer iRetval
38609>>>>>>>
38609>>>>>>>        Get psDriverID To sDriver
38610>>>>>>>        If (sDriver <> "") Begin
38612>>>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
38613>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
38618>>>>>>>        End
38618>>>>>>>>
38618>>>>>>>
38618>>>>>>>        Function_Return sOutConnStr
38619>>>>>>>    End_Function// BrowseConnect
38620>>>>>>>
38620>>>>>>>
38620>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
38622>>>>>>>        Local String  sDriver
38622>>>>>>>        Local String  sOutConnStr
38622>>>>>>>        Local Integer iArg
38622>>>>>>>        Local Integer iRetval
38622>>>>>>>        
38622>>>>>>>        Move 1 to iArg // Browses only local
38623>>>>>>>
38623>>>>>>>        Get psDriverID to sDriver
38624>>>>>>>        If (sDriver <> "") Begin
38626>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
38627>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
38632>>>>>>>        End
38632>>>>>>>>
38632>>>>>>>
38632>>>>>>>        Function_Return sOutConnStr
38633>>>>>>>    End_Function// BrowseConnect
38634>>>>>>>
38634>>>>>>>
38634>>>>>>>    Function DriverIndex String sDriver Returns Integer
38636>>>>>>>    
38636>>>>>>>        Local String  sCurrentDriver
38636>>>>>>>        Local Integer iNumberOfDrivers iDriver iCount
38636>>>>>>>    
38636>>>>>>>        Move 0 to iDriver
38637>>>>>>>    
38637>>>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
38640>>>>>>>        For iCount from 1 to iNumberOfDrivers
38646>>>>>>>>
38646>>>>>>>    
38646>>>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
38649>>>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
38651>>>>>>>                Move iCount to iDriver
38652>>>>>>>            End
38652>>>>>>>>
38652>>>>>>>        Loop
38653>>>>>>>>
38653>>>>>>>    
38653>>>>>>>        Function_Return iDriver
38654>>>>>>>    
38654>>>>>>>    End_Function 
38655>>>>>>>
38655>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
38657>>>>>>>        
38657>>>>>>>        Local String  sServerList
38657>>>>>>>        Local Integer iNumServers
38657>>>>>>>        Local Integer iDriver
38657>>>>>>>        Local Integer iClientVersion
38657>>>>>>>        Local String  sDriver
38657>>>>>>>        
38657>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
38658>>>>>>>
38658>>>>>>>        If (iDriver) Begin
38660>>>>>>>                
38660>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
38663>>>>>>>            
38663>>>>>>>            Case Begin
38663>>>>>>>    
38663>>>>>>>                Case (iClientVersion = SQLSERVER2016CLIENT)
38665>>>>>>>                    Move SQLSERVER2016DRVRSTR to sDriver
38666>>>>>>>                    Case Break
38667>>>>>>>    
38667>>>>>>>                Case (iClientVersion = SQLSERVER2014CLIENT)
38670>>>>>>>                    Move SQLSERVER2014DRVRSTR to sDriver
38671>>>>>>>                    Case Break
38672>>>>>>>            
38672>>>>>>>                Case (iClientVersion = SQLSERVER2012CLIENT)
38675>>>>>>>                    Move SQLSERVER2012DRVRSTR to sDriver
38676>>>>>>>                    Case Break
38677>>>>>>>    
38677>>>>>>>                Case (iClientVersion = SQLSERVER2008CLIENT)
38680>>>>>>>                    Move SQLSERVER2008DRVRSTR to sDriver
38681>>>>>>>                    Case Break
38682>>>>>>>    
38682>>>>>>>                Case (iClientVersion = SQLSERVER2005CLIENT)
38685>>>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
38686>>>>>>>                    Case Break
38687>>>>>>>            
38687>>>>>>>                Case (iClientVersion = SQLSERVER2000CLIENT)
38690>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
38691>>>>>>>                    Case Break
38692>>>>>>>            
38692>>>>>>>                Case Else
38692>>>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver
38693>>>>>>>            
38693>>>>>>>            Case End
38693>>>>>>>    
38693>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
38694>>>>>>>            If (iNetworkLocal = 0) Begin
38696>>>>>>>                Get BrowseConnect sDriver to sServerList
38697>>>>>>>            End
38697>>>>>>>>
38697>>>>>>>            Else Begin
38698>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
38699>>>>>>>            End
38699>>>>>>>>
38699>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
38700>>>>>>>        End
38700>>>>>>>>
38700>>>>>>>        
38700>>>>>>>        Function_Return iNumServers
38701>>>>>>>        
38701>>>>>>>    End_Function
38702>>>>>>>
38702>>>>>>>    //***
38702>>>>>>>    //*** Procedure: EnumerateServers
38702>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
38702>>>>>>>    //***            This function will return all SQL Server instances on the network. 
38702>>>>>>>    //***            This may take a long time. 
38702>>>>>>>    //***            To enumerate only local SQL Server instances use EnumerateServersLocal 
38702>>>>>>>    Function EnumerateServers Returns Integer
38704>>>>>>>
38704>>>>>>>        Local Integer iNumServers
38704>>>>>>>        Local Integer iNetworkLocal
38704>>>>>>>        
38704>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
38705>>>>>>>        
38705>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
38706>>>>>>>        
38706>>>>>>>        Function_Return iNumServers
38707>>>>>>>        
38707>>>>>>>    End_Function
38708>>>>>>>
38708>>>>>>>
38708>>>>>>>    //***
38708>>>>>>>    //*** Procedure: EnumerateServersLocal
38708>>>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
38708>>>>>>>    //***            This function will return only return SQL Server instance on the local machine
38708>>>>>>>    //***            To enumerate all SQL Server instances in a network use EnumerateServers
38708>>>>>>>    Function EnumerateServersLocal Returns Integer
38710>>>>>>>
38710>>>>>>>        Local Integer iNumServers
38710>>>>>>>        Local Integer iNetworkLocal
38710>>>>>>>        
38710>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
38711>>>>>>>        
38711>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
38712>>>>>>>        
38712>>>>>>>        Function_Return iNumServers
38713>>>>>>>        
38713>>>>>>>    End_Function
38714>>>>>>>
38714>>>>>>>    
38714>>>>>>>
38714>>>>>>>    //***
38714>>>>>>>    //*** Function: EnumerateDatabases
38714>>>>>>>    //*** Purpose : Enumerate database in a given server.
38714>>>>>>>    //***
38714>>>>>>>
38714>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
38716>>>>>>>        Local Integer hoSQL
38716>>>>>>>        Local String  sConnect
38716>>>>>>>        Local String  sDatabase
38716>>>>>>>        Local Integer hdbc
38716>>>>>>>        Local Integer hstmt
38716>>>>>>>        Local Integer iFetchResult
38716>>>>>>>
38716>>>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
38719>>>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
38722>>>>>>>
38722>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
38725>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
38727>>>>>>>
38727>>>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
38729>>>>>>>            Move Current_Object To hoSQL
38730>>>>>>>        End_Object // oEnumDBSQLManager
38731>>>>>>>
38731>>>>>>>        If (hoSQL <> 0) Begin
38733>>>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
38734>>>>>>>            If (hdbc <> 0) Begin
38736>>>>>>>                Get SQLOpen Of hdbc To hstmt
38737>>>>>>>                If (hstmt <> 0) Begin
38739>>>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
38739>>>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
38739>>>>>>>                    //*** approach in case meta data might change, the stored procedure will
38739>>>>>>>                    //*** stay the same.
38739>>>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
38740>>>>>>>                    Send SQLCall To hstmt
38741>>>>>>>                    Repeat
38741>>>>>>>>
38741>>>>>>>                        Get SQLFetch Of hstmt To iFetchResult
38742>>>>>>>                        If (iFetchResult <> 0) Begin
38744>>>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
38745>>>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
38746>>>>>>>                        End
38746>>>>>>>>
38746>>>>>>>                    Until (iFetchResult = 0)
38748>>>>>>>
38748>>>>>>>                    Send SQLClose To hstmt
38749>>>>>>>                End
38749>>>>>>>>
38749>>>>>>>                Send SQLDisconnect To hdbc
38750>>>>>>>            End
38750>>>>>>>>
38750>>>>>>>        End
38750>>>>>>>>
38750>>>>>>>        Send Destroy_Object To hoSQL
38751>>>>>>>
38751>>>>>>>        Function_return (Item_Count(Current_Object))
38752>>>>>>>    End_Function // EnumerateDatabases
38753>>>>>>>
38753>>>>>>>
38753>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
38755>>>>>>>        
38755>>>>>>>        Local String  sSqlServerClientVersionName
38755>>>>>>>        
38755>>>>>>>            
38755>>>>>>>        Case Begin
38755>>>>>>>
38755>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
38757>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
38758>>>>>>>                Case Break
38759>>>>>>>
38759>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
38762>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
38763>>>>>>>                Case Break
38764>>>>>>>        
38764>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
38767>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
38768>>>>>>>                Case Break
38769>>>>>>>
38769>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
38772>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
38773>>>>>>>                Case Break
38774>>>>>>>
38774>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
38777>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
38778>>>>>>>                Case Break
38779>>>>>>>        
38779>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
38782>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
38783>>>>>>>                Case Break
38784>>>>>>>        
38784>>>>>>>            Case Else
38784>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
38785>>>>>>>        
38785>>>>>>>        Case End
38785>>>>>>>    
38785>>>>>>>        
38785>>>>>>>        Function_Return sSqlServerClientVersionName
38786>>>>>>>        
38786>>>>>>>    End_Function
38787>>>>>>>
38787>>>>>>>
38787>>>>>>>End_Class // cMSSQLHandler
38788>>>>>>>
38788>>>>>Use db2_drv.pkg
Including file: db2_drv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\db2_drv.pkg)
38788>>>>>>>//*****************************************************************************
38788>>>>>>>//*** DB2_DRV.PKG                                                           ***
38788>>>>>>>//***                                                                       ***
38788>>>>>>>//*** Author: Ben Weijers                                                   ***
38788>>>>>>>//***         Data Access Nederland                                         ***
38788>>>>>>>//***         30 July 1998                                                  ***
38788>>>>>>>//***                                                                       ***
38788>>>>>>>//*** Last updated: May 2, 2007                                                                      ***
38788>>>>>>>//***                                                                       ***
38788>>>>>>>//*** Purpose:                                                              ***
38788>>>>>>>//***   Package that declares DB2 driver constants and functions.           ***
38788>>>>>>>//****                                                                      ***
38788>>>>>>>//***   This package can be used by developers who want to add DB2 driver   ***
38788>>>>>>>//***   specific code to a DataFlex application.                            ***
38788>>>>>>>//*****************************************************************************
38788>>>>>>>
38788>>>>>>>Use Cli.pkg
38788>>>>>>>
38788>>>>>>>//*** Driver attributes
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>//*** Driver Indentification
38788>>>>>>>
38788>>>>>>>//*** Error number constants
38788>>>>>>>
38788>>>>>>>//*** Call driver function identifiers
38788>>>>>>>
38788>>>>>>>// DB2 specific data types
38788>>>>>>>Define SQL_CLOB           for   (-99)  
38788>>>>>>>Define SQL_BLOB           for   (-98)  
38788>>>>>>>Define SQL_XML            for   (-370) 
38788>>>>>>>// DB2 Graphic types are Unicode types
38788>>>>>>>Define SQL_GRAPHIC        for   (-95)  
38788>>>>>>>Define SQL_VARGRAPHIC     for   (-96)  
38788>>>>>>>Define SQL_LONGVARGRAPHIC for   (-97)  
38788>>>>>>>Define SQL_DBCLOB         for   (-350) 
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>//*** Extra DB2 commands
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>//*****************************************************************************
38788>>>>>>>//*** DB2_CheckTrigger <NewState>                                           ***
38788>>>>>>>//***                                                                       ***
38788>>>>>>>//*** This command will set the trigger check at open on or off.            ***
38788>>>>>>>//*****************************************************************************
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>//*****************************************************************************
38788>>>>>>>//*** DB2_SetConstraint <FileNum> <ConstraintText>                          ***
38788>>>>>>>//***                                                                       ***
38788>>>>>>>//***   Setup a constraint for a file.                                      ***
38788>>>>>>>//*****************************************************************************
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>
38788>>>>>>>Class cDB2Handler Is A cCLIHandler
38789>>>>>>>
38789>>>>>>>    Procedure Construct_Object
38791>>>>>>>        Forward Send Construct_Object
38793>>>>>>>
38793>>>>>>>        Set psDriverID To DB2_DRV_ID
38794>>>>>>>    End_Procedure // Construct_Object
38795>>>>>>>
38795>>>>>>>
38795>>>>>>>
38795>>>>>>>    //***
38795>>>>>>>    //*** Procedure: SeedDataSources
38795>>>>>>>    //*** Purpose  : Reset the datasource list to the beginning
38795>>>>>>>    //***
38795>>>>>>>
38795>>>>>>>    Procedure SeedDataSources
38797>>>>>>>        Local String  sDriver
38797>>>>>>>        Local String  sVoid
38797>>>>>>>        Local Integer iRetval
38797>>>>>>>
38797>>>>>>>        Get psDriverID To sDriver
38798>>>>>>>        If (sDriver <> "") ;            Call_Driver 0 sDRiver Function CLI_INITDATASOURCES Callback 0 Passing sVoid sVoid SQL_FETCH_ALL Result iRetval
38805>>>>>>>    End_Procedure // SeedDataSources
38806>>>>>>>
38806>>>>>>>
38806>>>>>>>
38806>>>>>>>    //***
38806>>>>>>>    //*** Function: DataSources
38806>>>>>>>    //*** Purpose : Call the driver's data sources function
38806>>>>>>>    //***
38806>>>>>>>
38806>>>>>>>    Function DataSources Returns String
38808>>>>>>>        Local String  sDriver
38808>>>>>>>        Local String  sDataSource
38808>>>>>>>        Local String  sDescription
38808>>>>>>>        Local Integer iLength
38808>>>>>>>        Local Integer iRetval
38808>>>>>>>
38808>>>>>>>        Get psDriverID To sDriver
38809>>>>>>>        If (sDriver <> "") Begin
38811>>>>>>>            Move 8192 To iLength
38812>>>>>>>            Move (Repeat(" ", iLength)) To sDataSource
38813>>>>>>>            Move (Repeat(" ", iLength)) To sDescription
38814>>>>>>>            Call_Driver 0 sDRiver Function CLI_DATASOURCES Callback 0 Passing sDataSource sDescription iLength Result iRetval
38819>>>>>>>        End
38819>>>>>>>>
38819>>>>>>>
38819>>>>>>>        If (sDataSource <> "" Or sDescription <> "") ;            Function_Return (sDataSource + "," +  sDescription)
38822>>>>>>>        Else ;            Function_Return ""
38824>>>>>>>    End_Function// DataSources
38825>>>>>>>
38825>>>>>>>End_Class // cODBCHandler
38826>>>>>>>
38826>>>>>>>
38826>>>>>Use odbc_drv.pkg
Including file: odbc_drv.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\odbc_drv.pkg)
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBC_DRV.PKG                                                          ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Author: Ben Weijers                                                   ***
38826>>>>>>>//***         Data Access Nederland                                         ***
38826>>>>>>>//***         3 February 1998                                               ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Last updated: May 2, 2007                                                                      ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Purpose:                                                              ***
38826>>>>>>>//***   Package that declares ODBC driver constants and functions.          ***
38826>>>>>>>//****                                                                      ***
38826>>>>>>>//***   This package can be used by developers who want to add Data Access  ***
38826>>>>>>>//***   ODBC Client specific code to a DataFlex application.                ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>Use Cli.pkg
38826>>>>>>>
38826>>>>>>>//*** Driver Indentification
38826>>>>>>>
38826>>>>>>>//*** Error number constants
38826>>>>>>>
38826>>>>>>>//*** Call driver function identifiers
38826>>>>>>>
38826>>>>>>>//*** Extra ODBC commands
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCManage                                                            ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Start the ODBC manager.                                               ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCNumberOfDataSources To <NumDSN>                                   ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the number of data sources.                                   ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCDSNName <DSNNumber> To <DSNName>                                  ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the name of the data source.                                  ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCEnumerateTables <DSNName> To <TableNum>                           ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Builds internal table array and returns the number of tables in the   ***
38826>>>>>>>//*** DSN.                                                                  ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCTableName <TableNum> To <TableName>                               ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the name of the table.                                        ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCSchemaName <TableNum> To <SchemaName>                             ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the schema name of the table.                                 ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCNumberOfFields <DSNName> <TableName> To <NumDSN>                  ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the number of fields.                                         ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBCFieldName <FieldNumber> To <FieldName>                            ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//*** Returns the name of the field.                                  ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>//*****************************************************************************
38826>>>>>>>//*** ODBC_SetConstraint <FileNum> <ConstraintText>                         ***
38826>>>>>>>//***                                                                       ***
38826>>>>>>>//***   Setup a constraint for a file.                                      ***
38826>>>>>>>//*****************************************************************************
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>
38826>>>>>>>Class cODBCHandler Is A cCLIHandler
38827>>>>>>>
38827>>>>>>>    Procedure Construct_Object
38829>>>>>>>        Forward Send Construct_Object
38831>>>>>>>
38831>>>>>>>        Set psDriverID To ODBC_DRV_ID
38832>>>>>>>    End_Procedure // Construct_Object
38833>>>>>>>
38833>>>>>>>
38833>>>>>>>
38833>>>>>>>    //***
38833>>>>>>>    //*** Procedure Set: DataSourceType
38833>>>>>>>    //*** Purpose      : Setup the type of data sources returned by the datasources function
38833>>>>>>>    //***
38833>>>>>>>
38833>>>>>>>    Procedure Set DataSourceType Integer iNewType
38835>>>>>>>        Local String  sDriver
38835>>>>>>>        Local String  sVoid
38835>>>>>>>        Local Integer iRetval
38835>>>>>>>
38835>>>>>>>        Get psDriverID To sDriver
38836>>>>>>>        If (sDriver <> "") ;            Call_Driver 0 sDRiver Function CLI_INITDATASOURCES Callback 0 Passing sVoid sVoid iNewType Result iRetval
38843>>>>>>>    End_Procedure // Set DataSourceType
38844>>>>>>>
38844>>>>>>>
38844>>>>>>>
38844>>>>>>>    //***
38844>>>>>>>    //*** Function: DataSources
38844>>>>>>>    //*** Purpose : Call the driver's data sources function
38844>>>>>>>    //***
38844>>>>>>>
38844>>>>>>>    Function DataSources Returns String
38846>>>>>>>        Local String  sDriver
38846>>>>>>>        Local String  sDataSource
38846>>>>>>>        Local String  sDescription
38846>>>>>>>        Local Integer iLength
38846>>>>>>>        Local Integer iRetval
38846>>>>>>>
38846>>>>>>>        Get psDriverID To sDriver
38847>>>>>>>        If (sDriver <> "") Begin
38849>>>>>>>            Move 8192 To iLength
38850>>>>>>>            Move (Repeat(" ", iLength)) To sDataSource
38851>>>>>>>            Move (Repeat(" ", iLength)) To sDescription
38852>>>>>>>            Call_Driver 0 sDRiver Function CLI_DATASOURCES Callback 0 Passing sDataSource sDescription iLength Result iRetval
38857>>>>>>>        End
38857>>>>>>>>
38857>>>>>>>
38857>>>>>>>        If (sDataSource <> "" Or sDescription <> "") ;            Function_Return (sDataSource + "," +  sDescription)
38860>>>>>>>        Else ;            Function_Return ""
38862>>>>>>>    End_Function// DataSources
38863>>>>>>>
38863>>>>>>>End_Class // cODBCHandler
38864>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.0\Pkg\DFBTRDRV.PKG)
38864>>>>>>>//****************************************************************************
38864>>>>>>>//
38864>>>>>>>// $File name  : DFBTRDRV.PKG
38864>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
38864>>>>>>>// Notice      : This package contains constants and commands, used to call
38864>>>>>>>//               specific functions in the DFBTRDRV.
38864>>>>>>>// $Author(s)  : Eddy Kleinjan
38864>>>>>>>//
38864>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
38864>>>>>>>// Created     : 01-07-97 @ 12:00:00
38864>>>>>>>//
38864>>>>>>>// Changed     : 04-04-2001.
38864>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
38864>>>>>>>//
38864>>>>>>>// Changed     : June 6, 2001
38864>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
38864>>>>>>>//
38864>>>>>>>//               Added DFBTR_DDF_OWNER command.
38864>>>>>>>//
38864>>>>>>>// Changed     : June 12, 2001
38864>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
38864>>>>>>>//
38864>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
38864>>>>>>>//
38864>>>>>>>// Changed     : August 4, 2004
38864>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
38864>>>>>>>//
38864>>>>>>>//               Added cDfbtrdrvHandler class.
38864>>>>>>>//               New functions in this class:
38864>>>>>>>//                  Function CKRevision Returns String
38864>>>>>>>//                  Function CkUsesUri Returns Integer
38864>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
38864>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
38864>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
38864>>>>>>>//
38864>>>>>>>// Changed     : September 30, 2005
38864>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
38864>>>>>>>//
38864>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
38864>>>>>>>//****************************************************************************
38864>>>>>>>Use Ui
38864>>>>>>>//
38864>>>>>>>// Driver Indentification
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//*** Driver attributes
38864>>>>>>>//
38864>>>>>>>// Call_Driver functions ID's
38864>>>>>>>//
38864>>>>>>>//
38864>>>>>>>// DFBTRFN_CONVERT_FILE options
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// DFBTRFN_SET_OWNER options
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to create all vars which may be needed
38864>>>>>>>// in other commands.
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to set the owner of a Btrieve file.
38864>>>>>>>// File must have been opened.
38864>>>>>>>// Filenumber needs to be passed.
38864>>>>>>>// To clear set the owner to "".
38864>>>>>>>// Examples:
38864>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
38864>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
38864>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
38864>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
38864>>>>>>>// To clear:
38864>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to parse DFBTR_SET_OWNVER
38864>>>>>>>// options.
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to parse for Callback
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to clear the owner of a Btrieve file.
38864>>>>>>>// File must have been opened.
38864>>>>>>>// Filenumber needs to be passed.
38864>>>>>>>// Examples:
38864>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to add a owner name to the internal list of ownernames
38864>>>>>>>// which will be tries when opening files.
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to remove all owners from the internal list of ownernames
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to set the owner name to be used when opening the DDF files.
38864>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
38864>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
38864>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to change the transaction type.
38864>>>>>>>// Valid types are:
38864>>>>>>>//     DFBTRTT_NONE
38864>>>>>>>//     DFBTRTT_EXCLUSIVE
38864>>>>>>>//     DFBTRTT_CONCURRENT
38864>>>>>>>//
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to get the current transaction type.
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to set explicit_locking
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to get explicit locking
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//
38864>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
38864>>>>>>>//
38864>>>>>>>
38864>>>>>>>//*****************************************************************************
38864>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
38864>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
38864>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
38864>>>>>>>//*****************************************************************************
38864>>>>>>>
38864>>>>>>>Class cDFBtrDrvHandler Is An Array
38865>>>>>>>
38865>>>>>>>    Procedure Construct_Object Integer iImage
38867>>>>>>>        Forward Send Construct_object iImage
38869>>>>>>>
38869>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
38870>>>>>>>    End_Procedure // Construct_Object
38871>>>>>>>
38871>>>>>>>
38871>>>>>>>
38871>>>>>>>    //***
38871>>>>>>>    //*** Function: CKRevsion
38871>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
38871>>>>>>>    //***
38871>>>>>>>
38871>>>>>>>    Function CKRevision Returns String
38873>>>>>>>        Local String  sDriverID
38873>>>>>>>        Local String  sRevision
38873>>>>>>>        Local String  sVoid
38873>>>>>>>        Local Integer iRetval
38873>>>>>>>
38873>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
38873>>>>>>>        // This error would otherwise be raised when we have an older
38873>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
38873>>>>>>>        Send Ignore_error To Error_object_Id 20491
38874>>>>>>>        Get psDriverID To sDriverID
38875>>>>>>>        Move (Repeat(" ", 255)) To sRevision
38876>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
38881>>>>>>>        Send Trap_Error To Error_object_Id 20491
38882>>>>>>>        If (Trim(sRevision) = "") Begin
38884>>>>>>>            // Unable to get the revision. return all zeroes.
38884>>>>>>>            Move "0.0.0.0" To sRevision
38885>>>>>>>        End
38885>>>>>>>>
38885>>>>>>>        Function_Return sRevision
38886>>>>>>>    End_Function // CKRevision
38887>>>>>>>
38887>>>>>>>    Function CkUsesUri Returns Integer
38889>>>>>>>        Local String  sDriverID
38889>>>>>>>        Local String  sVoid1
38889>>>>>>>        Local String  sVoid2
38889>>>>>>>        Local Integer iRetval
38889>>>>>>>
38889>>>>>>>        Get psDriverID To sDriverID
38890>>>>>>>
38890>>>>>>>        Move 0 To iRetval
38891>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
38891>>>>>>>        // This error would otherwise be raised when we have an older
38891>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
38891>>>>>>>        Send Ignore_error To Error_object_Id 20491
38892>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
38897>>>>>>>        Send Trap_Error To Error_object_Id 20491
38898>>>>>>>
38898>>>>>>>        Function_Return iRetval
38899>>>>>>>    End_Function // CKUsesUri
38900>>>>>>>
38900>>>>>>>
38900>>>>>>>
38900>>>>>>>    //***
38900>>>>>>>    //*** Function: ExtractPartFromRevsion
38900>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
38900>>>>>>>    //***
38900>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
38900>>>>>>>    //***
38900>>>>>>>
38900>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
38902>>>>>>>        Local Integer iPartRev
38902>>>>>>>        Local Integer iCurrentPart
38902>>>>>>>        Local Integer iSeparatorPos
38902>>>>>>>
38902>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
38905>>>>>>>
38905>>>>>>>        Move 0 To iCurrentPart
38906>>>>>>>        Repeat
38906>>>>>>>>
38906>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
38907>>>>>>>            If (iSeparatorPos > 0) Begin
38909>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
38910>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
38911>>>>>>>                Increment iCurrentPart
38912>>>>>>>            End
38912>>>>>>>>
38912>>>>>>>            Else If (sRevision <> "") Begin
38915>>>>>>>                Move sRevision To iPartRev
38916>>>>>>>                Move "" To sRevision
38917>>>>>>>                Increment iCurrentPart
38918>>>>>>>            End
38918>>>>>>>>
38918>>>>>>>            Else ;                Move -1 To iPartRev
38920>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
38922>>>>>>>
38922>>>>>>>        Function_Return iPartRev
38923>>>>>>>    End_Function // EcxtractPartFromRevision
38924>>>>>>>
38924>>>>>>>
38924>>>>>>>
38924>>>>>>>    //***
38924>>>>>>>    //*** Function: CKMajorRevision
38924>>>>>>>    //*** Purpose : Returns the major revision of the CK
38924>>>>>>>    //***
38924>>>>>>>
38924>>>>>>>    Function CKMajorRevision Returns Integer
38926>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
38927>>>>>>>    End_Function // CKMajorRevision
38928>>>>>>>
38928>>>>>>>
38928>>>>>>>
38928>>>>>>>    //***
38928>>>>>>>    //*** Function: CKMinorRevision
38928>>>>>>>    //*** Purpose : Returns the minor revision of the CK
38928>>>>>>>    //***
38928>>>>>>>
38928>>>>>>>    Function CKMinorRevision Returns Integer
38930>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
38931>>>>>>>    End_Function // CKMinorRevision
38932>>>>>>>
38932>>>>>>>
38932>>>>>>>
38932>>>>>>>    //***
38932>>>>>>>    //*** Function: CKReleaseRevision
38932>>>>>>>    //*** Purpose : Returns the release revision of the CK
38932>>>>>>>    //***
38932>>>>>>>
38932>>>>>>>    Function CKReleaseRevision Returns Integer
38934>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
38935>>>>>>>    End_Function // CKReleaseRevision
38936>>>>>>>
38936>>>>>>>
38936>>>>>>>
38936>>>>>>>    //***
38936>>>>>>>    //*** Function: CKBuildRevision
38936>>>>>>>    //*** Purpose : Returns the major revision of the CK
38936>>>>>>>    //***
38936>>>>>>>
38936>>>>>>>    Function CKBuildRevision Returns Integer
38938>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
38939>>>>>>>    End_Function // CKBuildRevision
38940>>>>>>>
38940>>>>>>>
38940>>>>>>>
38940>>>>>>>    //***
38940>>>>>>>    //*** Function: IsMinimalRevision
38940>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
38940>>>>>>>    //***
38940>>>>>>>
38940>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
38942>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
38945>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
38948>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
38951>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
38954>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
38957>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
38961>>>>>>>            End
38961>>>>>>>>
38961>>>>>>>        End
38961>>>>>>>>
38961>>>>>>>
38961>>>>>>>        Function_Return (FALSE)
38962>>>>>>>    End_Function // IsMinimalRevision
38963>>>>>>>
38963>>>>>>>    //   Functions to query the Pervasive.SQL version:
38963>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
38963>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
38963>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
38963>>>>>>>    //
38963>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
38963>>>>>>>    //   in the following format:
38963>>>>>>>    //       <version>.<revision>.<type>
38963>>>>>>>    //   possible values for <type>:
38963>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
38963>>>>>>>    //         server using Workgroup authentication mode
38963>>>>>>>    //       C for client cache engine
38963>>>>>>>    //       D for DOS workstation
38963>>>>>>>    //       N for client Requester
38963>>>>>>>    //       S for NetWare server
38963>>>>>>>    //       T for 32-bit Windows server engine
38963>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
38963>>>>>>>    //
38963>>>>>>>    //   example:
38963>>>>>>>    //       8.50.T
38963>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
38963>>>>>>>    //   32-bits Windows server.
38963>>>>>>>    //
38963>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
38963>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
38963>>>>>>>    //
38963>>>>>>>    //   If the version information is not available or can not be obtained
38963>>>>>>>    //   the functions will return "0.0.0"
38963>>>>>>>
38963>>>>>>>
38963>>>>>>>    //***
38963>>>>>>>    //*** Function: PSQLRequesterVersionInfo
38963>>>>>>>    //*** Purpose : Returns the version information of the
38963>>>>>>>    //***           Pervasive.SQL Client requester.
38963>>>>>>>
38963>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
38965>>>>>>>
38965>>>>>>>        Local String  sDriverID
38965>>>>>>>        Local String  sVersion
38965>>>>>>>        Local String  sVoid
38965>>>>>>>        Local Integer iRetval
38965>>>>>>>
38965>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
38965>>>>>>>        // This error would otherwise be raised when we have an older
38965>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
38965>>>>>>>        Send Ignore_error To Error_object_Id 20491
38966>>>>>>>        Get psDriverID To sDriverID
38967>>>>>>>        Move (Repeat(" ", 255)) To sVersion
38968>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
38973>>>>>>>        Send Trap_Error To Error_object_Id 20491
38974>>>>>>>        If (Trim(sVersion) = "") Begin
38976>>>>>>>            // Unable to get the revision. return all zeroes.
38976>>>>>>>            Move "0.0.0" To sVersion
38977>>>>>>>        End
38977>>>>>>>>
38977>>>>>>>        Function_Return sVersion
38978>>>>>>>    End_Function //  PSQLRequesterVersion
38979>>>>>>>
38979>>>>>>>    //***
38979>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
38979>>>>>>>    //*** Purpose : Returns the version information of the
38979>>>>>>>    //***           Pervasive.SQL Local Engine
38979>>>>>>>
38979>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
38981>>>>>>>
38981>>>>>>>        Local String  sDriverID
38981>>>>>>>        Local String  sVersion
38981>>>>>>>        Local String  sVoid
38981>>>>>>>        Local Integer iRetval
38981>>>>>>>
38981>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
38981>>>>>>>        // This error would otherwise be raised when we have an older
38981>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
38981>>>>>>>        Send Ignore_error To Error_object_Id 20491
38982>>>>>>>        Get psDriverID To sDriverID
38983>>>>>>>        Move (Repeat(" ", 255)) To sVersion
38984>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
38989>>>>>>>        Send Trap_Error To Error_object_Id 20491
38990>>>>>>>        If (Trim(sVersion) = "") Begin
38992>>>>>>>            // Unable to get the revision. return all zeroes.
38992>>>>>>>            Move "0.0.0" To sVersion
38993>>>>>>>        End
38993>>>>>>>>
38993>>>>>>>        Function_Return sVersion
38994>>>>>>>    End_Function //  PSQLLocalEngineVersion
38995>>>>>>>
38995>>>>>>>    //***
38995>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
38995>>>>>>>    //*** Purpose : Returns the version information of the
38995>>>>>>>    //***           Pervasive.SQL Server Engine
38995>>>>>>>
38995>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
38997>>>>>>>
38997>>>>>>>        Local String  sDriverID
38997>>>>>>>        Local String  sVersion
38997>>>>>>>        Local String  sVoid
38997>>>>>>>        Local Integer iRetval
38997>>>>>>>
38997>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
38997>>>>>>>        // This error would otherwise be raised when we have an older
38997>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
38997>>>>>>>        Send Ignore_error To Error_object_Id 20491
38998>>>>>>>        Get psDriverID To sDriverID
38999>>>>>>>        Move (Repeat(" ", 255)) To sVersion
39000>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
39005>>>>>>>        Send Trap_Error To Error_object_Id 20491
39006>>>>>>>        If (Trim(sVersion) = "") Begin
39008>>>>>>>            // Unable to get the revision. return all zeroes.
39008>>>>>>>            Move "0.0.0" To sVersion
39009>>>>>>>        End
39009>>>>>>>>
39009>>>>>>>        Function_Return sVersion
39010>>>>>>>    End_Function //  PSQLServerEngineVersion
39011>>>>>>>
39011>>>>>>>End_Class // cDfbtrdrvHandler
39012>>>>>>>
39012>>>>>Use cDbUpdateFunctionLibrary.inc
39012>>>>>Use cSQLConnectionIniFile.inc
Including file: cSQLConnectionIniFile.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cSQLConnectionIniFile.inc)
39012>>>>>>>//****************************************************************************
39012>>>>>>>// $Module type: Include file
39012>>>>>>>// $Module name: cSQLConnectionIniFile.inc
39012>>>>>>>//
39012>>>>>>>// $Author     : Nils G. Svedmyr, RDC Tools International.
39012>>>>>>>// Copyright (c) 2012 RDC Tools International
39012>>>>>>>// E-mail      : support@rdctools.com
39012>>>>>>>// Web-site    : http://www.rdctools.com
39012>>>>>>>//
39012>>>>>>>// Created     : 2017-01-18 @ 13:04 (Military date format - Year-Month-Day)
39012>>>>>>>//
39012>>>>>>>// Note        : Header file with constant declarations for the cSQLConnectionIniFile class.
39012>>>>>>>//
39012>>>>>>>// The code is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
39012>>>>>>>// without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
39012>>>>>>>// This is free software; you can redistribute it and/or modify it under the terms of the
39012>>>>>>>// GNU Lesser General Public License - see the "GNU Lesser General Public License.txt"
39012>>>>>>>// in the help folder for more details.
39012>>>>>>>//
39012>>>>>>>Use Winkern.pkg
39012>>>>>>>Use cIniFile.pkg
39012>>>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCryptographer.pkg)
39012>>>>>>>>>Use VdfBase.pkg
39012>>>>>>>>>
39012>>>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CryptographerConstants.pkg)
39012>>>>>>>>>>>//                                      
39012>>>>>>>>>>>// File    : CryptographerConstants.pkg
39012>>>>>>>>>>>//
39012>>>>>>>>>>>//   Author  : Ulbe Stellema
39012>>>>>>>>>>>//             Data Access Worldwide
39012>>>>>>>>>>>//
39012>>>>>>>>>>>//   Date    : October 4, 2009
39012>>>>>>>>>>>//
39012>>>>>>>>>>>
39012>>>>>>>>>>>
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Algorithm classes
39012>>>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
39012>>>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
39012>>>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
39012>>>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
39012>>>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
39012>>>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
39012>>>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Algorithm types
39012>>>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
39012>>>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
39012>>>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
39012>>>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
39012>>>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
39012>>>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
39012>>>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Generic sub-ids
39012>>>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
39012>>>>>>>>>>>
39012>>>>>>>>>>>// RSA sub-ids
39012>>>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
39012>>>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
39012>>>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
39012>>>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
39012>>>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
39012>>>>>>>>>>>
39012>>>>>>>>>>>// DSS sub-ids
39012>>>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
39012>>>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
39012>>>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
39012>>>>>>>>>>>
39012>>>>>>>>>>>// DES sub_ids
39012>>>>>>>>>>>Define ALG_SID_DES                      for 1
39012>>>>>>>>>>>Define ALG_SID_3DES                     for 3
39012>>>>>>>>>>>Define ALG_SID_DESX                     for 4
39012>>>>>>>>>>>Define ALG_SID_IDEA                     for 5
39012>>>>>>>>>>>Define ALG_SID_CAST                     for 6
39012>>>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
39012>>>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
39012>>>>>>>>>>>Define ALG_SID_3DES_112                 for 9
39012>>>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
39012>>>>>>>>>>>Define ALG_SID_RC5                      for 13
39012>>>>>>>>>>>Define ALG_SID_AES_128                  for 14
39012>>>>>>>>>>>Define ALG_SID_AES_192                  for 15
39012>>>>>>>>>>>Define ALG_SID_AES_256                  for 16
39012>>>>>>>>>>>Define ALG_SID_AES                      for 17
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Fortezza sub-ids
39012>>>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
39012>>>>>>>>>>>Define ALG_SID_TEK                      for 11
39012>>>>>>>>>>>
39012>>>>>>>>>>>// RC2 sub-ids
39012>>>>>>>>>>>Define ALG_SID_RC2                      for 2
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Stream cipher sub-ids
39012>>>>>>>>>>>Define ALG_SID_RC4                      for 1
39012>>>>>>>>>>>Define ALG_SID_SEAL                     for 2
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Diffie-Hellman sub-ids
39012>>>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
39012>>>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
39012>>>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
39012>>>>>>>>>>>Define ALG_SID_KEA                      for 4
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Hash sub ids
39012>>>>>>>>>>>Define ALG_SID_MD2                      for 1
39012>>>>>>>>>>>Define ALG_SID_MD4                      for 2
39012>>>>>>>>>>>Define ALG_SID_MD5                      for 3
39012>>>>>>>>>>>Define ALG_SID_SHA                      for 4
39012>>>>>>>>>>>Define ALG_SID_SHA1                     for 4
39012>>>>>>>>>>>Define ALG_SID_MAC                      for 5
39012>>>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
39012>>>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
39012>>>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
39012>>>>>>>>>>>Define ALG_SID_HMAC                     for 9
39012>>>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
39012>>>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
39012>>>>>>>>>>>Define ALG_SID_SHA_256                  for 12
39012>>>>>>>>>>>Define ALG_SID_SHA_384                  for 13
39012>>>>>>>>>>>Define ALG_SID_SHA_512                  for 14
39012>>>>>>>>>>>
39012>>>>>>>>>>>// secure channel sub ids
39012>>>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
39012>>>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
39012>>>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
39012>>>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
39012>>>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
39012>>>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
39012>>>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
39012>>>>>>>>>>>
39012>>>>>>>>>>>// algorithm identifier definitions
39012>>>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
39012>>>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
39012>>>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
39012>>>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
39012>>>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
39012>>>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
39012>>>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
39012>>>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
39012>>>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
39012>>>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
39012>>>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
39012>>>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
39012>>>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
39012>>>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
39012>>>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
39012>>>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
39012>>>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
39012>>>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
39012>>>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
39012>>>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
39012>>>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
39012>>>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
39012>>>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
39012>>>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
39012>>>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
39012>>>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
39012>>>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
39012>>>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
39012>>>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
39012>>>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
39012>>>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
39012>>>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
39012>>>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
39012>>>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
39012>>>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
39012>>>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
39012>>>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
39012>>>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
39012>>>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
39012>>>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
39012>>>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
39012>>>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
39012>>>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
39012>>>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Providers
39012>>>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
39012>>>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
39012>>>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
39012>>>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
39012>>>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
39012>>>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
39012>>>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
39012>>>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
39012>>>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
39012>>>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
39012>>>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
39012>>>>>>>>>>>
39012>>>>>>>>>>>// dwFlags definitions for CryptAcquireContext
39012>>>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
39012>>>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
39012>>>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
39012>>>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
39012>>>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
39012>>>>>>>>>>>
39012>>>>>>>>>>>// dwFlag definitions for CryptGenKey
39012>>>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
39012>>>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
39012>>>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
39012>>>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
39012>>>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
39012>>>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
39012>>>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
39012>>>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
39012>>>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
39012>>>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
39012>>>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
39012>>>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
39012>>>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
39012>>>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
39012>>>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
39012>>>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
39012>>>>>>>>>>>
39012>>>>>>>>>>>// Provider types
39012>>>>>>>>>>>Define PROV_RSA_FULL                    for 1
39012>>>>>>>>>>>Define PROV_RSA_SIG                     for 2
39012>>>>>>>>>>>Define PROV_DSS                         for 3
39012>>>>>>>>>>>Define PROV_FORTEZZA                    for 4
39012>>>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
39012>>>>>>>>>>>Define PROV_SSL                         for 6
39012>>>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
39012>>>>>>>>>>>Define PROV_DSS_DH                      for 13
39012>>>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
39012>>>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
39012>>>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
39012>>>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
39012>>>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
39012>>>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
39012>>>>>>>>>>>Define PROV_RNG                         for 21
39012>>>>>>>>>>>Define PROV_INTEL_SEC                   for 22
39012>>>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
39012>>>>>>>>>>>Define PROV_RSA_AES                     for 24
39012>>>>>>>>>>>
39012>>>>>>>>>>>// KP_MODE
39012>>>>>>>>>>>// KP_MODE
39012>>>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
39012>>>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
39012>>>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
39012>>>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
39012>>>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
39012>>>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
39012>>>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
39012>>>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
39012>>>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
39012>>>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
39012>>>>>>>>>>>
39012>>>>>>>>>>>// dwParam definitions for CryptGetKeyParam
39012>>>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
39012>>>>>>>>>>>Define KP_SALT                          for 2       // Salt value
39012>>>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
39012>>>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
39012>>>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
39012>>>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
39012>>>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
39012>>>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
39012>>>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
39012>>>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
39012>>>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
39012>>>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
39012>>>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
39012>>>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
39012>>>>>>>>>>>Define KP_Y                             for 15      // Y value
39012>>>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
39012>>>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
39012>>>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
39012>>>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
39012>>>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
39012>>>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
39012>>>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
39012>>>>>>>>>>>Define KP_RP                            for 23
39012>>>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
39012>>>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
39012>>>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
39012>>>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
39012>>>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
39012>>>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
39012>>>>>>>>>>>Define KP_KEYVAL                        for 30
39012>>>>>>>>>>>Define KP_ADMIN_PIN                     for 31
39012>>>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
39012>>>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
39012>>>>>>>>>>>Define KP_PREHASH                       for 34
39012>>>>>>>>>>>Define KP_ROUNDS                        for 35
39012>>>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
39012>>>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
39012>>>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
39012>>>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
39012>>>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
39012>>>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
39012>>>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
39012>>>>>>>>>>>
39012>>>>>>>>>>>// dwParam definitions for CryptGetHashParam
39012>>>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
39012>>>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
39012>>>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
39012>>>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
39012>>>>>>>>>>>
39012>>>>>>>>>>>// key BLOB types
39012>>>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
39012>>>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
39012>>>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
39012>>>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
39012>>>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
39012>>>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
39012>>>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
39012>>>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
39012>>>>>>>>>>>
39012>>>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
39012>>>>>>>>>>>
39012>>>>>>>>>>>//  Structure cryptimportkey
39012>>>>>>>>>>>Struct PUBLICKEYSTRUC
39012>>>>>>>>>>>    UChar    bType
39012>>>>>>>>>>>    UChar    bVersion
39012>>>>>>>>>>>    UShort   reserved
39012>>>>>>>>>>>    UInteger aiKeyAlg
39012>>>>>>>>>>>End_Struct
39012>>>>>>>>>>>
39012>>>>>>>>>>>Struct tPLAINTEXTKEYBLOB
39012>>>>>>>>>>>    PUBLICKEYSTRUC hdr
39012>>>>>>>>>>>    PUBLICKEYSTRUC hdr
39012>>>>>>>>>>>    UInteger       dwKeySize
39012>>>>>>>>>>>//    UChar[]        rgbKeyData
39012>>>>>>>>>>>End_Struct
39012>>>>>>>>>>>
39012>>>>>>>>>>>
39012>>>>>>>>>>>
39012>>>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
39012>>>>>>>>>>>Struct HMAC_INFO
39012>>>>>>>>>>>    UInteger HashAlgid
39012>>>>>>>>>>>    Pointer pbInnerString
39012>>>>>>>>>>>    DWord cbInnerString
39012>>>>>>>>>>>    Pointer pbOuterString
39012>>>>>>>>>>>    DWord cbOuterString
39012>>>>>>>>>>>End_Struct
39012>>>>>>>>>>>
39012>>>>>>>>>>>
39012>>>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
39013>>>>>>>>>>>
39013>>>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
39014>>>>>>>>>>>
39014>>>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
39015>>>>>>>>>>>
39015>>>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
39016>>>>>>>>>>>
39016>>>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
39017>>>>>>>>>>>
39017>>>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
39018>>>>>>>>>>>
39018>>>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
39019>>>>>>>>>>>
39019>>>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
39020>>>>>>>>>>>
39020>>>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
39021>>>>>>>>>>>
39021>>>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
39022>>>>>>>>>>>    
39022>>>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
39023>>>>>>>>>>>
39023>>>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
39024>>>>>>>>>>>
39024>>>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
39025>>>>>>>>>>>
39025>>>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
39026>>>>>>>>>>>    
39026>>>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
39027>>>>>>>>>>>    
39027>>>>>>>>>
39027>>>>>>>>>Class cCryptographer is a cObject
39028>>>>>>>>>    
39028>>>>>>>>>    // Procedure : Construct_Object
39028>>>>>>>>>    // Purpose   : Object constructor
39028>>>>>>>>>    Procedure Construct_Object
39030>>>>>>>>>        Forward Send Construct_Object
39032>>>>>>>>>
39032>>>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
39033>>>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
39034>>>>>>>>>        Property Integer    piCipher    CALG_RC4
39035>>>>>>>>>        Property Integer    piHash      CALG_MD5
39036>>>>>>>>>        
39036>>>>>>>>>        // Private properties
39036>>>>>>>>>        Property Handle     Private_phProv
39037>>>>>>>>>    End_Procedure
39038>>>>>>>>>    
39038>>>>>>>>>    
39038>>>>>>>>>    // Function : AcquireContext
39038>>>>>>>>>    // Purpose  : Acquire key container handle
39038>>>>>>>>>    Function AcquireContext Returns Handle
39040>>>>>>>>>        Integer iProvider
39040>>>>>>>>>        String sProvider
39040>>>>>>>>>        Handle hProv
39040>>>>>>>>>        Boolean bOk
39040>>>>>>>>>        Address addrProv
39040>>>>>>>>>        
39040>>>>>>>>>        Move 0 to hProv
39041>>>>>>>>>        Get piProvider to iProvider
39042>>>>>>>>>        Get psProvider to sProvider
39043>>>>>>>>>        
39043>>>>>>>>>        //  Determine address to be passed as provider
39043>>>>>>>>>        If (Trim(sProvider) <> "") Begin
39045>>>>>>>>>            Move (AddressOf(sProvider)) to addrProv
39046>>>>>>>>>        End
39046>>>>>>>>>>
39046>>>>>>>>>        Else Begin
39047>>>>>>>>>            Move 0 to addrProv
39048>>>>>>>>>        End
39048>>>>>>>>>>
39048>>>>>>>>>        
39048>>>>>>>>>        //  Acquire Crypto Context
39048>>>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
39049>>>>>>>>>        If (not(bOk) or hProv = 0) Begin
39051>>>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
39052>>>>>>>>>        End
39052>>>>>>>>>>
39052>>>>>>>>>        
39052>>>>>>>>>        If (not(bOk) or hProv = 0) Begin
39054>>>>>>>>>            // Fallback to original
39054>>>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
39055>>>>>>>>>            
39055>>>>>>>>>            If (not(bOk) or hProv = 0) Begin
39057>>>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
39058>>>>>>>>>            End
39058>>>>>>>>>>
39058>>>>>>>>>        End
39058>>>>>>>>>>
39058>>>>>>>>>        Set Private_phProv to hProv
39059>>>>>>>>>        
39059>>>>>>>>>        Function_Return hProv
39060>>>>>>>>>    End_Function
39061>>>>>>>>>    
39061>>>>>>>>>    // Function : ReleaseContext
39061>>>>>>>>>    // Purpose  : Releases key container handle
39061>>>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
39063>>>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
39064>>>>>>>>>    End_Function
39065>>>>>>>>>    
39065>>>>>>>>>    // Function : CreateHash
39065>>>>>>>>>    // Purpose  : Creates hash object
39065>>>>>>>>>    Function CreateHash Handle hProv Returns Handle
39067>>>>>>>>>        Integer iAlgorithm
39067>>>>>>>>>        Handle hHash
39067>>>>>>>>>        Boolean bOk
39067>>>>>>>>>        
39067>>>>>>>>>        Move 0 to hHash
39068>>>>>>>>>        Get piHash to iAlgorithm
39069>>>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
39070>>>>>>>>>        
39070>>>>>>>>>        Function_Return hHash
39071>>>>>>>>>    End_Function
39072>>>>>>>>>    
39072>>>>>>>>>    // Function : DestroyHash
39072>>>>>>>>>    // Purpose  : Destroys the hash object
39072>>>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
39074>>>>>>>>>        Function_Return (CryptDestroyHash(hHash))
39075>>>>>>>>>    End_Function
39076>>>>>>>>>    
39076>>>>>>>>>    // Function : HashData
39076>>>>>>>>>    // Purpose  : Adds data to hash object
39076>>>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
39078>>>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
39079>>>>>>>>>    End_Function
39080>>>>>>>>>    
39080>>>>>>>>>    // Function : DeriveKey
39080>>>>>>>>>    // Purpose  : Generates session key
39080>>>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
39082>>>>>>>>>        Integer iAlgorithm
39082>>>>>>>>>        Handle hKey
39082>>>>>>>>>        Boolean bOk
39082>>>>>>>>>        
39082>>>>>>>>>        Move 0 to hKey
39083>>>>>>>>>        Get piCipher to iAlgorithm
39084>>>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
39085>>>>>>>>>        
39085>>>>>>>>>        Function_Return hKey
39086>>>>>>>>>    End_Function
39087>>>>>>>>>    
39087>>>>>>>>>    // Function : ImportPlainTextKey
39087>>>>>>>>>    // Purpose  : Imports a plain text key
39087>>>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
39089>>>>>>>>>        tPLAINTEXTKEYBLOB blobhead
39089>>>>>>>>>        tPLAINTEXTKEYBLOB blobhead
39089>>>>>>>>>        Boolean   bSuccess
39089>>>>>>>>>        Handle    hKey
39089>>>>>>>>>        Integer   iHeadSize iKeySize
39089>>>>>>>>>        UChar[]   ucaKeyblob
39090>>>>>>>>>        Integer iVoid
39090>>>>>>>>>    
39090>>>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
39091>>>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
39092>>>>>>>>>    
39092>>>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
39093>>>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
39094>>>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
39095>>>>>>>>>        Move iKeySize           to blobhead.dwKeySize
39096>>>>>>>>>    
39096>>>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
39097>>>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
39098>>>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
39099>>>>>>>>>    
39099>>>>>>>>>        Move 0 to hKey
39100>>>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
39101>>>>>>>>>        If (not(bSuccess)) Begin 
39103>>>>>>>>>            Move (ShowLastError()) to iVoid
39104>>>>>>>>>        End
39104>>>>>>>>>>
39104>>>>>>>>>    
39104>>>>>>>>>        Function_Return hKey
39105>>>>>>>>>    End_Function
39106>>>>>>>>>
39106>>>>>>>>>    // Function : DestroyKey
39106>>>>>>>>>    // Purpose  : Destroys the key
39106>>>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
39108>>>>>>>>>        Function_Return (CryptDestroyKey(hKey))
39109>>>>>>>>>    End_Function
39110>>>>>>>>>    
39110>>>>>>>>>    // Function : KeyParameter
39110>>>>>>>>>    // Purpose  : Retrieves key data
39110>>>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
39112>>>>>>>>>        Integer iBuffer iLen
39112>>>>>>>>>        Boolean bOk
39112>>>>>>>>>        
39112>>>>>>>>>        Move (SizeOfType(Integer)) to iLen
39113>>>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
39114>>>>>>>>>        Function_Return iBuffer
39115>>>>>>>>>    End_Function
39116>>>>>>>>>    
39116>>>>>>>>>    // Function : HashValue
39116>>>>>>>>>    // Purpose  : Retrieves a hash value
39116>>>>>>>>>    Function HashValue Handle lhHash Returns String
39118>>>>>>>>>        Pointer lpSize
39118>>>>>>>>>        Pointer lpHash
39118>>>>>>>>>        String  lsSize
39118>>>>>>>>>        String  lsHash
39118>>>>>>>>>        Integer liResult
39118>>>>>>>>>
39118>>>>>>>>>        Move (Repeat(Character(0),4)) to lsSize
39119>>>>>>>>>        GetAddress of lsSize to lpSize
39120>>>>>>>>>
39120>>>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,lpSize,0)) to liResult
39121>>>>>>>>>        If (liResult = 0) Function_Return ""
39124>>>>>>>>>
39124>>>>>>>>>        Move (Repeat(Character(0),BytesTodWord(lsSize,1))) to lsHash
39125>>>>>>>>>        GetAddress of lsHash to lpHash
39126>>>>>>>>>
39126>>>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,lpHash,lpSize,0)) to liResult
39127>>>>>>>>>        If (liResult = 0) Function_Return ""
39130>>>>>>>>>
39130>>>>>>>>>        Function_Return lsHash
39131>>>>>>>>>    End_Function  // HashValue
39132>>>>>>>>>    
39132>>>>>>>>>            
39132>>>>>>>>>    // Function : Encrypt
39132>>>>>>>>>    // Purpose  : Encrypts data
39132>>>>>>>>>    Function Encrypt String sPassword String sData Returns String
39134>>>>>>>>>        Handle hProv hHash hKey
39134>>>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
39134>>>>>>>>>        Boolean bOk
39134>>>>>>>>>        
39134>>>>>>>>>        Get AcquireContext to hProv
39135>>>>>>>>>        If (hProv) Begin
39137>>>>>>>>>            Get CreateHash hProv to hHash
39138>>>>>>>>>            If (hHash) Begin
39140>>>>>>>>>                Get HashData hHash sPassword to bOk
39141>>>>>>>>>                If (bOk) Begin
39143>>>>>>>>>                    Get piCipher to iAlgorithm
39144>>>>>>>>>                    Get DeriveKey hProv hHash to hKey
39145>>>>>>>>>                End // If (bOk) Begin            
39145>>>>>>>>>>
39145>>>>>>>>>                Get DestroyHash hHash to bOk
39146>>>>>>>>>            End // If (hHash) Begin
39146>>>>>>>>>>
39146>>>>>>>>>            
39146>>>>>>>>>            If (hKey) Begin
39148>>>>>>>>>                //  First call to determine resulting data size
39148>>>>>>>>>                Move (Length(sData)) to iDataLen
39149>>>>>>>>>                Move (Length(sData)) to iCipherLen
39150>>>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
39151>>>>>>>>>                
39151>>>>>>>>>                //  Reserve space in string
39151>>>>>>>>>                If (iDataLen < iCipherLen) Begin
39153>>>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
39154>>>>>>>>>                End
39154>>>>>>>>>>
39154>>>>>>>>>                
39154>>>>>>>>>                //  Call to really decrypt
39154>>>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
39155>>>>>>>>>                //If (not(bOk)) Begin
39155>>>>>>>>>                    //Move "" to sData
39155>>>>>>>>>                    //Move (GetLastError()) to iErr
39155>>>>>>>>>                //End
39155>>>>>>>>>                
39155>>>>>>>>>                Get DestroyKey hKey to bOk
39156>>>>>>>>>            End // If (hKey) Begin
39156>>>>>>>>>>
39156>>>>>>>>>            Get ReleaseContext hProv to bOk
39157>>>>>>>>>        End // If (hProv) Begin
39157>>>>>>>>>>
39157>>>>>>>>>        Function_Return sData
39158>>>>>>>>>    End_Function
39159>>>>>>>>>    
39159>>>>>>>>>    // Function : Decrypt
39159>>>>>>>>>    // Purpose  : Decrypts data
39159>>>>>>>>>    Function Decrypt String sPassword String sData Returns String
39161>>>>>>>>>        Handle hProv hHash hKey
39161>>>>>>>>>        Integer iAlgorithm iDataLen
39161>>>>>>>>>        Boolean bOk
39161>>>>>>>>>        
39161>>>>>>>>>        Get AcquireContext to hProv
39162>>>>>>>>>        If (hProv) Begin
39164>>>>>>>>>            Get CreateHash hProv to hHash
39165>>>>>>>>>            If (hHash) Begin
39167>>>>>>>>>                Get HashData hHash sPassword to bOk
39168>>>>>>>>>                If (bOk) Begin
39170>>>>>>>>>                    Get piCipher to iAlgorithm
39171>>>>>>>>>                    Get DeriveKey hProv hHash to hKey
39172>>>>>>>>>                End // If (bOk) Begin            
39172>>>>>>>>>>
39172>>>>>>>>>                Get DestroyHash hHash to bOk
39173>>>>>>>>>            End // If (hHash) Begin
39173>>>>>>>>>>
39173>>>>>>>>>            
39173>>>>>>>>>            If (hKey) Begin
39175>>>>>>>>>                Move (Length(sData)) to iDataLen
39176>>>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
39177>>>>>>>>>                //If (bOk = False) Move "" to sData
39177>>>>>>>>>                
39177>>>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
39177>>>>>>>>>                If (Length(sData) > iDataLen) Begin
39179>>>>>>>>>                    Move (Left(sData, iDataLen)) to sData
39180>>>>>>>>>                End
39180>>>>>>>>>>
39180>>>>>>>>>                
39180>>>>>>>>>                Get DestroyKey hKey to bOk
39181>>>>>>>>>            End // If (hKey) Begin
39181>>>>>>>>>>
39181>>>>>>>>>            Get ReleaseContext hProv to bOk
39182>>>>>>>>>        End // If (hProv) Begin
39182>>>>>>>>>>
39182>>>>>>>>>        Function_Return sData
39183>>>>>>>>>    End_Function
39184>>>>>>>>>    
39184>>>>>>>>>    //  Function : GenerateRandom
39184>>>>>>>>>    //  Purpose  : Generates random data.
39184>>>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
39186>>>>>>>>>        Handle hProv
39186>>>>>>>>>        UChar[] uaResult
39187>>>>>>>>>        Boolean bRes
39187>>>>>>>>>        
39187>>>>>>>>>        Get AcquireContext to hProv
39188>>>>>>>>>        
39188>>>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
39189>>>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
39190>>>>>>>>>        
39190>>>>>>>>>        Get ReleaseContext hProv to bRes
39191>>>>>>>>>        
39191>>>>>>>>>        Function_Return uaResult
39192>>>>>>>>>    End_Function
39193>>>>>>>>>    
39193>>>>>>>>>    //  Function : GenerateRandomString
39193>>>>>>>>>    //  Purpose  : Generates random data and does a base64 encoding to properly present it as a string.
39193>>>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
39195>>>>>>>>>        String sResult
39195>>>>>>>>>        UChar[] aData
39196>>>>>>>>>        Address pBase64
39196>>>>>>>>>        Integer iVoid
39196>>>>>>>>>
39196>>>>>>>>>        Get GenerateRandom iLenght to aData
39197>>>>>>>>>        
39197>>>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
39198>>>>>>>>>        Move pBase64 to sResult
39199>>>>>>>>>        Move (Free(pBase64)) to iVoid    
39200>>>>>>>>>        
39200>>>>>>>>>        Function_Return (Left(sResult, iLenght))
39201>>>>>>>>>    End_Function
39202>>>>>>>>>
39202>>>>>>>>>End_Class
39203>>>>>>>Use Base64Functions.pkg
Including file: Base64Functions.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\Base64Functions.pkg)
39203>>>>>>>>>//> This package enables base64 encoding and decoding of strings:
39203>>>>>>>>>//>
39203>>>>>>>>>//>     Get EncodeString of oBase64Functions sValue to sValue
39203>>>>>>>>>//>     Get DecodeString of oBase64Functions sValue to sValue
39203>>>>>>>>>//>
39203>>>>>>>>>//> Remember to set the "max argument size" if dealing with very large
39203>>>>>>>>>//> strings.
39203>>>>>>>>>//>
39203>>>>>>>>>//> For 17.1 and later the functionality of this package is based on two functions (Base64Encode and
39203>>>>>>>>>//> Base64Decode) that are built into the runtime.
39203>>>>>>>>>//>
39203>>>>>>>>>//> But for versions up to and including 17.0 it's based on the vdfBase64.dll file that was obtained
39203>>>>>>>>>//> from DAE that have kindly allowed me to distribute it to other DF developers. Programs including
39203>>>>>>>>>//> this package will give off an error on start-up if vdfBase64.dll is not found in the /bin folder
39203>>>>>>>>>//> if the VDF runtime. You will find the DLL in the /programs folder of the StureApsPublicLib workspace
39203>>>>>>>>>
39203>>>>>>>>>Use VdfBase.pkg
39203>>>>>>>>>
39203>>>>>>>>>// Functions in vdfBase64.dll
39203>>>>>>>>>External_Function xxBase64Encode "vdfbase64Encode" vdfBase64.dll Pointer pBuffer Returns Integer
39204>>>>>>>>>External_Function xxBase64Decode "vdfbase64Decode" vdfBase64.dll Pointer pBuffer Returns Integer
39205>>>>>>>>>External_Function xxBase64Free   "vdfbase64Free"   vdfBase64.dll Pointer pBuffer Returns Integer
39206>>>>>>>>>
39206>>>>>>>>>// Structure
39206>>>>>>>>>Struct txxfBase64Buffer
39206>>>>>>>>>    Pointer pData
39206>>>>>>>>>    Integer iLength
39206>>>>>>>>>End_Struct
39206>>>>>>>>>
39206>>>>>>>>>Global_Variable Integer oBase64Functions
39206>>>>>>>>>
39206>>>>>>>>>Object _oBase64Functions is a cObject
39208>>>>>>>>>    Move Self to oBase64Functions
39209>>>>>>>>>
39209>>>>>>>>>
39209>>>>>>>>>    Function EncodeString String sValue Returns String
39212>>>>>>>>>        Address pBase64
39212>>>>>>>>>        String sResult
39212>>>>>>>>>        Integer iVoid
39212>>>>>>>>>        Move (Base64Encode(AddressOf(sValue), Length(sValue))) to pBase64
39213>>>>>>>>>        Move pBase64 to sResult
39214>>>>>>>>>        Move (Free(pBase64)) to iVoid
39215>>>>>>>>>        Function_Return sResult
39216>>>>>>>>>    End_Function
39217>>>>>>>>>
39217>>>>>>>>>    Function DecodeString String sValue Returns String
39220>>>>>>>>>        Address pBinary
39220>>>>>>>>>        String sBinary
39220>>>>>>>>>        Integer iVoid iLen
39220>>>>>>>>>        Move (Base64Decode(AddressOf(sValue), &iLen)) to pBinary
39221>>>>>>>>>        Move (Repeat(Character(0), iLen)) to sBinary
39222>>>>>>>>>        Move (MemCopy(AddressOf(sBinary), pBinary, iLen)) to iVoid
39223>>>>>>>>>        Move (Free(pBinary)) to iVoid
39224>>>>>>>>>        Function_Return sBinary
39225>>>>>>>>>    End_Function
39226>>>>>>>>>
39226>>>>>>>>>End_Object
39227>>>>>>>Use MSSqldrv.pkg
39227>>>>>>>Use db2_drv.pkg
39227>>>>>>>Use odbc_drv.pkg
39227>>>>>>>Use vWin32fh.pkg
39227>>>>>>>
39227>>>>>>>Use DUFLanguageConstants.inc
39227>>>>>>>Use MertechDUF.pkg
Including file: MertechDUF.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\MertechDUF.pkg)
39227>>>>>>>>>//
39227>>>>>>>>>// Use of Mertech drivers:
39227>>>>>>>>>// Put the line "Define DUF_Use_Mertech_Drivers in YOUR code prior the "Use" statement for this package if using Mertech drivers!
39227>>>>>>>>>// And put the line right before the "Use cDbUpdateHandler.pkg" line.
39227>>>>>>>>>//Define DUF_Use_Mertech_Drivers
39227>>>>>>>>>//
#REM DO ~ USE MERTECH.INC
39227>>>>>>>>>// MySQL Data Types
39227>>>>>>>>>Define eMySQL_DECIMAL                               for 0
39227>>>>>>>>>Define eMySQL_TINY                                  for 1
39227>>>>>>>>>Define eMySQL_SHORT                                 for 2
39227>>>>>>>>>Define eMySQL_LONG                                  for 3
39227>>>>>>>>>Define eMySQL_FLOAT                                 for 4
39227>>>>>>>>>Define eMySQL_DOUBLE                                for 5
39227>>>>>>>>>Define eMySQL_NULL                                  for 6
39227>>>>>>>>>Define eMySQL_TIMESTAMP                             for 7
39227>>>>>>>>>Define eMySQL_LONGLONG                              for 8
39227>>>>>>>>>Define eMySQL_INT24                                 for 9
39227>>>>>>>>>Define eMySQL_DATE                                  for 10
39227>>>>>>>>>Define eMySQL_TIME                                  for 11
39227>>>>>>>>>Define eMySQL_DATETIME                              for 12
39227>>>>>>>>>Define eMySQL_YEAR                                  for 13
39227>>>>>>>>>Define eMySQL_NEWDATE                               for 14
39227>>>>>>>>>Define eMySQL_BIT                                   for 16
39227>>>>>>>>>Define eMySQL_NEWDECIMAL                            for 246
39227>>>>>>>>>Define eMySQL_ENUM                                  for 247
39227>>>>>>>>>Define eMySQL_SET                                   for 248
39227>>>>>>>>>Define eMySQL_TINY_BLOB                             for 249
39227>>>>>>>>>Define eMySQL_MEDIUM_BLOB                           for 250
39227>>>>>>>>>Define eMySQL_LONG_BLOB                             for 251
39227>>>>>>>>>Define eMySQL_BLOB                                  for 252
39227>>>>>>>>>Define eMySQL_VAR_STRING                            for 253
39227>>>>>>>>>Define eMySQL_STRING                                for 254
39227>>>>>>>>>Define eMySQL_TINY_TEXT                             for -249
39227>>>>>>>>>Define eMySQL_MEDIUM_TEXT                           for -250
39227>>>>>>>>>Define eMySQL_LONG_TEXT                             for -251
39227>>>>>>>>>Define eMySQL_TEXT                                  for -252
39227>>>>>>>>>
39227>>>>>>>>>// Oracle Data Types
39227>>>>>>>>>Define eOracle_VARCHAR2                             for   1
39227>>>>>>>>>Define eOracle_NUMBER                               for   2
39227>>>>>>>>>Define eOracle_INT                                  for   3
39227>>>>>>>>>Define eOracle_FLOAT                                for   4
39227>>>>>>>>>Define eOracle_STRING                               for   5
39227>>>>>>>>>Define eOracle_LONG                                 for   8
39227>>>>>>>>>Define eOracle_ROWID                                for  11
39227>>>>>>>>>Define eOracle_DATE                                 for  12
39227>>>>>>>>>Define eOracle_RAW                                  for  23
39227>>>>>>>>>Define eOracle_LONGRAW                              for  24
39227>>>>>>>>>Define eOracle_CHAR                                 for  96
39227>>>>>>>>>Define eOracle_MSLABEL                              for 106
39227>>>>>>>>>Define eOracle_CLOB                                 for 112
39227>>>>>>>>>Define eOracle_BLOB                                 for 113
39227>>>>>>>>>Define eOracle_TIMESTAMP                            for 187
39227>>>>>>>>>Define eOracle_TIMESTAMPTZ                          for 188
39227>>>>>>>>>Define eOracle_INTERVALYM                           for 189
39227>>>>>>>>>Define eOracle_INTERVALDS                           for 190
39227>>>>>>>>>Define eOracle_TIMESTAMPLTZ                         for 232
39227>>>>>>>>>Define eOracle_NCHAR                                for 286
39227>>>>>>>>>Define eOracle_NVARCHAR2                            for 287
39227>>>>>>>>>Define eOracle_NCLOB                                for 288
39227>>>>>>>>>
39227>>>>>>>>>// PostgreSQL Data Types
39227>>>>>>>>>Define ePgSQL_CIRCLE                                for  718
39227>>>>>>>>>Define ePgSQL_MONEY                                 for  790
39227>>>>>>>>>Define ePgSQL_BOOL                                  for   16
39227>>>>>>>>>Define ePgSQL_BYTEA                                 for   17
39227>>>>>>>>>Define ePgSQL_CHAR                                  for   18
39227>>>>>>>>>Define ePgSQL_INT2                                  for   21
39227>>>>>>>>>Define ePgSQL_INT4                                  for   23
39227>>>>>>>>>Define ePgSQL_REGPROC                               for   24
39227>>>>>>>>>Define ePgSQL_REGPROCEDURE                          for 2202
39227>>>>>>>>>Define ePgSQL_REGOPER                               for 2203
39227>>>>>>>>>Define ePgSQL_REGOPERATOR                           for 2204
39227>>>>>>>>>Define ePgSQL_REGCLASS                              for 2205
39227>>>>>>>>>Define ePgSQL_REGTYPE                               for 2206
39227>>>>>>>>>Define ePgSQL_TEXT                                  for   25
39227>>>>>>>>>Define ePgSQL_CITEXT                                for  -25
39227>>>>>>>>>Define ePgSQL_OID                                   for   26
39227>>>>>>>>>Define ePgSQL_TID                                   for   27
39227>>>>>>>>>Define ePgSQL_XID                                   for   28
39227>>>>>>>>>Define ePgSQL_CID                                   for   29
39227>>>>>>>>>Define ePgSQL_XML                                   for  142
39227>>>>>>>>>Define ePgSQL_BPCHAR                                for 1042
39227>>>>>>>>>Define ePgSQL_VARCHAR                               for 1043
39227>>>>>>>>>Define ePgSQL_INT8                                  for   20
39227>>>>>>>>>Define ePgSQL_PATH                                  for  602
39227>>>>>>>>>Define ePgSQL_FLOAT4                                for  700
39227>>>>>>>>>Define ePgSQL_FLOAT8                                for  701
39227>>>>>>>>>Define ePgSQL_ABSTIME                               for  702
39227>>>>>>>>>Define ePgSQL_RELTIME                               for  703
39227>>>>>>>>>Define ePgSQL_TINTERVAL                             for  704
39227>>>>>>>>>Define ePgSQL_POINT                                 for  600
39227>>>>>>>>>Define ePgSQL_LINE                                  for  628
39227>>>>>>>>>Define ePgSQL_LSEG                                  for  601
39227>>>>>>>>>Define ePgSQL_BOX                                   for  603
39227>>>>>>>>>Define ePgSQL_POLYGON                               for  604
39227>>>>>>>>>Define ePgSQL_ACLITEM                               for 1033
39227>>>>>>>>>Define ePgSQL_MACADDR                               for  829
39227>>>>>>>>>Define ePgSQL_INET                                  for  869
39227>>>>>>>>>Define ePgSQL_CIDR                                  for  650
39227>>>>>>>>>Define ePgSQL_TIMESTAMP                             for 1114
39227>>>>>>>>>Define ePgSQL_DATE                                  for 1082
39227>>>>>>>>>Define ePgSQL_TIME                                  for 1083
39227>>>>>>>>>Define ePgSQL_TIMESTAMPTZ                           for 1184
39227>>>>>>>>>Define ePgSQL_INTERVAL                              for 1186
39227>>>>>>>>>Define ePgSQL_NUMERIC                               for 1700
39227>>>>>>>>>Define ePgSQL_TIMETZ                                for 1266
39227>>>>>>>>>Define ePgSQL_BIT                                   for 1560
39227>>>>>>>>>Define ePgSQL_VARBIT                                for 1562
39227>>>>>>>>>Define ePgSQL_UUID                                  for 2950
39227>>>>>>>>>
39227>>>>>>>>>// SQL Server Data Types
39227>>>>>>>>>Define eSQLServer_NA                                for    0
39227>>>>>>>>>Define eSQLServer_CHAR                              for    1
39227>>>>>>>>>Define eSQLServer_NUMERIC                           for    2
39227>>>>>>>>>Define eSQLServer_DECIMAL                           for    3
39227>>>>>>>>>Define eSQLServer_INT                               for    4
39227>>>>>>>>>Define eSQLServer_SMALLINT                          for    5
39227>>>>>>>>>Define eSQLServer_FLOAT                             for    6
39227>>>>>>>>>Define eSQLServer_REAL                              for    7
39227>>>>>>>>>Define eSQLServer_DOUBLE                            for    8
39227>>>>>>>>>Define eSQLServer_DATETIME                          for   11
39227>>>>>>>>>Define eSQLServer_VARCHAR                           for   12
39227>>>>>>>>>Define eSQLServer_DATE                              for   40
39227>>>>>>>>>Define eSQLServer_TIME                              for   41
39227>>>>>>>>>Define eSQLServer_DATETIME2                         for   42
39227>>>>>>>>>Define eSQLServer_DATETIMEOFFSET                    for   43
39227>>>>>>>>>Define eSQLServer_SMALLDATETIME                     for   58
39227>>>>>>>>>Define eSQLServer_TIMESTAMP                         for   93
39227>>>>>>>>>Define eSQLServer_HIERARCHYID                       for  128
39227>>>>>>>>>Define eSQLServer_GEOMETRY                          for  129
39227>>>>>>>>>Define eSQLServer_GEOGRAPHY                         for  130
39227>>>>>>>>>Define eSQLServer_TEXT                              for   -1
39227>>>>>>>>>Define eSQLServer_BINARY                            for   -2
39227>>>>>>>>>Define eSQLServer_VARBINARY                         for   -3
39227>>>>>>>>>Define eSQLServer_IMAGE                             for   -4
39227>>>>>>>>>Define eSQLServer_BIGINT                            for   -5
39227>>>>>>>>>Define eSQLServer_TINYINT                           for   -6
39227>>>>>>>>>Define eSQLServer_BIT                               for   -7
39227>>>>>>>>>Define eSQLServer_NCHAR                             for   -8
39227>>>>>>>>>Define eSQLServer_NVARCHAR                          for   -9
39227>>>>>>>>>Define eSQLServer_NTEXT                             for  -10
39227>>>>>>>>>Define eSQLServer_GUID                              for  -11
39227>>>>>>>>>Define eSQLServer_VARBINARYMAX                      for  -98
39227>>>>>>>>>Define eSQLServer_VARCHARMAX                        for  -99
39227>>>>>>>>>Define eSQLServer_NVARCHARMAX                       for -100
39227>>>>>>>>>Define eSQLServer_SQLVARIANT                        for -150
39227>>>>>>>>>Define eSQLServer_XML                               for -370
39227>>>>>>>>>
39227>>>>>>>>>Use cDbUpdateFunctionLibrary.inc
39227>>>>>>>
39227>>>>>>>// This needs to be after Mertech drivers are defined.
39227>>>>>>>Use cDbUpdateFunctionLibrary_Mixin.pkg
39227>>>>>>>
39227>>>>>>>
39227>>>>>>>    Define SQLFLEX   for "SQL_DRV"
39227>>>>>>>
39227>>>>>>>    Define MDSPgSQL  for "MDSPGSQL"
39227>>>>>>>
39227>>>>>>>    Define MDSMySQL  for "MDSMYSQL"
39227>>>>>>>
39227>>>>>>>    Define ORAFLEX   for "ORA_DRV"
39227>>>>>>>
39227>>>>>>>
39227>>>>>>>// SQLConnection.ini constants:
39227>>>>>>>    Define CS_SQLConnectionIDText       for "DFConnectionId"
39227>>>>>>>Define CS_SQLIniFileName                for "SQLConnections.ini"
39227>>>>>>>Define CS_SQLDF19IniFileName            for "DFConnId.ini"
39227>>>>>>>Define CS_SQLIniConnectionSection       for "SQL Connections" // Obsolete!
39227>>>>>>>Define CS_SQLIniSectionName             for "Connection"
39227>>>>>>>
39227>>>>>>>// DF 19 ini-file settings:
39227>>>>>>>Define CS_SQLIniConnectionIdKeyword     for "Id"
39227>>>>>>>Define CS_SQLIniDriverKeyword           for "Driver"
39227>>>>>>>Define CS_SQLIniConnectionKeyWord       for "Connection"
39227>>>>>>>Define CS_SQLIniUIDKeyword              for "UID"
39227>>>>>>>Define CS_SQLIniPWDKeyword              for "PWD"
39227>>>>>>>Define CS_SQLIniDFPWDKeyword            for "DFPWD"
39227>>>>>>>Define CS_SQLIniServerKeyword           for "SERVER"
39227>>>>>>>Define CS_SQLIniDSNKeyword              for "DSN"
39227>>>>>>>Define CS_SQLIniDatabaseKeyword         for "DATABASE"
39227>>>>>>>Define CS_SQLIniTrustedKeyword          for "Trusted_Connection"
39227>>>>>>>
39227>>>>>>>// Database Update Framework extended settings:
39227>>>>>>>Define CS_SQLIniDbTypeKeyword           for "DbType"
39227>>>>>>>Define CS_SQLIniSchemaKeyword           for "Schema"
39227>>>>>>>Define CS_SQLIniBaseTableSpaceKeyword   for "Base Table Space"
39227>>>>>>>Define CS_SQLIniLongTableSpaceKeyword   for "Long Table Space"
39227>>>>>>>Define CS_SQLIniIndexTableSpaceKeyword  for "Index Table Space"
39227>>>>>>>Define CS_SQLIniSilentLoginKeyword      for "Silent Login"
39227>>>>>>>Define CS_SQLIniDisabledKeyword         for "Disabled"      // For compatability with DF19.
39227>>>>>>>
39227>>>>>>>Define CS_SQLIniConnectionPWD           for "PWD"
39227>>>>>>>Define CS_SQLIniConnectionYes           for "Yes"
39227>>>>>>>Define CS_SQLIniConnectionNo            for "No"
39227>>>>>>>
39227>>>>>>>Struct tSQLConnection
39227>>>>>>>    Boolean bEnabled                // 1. There can only be one active/enabled connection at a time.
39227>>>>>>>    String sConnectionID            // 2. The name of the connection ID.
39227>>>>>>>    Integer iDbType                 // 3. Database type; "MS-SQL Server", "DB2", "Oracle", "MySQL", "PostgreSQL"
39227>>>>>>>    String sDriverID                // 4. Name of the driver. E.g. "MSSQLDRV", "DB2_DRV" or "ODBC_DRV".
39227>>>>>>>    String sServer                  // 5. SQL Server/DSN/ODBC source name. (In DF19 this is the "sString" member of the tConnection struct.)
39227>>>>>>>    String sDatabase                // 6. SQL Database
39227>>>>>>>    String sConnectionString        // 7. Full connection string as is needed by e.g. the login command.
39227>>>>>>>    Boolean bTrusted                // 8. Trusted connection (then is UID & PWD not used)
39227>>>>>>>    String sUserID                  // 9. User ID
39227>>>>>>>    String sPassword                // 10. Password
39227>>>>>>>    String sSchema                  // 11. DB2 (and perhaps ODBC specific)
39227>>>>>>>    String sBaseTableSpace          // 12. DB2 specific
39227>>>>>>>    String sLongTableSpace          // 13. DB2 specific
39227>>>>>>>    String sIndexTableSpace         // 14. DB2 specific
39227>>>>>>>    Boolean bSilentLogin            // 15. True=Silent login. (i.e. don't show Database login dialog if database login to fails). Same as driver "Options" parameter.
39227>>>>>>>    Boolean bError                  // 16. Set to true on error.
39227>>>>>>>    Boolean bDAWConnection          // 17. True if a DFConnId.ini file (from DAW) has been used instead of a DUF SQLConnections.ini file.
39227>>>>>>>//    Boolean bDisabled               // 17. For compatability with DF19 Managed Connections only. Not used by DUF (Database Update Framework).
39227>>>>>>>//    Integer iDriverIndex            // 18. For compatability with DF19 Managed Connections only. Not used by DUF (Database Update Framework).
39227>>>>>>>End_Struct
39227>>>>>
39227>>>>>Class cDbUpdateFunctionLibrary_Mixin is a Mixin
39228>>>>>    Procedure CreateDbUpdateLibraryProperties
39230>>>>>        Handle hoSQLManagerMT
39230>>>>>
39230>>>>>        Property String Private.psUseDatabase ""
39231>>>>>
39231>>>>>//        { Visibility=Private }
39231>>>>>        // These are used by the Error routine to show the Table# & Field# if something goes wrong:
39231>>>>>        Property Handle  Private.phCurrentTable 0
39232>>>>>        Property Integer Private.piCurrentField 0
39233>>>>>
39233>>>>>        Property Handle phoCLIHandler      (Create(Self,RefClass(cCLIHandler)))
39234>>>>>        Property Handle phoSQLManager      (Create(Self,RefClass(cSQLHandleManager)))
39235>>>>>
39235>>>>>        Property Handle phoSQLManagerMT
39236>>>>>
39236>>>>>        Property Handle phoMSSQLHandler    (Create(Self,RefClass(cMSSQLHandler)))
39237>>>>>        Property Handle phoDB2SQLHandler   (Create(Self,RefClass(cDB2Handler)))
39238>>>>>        Property Handle phoODBCSQLHandler  (Create(Self,RefClass(cODBCHandler)))
39239>>>>>        Property Handle phoSQLConnectionHandler 0
39240>>>>>        Property tSQLKeyWords[] paSQLKeywordArray
39241>>>>>
39241>>>>>        Property Boolean pbHandleQueryErrors True
39242>>>>>
39242>>>>>        Property tSqlColumnNew[] paQueryColumns
39243>>>>>        Property String[] paSQLFetchResults
39244>>>>>
39244>>>>>        // Error handling     
39244>>>>>        Property Integer Error_Report_Mode DUF_ERROR_REPORT        
39245>>>>>        Property Boolean pbSqlError False
39246>>>>>        Property tSqlErrorArray paSqlErrorArray
39247>>>>>        Property Boolean pbProcessingError False
39248>>>>>
39248>>>>>        // Statistics on query
39248>>>>>        Property TimeSpan ptsTotalQueryTime
39249>>>>>        Property TimeSpan ptsQueryExec
39250>>>>>        Property TimeSpan ptsFetchResults
39251>>>>>        Property Integer piColumns 0
39252>>>>>        Property Integer piRows 0
39253>>>>>        Property Integer piRowType 0
39254>>>>>        Property String[] paQueryMessages
39255>>>>>        Property String psSQLStatementString
39256>>>>>
39256>>>>>        Property Integer[] paTableConvertExceptions
39257>>>>>
39257>>>>>        Property Integer[] paTableDateCorrectionExceptions
39258>>>>>
39258>>>>>        // Number of SQL statements (chunks) to be executed when executing a really big
39258>>>>>        // SQL file that has been compiled into the program. It is way faster to divide
39258>>>>>        // the statements in smaller chunks than to execute them all at the same time.
39258>>>>>        Property Integer piChunkMax 500
39259>>>>>
39259>>>>>        // Fill the paSQLKeywordArray array with values;
39259>>>>>        Send SetupSQLKeywordArray
39260>>>>>    End_Procedure
39261>>>>>
39261>>>>>    // Custom array find function. It compares both the iSQLWord & iSQLDbType params.
39261>>>>>    Function CompareFindSQLKeyWords tSQLKeyWords SQLKeywords1 tSQLKeyWords SQLKeywords2 Returns Integer
39263>>>>>        If (SQLKeywords1.iSQLWord = SQLKeywords2.iSQLWord and SQLKeywords1.iSQLDbType = SQLKeywords2.iSQLDbType) Begin
39265>>>>>            Function_Return (EQ)
39266>>>>>        End
39266>>>>>>
39266>>>>>        Function_Return (GT)
39267>>>>>    End_Function
39268>>>>>
39268>>>>>    // Custom array sort function. It compares both the iSQLWord & iSQLDbType params.
39268>>>>>    Function CompareSortSQLKeyWords tSQLKeyWords SQLKeywords1 tSQLKeyWords SQLKeywords2 Returns Integer
39270>>>>>        If (SQLKeywords1.iSQLWord   < SQLKeywords2.iSQLWord) ;            Function_Return (LT)
39273>>>>>        If (SQLKeywords1.iSQLWord   > SQLKeywords2.iSQLWord) ;            Function_Return (GT)
39276>>>>>        If (SQLKeywords1.iSQLDbType < SQLKeywords2.iSQLDbType) ;            Function_Return (LT)
39279>>>>>        If (SQLKeywords1.iSQLDbType > SQLKeywords2.iSQLDbType) ;            Function_Return (GT)
39282>>>>>
39282>>>>>        Function_Return (EQ)
39283>>>>>    End_Function
39284>>>>>
39284>>>>>    Procedure Add_Element Integer iSQLKeywordConstant Integer iEN_dbType String sSQLKeyword
39286>>>>>        tSQLKeyWords[] SQLKeywordArray
39286>>>>>        tSQLKeyWords[] SQLKeywordArray
39287>>>>>        Integer iSize
39287>>>>>
39287>>>>>        Get paSQLKeywordArray to SQLKeywordArray
39288>>>>>        Move (SizeOfArray(SQLKeywordArray)) to iSize
39289>>>>>        Move iSQLKeywordConstant to SQLKeywordArray[iSize].iSQLWord
39290>>>>>        Move iEN_dbType          to SQLKeywordArray[iSize].iSQLDbType
39291>>>>>        Move sSQLKeyword         to SQLKeywordArray[iSize].sSQLPhrase
39292>>>>>
39292>>>>>        Set paSQLKeywordArray to SQLKeywordArray
39293>>>>>    End_Procedure
39294>>>>>
39294>>>>>    // Creates a struct array with all SQL keywords
39294>>>>>    // for all EN_xxx SQL back-ends. Various back-ends can
39294>>>>>    // have slightly different wording.
39294>>>>>    // If a new EN_dbTypexxx type is added; additions
39294>>>>>    // needs to be done for every keyword group below.
39294>>>>>    Procedure SetupSQLKeywordArray
39296>>>>>        tSQLKeyWords[] SQLKeywordArray SQLKeywordArraySorted
39296>>>>>        tSQLKeyWords[] SQLKeywordArray SQLKeywordArraySorted
39298>>>>>
39298>>>>>        // This should only be called once; but in case it is
39298>>>>>        // we delete the array first.
39298>>>>>        Set paSQLKeywordArray to SQLKeywordArray
39299>>>>>
39299>>>>>        // ToDo: *** Not all SQL Key-words has been checked for other backends than MS-SQL ***
39299>>>>>        //
39299>>>>>        Send Add_Element CI_SQLAlterDatabase EN_dbTypeMSSQL    "ALTER DATABASE"
39300>>>>>        Send Add_Element CI_SQLAlterDatabase EN_dbTypeMySQL    "ALTER DATABASE"
39301>>>>>        Send Add_Element CI_SQLAlterDatabase EN_dbTypeOracle   "ALTER DATABASE"
39302>>>>>        Send Add_Element CI_SQLAlterDatabase EN_dbTypeDB2      "ALTER DATABASE"
39303>>>>>        Send Add_Element CI_SQLAlterDatabase EN_dbTypePostgre  "ALTER DATABASE"  
39304>>>>>        
39304>>>>>        Send Add_Element CI_SQLSingle_User   EN_dbTypeMSSQL    "SINGLE_USER"
39305>>>>>        Send Add_Element CI_SQLSingle_User   EN_dbTypeMySQL    "SINGLE_USER"
39306>>>>>        Send Add_Element CI_SQLSingle_User   EN_dbTypeOracle   "SINGLE_USER"
39307>>>>>        Send Add_Element CI_SQLSingle_User   EN_dbTypeDB2      "SINGLE_USER"
39308>>>>>        Send Add_Element CI_SQLSingle_User   EN_dbTypePostgre  "SINGLE_USER"  
39309>>>>>        
39309>>>>>        Send Add_Element CI_SQLMulti_User    EN_dbTypeMSSQL    "MULTI_USER"
39310>>>>>        Send Add_Element CI_SQLMulti_User    EN_dbTypeMySQL    "MULTI_USER"
39311>>>>>        Send Add_Element CI_SQLMulti_User    EN_dbTypeOracle   "MULTI_USER"
39312>>>>>        Send Add_Element CI_SQLMulti_User    EN_dbTypeDB2      "MULTI_USER"
39313>>>>>        Send Add_Element CI_SQLMulti_User    EN_dbTypePostgre  "MULTI_USER"  
39314>>>>>        
39314>>>>>        Send Add_Element CI_SQLRollback      EN_dbTypeMSSQL    "ROLLBACK"
39315>>>>>        Send Add_Element CI_SQLRollback      EN_dbTypeMySQL    "ROLLBACK"
39316>>>>>        Send Add_Element CI_SQLRollback      EN_dbTypeOracle   "ROLLBACK"
39317>>>>>        Send Add_Element CI_SQLRollback      EN_dbTypeDB2      "ROLLBACK"
39318>>>>>        Send Add_Element CI_SQLRollback      EN_dbTypePostgre  "ROLLBACK"  
39319>>>>>        
39319>>>>>        Send Add_Element CI_SQLImmediate     EN_dbTypeMSSQL    "IMMEDIATE"
39320>>>>>        Send Add_Element CI_SQLImmediate     EN_dbTypeMySQL    "IMMEDIATE"
39321>>>>>        Send Add_Element CI_SQLImmediate     EN_dbTypeOracle   "IMMEDIATE"
39322>>>>>        Send Add_Element CI_SQLImmediate     EN_dbTypeDB2      "IMMEDIATE"
39323>>>>>        Send Add_Element CI_SQLImmediate     EN_dbTypePostgre  "IMMEDIATE"  
39324>>>>>        
39324>>>>>        Send Add_Element CI_SQLAlterTable EN_dbTypeMSSQL    "ALTER TABLE"
39325>>>>>        Send Add_Element CI_SQLAlterTable EN_dbTypeMySQL    "ALTER TABLE"
39326>>>>>        Send Add_Element CI_SQLAlterTable EN_dbTypeOracle   "ALTER TABLE"
39327>>>>>        Send Add_Element CI_SQLAlterTable EN_dbTypeDB2      "ALTER TABLE"
39328>>>>>        Send Add_Element CI_SQLAlterTable EN_dbTypePostgre  "ALTER TABLE"
39329>>>>>
39329>>>>>        Send Add_Element CI_SQLAdd EN_dbTypeMSSQL           "ADD"
39330>>>>>        Send Add_Element CI_SQLAdd EN_dbTypeMySQL           "ADD"
39331>>>>>        Send Add_Element CI_SQLAdd EN_dbTypeOracle          "ADD"
39332>>>>>        Send Add_Element CI_SQLAdd EN_dbTypeDB2             "ADD"
39333>>>>>        Send Add_Element CI_SQLAdd EN_dbTypePostgre         "ADD"
39334>>>>>
39334>>>>>        Send Add_Element CI_SQLUpdate EN_dbTypeMSSQL        "UPDATE"
39335>>>>>        Send Add_Element CI_SQLUpdate EN_dbTypeMySQL        "UPDATE"
39336>>>>>        Send Add_Element CI_SQLUpdate EN_dbTypeOracle       "UPDATE"
39337>>>>>        Send Add_Element CI_SQLUpdate EN_dbTypeDB2          "UPDATE"
39338>>>>>        Send Add_Element CI_SQLUpdate EN_dbTypePostgre      "UPDATE"
39339>>>>>
39339>>>>>        Send Add_Element CI_SQLNotNull EN_dbTypeMSSQL       "NOT NULL"
39340>>>>>        Send Add_Element CI_SQLNotNull EN_dbTypeMySQL       "NOT NULL"
39341>>>>>        Send Add_Element CI_SQLNotNull EN_dbTypeOracle      "" // Seems like Oracle can't handle setting a new column to 'NOT NULL' if the table exists with data(!)
39342>>>>>        Send Add_Element CI_SQLNotNull EN_dbTypeDB2         "DEFAULT NOT NULL"
39343>>>>>        Send Add_Element CI_SQLNotNull EN_dbTypePostgre     "NOT NULL"
39344>>>>>
39344>>>>>        Send Add_Element CI_SQLSet EN_dbTypeMSSQL           "SET"
39345>>>>>        Send Add_Element CI_SQLSet EN_dbTypeMySQL           "SET"
39346>>>>>        Send Add_Element CI_SQLSet EN_dbTypeOracle          "SET"
39347>>>>>        Send Add_Element CI_SQLSet EN_dbTypeDB2             "SET"
39348>>>>>        Send Add_Element CI_SQLSet EN_dbTypePostgre         "SET"
39349>>>>>
39349>>>>>        Send Add_Element CI_SQLWith EN_dbTypeMSSQL          "WITH"
39350>>>>>        Send Add_Element CI_SQLWith EN_dbTypeMySQL          "WITH"
39351>>>>>        Send Add_Element CI_SQLWith EN_dbTypeOracle         "WITH"
39352>>>>>        Send Add_Element CI_SQLWith EN_dbTypeDB2            "WITH"
39353>>>>>        Send Add_Element CI_SQLWith EN_dbTypePostgre        "WITH"
39354>>>>>
39354>>>>>        Send Add_Element CI_SQLCreateDatabase EN_dbTypeMSSQL    "CREATE DATABASE"
39355>>>>>        Send Add_Element CI_SQLCreateDatabase EN_dbTypeMySQL    "CREATE DATABASE"
39356>>>>>        Send Add_Element CI_SQLCreateDatabase EN_dbTypeOracle   "CREATE DATABASE"
39357>>>>>        Send Add_Element CI_SQLCreateDatabase EN_dbTypeDB2      "CREATE DATABASE"
39358>>>>>        Send Add_Element CI_SQLCreateDatabase EN_dbTypePostgre  "CREATE DATABASE"
39359>>>>>
39359>>>>>        Send Add_Element CI_SQLDatabaseCollation EN_dbTypeMSSQL    "COLLATE"
39360>>>>>        Send Add_Element CI_SQLDatabaseCollation EN_dbTypeMySQL    "COLLATE"
39361>>>>>        Send Add_Element CI_SQLDatabaseCollation EN_dbTypeOracle   "COLLATE"
39362>>>>>        Send Add_Element CI_SQLDatabaseCollation EN_dbTypeDB2      "COLLATE"
39363>>>>>        Send Add_Element CI_SQLDatabaseCollation EN_dbTypePostgre  "COLLATE"
39364>>>>>
39364>>>>>        Send Add_Element CI_SQLCreateView EN_dbTypeMSSQL    "CREATE VIEW"
39365>>>>>        Send Add_Element CI_SQLCreateView EN_dbTypeMySQL    "CREATE VIEW"
39366>>>>>        Send Add_Element CI_SQLCreateView EN_dbTypeOracle   "CREATE VIEW"
39367>>>>>        Send Add_Element CI_SQLCreateView EN_dbTypeDB2      "CREATE VIEW"
39368>>>>>        Send Add_Element CI_SQLCreateView EN_dbTypePostgre  "CREATE VIEW"
39369>>>>>
39369>>>>>        Send Add_Element CI_SQLDropView EN_dbTypeMSSQL      "DROP VIEW"
39370>>>>>        Send Add_Element CI_SQLDropView EN_dbTypeMySQL      "DROP VIEW"
39371>>>>>        Send Add_Element CI_SQLDropView EN_dbTypeOracle     "DROP VIEW"
39372>>>>>        Send Add_Element CI_SQLDropView EN_dbTypeDB2        "DROP VIEW"
39373>>>>>        Send Add_Element CI_SQLDropView EN_dbTypePostgre    "DROP VIEW"
39374>>>>>
39374>>>>>        Send Add_Element CI_SQLCreateTable EN_dbTypeMSSQL   "CREATE TABLE"
39375>>>>>        Send Add_Element CI_SQLCreateTable EN_dbTypeMySQL   "CREATE TABLE"
39376>>>>>        Send Add_Element CI_SQLCreateTable EN_dbTypeOracle  "CREATE TABLE"
39377>>>>>        Send Add_Element CI_SQLCreateTable EN_dbTypeDB2     "CREATE TABLE"
39378>>>>>        Send Add_Element CI_SQLCreateTable EN_dbTypePostgre "CREATE TABLE"
39379>>>>>
39379>>>>>        Send Add_Element CI_SQLDropTable EN_dbTypeMSSQL     "DROP TABLE"
39380>>>>>        Send Add_Element CI_SQLDropTable EN_dbTypeMySQL     "DROP TABLE"
39381>>>>>        Send Add_Element CI_SQLDropTable EN_dbTypeOracle    "DROP TABLE"
39382>>>>>        Send Add_Element CI_SQLDropTable EN_dbTypeDB2       "DROP TABLE"
39383>>>>>        Send Add_Element CI_SQLDropTable EN_dbTypePostgre   "DROP TABLE"
39384>>>>>
39384>>>>>        Send Add_Element CI_SQLRenameTable EN_dbTypeMSSQL   "EXEC sp_rename"
39385>>>>>        Send Add_Element CI_SQLRenameTable EN_dbTypeMySQL   "RENAME TABLE"
39386>>>>>        Send Add_Element CI_SQLRenameTable EN_dbTypeOracle  "RENAME TABLE"
39387>>>>>        Send Add_Element CI_SQLRenameTable EN_dbTypeDB2     "RENAME TABLE"
39388>>>>>        Send Add_Element CI_SQLRenameTable EN_dbTypePostgre "RENAME TO"
39389>>>>>
39389>>>>>        Send Add_Element CI_SQLDropColumn EN_dbTypeMSSQL    "DROP COLUMN"
39390>>>>>        Send Add_Element CI_SQLDropColumn EN_dbTypeMySQL    "DROP COLUMN"
39391>>>>>        Send Add_Element CI_SQLDropColumn EN_dbTypeOracle   "DROP COLUMN"
39392>>>>>        Send Add_Element CI_SQLDropColumn EN_dbTypeDB2      "DROP COLUMN"
39393>>>>>        Send Add_Element CI_SQLDropColumn EN_dbTypePostgre  "DROP COLUMN"
39394>>>>>
39394>>>>>        Send Add_Element CI_SQLColumn EN_dbTypeMSSQL        "COLUMN"
39395>>>>>        Send Add_Element CI_SQLColumn EN_dbTypeMySQL        "COLUMN"
39396>>>>>        Send Add_Element CI_SQLColumn EN_dbTypeOracle       "COLUMN"
39397>>>>>        Send Add_Element CI_SQLColumn EN_dbTypeDB2          "COLUMN"
39398>>>>>        Send Add_Element CI_SQLColumn EN_dbTypePostgre      "COLUMN"
39399>>>>>
39399>>>>>        Send Add_Element CI_SQLAlterColumn EN_dbTypeMSSQL   "ALTER COLUMN"
39400>>>>>        Send Add_Element CI_SQLAlterColumn EN_dbTypeMySQL   "MODIFY"
39401>>>>>        Send Add_Element CI_SQLAlterColumn EN_dbTypeOracle  "MODIFY"
39402>>>>>        Send Add_Element CI_SQLAlterColumn EN_dbTypeDB2     "ALTER COLUMN"
39403>>>>>        Send Add_Element CI_SQLAlterColumn EN_dbTypePostgre "ALTER COLUMN"
39404>>>>>
39404>>>>>        Send Add_Element CI_SQLRenameColumn EN_dbTypeMSSQL   "EXEC sp_RENAME"
39405>>>>>        Send Add_Element CI_SQLRenameColumn EN_dbTypeMySQL   "CHANGE"
39406>>>>>        Send Add_Element CI_SQLRenameColumn EN_dbTypeOracle  "RENAME COLUMN"
39407>>>>>        Send Add_Element CI_SQLRenameColumn EN_dbTypeDB2     "RENAME COLUMN"
39408>>>>>        Send Add_Element CI_SQLRenameColumn EN_dbTypePostgre "RENAME COLUMN"
39409>>>>>
39409>>>>>        Send Add_Element CI_SQLSelect EN_dbTypeMSSQL        "SELECT"
39410>>>>>        Send Add_Element CI_SQLSelect EN_dbTypeMySQL        "SELECT"
39411>>>>>        Send Add_Element CI_SQLSelect EN_dbTypeOracle       "SELECT"
39412>>>>>        Send Add_Element CI_SQLSelect EN_dbTypeDB2          "SELECT"
39413>>>>>        Send Add_Element CI_SQLSelect EN_dbTypePostgre      "SELECT"
39414>>>>>
39414>>>>>        Send Add_Element CI_SQLWhere EN_dbTypeMSSQL         "WHERE"
39415>>>>>        Send Add_Element CI_SQLWhere EN_dbTypeMySQL         "WHERE"
39416>>>>>        Send Add_Element CI_SQLWhere EN_dbTypeOracle        "WHERE"
39417>>>>>        Send Add_Element CI_SQLWhere EN_dbTypeDB2           "WHERE"
39418>>>>>        Send Add_Element CI_SQLWhere EN_dbTypePostgre       "WHERE"
39419>>>>>
39419>>>>>        Send Add_Element CI_SQLFrom EN_dbTypeMSSQL          "FROM"
39420>>>>>        Send Add_Element CI_SQLFrom EN_dbTypeMySQL          "FROM"
39421>>>>>        Send Add_Element CI_SQLFrom EN_dbTypeOracle         "FROM"
39422>>>>>        Send Add_Element CI_SQLFrom EN_dbTypeDB2            "FROM"
39423>>>>>        Send Add_Element CI_SQLFrom EN_dbTypePostgre        "FROM"
39424>>>>>
39424>>>>>        Send Add_Element CI_SQLInfoSchema EN_dbTypeMSSQL    "INFORMATION_SCHEMA.COLUMNS"
39425>>>>>        Send Add_Element CI_SQLInfoSchema EN_dbTypeMySQL    "INFORMATION_SCHEMA.COLUMNS"
39426>>>>>        Send Add_Element CI_SQLInfoSchema EN_dbTypeOracle   "INFORMATION_SCHEMA.COLUMNS"
39427>>>>>        Send Add_Element CI_SQLInfoSchema EN_dbTypeDB2      "INFORMATION_SCHEMA.COLUMNS"
39428>>>>>        Send Add_Element CI_SQLInfoSchema EN_dbTypePostgre  "INFORMATION_SCHEMA.COLUMNS"
39429>>>>>
39429>>>>>        Send Add_Element CI_SQLTable_Name EN_dbTypeMSSQL    "TABLE_NAME"
39430>>>>>        Send Add_Element CI_SQLTable_Name EN_dbTypeMySQL    "TABLE_NAME"
39431>>>>>        Send Add_Element CI_SQLTable_Name EN_dbTypeOracle   "TABLE_NAME"
39432>>>>>        Send Add_Element CI_SQLTable_Name EN_dbTypeDB2      "TABLE_NAME"
39433>>>>>        Send Add_Element CI_SQLTable_Name EN_dbTypePostgre  "TABLE_NAME"
39434>>>>>
39434>>>>>        Send Add_Element CI_SQLTable EN_dbTypeMSSQL         "TABLE"
39435>>>>>        Send Add_Element CI_SQLTable EN_dbTypeMySQL         "TABLE"
39436>>>>>        Send Add_Element CI_SQLTable EN_dbTypeOracle        "TABLE"
39437>>>>>        Send Add_Element CI_SQLTable EN_dbTypeDB2           "TABLE"
39438>>>>>        Send Add_Element CI_SQLTable EN_dbTypePostgre       "TABLE"
39439>>>>>
39439>>>>>        Send Add_Element CI_SQLSys EN_dbTypeMSSQL           "SYS"
39440>>>>>        Send Add_Element CI_SQLSys EN_dbTypeMySQL           "SYS"
39441>>>>>        Send Add_Element CI_SQLSys EN_dbTypeOracle          "SYS"
39442>>>>>        Send Add_Element CI_SQLSys EN_dbTypeDB2             "SYS"
39443>>>>>        Send Add_Element CI_SQLSys EN_dbTypePostgre         "SYS"
39444>>>>>
39444>>>>>        Send Add_Element CI_SQLSp_Help EN_dbTypeMSSQL       "SP_HELP"
39445>>>>>        Send Add_Element CI_SQLSp_Help EN_dbTypeMySQL       "SP_HELP"
39446>>>>>        Send Add_Element CI_SQLSp_Help EN_dbTypeOracle      "SP_HELP"
39447>>>>>        Send Add_Element CI_SQLSp_Help EN_dbTypeDB2         "SP_HELP"
39448>>>>>        Send Add_Element CI_SQLSp_Help EN_dbTypePostgre     "SP_HELP"
39449>>>>>
39449>>>>>        Send Add_Element CI_SQLSetNoCountOn EN_dbTypeMSSQL      "SET NOCOUNT ON"
39450>>>>>        Send Add_Element CI_SQLSetNoCountOn EN_dbTypeMySQL      "SET NOCOUNT ON"
39451>>>>>        Send Add_Element CI_SQLSetNoCountOn EN_dbTypeOracle     "SET NOCOUNT ON"
39452>>>>>        Send Add_Element CI_SQLSetNoCountOn EN_dbTypeDB2        "SET NOCOUNT ON"
39453>>>>>        Send Add_Element CI_SQLSetNoCountOn EN_dbTypePostgre    "SET NOCOUNT ON"
39454>>>>>
39454>>>>>        Send Add_Element CI_SQLTo EN_dbTypeMSSQL            "TO"
39455>>>>>        Send Add_Element CI_SQLTo EN_dbTypeMySQL            "TO"
39456>>>>>        Send Add_Element CI_SQLTo EN_dbTypeOracle           "TO"
39457>>>>>        Send Add_Element CI_SQLTo EN_dbTypeDB2              "TO"
39458>>>>>        Send Add_Element CI_SQLTo EN_dbTypePostgre          "TO"
39459>>>>>
39459>>>>>        Send Add_Element CI_SQLGO EN_dbTypeMSSQL            "GO"
39460>>>>>        Send Add_Element CI_SQLGO EN_dbTypeMySQL            "GO"
39461>>>>>        Send Add_Element CI_SQLGO EN_dbTypeOracle           "GO"
39462>>>>>        Send Add_Element CI_SQLGO EN_dbTypeDB2              "GO"
39463>>>>>        Send Add_Element CI_SQLGO EN_dbTypePostgre          "GO"
39464>>>>>
39464>>>>>        Send Add_Element CI_SQLUse EN_dbTypeMSSQL           "USE"
39465>>>>>        Send Add_Element CI_SQLUse EN_dbTypeMySQL           "USE"
39466>>>>>        Send Add_Element CI_SQLUse EN_dbTypeOracle          "USE"
39467>>>>>        Send Add_Element CI_SQLUse EN_dbTypeDB2             "USE"
39468>>>>>        Send Add_Element CI_SQLUse EN_dbTypePostgre         "USE"
39469>>>>>
39469>>>>>        Send Add_Element CI_SQLDBO EN_dbTypeMSSQL           "dbo"
39470>>>>>        Send Add_Element CI_SQLDBO EN_dbTypeMySQL           "dbo"
39471>>>>>        Send Add_Element CI_SQLDBO EN_dbTypeOracle          "dbo"
39472>>>>>        Send Add_Element CI_SQLDBO EN_dbTypeDB2             "dbo"
39473>>>>>        Send Add_Element CI_SQLDBO EN_dbTypePostgre         "dbo"
39474>>>>>
39474>>>>>        Send Add_Element CI_SQLMaster EN_dbTypeMSSQL        "MASTER"
39475>>>>>        Send Add_Element CI_SQLMaster EN_dbTypeMySQL        "MASTER"
39476>>>>>        Send Add_Element CI_SQLMaster EN_dbTypeOracle       "MASTER"
39477>>>>>        Send Add_Element CI_SQLMaster EN_dbTypeDB2          "MASTER"
39478>>>>>        Send Add_Element CI_SQLMaster EN_dbTypePostgre      "MASTER"
39479>>>>>
39479>>>>>        Send Add_Element CI_SQLName EN_dbTypeMSSQL          "NAME"
39480>>>>>        Send Add_Element CI_SQLName EN_dbTypeMySQL          "NAME"
39481>>>>>        Send Add_Element CI_SQLName EN_dbTypeOracle         "NAME"
39482>>>>>        Send Add_Element CI_SQLName EN_dbTypeDB2            "NAME"
39483>>>>>        Send Add_Element CI_SQLName EN_dbTypePostgre        "NAME"
39484>>>>>
39484>>>>>        Send Add_Element CI_SQLDatabases EN_dbTypeMSSQL     "DATABASES"
39485>>>>>        Send Add_Element CI_SQLDatabases EN_dbTypeMySQL     "DATABASES"
39486>>>>>        Send Add_Element CI_SQLDatabases EN_dbTypeOracle    "DATABASES"
39487>>>>>        Send Add_Element CI_SQLDatabases EN_dbTypeDB2       "DATABASES"
39488>>>>>        Send Add_Element CI_SQLDatabases EN_dbTypePostgre   "DATABASES"
39489>>>>>
39489>>>>>        Send Add_Element CI_SQLSysIndexes EN_dbTypeMSSQL    "SYS.INDEXES"
39490>>>>>        Send Add_Element CI_SQLSysIndexes EN_dbTypeMySQL    "SYS.INDEXES"
39491>>>>>        Send Add_Element CI_SQLSysIndexes EN_dbTypeOracle   "SYS.INDEXES"
39492>>>>>        Send Add_Element CI_SQLSysIndexes EN_dbTypeDB2      "SYS.INDEXES"
39493>>>>>        Send Add_Element CI_SQLSysIndexes EN_dbTypePostgre  "SYS.INDEXES"
39494>>>>>
39494>>>>>        Send Add_Element CI_SQLObjectID EN_dbTypeMSSQL      "OBJECT_ID"
39495>>>>>        Send Add_Element CI_SQLObjectID EN_dbTypeMySQL      "OBJECT_ID"
39496>>>>>        Send Add_Element CI_SQLObjectID EN_dbTypeOracle     "OBJECT_ID"
39497>>>>>        Send Add_Element CI_SQLObjectID EN_dbTypeDB2        "OBJECT_ID"
39498>>>>>        Send Add_Element CI_SQLObjectID EN_dbTypePostgre    "OBJECT_ID"
39499>>>>>
39499>>>>>        Send Add_Element CI_SQLID EN_dbTypeMSSQL            "ID"
39500>>>>>        Send Add_Element CI_SQLID EN_dbTypeMySQL            "ID"
39501>>>>>        Send Add_Element CI_SQLID EN_dbTypeOracle           "ID"
39502>>>>>        Send Add_Element CI_SQLID EN_dbTypeDB2              "ID"
39503>>>>>        Send Add_Element CI_SQLID EN_dbTypePostgre          "ID"
39504>>>>>
39504>>>>>        Send Add_Element CI_SQLAND EN_dbTypeMSSQL           "AND"
39505>>>>>        Send Add_Element CI_SQLAND EN_dbTypeMySQL           "AND"
39506>>>>>        Send Add_Element CI_SQLAND EN_dbTypeOracle          "AND"
39507>>>>>        Send Add_Element CI_SQLAND EN_dbTypeDB2             "AND"
39508>>>>>        Send Add_Element CI_SQLAND EN_dbTypePostgre         "AND"
39509>>>>>
39509>>>>>        // In case we didn't put the above in order (and we don't need to); we sort the struct array.
39509>>>>>        Get paSQLKeywordArray to SQLKeywordArray
39510>>>>>        Move (SortArray(SQLKeywordArray, Self, (RefFunc(CompareSortSQLKeyWords)))) to SQLKeywordArraySorted
39511>>>>>        Set paSQLKeywordArray to SQLKeywordArraySorted
39512>>>>>
39512>>>>>    End_Procedure
39513>>>>>
39513>>>>>End_Class
39514>>>Use cSQLConnectionHandler.pkg
Including file: cSQLConnectionHandler.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cSQLConnectionHandler.pkg)
39514>>>>>//****************************************************************************
39514>>>>>// $Module type: Class
39514>>>>>// $Module name: cSQLConnectionHandler.pkg
39514>>>>>// $Author     : Nils G. Svedmyr, RDC Tools International, <mailto:support@rdctools.com>
39514>>>>>// Web-site    : http://www.rdctools.com
39514>>>>>// Created     : 2015-08-11 @ 16:02 (Military date format: YY-MM-DD)
39514>>>>>//
39514>>>>>// Description : A handler class for using CLI connection ID's to login to a database server.
39514>>>>>//
39514>>>>>// $Rev History:
39514>>>>>//    2015-08-11  Module header created
39514>>>>>//    2016-09-26  Changed name of the objecthandle from ghoCreateConnectionID to ghoSQLConnectionHandler.
39514>>>>>//                Added a new structure for passing connection data back & forth.
39514>>>>>//                Added better error handling.
39514>>>>>//                Added a decompose message for the connection string.
39514>>>>>//    2017-01-09  Added support for Mertech drivers
39514>>>>>//                Big overhaul to comply better with "Managed Connections" (DF 19)
39514>>>>>//                These changes make the class compatible with DFConnId.ini (can read/write DAW connection ini-files)
39514>>>>>//    2017-02-12  Reworked the whole connection property interface.
39514>>>>>//                Now there is one struct property that is the at cencter of a connection.
39514>>>>>//****************************************************************************
39514>>>>>Use cli.pkg
39514>>>>>Use MSSqldrv.pkg
39514>>>>>Use db2_drv.pkg
39514>>>>>Use odbc_drv.pkg
39514>>>>>Use cSQLConnectionIniFile.pkg
Including file: cSQLConnectionIniFile.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cSQLConnectionIniFile.pkg)
39514>>>>>>>//****************************************************************************
39514>>>>>>>// $Module type: Class
39514>>>>>>>// $Module name: cSQLConnectionIniFile.pkg
39514>>>>>>>//
39514>>>>>>>// $Author     : Nils G. Svedmyr, RDC Tools International.
39514>>>>>>>// Copyright (c) 2012 RDC Tools International
39514>>>>>>>// E-mail      : support@rdctools.com
39514>>>>>>>// Web-site    : http://www.rdctools.com
39514>>>>>>>//
39514>>>>>>>// Created     : 2012-09-20 @ 18:04 (Military date format - Year-Month-Day)
39514>>>>>>>//
39514>>>>>>>// Note        : The file must be USEd after declaration of the ghoApplication object, as it uses
39514>>>>>>>//               properties of that object.
39514>>>>>>>//
39514>>>>>>>// The code is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
39514>>>>>>>// without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
39514>>>>>>>// This is free software; you can redistribute it and/or modify it under the terms of the
39514>>>>>>>// GNU Lesser General Public License - see the "GNU Lesser General Public License.txt"
39514>>>>>>>// in the help folder for more details.
39514>>>>>>>//
39514>>>>>>>Use cSQLConnectionIniFile.inc
39514>>>>>>>Use cDbUpdateDatabaseDriver.pkg
Including file: cDbUpdateDatabaseDriver.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cDbUpdateDatabaseDriver.pkg)
39514>>>>>>>>>Use cSQLConnectionIniFile.inc
39514>>>>>>>>>
39514>>>>>>>>>Class cDbUpdateGenericDatabaseDriver is a cObject
39515>>>>>>>>>    Procedure Construct_Object
39517>>>>>>>>>        Forward Send Construct_Object
39519>>>>>>>>>        Property String psDriverID DATAFLEX_ID
39520>>>>>>>>>    End_Procedure
39521>>>>>>>>>
39521>>>>>>>>>    Function ServerKeyword Returns String
39523>>>>>>>>>        Function_Return CS_SQLIniDSNKeyword
39524>>>>>>>>>    End_Function
39525>>>>>>>>>
39525>>>>>>>>>    Function ConstructConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns String
39527>>>>>>>>>        String sConnect
39527>>>>>>>>>
39527>>>>>>>>>        Move (sConnect * ServerKeyword(Self) + "=" + sServer) to sConnect
39528>>>>>>>>>        If (sDatabase <> "") Begin
39530>>>>>>>>>            Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
39531>>>>>>>>>        End
39531>>>>>>>>>>
39531>>>>>>>>>        If (bTrusted = True) Begin
39533>>>>>>>>>            Move (sConnect * ";" + CS_SQLIniTrustedKeyword + "=Yes") to sConnect
39534>>>>>>>>>        End
39534>>>>>>>>>>
39534>>>>>>>>>        Else Begin
39535>>>>>>>>>            Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
39536>>>>>>>>>        End
39536>>>>>>>>>>
39536>>>>>>>>>        Function_Return sConnect
39537>>>>>>>>>    End_Function
39538>>>>>>>>>
39538>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39540>>>>>>>>>        Boolean bLoginSuccessful
39540>>>>>>>>>        String sDriverID
39540>>>>>>>>>
39540>>>>>>>>>        Get psDriverID to sDriverID
39541>>>>>>>>>        If (sDriverID = DATAFLEX_ID or sDriverID = "") Begin
39543>>>>>>>>>            Function_Return True
39544>>>>>>>>>        End
39544>>>>>>>>>>
39544>>>>>>>>>        Move 0 to LastErr  // Do NOT use the Err flag, it will be set true by the login command although it is successful.
39545>>>>>>>>>        If (bTrusted = False) Begin
39547>>>>>>>>>            Login sServer sUserId sPassword sDriverID
39549>>>>>>>>>        End
39549>>>>>>>>>>
39549>>>>>>>>>        Else Begin
39550>>>>>>>>>            Login sConnectionString "" "" sDriverID
39552>>>>>>>>>        End
39552>>>>>>>>>>
39552>>>>>>>>>        Move (LastErr = 0) to bLoginSuccessful
39553>>>>>>>>>        Function_Return bLoginSuccessful
39554>>>>>>>>>    End_Function
39555>>>>>>>>>End_Class
39556>>>>>>>>>
39556>>>>>>>>>Class cDbUpdateMSSQLDriver is a cDbUpdateGenericDatabaseDriver
39557>>>>>>>>>    Function ServerKeyword Returns String
39559>>>>>>>>>        Function_Return CS_SQLIniServerKeyword
39560>>>>>>>>>    End_Function
39561>>>>>>>>>End_Class
39562>>>>>>>>>
39562>>>>>>>>>Class cDbUpdateODBCDriver is a cDbUpdateGenericDatabaseDriver
39563>>>>>>>>>End_Class
39564>>>>>>>>>
39564>>>>>>>>>Class cDbUpdateDB2Driver is a cDbUpdateGenericDatabaseDriver
39565>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39567>>>>>>>>>        Boolean bLoginSuccessful
39567>>>>>>>>>        String sDriverID
39567>>>>>>>>>
39567>>>>>>>>>        Move False to Err
39568>>>>>>>>>        Get psDriverID to sDriverID
39569>>>>>>>>>        If (not(Uppercase(sServer) contains "DSN")) Begin
39571>>>>>>>>>            Move ("DSN=" + sServer) to sServer
39572>>>>>>>>>        End
39572>>>>>>>>>>
39572>>>>>>>>>        Login sServer sUserId sPassword sDriverID
39574>>>>>>>>>
39574>>>>>>>>>        Move (not(Err)) to bLoginSuccessful
39575>>>>>>>>>        Function_Return bLoginSuccessful
39576>>>>>>>>>    End_Function
39577>>>>>>>>>End_Class
39578>>>>>>>>>
39578>>>>>>>>>Class cDbUpdateDataFlexDriver is a cDbUpdateGenericDatabaseDriver
39579>>>>>>>>>    Function ConstructConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns String
39581>>>>>>>>>        Function_Return ""
39582>>>>>>>>>    End_Function
39583>>>>>>>>>End_Class
39584>>>>>>>>>
39584>>>>>>>>>Class cDbUpdateSQLFLEXDriver is a cDbUpdateGenericDatabaseDriver
39585>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39587>>>>>>>>>        Boolean bLoginSuccessful
39587>>>>>>>>>        String sDriverID
39587>>>>>>>>>
39587>>>>>>>>>        Get psDriverID to sDriverID
39588>>>>>>>>>        //For the Mertech driver, using the Err indicator is the sanctioned way
39588>>>>>>>>>        Move False to Err
39589>>>>>>>>>        If (bTrusted = False) Begin
39591>>>>>>>>>            Login sServer sUserId sPassword sDriverID
39593>>>>>>>>>        End
39593>>>>>>>>>>
39593>>>>>>>>>        Else Begin
39594>>>>>>>>>            Login sServer "" "" sDriverID
39596>>>>>>>>>        End
39596>>>>>>>>>>
39596>>>>>>>>>        Move (not(Err)) to bLoginSuccessful
39597>>>>>>>>>
39597>>>>>>>>>        Function_Return bLoginSuccessful
39598>>>>>>>>>    End_Function
39599>>>>>>>>>End_Class
39600>>>>>>>>>
39600>>>>>>>>>Class cDbUpdateORAFLEXDriver is a cDbUpdateGenericDatabaseDriver
39601>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39603>>>>>>>>>        Boolean bLoginSuccessful
39603>>>>>>>>>        String sDriverID
39603>>>>>>>>>        Integer iPos
39603>>>>>>>>>
39603>>>>>>>>>        Get psDriverID to sDriverID
39604>>>>>>>>>        Move (Pos("/", sServer)) to iPos
39605>>>>>>>>>        If (iPos = 0) Begin
39607>>>>>>>>>            If (sDatabase <> "") Begin
39609>>>>>>>>>                Move (sServer + "/" + sDatabase) to sServer
39610>>>>>>>>>            End
39610>>>>>>>>>>
39610>>>>>>>>>        End
39610>>>>>>>>>>
39610>>>>>>>>>        // For the Mertech driver, using the Err indicator is the sanctioned way
39610>>>>>>>>>        Move False to Err
39611>>>>>>>>>        // For Oracle I don't believe "Trusted" doesn't exist.
39611>>>>>>>>>        Login sServer sUserId sPassword sDriverID
39613>>>>>>>>>
39613>>>>>>>>>        Move (not(Err)) to bLoginSuccessful
39614>>>>>>>>>        Function_Return bLoginSuccessful
39615>>>>>>>>>    End_Function
39616>>>>>>>>>End_Class
39617>>>>>>>>>
39617>>>>>>>>>Class cDbUpdateMDSMySQLDriver is a cDbUpdateGenericDatabaseDriver
39618>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39620>>>>>>>>>        Boolean bLoginSuccessful
39620>>>>>>>>>        String sDriverID
39620>>>>>>>>>
39620>>>>>>>>>        Get psDriverID to sDriverID
39621>>>>>>>>>        // For the Mertech driver, using the Err indicator is the sanctioned way
39621>>>>>>>>>        Move False to Err
39622>>>>>>>>>        If (bTrusted = False) Begin
39624>>>>>>>>>            Login sServer sUserId sPassword sDriverID
39626>>>>>>>>>        End
39626>>>>>>>>>>
39626>>>>>>>>>        Else Begin
39627>>>>>>>>>            Login sServer "" "" sDriverID
39629>>>>>>>>>        End
39629>>>>>>>>>>
39629>>>>>>>>>        Move (not(Err)) to bLoginSuccessful
39630>>>>>>>>>        Function_Return bLoginSuccessful
39631>>>>>>>>>    End_Function
39632>>>>>>>>>End_Class
39633>>>>>>>>>
39633>>>>>>>>>Class cDbUpdateMDSPgSQLDriver is a cDbUpdateGenericDatabaseDriver
39634>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39636>>>>>>>>>        Boolean bLoginSuccessful
39636>>>>>>>>>        String sDriverID
39636>>>>>>>>>
39636>>>>>>>>>        Get psDriverID to sDriverID
39637>>>>>>>>>        // For the Mertech driver, using the Err indicator is the sanctioned way
39637>>>>>>>>>        Move False to Err
39638>>>>>>>>>        If (bTrusted = False) Begin
39640>>>>>>>>>            Login sServer sUserId sPassword sDriverID
39642>>>>>>>>>        End
39642>>>>>>>>>>
39642>>>>>>>>>        Else Begin
39643>>>>>>>>>            Login sServer "" "" sDriverID
39645>>>>>>>>>        End
39645>>>>>>>>>>
39645>>>>>>>>>        Move (not(Err)) to bLoginSuccessful
39646>>>>>>>>>        Function_Return bLoginSuccessful
39647>>>>>>>>>    End_Function
39648>>>>>>>>>End_Class
39649>>>>>>>>>
39649>>>>>>>>>Class cDbUpdateDatabaseDriver is a cObject
39650>>>>>>>>>    Procedure Construct_Object
39652>>>>>>>>>        Forward Send Construct_Object
39654>>>>>>>>>        Property String psDriverID DATAFLEX_ID
39655>>>>>>>>>        Property Handle phoDriverSpecificObject
39656>>>>>>>>>    End_Procedure
39657>>>>>>>>>
39657>>>>>>>>>    Function CreateDriver Returns Handle
39659>>>>>>>>>        String sDriverID
39659>>>>>>>>>        Handle hoDriver hcDriverClass
39659>>>>>>>>>
39659>>>>>>>>>        Get psDriverID to sDriverID
39660>>>>>>>>>        Case Begin
39660>>>>>>>>>            Case (sDriverID = MSSQLDRV_ID)
39662>>>>>>>>>                Move (RefClass(cDbUpdateMSSQLDriver))    to hcDriverClass
39663>>>>>>>>>                Case Break
39664>>>>>>>>>            Case (sDriverID = ODBC_DRV_ID)
39667>>>>>>>>>                Move (RefClass(cDbUpdateODBCDriver))     to hcDriverClass
39668>>>>>>>>>                Case Break
39669>>>>>>>>>            Case (sDriverID = DB2_DRV_ID)
39672>>>>>>>>>                Move (RefClass(cDbUpdateDB2Driver))      to hcDriverClass
39673>>>>>>>>>                Case Break
39674>>>>>>>>>            Case (sDriverID = SQLFLEX)
39677>>>>>>>>>                Move (RefClass(cDbUpdateSQLFLEXDriver))  to hcDriverClass
39678>>>>>>>>>                Case Break
39679>>>>>>>>>            Case (sDriverID = ORAFLEX)
39682>>>>>>>>>                Move (RefClass(cDbUpdateORAFLEXDriver))  to hcDriverClass
39683>>>>>>>>>                Case Break
39684>>>>>>>>>            Case (sDriverID = MDSPgSQL)
39687>>>>>>>>>                Move (RefClass(cDbUpdateMDSPgSQLDriver)) to hcDriverClass
39688>>>>>>>>>                Case Break
39689>>>>>>>>>            Case (sDriverID = MDSMySQL)
39692>>>>>>>>>                Move (RefClass(cDbUpdateMDSMySQLDriver)) to hcDriverClass
39693>>>>>>>>>                Case Break
39694>>>>>>>>>            // DATAFLEX_ID = Default driver
39694>>>>>>>>>            Case Else
39694>>>>>>>>>                Move (RefClass(cDbUpdateDataFlexDriver)) to hcDriverClass
39695>>>>>>>>>                Move DATAFLEX_ID to sDriverID
39696>>>>>>>>>        Case End
39696>>>>>>>>>
39696>>>>>>>>>        Get Create hcDriverClass to hoDriver
39697>>>>>>>>>        Set psDriverID of hoDriver to sDriverID
39698>>>>>>>>>        Set phoDriverSpecificObject to hoDriver
39699>>>>>>>>>
39699>>>>>>>>>        Function_Return hoDriver
39700>>>>>>>>>    End_Procedure
39701>>>>>>>>>
39701>>>>>>>>>    Procedure DestroyDriver
39703>>>>>>>>>        If (phoDriverSpecificObject(Self)) Begin
39705>>>>>>>>>            Send Destroy of (phoDriverSpecificObject(Self))
39706>>>>>>>>>        End
39706>>>>>>>>>>
39706>>>>>>>>>    End_Procedure
39707>>>>>>>>>
39707>>>>>>>>>    Function ConstructConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns String
39709>>>>>>>>>        String sConnect
39709>>>>>>>>>        Handle hoDriver
39709>>>>>>>>>
39709>>>>>>>>>        Get CreateDriver to hoDriver
39710>>>>>>>>>        Get ConstructConnectionString of hoDriver sServer sDatabase bTrusted sUserID sPassword to sConnect
39711>>>>>>>>>        Send DestroyDriver
39712>>>>>>>>>        Function_Return sConnect
39713>>>>>>>>>    End_Function
39714>>>>>>>>>
39714>>>>>>>>>    Function DbLogin String sConnectionString String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns Boolean
39716>>>>>>>>>        Boolean bLoginSuccessful
39716>>>>>>>>>        Handle hoDriver
39716>>>>>>>>>
39716>>>>>>>>>        Get CreateDriver to hoDriver
39717>>>>>>>>>        Get DbLogin of hoDriver sConnectionString sServer sDatabase bTrusted sUserID sPassword to bLoginSuccessful
39718>>>>>>>>>        Send DestroyDriver
39719>>>>>>>>>        Function_Return bLoginSuccessful
39720>>>>>>>>>    End_Function
39721>>>>>>>>>
39721>>>>>>>>>End_Class
39722>>>>>>>
39722>>>>>>>Class cSQLConnectionIniFile is a cIniFile
39723>>>>>>>    Procedure Construct_Object
39725>>>>>>>        Forward Send Construct_Object
39727>>>>>>>
39727>>>>>>>        Property String Private_psIniFilePath
39728>>>>>>>        Property String Private_psIniFileName CS_SQLIniFileName
39729>>>>>>>        Property String psIniSectionName (CS_SQLIniSectionName + "1")
39730>>>>>>>
39730>>>>>>>//        { Visibility=Private }
39730>>>>>>>        Property Boolean pbDFConnId False
39731>>>>>>>
39731>>>>>>>        // We use Base64 coding instead of the cCryptographer class because the
39731>>>>>>>        // password will get scrambled while writing/reading to/from the ini-file.
39731>>>>>>>//        { Visibility=Public }
39731>>>>>>>//        // *** You really want to change this value! ***
39731>>>>>>>//        Property String psHashString "zx!2139(LI0+?ips7433"
39731>>>>>>>
39731>>>>>>>    End_Procedure
39732>>>>>>>
39732>>>>>>>    Procedure End_Construct_Object
39734>>>>>>>        Forward Send End_Construct_Object
39736>>>>>>>    End_Procedure
39737>>>>>>>
39737>>>>>>>    Procedure Set psIniFilePath String sPath
39739>>>>>>>        String sIniFile
39739>>>>>>>        Get vFolderFormat sPath to sPath
39740>>>>>>>        Set private_psIniFilePath to sPath
39741>>>>>>>        Get psIniFileName to sIniFile
39742>>>>>>>        Set psFileName to (sPath + sIniFile)
39743>>>>>>>    End_Procedure
39744>>>>>>>
39744>>>>>>>    Function psIniFilePath Returns String
39746>>>>>>>        Function_Return (private_psIniFilePath(Self))
39747>>>>>>>    End_Function
39748>>>>>>>
39748>>>>>>>    Procedure Set psIniFileName String sFileName
39750>>>>>>>        String sPath
39750>>>>>>>        Get psIniFilePath to sPath
39751>>>>>>>        Set psFileName to (sPath + sFileName)
39752>>>>>>>        Set private_psIniFileName to sFileName
39753>>>>>>>    End_Procedure
39754>>>>>>>
39754>>>>>>>    Function psIniFileName Returns String
39756>>>>>>>        Function_Return (private_psIniFileName(Self))
39757>>>>>>>    End_Function
39758>>>>>>>
39758>>>>>>>    // *** Generalized messages to Get & Set values of the ini file.
39758>>>>>>>    // Sets a value in the program's ini file (write)
39758>>>>>>>    // Pass a section name, the value name parameter and the value itself to be written.
39758>>>>>>>    Procedure Set IniFileValue String sSection String sValueName String sValue
39760>>>>>>>        String sIniFile sPath
39760>>>>>>>
39760>>>>>>>        Get psIniFilePath to sPath
39761>>>>>>>        Get psIniFileName to sIniFile
39762>>>>>>>        Move (sPath + sIniFile) to sIniFile
39763>>>>>>>        Set psFileName to sIniFile
39764>>>>>>>        Send WriteString sSection sValueName sValue
39765>>>>>>>    End_Procedure
39766>>>>>>>
39766>>>>>>>    // Get a value from program's ini-file (read)
39766>>>>>>>    // Pass a section name and the name of the value parameter & a default value.
39766>>>>>>>    // Returns the value
39766>>>>>>>    Function IniFileValue String sSection String sValueName String sDefaultValue Returns String
39768>>>>>>>        String sValue sIniFile sPath
39768>>>>>>>
39768>>>>>>>        Get psIniFilePath to sPath
39769>>>>>>>        Get psIniFileName to sIniFile
39770>>>>>>>        Move (sPath + sIniFile) to sIniFile
39771>>>>>>>        Set psFileName to sIniFile
39772>>>>>>>        Get ReadString sSection sValueName sDefaultValue to sValue
39773>>>>>>>
39773>>>>>>>        Function_Return sValue
39774>>>>>>>    End_Function
39775>>>>>>>
39775>>>>>>>    // Sort function that first sorts on bEnabled & then on the connection string.
39775>>>>>>>    Function SortActiveFirst tSQLConnection SQLConnectionRow1 tSQLConnection SQLConnectionRow2 Returns Integer
39777>>>>>>>        If (SQLConnectionRow1.bEnabled > SQLConnectionRow2.bEnabled) ;            Function_Return (LT)
39780>>>>>>>        If (SQLConnectionRow1.bEnabled < SQLConnectionRow2.bEnabled) ;            Function_Return (GT)
39783>>>>>>>
39783>>>>>>>        If (SQLConnectionRow1.sConnectionID < SQLConnectionRow2.sConnectionID) ;            Function_Return (LT)
39786>>>>>>>        If (SQLConnectionRow1.sConnectionID > SQLConnectionRow2.sConnectionID) ;            Function_Return (GT)
39789>>>>>>>
39789>>>>>>>        If (SQLConnectionRow1.iDbType < SQLConnectionRow2.iDbType) ;            Function_Return (LT)
39792>>>>>>>        If (SQLConnectionRow1.iDbType > SQLConnectionRow2.iDbType) ;            Function_Return (GT)
39795>>>>>>>
39795>>>>>>>        If (SQLConnectionRow1.sServer < SQLConnectionRow2.sServer) ;            Function_Return (LT)
39798>>>>>>>        If (SQLConnectionRow1.sServer > SQLConnectionRow2.sServer) ;            Function_Return (GT)
39801>>>>>>>
39801>>>>>>>        If (SQLConnectionRow1.sDatabase < SQLConnectionRow2.sDatabase) ;            Function_Return (LT)
39804>>>>>>>        If (SQLConnectionRow1.sDatabase > SQLConnectionRow2.sDatabase) ;            Function_Return (GT)
39807>>>>>>>
39807>>>>>>>        If (SQLConnectionRow1.sDriverID < SQLConnectionRow2.sDriverID) ;            Function_Return (LT)
39810>>>>>>>        If (SQLConnectionRow1.sDriverID > SQLConnectionRow2.sDriverID) ;            Function_Return (GT)
39813>>>>>>>
39813>>>>>>>        If (SQLConnectionRow1.sConnectionString < SQLConnectionRow2.sConnectionString) ;            Function_Return (LT)
39816>>>>>>>        If (SQLConnectionRow1.sConnectionString > SQLConnectionRow2.sConnectionString) ;            Function_Return (GT)
39819>>>>>>>
39819>>>>>>>        Function_Return (EQ)
39820>>>>>>>    End_Function
39821>>>>>>>
39821>>>>>>>    Function SQLIniFileNumberOfConnections Returns Integer
39823>>>>>>>        Handle hoSections
39823>>>>>>>        Integer iItems
39823>>>>>>>
39823>>>>>>>        Send ReadSections hoSections
39824>>>>>>>        Move (Item_Count(hoSections)) to iItems
39825>>>>>>>        Function_Return iItems
39826>>>>>>>    End_Function
39827>>>>>>>
39827>>>>>>>    // The normal connection string looks something like this;
39827>>>>>>>    // "SERVER=.\SQLEXPRESS; DATABASE=OrderEntry; TRUSTED_CONNECTION=Yes; ,0"
39827>>>>>>>    // ...but the full connection string looks like this;
39827>>>>>>>    // "DFConnectionId OrderEntry, SERVER=.\SQLEXPRESS; DATABASE=OrderEntry; TRUSTED_CONNECTION=Yes; ,0"
39827>>>>>>>//    Function SQLIniFileAddConnection String sFullConnectionString Returns Boolean
39827>>>>>>>//        String sSection
39827>>>>>>>//        Integer iCount
39827>>>>>>>//
39827>>>>>>>//        Move False to Err
39827>>>>>>>//        Get psIniSectionName to sSection
39827>>>>>>>//        Get SQLIniFileNumberOfConnections to iCount
39827>>>>>>>//        Increment iCount
39827>>>>>>>//        Set IniFileValue sSection (CS_SQLIniSectionName + String(iCount)) to sFullConnectionString
39827>>>>>>>//
39827>>>>>>>//        Function_Return (Err = False)
39827>>>>>>>//    End_Function
39827>>>>>>>
39827>>>>>>>    Function SQLIniFileDeleteAllConnections Returns Boolean
39829>>>>>>>        Integer iCount
39829>>>>>>>        Boolean bExists
39829>>>>>>>        String sSection
39829>>>>>>>
39829>>>>>>>        Move False to Err
39830>>>>>>>        Move 1 to iCount
39831>>>>>>>        Get psIniSectionName to sSection
39832>>>>>>>        Get SectionExists (CS_SQLIniSectionName + String(iCount)) to bExists
39833>>>>>>>        While (bExists = True)
39837>>>>>>>            Send DeleteSection (CS_SQLIniSectionName + String(iCount))
39838>>>>>>>            Increment iCount
39839>>>>>>>            Get SectionExists (CS_SQLIniSectionName + String(iCount)) to bExists
39840>>>>>>>        Loop
39841>>>>>>>>
39841>>>>>>>        Function_Return (Err = False)
39842>>>>>>>    End_Function
39843>>>>>>>
39843>>>>>>>    Function SQLIniFileDeleteConnection Integer iItem Returns Boolean
39845>>>>>>>        Integer iCount
39845>>>>>>>        String sSection
39845>>>>>>>        Boolean bExists
39845>>>>>>>
39845>>>>>>>        Move False to Err
39846>>>>>>>        Move 1 to iCount
39847>>>>>>>        Get psIniSectionName to sSection
39848>>>>>>>        Get KeyExists sSection CS_SQLIniConnectionIdKeyword to bExists
39849>>>>>>>        While (bExists = True)
39853>>>>>>>            If (iCount = iItem) Begin
39855>>>>>>>                Send DeleteSection sSection
39856>>>>>>>//                Set IniFileValue sSection (CS_SQLIniSectionName + String(iCount)) to ""
39856>>>>>>>                Move 9999 to iCount // Just some ridiculously high number to get out of the loop as we're done.
39857>>>>>>>            End
39857>>>>>>>>
39857>>>>>>>            Increment iCount
39858>>>>>>>            Get KeyExists sSection (CS_SQLIniSectionName + String(iCount)) to bExists
39859>>>>>>>        Loop
39860>>>>>>>>
39860>>>>>>>
39860>>>>>>>        Function_Return (Err = False)
39861>>>>>>>    End_Function
39862>>>>>>>
39862>>>>>>>    // Returns all connection details for the passed Connection ID as a tSQLConnection
39862>>>>>>>    // If it fails the returned struct member SQLConnection.bError = True.
39862>>>>>>>    Function SQLIniFileConnectionID String sConnectionID Returns tSQLConnection
39864>>>>>>>        tSQLConnection[] SQLConnectionsArray
39864>>>>>>>        tSQLConnection[] SQLConnectionsArray
39865>>>>>>>        tSQLConnection   SQLConnection
39865>>>>>>>        tSQLConnection   SQLConnection
39865>>>>>>>        Integer iIndex
39865>>>>>>>
39865>>>>>>>        Get SQLIniFileConnectionIDIndex sConnectionID to iIndex
39866>>>>>>>        If (iIndex = -1) Begin
39868>>>>>>>            Move True to SQLConnection.bError
39869>>>>>>>            Function_Return SQLConnection
39870>>>>>>>        End
39870>>>>>>>>
39870>>>>>>>
39870>>>>>>>        Get SQLIniFileReadConnections to SQLConnectionsArray
39871>>>>>>>        Move SQLConnectionsArray[iIndex -1] to SQLConnection
39872>>>>>>>
39872>>>>>>>        Function_Return SQLConnection
39873>>>>>>>    End_Function
39874>>>>>>>
39874>>>>>>>    // Returns -1 if the passed connection ID was not found, else the item number.
39874>>>>>>>    Function SQLIniFileConnectionIDIndex String sConnectionID Returns Integer
39876>>>>>>>        tSQLConnection[] SQLConnectionsArray
39876>>>>>>>        tSQLConnection[] SQLConnectionsArray
39877>>>>>>>        Integer iRetval iCount iSize
39877>>>>>>>        String sValue
39877>>>>>>>        Boolean bExists
39877>>>>>>>
39877>>>>>>>        Move -1 to iRetval
39878>>>>>>>
39878>>>>>>>        Get SQLIniFileReadConnections to SQLConnectionsArray
39879>>>>>>>        Move (SizeOfArray(SQLConnectionsArray)) to iSize
39880>>>>>>>        Decrement iSize
39881>>>>>>>        For iCount from 0 to iSize
39887>>>>>>>>
39887>>>>>>>            Move SQLConnectionsArray[iCount].sConnectionID to sValue
39888>>>>>>>            Move (Uppercase(sValue) = Uppercase(sConnectionID)) to bExists
39889>>>>>>>            If (bExists) Begin
39891>>>>>>>                Move (iCount + 1) to iRetval // The [ConnectionX] keys are one-based (starts at 1) but the loop starts at zero.
39892>>>>>>>                Move iSize to iCount         // We're done!
39893>>>>>>>            End
39893>>>>>>>>
39893>>>>>>>        Loop
39894>>>>>>>>
39894>>>>>>>
39894>>>>>>>        Function_Return iRetval
39895>>>>>>>    End_Function
39896>>>>>>>
39896>>>>>>>    // Checks if the passed sConnectionID exists more than once in the passed struct array.
39896>>>>>>>    // Used to check that ConnectionID's are unique.
39896>>>>>>>    Function IsConnectionIDDuplicate String sConnectionID Returns Boolean
39898>>>>>>>        Integer iCount iSize iItems
39898>>>>>>>        String sValue
39898>>>>>>>        Boolean bExists
39898>>>>>>>        tSQLConnection[] SQLConnectionsArray
39898>>>>>>>        tSQLConnection[] SQLConnectionsArray
39899>>>>>>>
39899>>>>>>>        Move 0 to iItems
39900>>>>>>>        Get SQLIniFileReadConnections to SQLConnectionsArray
39901>>>>>>>        Move (SizeOfArray(SQLConnectionsArray)) to iSize
39902>>>>>>>        Decrement iSize
39903>>>>>>>        For iCount from 0 to iSize
39909>>>>>>>>
39909>>>>>>>            Move SQLConnectionsArray[iCount].sConnectionID to sValue
39910>>>>>>>            Move (sValue = sConnectionID) to bExists
39911>>>>>>>            If (bExists) Begin
39913>>>>>>>                Increment iItems
39914>>>>>>>            End
39914>>>>>>>>
39914>>>>>>>        Loop
39915>>>>>>>>
39915>>>>>>>
39915>>>>>>>        Function_Return (iItems > 1)
39916>>>>>>>    End_Function
39917>>>>>>>
39917>>>>>>>    // To update the SQLConnections.ini file with a new default Connection ID.
39917>>>>>>>    Function SQLIniFileSetDefaultConnection String sConnectionID Returns Boolean
39919>>>>>>>        Boolean bOK
39919>>>>>>>        Integer iSize iCount
39919>>>>>>>        tSQLConnection[] SQLConnectionsArray
39919>>>>>>>        tSQLConnection[] SQLConnectionsArray
39920>>>>>>>        tSQLConnection SQLConnection
39920>>>>>>>        tSQLConnection SQLConnection
39920>>>>>>>        String sConnectionString
39920>>>>>>>
39920>>>>>>>        Move False to Err
39921>>>>>>>        Get psConnectionString to sConnectionString
39922>>>>>>>
39922>>>>>>>        Get SQLIniFileReadConnections to SQLConnectionsArray
39923>>>>>>>        Move (SizeOfArray(SQLConnectionsArray)) to iSize
39924>>>>>>>        Decrement iSize
39925>>>>>>>        // Set all current connection to inactive.
39925>>>>>>>        For iCount from 0 to iSize
39931>>>>>>>>
39931>>>>>>>            Move False to SQLConnectionsArray[iCount].bEnabled
39932>>>>>>>        Loop
39933>>>>>>>>
39933>>>>>>>
39933>>>>>>>        Get SQLIniFileConnectionID sConnectionID to SQLConnection
39934>>>>>>>        Move True              to SQLConnection.bEnabled
39935>>>>>>>        Move sConnectionString to SQLConnection.sConnectionString
39936>>>>>>>        Move (InsertInArray(SQLConnectionsArray, 0, SQLConnection)) to SQLConnectionsArray
39937>>>>>>>        Get SQLIniFileWriteConnections SQLConnectionsArray to bOK
39938>>>>>>>
39938>>>>>>>        Function_Return (bOK = True)
39939>>>>>>>    End_Function
39940>>>>>>>
39940>>>>>>>    // Used for updating an existing connection with new data.
39940>>>>>>>    // Returns True if successful.
39940>>>>>>>    Function SQLIniFileUpdateConnection tSQLConnection SQLConnection Returns Boolean
39942>>>>>>>        Boolean bOK
39942>>>>>>>        Integer iItem iSize iCount
39942>>>>>>>        tSQLConnection[] SQLConnectionsArray
39942>>>>>>>        tSQLConnection[] SQLConnectionsArray
39943>>>>>>>
39943>>>>>>>        Move False to Err
39944>>>>>>>        Move -1 to iItem
39945>>>>>>>        Get SQLIniFileReadConnections to SQLConnectionsArray
39946>>>>>>>        Move (SizeOfArray(SQLConnectionsArray)) to iSize
39947>>>>>>>        Decrement iSize
39948>>>>>>>        // Set all current connection to inactive.
39948>>>>>>>        For iCount from 0 to iSize
39954>>>>>>>>
39954>>>>>>>            Move False to SQLConnectionsArray[iCount].bEnabled
39955>>>>>>>            If (SQLConnectionsArray[iCount].sConnectionID = SQLConnection.sConnectionID) Begin
39957>>>>>>>                Move iCount to iItem
39958>>>>>>>            End
39958>>>>>>>>
39958>>>>>>>        Loop
39959>>>>>>>>
39959>>>>>>>
39959>>>>>>>        If (iItem <> -1) Begin
39961>>>>>>>            Move True to SQLConnection.bEnabled
39962>>>>>>>            Move SQLConnection to SQLConnectionsArray[iItem]
39963>>>>>>>            Get SQLIniFileWriteConnections SQLConnectionsArray to bOK
39964>>>>>>>        End
39964>>>>>>>>
39964>>>>>>>
39964>>>>>>>        Function_Return (bOK = True)
39965>>>>>>>    End_Function
39966>>>>>>>
39966>>>>>>>    Function SQLIniFileReadConnections Returns tSQLConnection[]
39968>>>>>>>        tSQLConnection[] SQLConnectionsArray
39968>>>>>>>        tSQLConnection[] SQLConnectionsArray
39969>>>>>>>        String sSection sValue
39969>>>>>>>        Integer iCount
39969>>>>>>>        Boolean bExists bEnabled
39969>>>>>>>
39969>>>>>>>        Get psIniSectionName to sSection
39970>>>>>>>        Get SectionExists sSection to bExists
39971>>>>>>>        If (bExists = False) Begin
39973>>>>>>>            Function_Return SQLConnectionsArray
39974>>>>>>>        End
39974>>>>>>>>
39974>>>>>>>        Get SectionExists CS_SQLIniConnectionSection to bExists
39975>>>>>>>        If (bExists = True) Begin
39977>>>>>>>            Error DFERR_PROGRAM "Sorry, the format for the SQLConnections.ini file has been changed and this file has the old format that is no longer valid and thus cannot be read. You need to re-enter your connection(s)."
39978>>>>>>>>
39978>>>>>>>        End
39978>>>>>>>>
39978>>>>>>>
39978>>>>>>>        Move 1 to iCount // The section name "[ConnectionXX]" starts with "1"
39979>>>>>>>        Get SectionExists (CS_SQLIniSectionName + String(iCount)) to bExists
39980>>>>>>>
39980>>>>>>>        While (bExists = True)
39984>>>>>>>            // We always put the enabled/active connection at the top
39984>>>>>>>            Move (iCount = 1) to bEnabled
39985>>>>>>>            Move bEnabled to SQLConnectionsArray[iCount].bEnabled
39986>>>>>>>
39986>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniConnectionIdKeyword ""        to SQLConnectionsArray[iCount].sConnectionID
39987>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniDriverKeyword       ""        to SQLConnectionsArray[iCount].sDriverID
39988>>>>>>>
39988>>>>>>>            // The iDbType might be missing from the ini-file. This is e.g. the case when a DAW Managed Connection "DFConnId.ini" file is read.
39988>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniDbTypeKeyword       "99"      to sValue
39989>>>>>>>            If (sValue = "99") Begin
39991>>>>>>>                Get SqlUtilDbTypeFromDriver SQLConnectionsArray[iCount].sDriverID to sValue
39992>>>>>>>            End
39992>>>>>>>>
39992>>>>>>>            Move sValue                                                                                     to SQLConnectionsArray[iCount].iDbType
39993>>>>>>>
39993>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniConnectionKeyWord   ""        to SQLConnectionsArray[iCount].sConnectionString
39994>>>>>>>            Get ParseKeyWord SQLConnectionsArray[iCount].sConnectionString (CS_SQLIniServerKeyword + "=")   to SQLConnectionsArray[iCount].sServer
39995>>>>>>>            If (SQLConnectionsArray[iCount].sServer = "") Begin
39997>>>>>>>                Get ParseKeyWord SQLConnectionsArray[iCount].sConnectionString (CS_SQLIniDSNKeyword +"=")   to SQLConnectionsArray[iCount].sServer
39998>>>>>>>            End
39998>>>>>>>>
39998>>>>>>>            Get ParseKeyWord SQLConnectionsArray[iCount].sConnectionString (CS_SQLIniDatabaseKeyword + "=") to SQLConnectionsArray[iCount].sDatabase
39999>>>>>>>
39999>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniTrustedKeyword      ""        to sValue
40000>>>>>>>            Move (If(Uppercase(sValue) = "YES", True, False))                                               to SQLConnectionsArray[iCount].bTrusted
40001>>>>>>>
40001>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniUIDKeyword          ""        to SQLConnectionsArray[iCount].sUserID
40002>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniDFPWDKeyword        ""        to sValue
40003>>>>>>>            If (pbDFConnId(Self) = False and sValue <> "") Begin
40005>>>>>>>                Get DecryptPassword sValue to sValue
40006>>>>>>>            End
40006>>>>>>>>
40006>>>>>>>            Move sValue                                                                                     to SQLConnectionsArray[iCount].sPassword
40007>>>>>>>
40007>>>>>>>            // Here we reconstruct the connection string to be complete with all params;
40007>>>>>>>            Get ConstructConnectionString SQLConnectionsArray[iCount].sDriverID SQLConnectionsArray[iCount].sServer SQLConnectionsArray[iCount].sDatabase ;                                          SQLConnectionsArray[iCount].bTrusted SQLConnectionsArray[iCount].sUserID SQLConnectionsArray[iCount].sPassword ;                                          to SQLConnectionsArray[iCount].sConnectionString
40008>>>>>>>
40008>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniSchemaKeyword          ""     to SQLConnectionsArray[iCount].sSchema
40009>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniBaseTableSpaceKeyword  ""     to SQLConnectionsArray[iCount].sBaseTableSpace
40010>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniLongTableSpaceKeyword  ""     to SQLConnectionsArray[iCount].sLongTableSpace
40011>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniIndexTableSpaceKeyword ""     to SQLConnectionsArray[iCount].sIndexTableSpace
40012>>>>>>>            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniSilentLoginKeyword     ""     to SQLConnectionsArray[iCount].bSilentLogin
40013>>>>>>>//            Get IniFileValue (CS_SQLIniSectionName + String(iCount)) CS_SQLIniDisabledKeyword        ""     to SQLConnectionsArray[iCount].bDisabled
40013>>>>>>>
40013>>>>>>>            Increment iCount
40014>>>>>>>            Get SectionExists (CS_SQLIniSectionName + String(iCount)) to bExists
40015>>>>>>>        Loop
40016>>>>>>>>
40016>>>>>>>
40016>>>>>>>        // Lastly, we remove the very first array item as it is empty (we started at 1 because that is the first [Connection#])
40016>>>>>>>        If (SizeOfArray(SQLConnectionsArray) > 0) Begin
40018>>>>>>>            Move (RemoveFromArray(SQLConnectionsArray, 0)) to SQLConnectionsArray
40019>>>>>>>        End
40019>>>>>>>>
40019>>>>>>>
40019>>>>>>>        Function_Return SQLConnectionsArray
40020>>>>>>>    End_Function
40021>>>>>>>
40021>>>>>>>    Function SQLIniFileWriteConnections tSQLConnection[] SQLConnectionsArray Returns Boolean
40023>>>>>>>        Integer iCount iSize
40023>>>>>>>        Boolean bOK
40023>>>>>>>        String sConnectionString sSection sValue
40023>>>>>>>
40023>>>>>>>        // First we need to _remove_ all current connections in the ini-file, we
40023>>>>>>>        // do that by setting their values to "".
40023>>>>>>>        Move 0 to iCount
40024>>>>>>>        Get SQLIniFileDeleteAllConnections to bOK
40025>>>>>>>        If (bOK = False) Begin
40027>>>>>>>            Function_Return False
40028>>>>>>>        End
40028>>>>>>>>
40028>>>>>>>
40028>>>>>>>        Move False to Err
40029>>>>>>>        Get psIniSectionName to sSection
40030>>>>>>>        // Sorting will make sure we have the active connection record as the first connection item in the ini-file.
40030>>>>>>>        Move (SortArray(SQLConnectionsArray, Self, (RefFunc(SortActiveFirst)))) to SQLConnectionsArray
40031>>>>>>>        Move (SizeOfArray(SQLConnectionsArray)) to iSize
40032>>>>>>>        Decrement iSize
40033>>>>>>>
40033>>>>>>>        For iCount from 0 to iSize
40039>>>>>>>>
40039>>>>>>>            // DF 19 compatible settings:
40039>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniConnectionIdKeyword   to SQLConnectionsArray[iCount].sConnectionID
40040>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniDriverKeyword         to SQLConnectionsArray[iCount].sDriverID
40041>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniUIDKeyword            to SQLConnectionsArray[iCount].sUserID
40042>>>>>>>
40042>>>>>>>            Move SQLConnectionsArray[iCount].sPassword to sValue
40043>>>>>>>            If (pbDFConnId(Self) = False and sValue <> "") Begin
40045>>>>>>>                Get EncryptPassword sValue to sValue
40046>>>>>>>            End
40046>>>>>>>>
40046>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniDFPWDKeyword          to sValue
40047>>>>>>>
40047>>>>>>>            If (SQLConnectionsArray[iCount].bTrusted = True) Begin
40049>>>>>>>                Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniTrustedKeyword    to CS_SQLIniConnectionYes
40050>>>>>>>            End
40050>>>>>>>>
40050>>>>>>>
40050>>>>>>>            Get ConstructShortConnectionString SQLConnectionsArray[iCount].sDriverID SQLConnectionsArray[iCount].sServer SQLConnectionsArray[iCount].sDatabase ;                                            to SQLConnectionsArray[iCount].sConnectionString
40051>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniConnectionKeyWord     to SQLConnectionsArray[iCount].sConnectionString
40052>>>>>>>
40052>>>>>>>            // The Database Update Framework extended settings:
40052>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniDbTypeKeyword          to SQLConnectionsArray[iCount].iDbType
40053>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniSchemaKeyword          to SQLConnectionsArray[iCount].sSchema
40054>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniBaseTableSpaceKeyword  to SQLConnectionsArray[iCount].sBaseTableSpace
40055>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniLongTableSpaceKeyword  to SQLConnectionsArray[iCount].sLongTableSpace
40056>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniIndexTableSpaceKeyword to SQLConnectionsArray[iCount].sIndexTableSpace
40057>>>>>>>            Set IniFileValue (CS_SQLIniSectionName + String(iCount + 1)) CS_SQLIniSilentLoginKeyword     to SQLConnectionsArray[iCount].bSilentLogin
40058>>>>>>>        Loop
40059>>>>>>>>
40059>>>>>>>
40059>>>>>>>        Function_Return (bOK and Err = False)
40060>>>>>>>    End_Function
40061>>>>>>>
40061>>>>>>>    // *** DbType conversion routines - Converts between string/integer and driver ID values ***
40061>>>>>>>    //
40061>>>>>>>    // SQL utility function that returns a database type (string) constant
40061>>>>>>>    // corresponding to the passed iDbType.
40061>>>>>>>    Function SqlUtilDbTypeToString Integer iDbType Returns String
40063>>>>>>>        String sRetval
40063>>>>>>>        If (iDbType = EN_dbTypeMSSQL) Begin
40065>>>>>>>            Move CS_dbTypeMSSQL to sRetval
40066>>>>>>>        End
40066>>>>>>>>
40066>>>>>>>        If (iDbType = EN_dbTypeMySQL) Begin
40068>>>>>>>            Move CS_dbTypeMySQL to sRetval
40069>>>>>>>        End
40069>>>>>>>>
40069>>>>>>>        If (iDbType = EN_dbTypeOracle) Begin
40071>>>>>>>            Move CS_dbTypeOracle to sRetval
40072>>>>>>>        End
40072>>>>>>>>
40072>>>>>>>        If (iDbType = EN_dbTypeDB2) Begin
40074>>>>>>>            Move CS_dbTypeDB2 to sRetval
40075>>>>>>>        End
40075>>>>>>>>
40075>>>>>>>        If (iDbType = EN_dbTypePostgre) Begin
40077>>>>>>>            Move CS_dbTypePostgre to sRetval
40078>>>>>>>        End
40078>>>>>>>>
40078>>>>>>>        Function_Return sRetval
40079>>>>>>>    End_Function
40080>>>>>>>
40080>>>>>>>    // SQL utility function that returns a database type constant (integer)
40080>>>>>>>    // corresponding to the passed sDbType string constant.
40080>>>>>>>    Function SqlUtilDbTypeToInteger String sDbType  Returns Integer
40082>>>>>>>        Integer iRetval
40082>>>>>>>        If (sDbType = CS_dbTypeMSSQL) Begin
40084>>>>>>>            Move EN_dbTypeMSSQL to iRetval
40085>>>>>>>        End
40085>>>>>>>>
40085>>>>>>>        If (sDbType = CS_dbTypeMySQL) Begin
40087>>>>>>>            Move EN_dbTypeMySQL to iRetval
40088>>>>>>>        End
40088>>>>>>>>
40088>>>>>>>        If (sDbType = CS_dbTypeOracle) Begin
40090>>>>>>>            Move EN_dbTypeOracle to iRetval
40091>>>>>>>        End
40091>>>>>>>>
40091>>>>>>>        If (sDbType = CS_dbTypeDB2) Begin
40093>>>>>>>            Move EN_dbTypeDB2 to iRetval
40094>>>>>>>        End
40094>>>>>>>>
40094>>>>>>>        If (sDbType = CS_dbTypePostgre) Begin
40096>>>>>>>            Move EN_dbTypePostgre to iRetval
40097>>>>>>>        End
40097>>>>>>>>
40097>>>>>>>        Function_Return iRetval
40098>>>>>>>    End_Function
40099>>>>>>>
40099>>>>>>>    // Pass an integer DbType and function returns the database type integer as a string value.
40099>>>>>>>    // Used e.g. when reading a connection ini-file to display the database type in
40099>>>>>>>    // the SQL Connection program's grid.
40099>>>>>>>    Function SqlUtilDbTypeIntegerToStringConstant Integer iDbType Returns String
40101>>>>>>>        String sRetval
40101>>>>>>>        If (iDbType = EN_dbTypeMSSQL) Begin
40103>>>>>>>            Move "EN_dbTypeMSSQL" to sRetval
40104>>>>>>>        End
40104>>>>>>>>
40104>>>>>>>        If (iDbType = EN_dbTypeMySQL) Begin
40106>>>>>>>            Move "EN_dbTypeMySQL" to sRetval
40107>>>>>>>        End
40107>>>>>>>>
40107>>>>>>>        If (iDbType = EN_dbTypeOracle) Begin
40109>>>>>>>            Move "EN_dbTypeOracle" to sRetval
40110>>>>>>>        End
40110>>>>>>>>
40110>>>>>>>        If (iDbType = EN_dbTypeDB2) Begin
40112>>>>>>>            Move "EN_dbTypeDB2" to sRetval
40113>>>>>>>        End
40113>>>>>>>>
40113>>>>>>>        If (iDbType = EN_dbTypePostgre) Begin
40115>>>>>>>            Move "EN_dbTypePostgre" to sRetval
40116>>>>>>>        End
40116>>>>>>>>
40116>>>>>>>        Function_Return sRetval
40117>>>>>>>    End_Function
40118>>>>>>>
40118>>>>>>>    // Pass a driver id and the function will return
40118>>>>>>>    // a dbType as an integer. Obviously for the ODBC_DRV this doesn't
40118>>>>>>>    // quite work and always returns "MS SQL Server"
40118>>>>>>>    Function SqlUtilDbTypeFromDriver String sDriverID Returns Integer
40120>>>>>>>        Integer iRetval
40120>>>>>>>        If (sDriverID = MSSQLDRV_ID) Begin
40122>>>>>>>            Move EN_dbTypeMSSQL to iRetval
40123>>>>>>>        End
40123>>>>>>>>
40123>>>>>>>        If (sDriverID = SQLFLEX) Begin
40125>>>>>>>            Move EN_dbTypeMSSQL to iRetval
40126>>>>>>>        End
40126>>>>>>>>
40126>>>>>>>        If (sDriverID = ODBC_DRV_ID) Begin
40128>>>>>>>            Move EN_dbTypeMSSQL to iRetval
40129>>>>>>>        End
40129>>>>>>>>
40129>>>>>>>        If (sDriverID = MDSMySQL) Begin
40131>>>>>>>            Move EN_dbTypeMySQL to iRetval
40132>>>>>>>        End
40132>>>>>>>>
40132>>>>>>>        If (sDriverID = ORAFLEX) Begin
40134>>>>>>>            Move EN_dbTypeOracle to iRetval
40135>>>>>>>        End
40135>>>>>>>>
40135>>>>>>>        If (sDriverID = DB2_DRV_ID) Begin
40137>>>>>>>            Move EN_dbTypeDB2 to iRetval
40138>>>>>>>        End
40138>>>>>>>>
40138>>>>>>>        If (sDriverID = MDSPgSQL) Begin
40140>>>>>>>            Move EN_dbTypePostgre to iRetval
40141>>>>>>>        End
40141>>>>>>>>
40141>>>>>>>        Function_Return iRetval
40142>>>>>>>    End_Function
40143>>>>>>>
Including file: ParseKeyWord.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\ParseKeyWord.pkg)
40143>>>>>>>>
40143>>>>>>>>Function ParseKeyWord String sConnect String sKeyWord Returns String
40145>>>>>>>>    Integer iStart iEnd
40145>>>>>>>>    String sRetval
40145>>>>>>>>
40145>>>>>>>>    Move (Trim(sConnect)) to sConnect
40146>>>>>>>>    Move (Pos(Uppercase(sKeyWord), Uppercase(sConnect)))  to iStart
40147>>>>>>>>    If (iStart = 0) Begin
40149>>>>>>>>        Function_Return ""
40150>>>>>>>>    End
40150>>>>>>>>>
40150>>>>>>>>    Move (Left(sConnect, (iStart -1 + Length(sKeyWord)))) to sRetval
40151>>>>>>>>    Move (Replace(sRetval, sConnect, "")) to sRetval
40152>>>>>>>>    If (sKeyWord = Uppercase(CS_SQLConnectionIDText)) Begin
40154>>>>>>>>        Move (Pos(",", sRetval))          to iEnd
40155>>>>>>>>    End
40155>>>>>>>>>
40155>>>>>>>>    Else Begin
40156>>>>>>>>        Move (Pos(";", sRetval))          to iEnd
40157>>>>>>>>    End
40157>>>>>>>>>
40157>>>>>>>>    If (iEnd = 0 and (sRetval contains ",")) Begin
40159>>>>>>>>        Move (Pos(",", sRetval))          to iEnd
40160>>>>>>>>        Decrement iEnd
40161>>>>>>>>    End
40161>>>>>>>>>
40161>>>>>>>>    If (iEnd <> 0) Begin
40163>>>>>>>>        Move (Left(sRetval, (iEnd -1)))   to sRetval
40164>>>>>>>>    End
40164>>>>>>>>>
40164>>>>>>>>    Move (Replace("=", sRetval, ""))      to sRetval
40165>>>>>>>>
40165>>>>>>>>    Function_Return (Trim(sRetval))
40166>>>>>>>>End_Function
40167>>>>>>>>
40167>>>>>>>>
40167>>>>>>>
40167>>>>>>>    Function ConstructConnectionString String sDriverID String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns String
40169>>>>>>>        String sConnect
40169>>>>>>>        Handle hoDriver
40169>>>>>>>
40169>>>>>>>        Get Create (RefClass(cDbUpdateDatabaseDriver)) to hoDriver
40170>>>>>>>        Set psDriverID of hoDriver to sDriverID
40171>>>>>>>        Get ConstructConnectionString of hoDriver sServer sDatabase bTrusted sUserID sPassword to sConnect
40172>>>>>>>        Send Destroy   of hoDriver
40173>>>>>>>
40173>>>>>>>//        Case Begin
40173>>>>>>>//            Case (sDriverID = MSSQLDRV_ID)
40173>>>>>>>//                Move (sConnect * CS_SQLIniServerKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                If (sDatabase <> "") Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                If (bTrusted = True) Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniTrustedKeyword + "=Yes") to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Else Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = ODBC_DRV_ID)
40173>>>>>>>//                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                If (sDatabase <> "") Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                If (bTrusted = True) Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniTrustedKeyword + "=Yes") to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Else Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = DB2_DRV_ID)
40173>>>>>>>//                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40173>>>>>>>////                If (sDatabase <> "") Begin
40173>>>>>>>////                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>////                End
40173>>>>>>>////                If (bTrusted = True) Begin
40173>>>>>>>////                    Move (sConnect * ";" + CS_SQLIniTrustedKeyword + "=Yes") to sConnect
40173>>>>>>>////                End
40173>>>>>>>////                Else Begin
40173>>>>>>>//                Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>////                End
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = SQLFLEX)
40173>>>>>>>//                Move (sConnect * CS_SQLIniServerKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                If (sDatabase <> "") Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                If (bTrusted = True) Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniTrustedKeyword + "=Yes") to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Else Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = ORAFLEX)
40173>>>>>>>//                If (sDatabase <> "" and (not(sServer contains "/"))) Begin
40173>>>>>>>//                    Move (sServer + "/" + sDatabase)                  to sServer
40173>>>>>>>//                End
40173>>>>>>>//                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = MDSPgSQL)
40173>>>>>>>//                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                If (sDatabase <> "") Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = MDSMySQL)
40173>>>>>>>//                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40173>>>>>>>//                If (sDatabase <> "") Begin
40173>>>>>>>//                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40173>>>>>>>//                End
40173>>>>>>>//                Move (sConnect * ";" + CS_SQLIniUIDKeyword + "=" + sUserID * ";" + CS_SQLIniPWDKeyword + "=" + sPassword) to sConnect
40173>>>>>>>//                Case Break
40173>>>>>>>//
40173>>>>>>>//            Case (sDriverID = DATAFLEX_ID)    // Dummy stub.
40173>>>>>>>//                Break
40173>>>>>>>//
40173>>>>>>>//            Case Else
40173>>>>>>>//                Move "" to sConnect
40173>>>>>>>//        Case End
40173>>>>>>>
40173>>>>>>>        Function_Return sConnect
40174>>>>>>>    End_Function
40175>>>>>>>
40175>>>>>>>    // Short connection string used when writing to ini-file. This is to be compatible with DF19 DFConnId.ini files that uses this short format.
40175>>>>>>>    Function ConstructShortConnectionString String sDriverID String sServer String sDatabase Returns String
40177>>>>>>>        String sConnect
40177>>>>>>>
40177>>>>>>>        Case Begin
40177>>>>>>>            Case (sDriverID = MSSQLDRV_ID or sDriverID = SQLFLEX)
40179>>>>>>>                Move (sConnect * CS_SQLIniServerKeyword + "=" + sServer) to sConnect
40180>>>>>>>                If (sDatabase <> "") Begin
40182>>>>>>>                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40183>>>>>>>                End
40183>>>>>>>>
40183>>>>>>>                Case Break
40184>>>>>>>
40184>>>>>>>            Case (sDriverID = ODBC_DRV_ID)
40187>>>>>>>                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40188>>>>>>>                If (sDatabase <> "") Begin
40190>>>>>>>                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40191>>>>>>>                End
40191>>>>>>>>
40191>>>>>>>                Case Break
40192>>>>>>>
40192>>>>>>>            Case (sDriverID = DB2_DRV_ID)
40195>>>>>>>                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40196>>>>>>>                If (sDatabase <> "") Begin
40198>>>>>>>                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40199>>>>>>>                End
40199>>>>>>>>
40199>>>>>>>                Case Break
40200>>>>>>>
40200>>>>>>>            Case (sDriverID = ORAFLEX)
40203>>>>>>>                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40204>>>>>>>                If (sDatabase <> "") Begin
40206>>>>>>>                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40207>>>>>>>                End
40207>>>>>>>>
40207>>>>>>>                Case Break
40208>>>>>>>
40208>>>>>>>            Case (sDriverID = MDSPgSQL)
40211>>>>>>>                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40212>>>>>>>                If (sDatabase <> "") Begin
40214>>>>>>>                    Move (sConnect * ";" + CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40215>>>>>>>                End
40215>>>>>>>>
40215>>>>>>>                Case Break
40216>>>>>>>
40216>>>>>>>            Case (sDriverID = MDSMySQL)
40219>>>>>>>                Move (sConnect * CS_SQLIniDSNKeyword + "=" + sServer) to sConnect
40220>>>>>>>                If (sDatabase <> "") Begin
40222>>>>>>>                    Move (sConnect * ";" +CS_SQLIniDatabaseKeyword + "=" + sDatabase) to sConnect
40223>>>>>>>                End
40223>>>>>>>>
40223>>>>>>>                Case Break
40224>>>>>>>
40224>>>>>>>            Case (sDriverID = DATAFLEX_ID)    // Dummy stub.
40227>>>>>>>                Break
40228>>>>>>>
40228>>>>>>>            Case Else
40228>>>>>>>                Move "" to sConnect
40229>>>>>>>        Case End
40229>>>>>>>
40229>>>>>>>        Function_Return sConnect
40230>>>>>>>    End_Function
40231>>>>>>>
40231>>>>>>>    // Use Base64
40231>>>>>>>    Function EncryptPassword String sPassword Returns String
40233>>>>>>>        String sRetval
40233>>>>>>>//        Handle hoCryptographer
40233>>>>>>>//
40233>>>>>>>//        Get psHashString to sHashString
40233>>>>>>>//        Get Create (RefClass(cCryptographer)) to hoCryptographer
40233>>>>>>>//        Set psProvider of hoCryptographer to MS_ENHANCED_PROV
40233>>>>>>>//        Get Encrypt of hoCryptographer sHashString sPassword to sRetval
40233>>>>>>>//
40233>>>>>>>//        Send Destroy of hoCryptographer
40233>>>>>>>          Get EncodeString of oBase64Functions sPassword to sRetval
40234>>>>>>>        Function_Return sRetval
40235>>>>>>>    End_Function
40236>>>>>>>
40236>>>>>>>    Function DecryptPassword String sPassword Returns String
40238>>>>>>>        String sRetval
40238>>>>>>>//        Handle hoCryptographer
40238>>>>>>>//
40238>>>>>>>//        Get psHashString to sHashString
40238>>>>>>>//        Get Create (RefClass(cCryptographer)) to hoCryptographer
40238>>>>>>>//        Set psProvider of hoCryptographer to MS_ENHANCED_PROV
40238>>>>>>>//        Get Decrypt of hoCryptographer sHashString sPassword to sRetval
40238>>>>>>>//
40238>>>>>>>//        Send Destroy of hoCryptographer
40238>>>>>>>          Get DecodeString of oBase64Functions sPassword to sRetval
40239>>>>>>>
40239>>>>>>>        Function_Return sRetval
40240>>>>>>>    End_Function
40241>>>>>>>
40241>>>>>>>    // Returns the full path of the Application (no trailing "\")
40241>>>>>>>    Function ApplicationPath Returns String
40243>>>>>>>        String sApplicationFileName sPath
40243>>>>>>>        Integer iNumChars iRetval
40243>>>>>>>
40243>>>>>>>        Move (Repeat(Character(0), 1024))    to sApplicationFileName
40244>>>>>>>        Move (GetModuleFileName(0, AddressOf(sApplicationFileName), 1024)) to iNumChars
40245>>>>>>>        Move (CString(sApplicationFileName)) to sApplicationFileName
40246>>>>>>>        Move (PathRemoveFileSpec(AddressOf(sApplicationFileName))) to iRetval
40247>>>>>>>        Move (CString(sApplicationFileName)) to sPath
40248>>>>>>>
40248>>>>>>>        Function_Return sPath
40249>>>>>>>    End_Function
40250>>>>>>>
40250>>>>>>>End_Class
40251>>>>>Use cDbUpdateDatabaseDriver.pkg
40251>>>>>
40251>>>>>// The cConnection class is the new SQL connections class for DF 19.
40251>>>>>// If an object of the cConnection class hasn't been instantiated we use a "dummy" class in its place.
40251>>>>>    Use cConnectionDUF.pkg
Including file: cConnectionDUF.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cConnectionDUF.pkg)
40251>>>>>>>// * Dummy class * that will only be used if DF 18.2 or less.
40251>>>>>>>//
40251>>>>>>>// The cConnection class is new to DF 19 and that DF 19 package/class
40251>>>>>>>// will be used automatically instead of this package
40251>>>>>>>// if the current DF version is 19 and up _and_ the class
40251>>>>>>>// has been instantianted in the cApplication object.
40251>>>>>>>//
40251>>>>>>>// If an object of the original cConnection class is placed in
40251>>>>>>>// the cApplication, that connection logic will be used instead
40251>>>>>>>// of the Database Update Framework's SQLConnections logic. Or more
40251>>>>>>>// correctly; "Managed Connection" settings will be read and applied
40251>>>>>>>// instead of those defined in the framework's SQLConnections.ini file.
40251>>>>>>>//
40251>>>>>>>Struct tConnection
40251>>>>>>>    String sId                // connection id
40251>>>>>>>    String sString            // server-string as added via the ini file
40251>>>>>>>    String sUID               // User Id
40251>>>>>>>    String sPWD               // non-encrypted password
40251>>>>>>>    Boolean bTrustedConnection // Trusted connection
40251>>>>>>>    Integer iOptions          // connection ID options (don't use)
40251>>>>>>>    String sDriver            // name of driver
40251>>>>>>>    Integer iDriverIndex      // loaded driver index (is 1 based, 0 if none)
40251>>>>>>>    String sConnectionString  // Full connection string assembled from various strings
40251>>>>>>>    String sSection           // this is usually the section name as it appears
40251>>>>>>>                              // in the connections ini file (e.g., [Connection1])
40251>>>>>>>    Boolean bDisabled         // if set, this is not an active Id
40251>>>>>>>End_Struct
40251>>>>>>>
40251>>>>>>>
40251>>>>>>>Class cConnection is a cObject
40252>>>>>>>
40252>>>>>>>    Procedure Construct_Object
40254>>>>>>>        Forward Send Construct_Object
40256>>>>>>>
40256>>>>>>>    End_Procedure
40257>>>>>>>
40257>>>>>>>    Function ConnectionIdInfo Returns tConnection
40259>>>>>>>        tConnection Connection
40259>>>>>>>        tConnection Connection
40259>>>>>>>        Function_Return Connection
40260>>>>>>>    End_Function
40261>>>>>>>
40261>>>>>>>    Function IsConnectionIdLoggedIn Returns Boolean
40263>>>>>>>        Function_Return False
40264>>>>>>>    End_Function
40265>>>>>>>
40265>>>>>>>    Function LoginConnectionId Returns String
40267>>>>>>>        Function_Return ""
40268>>>>>>>    End_Function
40269>>>>>>>
40269>>>>>>>    // get array of managed connections across all drivers
40269>>>>>>>    // returns array of connections in tConnection.
40269>>>>>>>    Function ConnectionIDs Returns tConnection[]
40271>>>>>>>        tConnection[] Connections
40271>>>>>>>        tConnection[] Connections
40272>>>>>>>        Function_Return Connections
40273>>>>>>>    End_Function
40274>>>>>>>
40274>>>>>>>    Function ConnectionIdIndex String sConnectionID Returns Integer
40276>>>>>>>        Function_Return 0
40277>>>>>>>    End_Function
40278>>>>>>>
40278>>>>>>>    Function RedirectConnectionId String sConnectionID String sServer String sUserId String sPw Boolean bTrusted Boolean bKeepOpen Returns Boolean
40280>>>>>>>        Function_Return False
40281>>>>>>>    End_Function
40282>>>>>>>
40282>>>>>>>End_Class
40283>>>>>
40283>>>>>// We're making references to this object handle so we need it defined
40283>>>>>// here as well as for the cDbUpdateHandler class
40283>>>>>
40283>>>>>    Global_Variable Handle ghoSQLConnectionHandler
40283>>>>>
40283>>>>>Class cSQLConnectionHandler is a cObject
40284>>>>>
40284>>>>>    Procedure Construct_Object
40286>>>>>        Forward Send Construct_Object
40288>>>>>        Move Self to ghoSQLConnectionHandler
40289>>>>>
40289>>>>>        Property Handle phoSQLConnectionIniFile (Create(Self,RefClass(cSQLConnectionIniFile)))
40290>>>>>
40290>>>>>        // These properties are used by the cDbUpdateVersion and cDbUpdateFunctionLibrary classes,
40290>>>>>        // but put here so they can be set/get in both class objects. Those classes has "relay"
40290>>>>>        // methods to this class.
40290>>>>>        Property Boolean pbUseConnectionID True
40291>>>>>        Property Boolean pbToANSI          True
40292>>>>>        Property Boolean pbRecnum          True
40293>>>>>        Property Boolean pbCopyData        True
40294>>>>>        Property Boolean pbApiTableUpdateAuto    False
40295>>>>>        Property Boolean pbCompareDate_DateTime  False
40296>>>>>        Property Boolean pbCompareIndexAscending False
40297>>>>>        Property Boolean pbCompareIndexUppercase False
40298>>>>>
40298>>>>>        // Driver default value settings:
40298>>>>>        // Note: When the object is created the corresponding values
40298>>>>>        // from the driver .int files are read.
40298>>>>>        // Sample: Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_NUMERIC of {driverNumber} to {StringVariable}
40298>>>>>        Property String psDriverDefaultValueASCII    ""
40299>>>>>        Property String psDriverDefaultValueBinary   ""
40300>>>>>        Property String psDriverDefaultValueDate     ""
40301>>>>>        Property String psDriverDefaultValueDateTime ""
40302>>>>>        Property String psDriverDefaultValueNumeric  ""
40303>>>>>        Property String psDriverDefaultValueText     ""
40304>>>>>
40304>>>>>        // Driver "nullability" settings:
40304>>>>>        // Note: When the object is created the corresponding values
40304>>>>>        // from the driver .int files are read.
40304>>>>>        // Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_ASCII of {driverNumber} to {BooleanVariable}
40304>>>>>        Property Boolean pbDriverDefaultNullableASCII    False
40305>>>>>        Property Boolean pbDriverDefaultNullableBinary   False
40306>>>>>        Property Boolean pbDriverDefaultNullableDate     False
40307>>>>>        Property Boolean pbDriverDefaultNullableDateTime False
40308>>>>>        Property Boolean pbDriverDefaultNullableNumeric  False
40309>>>>>        Property Boolean pbDriverDefaultNullableText     False
40310>>>>>
40310>>>>>        // *** This is the central point of connection data for the Database Update Framework ***
40310>>>>>        //     It is private because the get/set version also updates the DAW/Mertech
40310>>>>>        //     driver interfaces.
40310>>>>>        //     There are also procedure/function pairs to set/get individual data members
40310>>>>>        //     of the struct they are all routed throu this struct property.
40310>>>>>        Property tSQLConnection Private.pSQLConnection
40311>>>>>
40311>>>>>    End_Procedure
40312>>>>>
40312>>>>>    Procedure End_Construct_Object
40314>>>>>        Boolean bReadSettings
40314>>>>>        tSQLConnection SQLConnection
40314>>>>>        tSQLConnection SQLConnection
40314>>>>>
40314>>>>>        Forward Send End_Construct_Object
40316>>>>>
40316>>>>>        // Now is the time to read and apply SQL connection settings.
40316>>>>>        Get SetupSQLConnection True True to SQLConnection
40317>>>>>        Set Private.pSQLConnection to SQLConnection
40318>>>>>    End_Procedure
40319>>>>>
40319>>>>>    // *** Properties ***
40319>>>>>    // All connection related "properties" (get/set pairs) are really done by changing the
40319>>>>>    // private.pSQLConnection struct connection property. These "properties" are
40319>>>>>    // merely here for conveniance.
40319>>>>>    //
40319>>>>>    // The pSQLConnection get/set are here so we have a "central hub"
40319>>>>>    // where we update data to/from the DAW & Mertech driver interfaces and this framework.
40319>>>>>    // This struct property contains all the connection data.
40319>>>>>    //
40319>>>>>    Procedure Set pSQLConnection tSQLConnection SQLConnection
40321>>>>>        Boolean bIsDaw bOK
40321>>>>>
40321>>>>>        Set Private.pSQLConnection to SQLConnection
40322>>>>>
40322>>>>>        // When starting a program we might not have a connection id yet:
40322>>>>>        If (SQLConnection.sConnectionID = "" or SQLConnection.sDriverID = DATAFLEX_ID) Begin
40324>>>>>            Procedure_Return
40325>>>>>        End
40325>>>>>>
40325>>>>>
40325>>>>>        // If a DAW DFConnId.ini file was read instead of the DUF SQLConnections.ini file we should by now
40325>>>>>        // be logged in already and don't want to do it again.
40325>>>>>        If (SQLConnection.bDAWConnection = False) Begin
40327>>>>>            // After we have set the class property we need to tell the DAW/Mertech
40327>>>>>            // driver interfaces about the change & make a new login.
40327>>>>>            Get SQLLogin SQLConnection to bOK
40328>>>>>            If (bOK = False) Begin
40330>>>>>                Error DFERR_PROGRAM "Login error."
40331>>>>>>
40331>>>>>            End
40331>>>>>>
40331>>>>>        End
40331>>>>>>
40331>>>>>
40331>>>>>        // Now is the time to setup our driver default values by reading the driver .int file:
40331>>>>>        Send SetupDriverDefaults SQLConnection.sDriverID
40332>>>>>
40332>>>>>    End_Procedure
40333>>>>>
40333>>>>>    // Similar to _SqlCheckCurrentDriver but generates no error and it doesn't
40333>>>>>    // attempt to load the driver.
40333>>>>>    // Returns true if the passed driver is SQL based.
40333>>>>>    Function IsSQLDriver String sDriverID Returns Boolean
40335>>>>>        Boolean bOK
40335>>>>>
40335>>>>>        Get IsDAWSQLDriver sDriverID to bOK
40336>>>>>        If (bOK = False) Begin
40338>>>>>            Get IsMertechDriver sDriverID to bOK
40339>>>>>        End
40339>>>>>>
40339>>>>>
40339>>>>>        Function_Return bOK
40340>>>>>    End_Function
40341>>>>>
40341>>>>>    // Reads the driver .int file and sets class properties of the cDbUpdateFunctionLibrary accordingly.
40341>>>>>    Procedure SetupDriverDefaults String sDriverID
40343>>>>>        String sAttributeValue
40343>>>>>        Integer iDriverID
40343>>>>>        Boolean bNULL bSQLDriver
40343>>>>>
40343>>>>>        Get IsSQLDriver sDriverID to bSQLDriver
40344>>>>>        If (bSQLDriver = False) Begin
40346>>>>>            Procedure_Return
40347>>>>>        End
40347>>>>>>
40347>>>>>
40347>>>>>        Get DriverIndex sDriverID to iDriverID
40348>>>>>
40348>>>>>        // Driver default values for various data types:
40348>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_ASCII of iDriverID      to sAttributeValue
40351>>>>>        Set psDriverDefaultValueASCII                                   to sAttributeValue
40352>>>>>
40352>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_BINARY of iDriverID     to sAttributeValue
40355>>>>>        Set psDriverDefaultValueBinary                                  to sAttributeValue
40356>>>>>
40356>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_DATE of iDriverID       to sAttributeValue
40359>>>>>        Set psDriverDefaultValueDate                                    to sAttributeValue
40360>>>>>
40360>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_DATETIME of iDriverID   to sAttributeValue
40363>>>>>        Set psDriverDefaultValueDateTime                                to sAttributeValue
40364>>>>>
40364>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_NUMERIC of iDriverID    to sAttributeValue
40367>>>>>        Set psDriverDefaultValueNumeric                                 to sAttributeValue
40368>>>>>
40368>>>>>        Get_Attribute DF_DRIVER_DEFAULT_DEFAULT_TEXT of iDriverID       to sAttributeValue
40371>>>>>        Set psDriverDefaultValueText                                    to sAttributeValue
40372>>>>>
40372>>>>>        // The default setting for the "nullability" of newly created ASCII columns.
40372>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_ASCII      of iDriverID to bNULL
40375>>>>>        Set pbDriverDefaultNullableASCII to bNULL
40376>>>>>
40376>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_BINARY     of iDriverID to bNULL
40379>>>>>        Set pbDriverDefaultNullableBinary to bNULL
40380>>>>>
40380>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_DATE       of iDriverID to bNULL
40383>>>>>        Set pbDriverDefaultNullableDate to bNULL
40384>>>>>
40384>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_DATETIME   of iDriverID to bNULL
40387>>>>>        Set pbDriverDefaultNullableDateTime to bNULL
40388>>>>>
40388>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_NUMERIC    of iDriverID to bNULL
40391>>>>>        Set pbDriverDefaultNullableNumeric to bNULL
40392>>>>>
40392>>>>>        Get_Attribute DF_DRIVER_DEFAULT_NULLABLE_TEXT       of iDriverID to bNULL
40395>>>>>        Set pbDriverDefaultNullableText to bNULL
40396>>>>>
40396>>>>>    End_Procedure
40397>>>>>
40397>>>>>    Function SQLLogin tSQLConnection SQLConnection Returns Boolean
40399>>>>>        Boolean bOK bIsDaw bIsMertech bTrusted
40399>>>>>        String sConnectionString sServer sDatabase sUserId sPassword sDriverID
40399>>>>>        Handle hoErrorObj hoDriver hoIniFile
40399>>>>>        Integer iDriverID
40399>>>>>
40399>>>>>        Move False to bOK
40400>>>>>
40400>>>>>        Get IsDAWSQLDriver SQLConnection.sDriverID to bIsDaw
40401>>>>>        If (bIsDaw = False) Begin
40403>>>>>            Get IsMertechDriver SQLConnection.sDriverID to bIsMertech
40404>>>>>            If (bIsMertech = False) Begin
40406>>>>>                Function_Return False
40407>>>>>            End
40407>>>>>>
40407>>>>>        End
40407>>>>>>
40407>>>>>
40407>>>>>        Move Error_Object_Id to hoErrorObj
40408>>>>>        Move Self to Error_Object_Id
40409>>>>>
40409>>>>>        Get phoSQLConnectionIniFile to hoIniFile
40410>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to sConnectionString
40411>>>>>        Get DriverIndex SQLConnection.sDriverID to iDriverID
40412>>>>>        If (iDriverID = 0) Begin
40414>>>>>            Move hoErrorObj to Error_Object_Id
40415>>>>>            Function_Return False
40416>>>>>        End
40416>>>>>>
40416>>>>>
40416>>>>>        // There's a bug in Mertech drivers creating "an Exception error" in the debugger (probably will crash an application too.)
40416>>>>>        If (bIsMertech = False) Begin
40418>>>>>            Set_Attribute DF_DRIVER_SILENT_LOGIN of iDriverID to SQLConnection.bSilentLogin
40421>>>>>        End
40421>>>>>>
40421>>>>>
40421>>>>>        Get Create (RefClass(cDbUpdateDatabaseDriver)) to hoDriver
40422>>>>>        Set psDriverID of hoDriver to SQLConnection.sDriverID
40423>>>>>        Get DbLogin    of hoDriver sConnectionString SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to bOK
40424>>>>>        Send Destroy   of hoDriver
40425>>>>>        Move hoErrorObj to Error_Object_Id
40426>>>>>
40426>>>>>        Function_Return bOK
40427>>>>>    End_Function
40428>>>>>
40428>>>>>    Function pSQLConnection Returns tSQLConnection
40430>>>>>        tSQLConnection SQLConnection
40430>>>>>        tSQLConnection SQLConnection
40430>>>>>        Get Private.pSQLConnection to SQLConnection
40431>>>>>        Function_Return SQLConnection
40432>>>>>    End_Function
40433>>>>>
40433>>>>>    Procedure Set psConnectionID String sValue
40435>>>>>        tSQLConnection SQLConnection
40435>>>>>        tSQLConnection SQLConnection
40435>>>>>
40435>>>>>        Get Private.pSQLConnection to SQLConnection
40436>>>>>        If (SQLConnection.sConnectionID = "") Begin
40438>>>>>            Move sValue to SQLConnection.sConnectionID
40439>>>>>        End
40439>>>>>>
40439>>>>>
40439>>>>>        // Else we might want to change the current connection ID
40439>>>>>        Else If (SQLConnection.sConnectionID <> "" and SQLConnection.sConnectionID <> sValue) Begin
40442>>>>>            Move False to Err
40443>>>>>            Logout SQLConnection.sDriverID
40444>>>>>            // This will also make a login to the new server.
40444>>>>>            Get SQLIniFileConnectionID of (phoSQLConnectionIniFile(Self)) sValue to SQLConnection
40445>>>>>        End
40445>>>>>>
40445>>>>>        Set pSQLConnection to SQLConnection
40446>>>>>    End_Procedure
40447>>>>>
40447>>>>>    Function psConnectionID Returns String
40449>>>>>        tSQLConnection SQLConnection
40449>>>>>        tSQLConnection SQLConnection
40449>>>>>        Get Private.pSQLConnection to SQLConnection
40450>>>>>        Function_Return SQLConnection.sConnectionID
40451>>>>>    End_Procedure
40452>>>>>
40452>>>>>    // Note: If the psDriverID + other connection properties are to be changed,
40452>>>>>    //       the psDriverID *must* be the first property that is changed!
40452>>>>>    //       Otherwise errors might be raised by the driver when e.g. the format
40452>>>>>    //       for a connection string has the wrong format for that driver.
40452>>>>>    Procedure Set psDriverID String sValue
40454>>>>>        tSQLConnection SQLConnection
40454>>>>>        tSQLConnection SQLConnection
40454>>>>>        Get pSQLConnection to SQLConnection
40455>>>>>        Move sValue        to SQLConnection.sDriverID
40456>>>>>        Set pSQLConnection to SQLConnection
40457>>>>>        If (sValue <> DATAFLEX_ID) Begin
40459>>>>>            Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40460>>>>>        End
40460>>>>>>
40460>>>>>    End_Procedure
40461>>>>>
40461>>>>>    Function psDriverID Returns String
40463>>>>>        tSQLConnection SQLConnection
40463>>>>>        tSQLConnection SQLConnection
40463>>>>>        Get Private.pSQLConnection to SQLConnection
40464>>>>>        If (SQLConnection.sDriverID = "") Begin
40466>>>>>            Move DATAFLEX_ID to SQLConnection.sDriverID // Default is the DataFlex driver.
40467>>>>>        End
40467>>>>>>
40467>>>>>        Function_Return SQLConnection.sDriverID
40468>>>>>    End_Function
40469>>>>>
40469>>>>>    Procedure Set psConnectionString String sValue
40471>>>>>        tSQLConnection SQLConnection
40471>>>>>        tSQLConnection SQLConnection
40471>>>>>        Get Private.pSQLConnection to SQLConnection
40472>>>>>        Move sValue        to SQLConnection.sConnectionString
40473>>>>>        Set pSQLConnection to SQLConnection
40474>>>>>    End_Procedure
40475>>>>>
40475>>>>>    Function psConnectionString Returns String
40477>>>>>        tSQLConnection SQLConnection
40477>>>>>        tSQLConnection SQLConnection
40477>>>>>        Get Private.pSQLConnection to SQLConnection
40478>>>>>        Function_Return SQLConnection.sConnectionString
40479>>>>>    End_Function
40480>>>>>
40480>>>>>    Procedure Set psServer String sValue
40482>>>>>        tSQLConnection SQLConnection
40482>>>>>        tSQLConnection SQLConnection
40482>>>>>        Get Private.pSQLConnection to SQLConnection
40483>>>>>        Move sValue        to SQLConnection.sServer
40484>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40485>>>>>        Set pSQLConnection to SQLConnection
40486>>>>>    End_Procedure
40487>>>>>
40487>>>>>    Function psServer Returns String
40489>>>>>        tSQLConnection SQLConnection
40489>>>>>        tSQLConnection SQLConnection
40489>>>>>        Get Private.pSQLConnection to SQLConnection
40490>>>>>        Function_Return SQLConnection.sServer
40491>>>>>    End_Function
40492>>>>>
40492>>>>>    Procedure Set psDatabase String sValue
40494>>>>>        tSQLConnection SQLConnection
40494>>>>>        tSQLConnection SQLConnection
40494>>>>>        Get Private.pSQLConnection to SQLConnection
40495>>>>>        Move sValue        to SQLConnection.sDatabase
40496>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40497>>>>>        Set pSQLConnection to SQLConnection
40498>>>>>    End_Procedure
40499>>>>>
40499>>>>>    Function psDatabase Returns String
40501>>>>>        tSQLConnection SQLConnection
40501>>>>>        tSQLConnection SQLConnection
40501>>>>>        Get Private.pSQLConnection to SQLConnection
40502>>>>>        Function_Return SQLConnection.sDatabase
40503>>>>>    End_Function
40504>>>>>
40504>>>>>    Procedure Set psUserID String sValue
40506>>>>>        tSQLConnection SQLConnection
40506>>>>>        tSQLConnection SQLConnection
40506>>>>>        Get Private.pSQLConnection to SQLConnection
40507>>>>>        Move sValue        to SQLConnection.sUserID
40508>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40509>>>>>        Set pSQLConnection to SQLConnection
40510>>>>>    End_Procedure
40511>>>>>
40511>>>>>    Function psUserID Returns String
40513>>>>>        tSQLConnection SQLConnection
40513>>>>>        tSQLConnection SQLConnection
40513>>>>>        Get Private.pSQLConnection to SQLConnection
40514>>>>>        Function_Return SQLConnection.sUserID
40515>>>>>    End_Function
40516>>>>>
40516>>>>>    // This is the uncrypted password
40516>>>>>    Procedure Set psPassword String sValue
40518>>>>>        tSQLConnection SQLConnection
40518>>>>>        tSQLConnection SQLConnection
40518>>>>>        Get Private.pSQLConnection to SQLConnection
40519>>>>>        Move sValue        to SQLConnection.sPassword
40520>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40521>>>>>        Set pSQLConnection to SQLConnection
40522>>>>>    End_Procedure
40523>>>>>
40523>>>>>    Function psPassword Returns String
40525>>>>>        tSQLConnection SQLConnection
40525>>>>>        tSQLConnection SQLConnection
40525>>>>>        Get Private.pSQLConnection to SQLConnection
40526>>>>>        Function_Return SQLConnection.sPassword
40527>>>>>    End_Function
40528>>>>>
40528>>>>>    Procedure Set pbTrusted Boolean bValue
40530>>>>>        tSQLConnection SQLConnection
40530>>>>>        tSQLConnection SQLConnection
40530>>>>>        Get Private.pSQLConnection to SQLConnection
40531>>>>>        Move bValue        to SQLConnection.bTrusted
40532>>>>>        Get ConstructConnectionString SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to SQLConnection.sConnectionString
40533>>>>>        Set pSQLConnection to SQLConnection
40534>>>>>    End_Procedure
40535>>>>>
40535>>>>>    Function pbTrusted Returns Boolean
40537>>>>>        tSQLConnection SQLConnection
40537>>>>>        tSQLConnection SQLConnection
40537>>>>>        Get Private.pSQLConnection to SQLConnection
40538>>>>>        Function_Return SQLConnection.bTrusted
40539>>>>>    End_Function
40540>>>>>
40540>>>>>    // *** All of these properties are special to the Database Update Framework ***
40540>>>>>    //     Thus they are not propagated to the DAW/Mertech classes and that is why
40540>>>>>    //     the Private.pSQLConnection property is set instead of the going throu
40540>>>>>    //     the central pSQLConnection "hub".
40540>>>>>    Procedure Set pbSilentLogin Boolean bValue
40542>>>>>        tSQLConnection SQLConnection
40542>>>>>        tSQLConnection SQLConnection
40542>>>>>        Get Private.pSQLConnection to SQLConnection
40543>>>>>        Move bValue to SQLConnection.bTrusted
40544>>>>>        Set Private.pSQLConnection to SQLConnection
40545>>>>>    End_Procedure
40546>>>>>
40546>>>>>    Function pbSilentLogin Returns Boolean
40548>>>>>        tSQLConnection SQLConnection
40548>>>>>        tSQLConnection SQLConnection
40548>>>>>        Get Private.pSQLConnection to SQLConnection
40549>>>>>        Function_Return SQLConnection.bSilentLogin
40550>>>>>    End_Function
40551>>>>>
40551>>>>>    Procedure Set piDbType Integer iValue
40553>>>>>        tSQLConnection SQLConnection
40553>>>>>        tSQLConnection SQLConnection
40553>>>>>        Get Private.pSQLConnection to SQLConnection
40554>>>>>        Move iValue to SQLConnection.iDbType
40555>>>>>        Set Private.pSQLConnection to SQLConnection
40556>>>>>    End_Procedure
40557>>>>>
40557>>>>>    Function piDbType Returns Integer
40559>>>>>        tSQLConnection SQLConnection
40559>>>>>        tSQLConnection SQLConnection
40559>>>>>        Get Private.pSQLConnection to SQLConnection
40560>>>>>        Function_Return SQLConnection.iDbType
40561>>>>>    End_Function
40562>>>>>
40562>>>>>    Procedure Set psBaseTableSpace String sValue
40564>>>>>        tSQLConnection SQLConnection
40564>>>>>        tSQLConnection SQLConnection
40564>>>>>        Get Private.pSQLConnection to SQLConnection
40565>>>>>        Move sValue to SQLConnection.sBaseTableSpace
40566>>>>>        Set Private.pSQLConnection to SQLConnection
40567>>>>>    End_Procedure
40568>>>>>
40568>>>>>    Function psBaseTableSpace Returns String
40570>>>>>        tSQLConnection SQLConnection
40570>>>>>        tSQLConnection SQLConnection
40570>>>>>        Get Private.pSQLConnection to SQLConnection
40571>>>>>        Function_Return SQLConnection.sBaseTableSpace
40572>>>>>    End_Function
40573>>>>>
40573>>>>>    Procedure Set psIndexTableSpace String sValue
40575>>>>>        tSQLConnection SQLConnection
40575>>>>>        tSQLConnection SQLConnection
40575>>>>>        Get Private.pSQLConnection to SQLConnection
40576>>>>>        Move sValue to SQLConnection.sIndexTableSpace
40577>>>>>        Set Private.pSQLConnection to SQLConnection
40578>>>>>    End_Procedure
40579>>>>>
40579>>>>>    Function psIndexTableSpace Returns String
40581>>>>>        tSQLConnection SQLConnection
40581>>>>>        tSQLConnection SQLConnection
40581>>>>>        Get Private.pSQLConnection to SQLConnection
40582>>>>>        Function_Return SQLConnection.sIndexTableSpace
40583>>>>>    End_Function
40584>>>>>
40584>>>>>    Procedure Set psLongTableSpace String sValue
40586>>>>>        tSQLConnection SQLConnection
40586>>>>>        tSQLConnection SQLConnection
40586>>>>>        Get Private.pSQLConnection to SQLConnection
40587>>>>>        Move sValue to SQLConnection.sLongTableSpace
40588>>>>>        Set Private.pSQLConnection to SQLConnection
40589>>>>>    End_Procedure
40590>>>>>
40590>>>>>    Function psLongTableSpace Returns String
40592>>>>>        tSQLConnection SQLConnection
40592>>>>>        tSQLConnection SQLConnection
40592>>>>>        Get Private.pSQLConnection to SQLConnection
40593>>>>>        Function_Return SQLConnection.sLongTableSpace
40594>>>>>    End_Function
40595>>>>>
40595>>>>>    Procedure Set psSchema String sValue
40597>>>>>        tSQLConnection SQLConnection
40597>>>>>        tSQLConnection SQLConnection
40597>>>>>        Get Private.pSQLConnection to SQLConnection
40598>>>>>        Move sValue to SQLConnection.sSchema
40599>>>>>        Set Private.pSQLConnection to SQLConnection
40600>>>>>    End_Procedure
40601>>>>>
40601>>>>>    Function psSchema Returns String
40603>>>>>        tSQLConnection SQLConnection
40603>>>>>        tSQLConnection SQLConnection
40603>>>>>        Get Private.pSQLConnection to SQLConnection
40604>>>>>        Function_Return SQLConnection.sSchema
40605>>>>>    End_Function
40606>>>>>
40606>>>>>    Procedure Set pbEnabled Boolean bValue
40608>>>>>        tSQLConnection SQLConnection
40608>>>>>        tSQLConnection SQLConnection
40608>>>>>        Get Private.pSQLConnection to SQLConnection
40609>>>>>        Move bValue to SQLConnection.bEnabled
40610>>>>>        Set Private.pSQLConnection to SQLConnection
40611>>>>>    End_Procedure
40612>>>>>
40612>>>>>    Function pbEnabled Returns Boolean
40614>>>>>        tSQLConnection SQLConnection
40614>>>>>        tSQLConnection SQLConnection
40614>>>>>        Get Private.pSQLConnection to SQLConnection
40615>>>>>        Function_Return SQLConnection.bEnabled
40616>>>>>    End_Function
40617>>>>>
40617>>>>>
40617>>>>>    // ************************************
40617>>>>>    Function SetupSQLConnection Boolean bReadDFConnSettings Boolean bReadSQLConnections Returns tSQLConnection
40619>>>>>        tSQLConnection SQLConnection
40619>>>>>        tSQLConnection SQLConnection
40619>>>>>
40619>>>>>        // If this object was created by the cDbUpdateHandler class we will
40619>>>>>        // deferr reading SQL connection values until later.
40619>>>>>        If (bReadDFConnSettings = True) Begin
40621>>>>>            // This is the new SQL login logic for DF 19 and up; "Managed Connections"
40621>>>>>            If (ghoConnection > 0) Begin
40623>>>>>                Get ReadcConnections to SQLConnection
40624>>>>>            End
40624>>>>>>
40624>>>>>
40624>>>>>            // In addition to the above; there might be other values set even if a cConnection
40624>>>>>            // object is used.
40624>>>>>            If (bReadSQLConnections = True) Begin
40626>>>>>                Get ReadSQLConnectionsIniSettings to SQLConnection
40627>>>>>            End
40627>>>>>>
40627>>>>>        End
40627>>>>>>
40627>>>>>
40627>>>>>        Function_Return SQLConnection
40628>>>>>    End_Function
40629>>>>>
40629>>>>>    // This is for the new cConnection class used by DF 19 and up (only).
40629>>>>>    Function ReadcConnections Returns tSQLConnection
40631>>>>>        tConnection Connection
40631>>>>>        tConnection Connection
40631>>>>>        tSQLConnection SQLConnection SQLConnectionEmpty
40631>>>>>        tSQLConnection SQLConnection SQLConnectionEmpty
40631>>>>>        Integer iRetval iDbType
40631>>>>>        Boolean bOK bEnabled bConnected
40631>>>>>        String sConnectionID sSchema
40631>>>>>
40631>>>>>
40631>>>>>        Function_Return SQLConnection
40632>>>>>    End_Function
40633>>>>>
40633>>>>>    // Returns True if the psConnectionID has been set in the cDbUpateHandler object,
40633>>>>>    // or the DAW cConnect array of registered connection only contains one active/enabled
40633>>>>>    // connection id for a particular driver.
40633>>>>>    // So either the psConnectionID or the psDriverID can have been set in the cDbUpdateHandler
40633>>>>>    // object. We can then match a connection id from the DAW cConnect class array.
40633>>>>>    // Returns False if there are multiple connections that are enabled or the psConnectionID has
40633>>>>>    // been set in the cDbUpdateHandler object but it cannot be found amongst the registered
40633>>>>>    // connections of the DAW cConnect class.
40633>>>>>    Function IsSinglecConnection String ByRef sConnectionID Returns Boolean
40635>>>>>        tConnection[] ConnIdArray
40635>>>>>        tConnection[] ConnIdArray
40636>>>>>        Integer iCount iSize iConnectionIDCounter
40636>>>>>        Boolean bEnabled bFound
40636>>>>>        String sConnectionID2 sDriverID sDriverConn
40636>>>>>
40636>>>>>        Move False to bFound
40637>>>>>        If (ghoConnection > 0) Begin
40639>>>>>
40639>>>>>            // The property of the cDbUpdateHandler container object
40639>>>>>            Get psDriverID to sDriverID
40640>>>>>
40640>>>>>            Move 0 to iConnectionIDCounter
40641>>>>>            // This is the the DAW cConnect array with all registered connection id's.
40641>>>>>            Move (SizeOfArray(ConnIdArray)) to iSize
40642>>>>>            Decrement iSize
40643>>>>>            For iCount from 0 to iSize
40649>>>>>>
40649>>>>>                Move ConnIdArray[iCount].sDriver to sDriverConn
40650>>>>>                Move ConnIdArray[iCount].sId to sConnectionID2
40651>>>>>                Move (ConnIdArray[iCount].bDisabled = False) to bEnabled
40652>>>>>                // If no psConnectionID specified in the cDbUpdateHandler, we check if there is a driver
40652>>>>>                // connection in the DAW cConnect object _and_ that there is only one!
40652>>>>>                If (sConnectionID = "") Begin
40654>>>>>                    Move (sDriverID = sDriverConn and bEnabled = True) to bFound
40655>>>>>                End
40655>>>>>>
40655>>>>>                Else Begin
40656>>>>>                    If (Uppercase(sConnectionID) = Uppercase(sConnectionID2)) Begin
40658>>>>>                        Move iSize to iCount // Then we've found what we were looking for and we're out of here...
40659>>>>>                    End
40659>>>>>>
40659>>>>>                End
40659>>>>>>
40659>>>>>
40659>>>>>                If (bFound = True) Begin
40661>>>>>                    Increment iConnectionIDCounter
40662>>>>>                End
40662>>>>>>
40662>>>>>            Loop
40663>>>>>>
40663>>>>>            Move (iConnectionIDCounter <= 1 and sDriverConn <> "" and sConnectionID2 <> "") to bFound
40664>>>>>            If (bFound = True) Begin
40666>>>>>                Move sConnectionID2 to sConnectionID
40667>>>>>            End
40667>>>>>>
40667>>>>>        End
40667>>>>>>
40667>>>>>
40667>>>>>        // Special case; a cConnection object has been setup in the cApplication,
40667>>>>>        // but no DFConn.ini record has been created.
40667>>>>>        If (iSize = -1) Begin
40669>>>>>            Move True to bFound
40670>>>>>        End
40670>>>>>>
40670>>>>>
40670>>>>>        Function_Return bFound
40671>>>>>    End_Function
40672>>>>>
40672>>>>>    // Send on object creation to read the default connection string settings, and
40672>>>>>    // create a connection to the server.
40672>>>>>    Function ReadSQLConnectionsIniSettings Returns tSQLConnection
40674>>>>>        String sPath sFileName sPassword
40674>>>>>        Boolean bExists
40674>>>>>        tSQLConnection[] SQLConnectionArray
40674>>>>>        tSQLConnection[] SQLConnectionArray
40675>>>>>        tSQLConnection SQLConnection SQLConnectionEmpty
40675>>>>>        tSQLConnection SQLConnection SQLConnectionEmpty
40675>>>>>        Handle hoIniFile
40675>>>>>        Integer iSize iCount
40675>>>>>
40675>>>>>        Get psIniFilePath to sPath
40676>>>>>        Get phoSQLConnectionIniFile to hoIniFile
40677>>>>>        If (sPath = "") Begin
40679>>>>>            Get ApplicationPath of hoIniFile to sPath
40680>>>>>            Set psIniFilePath   of hoIniFile to sPath
40681>>>>>        End
40681>>>>>>
40681>>>>>        Get vFolderFormat sPath to sPath
40682>>>>>        Get psIniFileName to sFileName
40683>>>>>        Get vFilePathExists (sPath + sFileName) to bExists
40684>>>>>
40684>>>>>        Get SQLIniFileReadConnections of hoIniFile to SQLConnectionArray
40685>>>>>        Move (SizeOfArray(SQLConnectionArray)) to iSize
40686>>>>>        If (iSize = 0) Begin
40688>>>>>            // This may have been set by the "ReadcConnections" function,
40688>>>>>            // if a cConnection object has been setup for DataFlex 19 or later
40688>>>>>            // in the cApplication object.
40688>>>>>            Get pSQLConnection to SQLConnection
40689>>>>>            If (SQLConnection.sConnectionID = "") Begin
40691>>>>>                Function_Return SQLConnectionEmpty
40692>>>>>            End
40692>>>>>>
40692>>>>>            Move SQLConnection to SQLConnectionArray[0]
40693>>>>>        End
40693>>>>>>
40693>>>>>
40693>>>>>        // The first connection should be the one that is active, but just in case...
40693>>>>>        Decrement iSize
40694>>>>>        For iCount from 0 to iSize
40700>>>>>>
40700>>>>>            Move SQLConnectionArray[iCount] to SQLConnection
40701>>>>>            If (SQLConnection.bEnabled = True) Begin
40703>>>>>                Move iSize to iCount // We've found the enabled item, so we're out of here.
40704>>>>>            End
40704>>>>>>
40704>>>>>        Loop
40705>>>>>>
40705>>>>>
40705>>>>>        Send CreateSQLConnection SQLConnection.sDriverID SQLConnection.sConnectionID ;             SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted ;             SQLConnection.sUserID SQLConnection.sPassword SQLConnection.bSilentLogin
40706>>>>>
40706>>>>>        Set pSQLConnection to SQLConnection
40707>>>>>        Send AutoSetConnectionID
40708>>>>>
40708>>>>>        Function_Return SQLConnection
40709>>>>>    End_Function
40710>>>>>
40710>>>>>    Procedure Set psIniFilePath String sPath
40712>>>>>        Set psIniFilePath of (phoSQLConnectionIniFile(Self)) to sPath
40713>>>>>    End_Procedure
40714>>>>>
40714>>>>>    Function psIniFilePath Returns String
40716>>>>>        String sRetval
40716>>>>>        Get psIniFilePath of (phoSQLConnectionIniFile(Self)) to sRetval
40717>>>>>        Function_Return sRetval
40718>>>>>    End_Function
40719>>>>>
40719>>>>>    Procedure Set psIniFileName String sFileName
40721>>>>>        Set psIniFileName of (phoSQLConnectionIniFile(Self)) to sFileName
40722>>>>>    End_Procedure
40723>>>>>
40723>>>>>    Function psIniFileName Returns String
40725>>>>>        String sRetval
40725>>>>>        Get psIniFileName of (phoSQLConnectionIniFile(Self)) to sRetval
40726>>>>>        Function_Return sRetval
40727>>>>>    End_Function
40728>>>>>
40728>>>>>    // We use Base64 coding instead of the cCryptographer class because the
40728>>>>>    // password will get scrambled while writing/reading to/from the ini-file.
40728>>>>>//    { MethodType=Property Category="Behavior" InitialValue="zx!2139(LI0+?ips7433"}
40728>>>>>//    Procedure Set psHashString String sHashString
40728>>>>>//        Set psHashString of (phoSQLConnectionIniFile(Self)) to sHashString
40728>>>>>//    End_Procedure
40728>>>>>//
40728>>>>>//    Function psHashString Returns String
40728>>>>>//        String sRetval
40728>>>>>//        Get psHashString of (phoSQLConnectionIniFile(Self)) to sRetval
40728>>>>>//        Function_Return sRetval
40728>>>>>//    End_Function
40728>>>>>
40728>>>>>    Procedure Set psIniSectionName String sSection
40730>>>>>        Set psIniSectionName of (phoSQLConnectionIniFile(Self)) to sSection
40731>>>>>    End_Procedure
40732>>>>>
40732>>>>>    Function psIniSectionName Returns String
40734>>>>>        String sRetval
40734>>>>>        Get psIniSectionName of (phoSQLConnectionIniFile(Self)) to sRetval
40735>>>>>        Function_Return sRetval
40736>>>>>    End_Function
40737>>>>>
40737>>>>>    Procedure Set IniFileValue String sSection String sValueName String sValue
40739>>>>>        Handle ho
40739>>>>>        Get phoSQLConnectionIniFile to ho
40740>>>>>        Set IniFileValue of ho to sSection sValueName sValue
40741>>>>>    End_Procedure
40742>>>>>
40742>>>>>    Function IniFileValue String sSection String sValueName String sDefaultValue Returns String
40744>>>>>        Handle ho
40744>>>>>        String sRetval
40744>>>>>        Get phoSQLConnectionIniFile to ho
40745>>>>>        Get IniFileValue of ho sSection sValueName sDefaultValue to sRetval
40746>>>>>        Function_Return sRetval
40747>>>>>    End_Function
40748>>>>>
40748>>>>>    Function SectionExists String sSection Returns Boolean
40750>>>>>        Handle ho
40750>>>>>        Boolean bRetval
40750>>>>>        Get phoSQLConnectionIniFile to ho
40751>>>>>        Get SectionExists of ho sSection to bRetval
40752>>>>>        Function_Return bRetval
40753>>>>>    End_Function
40754>>>>>
40754>>>>>    Function KeyExists String sSection String sKey Returns Boolean
40756>>>>>        Handle ho
40756>>>>>        Boolean bRetval
40756>>>>>        Get phoSQLConnectionIniFile to ho
40757>>>>>        Get KeyExists of ho sSection sKey to bRetval
40758>>>>>        Function_Return bRetval
40759>>>>>    End_Function
40760>>>>>
40760>>>>>    Function EncryptPassword String sPassword Returns String
40762>>>>>        Handle ho
40762>>>>>        String sRetval
40762>>>>>        Get phoSQLConnectionIniFile to ho
40763>>>>>        Get EncryptPassword of ho sPassword to sRetval
40764>>>>>        Function_Return sRetval
40765>>>>>    End_Function
40766>>>>>
40766>>>>>    Function DecryptPassword String sPassword Returns String
40768>>>>>        Handle ho
40768>>>>>        String sRetval
40768>>>>>        Get phoSQLConnectionIniFile to ho
40769>>>>>        Get DecryptPassword of ho sPassword to sRetval
40770>>>>>        Function_Return sRetval
40771>>>>>    End_Function
40772>>>>>
40772>>>>>    // *** Main Connection Message ***
40772>>>>>    // It will create a Connection ID for the passed driver.
40772>>>>>    // It will also set the psDriverID & psConnectionID of this class.
40772>>>>>    Procedure CreateSQLConnection String sDriverID String sConnectionID String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Boolean bSilent
40774>>>>>        Handle hoDriver
40774>>>>>        String sConnectionString sError
40774>>>>>        Boolean bLoginSuccessful
40774>>>>>
40774>>>>>        Get ConstructConnectionString sDriverID sServer sDatabase bTrusted sUserID sPassword to sConnectionString
40775>>>>>        Get Create (RefClass(cDbUpdateDatabaseDriver)) to hoDriver
40776>>>>>        Set psDriverID of hoDriver to sDriverID
40777>>>>>        Get DbLogin of hoDriver sConnectionString sServer sDatabase bTrusted sUserID sPassword to bLoginSuccessful
40778>>>>>        If (bLoginSuccessful = False) Begin
40780>>>>>            Error DFERR_PROGRAM (CS_DUF_CannotLoginToServer * CS_DUF_ErrorText * String(sError) + "\nConnectionID = " * sConnectionID + "\nConnection String = " * sConnectionString)
40781>>>>>>
40781>>>>>            Send Exit_Application
40782>>>>>        End
40782>>>>>>
40782>>>>>        Send Destroy of hoDriver
40783>>>>>
40783>>>>>    End_Procedure
40784>>>>>
40784>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
40786>>>>>        Integer iRetval
40786>>>>>        Handle hoCLI
40786>>>>>        String sDriverID
40786>>>>>
40786>>>>>        Get psDriverID to sDriverID
40787>>>>>        Get Create (Refclass(cCLIHandler)) to hoCLI
40788>>>>>        If (hoCLI <> 0) Begin
40790>>>>>            Set psDriverID of hoCLI to sDriverID
40791>>>>>            Get RedirectConnection of hoCLI sOldConnection sNewConnection to iRetval
40792>>>>>            Send Destroy of hoCLI
40793>>>>>        End
40793>>>>>>
40793>>>>>
40793>>>>>        Function_Return iRetval
40794>>>>>    End_Function
40795>>>>>
40795>>>>>    Procedure CreateConnParamsFromConnectionString String sDriverID String sConnectionString
40797>>>>>        String sServer sDatabase sUserID sPassword
40797>>>>>        tSQLConnection SQLConnection
40797>>>>>        tSQLConnection SQLConnection
40797>>>>>
40797>>>>>        Set psDriverID to sDriverID
40798>>>>>        Get DeComposeConnectionString sDriverID sConnectionString to SQLConnection
40799>>>>>        Send CreateSQLConnection SQLConnection.sDriverID SQLConnection.sConnectionID SQLConnection.sServer;                                 SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword SQLConnection.bTrusted
40800>>>>>    End_Procedure
40801>>>>>
40801>>>>>    // This is needed when e.g. the connection id we have specified in the program code
40801>>>>>    // also exists in e.g. the MSSQLDRV.ini file (can either be local in the Data folder
40801>>>>>    // or the one in the DataFlex Bin folder.)
40801>>>>>    // We then need to delete the current one before creating a new one.
40801>>>>>    // This is because the parameters may differ between the program code and the
40801>>>>>    // MSSQLDRV.ini file in a deployed environment. Also DataFlex will generate an error
40801>>>>>    // when one tries to create a Connection ID that already exists.
40801>>>>>    Procedure RemoveExistingConnectionID String sDriverID String sConnectionID
40803>>>>>        Integer iResult iDriver iNumConn iConn
40803>>>>>        Handle hoCLI
40803>>>>>        String sID
40803>>>>>
40803>>>>>        If (sDriverID = "" or sConnectionID = "") Begin
40805>>>>>            Procedure_Return
40806>>>>>        End
40806>>>>>>
40806>>>>>
40806>>>>>        Move 0 to iResult
40807>>>>>        Get Create U_cCLIHandler to hoCLI
40808>>>>>        If (hoCLI <> 0) Begin
40810>>>>>            Set psDriverID of hoCLI to sDriverID
40811>>>>>            Get DriverIndex sDriverID to iDriver
40812>>>>>            Get_Attribute DF_DRIVER_NUMBER_CONNECTION_IDS of iDriver to iNumConn
40815>>>>>            Decrement iNumConn
40816>>>>>            For iConn from 0 to iNumConn
40822>>>>>>
40822>>>>>                Get_Attribute DF_DRIVER_CONNECTION_ID of iDriver iConn to sID
40825>>>>>                If (Uppercase(sID) = Uppercase(sConnectionID)) Begin
40827>>>>>                    Get DeleteConnectionID of hoCLI sConnectionID -1 to iResult
40828>>>>>                End
40828>>>>>>
40828>>>>>            Loop
40829>>>>>>
40829>>>>>            Send Destroy of hoCLI
40830>>>>>        End
40830>>>>>>
40830>>>>>
40830>>>>>    End_Procedure
40831>>>>>
40831>>>>>    Function ExistingConnectionSettings String sDriverID String sConnectionID Returns tSQLConnection
40833>>>>>        Integer iResult iDriver iNumConn iConn
40833>>>>>        Handle hoCLI
40833>>>>>        String sID sConnectionString sVal sDatabase
40833>>>>>        tSQLConnection SQLConnection
40833>>>>>        tSQLConnection SQLConnection
40833>>>>>        Boolean bTrusted
40833>>>>>
40833>>>>>        Move 0 to iResult
40834>>>>>        Get Create U_cCLIHandler to hoCLI
40835>>>>>        If (hoCLI <> 0) Begin
40837>>>>>            Set psDriverID of hoCLI to sDriverID
40838>>>>>            Get DriverIndex sDriverID to iDriver
40839>>>>>            Get_Attribute DF_DRIVER_NUMBER_CONNECTION_IDS of iDriver to iNumConn
40842>>>>>            Decrement iNumConn
40843>>>>>            For iConn from 0 to iNumConn
40849>>>>>>
40849>>>>>                Get_Attribute DF_DRIVER_CONNECTION_ID of iDriver iConn to sID
40852>>>>>                If (Uppercase(sID) = Uppercase(sConnectionID)) Begin
40854>>>>>                    Move sDriverID                                                      to SQLConnection.sDriverID      // For completeness only...
40855>>>>>                    Get_Attribute DF_DRIVER_CONNECTION_ID of iDriver iConn              to SQLConnection.sConnectionID  // For completeness only...
40858>>>>>                    Get_Attribute DF_DRIVER_CONNECTION_ID_STRING of iDriver iConn       to sConnectionString
40861>>>>>                    Move sConnectionString                                              to SQLConnection.sConnectionString
40862>>>>>                    Get_Attribute DF_DRIVER_CONNECTION_ID_OPTIONS of iDriver iConn      to SQLConnection.bSilentLogin
40865>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniServerKeyword + "=")   to SQLConnection.sServer
40866>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to SQLConnection.sDatabase
40867>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")      to SQLConnection.sUserID
40868>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")      to SQLConnection.sPassword
40869>>>>>
40869>>>>>                    Case Begin
40869>>>>>                        Case (sDriverID = MSSQLDRV_ID)
40871>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniTrustedKeyword + "=") to sVal
40872>>>>>                            Move (If(Uppercase(sVal) = Uppercase(CS_SQLIniConnectionYes), True, False)) to bTrusted
40873>>>>>                            Move bTrusted                                               to SQLConnection.bTrusted
40874>>>>>                            Case Break
40875>>>>>                        Case (sDriverID = DB2_DRV_ID)
40878>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=") to SQLConnection.sServer
40879>>>>>                            Case Break
40880>>>>>                        Case (sDriverID = ODBC_DRV_ID)
40883>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=") to SQLConnection.sServer
40884>>>>>                            Case Break
40885>>>>>                        Case (sDriverID = SQLFLEX)
40888>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=") to SQLConnection.sServer
40889>>>>>                            Move (CS_SQLIniServerKeyword + "=" + SQLConnection.sServer)    to sConnectionString
40890>>>>>                            If (SQLConnection.bTrusted = True) Begin
40892>>>>>                                Move (sConnectionString + ";" + CS_SQLIniTrustedKeyword + "=" + CS_SQLIniConnectionYes) to sConnectionString
40893>>>>>                            End
40893>>>>>>
40893>>>>>                            Else Begin
40894>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")    to sVal
40895>>>>>                                Move (sConnectionString + ";" + CS_SQLIniUIDKeyword + "=" + sVal) to sConnectionString
40896>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")    to sVal
40897>>>>>                                Move (sConnectionString + ";" + CS_SQLIniPWDKeyword + "=" + sVal) to sConnectionString
40898>>>>>                            End
40898>>>>>>
40898>>>>>                            Move sConnectionString                                         to SQLConnection.sConnectionString
40899>>>>>                            Case Break
40900>>>>>                        Case (sDriverID = MDSMySQL)
40903>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=") to SQLConnection.sServer
40904>>>>>                            Move (CS_SQLIniServerKeyword + "=" + SQLConnection.sServer)    to sConnectionString
40905>>>>>                            If (SQLConnection.bTrusted = True) Begin
40907>>>>>                                Move (sConnectionString + ";" + CS_SQLIniTrustedKeyword + "=" + CS_SQLIniConnectionYes) to sConnectionString
40908>>>>>                            End
40908>>>>>>
40908>>>>>                            Else Begin
40909>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")    to sVal
40910>>>>>                                Move (sConnectionString + ";" + CS_SQLIniUIDKeyword + "=" + sVal) to sConnectionString
40911>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")    to sVal
40912>>>>>                                Move (sConnectionString + ";" + CS_SQLIniPWDKeyword + "=" + sVal) to sConnectionString
40913>>>>>                            End
40913>>>>>>
40913>>>>>                            Move sConnectionString                                         to SQLConnection.sConnectionString
40914>>>>>                            Case Break
40915>>>>>                        Case (sDriverID = MDSPgSQL)
40918>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=") to SQLConnection.sServer
40919>>>>>                            Move (CS_SQLIniServerKeyword + "=" + SQLConnection.sServer)    to sConnectionString
40920>>>>>                            If (SQLConnection.bTrusted = True) Begin
40922>>>>>                                Move (sConnectionString + ";" + CS_SQLIniTrustedKeyword + "=" + CS_SQLIniConnectionYes) to sConnectionString
40923>>>>>                            End
40923>>>>>>
40923>>>>>                            Else Begin
40924>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")    to sVal
40925>>>>>                                Move (sConnectionString + ";" + CS_SQLIniUIDKeyword + "=" + sVal) to sConnectionString
40926>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")    to sVal
40927>>>>>                                Move (sConnectionString + ";" + CS_SQLIniPWDKeyword + "=" + sVal) to sConnectionString
40928>>>>>                            End
40928>>>>>>
40928>>>>>                            Move sConnectionString                                                to SQLConnection.sConnectionString
40929>>>>>                            Case Break
40930>>>>>
40930>>>>>                        Case (sDriverID = ORAFLEX)
40933>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to SQLConnection.sServer
40934>>>>>                            Move (CS_SQLIniServerKeyword + "=" + SQLConnection.sServer)         to sConnectionString
40935>>>>>                            Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to sDatabase
40936>>>>>                            If (sDatabase <> "" and (not(SQLConnection.sServer contains "/"))) Begin
40938>>>>>                                Move (SQLConnection.sServer + "/" + sDatabase)                  to SQLConnection.sServer
40939>>>>>                            End
40939>>>>>>
40939>>>>>                            If (SQLConnection.bTrusted = True) Begin
40941>>>>>                                Move (sConnectionString + ";" + CS_SQLIniTrustedKeyword + "=" + CS_SQLIniConnectionYes) to sConnectionString
40942>>>>>                            End
40942>>>>>>
40942>>>>>                            Else Begin
40943>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")    to sVal
40944>>>>>                                Move (sConnectionString + ";" + CS_SQLIniUIDKeyword + "=" + sVal) to sConnectionString
40945>>>>>                                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")    to sVal
40946>>>>>                                Move (sConnectionString + ";" + CS_SQLIniPWDKeyword + "=" + sVal) to sConnectionString
40947>>>>>                            End
40947>>>>>>
40947>>>>>                            Move sConnectionString                                         to SQLConnection.sConnectionString
40948>>>>>                            Case Break
40949>>>>>                        Case Else
40949>>>>>                            Error ("Wrong driver ID passed:" * sDriverID)
40950>>>>>>
40950>>>>>                            Case Break
40951>>>>>                    Case End
40951>>>>>                End
40951>>>>>>
40951>>>>>            Loop
40952>>>>>>
40952>>>>>            Send Destroy of hoCLI
40953>>>>>        End
40953>>>>>>
40953>>>>>
40953>>>>>        Function_Return SQLConnection
40954>>>>>    End_Function
40955>>>>>
40955>>>>>    Function DriverIndex String sDriverID Returns Integer
40957>>>>>        String  sCurrentDriver
40957>>>>>        Integer iNumberOfDrivers iDriver iCount
40957>>>>>
40957>>>>>        Move 0 to iDriver
40958>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
40961>>>>>        For iCount from 1 to iNumberOfDrivers
40967>>>>>>
40967>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
40970>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriverID) ) Begin
40972>>>>>                Function_Return iCount
40973>>>>>            End
40973>>>>>>
40973>>>>>        Loop
40974>>>>>>
40974>>>>>
40974>>>>>        // If driver not previously loaded; attempt to do so now.
40974>>>>>        If (iDriver = 0) Begin
40976>>>>>            Move 0 to LastErr
40977>>>>>            Load_Driver sDriverID
40978>>>>>            // If driver could not be loaded.
40978>>>>>            If (LastErr = 4255) Begin
40980>>>>>                Move 0 to iCount
40981>>>>>            End
40981>>>>>>
40981>>>>>            Function_Return iCount
40982>>>>>        End
40982>>>>>>
40982>>>>>        Function_Return 0
40983>>>>>    End_Function
40984>>>>>
40984>>>>>    // This will update connection settings of the cCLIHandler object with that passed struct values.
40984>>>>>    Procedure UpdateConnectionString tSQLConnection SQLConnection
40986>>>>>        String sDriverID sConnectionID sServer sDatabase sUserID sPassword
40986>>>>>        Boolean bTrusted bSilent
40986>>>>>
40986>>>>>        Move SQLConnection.sDriverID     to sDriverID
40987>>>>>        Move SQLConnection.sConnectionID to sConnectionID
40988>>>>>        Move SQLConnection.sServer       to sServer
40989>>>>>        Move SQLConnection.sDatabase     to sDatabase
40990>>>>>        Move SQLConnection.bTrusted      to bTrusted
40991>>>>>        Move SQLConnection.sUserID       to sUserID
40992>>>>>        Move SQLConnection.sPassword     to sPassword
40993>>>>>        Move SQLConnection.bSilentLogin  to bSilent
40994>>>>>
40994>>>>>        Send CreateSQLConnection sDriverID sConnectionID sServer sDatabase bTrusted sUserID sPassword bSilent
40995>>>>>        // Note that this message will first delete the current ConnectionID if it exists; which is needed by the cCLIHandler logic.
40995>>>>>        Send AutoSetConnectionID
40996>>>>>    End_Procedure
40997>>>>>
40997>>>>>    // Called when the object is constructed.
40997>>>>>    // It will check the psDriverID for a ConnectionID and save it
40997>>>>>    // as psConnectionID property. It is later used whenever a login to
40997>>>>>    // the database is needed.
40997>>>>>    Procedure AutoSetConnectionID
40999>>>>>        String sConnectionID sDriverID sConnectionString
40999>>>>>        Integer iDriver iRetval
40999>>>>>        Handle hoCLI
40999>>>>>        Boolean bOK bSilent bMertechDriver
40999>>>>>
40999>>>>>        Get pbSilentLogin      to bSilent
41000>>>>>        Get psConnectionID     to sConnectionID
41001>>>>>        Get psConnectionString to sConnectionString
41002>>>>>        // Get the driver Connection ID string & set the psConnectionString property.
41002>>>>>        Get psDriverID to sDriverID
41003>>>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41004>>>>>        If (bOK = False) Begin
41006>>>>>            Procedure_Return
41007>>>>>        End
41007>>>>>>
41007>>>>>
41007>>>>>        // Mertech drivers can't use connection ID's.
41007>>>>>        Get IsMertechDriver sDriverID to bMertechDriver
41008>>>>>        If (bMertechDriver = True) Begin
41010>>>>>            // This ensures that the correct Server & Database attributes are set both for
41010>>>>>            // embedded SQL calls and "normal" database commands like e.g. "Open".
41010>>>>>            Get _MertechSQLManagerHandle to hoCLI
41011>>>>>            Procedure_Return
41012>>>>>        End
41012>>>>>>
41012>>>>>
41012>>>>>        Get DriverIndex sDriverID          to iDriver
41013>>>>>        // If driver not loaded; load it.
41013>>>>>        If (iDriver = 0) Begin
41015>>>>>            Load_Driver sDriverID
41016>>>>>            Get DriverIndex sDriverID      to iDriver
41017>>>>>        End
41017>>>>>>
41017>>>>>        // This shouldn't be possible; unless the driver.dll file is missing or something...
41017>>>>>        If (iDriver = 0) Begin
41019>>>>>            Error DFERR_PROGRAM ("The database driver could not be loaded! Connection to database failed." * sDriverID)
41020>>>>>>
41020>>>>>            Procedure_Return
41021>>>>>        End
41021>>>>>>
41021>>>>>
41021>>>>>        Get Create (RefClass(cCLIHandler)) to hoCLI
41022>>>>>        Set psDriverID of hoCLI            to sDriverID
41023>>>>>        // Delete the connection first; in case it exists
41023>>>>>        Get DeleteConnectionID of hoCLI sConnectionID -1 to iRetval
41024>>>>>        Get CreateConnectionID of hoCLI sConnectionID sConnectionString bSilent to iRetval
41025>>>>>
41025>>>>>        Send Destroy of hoCLI
41026>>>>>    End_Procedure
41027>>>>>
41027>>>>>    // Returns the handle of the Mertech SQL handler.
41027>>>>>    // It also ensures that the correct Server & Database attributes are set both for
41027>>>>>    // embedded SQL calls and "normal" database commands like e.g. "Open".
41027>>>>>    // Note: This does _not_ return a proper CLI handler handle as it is not in this class.
41027>>>>>    //       So the return value is of no use! But we don't need the handle for this class.
41027>>>>>    Function _MertechSQLManagerHandle Returns Handle
41029>>>>>        Handle hoSQLHandler
41029>>>>>        String sDriverID sServer sDatabase
41029>>>>>
41029>>>>>        Move 0 to hoSQLHandler
41030>>>>>        Get psDriverID to sDriverID
41031>>>>>        Get psServer   to sServer
41032>>>>>        Get psDatabase to sDatabase
41033>>>>>
41033>>>>>        Function_Return hoSQLHandler
41034>>>>>    End_Function
41035>>>>>
41035>>>>>    Function _SqlCheckCurrentDriver String sDriverID Returns Boolean
41037>>>>>        Boolean bOK bMertechDriver
41037>>>>>
41037>>>>>        Get IsDAWSQLDriver sDriverID to bOK
41038>>>>>
41038>>>>>        If (bOK = False) Begin
41040>>>>>            Get IsMertechDriver sDriverID to bOK
41041>>>>>        End
41041>>>>>>
41041>>>>>
41041>>>>>        If (bOK = False) Begin
41043>>>>>            Get IsMertechDriver sDriverID to bMertechDriver
41044>>>>>            If (bMertechDriver = True) Begin
41046>>>>>                Error DFERR_PROGRAM "Driver needs to be one of MSSQLDRV_ID, DB2_DRV_ID, ODBC_DRV_ID, SQLFLEX, ORAFLEX, MDSPgSQL or MDSMYSQL"
41047>>>>>>
41047>>>>>            End
41047>>>>>>
41047>>>>>            Else Begin
41048>>>>>                Error DFERR_PROGRAM "Driver needs to be one of MSSQLDRV_ID, DB2_DRV_ID or ODBC_DRV_ID"
41049>>>>>>
41049>>>>>            End
41049>>>>>>
41049>>>>>            Function_Return False
41050>>>>>        End
41050>>>>>>
41050>>>>>
41050>>>>>        Function_Return True
41051>>>>>    End_Function
41052>>>>>
41052>>>>>    Function IsDAWSQLDriver String sDriverID Returns Boolean
41054>>>>>        Boolean bOK
41054>>>>>        Move (sDriverID = MSSQLDRV_ID or sDriverID = DB2_DRV_ID or sDriverID = ODBC_DRV_ID) to bOK
41055>>>>>        Function_Return bOK
41056>>>>>    End_Function
41057>>>>>
41057>>>>>    Function IsMertechDriver String sDriverID Returns Boolean
41059>>>>>        Boolean bOK
41059>>>>>        Move False to bOK
41060>>>>>        Function_Return bOK
41061>>>>>    End_Function
41062>>>>>
41062>>>>>    Function ConstructConnectionString String sDriverID String sServer String sDatabase Boolean bTrusted String sUserID String sPassword Returns String
41064>>>>>        Handle hoIniFile
41064>>>>>        String sConnect
41064>>>>>
41064>>>>>        Get phoSQLConnectionIniFile to hoIniFile
41065>>>>>        Get ConstructConnectionString of hoIniFile sDriverID sServer sDatabase bTrusted sUserID sPassword to sConnect
41066>>>>>
41066>>>>>        Function_Return sConnect
41067>>>>>    End_Function
41068>>>>>
41068>>>>>    // Sample sConnString: "SERVER=(local)\SQLEXPRESS;UID=dbuser;PWD=secret;DATABASE=OrderEntry;, 0"
41068>>>>>    // Pass a complete driver connection string
41068>>>>>    // Returns the following as a struct:
41068>>>>>    //   sServer, sDatabase, sUser, sPassword & True if Trusted_Connection is used.
41068>>>>>    // Finally also returns a boolean TRUE if trusted_connection=yes, else false is returned.
41068>>>>>    //
41068>>>>>    Function DeComposeConnectionString String sDriverID String sConnectionString Returns tSQLConnection
41070>>>>>        tSQLConnection SQLConnection
41070>>>>>        tSQLConnection SQLConnection
41070>>>>>        String sValue sConnectionID sServer sDatabase sUserID sPassword
41070>>>>>        Boolean bTrusted bSilent bOK
41070>>>>>        Integer iPos
41070>>>>>
41070>>>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41071>>>>>        If (bOK = False) Begin
41073>>>>>            Function_Return SQLConnection
41074>>>>>        End
41074>>>>>>
41074>>>>>
41074>>>>>        Move False to bTrusted
41075>>>>>        Move False to bSilent
41076>>>>>
41076>>>>>        Case Begin
41076>>>>>            Case (sDriverID = MSSQLDRV_ID)
41078>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniServerKeyword + "=")   to sServer
41079>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to sDatabase
41080>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniTrustedKeyword + "=")  to sValue
41081>>>>>                Move (If(Uppercase(sValue) = "YES", True, False))                   to bTrusted
41082>>>>>                If (bTrusted = False) Begin
41084>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")  to sUserID
41085>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")  to sPassword
41086>>>>>                End
41086>>>>>>
41086>>>>>                Case Break
41087>>>>>
41087>>>>>            Case (sDriverID = ODBC_DRV_ID)
41090>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to sServer
41091>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniTrustedKeyword + "=")  to sValue
41092>>>>>                Move (If(Uppercase(sValue) = "YES", True, False))                   to bTrusted
41093>>>>>                If (bTrusted = False) Begin
41095>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")  to sUserID
41096>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")  to sPassword
41097>>>>>                End
41097>>>>>>
41097>>>>>                Case Break
41098>>>>>
41098>>>>>            Case (sDriverID = DB2_DRV_ID)
41101>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to sServer
41102>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")      to sUserID
41103>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")      to sPassword
41104>>>>>                Case Break
41105>>>>>
41105>>>>>            Case (sDriverID = SQLFLEX)
41108>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniServerKeyword + "=")   to sServer
41109>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniTrustedKeyword + "=")  to sValue
41110>>>>>                Move (If(Uppercase(sValue) = "YES", True, False))                   to bTrusted
41111>>>>>                If (bTrusted = False) Begin
41113>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")  to sUserID
41114>>>>>                    Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")  to sPassword
41115>>>>>                End
41115>>>>>>
41115>>>>>                Case Break
41116>>>>>
41116>>>>>            Case (sDriverID = ORAFLEX)
41119>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to sServer
41120>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to sDatabase
41121>>>>>                If (sDatabase <> "" and (not(sServer contains "/"))) Begin
41123>>>>>                    Move (sServer + "/" + sDatabase)                                to sServer
41124>>>>>                End
41124>>>>>>
41124>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")      to sUserID
41125>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")      to sPassword
41126>>>>>                Case Break
41127>>>>>
41127>>>>>            Case (sDriverID = MDSPgSQL)
41130>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to sServer
41131>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to sDatabase
41132>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")      to sUserID
41133>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")      to sPassword
41134>>>>>                Case Break
41135>>>>>
41135>>>>>            Case (sDriverID = MDSMySQL)
41138>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDSNKeyword + "=")      to sServer
41139>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniDatabaseKeyword + "=") to sDatabase
41140>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniUIDKeyword + "=")      to sUserID
41141>>>>>                Get ParseKeyWord sConnectionString (CS_SQLIniPWDKeyword + "=")      to sPassword
41142>>>>>                Case Break
41143>>>>>
41143>>>>>            Case (sDriverID = DATAFLEX_ID)    // Dummy stub.
41146>>>>>                Break
41147>>>>>        Case End
41147>>>>>
41147>>>>>        Get ParseKeyWord sConnectionString (Uppercase(CS_SQLConnectionIDText))  to sConnectionID
41148>>>>>
41148>>>>>        // bSilent?
41148>>>>>        Move (Pos(",0", sConnectionString))                                     to iPos
41149>>>>>        If (iPos = 0) Begin
41151>>>>>            Move (Pos(",1", sConnectionString))                                 to iPos
41152>>>>>        End
41152>>>>>>
41152>>>>>        If (iPos = 0) Begin
41154>>>>>            Move "0"                                                            to sValue
41155>>>>>        End
41155>>>>>>
41155>>>>>        Else Begin
41156>>>>>            Move (Mid(sConnectionString, 1, (iPos +1)))                         to sValue
41157>>>>>        End
41157>>>>>>
41157>>>>>        Move (If(sValue = 1, True, False))                                      to bSilent
41158>>>>>
41158>>>>>        Move (Trim(sDriverID))                                                  to SQLConnection.sDriverID
41159>>>>>        Move (Trim(sConnectionID))                                              to SQLConnection.sConnectionID
41160>>>>>        Move (Trim(sConnectionString))                                          to SQLConnection.sConnectionString
41161>>>>>        Move (Trim(sServer))                                                    to SQLConnection.sServer
41162>>>>>        Move (Trim(sDatabase))                                                  to SQLConnection.sDatabase
41163>>>>>        Move bTrusted                                                           to SQLConnection.bTrusted
41164>>>>>        Move (Trim(sUserID))                                                    to SQLConnection.sUserID
41165>>>>>        Move (Trim(sPassword))                                                  to SQLConnection.sPassword
41166>>>>>        Move bSilent                                                            to SQLConnection.bSilentLogin
41167>>>>>
41167>>>>>        Function_Return SQLConnection
41168>>>>>    End_Function
41169>>>>>
Including file: ParseKeyWord.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\ParseKeyWord.pkg)
41169>>>>>>
41169>>>>>>Function ParseKeyWord String sConnect String sKeyWord Returns String
41171>>>>>>    Integer iStart iEnd
41171>>>>>>    String sRetval
41171>>>>>>
41171>>>>>>    Move (Trim(sConnect)) to sConnect
41172>>>>>>    Move (Pos(Uppercase(sKeyWord), Uppercase(sConnect)))  to iStart
41173>>>>>>    If (iStart = 0) Begin
41175>>>>>>        Function_Return ""
41176>>>>>>    End
41176>>>>>>>
41176>>>>>>    Move (Left(sConnect, (iStart -1 + Length(sKeyWord)))) to sRetval
41177>>>>>>    Move (Replace(sRetval, sConnect, "")) to sRetval
41178>>>>>>    If (sKeyWord = Uppercase(CS_SQLConnectionIDText)) Begin
41180>>>>>>        Move (Pos(",", sRetval))          to iEnd
41181>>>>>>    End
41181>>>>>>>
41181>>>>>>    Else Begin
41182>>>>>>        Move (Pos(";", sRetval))          to iEnd
41183>>>>>>    End
41183>>>>>>>
41183>>>>>>    If (iEnd = 0 and (sRetval contains ",")) Begin
41185>>>>>>        Move (Pos(",", sRetval))          to iEnd
41186>>>>>>        Decrement iEnd
41187>>>>>>    End
41187>>>>>>>
41187>>>>>>    If (iEnd <> 0) Begin
41189>>>>>>        Move (Left(sRetval, (iEnd -1)))   to sRetval
41190>>>>>>    End
41190>>>>>>>
41190>>>>>>    Move (Replace("=", sRetval, ""))      to sRetval
41191>>>>>>
41191>>>>>>    Function_Return (Trim(sRetval))
41192>>>>>>End_Function
41193>>>>>>
41193>>>>>>
41193>>>>>
41193>>>>>    // To update the SQLSettings.ini file with updated connection data (SQLConnection struct data).
41193>>>>>    Function SQLIniFileSetDefaultConnection String sConnectionID Returns Boolean
41195>>>>>        Handle ho
41195>>>>>        Integer iIndex
41195>>>>>        Boolean bRetval bOK
41195>>>>>        tSQLConnection SQLConnection
41195>>>>>        tSQLConnection SQLConnection
41195>>>>>
41195>>>>>        Get pSQLConnection to SQLConnection
41196>>>>>        Get phoSQLConnectionIniFile to ho
41197>>>>>        Get SQLIniFileConnectionIDIndex of ho sConnectionID to iIndex
41198>>>>>        If (iIndex = -1) Begin
41200>>>>>            Function_Return False
41201>>>>>        End
41201>>>>>>
41201>>>>>
41201>>>>>        Get SQLIniFileUpdateConnection of ho SQLConnection to bRetval
41202>>>>>        Send UpdateConnectionString of ghoSQLConnectionHandler SQLConnection
41203>>>>>        If (ghoConnection > 0) Begin
41205>>>>>            Get ConnectionIdIndex of ghoConnection SQLConnection.sConnectionID to iIndex
41206>>>>>            If (iIndex <> -1) Begin
41208>>>>>                Get RedirectConnectionId of ghoConnection SQLConnection.sConnectionID (SQLConnection.sServer + ";" + CS_SQLIniDatabaseKeyword + "=" + SQLConnection.sDatabase) SQLConnection.sUserID SQLConnection.sPassword SQLConnection.bTrusted True to bOK
41209>>>>>            End
41209>>>>>>
41209>>>>>        End
41209>>>>>>
41209>>>>>
41209>>>>>        Function_Return bRetval
41210>>>>>    End_Function
41211>>>>>
41211>>>>>End_Class
41212>>>Use vWin32fh.pkg
41212>>>
41212>>>//
41212>>>Class cDbUpdateFunctionLibrary is a cObject
41213>>>    Import_Class_Protocol cDbUpdateFunctionLibrary_Mixin
Including file: ParseKeyWord.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\ParseKeyWord.pkg)
41214>>>>
41214>>>>Function ParseKeyWord String sConnect String sKeyWord Returns String
41216>>>>    Integer iStart iEnd
41216>>>>    String sRetval
41216>>>>
41216>>>>    Move (Trim(sConnect)) to sConnect
41217>>>>    Move (Pos(Uppercase(sKeyWord), Uppercase(sConnect)))  to iStart
41218>>>>    If (iStart = 0) Begin
41220>>>>        Function_Return ""
41221>>>>    End
41221>>>>>
41221>>>>    Move (Left(sConnect, (iStart -1 + Length(sKeyWord)))) to sRetval
41222>>>>    Move (Replace(sRetval, sConnect, "")) to sRetval
41223>>>>    If (sKeyWord = Uppercase(CS_SQLConnectionIDText)) Begin
41225>>>>        Move (Pos(",", sRetval))          to iEnd
41226>>>>    End
41226>>>>>
41226>>>>    Else Begin
41227>>>>        Move (Pos(";", sRetval))          to iEnd
41228>>>>    End
41228>>>>>
41228>>>>    If (iEnd = 0 and (sRetval contains ",")) Begin
41230>>>>        Move (Pos(",", sRetval))          to iEnd
41231>>>>        Decrement iEnd
41232>>>>    End
41232>>>>>
41232>>>>    If (iEnd <> 0) Begin
41234>>>>        Move (Left(sRetval, (iEnd -1)))   to sRetval
41235>>>>    End
41235>>>>>
41235>>>>    Move (Replace("=", sRetval, ""))      to sRetval
41236>>>>
41236>>>>    Function_Return (Trim(sRetval))
41237>>>>End_Function
41238>>>>
41238>>>>
41238>>>
41238>>>    Procedure Construct_Object
41240>>>        Handle ho
41240>>>        Forward Send Construct_Object
41242>>>
41242>>>        Move Self to ghoDbUpdateFunctionLibrary
41243>>>
41243>>>        Send CreateDbUpdateLibraryProperties
41244>>>        // If no ghoSQLConnectionHandler object has been created prior to this object,
41244>>>        // we will create one as it is used for all ConnectionID, ConnectionString
41244>>>        // etc settings.
41244>>>        If (ghoSQLConnectionHandler = 0) Begin
41246>>>            Get Create (RefClass(cSQLConnectionHandler)) to ho
41247>>>            Set phoSQLConnectionHandler to ho
41248>>>        End
41248>>>>
41248>>>
41248>>>    End_Procedure
41249>>>
41249>>>    Procedure End_Construct_Object
41251>>>        Forward Send End_Construct_Object
41253>>>    End_Procedure
41254>>>
41254>>>    // *** SQL Messages for making changes to the SQL back-end ***
41254>>>    //
41254>>>    // * Dummy function for the Studio's Code Explorer *
41254>>>    Function SQL_DATABASE_FUNCTIONS Returns Boolean
41256>>>        Function_Return False
41257>>>    End_Function
41258>>>
41258>>>    // Function for creating a new *Database*.
41258>>>    // Note: This is for creating SQL DATABASES - not tables!
41258>>>    // Returns True if successful.
41258>>>    // ToDo: Only works for MS-SQL...
41258>>>    Function SqlDatabaseCreate String sDriverID String sDatabase Boolean bUpdateConnectionString Boolean bPermanantly Returns Boolean
41260>>>        String sSQL sSQL1 sConnectionID sConnectionString 
41260>>>        String sCreateDatabaseKeyWord sSelectFromWhereName sCollation sCollateKeyWord
41260>>>        Handle hConnection hStmt hoSQLManager
41260>>>        Integer iFetchResult iDbType
41260>>>        Boolean bOK bMertechDriver
41260>>>
41260>>>        Get piDbType to iDbType
41261>>>        If (iDbType <> EN_DbTypeMSSQL) Begin
41263>>>            Error DFERR_PROGRAM "Sorry, the SqlDatabaseCreate function is currently only supported for MS-SQL"
41264>>>>
41264>>>            Function_Return False
41265>>>        End
41265>>>>
41265>>>
41265>>>        Get IsMertechDriver sDriverID to bMertechDriver
41266>>>        If (bMertechDriver = False) Begin
41268>>>            Get phoSQLManager to hoSQLManager
41269>>>        End
41269>>>>
41269>>>        Else Begin
41270>>>            Get _MertechSQLManagerHandle to hoSQLManager
41271>>>        End
41271>>>>
41271>>>        
41271>>>        Get psConnectionID     to sConnectionID
41272>>>        Get psConnectionString to sConnectionString
41273>>>        Move 0 to LastErr
41274>>>
41274>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
41275>>>        Get SqlConnect of hoSQLManager sDriverID sConnectionString to hConnection
41276>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
41277>>>        If (LastErr = CLIERR_LOGIN_UNSUCCESSFUL) Begin
41279>>>            Error DFERR_PROGRAM ("Login failed to the database server. The following connect string was used:\n" + sConnectionString)
41280>>>>
41280>>>            Function_Return False
41281>>>        End
41281>>>>
41281>>>
41281>>>        Get SqlOpen of hConnection to hStmt
41282>>>
41282>>>        If (hStmt = 0) Begin
41284>>>            Send SqlDisconnect of hoSQLManager
41285>>>            Error DFERR_PROGRAM CS_SQLConnectError
41286>>>>
41286>>>            Function_Return False
41287>>>        End
41287>>>>
41287>>>
41287>>>        Get _SqlFindKeyWord CI_SQLCreateDatabase to sCreateDatabaseKeyWord
41288>>>        Get _SqlSelectFromWhereName to sSelectFromWhereName
41289>>>        Move (sSelectFromWhereName + "='" + sDatabase + "'") to sSQL 
41290>>>        
41290>>>        // Check if database exists
41290>>>        Send SqlExecDirect of hStmt sSQL
41291>>>        Get SqlFetch of hStmt to iFetchResult
41292>>>        Send SqlClose of hStmt
41293>>>        Send SqlDisconnect of hConnection
41294>>>
41294>>>        // If database already exists we're out of here!
41294>>>        // Note that we return True as this is not an error.
41294>>>        If (iFetchResult > 0) Begin
41296>>>            Function_Return True
41297>>>        End
41297>>>>
41297>>>
41297>>>        // Database doesn't exist, create it.
41297>>>        If (iFetchResult = 0) Begin
41299>>>            Move (sCreateDatabaseKeyWord + " [" + sDatabase + "]") to sSQL1
41300>>>            Send Ignore_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41301>>>
41301>>>            Get psCollation to sCollation
41302>>>            If (sCollation <> "") Begin
41304>>>                Get _SqlFindKeyWord CI_SQLDatabaseCollation to sCollateKeyWord
41305>>>                Move (sSQL1 * String(sCollateKeyWord) * String(sCollation)) to sSQL1
41306>>>            End
41306>>>>
41306>>>
41306>>>            Send SqlUtilExecuteQuery sSQL1 sDriverID
41307>>>
41307>>>            Send Trap_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41308>>>            If (LastErr = CLIERR_GENERAL_ERROR) Begin
41310>>>               Function_Return False
41311>>>            End
41311>>>>
41311>>>
41311>>>            // We need to wait a short time for Sql to finish, especially Windows to write the new file to disk.
41311>>>            Sleep 1
41312>>>            Send SqlUtilExecuteQuery sSQL sDriverID
41313>>>        End
41313>>>>
41313>>>
41313>>>        // If used in e.g. the cDbUpdteHandler we want to change the login database name to
41313>>>        // the one we just created.
41313>>>        If (bUpdateConnectionString = True) Begin
41315>>>            Set psDatabase to sDatabase
41316>>>            //...and perhaps also the SQLConnections.ini file setting.
41316>>>            If (bPermanantly = True) Begin
41318>>>                If (ghoSQLConnectionHandler <> 0) Begin
41320>>>                    Get SQLIniFileSetDefaultConnection of ghoSQLConnectionHandler sConnectionID to bOK
41321>>>                End
41321>>>>
41321>>>            End
41321>>>>
41321>>>        End
41321>>>>
41321>>>
41321>>>        Function_Return (Err = False)
41322>>>    End_Function
41323>>>
41323>>>    // Backs up an SQL database to a folder of choice. If no path is passed the SQL default backup folder
41323>>>    // will be used.
41323>>>    Function SqlDatabaseBackupToDisk String sDatabase String sBackupName String sPath Boolean bShowProg Returns Boolean
41325>>>        Boolean bOK bExists bShowProgress
41325>>>        String sStatement sDriverID
41325>>>        tSQLScriptArray SQLScriptArray SQLScriptArrayPercentReady
41325>>>        tSQLScriptArray SQLScriptArray SQLScriptArrayPercentReady
41325>>>        Integer iDbType
41325>>>
41325>>>        If (sDatabase = "") Begin
41327>>>            Error DFERR_PROGRAM "The database name was not passed as a parameter to the 'SqlUtilBackupDatabaseToDisk' function"
41328>>>>
41328>>>            Function_Return False
41329>>>        End
41329>>>>
41329>>>        If (sBackupName = "") Begin
41331>>>            Error DFERR_PROGRAM "The database backup name was not passed as a parameter to the 'SqlUtilBackupDatabaseToDisk' function"
41332>>>>
41332>>>            Function_Return False
41333>>>        End
41333>>>>
41333>>>
41333>>>        // Create backup-folder if it doesn't exist
41333>>>        Get vFolderExists sPath to bExists
41334>>>        If (bExists = False) Begin
41336>>>            Get vCreateDirectory sPath to bOK
41337>>>            If (bOK = False) Begin
41339>>>                Error DFERR_PROGRAM ("Could not create database backup folder:" * sPath)
41340>>>>
41340>>>                Function_Return False
41341>>>            End
41341>>>>
41341>>>        End
41341>>>>
41341>>>        // Make sure the path ends with a back-slash
41341>>>        If (sPath <> "") Begin
41343>>>            Get vFolderFormat sPath to sPath
41344>>>        End
41344>>>>
41344>>>
41344>>>        Get psDriverID to sDriverID
41345>>>        Get piDbType   to iDbType
41346>>>        If (num_arguments > 3) Begin
41348>>>            Move bShowProg to bShowProgress
41349>>>        End
41349>>>>
41349>>>
41349>>>        Case Begin
41349>>>            Case (iDbType = EN_DbTypeMSSQL)
41351>>>                SQLIncludeScriptFile ..\Scripts\BackupMSSQLDatabase.sql as BackupMSSQLDatabase.sql
41351>>>                SQLIncludeScriptFile ..\Scripts\GetPercentageBackupCompletionMSSQL.sql as GetPercentageBackupCompletionMSSQL.sql
41351>>>                Get SqlUtilReadResource of ghoDbUpdateFunctionLibrary "BackupMSSQLDatabase.sql" sDriverID False to SQLScriptArray
41352>>>                Get SqlUtilReadResource of ghoDbUpdateFunctionLibrary "GetPercentageBackupCompletionMSSQL.sql" sDriverID False to SQLScriptArrayPercentReady
41353>>>
41353>>>                Move SQLScriptArray.sSQLScriptArray[0] to sStatement
41354>>>                Move (Replaces("DATABASE_NAME_XXX", sStatement, sDatabase))   to sStatement
41355>>>                Move (Replaces("BACKUP_PATH_XXX",   sStatement, sPath))       to sStatement
41356>>>                Move (Replaces("BACKUP_NAME_XXX",   sStatement, sBackupName)) to sStatement
41357>>>                Move sStatement to SQLScriptArray.sSQLScriptArray[0]
41358>>>                Get SqlUtilExecuteEmbeddedScript of ghoDbUpdateFunctionLibrary SQLScriptArray sDriverID False "" bShowProgress to bOK
41359>>>                Case Break
41360>>>            Case Else
41360>>>                Send Info_Box ("The SqlUtilBackupDatabaseToDisk function is currently not implemented for the driver:" * sDriverID + ". It would be great if you could spend a couple of minutes and add a little ESQL code snippet to make it work for that driver! Thanks for helping out.")
41361>>>        Case End
41361>>>
41361>>>        Function_Return bOK
41362>>>    End_Function
41363>>>
41363>>>    Function SqlDatabaseCollationQuery String sDatabase Returns String
41365>>>        Boolean bOK bExists 
41365>>>        String sStatement sDriverID sRetval sPrevious
41365>>>        tSQLScriptArray SQLScriptArray SQLScriptArrayPercentReady
41365>>>        tSQLScriptArray SQLScriptArray SQLScriptArrayPercentReady
41365>>>        Integer iDbType iRows iFetchResult iColumn
41365>>>        Handle hoSQLHandler hoSQLConnect hstmt 
41365>>>        tSQLConnection SQLConnection
41365>>>        tSQLConnection SQLConnection
41365>>>
41365>>>        If (sDatabase = "") Begin
41367>>>            Error DFERR_PROGRAM "The database name was not passed as a parameter to the 'SqlUtilDatabaseCollation' function"
41368>>>>
41368>>>            Function_Return False
41369>>>        End
41369>>>>
41369>>>        
41369>>>        Move "" to sRetval
41370>>>        Get psDriverID to sDriverID
41371>>>        Get piDbType   to iDbType
41372>>>
41372>>>        Case Begin
41372>>>            Case (iDbType = EN_DbTypeMSSQL)
41374>>>                SQLIncludeScriptFile ..\Scripts\QueryMSSQLCollation.sql as QueryMSSQLCollation.sql
41374>>>                Get SqlUtilReadResource of ghoDbUpdateFunctionLibrary "QueryMSSQLCollation.sql" sDriverID False to SQLScriptArray
41375>>>
41375>>>                Move SQLScriptArray.sSQLScriptArray[0] to sStatement
41376>>>                Move (Replaces("DATABASE_NAME_XXX", sStatement, sDatabase)) to sStatement
41377>>>                Get phoSQLManager to hoSQLHandler
41378>>>        
41378>>>                If (hoSQLHandler <> 0) Begin
41380>>>                    Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
41381>>>                    Get SQLConnect of hoSQLHandler SQLConnection.sDriverID SQLConnection.sConnectionString to hoSQLConnect
41382>>>        
41382>>>                    If (hoSQLConnect <> 0) Begin
41384>>>                        Get SQLOpen of hoSQLConnect to hstmt
41385>>>                        If (hstmt <> 0) Begin
41387>>>                            Send SqlExecDirect of hstmt sStatement
41388>>>                            Get SqlStmtAttribute of hstmt SqlSTMTATTRIB_ROWCOUNT to iRows
41389>>>                            Get SQLFetch of hstmt to iFetchResult
41390>>>                            If (iFetchResult <> 0) Begin
41392>>>                                Get SQLColumnValue of hstmt 2 to sRetval // Column 1 = Database Name, 2 = Collation Name.
41393>>>                            End
41393>>>>
41393>>>                            Send SQLClose of hstmt
41394>>>                        End
41394>>>>
41394>>>                        Send SQLDisconnect of hoSQLConnect
41395>>>                    End
41395>>>>
41395>>>                End
41395>>>>
41395>>>                Case Break
41396>>>            Case Else
41396>>>                Send Info_Box ("The SqlDatabaseCollationQuery function is currently not implemented for the driver:" * sDriverID + ". It would be great if you could spend a couple of minutes and add a little ESQL code snippet to make it work for that driver! Thanks for helping out.")
41397>>>        Case End
41397>>>
41397>>>        Function_Return sRetval
41398>>>    End_Function
41399>>>
41399>>>    Function SqlDatabaseCollationChange String sDatabase String sSQLCollation Returns Boolean
41401>>>        Boolean bOK bExists bMertechDriver
41401>>>        String sDriverID sSQL sSQL1 sConnectionID sConnectionString sSet sWith
41401>>>        String sAlterDatabaseKeyWord sCollateKeyWord sSQLCollationCheck sSingle_User sMulti_User sRollback sImmediate
41401>>>        Handle hConnection hStmt hoSQLManager
41401>>>        Integer iFetchResult iDbType
41401>>>
41401>>>        If (sDatabase = "") Begin
41403>>>            Error DFERR_PROGRAM "The database name was not passed as a parameter to the 'SqlDatabaseCollationChange' function"
41404>>>>
41404>>>            Function_Return False
41405>>>        End
41405>>>>
41405>>>        
41405>>>        If (sSQLCollation = "") Begin
41407>>>            Error DFERR_PROGRAM "The SQL Collation name was not passed as a parameter to the 'SqlDatabaseCollationChange' function"
41408>>>>
41408>>>            Function_Return False
41409>>>        End
41409>>>>
41409>>>        
41409>>>        Get psDriverID to sDriverID
41410>>>        Get piDbType   to iDbType
41411>>>
41411>>>        Get IsMertechDriver sDriverID to bMertechDriver
41412>>>        If (bMertechDriver = False) Begin
41414>>>            Get phoSQLManager to hoSQLManager
41415>>>        End
41415>>>>
41415>>>        Else Begin
41416>>>            Get _MertechSQLManagerHandle to hoSQLManager
41417>>>        End
41417>>>>
41417>>>        
41417>>>        Get psConnectionID     to sConnectionID
41418>>>        Get psConnectionString to sConnectionString
41419>>>        Move 0 to LastErr
41420>>>
41420>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
41421>>>        Get SqlConnect of hoSQLManager sDriverID sConnectionString to hConnection
41422>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
41423>>>        If (LastErr = CLIERR_LOGIN_UNSUCCESSFUL) Begin
41425>>>            Error DFERR_PROGRAM ("Login failed to the database server. The following connect string was used:\n" + sConnectionString)
41426>>>>
41426>>>            Function_Return False
41427>>>        End
41427>>>>
41427>>>
41427>>>        Get SqlOpen of hConnection to hStmt
41428>>>
41428>>>        If (hStmt = 0) Begin
41430>>>            Send SqlDisconnect of hoSQLManager
41431>>>            Error DFERR_PROGRAM CS_SQLConnectError
41432>>>>
41432>>>            Function_Return False
41433>>>        End
41433>>>>
41433>>>        
41433>>>        // Check if collation already exists   
41433>>>        Get SqlDatabaseCollationQuery sDatabase to sSQLCollationCheck
41434>>>        // If the current collate is the same as the new; do nothing.
41434>>>        If (sSQLCollation = sSQLCollationCheck) Begin
41436>>>            Function_Return True
41437>>>        End
41437>>>>
41437>>>            
41437>>>        Get _SqlFindKeyWord CI_SQLSet               to sSet
41438>>>        Get _SqlFindKeyWord CI_SQLWith              to sWith
41439>>>        Get _SqlFindKeyWord CI_SQLSingle_User       to sSingle_User
41440>>>        Get _SqlFindKeyWord CI_SQLMulti_User        to sMulti_User
41441>>>        Get _SqlFindKeyWord CI_SQLRollback          to sRollback
41442>>>        Get _SqlFindKeyWord CI_SQLIMMEDIATE         to sImmediate
41443>>>        Get _SqlFindKeyWord CI_SQLAlterDatabase     to sAlterDatabaseKeyWord
41444>>>        Get _SqlFindKeyWord CI_SQLDatabaseCollation to sCollateKeyWord
41445>>>        
41445>>>        // MS-SQL Syntax:
41445>>>        // ALTER DATABASE [database] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
41445>>>        // ALTER DATABASE [database] COLLATE SQL_1xCompat_CP850_CI_AS;
41445>>>        // ALTER DATABASE [database] SET MULTI_USER;
41445>>>        Move (              sAlterDatabaseKeyWord  * String(sDatabase) * String(sSet) * String(sSingle_User) * String(sWith) * String(sRollback) * String(sImmediate)) to sSQL
41446>>>        Move (sSQL * String(sAlterDatabaseKeyWord) * String(sDatabase) * String(sCollateKeyWord) * String(sSQLCollation)) to sSQL
41447>>>        Move (sSQL * String(sAlterDatabaseKeyWord) * String(sDatabase) * String(sSet) * String(sMulti_User)) to sSQL
41448>>>//        Move (sAlterDatabaseKeyWord * String(sDatabase) * String(sCollateKeyWord) * String(sSQLCollation)) to sSQL 
41448>>>        
41448>>>        Send Ignore_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41449>>>        Send SqlUtilExecuteQuery sSQL sDriverID False
41450>>>        Send Trap_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41451>>>        If (LastErr = CLIERR_GENERAL_ERROR) Begin
41453>>>           Function_Return False
41454>>>        End
41454>>>>
41454>>>
41454>>>        Function_Return (Err = False)
41455>>>    End_Function
41456>>>
41456>>>    // * Dummy function for the Studio's Code Explorer *
41456>>>    Function SQL_TABLE_FUNCTIONS Returns Boolean
41458>>>        Function_Return False
41459>>>    End_Function
41460>>>    // Converts from SQL to Embedded (DataFlex .dat files).
41460>>>    // To convert from SQL -> SQL (e.g. from Oracle - > MS SQL)
41460>>>    //   first use SQLTableConvertToEmbedded in one cDbUpdateVersion object,
41460>>>    //   and then use the ApiTableConvertToSQL method in a second cDbUpdateVersion object.
41460>>>    // Note: To convert an embedded table to SQL use ApiTableConvertToSQL.
41460>>>    Function SqlTableConvertToEmbedded Handle hTable Boolean bCpyDat Returns Boolean
41462>>>        Handle hToTable
41462>>>        Boolean bOK bExists bOpened bMertechDriver bCopyData
41462>>>        String sDriverID sPhysicalName sRootName sDisplayName
41462>>>        tSQLConnection SQLConnection
41462>>>        tSQLConnection SQLConnection
41462>>>        Integer iPos iMaxRecords
41462>>>
41462>>>        Get psDriverID to sDriverID
41463>>>        Get SqlUtilCheckIfTableHandleExists hTable sDriverID to bExists
41464>>>        If (bExists = False) Begin
41466>>>            Function_Return False
41467>>>        End
41467>>>>
41467>>>
41467>>>        If (num_arguments > 1) Begin
41469>>>            Move bCpyDat to bCopyData
41470>>>        End
41470>>>>
41470>>>        Else Begin
41471>>>            Move False to bCopyData
41472>>>        End
41472>>>>
41472>>>
41472>>>        Open hTable
41474>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
41477>>>        If (bOpened = False) Begin
41479>>>            Error DFERR_PROGRAM ("Could not open table number:" * String(hTable))
41480>>>>
41480>>>            Function_Return False
41481>>>        End
41481>>>>
41481>>>        Move 0 to hToTable
41482>>>
41482>>>        Move 16711679 to iMaxRecords
41483>>>        Get_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
41486>>>        Move (Pos(".", sDisplayName)) to iPos
41487>>>        If (iPos > 0) Begin
41489>>>            Move (Mid(sDisplayName, 200, (iPos +1))) to sDisplayName
41490>>>        End
41490>>>>
41490>>>        Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
41493>>>        Get _TableNameOnly sRootName                 to sRootName
41494>>>        Move (sRootName + ".dat")                    to sPhysicalName
41495>>>
41495>>>        If (ghoProgressBar <> 0) Begin
41497>>>            Send DoAdvance of ghoProgressBar
41498>>>            Set TableName_Text of ghoStatusPanel to ("Converting to Embedded - Table:" * String(sRootName) * "Number:" * String(hTable))
41499>>>        End
41499>>>>
41499>>>
41499>>>        Move False to Err
41500>>>
41500>>>        Structure_Start hToTable DATAFLEX_ID
41501>>>            Structure_Copy hTable to hToTable
41502>>>
41502>>>            Set_Attribute DF_FILE_PHYSICAL_NAME of hToTable to sPhysicalName
41505>>>            Set_Attribute DF_FILE_REUSE_DELETED of hToTable to DF_FILE_DELETED_REUSE
41508>>>            Set_Attribute DF_FILE_MULTIUSER     of hToTable to DF_FILE_USER_MULTI
41511>>>            Set_Attribute DF_FILE_TRANSACTION   of hToTable to DF_FILE_TRANSACTION_CLIENT_ATOMIC
41514>>>            Set_Attribute DF_FILE_MAX_RECORDS   of hToTable to iMaxRecords
41517>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
41518>>>
41518>>>        Structure_End hToTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
41520>>>
41520>>>        Set Action_Text of ghoStatusPanel to ""
41521>>>        Move (not(Err)) to bOK
41522>>>        If (bOK = True and bCopyData = True) Begin
41524>>>            Get ApiTableCopyData hTable sPhysicalName sRootName DATAFLEX_ID to bOK
41525>>>        End
41525>>>>
41525>>>
41525>>>        Get IsMertechDriver sDriverID to bMertechDriver
41526>>>        If (bMertechDriver = True) Begin
41528>>>            Open hTable
41530>>>        End
41530>>>>
41530>>>
41530>>>        // This must be after copying data...
41530>>>        If (Err = False) Begin
41532>>>            Set_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
41535>>>            Set_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
41538>>>        End
41538>>>>
41538>>>        Move (not(Err)) to bOK
41539>>>
41539>>>        Function_Return (bOK = True)
41540>>>    End_Function
41541>>>
41541>>>    // Creates an SQL Table at the SQL end by its filelist number;
41541>>>    // Also creates a 'DUMMY' column because SQL doesn't like to create a table with no columns!
41541>>>    Function SqlTableCreate Integer hTable Returns Boolean
41543>>>        String sTableName sSQLString sPath sCreateTable sDriverID
41543>>>        Integer iDbType
41543>>>        Boolean bExists
41543>>>
41543>>>        Get psDriverID to sDriverID
41544>>>        Get UtilTableHandleToString hTable to sTableName
41545>>>        Get SqlUtilCheckIfTableNameExists sTableName sDriverID to bExists
41546>>>        If (bExists = True) Begin
41548>>>            Function_Return False
41549>>>        End
41549>>>>
41549>>>
41549>>>        Get psDataPathFirstPart to sPath
41550>>>        Get vFilePathExists (sPath + String(sTableName) + ".int") to bExists
41551>>>
41551>>>        Get piDbType to iDbType
41552>>>        Get _SqlProperTableName sTableName to sTableName
41553>>>        Get _SqlFindKeyWord CI_SQLCreateTable iDbType to sCreateTable
41554>>>        Move (sCreateTable * String(sTableName) * "(Dummy Decimal(2,0))") to sSQLString
41555>>>
41555>>>        Move False to Err
41556>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41557>>>
41557>>>        Function_Return (Err = False)
41558>>>    End_Function
41559>>>
41559>>>    // Same as SqlTableCreate but creates an SQL Table at the SQL end by a table name;
41559>>>    // Also creates a 'DUMMY' column because SQL doesn't like to create a table with no columns!
41559>>>    Function SqlTableCreateByTableName String sTableName  Returns Boolean
41561>>>        String sSQLString sPath sCreateTable sDriverID
41561>>>        Integer iDbType
41561>>>        Boolean bExists
41561>>>
41561>>>        Get psDriverID to sDriverID
41562>>>        Get SqlUtilCheckIfTableNameExists sTableName sDriverID to bExists
41563>>>        If (bExists = True) Begin
41565>>>            Function_Return False
41566>>>        End
41566>>>>
41566>>>
41566>>>        Get psDataPathFirstPart to sPath
41567>>>        Get vFilePathExists (sPath + String(sTableName) + ".int") to bExists
41568>>>        If (bExists = True) Begin
41570>>>            // ToDo: What should we do if an .int file already exists?
41570>>>        End
41570>>>>
41570>>>
41570>>>        Get piDbType to iDbType
41571>>>        Get _SqlProperTableName sTableName to sTableName
41572>>>        Get _SqlFindKeyWord CI_SQLCreateTable iDbType to sCreateTable
41573>>>        Move (sCreateTable * String(sTableName) * "(Dummy Decimal(2,0))") to sSQLString
41574>>>
41574>>>        Move False to Err
41575>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41576>>>
41576>>>        Function_Return (Err = False)
41577>>>    End_Function
41578>>>
41578>>>    // First deletes the data cache file and then drops the passed SQL table.
41578>>>    // Note: The table needs to exist in filelist.cfg, and it must be possible to open it,
41578>>>    //       else try using the SqlTableRemoveByTableName message.
41578>>>    Function SqlTableRemove Integer hTable Returns Boolean
41580>>>        String sSQLString sPath sDropTable sTableName sDriverID
41580>>>        Integer iRetval iDbType
41580>>>        Boolean bExists bMertechDriver bOK
41580>>>
41580>>>        Get psDriverID to sDriverID
41581>>>        Get IsMertechDriver sDriverID to bMertechDriver
41582>>>        Get UtilTableHandleToString hTable to sTableName
41583>>>        Get SqlUtilCheckIfTableNameExists sTableName sDriverID to bExists
41584>>>        If (bExists = False) Begin
41586>>>            Function_Return False
41587>>>        End
41587>>>>
41587>>>
41587>>>        Get psDataPathFirstPart to sPath
41588>>>        Get UtilDeleteCacheFile sTableName to iRetval
41589>>>
41589>>>        Get piDbType to iDbType
41590>>>        Get _SqlProperTableName sTableName to sTableName
41591>>>        Get _SqlFindKeyWord CI_SQLDropTable iDbType to sDropTable
41592>>>        Move (sDropTable * String(sTableName)) to sSQLString
41593>>>
41593>>>        Move False to Err
41594>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41595>>>
41595>>>        // We also need to remove the cache-file since the table has been changed
41595>>>        Get UtilDeleteCacheFile sTableName to bOK
41596>>>
41596>>>        Function_Return (Err = False)
41597>>>    End_Function
41598>>>
41598>>>    // First deletes the data cache file and then drops the passed data table.
41598>>>    Function SqlTableRemoveByTableName String sTableName Returns Boolean
41600>>>        String sSQLString sPath sDropTable sVal sSchema sDriverID
41600>>>        Integer iRetval iDbType
41600>>>        Boolean bMertechDriver bOK
41600>>>
41600>>>        Get psDriverID to sDriverID
41601>>>        Get IsMertechDriver sDriverID to bMertechDriver
41602>>>        Get psDataPathFirstPart to sPath
41603>>>        Get UtilDeleteCacheFile sTableName to iRetval
41604>>>
41604>>>        Get piDbType to iDbType
41605>>>        Get _SqlFindKeyWord CI_SQLDropTable iDbType to sDropTable
41606>>>        Get psSchema to sSchema
41607>>>        If (sSchema = "") Begin
41609>>>            Get _SqlFindKeyWord CI_SQLDBO to sSchema
41610>>>        End
41610>>>>
41610>>>        Move (Uppercase(sTableName)) to sVal
41611>>>        If (not(sVal contains (sSchema + "."))) Begin
41613>>>            Move (Lowercase(sSchema) + "." + sTableName) to sTableName
41614>>>        End
41614>>>>
41614>>>        Move (sDropTable * String(sTableName)) to sSQLString
41615>>>
41615>>>        Move False to Err
41616>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41617>>>
41617>>>        // We also need to remove the cache-file since the table has been changed
41617>>>        Get UtilDeleteCacheFile sTableName to bOK
41618>>>
41618>>>        Function_Return (Err = False)
41619>>>    End_Function
41620>>>
41620>>>    // *** Sql View Messages ***
41620>>>
41620>>>    // First deletes the data cache file and then drops the passed Sql data view.
41620>>>    Function SqlViewRemove String sDataView Returns Boolean
41622>>>        String sDriverID sSQLString sDropViewKeyWord
41622>>>        Integer iRetval
41622>>>        Boolean bMertechDriver bOK
41622>>>
41622>>>        Get psDriverID to sDriverID
41623>>>        Get IsMertechDriver sDriverID to bMertechDriver
41624>>>        Get UtilDeleteCacheFile sDataView to iRetval
41625>>>
41625>>>        Get _SqlFindKeyWord CI_SQLDropView to sDropViewKeyWord
41626>>>        Move (sDropViewKeyWord * String(sDataView)) to sSQLString
41627>>>        Set psSQLStatementString to sSQLString
41628>>>
41628>>>        // As we don't check if the view exist or not, it might happen
41628>>>        // that it doesn't and that would through an error, so guard for that eventuality (just ignore it).
41628>>>        Move False to Err
41629>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
41630>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41631>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
41632>>>        Move 0 to LastErr
41633>>>
41633>>>        // We also need to remove the cache-file since the table has been changed
41633>>>        Get UtilDeleteCacheFile sDataView to bOK
41634>>>
41634>>>        Function_Return (Err = False)
41635>>>    End_Function
41636>>>
41636>>>    Function SqlTableRename Handle hTable String sCurrentTableName String sNewtTableName Returns Boolean
41638>>>        Boolean bOK
41638>>>        Integer iDbType
41638>>>        String sDriverID sAlterTable sRenameTable sSQLTo sSQLString
41638>>>
41638>>>        Get psDriverID to sDriverID
41639>>>        Get piDbType   to iDbType
41640>>>
41640>>>        Case Begin
41640>>>            Case (iDbType = EN_DbTypeDB2)
41642>>>                Get _SqlFindKeyWord CI_SQLRenameTable to sRenameTable
41643>>>                Get _SqlFindKeyWord CI_SQLTo          to sSQLTo
41644>>>                Move (sRenameTable * sCurrentTableName * sSQLTo * sNewtTableName) to sSQLString
41645>>>            Break
41646>>>
41646>>>            Case (iDbType = EN_DbTypeMSSQL)
41649>>>                Get _SqlFindKeyWord CI_SQLRenameTable to sRenameTable
41650>>>                Get _SqlFindKeyWord CI_SQLTo          to sSQLTo
41651>>>                Move (sRenameTable * "'" - sCurrentTableName - "', '" - sNewtTableName - "'") to sSQLString
41652>>>            Break
41653>>>
41653>>>            Case (iDbType = EN_DbTypeOracle)
41656>>>                Get _SqlFindKeyWord CI_SQLRenameTable to sRenameTable
41657>>>                Get _SqlFindKeyWord CI_SQLTo          to sSQLTo
41658>>>                Move (sRenameTable * sCurrentTableName * sSQLTo * sNewtTableName) to sSQLString
41659>>>            Break
41660>>>
41660>>>            Case (iDbType = EN_DbTypePostgre)
41663>>>                Get _SqlFindKeyWord CI_SQLAlterTable  to sAlterTable
41664>>>                Get _SqlFindKeyWord CI_SQLRenameTable to sRenameTable
41665>>>                Get _SqlFindKeyWord CI_SQLTo          to sSQLTo
41666>>>                Move (sAlterTable * sCurrentTableName * sRenameTable * sSQLTo * sNewtTableName) to sSQLString
41667>>>            Break
41668>>>
41668>>>            Case (iDbType = EN_DbTypeMySQL)
41671>>>                Get _SqlFindKeyWord CI_SQLRenameTable to sRenameTable
41672>>>                Get _SqlFindKeyWord CI_SQLTo          to sSQLTo
41673>>>                Move (sRenameTable * sCurrentTableName * sSQLTo * sNewtTableName) to sSQLString
41674>>>            Break
41675>>>        Case End
41675>>>
41675>>>        Move False to Err
41676>>>        Send SqlUtilExecuteQuery sSQLString sDriverID
41677>>>        Move (Err = False) to bOK
41678>>>
41678>>>        Function_Return bOK
41679>>>    End_Function
41680>>>
41680>>>    // * Dummy function for the Studio's Code Explorer *
41680>>>    Function SQL_COLUMN_FUNCTIONS Returns Boolean
41682>>>        Function_Return False
41683>>>    End_Function
41684>>>
41684>>>    // Sample: Get SqlColumnAdd MyTable.File_Number "NewColumnName" True "InitValue" DF_ASCII_DUF 35
41684>>>    Function SqlColumnAdd Integer hTable String sColumnName Integer iDataType Integer iLen Integer iDec Boolean bInitVal String sColVal Returns Boolean
41686>>>        Integer iLength iDecimals
41686>>>        String sColumnValue
41686>>>        String sTableName sDriverID
41686>>>        Boolean bOK bInitializeValue
41686>>>
41686>>>        Get psDriverID to sDriverID
41687>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41688>>>        If (bOK = False) Begin
41690>>>            Function_Return False
41691>>>        End
41691>>>>
41691>>>
41691>>>        Get UtilTableHandleToString hTable to sTableName
41692>>>        If (sTableName = "") Begin
41694>>>            Function_Return False
41695>>>        End
41695>>>>
41695>>>
41695>>>        If (num_arguments > 3) Begin
41697>>>            Move iLen     to iLength
41698>>>            Move iDec     to iDecimals
41699>>>            Move bInitVal to bInitializeValue
41700>>>            Move sColVal  to sColumnValue
41701>>>        End
41701>>>>
41701>>>
41701>>>        Get SqlColumnAddByTableName sTableName sColumnName iDataType iLen iDecimals bInitializeValue sColumnValue to bOK
41702>>>
41702>>>        Function_Return (bOK = True)
41703>>>    End_Function
41704>>>
41704>>>    // Sample: Get SqlColumnAddByTableName "MyTable" "NewColumnName" DF_ASCII_DUF 35 0 True "InitValue"
41704>>>    Function SqlColumnAddByTableName String sTableName String sColumnName Integer iDataType Integer iLen Integer iDec Boolean bInitVal String sColVal Returns Boolean
41706>>>        Integer iDbType iLength iDecimals iDriver
41706>>>        String sStmt sAlterTable sAddColumn sVal sDataType sLengthAndDecimals sColumnValue
41706>>>        String sDriverID sNotNull
41706>>>        Boolean bOK bInitializeValue bRetval bFixed bDriverIgnoreErrorState
41706>>>        Handle hTable
41706>>>
41706>>>        Get psDriverID to sDriverID
41707>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41708>>>        If (bOK = False) Begin
41710>>>            Function_Return False
41711>>>        End
41711>>>>
41711>>>
41711>>>        Get UtilTableNameToHandle sTableName to hTable
41712>>>        If (hTable = 0) Begin
41714>>>            Get NextFreeFilelistSlot to hTable
41715>>>        End
41715>>>>
41715>>>
41715>>>        Get piDbType to iDbType
41716>>>        // If a field/column already exists; we just ignore the request to not add unneccesary errors to the log.
41716>>>        Get _SqlFindColumnName sTableName sColumnName to sVal
41717>>>        If (Uppercase(sVal) = Uppercase(sColumnName)) Begin
41719>>>            Function_Return False
41720>>>        End
41720>>>>
41720>>>
41720>>>        Get DriverIndex sDriverID to iDriver
41721>>>        Get_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41724>>>        Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to True
41727>>>
41727>>>        Get UtilColumnTypeToString sDriverID iDbType iDataType to sDataType
41728>>>        If (num_arguments > 3) Begin
41730>>>            Move iLen     to iLength
41731>>>            Move iDec     to iDecimals
41732>>>            Move bInitVal to bInitializeValue
41733>>>            Move sColVal  to sColumnValue
41734>>>        End
41734>>>>
41734>>>
41734>>>        Get _SqlProperTableName sTableName   to sTableName
41735>>>        Get _SqlFindKeyWord CI_SQLAlterTable to sAlterTable
41736>>>        Get _SqlFindKeyWord CI_SQLAdd        to sAddColumn
41737>>>        Get SQLUtilDefaultNullValue sDriverID iDbType iDataType to sNotNull
41738>>>
41738>>>        Get UtilColumnTypeFixed sDriverID iDbType iDataType to bFixed
41739>>>        If (bFixed = False) Begin
41741>>>            Get _SqlFormatLengthAndDecimalAsString iLength iDecimals to sLengthAndDecimals
41742>>>        End
41742>>>>
41742>>>        Move (sAlterTable * sTableName * sAddColumn * sColumnName * sDataType + sLengthAndDecimals * sNotNull) to sStmt
41743>>>
41743>>>        Move False to Err
41744>>>        Send SqlUtilExecuteQuery sStmt sDriverID
41745>>>
41745>>>        If (bInitializeValue = True and Err = False) Begin
41747>>>            Get SQLColumnUpdateValue hTable sColumnName sColumnValue to bRetval
41748>>>        End
41748>>>>
41748>>>
41748>>>        If (Err = False) Begin
41750>>>            Get SqlUtilAdjustAuxFiles hTable sTableName sColumnName to bOK
41751>>>        End
41751>>>>
41751>>>
41751>>>        Move (not(Err)) to bRetval
41752>>>
41752>>>        // We also need to remove the cache-file since the table has been changed
41752>>>        Get UtilDeleteCacheFile sTableName to bOK
41753>>>        Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41756>>>
41756>>>        Function_Return bRetval
41757>>>    End_Function
41758>>>
41758>>>    // To update all current rows for a table column with a common value.
41758>>>    Function SqlColumnUpdateValue Handle hTable String sColumnName String sColumnValue Returns Boolean
41760>>>        String sDriverID sTableName sUpdate sSet sNoCountOn sStmt
41760>>>        Boolean bRetval bSQLDriver
41760>>>        Integer iCurrErr
41760>>>
41760>>>        Move False to bRetval
41761>>>        Get psDriverID to sDriverID
41762>>>        Get IsSQLDriver sDriverID to bSQLDriver
41763>>>        If (bSQLDriver = False) Begin
41765>>>            Function_Return bRetval
41766>>>        End
41766>>>>
41766>>>        Get UtilTableHandleToString hTable to sTableName
41767>>>
41767>>>        Move Err to iCurrErr
41768>>>        Move False to Err
41769>>>        Get _SqlFindKeyWord CI_SQLUpdate       to sUpdate
41770>>>        Get _SqlFindKeyWord CI_SQLSet          to sSet
41771>>>        Get _SqlFindKeyWord CI_SQLSetNoCountOn to sNoCountOn
41772>>>        Move (sNoCountOn * sUpdate * sTableName * sSet * sColumnName + "='" + sColumnValue + "'") to sStmt
41773>>>        Send SqlUtilExecuteQuery sStmt sDriverID
41774>>>        Move (Err = False) to bRetval
41775>>>        Move iCurrErr to Err
41776>>>
41776>>>        Function_Return bRetval
41777>>>    End_Function
41778>>>
41778>>>    // The fourth & fifth arguments are optional, depending on the iDataType
41778>>>    // passed. For e.g. a DF_ASCII the iLen must be passed.                     // Optional: // Optional:
41778>>>    Function SqlColumnChange Handle hTable String sColumnName Integer iDataType Integer iLen Integer iDec Returns Boolean
41780>>>        String sDriverID sTableName
41780>>>        Boolean bOK
41780>>>
41780>>>        Get psDriverID to sDriverID
41781>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41782>>>        If (bOK = False) Begin
41784>>>            Function_Return False
41785>>>        End
41785>>>>
41785>>>
41785>>>        Get UtilTableHandleToString hTable to sTableName
41786>>>        Get SqlColumnChangeByTableName sTableName sColumnName iDataType iLen iDec to bOK
41787>>>
41787>>>        Function_Return (Err = False)
41788>>>    End_Function
41789>>>
41789>>>    // Same as SqlColumnChange but instead of passing a filelist number; pass the table name as a string.
41789>>>    // The fourth & fifth arguments are optional, depending on the iDataType
41789>>>    // passed. For e.g. a DF_ASCII the iLen must be passed.                     // Optional: // Optional:
41789>>>    Function SqlColumnChangeByTableName String sTableName String sColumnName Integer iDataType Integer iLen Integer iDec Returns Boolean
41791>>>        Integer iDbType iLength iDecimals
41791>>>        String sDriverID sStmt sAlterTable sAlterColumn sDataType sLengthAndDecimals sNotNull
41791>>>        Boolean bExists bOK bFixed
41791>>>        Handle hTable
41791>>>
41791>>>        Get psDriverID to sDriverID
41792>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41793>>>        If (bOK = False) Begin
41795>>>            Function_Return False
41796>>>        End
41796>>>>
41796>>>
41796>>>        Get UtilTableNameToHandle sTableName to hTable
41797>>>        If (hTable = 0) Begin
41799>>>            Get NextFreeFilelistSlot to hTable
41800>>>        End
41800>>>>
41800>>>        Get SQLUtilColumnExists sTableName sColumnName to bExists
41801>>>        If (bExists = True) Begin
41803>>>            Function_Return False
41804>>>        End
41804>>>>
41804>>>
41804>>>        If (num_arguments > 3) Begin
41806>>>            Move iLen to iLength
41807>>>        End
41807>>>>
41807>>>        If (num_arguments > 4) Begin
41809>>>            Move iDec to iDecimals
41810>>>        End
41810>>>>
41810>>>
41810>>>        Get piDbType to iDbType
41811>>>        Get UtilColumnTypeToString sDriverID iDbType iDataType to sDataType
41812>>>
41812>>>        Move False to Err
41813>>>        Get _SqlProperTableName sTableName    to sTableName
41814>>>        Get _SqlFindKeyWord CI_SQLAlterTable  to sAlterTable
41815>>>        Get _SqlFindKeyWord CI_SQLAlterColumn to sAlterColumn
41816>>>        Get SQLUtilDefaultNullValue sDriverID iDbType iDataType to sNotNull
41817>>>
41817>>>        Get UtilColumnTypeFixed sDriverID iDbType iDataType to bFixed
41818>>>        If (bFixed = False) Begin
41820>>>            Get _SqlFormatLengthAndDecimalAsString iLength iDecimals to sLengthAndDecimals
41821>>>        End
41821>>>>
41821>>>
41821>>>        Move (sAlterTable * sTableName * sAlterColumn * sColumnName * sDataType + sLengthAndDecimals * sNotNull) to sStmt
41822>>>        Send SqlUtilExecuteQuery sStmt sDriverID
41823>>>
41823>>>        // We also need to remove the cache-file since the table has been changed
41823>>>        Get UtilDeleteCacheFile sTableName to bOK
41824>>>
41824>>>        Function_Return (Err = False)
41825>>>    End_Function
41826>>>
41826>>>    Function SqlColumnDefaultValue Handle hTable Integer iColumn String sValue Returns Boolean
41828>>>        Boolean bOK bErr bIsSQLDriver
41828>>>        String sDriverID  
41828>>>        Integer iDataType
41828>>>
41828>>>        Get psDriverID to sDriverID
41829>>>        Get IsSQLDriver sDriverID to bIsSQLDriver
41830>>>        If (bIsSQLDriver = False) Begin
41832>>>            Function_Return False
41833>>>        End
41833>>>>
41833>>>
41833>>>        Move Err to bErr
41834>>>        Move False to bErr
41835>>>
41835>>>        // There seems to be a problem with the ODBC_DRV driver that sometimes
41835>>>        // inserts randomly character(10) and spaces, so we correct from that here:
41835>>>        Move (Replaces(Character(10), Trim(sValue), "")) to sValue
41836>>>        Get_Attribute DF_FIELD_TYPE of hTable iColumn to iDataType 
41839>>>        If (iDataType = DF_BCD and Left(sValue, 1 <> "[")) Begin
41841>>>            Move ("[" + String(sValue) + "]") to sValue
41842>>>        End
41842>>>>
41842>>>        
41842>>>        Set_Attribute DF_FIELD_DEFAULT_VALUE of hTable iColumn to sValue
41845>>>        Move (not(Err)) to bOK
41846>>>        Move bErr to Err
41847>>>
41847>>>        Function_Return bOK
41848>>>    End_Function
41849>>>
41849>>>    Function SqlColumnNullable Handle hTable Integer iColumn Boolean bNullable Returns Boolean
41851>>>        Boolean bOK bErr bCurrentState bOpen bIsSQLDriver
41851>>>        String sDriverID
41851>>>
41851>>>        Get psDriverID to sDriverID
41852>>>        Get IsSQLDriver sDriverID to bIsSQLDriver
41853>>>        If (bIsSQLDriver = False) Begin
41855>>>            Function_Return False
41856>>>        End
41856>>>>
41856>>>
41856>>>        Move Err to bErr
41857>>>        Move False to bErr
41858>>>        Get_Attribute DF_FIELD_NULL_ALLOWED of hTable iColumn to bCurrentState
41861>>>        If (bNullable = bCurrentState) Begin
41863>>>            Function_Return True
41864>>>        End
41864>>>>
41864>>>
41864>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
41867>>>        If (bOpen = False) Begin
41869>>>            Get AutoConnectionIDLogin to bOK
41870>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
41871>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_INTERMEDIATE_FILE
41872>>>            Send Ignore_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41873>>>            Open hTable
41875>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
41876>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_INTERMEDIATE_FILE
41877>>>            Send Trap_Error of Error_Object_Id CLIERR_GENERAL_ERROR
41878>>>            Get_Attribute DF_FILE_OPENED of hTable to bOpen
41881>>>        End
41881>>>>
41881>>>        If (bOpen = True) Begin
41883>>>            Structure_Start hTable sDriverID
41884>>>                Set_Attribute DF_FIELD_NULL_ALLOWED of hTable iColumn to bNullable
41887>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
41888>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
41890>>>            Set Action_Text of ghoStatusPanel to ""
41891>>>        End
41891>>>>
41891>>>
41891>>>        Move (not(Err)) to bOK
41892>>>        Move bErr to Err
41893>>>
41893>>>        Function_Return bOK
41894>>>    End_Function
41895>>>
41895>>>    // Drop column by its table handle
41895>>>    Function SqlColumnRemove Handle hTable String sColumnName Returns Boolean
41897>>>        String sDriverID sTableName
41897>>>        Boolean bOK
41897>>>
41897>>>        Get psDriverID to sDriverID
41898>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41899>>>        If (bOK = False) Begin
41901>>>            Function_Return False
41902>>>        End
41902>>>>
41902>>>
41902>>>        Get UtilTableHandleToString hTable to sTableName
41903>>>        If (sTableName = "") Begin
41905>>>            Function_Return False
41906>>>        End
41906>>>>
41906>>>
41906>>>        Get SqlColumnRemoveByTableName sTableName sColumnName to bOK
41907>>>
41907>>>        Function_Return (bOK = True)
41908>>>    End_Function
41909>>>
41909>>>    // Drop column by its table name as a string.
41909>>>    Function SqlColumnRemoveByTableName String sTableName String sColumnName Returns Boolean
41911>>>        Integer iDbType iDriver
41911>>>        String sDriverID sStmt sAlterTable sDropColumn
41911>>>        Boolean bExists bOK bRetval bDriverIgnoreErrorState
41911>>>        Handle hTable
41911>>>
41911>>>        Get psDriverID to sDriverID
41912>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41913>>>        If (bOK = False) Begin
41915>>>            Function_Return False
41916>>>        End
41916>>>>
41916>>>
41916>>>        Get DriverIndex sDriverID to iDriver
41917>>>        Get_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41920>>>        Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to True
41923>>>
41923>>>        Get UtilTableNameToHandle sTableName to hTable
41924>>>        If (hTable <> 0) Begin
41926>>>            Get SQLUtilColumnExists sTableName sColumnName to bExists
41927>>>            If (bExists = False) Begin
41929>>>                Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41932>>>                Function_Return False
41933>>>            End
41933>>>>
41933>>>        End
41933>>>>
41933>>>
41933>>>        Get piDbType to iDbType
41934>>>        If (iDbType = EN_DbTypeMSSQL) Begin
41936>>>            Get _SqlUtilRemoveTableColumnMSSQL sTableName sColumnName to bOK
41937>>>            Get UtilDeleteCacheFile sTableName to bOK
41938>>>            Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41941>>>            Function_Return bOK
41942>>>        End
41942>>>>
41942>>>
41942>>>        Move False to Err
41943>>>        Get _SqlProperTableName sTableName    to sTableName
41944>>>        Get _SqlFindKeyWord CI_SQLAlterTable  to sAlterTable
41945>>>        Get _SqlFindKeyWord CI_SQLDropColumn  to sDropColumn
41946>>>
41946>>>        Move (sAlterTable * sTableName * sDropColumn * sColumnName) to sStmt
41947>>>        Send SqlUtilExecuteQuery sStmt sDriverID
41948>>>        Move (not(Err)) to bRetval
41949>>>
41949>>>        // We also need to remove the cache-file since the table has been changed
41949>>>        Get UtilDeleteCacheFile sTableName to bOK
41950>>>        Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to bDriverIgnoreErrorState
41953>>>
41953>>>        Function_Return bRetval
41954>>>    End_Function
41955>>>
41955>>>    // Rename a field/column by table handle (filelist number)
41955>>>    Function SqlColumnRename Integer hTable String sColumnName String sNewColumnName Returns Boolean
41957>>>        String sDriverID sTableName
41957>>>        Boolean bOK
41957>>>
41957>>>        Get psDriverID to sDriverID
41958>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41959>>>        If (bOK = False) Begin
41961>>>            Function_Return False
41962>>>        End
41962>>>>
41962>>>
41962>>>        Get UtilTableHandleToString hTable to sTableName
41963>>>        Get SqlColumnRenameByTableName sTableName sColumnName sNewColumnName to bOK
41964>>>
41964>>>        Function_Return (Err = False)
41965>>>    End_Function
41966>>>
41966>>>    // Rename a field/column by table name.
41966>>>    Function SqlColumnRenameByTableName String sTableName String sColumnName String sNewColumnName Returns Boolean
41968>>>        Integer iDbType iDataType
41968>>>        String sDriverID sStmt sAlterTable sRenameColumn sVal sColumnKeyWord sOrgTableName sDatabase sDataType
41968>>>        Boolean bOK bRetval
41968>>>        Handle hTable
41968>>>
41968>>>        Move sTableName to sOrgTableName
41969>>>        Get psDriverID to sDriverID
41970>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
41971>>>        If (bOK = False) Begin
41973>>>            Function_Return False
41974>>>        End
41974>>>>
41974>>>
41974>>>        Get _SqlFindColumnName sTableName sColumnName to sVal
41975>>>        If (sVal = "") Begin
41977>>>            Function_Return False
41978>>>        End
41978>>>>
41978>>>
41978>>>        Get piDbType to iDbType
41979>>>        Get _SqlFindKeyWord CI_SQLColumn       to sColumnKeyWord
41980>>>        Get _SqlProperTableName sTableName     to sTableName
41981>>>        Get _SqlFindKeyWord CI_SQLAlterTable   to sAlterTable
41982>>>        Get _SqlFindKeyWord CI_SQLRenameColumn to sRenameColumn
41983>>>
41983>>>        Case Begin
41983>>>            Case (iDbType = EN_dbTypeMSSQL)
41985>>>                Move (sRenameColumn * "'" + sTableName + "." + sColumnName + "'," * "'" + sNewColumnName + "'," * "'" + sColumnKeyWord + "'") to sStmt
41986>>>                Case Break
41987>>>            // Alter table "SYS"."Customer" rename column "Comments" to "NewColumnName"
41987>>>            Case (iDbType = EN_dbTypeOracle)
41990>>>                Move (sAlterTable * '"' + sTableName + '"' * sRenameColumn * '"' + sColumnName + '"' * "TO" * '"' + sNewColumnName + '"') to sStmt
41991>>>                Case Break
41992>>>            // ALTER TABLE Schema.TableName RENAME COLUMN "deptnumb" TO "deptnum"
41992>>>            Case (iDbType = EN_dbTypeDB2)
41995>>>                Move (sAlterTable *  sTableName * sRenameColumn * '"' + sColumnName + '"' * "TO" * '"' + sNewColumnName + '"') to sStmt
41996>>>                Case Break
41997>>>            // ALTER TABLE "Customer" RENAME COLUMN "Comments" TO "NewColumnName"
41997>>>            Case (iDbType = EN_dbTypePostgre)
42000>>>                Move sOrgTableName to sTableName
42001>>>                Move (sAlterTable * '"' + sTableName + '"' * sRenameColumn * '"' + sColumnName + '"' * "TO" * '"' + sNewColumnName + '"') to sStmt
42002>>>                Case Break
42003>>>            Case (iDbType = EN_dbTypeMySQL)
42006>>>                // ALTER TABLE orderentry.customer CHANGE Comments NewColumnName text // Note: The last token is the column type!
42006>>>                Move sOrgTableName to sTableName
42007>>>                Get psDatabase to sDatabase
42008>>>                Get UtilTableNameToHandle sTableName to hTable
42009>>>                If (hTable = 0) Begin
42011>>>                    Get UtilTableOpen hTable sTableName DF_SHARE to bOK
42012>>>                    If (bOK = False) Begin
42014>>>                        Function_Return False
42015>>>                    End
42015>>>>
42015>>>                    Get NextFreeFilelistSlot to hTable
42016>>>                End
42016>>>>
42016>>>                Else Begin
42017>>>                    Open hTable
42019>>>                End
42019>>>>
42019>>>                Get SQLColumnType sDriverID hTable sTableName sColumnName to iDataType
42020>>>                Get UtilColumnTypeToString sDriverID iDbType iDataType    to sDataType
42021>>>                Move (sAlterTable * sDatabase + "." + sTableName * sRenameColumn * sColumnName * sNewColumnName * sDataType) to sStmt
42022>>>                Case Break
42023>>>            Case Else
42023>>>                Move (sAlterTable * "'" + sTableName + "'" * sRenameColumn * "'" + sTableName + "." + sColumnName + "'" * "TO" * "'" + sNewColumnName + "'") to sStmt
42024>>>        Case End
42024>>>
42024>>>        Move False to Err
42025>>>        Send SqlUtilExecuteQuery sStmt sDriverID
42026>>>        Move (Err = False) to bRetval
42027>>>        // We also need to remove the cache-file since the table has been changed
42027>>>        Get UtilDeleteCacheFile sTableName to bOK
42028>>>
42028>>>        Function_Return bRetval
42029>>>    End_Function
42030>>>
42030>>>    Function SqlColumnType String sDriverID Handle hTable String sTableName String sColumnName Returns Integer
42032>>>        Handle hoSQLHandler hSQLConnect hStmt
42032>>>        Boolean bMertechDriver
42032>>>        Integer iNumCols iCount iDataType
42032>>>        String sValue
42032>>>
42032>>>        Get IsMertechDriver sDriverID to bMertechDriver
42033>>>        If (bMertechDriver = False) Begin
42035>>>            Get phoSQLManager to hoSQLHandler
42036>>>        End
42036>>>>
42036>>>        Else Begin
42037>>>            Get _MertechSQLManagerHandle to hoSQLHandler
42038>>>        End
42038>>>>
42038>>>
42038>>>        Get SQLFileConnect of hoSQLHandler hTable to hSQLConnect
42039>>>        If (hSQLConnect <> 0) Begin
42041>>>            Get SQLOpen of hSQLConnect to hStmt
42042>>>            If (hStmt <> 0) Begin
42044>>>                Send SQLExecDirect of hStmt ("select * from" * sTableName)
42045>>>
42045>>>                Get SQLStmtAttribute of hStmt SQLSTMTATTRIB_COLUMNCOUNT to iNumCols
42046>>>                For iCount from 1 to iNumCols
42052>>>>
42052>>>                    Get SQLColAttribute of hStmt iCount SQLCOLATTRIB_LABEL to sValue
42053>>>                    If (Lowercase(sValue) = Lowercase(sColumnName)) Begin
42055>>>                        Get SQLColAttribute of hStmt iCount SQLCOLATTRIB_SQLTYPE to iDataType
42056>>>                        Move iNumCols to iCount // We're out of here
42057>>>                    End
42057>>>>
42057>>>                Loop
42058>>>>
42058>>>
42058>>>                Send SQLClose of hStmt
42059>>>            End
42059>>>>
42059>>>            Send SQLDisconnect of hSQLConnect
42060>>>        End
42060>>>>
42060>>>
42060>>>        Function_Return iDataType
42061>>>    End_Function
42062>>>
42062>>>    // * Dummy function for the Studio's Code Explorer *
42062>>>    Function SQL_EXECUTE_FUNCTIONS Returns Boolean
42064>>>        Function_Return False
42065>>>    End_Function
42066>>>
42066>>>    Procedure SqlUtilExecuteQuery String sStmt String sDriverID Boolean bShowProgr
42068>>>        String sConnectionString sMessage
42068>>>        Handle hoSqlHandler hoSQLConnect hoStmt hoError
42068>>>        Integer i iMsgs iFetchResult iRowType iRows iErr iMessage iLastErr
42068>>>        String[] sMsg aSQLQueryMessages aSQLFetchResults
42071>>>        DateTime dtQueryExecStart dtQueryExecEnd dtFetchStart dtFetchEnd
42071>>>        TimeSpan tsQuery tsFetch
42071>>>        tSqlErrorArray aSqlErrorArray
42071>>>        tSqlErrorArray aSqlErrorArray
42071>>>        Boolean bOK bMertechDriver bShowProgress
42071>>>        tSQLConnection SQLConnection
42071>>>        tSQLConnection SQLConnection
42071>>>
42071>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
42072>>>        If (bOK = False) Begin
42074>>>            Procedure_Return
42075>>>        End
42075>>>>
42075>>>
42075>>>        If (num_arguments > 2) Begin
42077>>>            Move bShowProgr to bShowProgress
42078>>>        End
42078>>>>
42078>>>
42078>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
42079>>>
42079>>>        Get IsMertechDriver sDriverID to bMertechDriver
42080>>>        If (bMertechDriver = True) Begin
42082>>>            Get _MertechSQLConnect sDriverID SQLConnection.sServer SQLConnection.sUserID SQLConnection.sPassword to hoSQLConnect
42083>>>        End
42083>>>>
42083>>>        If (bMertechDriver = False) Begin
42085>>>            Get phoSQLManager to hoSqlHandler
42086>>>            Send SqlSetConnect of hoSqlHandler sDriverID SQLConnection.sConnectionString
42087>>>            Get SqlConnect     of hoSqlHandler "" "" to hoSQLConnect
42088>>>        End
42088>>>>
42088>>>
42088>>>        If (hoSQLConnect <> 0) Begin
42090>>>            Get SqlOpen of hoSQLConnect to hoStmt
42091>>>            If (hoStmt <> 0) Begin
42093>>>                // record starting date/time stamp
42093>>>                Move (CurrentDateTime()) to dtQueryExecStart
42094>>>                // turn on error handling if enabled
42094>>>                If (pbHandleQueryErrors(Self)) Begin
42096>>>                    Set pbSqlError to False
42097>>>                    Set paSqlErrorArray to aSqlErrorArray
42098>>>                    Move Error_Object_Id to hoError 
42099>>>                    If (ghoDbUpdateHandler <> 0) Begin
42101>>>                        Move ghoDbUpdateHandler to Error_Object_Id
42102>>>                    End                                           
42102>>>>
42102>>>                    Else Begin
42103>>>                        Move Self to Error_Object_Id
42104>>>                    End
42104>>>>
42104>>>                End
42104>>>>
42104>>>
42104>>>                // Before we execute the statement; save it so we can display the faulty statement in the error log.
42104>>>                Set psSQLStatementString to sStmt 
42105>>>                Send Cursor_Wait of Cursor_Control
42106>>>                Send SqlExecDirect of hoStmt sStmt
42107>>>                Send Cursor_Ready of Cursor_Control
42108>>>
42108>>>                If (pbHandleQueryErrors(Self)) Begin
42110>>>                    Move hoError to Error_Object_Id
42111>>>                End
42111>>>>
42111>>>
42111>>>                Move 0 to iMsgs
42112>>>                // ToDo: There seems to be some issues with this code and Mertech drivers that makes
42112>>>                // the debugger crash in some cases like an error in the ESQL statement; so we exclude it for now.
42112>>>                If (bMertechDriver = False) Begin
42114>>>                    Move Err to iErr
42115>>>                    Move LastErr to iLastErr
42116>>>                    Get SqlStmtAttribute of hoStmt SQLSTMTATTRIB_NUMMESSAGES   to iMsgs
42117>>>                    Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_ROWCOUNT      to iRows
42118>>>                    Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_ROWCOUNT_TYPE to iRowType
42119>>>                    Send _SqlColumnInfo hoStmt
42120>>>                    Send Ignore_Error of Error_Object_Id 12289
42121>>>                    Set Error_Report_Mode to DUF_ERROR_NO_REPORT
42122>>>                    Repeat
42122>>>>
42122>>>                        Get SqlFetch of hoStmt to iFetchResult
42123>>>                        If (iFetchResult <> 0) Begin
42125>>>                            Get SQLColumnValue of hoStmt 1 to aSQLFetchResults[SizeOfArray(aSQLFetchResults)]
42126>>>                        End
42126>>>>
42126>>>                    Until (iFetchResult = 0)
42128>>>                    Send Trap_Error of Error_Object_Id 12289
42129>>>                    Set Error_Report_Mode to DUF_ERROR_REPORT
42130>>>                    Move iErr to Err
42131>>>                    Move iLastErr to LastErr
42132>>>                    Set paSQLFetchResults to aSQLFetchResults
42133>>>                End
42133>>>>
42133>>>
42133>>>                Set piRows    to iRows
42134>>>                Set piRowType to iRowType
42135>>>                Move (CurrentDateTime()) to dtQueryExecEnd
42136>>>                Move (CurrentDateTime()) to dtFetchStart
42137>>>
42137>>>                If (iMsgs <> 0) Begin
42139>>>                    If (ghoDbUpdateHandler > 0) Begin
42141>>>                        Get paSQLQueryMessages of ghoDbUpdateHandler to aSQLQueryMessages
42142>>>                    End
42142>>>>
42142>>>                    For i from 1 to iMsgs
42148>>>>
42148>>>                        Get SqlGetMessage of hoStmt i to sMessage
42149>>>                        Get RemoveComponentIdentifier of hoStmt sMessage to sMessage
42150>>>                        If (bShowProgress = True) Begin
42152>>>                            If (Active_State(ghoStatusPanel)) Begin
42154>>>                                Send Update_StatusPanel of ghoStatusPanel (Sformat("  SQLGetMessage iMessage %1 returned [%2]",iMessage,sMessage))
42155>>>                            End
42155>>>>
42155>>>                            Else Begin
42156>>>                                Showln (Sformat("  SQLGetMessage iMessage %1 returned [%2]",iMessage,sMessage))
42158>>>                            End
42158>>>>
42158>>>                        End
42158>>>>
42158>>>                        Move sMessage to sMsg[SizeOfArray(sMsg)]
42159>>>                        Move sMessage to aSQLQueryMessages[SizeOfArray(aSQLQueryMessages)]
42160>>>                    Loop
42161>>>>
42161>>>                    If (ghoDbUpdateHandler > 0) Begin
42163>>>                        Set paSQLQueryMessages of ghoDbUpdateHandler to aSQLQueryMessages
42164>>>                    End
42164>>>>
42164>>>                    Set paQueryMessages to sMsg
42165>>>                End 
42165>>>>
42165>>>                Else Begin
42166>>>                    If (bShowProgress = True) Begin
42168>>>                        Get paSqlErrorArray to aSqlErrorArray
42169>>>                        If (SizeOfArray(aSqlErrorArray.iSqlErrorArray)) Begin
42171>>>                            Move (SizeOfArray(aSqlErrorArray.iSqlErrorArray)) to iMsgs
42172>>>                            Decrement iMsgs
42173>>>                            For i from 0 to iMsgs
42179>>>>
42179>>>                                Showln "Embedded SQL Statement: " aSqlErrorArray.sSqlStatementArray[i]
42182>>>                                Showln "SQL Error Message     : " aSqlErrorArray.sSqlErrorArray[i]
42185>>>                            Loop
42186>>>>
42186>>>                        End
42186>>>>
42186>>>                    End
42186>>>>
42186>>>                End
42186>>>>
42186>>>                Move (CurrentDateTime()) to dtFetchEnd
42187>>>            End
42187>>>>
42187>>>            Move (dtQueryExecEnd - dtQueryExecStart) to tsQuery
42188>>>            Move (dtFetchStart - dtFetchEnd) to tsFetch
42189>>>            Set ptsQueryExec to tsQuery
42190>>>            Set ptsFetchResults to tsFetch
42191>>>            Send SqlClose of hoStmt
42192>>>        End
42192>>>>
42192>>>
42192>>>        Send SqlDisconnect of hoSQLConnect
42193>>>    End_Procedure
42194>>>
42194>>>    // *** Main message for executing an SQL script that has been compiled into the program as a resource ***
42194>>>    // Use the SQLIncludeScriptFile command to include an SQL script into the program.
42194>>>    // Returns False if no error occured.
42194>>>    Function SqlUtilExecuteResource String sMemFileName String sDriverID Boolean bCreateScriptFile Boolean bShowProgr Returns Boolean
42196>>>        Boolean bOK bShowProgress
42196>>>        tSQLScriptArray SQLScriptArray
42196>>>        tSQLScriptArray SQLScriptArray
42196>>>        DateTime dtTotalQueryStart dtTotalQueryEnd
42196>>>        TimeSpan tsTotalTime
42196>>>
42196>>>        Move (CurrentDateTime()) to dtTotalQueryStart
42197>>>        Get SqlUtilReadResource sMemFileName to SQLScriptArray
42198>>>        If (SQLScriptArray.bError = True) Begin
42200>>>            Function_Return False
42201>>>        End
42201>>>>
42201>>>
42201>>>        If (num_arguments > 3) Begin
42203>>>            Move bShowProgr to bShowProgress
42204>>>        End
42204>>>>
42204>>>
42204>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
42205>>>        Get SqlUtilExecuteEmbeddedScript SQLScriptArray sDriverID bCreateScriptFile sMemFileName bShowProgress to bOK
42206>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
42207>>>
42207>>>        If (SQLScriptArray.bArgumentSizeChanged = True) Begin
42209>>>            Set_Argument_Size SQLScriptArray.iOrgArgumentSize
42210>>>>
42210>>>        End
42210>>>>
42210>>>
42210>>>        Move (CurrentDateTime()) to dtTotalQueryEnd
42211>>>        Move (dtTotalQueryEnd - dtTotalQueryStart) to tsTotalTime
42212>>>        Set ptsTotalQueryTime to tsTotalTime
42213>>>
42213>>>        Function_Return bOK
42214>>>    End_Procedure
42215>>>
42215>>>    // Reads a SQL script file that has been compiled into the .exe program as a resource.
42215>>>    // Pass: The memory resource reference and a boolean True if you want to create the file on disk (in the Home folder).
42215>>>    // Returns: A tSQLScriptArray Struct with the Sql script as an uChar Array will be returned along with the a bError boolean.
42215>>>    Function SqlUtilReadResource String sMemFileName Returns tSQLScriptArray
42217>>>        Integer iChannel iArgumentSize iCount
42217>>>        Number nByteCount
42217>>>        String sSQLScript
42217>>>        tSQLScriptArray SqlScriptArray
42217>>>        tSQLScriptArray SqlScriptArray
42217>>>        UChar[] uCharData
42218>>>
42218>>>        Move False to Err
42219>>>        Get Seq_New_Channel to iChannel
42220>>>        If (iChannel = DF_SEQ_CHANNEL_NOT_AVAILABLE) Begin
42222>>>            Error DFERR_PROGRAM 'No channel available...'
42223>>>>
42223>>>            Move True to SqlScriptArray.bError
42224>>>            Function_Return SqlScriptArray
42225>>>        End
42225>>>>
42225>>>
42225>>>        // First decide the size of the script
42225>>>        Direct_Input channel iChannel ("Resource: " + sMemFileName)
42227>>>        Read_Block channel iChannel uCharData -1 // -1 means that all data should be read.
42229>>>        Close_Input channel iChannel
42231>>>
42231>>>        Move (SizeOfArray(uCharData)) to nByteCount
42232>>>        If (nByteCount  < 1) Begin
42234>>>            Send Seq_Release_Channel iChannel
42235>>>            Move True to SqlScriptArray.bError
42236>>>            Function_Return SqlScriptArray
42237>>>        End
42237>>>>
42237>>>
42237>>>        // If necessary change the string argument_size
42237>>>        Get_Argument_Size to iArgumentSize
42238>>>        If (nByteCount >= iArgumentSize) Begin
42240>>>            Move (nByteCount + 2048) to nByteCount
42241>>>            Set_Argument_Size nByteCount // Set new argument size just a bit higher than "needed" for overhead margin.
42242>>>>
42242>>>            Move True          to SqlScriptArray.bArgumentSizeChanged
42243>>>            Move iArgumentSize to SqlScriptArray.iOrgArgumentSize
42244>>>        End
42244>>>>
42244>>>        Else Begin
42245>>>            Move False to SqlScriptArray.bArgumentSizeChanged
42246>>>        End
42246>>>>
42246>>>
42246>>>        // Read the script file from memory line-by-line
42246>>>        Direct_Input channel iChannel ("Resource: " + sMemFileName)
42248>>>            Move 0 to iCount
42249>>>            Repeat
42249>>>>
42249>>>                Readln channel iChannel sSQLScript
42251>>>                Move sSQLScript to SqlScriptArray.sSQLScriptArray[iCount]
42252>>>                Increment iCount
42253>>>            Until (SeqEof = True)
42255>>>        Close_Input channel iChannel
42257>>>        Send Seq_Release_Channel iChannel
42258>>>
42258>>>        // Finally "sanitize" the script by removing all comments.
42258>>>        Get _SqlUtilSanitizeScript SqlScriptArray to SqlScriptArray
42259>>>
42259>>>        Function_Return SqlScriptArray
42260>>>    End_Function
42261>>>
42261>>>    Function SqlUtilExecuteEmbeddedScript tSQLScriptArray SQLScriptArray String sDriverID Boolean bCreateScriptFile String sMemFileName Boolean bShowProgr Returns Boolean
42263>>>        String sSQLVal sStmt sCR sGOKeyWord sNoCountKeyWord sMessage sExportFile
42263>>>        Handle hoSql hoSQLConnect hoStmt hoError
42263>>>        Integer i iMsgs iRows iRowType iCount iChunkCounter iChunkMax iOut iNextSet iMessage
42263>>>        String[] sMsg aSQLQueryMessages
42265>>>        DateTime dtQueryExecStart dtQueryExecEnd
42265>>>        TimeSpan tsQuery
42265>>>        tSqlErrorArray aSqlErrorArray
42265>>>        tSqlErrorArray aSqlErrorArray
42265>>>        tSQLConnection SQLConnection
42265>>>        tSQLConnection SQLConnection
42265>>>        Boolean bMertechDriver bShowProgress
42265>>>
42265>>>        If (num_arguments > 4) Begin
42267>>>            Move bShowProgr to bShowProgress
42268>>>        End
42268>>>>
42268>>>        Get IsMertechDriver sDriverID to bMertechDriver
42269>>>        If (bMertechDriver = False) Begin
42271>>>            Get phoSQLManager to hoSql
42272>>>        End
42272>>>>
42272>>>        Else Begin
42273>>>            Get _MertechSQLManagerHandle to hoSql
42274>>>        End
42274>>>>
42274>>>
42274>>>        Get _SqlFindKeyWord CI_SQLGO to sGOKeyWord
42275>>>        // There seems to be a problem to pass strings when their value gets really big, aka
42275>>>        // above the argument_size level. It isn't clear when these problems starts but sooner
42275>>>        // or later SqlExecDirect stops working correctly with no error messages!
42275>>>        // To guard from this we set a max number of lines (iChunkMax) that can be processed
42275>>>        // at a time. Testing with the Create Chinook Database script; 500 seems like a number that works fine.
42275>>>        // A bonus of this is that it turns out that it is actually faster to run in chunks!
42275>>>        Get piChunkMax to iChunkMax
42276>>>        Move 0 to iChunkCounter
42277>>>        Move "" to sStmt
42278>>>
42278>>>        Get _SqlFindKeyWord CI_SQLSetNoCountOn to sNoCountKeyWord
42279>>>        Move (Character(13) + Character(10)) to sCR
42280>>>
42280>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
42281>>>
42281>>>        If (bMertechDriver = True) Begin
42283>>>            Get _MertechSQLConnect sDriverID SQLConnection.sServer SQLConnection.sUserID SQLConnection.sPassword to hoSQLConnect
42284>>>        End
42284>>>>
42284>>>        If (bMertechDriver = False) Begin
42286>>>            Get phoSQLManager  to hoSQL
42287>>>            Send SqlSetConnect of hoSQL sDriverID SQLConnection.sConnectionString
42288>>>            Get SqlConnect     of hoSQL "" "" to hoSQLConnect
42289>>>        End
42289>>>>
42289>>>
42289>>>        If (hoSQLConnect <> 0) Begin
42291>>>            Move False to Err
42292>>>            Get SqlOpen of hoSQLConnect to hoStmt
42293>>>            If (hoStmt <> 0) Begin
42295>>>
42295>>>                // If the embedded resource should be written as a script file to disk:
42295>>>                If (bCreateScriptFile = True) Begin
42297>>>                    Get psHome of (phoWorkspace(ghoApplication)) to sExportFile
42298>>>                    Get vFolderFormat sExportFile to sExportFile
42299>>>                    Move (sExportFile + sMemFileName) to sExportFile
42300>>>                    Get Seq_New_Channel to iOut
42301>>>                    If (iOut <> DF_SEQ_CHANNEL_NOT_AVAILABLE) Begin
42303>>>                        Direct_Output channel iOut sExportFile
42305>>>                    End
42305>>>>
42305>>>                End
42305>>>>
42305>>>
42305>>>                // Record starting date/time stamp
42305>>>                Move (CurrentDateTime()) to dtQueryExecStart
42306>>>                // Turn on error handling if enabled
42306>>>                If (pbHandleQueryErrors(Self)) Begin
42308>>>                    Set pbSqlError to False
42309>>>                    Set paSqlErrorArray to aSqlErrorArray
42310>>>                    Move Error_Object_Id to hoError
42311>>>                    Move Self to Error_Object_Id
42312>>>                End
42312>>>>
42312>>>
42312>>>                Move (SizeOfArray(SQLScriptArray.sSQLScriptArray)) to iRows
42313>>>                Decrement iRows
42314>>>                Move (sNoCountKeyWord + sCR) to sStmt
42315>>>
42315>>>                For iCount from 0 to iRows
42321>>>>
42321>>>                    Move (SQLScriptArray.sSQLScriptArray[iCount]) to sSQLVal
42322>>>
42322>>>                    If (Uppercase(sSQLVal) <> sGOKeyWord) Begin
42324>>>                        If (sSQLVal <> "") Begin
42326>>>                            Move (sSQLVal + sCR) to sSQLVal
42327>>>                        End
42327>>>>
42327>>>                        Move (Append(sStmt, (sSQLVal))) to sStmt
42328>>>                    End
42328>>>>
42328>>>
42328>>>                    // - Each time we encounter a "GO" statement we execute it,
42328>>>                    // or if at the very end of the script.
42328>>>                    If (Uppercase(sSQLVal) = sGOKeyWord or iChunkCounter >= iChunkMax or iCount = iRows) Begin
42330>>>
42330>>>                        // - It turns out it can be at least 10 times faster to execute SQL statements in chunks,
42330>>>                        // instead of all in one go.
42330>>>                        Send SqlExecDirect of hoStmt sStmt
42331>>>
42331>>>                        If (bCreateScriptFile = True) Begin
42333>>>                            Write channel iOut sStmt
42335>>>                        End
42335>>>>
42335>>>                        Move "" to sStmt
42336>>>                        Move 0 to iChunkCounter
42337>>>                    End
42337>>>>
42337>>>                    Increment iChunkCounter
42338>>>                Loop
42339>>>>
42339>>>
42339>>>                Repeat
42339>>>>
42339>>>                    If (pbHandleQueryErrors(Self)) Begin
42341>>>                        Move hoError to Error_Object_Id
42342>>>                    End
42342>>>>
42342>>>                    Move (CurrentDateTime()) to dtQueryExecEnd
42343>>>
42343>>>                    Send _SqlColumnInfo hoStmt
42344>>>                    Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_ROWCOUNT to iRows
42345>>>                    Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_ROWCOUNT_TYPE to iRowType
42346>>>                    Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_NUMMESSAGES to iMsgs
42347>>>                    Set piRows    to iRows
42348>>>                    Set piRowType to iRowType
42349>>>
42349>>>                    If (iMsgs <> 0) Begin
42351>>>                        If (ghoDbUpdateHandler > 0) Begin
42353>>>                            Get paSQLQueryMessages of ghoDbUpdateHandler to aSQLQueryMessages
42354>>>                        End
42354>>>>
42354>>>                        For i from 1 to iMsgs
42360>>>>
42360>>>                            Get SqlGetMessage of hoStmt i to sMessage
42361>>>                            Get RemoveComponentIdentifier of hoStmt sMessage to sMessage
42362>>>                            If (bShowProgress = True) Begin
42364>>>                                If (Active_State(ghoStatusPanel)) Begin
42366>>>                                    Send Update_StatusPanel of ghoStatusPanel (Sformat("  SQLGetMessage iMessage %1 returned [%2]", iMessage, sMessage))
42367>>>                                End
42367>>>>
42367>>>                                Else Begin
42368>>>                                    Showln (Sformat("  SQLGetMessage iMessage %1 returned [%2]", iMessage, sMessage))
42370>>>                                End
42370>>>>
42370>>>                            End
42370>>>>
42370>>>                            Move sMessage to sMsg[SizeOfArray(sMsg)]
42371>>>                            Move sMessage to aSQLQueryMessages[SizeOfArray(aSQLQueryMessages)]
42372>>>                        Loop
42373>>>>
42373>>>
42373>>>
42373>>>                        If (ghoDbUpdateHandler > 0) Begin
42375>>>                            Set paSQLQueryMessages of ghoDbUpdateHandler to aSQLQueryMessages
42376>>>                        End
42376>>>>
42376>>>                        Set paQueryMessages to sMsg
42377>>>                    End
42377>>>>
42377>>>
42377>>>                    Get SQLNextResultSet of hoStmt to iNextSet
42378>>>                Until (iNextSet = 0)
42380>>>
42380>>>                Move (CurrentDateTime()) to dtQueryExecEnd
42381>>>            End
42381>>>>
42381>>>
42381>>>            Move (dtQueryExecEnd - dtQueryExecStart) to tsQuery
42382>>>            Set ptsQueryExec to tsQuery
42383>>>            Send SqlClose of hoStmt
42384>>>
42384>>>            If (bCreateScriptFile = True) Begin
42386>>>                Close_Output channel iOut
42388>>>                Send Seq_Release_Channel iOut
42389>>>            End
42389>>>>
42389>>>        End
42389>>>>
42389>>>        Send SqlDisconnect of hoSQLConnect
42390>>>
42390>>>        Function_Return (hoSQLConnect <> 0 and Err = False)
42391>>>    End_Function
42392>>>
42392>>>    // * Dummy function for the Studio's Code Explorer *
42392>>>    Function SQL_UTILITY_FUNCTIONS Returns Boolean
42394>>>        Function_Return False
42395>>>    End_Function
42396>>>
42396>>>    // Does three things with auxilirary files;
42396>>>    // 1) Deletes the cache file in the first Data folder of the psDataPath property as the table at the SQL end has been changed.
42396>>>    // 2) Adds the sColumnName to the TableName.tag file in the first Data folder of the psDataPath property
42396>>>    // 3) Creates a new TableName.fd file if the DdSrc folder is available (if this is a development environment)
42396>>>    Function SqlUtilAdjustAuxFiles Handle hTable String sTableName String sColumnName Returns Boolean
42398>>>        String sDataPath sDDSrcPath sDriverID
42398>>>        Boolean bOK bExists bMertechDriver
42398>>>        Integer iCount iCh iPos
42398>>>
42398>>>        // If table name equals e.g. "dbo.MyTable" we need to remove the prefix.
42398>>>        If (sTableName contains ".") Begin
42400>>>            Move (Pos(".", sTableName)) to iPos
42401>>>            Move (Mid(sTableName, 999, (iPos +1))) to sTableName
42402>>>        End
42402>>>>
42402>>>
42402>>>        Get psDriverID to sDriverID
42403>>>        Get psDataPathFirstPart to sDataPath
42404>>>        Get vFolderExists sDataPath to bOK
42405>>>        If (bOK = False) Begin
42407>>>            Error DFERR_PROGRAM "Function SqlUtilAdjustAuxFiles; psDataPath not found!"
42408>>>>
42408>>>            Function_Return False
42409>>>        End
42409>>>>
42409>>>
42409>>>        Get IsMertechDriver sDriverID to bMertechDriver
42410>>>        // First delete the cache file:
42410>>>        Get UtilDeleteCacheFile sTableName to bOK
42411>>>
42411>>>        Get Seq_New_Channel to iCh
42412>>>        If (iCh = DF_SEQ_CHANNEL_NOT_AVAILABLE) Begin
42414>>>            Function_Return False
42415>>>        End
42415>>>>
42415>>>
42415>>>        Get vFilePathExists (sDataPath + sTableName + ".tag") to bExists
42416>>>        If (bExists = False) Begin
42418>>>            Function_Return False
42419>>>        End
42419>>>>
42419>>>
42419>>>        // Add the new column name to the .tag file:
42419>>>        Append_Output channel iCh (sDataPath + sTableName + ".tag")
42421>>>            Writeln channel iCh sColumnName
42424>>>        Close_Output
42425>>>
42425>>>        // If in development environment; output new .fd file:
42425>>>        Get psDdSrcPath of (phoWorkspace(ghoApplication)) to sDDSrcPath
42426>>>        Get CountOfPaths of (phoWorkspace(ghoApplication)) sDDSrcPath to iCount
42427>>>        If (iCount > 1) Begin
42429>>>            Get PathAtIndex of (phoWorkspace(ghoApplication)) sDDSrcPath 1 to sDDSrcPath
42430>>>        End
42430>>>>
42430>>>        Get vFolderExists sDDSrcPath to bExists
42431>>>        If (bExists = True) Begin
42433>>>            Get vFolderFormat sDDSrcPath to sDDSrcPath
42434>>>            Move False to Err
42435>>>            Get AutoConnectionIDLogin to bOK
42436>>>            If (hTable <> 0) Begin
42438>>>                Open hTable
42440>>>            End
42440>>>>
42440>>>            Else Begin
42441>>>                Get UtilTableOpen hTable sTableName DF_SHARE to bOK
42442>>>            End
42442>>>>
42442>>>
42442>>>            Get_Attribute DF_FILE_OPENED of hTable to bOK
42445>>>            If (bOK = True) Begin
42447>>>                Output_Aux_File DF_AUX_FILE_FD for hTable to (sDDSrcPath + sTableName + ".fd")
42449>>>            End
42449>>>>
42449>>>            If (Err = True) Begin
42451>>>                Move False to bOK
42452>>>            End
42452>>>>
42452>>>        End
42452>>>>
42452>>>
42452>>>        Function_Return (bOK = True)
42453>>>    End_Function
42454>>>
42454>>>    // Message for changing .int files to use connection ID's
42454>>>    //
42454>>>    // Changes all ".int" files for the passed sDataPath to use a sConnectionID,
42454>>>    // OR changes an existing connection id to a new id.
42454>>>    // Pass the full path to the data folder and the name of the connection id (string value).
42454>>>    // Pass a True for the bShowResult parameter to show work in progress (showln's).
42454>>>    Procedure SqlUtilChangeIntFilesToConnectionIDs String sDataPath String sConnectionID Boolean bShowResult
42456>>>        String sFileName sDriverID sDriverFile sConnectionString
42456>>>        String[] sFilesData
42457>>>        Boolean bOK bCancel
42457>>>        Integer iSize iCount
42457>>>
42457>>>        Get SqlUtilEnumerateIntFiles sDataPath to sFilesData
42458>>>        Move (SizeOfArray(sFilesData))    to iSize
42459>>>        If (iSize = 0) Begin
42461>>>            If (ghoStatusPanel <> 0) Begin
42463>>>                If (Active_State(ghoStatusPanel)) Begin
42465>>>                    Send Stop_StatusPanel of ghoStatusPanel
42466>>>                End
42466>>>>
42466>>>            End
42466>>>>
42466>>>            Send Info_Box "No .int files found! Nothing was changed."
42467>>>            Procedure_Return
42468>>>        End
42468>>>>
42468>>>
42468>>>        Move (Trim(sConnectionID)) to sConnectionID
42469>>>        Get vFolderFormat sDataPath to sDataPath
42470>>>        Decrement iSize
42471>>>        For iCount from 0 to iSize
42477>>>>
42477>>>            Move sFilesData[iCount] to sFileName
42478>>>            // This makes sure that we also can change an existing connection id to something new:
42478>>>            Get UtilChangeSourceCodeLine (sDataPath + sFileName) CS_SERVER_NAME (CS_SERVER_NAME * CS_DFCONNID + "=" + sConnectionID) bShowResult to bOK
42479>>>            If (ghoStatusPanel <> 0) Begin
42481>>>                If (Active_State(ghoStatusPanel)) Begin
42483>>>                    Get Check_StatusPanel of ghoStatusPanel to bCancel
42484>>>                    If (bCancel = True) Begin
42486>>>                        Send Deactivate of ghoStatusPanel
42487>>>                        Procedure_Return
42488>>>                    End
42488>>>>
42488>>>                End
42488>>>>
42488>>>            End
42488>>>>
42488>>>        Loop
42489>>>>
42489>>>
42489>>>        Get psDriverID to sDriverID
42490>>>
42490>>>         // Finally also change the driver file e.g. MSSQLDRV.int file in the Data folder in case it has a "DFconnectionID xxxxID,SERVER..."
42490>>>        Move "" to sFileName
42491>>>        If (sDriverID = MSSQLDRV_ID) Begin
42493>>>            Move "MSSQLDrv.int" to sFileName
42494>>>        End
42494>>>>
42494>>>        If (sDriverID = DB2_DRV_ID) Begin
42496>>>            Move "DB2_Drv.int" to sFileName
42497>>>        End
42497>>>>
42497>>>        If (sDriverID = ODBC_DRV_ID) Begin
42499>>>            Move "ODBC_Drv.int" to sFileName
42500>>>        End
42500>>>>
42500>>>        If (sFileName <> "") Begin
42502>>>            Move "" to sDriverFile
42503>>>            Get_File_Path sFileName to sDriverFile
42504>>>            If (sDriverFile <> "") Begin
42506>>>                Get psConnectionString to sConnectionString
42507>>>                Get UtilChangeSourceCodeLine sDriverFile CS_SQLConnectionIDText (CS_SQLConnectionIDText * String(sConnectionID) + "," * String(sConnectionString) * String(",0")) bShowResult to bOK
42508>>>            End
42508>>>>
42508>>>        End
42508>>>>
42508>>>    End_Procedure
42509>>>
42509>>>    // Checks if the database exists in SQL. Returns = True if it does.
42509>>>    Function SqlUtilCheckIfDatabaseExists String sDatabase Returns Boolean
42511>>>        String[] sDatabaseArray
42512>>>        String sVal sServer sDriverID
42512>>>        Integer iCount iSize iPos
42512>>>        Boolean bExists
42512>>>        tSQLConnection SQLConnection
42512>>>        tSQLConnection SQLConnection
42512>>>
42512>>>        Move False to bExists
42513>>>        Get psDriverID to sDriverID
42514>>>        // DB2 doesn't need to have a "Database" name, so we always return True.
42514>>>        If (sDriverID = DB2_DRV_ID) Begin
42516>>>            Function_Return bExists
42517>>>        End
42517>>>>
42517>>>
42517>>>        Get SqlUtilEnumerateDatabases sDriverID to sDatabaseArray
42518>>>        If (SizeOfArray(sDatabaseArray) = 0) Begin
42520>>>            Function_Return False
42521>>>        End
42521>>>>
42521>>>
42521>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
42522>>>        Get ParseKeyWord SQLConnection.sConnectionString (CS_SQLIniDSNKeyword + "=") to sServer
42523>>>        If (sServer contains "/") Begin
42525>>>            Move (Pos("/", sServer)) to iPos
42526>>>            Move (Mid(sServer, 999, (iPos +1)))                        to sDatabase
42527>>>        End
42527>>>>
42527>>>
42527>>>        Move (SizeOfArray(sDatabaseArray)) to iSize
42528>>>        Decrement iSize
42529>>>        For iCount from 0 to iSize
42535>>>>
42535>>>            Move sDatabaseArray[iCount] to sVal
42536>>>            If (Uppercase(sVal) = Uppercase(sDatabase)) Begin
42538>>>                Move True to bExists
42539>>>            End
42539>>>>
42539>>>        Loop
42540>>>>
42540>>>
42540>>>        Function_Return bExists
42541>>>    End_Function
42542>>>
42542>>>    // Checks if a table exists as an SQL table. Returns = True if it does.
42542>>>    Function SqlUtilCheckIfTableHandleExists Handle hTable String sDriverID Returns Boolean
42544>>>        String sTableName sVal
42544>>>        Boolean bExists
42544>>>        String[] sTablesArray
42545>>>        Integer iSize iCount
42545>>>
42545>>>        Move False to bExists
42546>>>        Get UtilTableHandleToString hTable to sTableName
42547>>>        Get SqlUtilEnumerateTables sDriverID to sTablesArray
42548>>>        Move (SizeOfArray(sTablesArray)) to iSize
42549>>>        Decrement iSize
42550>>>        For iCount from 0 to iSize
42556>>>>
42556>>>            Move sTablesArray[iCount] to sVal
42557>>>            If (Uppercase(sVal) = Uppercase(sTableName)) Begin
42559>>>                Move True to bExists
42560>>>                Move iSize to iCount // We're done!
42561>>>            End
42561>>>>
42561>>>        Loop
42562>>>>
42562>>>
42562>>>        Function_Return bExists
42563>>>    End_Function
42564>>>
42564>>>    // Checks if a table exists as an SQL table. Returns = True if it does.
42564>>>    Function SqlUtilCheckIfTableNameExists String sTableName String sDriverID Returns Boolean
42566>>>        String sVal
42566>>>        Boolean bExists
42566>>>        String[] sTablesArray
42567>>>        Integer iSize iCount
42567>>>
42567>>>        Move False to bExists
42568>>>        Get SqlUtilEnumerateTables sDriverID to sTablesArray
42569>>>        Move (SizeOfArray(sTablesArray)) to iSize
42570>>>        Decrement iSize
42571>>>        For iCount from 0 to iSize
42577>>>>
42577>>>            Move sTablesArray[iCount] to sVal
42578>>>            If (Uppercase(sVal) = Uppercase(sTableName)) Begin
42580>>>                Move True to bExists
42581>>>                Move iSize to iCount // We're done!
42582>>>            End
42582>>>>
42582>>>        Loop
42583>>>>
42583>>>
42583>>>        Function_Return bExists
42584>>>    End_Function
42585>>>
42585>>>    // ToDo: This index name function needs to be finished...
42585>>>    Function SqlUtilCheckIfIndexNameExists Handle hTable String sIndexName Returns Boolean
42587>>>        String sSchema sTableName sDriverID
42587>>>        Boolean bExists
42587>>>
42587>>>        Get psDriverID to sDriverID
42588>>>        Get psSchema to sSchema
42589>>>        Get UtilTableHandleToString hTable to sTableName
42590>>>
42590>>>        Function_Return bExists
42591>>>    End_Function
42592>>>
42592>>>    // Checks if a column/field name exists in a SQL table definition
42592>>>    // Returns True if it does
42592>>>    // Sample:
42592>>>    //   Get SQLUtilColumnExists "MySQLTable" "MyColumnName" to bExists
42592>>>    Function SqlUtilColumnExists String sTableName String sFieldName Returns Boolean
42594>>>        Integer iNumColumns iColumn
42594>>>        String sColumn sDriverID
42594>>>        String[] sColumnsArray
42595>>>        Boolean bExists bOK
42595>>>
42595>>>        Move False to bExists
42596>>>        Get AutoConnectionIDLogin to bOK
42597>>>        Get psDriverID to sDriverID
42598>>>
42598>>>        Get SqlUtilEnumerateColumns sDriverID sTableName to sColumnsArray
42599>>>        Move (SizeOfArray(sColumnsArray)) to iNumColumns
42600>>>        Decrement iNumColumns
42601>>>        For iColumn from 0 to iNumColumns
42607>>>>
42607>>>            Move sColumnsArray[iColumn] to sColumn
42608>>>            If (Uppercase(sFieldName) = Uppercase(sColumn)) Begin
42610>>>                Move True to bExists
42611>>>                Move iNumColumns to iColumn // We're out of here
42612>>>            End
42612>>>>
42612>>>        Loop
42613>>>>
42613>>>
42613>>>        Function_Return bExists
42614>>>    End_Function
42615>>>
42615>>>    Function SqlUtilConvertColumnTypesToSQL2008 Handle hTable Returns Boolean
42617>>>        Integer iNumColumns iColumn iDFType iNativeType
42617>>>        Boolean bOpened bOK
42617>>>        String sColumnName sNativeTypeName
42617>>>
42617>>>        Get AutoConnectionIDLogin to bOK
42618>>>        Get OpenTableExclusive hTable to bOK
42619>>>        If (bOK = False) Begin
42621>>>            Function_Return False
42622>>>        End
42622>>>>
42622>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
42625>>>        If (bOpened = False) Begin
42627>>>            Error DFERR_PROGRAM ("Function SQLUtilConvertColumnTypesToSQL2008; Could not open table" * String(hTable))
42628>>>>
42628>>>            Function_Return False
42629>>>        End
42629>>>>
42629>>>
42629>>>        Move False to Err
42630>>>
42630>>>        Structure_Start hTable
42631>>>            Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumColumns
42634>>>
42634>>>            For iColumn from 1 to iNumColumns
42640>>>>
42640>>>                Get_Attribute DF_FIELD_TYPE             of hTable iColumn to iDfType
42643>>>                Get_Attribute DF_FIELD_NAME             of hTable iColumn to sColumnName
42646>>>                Get_Attribute DF_FIELD_NATIVE_TYPE      of hTable iColumn to iNativeType
42649>>>                Get_Attribute DF_FIELD_NATIVE_TYPE_Name of hTable iColumn to sNativeTypeName
42652>>>
42652>>>                Case Begin
42652>>>                    Case (iDFType = DF_DATE)
42654>>>                        If (iNativeType = SQL_TYPE_TIMESTAMP) Begin
42656>>>                            // Convert datetime to date
42656>>>                            Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to SQL_TYPE_DATE
42659>>>                        End
42659>>>>
42659>>>                        Case Break
42660>>>                    Case (iDFType = DF_DATETIME)
42663>>>                        If (iNativeType = SQL_TYPE_TIMESTAMP) Begin
42665>>>                            // Convert datetime to datetime2
42665>>>                            Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to SQL_TYPE_TIMESTAMP2
42668>>>                        End
42668>>>>
42668>>>                        Case Break
42669>>>                    Case (iDFType = DF_ASCII)
42672>>>                        If (iNativeType = SQL_CHAR) Begin
42674>>>                            // Convert char to varchar
42674>>>                            Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to SQL_VARCHAR
42677>>>                        End
42677>>>>
42677>>>                        Case Break
42678>>>                    Case (iDFType = DF_TEXT)
42681>>>                        If (iNativeType = SQL_LONGVARCHAR) Begin
42683>>>                            // Convert text to varchar(max)
42683>>>                            Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to SQL_VARCHAR
42686>>>                        End
42686>>>>
42686>>>                        Case Break
42687>>>                    Case (iDFType = DF_BINARY)
42690>>>                        If (iNativeType = SQL_LONGVARBINARY) Begin
42692>>>                            // Convert image to varbinary(max)
42692>>>                            Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to SQL_VARBINARY
42695>>>                        End
42695>>>>
42695>>>                        Case Break
42696>>>                Case End
42696>>>            Loop
42697>>>>
42697>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
42698>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
42700>>>
42700>>>        Set Action_Text of ghoStatusPanel to ""
42701>>>        Function_Return (Err = False)
42702>>>    End_Function
42703>>>
42703>>>
42703>>>    // Will create an SQL table with the passed sTableName & sColumnName as Numeric 4.2 to keep
42703>>>    // the DbUpdateVersion database revision in.
42703>>>    // Also pass the file number of the current (embedded?) table number used in development.
42703>>>    // It will first create the SQL Table & column, then create the .int file and change Filelist.cfg
42703>>>    Function SqlUtilCreateDbVersionTable Handle hTable String sColumnName String sDriverID Returns Boolean
42705>>>        Boolean bOK bOpened
42705>>>        String sTableName sDataType sAlterTable sAddColumn sLengthAndDecimals sStmt
42705>>>
42705>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sTableName
42708>>>        Get _TableNameOnly sTableName to sTableName
42709>>>        If (sTableName = "") Begin
42711>>>            Function_Return False
42712>>>        End
42712>>>>
42712>>>
42712>>>        // This just creates the table and a "dummy" column.
42712>>>        Get SqlTableCreate hTable sDriverID to bOK
42713>>>        If (bOK = False) Begin
42715>>>            Function_Return False
42716>>>        End
42716>>>>
42716>>>
42716>>>        Close hTable
42717>>>        Move False to Err
42718>>>
42718>>>        Get _SqlFindKeyWord CI_SQLAlterTable to sAlterTable
42719>>>        Get _SqlFindKeyWord CI_SQLAdd        to sAddColumn
42720>>>        Move "Decimal" to sDataType
42721>>>        Get _SqlFormatLengthAndDecimalAsString 4 2 to sLengthAndDecimals
42722>>>
42722>>>        // Adds the "sColumnName" passed to the function
42722>>>        Move (sAlterTable * sTableName * sAddColumn * sColumnName * sDataType + sLengthAndDecimals) to sStmt
42723>>>        Send SqlUtilExecuteQuery sStmt sDriverID
42724>>>
42724>>>        // Now we can delete the dummy column:
42724>>>        Get SqlColumnRemoveByTableName sTableName "Dummy" to bOK
42725>>>
42725>>>        // Finally, we attach to the newly created table.
42725>>>        If (Err = False) Begin
42727>>>            Get ApiTableAttachToSQL hTable True to bOK
42728>>>        End
42728>>>>
42728>>>        Open hTable
42730>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
42733>>>
42733>>>        Function_Return (Err = False and bOK = True and bOpened = True)
42734>>>    End_Function
42735>>>
42735>>>    // The table must already exist in the filelist for this function to work.
42735>>>    // It creates a rudimentary .int file in the first Data folder of the psDataPath property.
42735>>>    Function SqlUtilCreateIntFile Handle hTable String sDriverID String sConnectionID Boolean bAnsi Boolean bSysFile Returns Boolean
42737>>>        Boolean bOK bExists bUseConnectionID bMertech
42737>>>        String sDataPath sRootName sLogicalName sPhysicalFileName sConnectionString sDatabaseName sSchemaName sANSI_OEM
42737>>>        String[] sIndexArray
42738>>>        Integer iCount iCh iSize
42738>>>
42738>>>        Move (Trim(sConnectionID) <> "") to bUseConnectionID
42739>>>        Get psConnectionString to sConnectionString
42740>>>
42740>>>        Move CS_ANSI_Txt to sANSI_OEM
42741>>>        If (bANSI = False) Begin
42743>>>            Move CS_OEM_Txt to sANSI_OEM
42744>>>        End
42744>>>>
42744>>>
42744>>>        Get psDataPathFirstPart to sDataPath
42745>>>        Get vFolderExists sDataPath to bOK
42746>>>        If (bOK = False) Begin
42748>>>            Error DFERR_PROGRAM "Function SqlUtilCreateIntFile; psDataPath not found!"
42749>>>>
42749>>>            Function_Return False
42750>>>        End
42750>>>>
42750>>>        Get vFolderFormat sDataPath to sDataPath
42751>>>
42751>>>        Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
42754>>>        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
42757>>>        Get _TableNameOnly sRootName to sDatabaseName
42758>>>        Move sLogicalName  to sPhysicalFileName
42759>>>        Move (sPhysicalFileName + ".int") to sPhysicalFileName
42760>>>
42760>>>        Get IsMertechDriver sDriverID to bMertech
42761>>>        If (bMertech = True) Begin
42763>>>            // This should not be called here. Instead it is called by the SqlUtilUpdateIntFile!
42763>>>            // Else it will create an error in the error log (although it won't do anything...)
42763>>>            // Get _MertechSqlUtilCreateIntFile hTable sDataPath sPhysicalFileName to bOK
42763>>>            Function_Return (bOK = True)
42764>>>        End
42764>>>>
42764>>>
42764>>>        Get psSchema hTable to sSchemaName
42765>>>        If (sSchemaName = "") Begin
42767>>>            Get _SqlFindKeyWord CI_SQLDBO to sSchemaName
42768>>>        End
42768>>>>
42768>>>
42768>>>        // If the .int file already exists; we rename it to "FileName" + ".bak"
42768>>>        Get vFilePathExists (sDataPath + sPhysicalFileName) to bExists
42769>>>        If (bExists = True) Begin
42771>>>            Get vRenameFile (sDataPath + sPhysicalFileName) (sDataPath + sPhysicalFileName + ".bak") to bOK
42772>>>        End
42772>>>>
42772>>>
42772>>>        Get UtilDeleteCacheFile sRootName to bOK
42773>>>        Get SqlUtilEnumerateIndexes sRootName sDriverID to sIndexArray
42774>>>
42774>>>        Get Seq_Open_Output_Channel (sDataPath + sPhysicalFileName) to iCh
42775>>>            Writeln channel iCh CS_DRIVER_NAME     " " sDriverID
42780>>>            If (bUseConnectionID = True) Begin
42782>>>                Writeln channel iCh CS_SERVER_NAME " " CS_DFCONNID "=" sConnectionID
42789>>>            End
42789>>>>
42789>>>            Else Begin
42790>>>                Writeln channel iCh CS_SERVER_NAME " " CS_SERVER "=" sConnectionString
42797>>>            End
42797>>>>
42797>>>            Writeln channel iCh CS_DATABASE_NAME          " " sDatabaseName
42802>>>            Writeln channel iCh CS_SCHEMA_NAME            " " (Lowercase(sSchemaName))
42807>>>            // There seems to be a new order how these are set from DF19.
42807>>>            If (bSysFile = True) Begin
42809>>>                Writeln channel iCh CS_RECNUM_TABLE       " " "NO"
42814>>>            End
42814>>>>
42814>>>            Writeln channel iCh CS_TABLE_CHARACTER_FORMAT " " sANSI_OEM
42819>>>            Writeln channel iCh CS_USE_DUMMY_ZERO_DATE    " " "YES" // ToDo: We maybe need to paramerize this setting?
42824>>>            If (bSysFile = True) Begin
42826>>>                Writeln channel iCh CS_SYSTEM_FILE        " " "YES"
42831>>>            End
42831>>>>
42831>>>
42831>>>            If (bSysFile = False) Begin
42833>>>                Move (SizeOfArray(sIndexArray)) to iSize
42834>>>                Move (SortArray(sIndexArray)) to sIndexArray
42835>>>                If (iSize > 0) Begin
42837>>>                    Writeln channel iCh (CS_PRIMARY_INDEX * String("0"))
42840>>>                    Writeln channel iCh // Just an empty line
42842>>>                End
42842>>>>
42842>>>                Decrement iSize
42843>>>                For iCount from 0 to iSize
42849>>>>
42849>>>                    Writeln channel iCh (CS_INDEX_NUMBER * String(iCount))
42852>>>                    Writeln channel iCh (CS_INDEX_NAME   * String(sIndexArray[iCount]))
42855>>>                    Writeln channel iCh
42857>>>                Loop
42858>>>>
42858>>>            End
42858>>>>
42858>>>        Send Seq_Close_Channel iCh
42859>>>
42859>>>        // Wait a sec for Windows to finish writing the file:
42859>>>        Sleep 1
42860>>>
42860>>>        Function_Return (bOK = True)
42861>>>    End_Function
42862>>>
42862>>>    // Returns a handle to the SQL server associated with the passed driver ID.
42862>>>    // Pass e.g. the psServer property to determine the current connection server.
42862>>>    // Returns a handle to the database connection, or a zero (0) if it fails.
42862>>>    // This handle can be used to obtain attributes about the server, such as default
42862>>>    // column types.
42862>>>    Function SqlUtilDatabaseHandle String sDriverID String sServer Returns Handle
42864>>>        Handle hDatabase
42864>>>        Integer iDriver iServers iCount
42864>>>        String sValue
42864>>>
42864>>>        If (sServer = "") Begin
42866>>>            Function_Return 0
42867>>>        End
42867>>>>
42867>>>
42867>>>        Get DriverIndex sDriverID to iDriver
42868>>>        If (iDriver = 0) Begin
42870>>>            Function_Return 0
42871>>>        End
42871>>>>
42871>>>
42871>>>        Get_Attribute DF_DRIVER_NUMBER_SERVERS of iDriver to iServers
42874>>>        For iCount from 1 to iServers
42880>>>>
42880>>>            Get_Attribute DF_DRIVER_SERVER_NAME of iDriver iCount to sValue
42883>>>            If (Uppercase(sValue) contains Uppercase(sServer)) Begin
42885>>>                Get_Attribute DF_DATABASE_ID of iDriver iCount to hDatabase
42888>>>            End
42888>>>>
42888>>>        Loop
42889>>>>
42889>>>
42889>>>        Function_Return hDatabase
42890>>>    End_Function
42891>>>
42891>>>//    Function UtilIsFilelistEntryDriverBased Integer hTable String sDriverID Returns Boolean
42891>>>//        String sRootName
42891>>>//        Boolean bOK
42891>>>//
42891>>>//        Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
42891>>>//        Move (sRootName contains sDriverID) to bOK
42891>>>//
42891>>>//        Function_Return bOK
42891>>>//    End_Function
42891>>>
42891>>>//    Function UtilFilelistAddDriverInfo Integer hTable Returns Boolean
42891>>>//        String sDriverID sRootName sDisplayName sSchema sVal
42891>>>//        Integer iDbType
42891>>>//        Boolean bOK
42891>>>//
42891>>>//        Get UtilIsFilelistEntryDriverBased to bOK
42891>>>//        If (bOK = True) Begin
42891>>>//            Function_Return False
42891>>>//        End
42891>>>//
42891>>>//        Get psDriverID to sDriverID
42891>>>//        Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
42891>>>//        Move (sDriverID + ":" + sRootName)           to sRootName
42891>>>//        Get_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
42891>>>//
42891>>>//        Get psDriverID to sDriverID
42891>>>//        Get piDbType   to iDbType
42891>>>//        Get psSchema   to sSchema
42891>>>//        If (sSchema = "") Begin
42891>>>//            Get _SqlFindKeyWord CI_SQLDBO to sSchema
42891>>>//        End
42891>>>//
42891>>>//        Move (Uppercase(sDisplayName)) to sVal
42891>>>//        If (not(sVal contains (sSchema + "."))) Begin
42891>>>//            If (iDbType = EN_dbTypeDB2) Begin
42891>>>//                Move (Lowercase(sSchema) + "." + sDisplayName) to sDisplayName
42891>>>//            End
42891>>>//            Else Begin
42891>>>//                Move (sSchema + "." + sDisplayName) to sDisplayName
42891>>>//            End
42891>>>//        End
42891>>>//
42891>>>//        Set_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
42891>>>//        Set_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
42891>>>//
42891>>>//        Function_Return True
42891>>>//    End_Function
42891>>>
42891>>>    // Removes all driver identifications (e.g. "MSSQLDRV;MyTable" or "MyTable.MSSQLDRV"
42891>>>    // from the passed filelist.
42891>>>    // Returns the number of tables affected.
42891>>>    Function SqlUtilFilelistRemoveDriverInfo String sFilelist Returns Integer
42893>>>        String sCurrentFileList sRootName sDisplayName sLogicalName sVal
42893>>>        Integer iRetval
42893>>>        Handle hTable
42893>>>
42893>>>        // We first save the current filelist as the passed filelist name
42893>>>        // may come from another workspace, to restore it when we're ready.
42893>>>        Get_Attribute DF_FILELIST_NAME to sCurrentFileList
42896>>>        Set_Attribute DF_FILELIST_NAME to sFilelist
42899>>>        Move 0 to hTable
42900>>>        Move 0 to iRetval
42901>>>
42901>>>        Repeat
42901>>>>
42901>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
42904>>>            If (hTable <> 0) Begin
42906>>>                Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
42909>>>                Get_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
42912>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
42915>>>                Move (Uppercase(sRootName)) to sVal
42916>>>                If (sVal contains MSSQLDRV_ID or sVal contains DB2_DRV_ID or sVal contains ODBC_DRV_ID) Begin
42918>>>                    // Prefixes:
42918>>>                    Move (Replace((MSSQLDRV_ID + ":"), sRootName, "")) to sRootName
42919>>>                    Move (Replace((DB2_DRV_ID  + ":"), sRootName, "")) to sRootName
42920>>>                    Move (Replace((ODBC_DRV_ID + ":"), sRootName, "")) to sRootName
42921>>>                    // Suffixes:
42921>>>                    Move (Replace(("." + MSSQLDRV_ID), sRootName, "")) to sRootName
42922>>>                    Move (Replace(("." + DB2_DRV_ID),  sRootName, "")) to sRootName
42923>>>                    Move (Replace(("." + ODBC_DRV_ID), sRootName, "")) to sRootName
42924>>>
42924>>>                    // Change Filelist entry:
42924>>>                    Set_Attribute DF_FILE_ROOT_NAME of hTable          to sRootName
42927>>>
42927>>>                    Move (Lowercase(sDisplayName)) to sVal
42928>>>                    If (sVal contains "dbo.") Begin
42930>>>                        Move (Replace("dbo.", sDisplayName, ""))       to sDisplayName
42931>>>
42931>>>                        // Change Filelist entry:
42931>>>                        Set_Attribute DF_FILE_DISPLAY_NAME of hTable   to sDisplayName
42934>>>                    End
42934>>>>
42934>>>                    Increment iRetval
42935>>>                End
42935>>>>
42935>>>            End
42935>>>>
42935>>>        Until (hTable = 0)
42937>>>
42937>>>        Set_Attribute DF_FILELIST_NAME to sCurrentFileList
42940>>>
42940>>>        Function_Return iRetval
42941>>>    End_Function
42942>>>
42942>>>    // To open all Sql based tables in Filelist.cfg
42942>>>    Procedure SqlUtilOpenAllTables
42944>>>        Handle hTable
42944>>>        String sRoot sDriverID
42944>>>        Boolean bOK
42944>>>
42944>>>        Move 0 to hTable
42945>>>        Move "" to sDriverID
42946>>>        Get AutoConnectionIDLogin to bOK
42947>>>
42947>>>        Repeat
42947>>>>
42947>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
42950>>>            If (hTable > 0) Begin
42952>>>                Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
42955>>>                If (sDriverID = MSSQLDRV_ID or sDriverID = DB2_DRV_ID or sDriverID = ODBC_DRV_ID) Begin
42957>>>                    Get_Attribute DF_FILE_ROOT_NAME of hTable to sRoot
42960>>>                    If (Uppercase(sRoot) contains ".INT" or Uppercase(sRoot) contains MSSQLDRV_ID or Uppercase(sRoot) contains DB2_DRV_ID or Uppercase(sRoot) contains ODBC_DRV_ID) Begin
42962>>>                        Open hTable
42964>>>                    End
42964>>>>
42964>>>                End
42964>>>>
42964>>>            End
42964>>>>
42964>>>
42964>>>        Until (hTable = 0)
42966>>>    End_Procedure
42967>>>
42967>>>//    Function SqlUtilSchemaName Handle hTable Returns String
42967>>>//        String sRetval sDriverID
42967>>>//        String sTableName
42967>>>//        Integer iDbType iIndex
42967>>>//        Boolean bOK
42967>>>//
42967>>>//        Get psDriverID to sDriverID
42967>>>//        Get _SqlCheckCurrentDriver sDriverID to bOK
42967>>>//        If (hTable = 0 or bOK = False) Begin
42967>>>//            Function_Return ""
42967>>>//        End
42967>>>//
42967>>>//        Move False to Err
42967>>>//        Get UtilTableHandleToString hTable to sTableName
42967>>>//        Get piDbType to iDbType
42967>>>//        Get _SqlUtilEnumerateTableIndex sTableName sDriverID to iIndex
42967>>>//        If (iIndex = -1) Begin
42967>>>//            Function_Return ""
42967>>>//        End
42967>>>//
42967>>>//        Function_Return sRetval
42967>>>//    End_Function
42967>>>
42967>>>    // Checks if the passed Table;
42967>>>    // 1) Already has a Filelist entry that points to SQL and
42967>>>    // 2) It has an .int file.
42967>>>    // If both is True it should already be connected to SQL
42967>>>    Function SqlUtilTableIsAttached String sDriverID Handle hTable Returns Boolean
42969>>>        Boolean bExists bRootName
42969>>>        String sRootName sDataPath
42969>>>
42969>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
42972>>>        Move (sRootName contains sDriverID) to bRootName
42973>>>
42973>>>        Get psDataPathFirstPart to sDataPath
42974>>>        Get vFolderExists sDataPath to bExists
42975>>>        If (bExists = False) Begin
42977>>>            // If the path doesn't exist it cannot have an .int file and we're done, although it shouldn't happen.
42977>>>            Function_Return False
42978>>>        End
42978>>>>
42978>>>
42978>>>        Get vFolderFormat sDataPath to sDataPath
42979>>>        Get _TableNameOnly sRootName to sRootName
42980>>>        Get vFilePathExists (sDataPath + sRootName + ".int") to bExists
42981>>>
42981>>>        Function_Return (bRootName = True and bExists = True)
42982>>>    End_Function
42983>>>
42983>>>    Function SqlUtilTableIsViewType String sDriverID Handle hTable Returns Boolean
42985>>>        Boolean bViewTableType bOpen bOK
42985>>>        Integer iTableCount iNumTables
42985>>>        String sTableName sOwner sTableType sEnumTableName sEnumSchemaName
42985>>>        Handle hoCliHandler
42985>>>        tSQLConnection SQLConnection
42985>>>        tSQLConnection SQLConnection
42985>>>
42985>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
42988>>>        If (bOpen = False) Begin
42990>>>            Get AutoConnectionIDLogin to bOK
42991>>>            Open hTable
42993>>>        End
42993>>>>
42993>>>
42993>>>        Get pSQLConnection to SQLConnection
42994>>>        Get phoCLIHandler to hoCliHandler
42995>>>        Set psDriverID of hoCliHandler to sDriverID
42996>>>
42996>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sTableName
42999>>>        Get _TableNameOnly sTableName to sTableName
43000>>>        Get_Attribute DF_FILE_OWNER     of hTable to sOwner
43003>>>        Get EnumerateTables of hoCliHandler SQLConnection.sConnectionString to iNumTables
43004>>>
43004>>>        For iTableCount from 1 to iNumTables
43010>>>>
43010>>>            Get TableName  of hoCliHandler iTableCount to sEnumTableName
43011>>>            Get SchemaName of hoCliHandler iTableCount to sEnumSchemaName
43012>>>            If ((Uppercase(sEnumTableName)  = Uppercase(sTableName)) and (Uppercase(sEnumSchemaName) = Uppercase(sOwner))) Begin
43014>>>                Get TableType of hoCliHandler iTableCount to sTableType
43015>>>                Move iNumTables to iTableCount // We're done.
43016>>>            End
43016>>>>
43016>>>        Loop
43017>>>>
43017>>>
43017>>>        Move (sTableType = "VIEW") to bViewTableType
43018>>>        If (bOpen = False) Begin
43020>>>            Close hTable
43021>>>        End
43021>>>>
43021>>>
43021>>>        Function_Return bViewTableType
43022>>>    End_Function
43023>>>
43023>>>    // *** DbType conversion routines - Converts between string/integer and driver ID values ***
43023>>>    //
43023>>>    // SQL utility function that returns a database type (string) constant
43023>>>    // corresponding to the passed iDbType.
43023>>>    Function SqlUtilDbTypeToString Integer iDbType Returns String
43025>>>        String sRetval
43025>>>        Get SqlUtilDbTypeToString of (phoSQLConnectionIniFile(ghoSQLConnectionHandler)) iDbType to sRetval
43026>>>        Function_Return sRetval
43027>>>    End_Function
43028>>>
43028>>>    // SQL utility function that returns a database type constant (integer)
43028>>>    // corresponding to the passed sDbType string constant.
43028>>>    Function SqlUtilDbTypeToInteger String sDbType Returns Integer
43030>>>        Integer iRetval
43030>>>        Get SqlUtilDbTypeToInteger of (phoSQLConnectionIniFile(ghoSQLConnectionHandler)) sDbType to iRetval
43031>>>        Function_Return iRetval
43032>>>    End_Function
43033>>>
43033>>>    // Pass an integer DbType and function returns the database type integer as a string value.
43033>>>    // Used e.g. when reading a connection ini-file to display the database type in
43033>>>    // the SQL Connection program's grid.
43033>>>    Function SqlUtilDbTypeIntegerToStringConstant Integer iDbType Returns String
43035>>>        String sRetval
43035>>>        Get SqlUtilDbTypeIntegerToStringConstant of (phoSQLConnectionIniFile(ghoSQLConnectionHandler)) iDbType to sRetval
43036>>>        Function_Return sRetval
43037>>>    End_Function
43038>>>
43038>>>    // Pass a driver name as a string and the function will return
43038>>>    // a dbType as an integer. Obviously for the ODBC_DRV this doesn't
43038>>>    // quite work and always returns "MS SQL Server"
43038>>>    Function SqlUtilDbTypeFromDriver String sDriverID Returns Integer
43040>>>        Integer iRetval
43040>>>        Get SqlUtilDbTypeFromDriver of (phoSQLConnectionIniFile(ghoSQLConnectionHandler)) sDriverID to iRetval
43041>>>        Function_Return iRetval
43042>>>    End_Function
43043>>>
43043>>>    // Returns a temp table name that consists of the RootName, an underscore and as much of a GUID
43043>>>    // that "fits" in the max allowed length for table names.
43043>>>    // Max number of characters allowed for table names;
43043>>>    // IBM DB2      = 128
43043>>>    // MS-SQL       = 128
43043>>>    // Oracle       = 128 (Version 12.2 and later. 30 characters for earlier versions)
43043>>>    // MySQL        = 64
43043>>>    // PostgreSQL   = 64
43043>>>    Function SqlUtilGUIDTempTableName String sRootName Returns String
43045>>>        String sGUIDName
43045>>>        Integer iDbType iLength
43045>>>
43045>>>        Get piDbType to iDbType
43046>>>        Move (RandomHexUUID()) to sGUIDName
43047>>>        Move (sRootName + "_" + sGUIDName) to sGUIDName
43048>>>        Move (Length(sGUIDName)) to iLength
43049>>>
43049>>>        Case Begin
43049>>>            Case (iDbType = EN_DbTypeDB2)
43051>>>            If (iLength > 128) Begin
43053>>>                Move (Left(sGUIDName, 128)) to sGUIDName
43054>>>            End
43054>>>>
43054>>>            Case Break
43055>>>
43055>>>            Case (iDbType = EN_DbTypeMSSQL)
43058>>>            If (iLength > 128) Begin
43060>>>                Move (Left(sGUIDName, 128)) to sGUIDName
43061>>>            End
43061>>>>
43061>>>            Case Break
43062>>>
43062>>>            Case (iDbType = EN_DbTypeOracle) // Note: We assume an Oracle version of 12.2 or later.
43065>>>            If (iLength > 128) Begin
43067>>>                Move (Left(sGUIDName, 128)) to sGUIDName
43068>>>            End
43068>>>>
43068>>>            Case Break
43069>>>
43069>>>            Case (iDbType = EN_DbTypeMySQL)
43072>>>            If (iLength > 64) Begin
43074>>>                Move (Left(sGUIDName, 64)) to sGUIDName
43075>>>            End
43075>>>>
43075>>>            Case Break
43076>>>
43076>>>            Case (iDbType = EN_DbTypePostgre)
43079>>>            If (iLength > 64) Begin
43081>>>                Move (Left(sGUIDName, 64)) to sGUIDName
43082>>>            End
43082>>>>
43082>>>        Case End
43082>>>
43082>>>        Function_Return sGUIDName
43083>>>    End_Function
43084>>>
43084>>>    // Reads a resource that has been embedded by the compiler and writes it to disk.
43084>>>    // Pass the memory resource file reference and the filename to be created,
43084>>>    // including full path.
43084>>>    Procedure SqlUtilCreateFileFromMemory String sMemFileName String sFileName
43086>>>        String sText
43086>>>        Integer iCh iSize iArgSize
43086>>>
43086>>>        Move ("Resource:" + sMemFileName) to sMemFileName
43087>>>        Get Seq_Open_Input_Channel sMemFileName to iCh
43088>>>            Get_Channel_Size iCh to iSize
43089>>>            Get_Argument_Size to iArgSize
43090>>>            If (iSize > iArgSize) Begin
43092>>>                Set_Argument_Size iSize
43093>>>>
43093>>>            End
43093>>>>
43093>>>            Read_Block channel iCh sText iSize
43095>>>        Send Seq_Close_Channel iCh
43096>>>
43096>>>        Get Seq_Open_Output_Channel sFileName to iCh
43097>>>            Write channel iCh sText
43099>>>        Send Seq_Close_Channel iCh
43100>>>
43100>>>        If (iSize <> iArgSize) Begin
43102>>>            Set_Argument_Size iArgSize
43103>>>>
43103>>>        End
43103>>>>
43103>>>
43103>>>        // Wait for file to be written to disk.
43103>>>        Sleep 2
43104>>>    End_Procedure
43105>>>
43105>>>    Function SqlUtilDefaultNullValue String sDriverID Integer iDbType Integer iDataType Returns String
43107>>>        String sNotNull sRetval sDefaultValue
43107>>>        Boolean bOK
43107>>>
43107>>>        Get IsSQLDriver sDriverID to bOK
43108>>>        If (bOK = False) Begin
43110>>>            Function_Return ""
43111>>>        End
43111>>>>
43111>>>
43111>>>        Get UtilDataTypeDefaultValue sDriverID iDbType iDataType to sDefaultValue
43112>>>        Get _SqlFindKeyWord CI_SQLNotNull to sNotNull
43113>>>
43113>>>        Case Begin
43113>>>            Case (iDbType = EN_dbTypeMSSQL)
43115>>>                Move ("DEFAULT" * String(sDefaultValue) * String(sNotNull)) to sRetval
43116>>>                Case Break
43117>>>            Case (iDbType = EN_dbTypeMySQL)
43120>>>                Move (String(sNotNull) * "DEFAULT" * String(sDefaultValue)) to sRetval
43121>>>                Case Break
43122>>>            Case (iDbType = EN_dbTypePostgre)
43125>>>                Move (String(sNotNull) * "DEFAULT" * String(sDefaultValue)) to sRetval
43126>>>                Case Break
43127>>>            Case (iDbType = EN_dbTypeDB2)
43130>>>                Move (String(sNotNull))                                     to sRetval
43131>>>                Case Break
43132>>>
43132>>>            // Seems like Oracle can't handle setting a new column to 'NOT NULL' if the table exists with data(!)
43132>>>            // ToDo: We need to look deeper into how Oracle handles NULL
43132>>>            Case (iDbType = EN_dbTypeOracle)
43135>>>                Move  ""                                                    to sRetval
43136>>>                Case Break
43137>>>
43137>>>            Case Else
43137>>>                Move  ""                                                    to sRetval
43138>>>        Case End
43138>>>
43138>>>        Function_Return sRetval
43139>>>    End_Function
43140>>>
43140>>>    Function SqlUtilUpdateIntFile Integer hTable Returns Boolean
43142>>>        String sOrgFormat sNewFormat sRootName sDatabaseName sPhysicalFileName sDriverID sDataPath
43142>>>        Boolean bOpened bOK bMertech
43142>>>
43142>>>        // For some reason this .int file update screws up of CodeMast & CodeType .int files
43142>>>        // which makes the program unable to run because they can't be opened.
43142>>>        // ToDo: This needs further investigation but for now we just skip CodeMast & CodeType .int files update...
43142>>>        // Also note that there is another helper function "UtilTableCreateCodeMastCodeTypeIntFiles" to create
43142>>>        // proper .int files for the two tables.
43142>>>        If (Uppercase(sDatabaseName) = "CODETYPE" or Uppercase(sDatabaseName) = "CODEMAST") Begin
43144>>>            Function_Return True
43145>>>        End
43145>>>>
43145>>>
43145>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
43148>>>        Get _TableNameOnly sRootName to sDatabaseName
43149>>>        Move CS_OEM_Txt  to sOrgFormat
43150>>>        Move CS_ANSI_Txt to sNewFormat
43151>>>        Get AutoConnectionIDLogin to bOK
43152>>>
43152>>>        // It seems this can be called to quickly; causing a 13001 error "Cannot open cache file for write"
43152>>>        Sleep 2
43153>>>        Get OpenTableExclusive hTable to bOpened
43154>>>        If (bOpened = False) Begin
43156>>>            Function_Return False
43157>>>        End
43157>>>>
43157>>>
43157>>>        Get psDriverID to sDriverID
43158>>>        Get IsMertechDriver sDriverID to bMertech
43159>>>        If (bMertech = True) Begin
43161>>>            Get psDataPathFirstPart to sDataPath
43162>>>            Get vFolderExists sDataPath to bOK
43163>>>            If (bOK = False) Begin
43165>>>                Error DFERR_PROGRAM "Function SqlUtilUpdateIntFile; psDataPath not found!"
43166>>>>
43166>>>                Function_Return False
43167>>>            End
43167>>>>
43167>>>            Get vFolderFormat sDataPath to sDataPath
43168>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
43171>>>            Get _TableNameOnly sRootName to sDatabaseName
43172>>>            Move sDatabaseName to sPhysicalFileName
43173>>>            Move (sPhysicalFileName + ".int") to sPhysicalFileName
43174>>>            Get _MertechSqlUtilCreateIntFile hTable sDataPath sPhysicalFileName to bOK
43175>>>            Function_Return (bOK = True)
43176>>>        End
43176>>>>
43176>>>
43176>>>        Move False to Err
43177>>>        Get_Attribute DF_FILE_TABLE_CHARACTER_FORMAT of hTable to sOrgFormat
43180>>>        Move (Uppercase(sOrgFormat)) to sOrgFormat
43181>>>        // Lets swap the OEM/ANSI format, just to make a change in Structure_Start below (and back),
43181>>>        // to "touch" the table so the driver feels there has been a change and updates the .int file.
43181>>>        Move (If(sOrgFormat = CS_OEM_Txt, CS_ANSI_Txt, CS_OEM_Txt)) to sNewFormat
43182>>>
43182>>>        If (hTable > 0) Begin
43184>>>            Structure_Start hTable
43185>>>                Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT of hTable to sNewFormat
43188>>>                Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT of hTable to sOrgFormat
43191>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
43193>>>        End
43193>>>>
43193>>>        Else Begin
43194>>>            Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT of hTable to sNewFormat
43197>>>            Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT of hTable to sOrgFormat
43200>>>        End
43200>>>>
43200>>>        Function_Return (Err = False)
43201>>>    End_Function
43202>>>
43202>>>    Function SqlProcedureArrayMertech String sStmt String sArgument Returns String[]
43204>>>        String[] sReturnArray
43205>>>        String sValue sUserID sPassword
43205>>>        Handle hoSQLHandler hoSQLConnect hStmt
43205>>>        Integer iFetchResult iRetval
43205>>>        tSQLConnection SQLConnection
43205>>>        tSQLConnection SQLConnection
43205>>>
43205>>>        Get _MertechSQLManagerHandle to hoSQLHandler
43206>>>        If (hoSQLHandler <> 0) Begin
43208>>>            Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
43209>>>            Get SQLConnect of hoSQLHandler SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sUserID SQLConnection.sPassword to hoSQLConnect
43210>>>            If (hoSQLConnect <> 0) Begin
43212>>>                Get SQLOpen of hoSQLConnect to hStmt
43213>>>                If (hStmt <> 0) Begin
43215>>>                    Send SQLSetProcedureName of hStmt sStmt
43216>>>                    If (sArgument <> "") Begin
43218>>>                        Send SqlSetArgument  of hStmt 1 sArgument
43219>>>                    End
43219>>>>
43219>>>                    Send SQLCall of hStmt
43220>>>
43220>>>                    Get SqlReturnValue       of hStmt to iRetval
43221>>>                    If (iRetval = 0) Begin
43223>>>                        Repeat
43223>>>>
43223>>>                            Get SQLFetch of hStmt to iFetchResult
43224>>>                            If (iFetchResult <> 0) Begin
43226>>>                                Get SQLColumnValue of hStmt 1 to sValue
43227>>>                                Move (Trim(sValue)) to sReturnArray[SizeOfArray(sReturnArray)
43228>>>                            End
43228>>>>
43228>>>                        Until (iFetchResult = 0)
43230>>>                        Send SQLClose of hStmt
43231>>>                    End
43231>>>>
43231>>>                End
43231>>>>
43231>>>                Send SQLDisconnect of hoSQLConnect
43232>>>            End
43232>>>>
43232>>>        End
43232>>>>
43232>>>
43232>>>        Function_Return sReturnArray
43233>>>    End_Function
43234>>>
43234>>>    // * Dummy function for the Studio's Code Explorer *
43234>>>    Function SQL_ENUMERATION_FUNCTIONS Returns Boolean
43236>>>        Function_Return False
43237>>>    End_Function
43238>>>
43238>>>    // Enumerate SQL Servers.
43238>>>    // Pass a driver id. Returns a string array.
43238>>>    // The iDataSourceType (iDatSrcType) parameter is optional and is for the ODBC driver only.
43238>>>    // Note: Returns servers for MSSQLDRV; else data-sources on the machine.
43238>>>    Function SqlUtilEnumerateServers String sDriverID Integer iDatSrcType Returns String[]
43240>>>        String[] sReturnArray
43241>>>        Handle hoSQLHandler
43241>>>        String sServer
43241>>>        Integer iCount iNumItems iDataSourceType
43241>>>
43241>>>        If (num_arguments > 1) Begin
43243>>>            Move iDatSrcType to iDataSourceType
43244>>>        End
43244>>>>
43244>>>
43244>>>        Case Begin
43244>>>            Case (sDriverID = MSSQLDRV_ID)
43246>>>                Get phoMSSQLHandler to hoSQLHandler
43247>>>                // Not sure why, but this doesn't seem to work with the updated DAW MSSQLDRV driver.
43247>>>//                #IFNDEF get_ComparetConnectionById
43247>>>//                    Get EnumerateServers of hoSQLHandler to iNumItems
43247>>>//                #ELSE
43247>>>//                    Get EnumerateServersLocal of hoSQLHandler to iNumItems
43247>>>//                    If (iNumItems = 0) Begin
43247>>>                        Get EnumerateServers of hoSQLHandler to iNumItems
43248>>>//                    End
43248>>>//                #ENDIF
43248>>>                For iCount from 0 to (iNumItems - 1)
43254>>>>
43254>>>                    Get String_Value of hoSQLHandler item iCount to sServer
43255>>>                    Move (Trim(sServer)) to sReturnArray[iCount]
43256>>>                Loop
43257>>>>
43257>>>                Case Break
43258>>>
43258>>>            Case (sDriverID = DB2_DRV_ID)
43261>>>                Get phoDB2SQLHandler to hoSQLHandler
43262>>>                Send SeedDataSources of hoSQLHandler
43263>>>                Move 0 to iCount
43264>>>                Repeat
43264>>>>
43264>>>                    Get DataSources of hoSQLHandler to sServer
43265>>>                    If (sServer <> "") Begin
43267>>>                        Move (Replace(",", sServer, "")) to sServer
43268>>>                        Move sServer to sReturnArray[iCount]
43269>>>                    End
43269>>>>
43269>>>                    Increment iCount
43270>>>                Until (sServer = "")
43272>>>                Case Break
43273>>>
43273>>>            Case (sDriverID = ODBC_DRV_ID)
43276>>>                Get phoODBCSQLHandler to hoSQLHandler
43277>>>                Set DataSourceType of hoSQLHandler to iDataSourceType
43278>>>                Move 0 to iCount
43279>>>                Repeat
43279>>>>
43279>>>                    Get DataSources of hoSQLHandler to sServer
43280>>>                    If (sServer <> "") Begin
43282>>>                        Move (Replace(",", sServer, ", ")) to sServer
43283>>>                        Move sServer to sReturnArray[iCount]
43284>>>                    End
43284>>>>
43284>>>                    Increment iCount
43285>>>                Until (sServer = "")
43287>>>                Case Break
43288>>>
43288>>>            Case (sDriverID = SQLFLEX)
43291>>>                Get _MertechEnumerateSQLFlexServers to sReturnArray
43292>>>                Case Break
43293>>>
43293>>>            Case (sDriverID = ORAFLEX)
43296>>>                Get _MertechEnumerateORAFLEXServers to sReturnArray
43297>>>                Case Break
43298>>>
43298>>>            // There appearantly is no way to enumerate servers for this backend.
43298>>>            Case (sDriverID = MDSPgSQL)
43301>>>                Move "localhost" to sReturnArray[0]
43302>>>                Case Break
43303>>>
43303>>>            // There appearantly is no way to enumerate servers for this backend.
43303>>>            Case (sDriverID = MDSMySQL)
43306>>>                Move "localhost" to sReturnArray[0]
43307>>>                Case Break
43308>>>
43308>>>            Case Else
43308>>>                Error DFERR_PROGRAM "Unsupported DriverID passed to SqlUtilEnumerateServers function"
43309>>>>
43309>>>        Case End
43309>>>
43309>>>        Function_Return sReturnArray
43310>>>    End_Function
43311>>>
43311>>>    // Returns all databases as a string array for the passed driver id.
43311>>>    Function SqlUtilEnumerateDatabases String sDriverID Returns String[]
43313>>>        String[] sReturnArray
43314>>>        Boolean bOK
43314>>>
43314>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43315>>>        If (bOK = False) Begin
43317>>>            Function_Return sReturnArray
43318>>>        End
43318>>>>
43318>>>
43318>>>        Case Begin
43318>>>            Case (sDriverID = MSSQLDRV_ID)
43320>>>                Get _SqlDatabasesArrayMSSQL to sReturnArray
43321>>>                Case Break
43322>>>            Case (sDriverID = DB2_DRV_ID)
43325>>>                Get _SqlDatabasesArrayDB2 to sReturnArray
43326>>>                Case Break
43327>>>
43327>>>            // Enumeration of ODBC databases should be irrelevant as the database
43327>>>            // should have been specified when the ODBC source was setup with the ODBC manager.
43327>>>            Case (sDriverID = ODBC_DRV_ID)
43330>>>                Case Break
43331>>>
43331>>>            Case (sDriverID = SQLFLEX)
43334>>>                Get SqlProcedureArrayMertech "sp_databases" "" to sReturnArray
43335>>>                Case Break
43336>>>
43336>>>            Case (sDriverID = MDSPgSQL)
43339>>>                Get SqlEnumerateEsqlMertech "SELECT datname FROM pg_database" to sReturnArray
43340>>>                Case Break
43341>>>
43341>>>            Case (sDriverID = MDSMySQL)
43344>>>                Get SqlEnumerateEsqlMertech "show databases" to sReturnArray
43345>>>                Case Break
43346>>>
43346>>>            Case (sDriverID = ORAFLEX)
43349>>>                Get SqlEnumerateEsqlMertech "SELECT NAME FROM v$database" to sReturnArray
43350>>>                Case Break
43351>>>
43351>>>            Case Else
43351>>>                Error DFERR_PROGRAM "Unsupported DriverID passed to SqlUtilEnumerateDatabases function"
43352>>>>
43352>>>        Case End
43352>>>
43352>>>        Function_Return sReturnArray
43353>>>    End_Function
43354>>>
43354>>>    // Returns all table spaces as a string array for the passed driver id.
43354>>>    Function SqlUtilEnumerateTableSpaces String sDriverID Returns String[]
43356>>>        String[] sReturnArray
43357>>>        Boolean bOK
43357>>>
43357>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43358>>>        If (bOK = False) Begin
43360>>>            Function_Return sReturnArray
43361>>>        End
43361>>>>
43361>>>
43361>>>        Case Begin
43361>>>            Case (sDriverID = DB2_DRV_ID)
43363>>>                Get SqlEnumerateEsqlDAW "select tablespace_name from dba_tablespaces" 1 to sReturnArray
43364>>>                Case Break
43365>>>
43365>>>            Case (sDriverID = MDSPgSQL)
43368>>>                Get SqlEnumerateEsqlMertech "SELECT spcname FROM pg_tablespace" 1 to sReturnArray
43369>>>                Case Break
43370>>>
43370>>>            Case (sDriverID = ORAFLEX)
43373>>>                Get SqlEnumerateEsqlMertech "SELECT TABLESPACE_NAME FROM USER_TABLESPACES" 1 to sReturnArray
43374>>>                Case Break
43375>>>
43375>>>            Case Else
43375>>>                Error DFERR_PROGRAM "Unsupported driver passed to SqlUtilEnumerateTableSpaces function."
43376>>>>
43376>>>                Case Break
43377>>>        Case End
43377>>>
43377>>>        Function_Return sReturnArray
43378>>>    End_Function
43379>>>
43379>>>    // Returns all schemas as a string array for the passed driver id.
43379>>>    Function SqlUtilEnumerateSchemas String sDriverID Returns String[]
43381>>>        String[] sReturnArray
43382>>>        Boolean bOK
43382>>>
43382>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43383>>>        If (bOK = False) Begin
43385>>>            Function_Return sReturnArray
43386>>>        End
43386>>>>
43386>>>
43386>>>        Case Begin
43386>>>            Case (sDriverID = DB2_DRV_ID)
43388>>>                Get SqlEnumerateEsqlDAW "select schemaname from syscat.schemata" 1 to sReturnArray
43389>>>                Case Break
43390>>>
43390>>>            Case (sDriverID = MDSPgSQL)
43393>>>                Get SqlEnumerateEsqlMertech "select schema_name from information_schema.schemata" 1 to sReturnArray
43394>>>                Case Break
43395>>>
43395>>>            Case (sDriverID = ORAFLEX)
43398>>>                Get SqlEnumerateEsqlMertech "SELECT username from dba_users WHERE default_tablespace not in ('SYSTEM','SYSAUX')" 1 to sReturnArray
43399>>>                Case Break
43400>>>
43400>>>            Case Else
43400>>>                Error DFERR_PROGRAM "Unsupported driver passed to SqlUtilEnumerateSchemas function."
43401>>>>
43401>>>                Case Break
43402>>>        Case End
43402>>>
43402>>>        Function_Return sReturnArray
43403>>>    End_Function
43404>>>
43404>>>    // Returns a string array with all tables for the current database.
43404>>>    Function SqlUtilEnumerateTables String sDriverID Returns String[]
43406>>>        String[] sReturnArray sArray
43408>>>        String sDatabase sConnectionString sSelect sSchema
43408>>>        Integer iSize iCount
43408>>>        Boolean bOK
43408>>>
43408>>>        If (sDriverID = DATAFLEX_ID) Begin
43410>>>            Function_Return sArray
43411>>>        End
43411>>>>
43411>>>
43411>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43412>>>        If (bOK = False) Begin
43414>>>            Function_Return sReturnArray
43415>>>        End
43415>>>>
43415>>>
43415>>>        Get psConnectionString to sConnectionString
43416>>>        Get psDatabase to sDatabase
43417>>>        Get psSchema   to sSchema
43418>>>
43418>>>        Case Begin
43418>>>            Case (sDriverID = MSSQLDRV_ID)
43420>>>                Get _SqlTableArrayDAW to sReturnArray
43421>>>                Case Break
43422>>>
43422>>>            Case (sDriverID = DB2_DRV_ID)
43425>>>                Get _SqlTableArrayDAW to sReturnArray
43426>>>                Case Break
43427>>>
43427>>>            Case (sDriverID = ODBC_DRV_ID)
43430>>>                Get _SqlTableArrayDAW to sReturnArray
43431>>>                Case Break
43432>>>
43432>>>            Case (sDriverID = SQLFLEX)
43435>>>                Move ("SELECT TABLE_NAME FROM" * sDatabase + ".INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE != 'VIEW'") to sSelect
43436>>>                Get SqlEnumerateEsqlMertech sSelect to sReturnArray
43437>>>                Case Break
43438>>>
43438>>>            Case (sDriverID = MDSMySQL)
43441>>>                Move ("SELECT TABLE_NAME from INFORMATION_SCHEMA.TABLES where TABLE_SCHEMA = '" + sDatabase + "' and TABLE_TYPE = 'BASE TABLE' order by TABLE_NAME") to sSelect
43442>>>                Get SqlEnumerateEsqlMertech sSelect to sReturnArray
43443>>>                Case Break
43444>>>
43444>>>            Case (sDriverID = MDSPgSQL)
43447>>>                Move "select tablename, schemaname from pg_catalog.pg_tables order by tablename"  to sSelect
43448>>>                Get SqlEnumerateEsqlMertech sSelect "" to sReturnArray
43449>>>                Case Break
43450>>>
43450>>>            Case (sDriverID = ORAFLEX)
43453>>>                Move "SELECT table_name from user_tables" to sSelect
43454>>>                Get SqlEnumerateEsqlMertech sSelect to sArray
43455>>>                Move (SizeOfArray(sArray)) to iSize
43456>>>                Decrement iSize
43457>>>                For iCount from 0 to iSize
43463>>>>
43463>>>                    If (not(sArray[iCount] contains "$")) Begin
43465>>>                        Move sArray[iCount] to sReturnArray[SizeOfArray(sReturnArray)]
43466>>>                    End
43466>>>>
43466>>>                Loop
43467>>>>
43467>>>                Case Break
43468>>>
43468>>>            Case Else
43468>>>                Error DFERR_PROGRAM "Unsupported driver passed to SqlUtilEnumerateTables function."
43469>>>>
43469>>>                Case Break
43470>>>        Case End
43470>>>
43470>>>        Function_Return sReturnArray
43471>>>    End_Function
43472>>>
43472>>>    // Returns a string array with all table columns/fields for the passed table handle and driver id.
43472>>>    Function SqlUtilEnumerateColumns String sDriverID String sTableName Returns String[]
43474>>>        String[] sReturnArray
43475>>>        String sConnectionString sSelect sSchema
43475>>>        Boolean bOK
43475>>>
43475>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43476>>>        If (bOK = False) Begin
43478>>>            Error DFERR_PROGRAM ("Unsupported driver. A list of table columns could not be retrieved for:" * sDriverID + ".")
43479>>>>
43479>>>            Function_Return sReturnArray
43480>>>        End
43480>>>>
43480>>>
43480>>>        Get psConnectionString to sConnectionString
43481>>>        Get psSchema to sSchema
43482>>>
43482>>>        Case Begin
43482>>>            Case (sDriverID = MSSQLDRV_ID)
43484>>>                Move ("select name from sys.columns where [object_id] = object_id('dbo." + sTableName + "')") to sSelect
43485>>>                Get SqlEnumerateEsqlDAW sSelect 1 to sReturnArray
43486>>>                Case Break
43487>>>
43487>>>            Case (sDriverID = DB2_DRV_ID)
43490>>>                Move ("SELECT colname from syscat.columns WHERE tabschema = '" + sSchema + "'" * "AND tabname = '" + sTableName + "'") to sSelect
43491>>>                Get SqlEnumerateEsqlDAW sSelect 1 to sReturnArray
43492>>>                Case Break
43493>>>
43493>>>            Case (sDriverID = SQLFLEX)
43496>>>                Move ("select name from sys.columns where [object_id] = object_id('dbo." + sTableName + "')") to sSelect
43497>>>                Get SqlEnumerateEsqlMertech sSelect 1 to sReturnArray
43498>>>                Case Break
43499>>>
43499>>>            Case (sDriverID = MDSMySQL)
43502>>>                Move ("SHOW COLUMNS FROM" * sTableName) to sSelect
43503>>>                Get SqlEnumerateEsqlMertech sSelect 1 to sReturnArray
43504>>>                Case Break
43505>>>
43505>>>            Case (sDriverID = MDSPgSQL)
43508>>>                Move ("select column_name, data_type, character_maximum_length from INFORMATION_SCHEMA.COLUMNS where table_name = '" +sTableName + "'") to sSelect
43509>>>                Get SqlEnumerateEsqlMertech sSelect 1 to sReturnArray
43510>>>                Case Break
43511>>>
43511>>>            Case (sDriverID = ORAFLEX)
43514>>>                Move ("SELECT column_name from user_tab_cols WHERE table_name = '" + sTableName + "'") to sSelect
43515>>>                Get SqlEnumerateEsqlMertech sSelect 1 to sReturnArray
43516>>>                Case Break
43517>>>
43517>>>            Case Else
43517>>>                Error DFERR_PROGRAM "Unsupported driver passed to SqlUtilEnumerateColumns function."
43518>>>>
43518>>>                Case Break
43519>>>        Case End
43519>>>
43519>>>        Function_Return sReturnArray
43520>>>    End_Function
43521>>>
43521>>>
43521>>>    // Returns a string array with all table indexes for the passed table handle and driver id.
43521>>>    Function SqlUtilEnumerateIndexes String sTableName String sDriverID Returns String[]
43523>>>        String[] sReturnArray sReturnArray2
43525>>>        String sConnectionString sSelect sSchema
43525>>>        Boolean bOK
43525>>>        Integer iCount iSize
43525>>>
43525>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43526>>>        If (bOK = False) Begin
43528>>>            Error DFERR_PROGRAM ("Unsupported driver. A list of table columns could not be retrieved for:" * sDriverID + ".")
43529>>>>
43529>>>            Function_Return sReturnArray
43530>>>        End
43530>>>>
43530>>>
43530>>>        Get psConnectionString to sConnectionString
43531>>>        Get psSchema to sSchema
43532>>>
43532>>>        Case Begin
43532>>>            Case (sDriverID = MSSQLDRV_ID)
43534>>>                Move ("select * from sys.indexes where object_id = (select object_id from sys.objects where name = '" + sTableName + "')") to sSelect
43535>>>                Get SqlEnumerateEsqlDAW sSelect 2 to sReturnArray
43536>>>                Case Break
43537>>>
43537>>>            Case (sDriverID = DB2_DRV_ID)
43540>>>                Error "Not implemented yet! The select statement has not been finalized."
43541>>>>
43541>>>//                Move () to sSelect
43541>>>//                Get SqlEnumerateEsqlDAW sSelect 2 to sReturnArray
43541>>>                Case Break
43542>>>
43542>>>            Case (sDriverID = SQLFLEX)
43545>>>                Error "Not implemented yet! The select statement has not been finalized."
43546>>>>
43546>>>//                Move () to sSelect
43546>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43546>>>                Case Break
43547>>>
43547>>>            Case (sDriverID = MDSMySQL)
43550>>>                Error "Not implemented yet! The select statement has not been finalized."
43551>>>>
43551>>>//                Move () to sSelect
43551>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43551>>>                Case Break
43552>>>
43552>>>            Case (sDriverID = MDSPgSQL)
43555>>>                Error "Not implemented yet! The select statement has not been finalized."
43556>>>>
43556>>>//                Move () to sSelect
43556>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43556>>>                Case Break
43557>>>
43557>>>            Case (sDriverID = ORAFLEX)
43560>>>                Error "Not implemented yet! The select statement has not been finalized."
43561>>>>
43561>>>//                Move () to sSelect
43561>>>//                Get SqlEnumerateEsqlMertech sSelect to sReturnArray
43561>>>                Case Break
43562>>>
43562>>>            Case Else
43562>>>                Error DFERR_PROGRAM "Unsupported driver passed to SqlUtilEnumerateIndexes function."
43563>>>>
43563>>>                Case Break
43564>>>        Case End
43564>>>
43564>>>        Move (SizeOfArray(sReturnArray)) to iSize
43565>>>        Decrement iSize
43566>>>        For iCount from 0 to iSize
43572>>>>
43572>>>            If (Trim(sReturnArray[iCount]) <> "") Begin
43574>>>                Move sReturnArray[iCount] to sReturnArray2[SizeOfArray(sReturnArray2)]
43575>>>            End
43575>>>>
43575>>>        Loop
43576>>>>
43576>>>
43576>>>        Function_Return sReturnArray2
43577>>>    End_Function
43578>>>
43578>>>    // Returns a string array with all table names the passed table handle has relation ships with.
43578>>>    // The format of the array is "TableName.FieldName"
43578>>>    Function SqlUtilEnumerateRelations String sTableName String sDriverID Returns tSQLRelation[]
43580>>>        String[] sFileNameArray sFieldNameArray
43582>>>        tSQLRelation[] sRelationsArray
43582>>>        tSQLRelation[] sRelationsArray
43583>>>        String sConnectionString sSelect sSchema sFileName sFieldName
43583>>>        Boolean bOK
43583>>>        Integer iCount iSize iLength
43583>>>
43583>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
43584>>>        If (bOK = False) Begin
43586>>>            Error DFERR_PROGRAM ("Unsupported driver. A list of table columns could not be retrieved for:" * sDriverID + ".")
43587>>>>
43587>>>            Function_Return sRelationsArray
43588>>>        End
43588>>>>
43588>>>
43588>>>        Get psConnectionString to sConnectionString
43589>>>        Get psSchema to sSchema
43590>>>
43590>>>        Case Begin
43590>>>            Case (sDriverID = MSSQLDRV_ID)
43592>>>                Move ("SELECT object_name(parent_object_id), object_name(referenced_object_id), name from sys.foreign_keys WHERE parent_object_id = object_id( '" + sTableName + "')") to sSelect
43593>>>                Get SqlEnumerateEsqlDAW sSelect 2 to sFileNameArray
43594>>>                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43595>>>                Case Break
43596>>>
43596>>>            Case (sDriverID = DB2_DRV_ID)
43599>>>                Error "Not implemented yet! The select statement has not been finalized."
43600>>>>
43600>>>//                Move () to sSelect
43600>>>//                Get SqlEnumerateEsqlDAW sSelect 2 to sReturnArray
43600>>>//                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43600>>>                Case Break
43601>>>
43601>>>            Case (sDriverID = SQLFLEX)
43604>>>                Error "Not implemented yet! The select statement has not been finalized."
43605>>>>
43605>>>//                Move () to sSelect
43605>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43605>>>//                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43605>>>                Case Break
43606>>>
43606>>>            Case (sDriverID = MDSMySQL)
43609>>>                Error "Not implemented yet! The select statement has not been finalized."
43610>>>>
43610>>>//                Move () to sSelect
43610>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43610>>>//                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43610>>>                Case Break
43611>>>
43611>>>            Case (sDriverID = MDSPgSQL)
43614>>>                Error "Not implemented yet! The select statement has not been finalized."
43615>>>>
43615>>>//                Move () to sSelect
43615>>>//                Get SqlEnumerateEsqlMertech sSelect 2 to sReturnArray
43615>>>//                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43615>>>                Case Break
43616>>>
43616>>>            Case (sDriverID = ORAFLEX)
43619>>>                Error "Not implemented yet! The select statement has not been finalized."
43620>>>>
43620>>>//                Move () to sSelect
43620>>>//                Get SqlEnumerateEsqlMertech sSelect to sReturnArray
43620>>>//                Get SqlEnumerateEsqlDAW sSelect 3 to sFieldNameArray
43620>>>                Case Break
43621>>>
43621>>>            Case Else
43621>>>                Error DFERR_PROGRAM "Unsupported driver passed to the SqlUtilEnumerateRelations function."
43622>>>>
43622>>>                Case Break
43623>>>        Case End
43623>>>
43623>>>        Move (Length(sTableName)) to iLength
43624>>>        Move (iLength + 4)        to iLength // The related to field key has the format "FK_TableName + FieldName"
43625>>>        Move (SizeOfArray(sFileNameArray)) to iSize
43626>>>        Decrement iSize
43627>>>        For iCount from 0 to iSize
43633>>>>
43633>>>            If (Trim(sFileNameArray[iCount]) <> "") Begin
43635>>>                Move sFileNameArray[iCount]         to sFileName
43636>>>                Move sFieldNameArray[iCount]        to sFieldName
43637>>>                Move (Mid(sFieldName, 99, iLength)) to sFieldName
43638>>>                Move sFileName  to sRelationsArray[iCount].sFileName
43639>>>                Move sFieldName to sRelationsArray[iCount].sFieldName
43640>>>            End
43640>>>>
43640>>>        Loop
43641>>>>
43641>>>
43641>>>        Function_Return sRelationsArray
43642>>>    End_Function
43643>>>
43643>>>    Function SqlUtilEnumerateLoggedInUsers String sDriverID String sDatabase Returns tSQLLoggedInUser[]
43645>>>        tSQLLoggedInUser[] SQLLoggedInUser
43645>>>        tSQLLoggedInUser[] SQLLoggedInUser
43646>>>        String[] sUsers sPrograms
43648>>>        String sSelect
43648>>>        Integer iSize iCount
43648>>>
43648>>>        Case Begin
43648>>>            Case (sDriverID = MSSQLDRV_ID)
43650>>>                Move ("SELECT RTRIM(SP.nt_username) AS Inlog, RTRIM(SP.program_name) as Programma from master.dbo.sysprocesses SP INNER JOIN master.dbo.sysdatabases SD ON SP.dbid = SD.dbid WHERE (SP.nt_username <> '') and (SP.nt_username <> 'SYSTEM') and (SD.name = '" ;                + sDatabase + "') ORDER by Inlog") to sSelect
43651>>>                Get SqlEnumerateEsqlDAW sSelect 1 to sUsers
43652>>>                Get SqlEnumerateEsqlDAW sSelect 2 to sPrograms
43653>>>                Case Break
43654>>>            Case (sDriverID = SQLFLEX)
43657>>>                Move ("SELECT RTRIM(SP.nt_username) AS Inlog, RTRIM(SP.program_name) as Programma from master.dbo.sysprocesses SP INNER JOIN master.dbo.sysdatabases SD ON SP.dbid = SD.dbid WHERE (SP.nt_username <> '') and (SP.nt_username <> 'SYSTEM') and (SD.name = '" ;                + sDatabase + "') ORDER by Inlog") to sSelect
43658>>>                Get SqlEnumerateEsqlMertech sSelect 1 to sUsers
43659>>>                Get SqlEnumerateEsqlMertech sSelect 2 to sPrograms
43660>>>                Case Break
43661>>>            Case Else
43661>>>                Error DFERR_PROGRAM ("Not implemented yet for this driver (" + sDriverID + ")")
43662>>>>
43662>>>        Case End
43662>>>
43662>>>        Move (SizeOfArray(sUsers)) to iSize
43663>>>        Decrement iSize
43664>>>        For iCount from 0 to iSize
43670>>>>
43670>>>            Move sUsers[iCount]    to SQLLoggedInUser[iCount].sUser
43671>>>            Move sPrograms[iCount] to SQLLoggedInUser[iCount].sProgram
43672>>>        Loop
43673>>>>
43673>>>
43673>>>        Function_Return SQLLoggedInUser
43674>>>    End_Function
43675>>>
43675>>>    // Returns an array with all ".int" files for the passed sDataPath, _except_ for the driver .int files;
43675>>>    // "MSSQLDRV.int", "DB2_DRV.int" & "ODBC_DRV.int".
43675>>>    Function SqlUtilEnumerateIntFiles String sDataPath Returns String[]
43677>>>        String[] sFilesData
43678>>>        Boolean bExists
43678>>>        Integer iCh
43678>>>        String sFileName sExt
43678>>>
43678>>>        Get vFolderExists sDataPath to bExists
43679>>>        If (bExists = True) Begin
43681>>>            Move (ToANSI(Trim(sDataPath))) to sDataPath
43682>>>            Move ("dir:" + sDataPath)      to sDataPath
43683>>>            Get Seq_New_Channel to iCh  // get free channel for input
43684>>>            Direct_Input channel iCh sDataPath
43686>>>                Repeat
43686>>>>
43686>>>                    Readln channel iCh sFileName
43688>>>                    Get ParseFileExtension sFileName to sExt
43689>>>                    If (Uppercase(sExt) = "INT") Begin
43691>>>                        If (not(Uppercase(sFileName) contains "MSSQLDRV" and Uppercase(sFileName) contains "DB2_DRV" and Uppercase(sFileName) contains "ODBC_DRV")) Begin
43693>>>                            Move sFileName to sFilesData[SizeOfArray(sFilesData)]
43694>>>                        End
43694>>>>
43694>>>                    End
43694>>>>
43694>>>                Until (SeqEof = True)
43696>>>            Close_Input channel iCh
43698>>>        End
43698>>>>
43698>>>        Function_Return sFilesData
43699>>>    End_Function
43700>>>
43700>>>    // To enumerate SQL database resources with ESQL and return the result as a string array,
43700>>>    // for DAW drivers.
43700>>>    // Returns: A string array.
43700>>>    Function SqlEnumerateEsqlDAW String sStmt Integer iColumn Returns String[]
43702>>>        String[] sReturnArray
43703>>>        String sValue sPrevious
43703>>>        Handle hoSQLHandler hoSQLConnect hstmt
43703>>>        Integer iFetchResult iRows
43703>>>        tSQLConnection SQLConnection
43703>>>        tSQLConnection SQLConnection
43703>>>
43703>>>        Get phoSQLManager to hoSQLHandler
43704>>>
43704>>>        If (hoSQLHandler <> 0) Begin
43706>>>            Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
43707>>>            Get SQLConnect of hoSQLHandler SQLConnection.sDriverID SQLConnection.sConnectionString to hoSQLConnect
43708>>>
43708>>>            If (hoSQLConnect <> 0) Begin
43710>>>                Get SQLOpen of hoSQLConnect to hstmt
43711>>>                If (hstmt <> 0) Begin
43713>>>                    Send SqlExecDirect of hstmt sStmt
43714>>>                    Get SqlStmtAttribute of hstmt SqlSTMTATTRIB_ROWCOUNT to iRows
43715>>>                    Repeat
43715>>>>
43715>>>                        Get SQLFetch of hstmt to iFetchResult
43716>>>                        If (iFetchResult <> 0) Begin
43718>>>                            Get SQLColumnValue of hstmt iColumn to sValue
43719>>>                            If (sValue <> sPrevious) Begin
43721>>>                                Move (Trim(sValue)) to sReturnArray[SizeOfArray(sReturnArray)
43722>>>                            End
43722>>>>
43722>>>                            Move sValue to sPrevious
43723>>>                        End
43723>>>>
43723>>>                    Until (iFetchResult = 0)
43725>>>                    Send SQLClose of hstmt
43726>>>                End
43726>>>>
43726>>>                Send SQLDisconnect of hoSQLConnect
43727>>>            End
43727>>>>
43727>>>        End
43727>>>>
43727>>>
43727>>>        Function_Return sReturnArray
43728>>>    End_Function
43729>>>
43729>>>    // To enumerate SQL database resources with ESQL and return the result as a string array,
43729>>>    // for Mertech drivers.
43729>>>    // Returns: A string array.
43729>>>    Function SqlEnumerateEsqlMertech String sStmt Returns String[]
43731>>>        String[] sReturnArray
43732>>>        String sValue sUserID sPassword
43732>>>        Handle hoSQLHandler hoSQLConnect hStmt
43732>>>        Integer iFetchResult iRows
43732>>>        tSQLConnection SQLConnection
43732>>>        tSQLConnection SQLConnection
43732>>>
43732>>>        Get _MertechSQLManagerHandle to hoSQLHandler
43733>>>
43733>>>        If (hoSQLHandler <> 0) Begin
43735>>>            Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
43736>>>            Get SQLConnect of hoSQLHandler SQLConnection.sDriverID SQLConnection.sServer SQLConnection.sUserID SQLConnection.sPassword to hoSQLConnect
43737>>>
43737>>>            If (hoSQLConnect <> 0) Begin
43739>>>                Get SQLOpen of hoSQLConnect to hStmt
43740>>>                If (hStmt <> 0) Begin
43742>>>                    Send SqlExecDirect of hStmt sStmt
43743>>>                    Get SqlStmtAttribute of hStmt SqlSTMTATTRIB_ROWCOUNT to iRows
43744>>>                    Repeat
43744>>>>
43744>>>                        Get SQLFetch of hStmt to iFetchResult
43745>>>                        If (iFetchResult <> 0) Begin
43747>>>                            Get SQLColumnValue of hStmt 1 to sValue
43748>>>                            Move (Trim(sValue)) to sReturnArray[SizeOfArray(sReturnArray)
43749>>>                        End
43749>>>>
43749>>>                    Until (iFetchResult = 0)
43751>>>                    Send SQLClose of hStmt
43752>>>                End
43752>>>>
43752>>>                Send SQLDisconnect of hoSQLConnect
43753>>>            End
43753>>>>
43753>>>        End
43753>>>>
43753>>>
43753>>>        Function_Return sReturnArray
43754>>>    End_Function
43755>>>
43755>>>    // * Dummy function for the Studio's Code Explorer *
43755>>>    Function PRIVATE_SQL_SUB_FUNCTIONS Returns Boolean
43757>>>        Function_Return False
43758>>>    End_Function
43759>>>
43759>>>    // Returns the index for the passed sTableName
43759>>>    // Returns >= 0 if successful. It is e.g. needed to get the SchemaName for a table.
43759>>>    Function _SqlUtilEnumerateTableIndex String sTableName String sDriverID Returns Integer
43761>>>        Integer iIndex iSize iCount
43761>>>        String[] sTablesArray
43762>>>        String sVal sConnectionString
43762>>>
43762>>>        Move -1 to iIndex
43763>>>        Get psConnectionString to sConnectionString
43764>>>        Get SqlUtilEnumerateTables sDriverID to sTablesArray
43765>>>        Move (SizeOfArray(sTablesArray)) to iSize
43766>>>        Decrement iSize
43767>>>        For iCount from 0 to iSize
43773>>>>
43773>>>            Move sTablesArray[iCount] to sVal
43774>>>            If (Uppercase(sVal) = Uppercase(sTableName)) Begin
43776>>>                Move iCount to iIndex // We found it!
43777>>>                Move iSize to iCount  // End the loop
43778>>>            End
43778>>>>
43778>>>        Loop
43779>>>>
43779>>>
43779>>>        Function_Return iIndex
43780>>>    End_Function
43781>>>
43781>>>    // Helper function that builds a string like;
43781>>>    // "SELECT name from [Master].[sys].[databases] where name"
43781>>>    Function _SqlSelectFromWhereName Returns String
43783>>>        String sRetval sSelect sName sFrom sMaster sSys sDatabases sWhere sDBO
43783>>>
43783>>>        Get _SqlFindKeyWord CI_SQLSelect       to sSelect
43784>>>        Get _SqlFindKeyWord CI_SQLName         to sName
43785>>>        Get _SqlFindKeyWord CI_SQLDBO          to sDBO
43786>>>        Get _SqlFindKeyWord CI_SQLFrom         to sFrom
43787>>>        Get _SqlFindKeyWord CI_SQLMaster       to sMaster
43788>>>        Get _SqlFindKeyWord CI_SQLSys          to sSys
43789>>>        Get _SqlFindKeyWord CI_SQLDatabases    to sDatabases
43790>>>        Get _SqlFindKeyWord CI_SQLWhere        to sWhere
43791>>>        Move (sSelect * sName * sFrom * "[" + sMaster + "].[" + sDBO + "].[" + sSys + sDatabases + "]" * sWhere * sName) to sRetval
43792>>>        Function_Return sRetval
43793>>>    End_Function
43794>>>
43794>>>    // Helper function to create a SQL statement like;
43794>>>    // "SELECT * FROM SYS.INDEXES WHERE NAME = MyIndexName AND OBJECT_ID = OBJECT_ID([MySchmaName].[MyTableName])"
43794>>>    // Used for checking if an index exists.
43794>>>    Function _SqlQueryIfIndexExists String sSchemaName String sTableName String sIndexName Returns String
43796>>>        String sRetval sSelect sFrom sSysIndexes sWhere sObjectID sAnd sName
43796>>>
43796>>>        Get _SqlFindKeyWord CI_SQLSelect to sSelect
43797>>>        Get _SqlFindKeyWord CI_SQLFrom to sFrom
43798>>>        Get _SqlFindKeyWord CI_SQLSysIndexes to sSysIndexes
43799>>>        Get _SqlFindKeyWord CI_SQLWhere to sWhere
43800>>>        Get _SqlFindKeyWord CI_SQLObjectID to sObjectID
43801>>>        Get _SqlFindKeyWord CI_SQLAND to sAnd
43802>>>        Get _SqlFindKeyWord CI_SQLName to sName
43803>>>
43803>>>        Move (sSelect * String("*") * sFrom * sSysIndexes * sWhere * sName * "=" * sIndexName * sAnd * sObjectID * "=([" + sSchemaName + "].[" + sTableName + "])") to sRetval
43804>>>
43804>>>        Function_Return sRetval
43805>>>    End_Function
43806>>>
43806>>>    // Formats a columns iLenght & iDecimal parameters as SQL expects them in a string.
43806>>>    // E.g. (4,2), where 4 is the iLength and 2 the iDecimals param.
43806>>>    Function _SqlFormatLengthAndDecimalAsString Integer iLength Integer iDecimals Returns String
43808>>>        String sRetval
43808>>>        If (iLength <> 0) Begin
43810>>>            Move ("(" + String(iLength)) to sRetval
43811>>>            If (iDecimals <> 0) Begin
43813>>>                Move (sRetval + "," + String(iDecimals)) to sRetval
43814>>>            End
43814>>>>
43814>>>            Move (sRetval + ")") to sRetval
43815>>>        End
43815>>>>
43815>>>        Function_Return sRetval
43816>>>    End_Function
43817>>>
43817>>>    Procedure _SqlColumnInfo Handle hoStmt
43819>>>        Integer i iCols iItem
43819>>>        tSqlColumnNew[] aQueryColumns
43819>>>        tSqlColumnNew[] aQueryColumns
43820>>>
43820>>>        Get SqlStmtAttribute of hoStmt SqlSTMTATTRIB_COLUMNCOUNT to iCols
43821>>>        For i from 1 to iCols
43827>>>>
43827>>>            Move (SizeOfArray(aQueryColumns)) to iItem
43828>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_BASECOLUMNNAME to aQueryColumns[iItem].sBaseColumnName
43829>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_BASETABLENAME  to aQueryColumns[iItem].sBaseTableName
43830>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_LABEL          to aQueryColumns[iItem].sLabel
43831>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_SQLTYPE        to aQueryColumns[iItem].iSqlType
43832>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_DFTYPE         to aQueryColumns[iItem].iDFType
43833>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_SIZE           to aQueryColumns[iItem].iSize
43834>>>            Get SqlColAttribute of hoStmt i SqlCOLATTRIB_PRECISION      to aQueryColumns[iItem].iPrecision
43835>>>        Loop
43836>>>>
43836>>>        Set piColumns to iCols
43837>>>        Set paQueryColumns to aQueryColumns
43838>>>    End_Procedure
43839>>>
43839>>>    // Checks that the passed sDriverID is defined.
43839>>>    // Also checks if the driver has been loaded; else it gets loaded.
43839>>>    Function _SqlCheckCurrentDriver String sDriverID Returns Boolean
43841>>>        Boolean bOK
43841>>>        Integer iDriver
43841>>>
43841>>>        If (sDriverID = DATAFLEX_ID) Begin
43843>>>            Function_Return False
43844>>>        End
43844>>>>
43844>>>
43844>>>        Get IsDAWSQLDriver sDriverID to bOK
43845>>>
43845>>>        If (bOK = False) Begin
43847>>>            Get IsMertechDriver sDriverID to bOK
43848>>>        End
43848>>>>
43848>>>
43848>>>        If (bOK = False) Begin
43850>>>            Error DFERR_PROGRAM "Driver needs to be one of MSSQLDRV, DB2_DRV, ODBC_DRV, SQLFLEX, ORAFLEX, MDSPgSQL or MDSMySQL"
43851>>>>
43851>>>            Function_Return False
43852>>>        End
43852>>>>
43852>>>
43852>>>        Get DriverIndex sDriverID to iDriver
43853>>>        If (iDriver = 0) Begin
43855>>>            Load_Driver sDriverID
43856>>>        End
43856>>>>
43856>>>
43856>>>        Function_Return True
43857>>>    End_Function
43858>>>
43858>>>    // Checks that the length parameter has been passed correctly.
43858>>>    // This is only of concern for certain SQL data types.
43858>>>    Function _SqlCheckLengthParamForDataType Integer iDataType Integer iLen Returns Boolean
43860>>>        Integer iLength
43860>>>        Boolean bOK bCheckTypeLength
43860>>>
43860>>>        If (num_arguments > 1) Begin
43862>>>            Move iLen to iLength
43863>>>        End
43863>>>>
43863>>>        Move (iDataType = SQL_DECIMAL   or iDataType = SQL_NUMERIC or iDataType = SQL_FLOAT   or iDataType = SQL_INTEGER or;              iDataType = SQL_VARBINARY or iDataType = SQL_BINARY  or iDataType = SQL_VARCHAR or iDataType = SQL_CHAR or;              iDataType = SQL_BIGINT    or iDataType = SQL_REAL) to bCheckTypeLength
43864>>>
43864>>>        If (bCheckTypeLength = True) Begin
43866>>>            Move (iLength > 0) to bOK
43867>>>        End
43867>>>>
43867>>>
43867>>>        Function_Return (bOK = True)
43868>>>    End_Function
43869>>>
43869>>>    Function _SqlProperTableName String sTableName Returns String
43871>>>        String sVal sSchema sDriverID
43871>>>        Integer iDbType
43871>>>
43871>>>        If (Trim(sTableName) = "") Begin
43873>>>            Function_Return ""
43874>>>        End
43874>>>>
43874>>>
43874>>>        Get psDriverID to sDriverID
43875>>>        Get piDbType   to iDbType
43876>>>        If (iDbType = EN_dbTypeOracle) Begin
43878>>>            Get psUserID to sSchema
43879>>>            // Not sure about this uppercasing but it seems like Oracle wants that?
43879>>>            Move (Uppercase(sSchema)) to sSchema
43880>>>            Move ('"' + sSchema + '"."' + sTableName + '"') to sTableName
43881>>>            Function_Return sTableName
43882>>>        End
43882>>>>
43882>>>        If (iDbType = EN_DbTypeMySQL) Begin
43884>>>            Get psDatabase to sVal
43885>>>            Move (sVal + "." + sTableName) to sTableName
43886>>>            Function_Return sTableName
43887>>>        End
43887>>>>
43887>>>        If (iDbType = EN_DbTypePostgre) Begin
43889>>>            Move ('"' + sTableName + '"') to sTableName
43890>>>            Function_Return sTableName
43891>>>        End
43891>>>>
43891>>>
43891>>>        Get psSchema to sSchema
43892>>>        If (sSchema = "") Begin
43894>>>            Get _SqlFindKeyWord CI_SQLDBO to sSchema
43895>>>        End
43895>>>>
43895>>>
43895>>>        Move (Uppercase(sTableName)) to sVal
43896>>>        If (not(sVal contains (sSchema + "."))) Begin
43898>>>            If (iDbType = EN_dbTypeDB2) Begin
43900>>>                Move (Lowercase(sSchema) + "." + sTableName) to sTableName
43901>>>            End
43901>>>>
43901>>>            Else Begin
43902>>>                Move (sSchema + "." + sTableName) to sTableName
43903>>>            End
43903>>>>
43903>>>        End
43903>>>>
43903>>>
43903>>>        Function_Return sTableName
43904>>>    End_Function
43905>>>
43905>>>    // SQL column names can be case-sensitive. This function is used to check that
43905>>>    // the passed sFieldName has the correct spelling.
43905>>>    // Used with Embedded SQL statement calls.
43905>>>    // If the spelling or fieldname doesn't exist, the return value is "" (blank).
43905>>>    Function _SqlFindColumnName String sTableName String sColumnName Returns String
43907>>>        String sRetval sValue sDriverID
43907>>>        String[] sColumnNamesArray
43908>>>        Integer iCount iColumns
43908>>>
43908>>>        Move "" to sRetval
43909>>>        Get psDriverID to sDriverID
43910>>>        Get SqlUtilEnumerateColumns sDriverID sTableName to sColumnNamesArray
43911>>>        Move (SizeOfArray(sColumnNamesArray)) to iColumns
43912>>>        Decrement iColumns
43913>>>
43913>>>        For iCount from 0 to iColumns
43919>>>>
43919>>>            Move sColumnNamesArray[iCount] to sValue
43920>>>            If (Uppercase(sColumnName) = Uppercase(sValue)) Begin
43922>>>                Move sValue to sRetval
43923>>>                Move iColumns to iCount // We're done.
43924>>>            End
43924>>>>
43924>>>        Loop
43925>>>>
43925>>>
43925>>>        Function_Return sRetval
43926>>>    End_Function
43927>>>
43927>>>    Function _SqlDatabasesArrayMSSQL Returns String[]
43929>>>        String[] sReturnArray
43930>>>        Handle hoSQLHandler
43930>>>        Integer iCount iSize iItem
43930>>>        String sServer sUser sPassword
43930>>>        tSQLConnection SQLConnection
43930>>>        tSQLConnection SQLConnection
43930>>>
43930>>>        Get phoMSSQLHandler to hoSQLHandler
43931>>>        Send Delete_Data    of hoSQLHandler
43932>>>        Get pSQLConnection  of ghoSQLConnectionHandler to SQLConnection
43933>>>
43933>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
43934>>>        Get EnumerateDatabases of hoSQLHandler SQLConnection.sServer SQLConnection.sUserID SQLConnection.sPassword to iSize
43935>>>        Decrement iSize
43936>>>
43936>>>        For iCount from 0 to iSize
43942>>>>
43942>>>            Get String_Value of hoSQLHandler item iCount to sServer
43943>>>            Move (Trim(sServer)) to sReturnArray[iItem]
43944>>>            Increment iItem
43945>>>        Loop
43946>>>>
43946>>>
43946>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
43947>>>
43947>>>        Function_Return sReturnArray
43948>>>    End_Function
43949>>>
43949>>>    Function _SqlTableArrayDAW Returns String[]
43951>>>        String[] sReturnArray
43952>>>        String sTable sTableType sSchema sDefSchema sComment sTableKeyWord sSysKeyWord
43952>>>        Handle hoSQLHandler
43952>>>        Integer iCount iSize iItem
43952>>>        Boolean bOK
43952>>>        tSQLConnection SQLConnection
43952>>>        tSQLConnection SQLConnection
43952>>>
43952>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
43953>>>        If (SQLConnection.sConnectionString = "") Begin
43955>>>            Function_Return sReturnArray
43956>>>        End
43956>>>>
43956>>>
43956>>>        Move SQLConnection.sSchema      to sDefSchema
43957>>>        Move (Uppercase(sDefSchema))    to sDefSchema
43958>>>        Get _SqlFindKeyWord CI_SQLTable to sTableKeyWord
43959>>>        Get _SqlFindKeyWord CI_SQLSys   to sSysKeyWord
43960>>>
43960>>>        Get phoCLIHandler to hoSQLHandler
43961>>>        Set psDriverID    of hoSQLHandler to SQLConnection.sDriverID
43962>>>        Send Delete_Data  of hoSQLHandler
43963>>>
43963>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
43964>>>        Get EnumerateTables of hoSQLHandler SQLConnection.sConnectionString to iSize
43965>>>        Move False to Err
43966>>>        Decrement iSize
43967>>>
43967>>>        For iCount from 0 to iSize
43973>>>>
43973>>>            Get TableName    of hoSQLHandler iCount to sTable
43974>>>            Get TableType    of hoSQLHandler iCount to sTableType
43975>>>            Get SchemaName   of hoSQLHandler iCount to sSchema
43976>>>            Get TableComment of hoSQLHandler iCount to sComment
43977>>>            Move (Trim(sTable)) to sTable
43978>>>            If (SQLConnection.sDriverID = DB2_DRV_ID) Begin
43980>>>                Move (sTable <> "" and Uppercase(sTableType) = sTableKeyWord and Uppercase(sSchema) = sDefSchema) to bOK
43981>>>            End
43981>>>>
43981>>>            Else Begin
43982>>>                Move (sTable <> "" and Uppercase(sTableType) = sTableKeyWord and Uppercase(sSchema) <> sSysKeyWord and Uppercase(sSchema) <> "SYSTOOLS") to bOK
43983>>>            End
43983>>>>
43983>>>            If (bOK = True) Begin
43985>>>                Move sTable to sReturnArray[iItem]
43986>>>                Increment iItem
43987>>>            End
43987>>>>
43987>>>        Loop
43988>>>>
43988>>>
43988>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
43989>>>
43989>>>        Function_Return sReturnArray
43990>>>    End_Function
43991>>>
43991>>>    Function _SqlProcedureArrayDAW String sStmt String sArgument Returns String[]
43993>>>        String[] sReturnArray
43994>>>        String sValue
43994>>>        Handle hoSQLHandler hoSQLConnect hStmt
43994>>>        Integer iRetval iCols iFetchResult
43994>>>        tSQLConnection SQLConnection
43994>>>        tSQLConnection SQLConnection
43994>>>
43994>>>        Get phoSQLManager to hoSQLHandler
43995>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
43996>>>        Get SqlConnect of hoSQLHandler SQLConnection.sDriverID SQLConnection.sConnectionString to hoSQLConnect
43997>>>
43997>>>        If (hoSQLConnect <> 0) Begin
43999>>>            Get SqlOpen of hoSQLConnect to hStmt
44000>>>            If (hStmt <> 0) Begin
44002>>>                Send SqlSetProcedurename of hStmt sStmt
44003>>>                If (sArgument <> "") Begin
44005>>>                    Send SqlSetArgument  of hStmt 1 sArgument
44006>>>                End
44006>>>>
44006>>>
44006>>>                Send SqlCall             of hStmt
44007>>>                Get SqlReturnValue       of hStmt to iRetval
44008>>>                If (iRetval = 0) Begin
44010>>>                    Repeat
44010>>>>
44010>>>                        Get SqlStmtAttribute of hStmt SqlSTMTATTRIB_COLUMNCOUNT to iCols
44011>>>                        If (iCols > 0) Begin
44013>>>                            Repeat
44013>>>>
44013>>>                                Get SqlFetch of hStmt to iFetchResult
44014>>>                                If (iFetchResult <> 0) Begin
44016>>>                                    Get SqlColumnValue of hStmt 1 to sValue
44017>>>                                    Move (Trim(sValue)) to sReturnArray[SizeOfArray(sReturnArray)]
44018>>>                                End
44018>>>>
44018>>>                            Until (iFetchResult = 0)
44020>>>                        End
44020>>>>
44020>>>                        Get SqlNextResultSet of hStmt to iRetval
44021>>>                    Until (iRetval = 0)
44023>>>                    Send SqlClose of hStmt
44024>>>                End
44024>>>>
44024>>>            End
44024>>>>
44024>>>            Send SqlDisconnect of hoSQLConnect
44025>>>        End
44025>>>>
44025>>>        Function_Return sReturnArray
44026>>>    End_Function
44027>>>
44027>>>    Function _SqlDatabasesArrayDB2 Returns String[]
44029>>>        String[] sReturnArray
44030>>>        String sDataSource
44030>>>        Handle hoSQLHandler
44030>>>        Integer iItem
44030>>>
44030>>>        Get phoDB2SQLHandler to hoSQLHandler
44031>>>        Send SeedDataSources of hoSQLHandler
44032>>>
44032>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
44033>>>
44033>>>        Repeat
44033>>>>
44033>>>            Get DataSources of hoSQLHandler to sDataSource
44034>>>            Move (Replaces(",", sDataSource, "")) to sDataSource
44035>>>            Move (Trim(sDataSource)) to sReturnArray[iItem]
44036>>>            Increment iItem
44037>>>        Until (sDataSource = "")
44039>>>
44039>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
44040>>>
44040>>>        Function_Return sReturnArray
44041>>>    End_Function
44042>>>
44042>>>    Function _SqlDatabasesArrayODBC Returns String[]
44044>>>        String[] sReturnArray
44045>>>        String sDataSource
44045>>>        Handle hoSQLHandler
44045>>>        Integer iItem
44045>>>
44045>>>        Get phoODBCSQLHandler to hoSQLHandler
44046>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
44047>>>
44047>>>        Send SeedDataSources of hoSQLHandler
44048>>>
44048>>>        Repeat
44048>>>>
44048>>>            Get DataSources of hoSQLHandler to sDataSource
44049>>>            If (Trim(sDataSource) <> "" and not(sDataSource contains "*.")) Begin
44051>>>                Move (Trim(sDataSource)) to sReturnArray[iItem]
44052>>>                Increment iItem
44053>>>            End
44053>>>>
44053>>>        Until (sDataSource = "")
44055>>>
44055>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
44056>>>
44056>>>        Function_Return sReturnArray
44057>>>    End_Function
44058>>>
44058>>>    // We might have a split Sql script where the info about which database to use is
44058>>>    // put on top of the Sql script, we then need to save it to be able to retrieve it later and
44058>>>    // insert it for scriplets to come after the first one.
44058>>>    Function _SqlFormatStatement String sStmt Returns String
44060>>>        String sUseDatabase sTmp sUseKeyWord sCreateViewKeyWord sDBOKeyWord sNoCountKeyWord sDriverID
44060>>>        Integer iStart iEnd iDbType
44060>>>        Boolean bOK
44060>>>
44060>>>        Get piDbType to iDbType
44061>>>        Get psDriverID to sDriverID
44062>>>        Get _SqlFindKeyWord CI_SQLUse          to sUseKeyWord
44063>>>        Get _SqlFindKeyWord CI_SQLSetNoCountOn to sNoCountKeyWord
44064>>>        Get _SqlFindKeyWord CI_SQLCreateView   to sCreateViewKeyWord
44065>>>        Get _SqlFindKeyWord CI_SQLDBO          to sDBOKeyWord
44066>>>        Move (Replaces(" ", sStmt, "")) to sTmp
44067>>>        If (Uppercase(sTmp) contains (sUseKeyWord +"[")) Begin
44069>>>            Move (Pos("[", (Uppercase(sTmp)))) to iStart
44070>>>            Move (Pos("]", sTmp)) to iEnd
44071>>>            Move (Mid(sTmp, (iEnd -iStart +1), iStart)) to sUseDatabase
44072>>>            Move (sUseKeyWord * sUseDatabase + " ") to sUseDatabase
44073>>>            Set Private.psUseDatabase to sUseDatabase
44074>>>        End
44074>>>>
44074>>>        Else Begin
44075>>>            Move (Uppercase(sStmt)) to sTmp
44076>>>
44076>>>            // A "Create View" statement _must_ be the very first words in a Sql statement.
44076>>>            If (not(sTmp contains sCreateViewKeyWord)) Begin
44078>>>                Get Private.psUseDatabase to sUseDatabase
44079>>>                Move (Insert(sUseDatabase, sStmt, 1)) to sStmt
44080>>>            End
44080>>>>
44080>>>
44080>>>            // This is a bit special to place here but was done so because it was easier that way.
44080>>>            // We will get an error when trying to create a view if it already exists.
44080>>>            // So to avoid such errors; we first remove it & then recreate it.
44080>>>            Else If (sTmp contains sCreateViewKeyWord) Begin
44083>>>                // Make sure we only have one space between statements/words.
44083>>>                Move (Replaces("  ", sTmp, " ")) to sTmp
44084>>>                Move (Replace(sCreateViewKeyWord, sTmp, "")) to sTmp
44085>>>                Move (Trim(sTmp)) to sTmp
44086>>>                Move (Pos(" ", sTmp)) to iEnd
44087>>>                Move (Left(sTmp, iEnd)) to sTmp
44088>>>                If ((not(sTmp contains ("[" + sDBOKeyWord + "]."))) and (not(sTmp contains (sDBOKeyWord + ".")))) Begin
44090>>>                    Move (sDBOKeyWord + "." + Trim(sTmp)) to sTmp
44091>>>                End
44091>>>>
44091>>>                Move (Trim(sTmp)) to sTmp
44092>>>                // Remove data view as it already exists!
44092>>>                Get SqlViewRemove sDriverID sTmp to bOK
44093>>>            End
44093>>>>
44093>>>        End
44093>>>>
44093>>>
44093>>>        Function_Return sStmt
44094>>>    End_Function
44095>>>
44095>>>    // Returns the proper Sql language key word(s) for the passed SQL key-word constant
44095>>>    Function _SqlFindKeyWord Integer iSQLKeywordConstant Returns String
44097>>>        String sRetval
44097>>>        Integer iDbType iIndex
44097>>>        tSQLKeyWords[] SQLKeywordArray
44097>>>        tSQLKeyWords[] SQLKeywordArray
44098>>>        tSQLKeyWords   SQLKeyWords
44098>>>        tSQLKeyWords   SQLKeyWords
44098>>>
44098>>>        // Sql back-end type. E.g. MS-SQL, MySQL, Oracle, DB2...
44098>>>        Get piDbType to iDbType
44099>>>        Move iDbType             to SQLKeyWords.iSQLDbType
44100>>>        Move iSQLKeywordConstant to SQLKeyWords.iSQLWord
44101>>>
44101>>>        Get paSQLKeywordArray to SQLKeywordArray
44102>>>        Move (SearchArray(SQLKeyWords, SQLKeywordArray, Self, RefFunc(CompareFindSQLKeyWords))) to iIndex
44103>>>        Move SQLKeywordArray[iIndex].sSQLPhrase to sRetval
44104>>>
44104>>>        Function_Return sRetval
44105>>>    End_Function
44106>>>
44106>>>    // Function will "clean/sanitize" the script by removing all comments and blank lines.
44106>>>    Function _SqlUtilSanitizeScript tSQLScriptArray SqlScriptArray Returns tSQLScriptArray[]
44108>>>        String[] sSQLScriptArray
44109>>>        String sText sLine sTmp sCommentStart sCommentEnd sDashComment
44109>>>        Integer iSize iCount
44109>>>        Boolean bCommentStart bCommentEnd bDashComment
44109>>>
44109>>>        Move False to bCommentStart
44110>>>        Move False to bCommentEnd
44111>>>        Move False to bDashComment
44112>>>        Move "/*"  to sCommentStart   // These are the standard comment start & stop tokens...
44113>>>        Move "*/"  to sCommentEnd
44114>>>        Move "--"  to sDashComment    // ...but a comment can also start with two dashes "--".
44115>>>
44115>>>        Move (SizeOfArray(SqlScriptArray.sSQLScriptArray)) to iSize
44116>>>        Decrement iSize
44117>>>        Move "" to sText
44118>>>
44118>>>        For iCount from 0 to iSize
44124>>>>
44124>>>            Move SqlScriptArray.sSQLScriptArray[iCount] to sLine
44125>>>            Move (Trim(sLine)) to sTmp
44126>>>            If (sTmp <> "") Begin
44128>>>                Move (Left(sTmp, 2) = sDashComment) to bDashComment
44129>>>                If (bCommentStart = False) Begin
44131>>>                    Move (Left(sTmp, 2) = sCommentStart) to bCommentStart
44132>>>                    If (bCommentStart = False) Begin
44134>>>                    End
44134>>>>
44134>>>                End
44134>>>>
44134>>>                Move (sTmp contains sCommentEnd) to bCommentEnd
44135>>>                If (bCommentEnd = True) Begin
44137>>>                    Move False to bCommentStart
44138>>>                End
44138>>>>
44138>>>                If (bDashComment = False and bCommentStart = False and bCommentEnd = False) Begin
44140>>>                    Move sLine to sSQLScriptArray[SizeOfArray(sSQLScriptArray)]
44141>>>                End
44141>>>>
44141>>>            End
44141>>>>
44141>>>        Loop
44142>>>>
44142>>>
44142>>>        // Update the retval struct array:
44142>>>        Move sSQLScriptArray to SqlScriptArray.sSQLScriptArray
44143>>>        Function_Return SqlScriptArray
44144>>>    End_Function
44145>>>
44145>>>
44145>>>    // *** Database API Functions: ***
44145>>>    // Instead of using Sql Scripts (ESQL), we can opt to use the DataFlex Database API's to
44145>>>    // make changes/updates to the database.
44145>>>
44145>>>    // * Dummy function for the Studio's Code Explorer *
44145>>>    Function API_TABLE_FUNCTIONS Returns Boolean
44147>>>        Function_Return False
44148>>>    End_Function
44149>>>
44149>>>    // This might not do what you think - Here's what it does:
44149>>>    // It checks that the passed hTable TableName in filelist.cfg is exactly the same as at the SQL back-end.
44149>>>    // If that is True; it creates an .int file for it and changes Filelist.cfg to point
44149>>>    // to the SQL table.
44149>>>    // Typical usage for this function is when an entry exists in the Filelist for a table and the table
44149>>>    // already exists in SQL.
44149>>>    // This is a bit fiddly as the DF_FILE_PHYSICAL_NAME attribute can only be set inside a
44149>>>    // Structure_Start ... Structure_End operation when creating a NEW table. Thus it cannot be set when
44149>>>    // restructuring an existing table.
44149>>>    Function ApiTableAttachToSql Handle hTable Boolean bUseConnID Returns Boolean
44151>>>        Boolean bExists bOpened bOK bSystemFile bMertechDriver bUseConnectionID bIsAlias
44151>>>        String sDriverID sConnectionID sConnectionString sDisplayName sRootName sLogicalName sPhysicalName sSchema
44151>>>        Handle hToTable
44151>>>        Integer iPos
44151>>>
44151>>>        Move True to bUseConnectionID
44152>>>        If (num_arguments > 1) Begin
44154>>>            Move bUseConnID to bUseConnectionID
44155>>>        End
44155>>>>
44155>>>
44155>>>        Get psDriverID to sDriverID
44156>>>        // If the table doesn't exist on the SQL back-end we do nothing.
44156>>>        Get SqlUtilCheckIfTableHandleExists hTable sDriverID to bExists
44157>>>        If (bExists = False) Begin
44159>>>            Function_Return False
44160>>>        End
44160>>>>
44160>>>
44160>>>        Get UtilTableIsAlias hTable to bIsAlias
44161>>>
44161>>>        Get _SqlCheckCurrentDriver sDriverID to bOK
44162>>>        If (bOK = False) Begin
44164>>>            Function_Return False
44165>>>        End
44165>>>>
44165>>>
44165>>>        // Then we need to check that the function hasn't been called before; which in case
44165>>>        // we do nothing
44165>>>        Get SQLUtilTableIsAttached sDriverID hTable to bExists
44166>>>        If (bExists = True) Begin
44168>>>            Function_Return False
44169>>>        End
44169>>>>
44169>>>
44169>>>        Get psConnectionID     to sConnectionID
44170>>>        Get psConnectionString to sConnectionString
44171>>>        If (sConnectionID = "" or sConnectionString = "") Begin
44173>>>            Error DFERR_PROGRAM ("An SQL connection has NOT been setup correctly. Could not attach table:" * String(hTable) * "to SQL")
44174>>>>
44174>>>            Function_Return False
44175>>>        End
44175>>>>
44175>>>
44175>>>        Set Private.phCurrentTable to hTable
44176>>>        Get psSchema to sSchema
44177>>>        If (sSchema = "") Begin
44179>>>            Get _SqlFindKeyWord CI_SQLDBO to sSchema
44180>>>        End
44180>>>>
44180>>>
44180>>>        Get IsMertechDriver sDriverID to bMertechDriver
44181>>>
44181>>>        // Mertech drivers don't use connection id's, so if the passed bUseConnectionID = True that
44181>>>        // was a programmer's error and we adjust for it here.
44181>>>        If (bMertechDriver = True) Begin
44183>>>            Move False to bUseConnectionID
44184>>>        End
44184>>>>
44184>>>
44184>>>        // If we should use a connection id we need to check it exists;
44184>>>        // else we create it before attempting creating the table
44184>>>        If (bUseConnectionID = True) Begin
44186>>>            Get AutoConnectionIDLogin to bOK
44187>>>            If (bOk = False) Begin
44189>>>                Error DFERR_PROGRAM ("The Connection ID:" * sConnectionID * "could not be created and therefor the table can't be created.")
44190>>>>
44190>>>                Function_Return False
44191>>>            End
44191>>>>
44191>>>        End
44191>>>>
44191>>>
44191>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
44194>>>        Get _TableNameOnly sRootName to sRootName
44195>>>        If (sRootName = "") Begin
44197>>>            Function_Return False
44198>>>        End
44198>>>>
44198>>>        Move (sRootName + ".int")                    to sPhysicalName
44199>>>        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
44202>>>        Get_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
44205>>>
44205>>>        // We don't want to change the display name if it starts with an ampersand ("@"),
44205>>>        // because then the table should not be visible to users.
44205>>>        Move (Pos("@", sDisplayName)) to iPos
44206>>>        If (iPos <> 1) Begin
44208>>>            If (sDisplayName contains ".") Begin
44210>>>                Move (Pos(".", sDisplayName)) to iPos
44211>>>                Move (Mid(sDisplayName, 200 ,(iPos + 1))) to sDisplayName
44212>>>                Move (sSchema + "." + sDisplayName)       to sDisplayName
44213>>>            End
44213>>>>
44213>>>            If (not(Lowercase(sDisplayName) contains Lowercase(sSchema + "."))) Begin
44215>>>                Move (Lowercase(sSchema) + "." + sDisplayName) to sDisplayName
44216>>>            End
44216>>>>
44216>>>        End
44216>>>>
44216>>>
44216>>>        If (bIsAlias = False) Begin
44218>>>            Get OpenTableExclusive hTable to bOpened
44219>>>            If (bOpened = False) Begin
44221>>>                Error DFERR_PROGRAM ("Function ApiTableAttachToSQL - Could not open table number:" * String(hTable) * sLogicalName)
44222>>>>
44222>>>                Function_Return False
44223>>>            End
44223>>>>
44223>>>        End
44223>>>>
44223>>>
44223>>>        If (ghoProgressBar <> 0) Begin
44225>>>            Send DoAdvance of ghoProgressBar
44226>>>            Set TableName_Text of ghoStatusPanel to ("Attaching to SQL - Table:" * String(sLogicalName) * "Number:" * String(hTable) * "to SQL")
44227>>>        End
44227>>>>
44227>>>        // Note: The hToTable will get changed by the Structure_xxx command...
44227>>>        Move hTable to hToTable
44228>>>        Move False to Err
44229>>>
44229>>>        // We now create a stub .int file and after Structure_end and also change the Filelist.cfg,
44229>>>        // then we do a pseudo .int file change with the "SqlUtilUpdateIntFile" function. After that we have
44229>>>        // a proper and updated .int file.
44229>>>        Get_Attribute DF_FILE_IS_SYSTEM_FILE of hTable to bSystemFile
44232>>>        Get SqlUtilCreateIntFile hTable sDriverID sConnectionID True bSystemFile to bOK
44233>>>
44233>>>        If (bIsAlias = False) Begin
44235>>>            Structure_Start hToTable sDriverID
44236>>>                Set Private.phCurrentTable to hTable
44237>>>                If (bUseConnectionID = True) Begin
44239>>>                    Set_Attribute DF_FILE_LOGIN     of hToTable to (CS_DFCONNID + "=" + sConnectionID)
44242>>>                End
44242>>>>
44242>>>                Else Begin
44243>>>                    Set_Attribute DF_FILE_LOGIN     of hToTable to sConnectionString
44246>>>                End
44246>>>>
44246>>>                Set_Attribute DF_FILE_OWNER         of hToTable to (Lowercase(sSchema))
44249>>>                // For unknown reason the above sometimes triggers an error and it doesn't help to try to trap the error; so we cheat...
44249>>>                Move False to Err
44250>>>                Move 0 to LastErr
44251>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
44252>>>            Structure_End hToTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44254>>>            Set Action_Text of ghoStatusPanel to ""
44255>>>        End
44255>>>>
44255>>>
44255>>>        Move (not(Err)) to bOK
44256>>>        If (bOK = True) Begin
44258>>>            // The attributes set above will always trigger an error
44258>>>            // We also adjust the Filelist entries
44258>>>            Set_Attribute DF_FILE_ROOT_NAME    of hTable to (sDriverID + ":" + sRootName)
44261>>>            Set_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
44264>>>            Set_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
44267>>>
44267>>>            // This updates the .int file to make it up-to-date with the SQL back-end.
44267>>>            Get SqlUtilUpdateIntFile hTable to bOK
44268>>>        End
44268>>>>
44268>>>
44268>>>        Function_Return (bOK = True)
44269>>>    End_Function
44270>>>
44270>>>    // Sample usage:
44270>>>    //    Get ApiTableChangeAttribute SysInfo.File_Number DF_FILE_IS_SYSTEM_FILE True to bOK
44270>>>    //    Get ApiTableChangeAttribute OrderHea.File_Number DF_FILE_REUSE_DELETED DF_FILE_DELETED_NOREUSE to bOK
44270>>>    Function ApiTableChangeAttribute Handle hTable Integer iAttribute Integer iValue Returns Boolean
44272>>>        Boolean bOK bIsSQLTable
44272>>>
44272>>>        Get AutoConnectionIDLogin to bOK
44273>>>        Move False to Err
44274>>>        Get OpenTableExclusive hTable to bOK
44275>>>        If (bOK = False) Begin
44277>>>            Function_Return False
44278>>>        End 
44278>>>>
44278>>>        
44278>>>        // ToDo: Add to all table change functions!
44278>>>            Get UtilTableIsSQL hTable to bIsSQLTable
44279>>>            If (bIsSQLTable = True) Begin
44281>>>                Set_Attribute DF_FILE_ALLOWED_STRUCTURE_CHANGES of hTable to ALL_TABLE_CHANGES_ALLOWED
44284>>>            End
44284>>>>
44284>>>        
44284>>>        Set Private.phCurrentTable to hTable
44285>>>        Structure_Start hTable
44286>>>            Set_Attribute iAttribute of hTable to iValue
44289>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
44290>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44292>>>
44292>>>        Set Action_Text of ghoStatusPanel to ""
44293>>>        Function_Return (Err = False)
44294>>>    End_Function
44295>>>
44295>>>    // To use a filelist slot for the passed FileName, TableName & DisplayName,
44295>>>    // or to change the filelist slot names.
44295>>>    Function ApiTableChangeFileListSlot String sRootName String sLogicalName String sDisplayName Handle hTable String sDriverID Returns Boolean
44297>>>        Boolean bExists
44297>>>
44297>>>        Move False to Err
44298>>>        Get UtilTableNumberIsInUse hTable to bExists
44299>>>        If (bExists = False) Begin
44301>>>            Function_Return False
44302>>>        End
44302>>>>
44302>>>
44302>>>        If (ghoProgressBar <> 0) Begin
44304>>>            Send DoAdvance of ghoProgressBar
44305>>>            Set TableName_Text of ghoStatusPanel to ("Changing Filelist slot for Table:" * String(sLogicalName) * "Number:" * String(hTable))
44306>>>        End
44306>>>>
44306>>>        // If all strings are empty it means that we should remove this entry from filelist.
44306>>>        If (sRootName = "" and sLogicalName = "" and sDisplayName = "") Begin
44308>>>            Set_Attribute DF_FILE_ROOT_NAME     of hTable to ""
44311>>>            Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to ""
44314>>>            Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to ""
44317>>>            Function_Return (Err = False) // And we're done.
44318>>>        End
44318>>>>
44318>>>
44318>>>        If (sDriverID <> DATAFLEX_ID) Begin
44320>>>            Set_Attribute DF_FILE_ROOT_NAME of hTable to (sDriverID + ":" + sRootName)
44323>>>        End
44323>>>>
44323>>>        Else Begin
44324>>>            Set_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
44327>>>        End
44327>>>>
44327>>>
44327>>>        Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalName
44330>>>
44330>>>        If (sDriverID <> DATAFLEX_ID and not(Uppercase(sDisplayName) contains "DBO.")) Begin
44332>>>            Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to ("dbo." + sDisplayName)
44335>>>        End
44335>>>>
44335>>>        Else Begin
44336>>>            Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayName
44339>>>        End
44339>>>>
44339>>>
44339>>>        Function_Return (Err = False)
44340>>>    End_Function
44341>>>
44341>>>    Function ApiTableChangeRecordLength Handle hTable Integer iRecordLength Returns Boolean
44343>>>        Boolean bOK
44343>>>
44343>>>        Get AutoConnectionIDLogin to bOK
44344>>>        Move False to Err
44345>>>        Get OpenTableExclusive hTable to bOK
44346>>>        If (bOK = False) Begin
44348>>>            Function_Return False
44349>>>        End
44349>>>>
44349>>>
44349>>>        Set Private.phCurrentTable to hTable
44350>>>        Structure_Start hTable
44351>>>            Set_Attribute DF_FILE_RECORD_LENGTH of hTable to iRecordLength
44354>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
44355>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44357>>>
44357>>>        Set Action_Text of ghoStatusPanel to ""
44358>>>        Function_Return (Err = False)
44359>>>    End_Function
44360>>>
44360>>>    Function ApiTableChangeRelation Handle hTable Handle hToTable Integer iFromField Integer iToField Returns Boolean
44362>>>        Boolean bOK
44362>>>
44362>>>        Move False to Err
44363>>>        Get AutoConnectionIDLogin to bOK
44364>>>        Open hToTable
44366>>>        Get OpenTableExclusive hTable to bOK
44367>>>        If (bOK = False) Begin
44369>>>            Function_Return False
44370>>>        End
44370>>>>
44370>>>
44370>>>        Set Private.phCurrentTable to hTable
44371>>>        Structure_Start hTable
44372>>>            Set_Attribute DF_FIELD_RELATED_FILE  of hTable iFromField to hToTable
44375>>>            Set_Attribute DF_FIELD_RELATED_FIELD of hTable iFromField to iToField
44378>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
44379>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44381>>>
44381>>>        Set Action_Text of ghoStatusPanel to ""
44382>>>        Function_Return (Err = False)
44383>>>    End_Function
44384>>>
44384>>>    Procedure ApiTableConvertAllAddException Integer hTable
44386>>>        Integer[] aTableConvertExceptions
44387>>>        Get paTableConvertExceptions to aTableConvertExceptions
44388>>>        Move hTable to aTableConvertExceptions[SizeOfArray(aTableConvertExceptions)]
44389>>>        Set paTableConvertExceptions to aTableConvertExceptions
44390>>>    End_Procedure
44391>>>
44391>>>    Procedure ApiTableDateCorrectionAddException Integer hTable
44393>>>        Integer[] aTableDateCorrectionExceptions
44394>>>        Get paTableDateCorrectionExceptions to aTableDateCorrectionExceptions
44395>>>        Move hTable to aTableDateCorrectionExceptions[SizeOfArray(aTableDateCorrectionExceptions)]
44396>>>        Set paTableDateCorrectionExceptions to aTableDateCorrectionExceptions
44397>>>    End_Procedure
44398>>>
44398>>>    Procedure ApiTableConvertALLToSql
44400>>>        Integer[] iTablesArray
44401>>>        Integer iSize iCount
44401>>>        Boolean bUseConnectionID bToANSI bRecnum bCopyData bOK bContinueOnError
44401>>>        String sDriverID
44401>>>
44401>>>        Get psDriverID to sDriverID
44402>>>        Get pbUseConnectionID to bUseConnectionID
44403>>>        Get pbToANSI          to bToANSI
44404>>>        Get pbRecnum          to bRecnum
44405>>>        Get pbCopyData        to bCopyData
44406>>>        If (ghoDbUpdateHandler > 0) Begin
44408>>>            Get pbContinueOnError to bContinueOnError
44409>>>        End
44409>>>>
44409>>>
44409>>>        Get _AllTablesToConvert to iTablesArray
44410>>>        Move (SizeOfArray(iTablesArray)) to iSize
44411>>>        Set pbVisible   of ghoProgressBarOverall to True
44412>>>        Set piPosition  of ghoProgressBarOverall to 0
44413>>>        Set piAdvanceBy of ghoProgressBarOverall to 1
44414>>>        Set piMaximum   of ghoProgressBarOverall to iSize
44415>>>
44415>>>        Decrement iSize
44416>>>        For iCount from 0 to iSize
44422>>>>
44422>>>            Set piPosition of ghoProgressBarOverall to iCount
44423>>>            Get ApiTableConvertToSQL_Ex iTablesArray[iCount] sDriverID bUseConnectionID bToANSI bRecnum bCopyData to bOK
44424>>>            // Probably the right logic here is to just continue trying to convert every table even
44424>>>            // if there was an error converting one table...
44424>>>            //If (bContinueOnError = False and bOK = False) Break
44424>>>        Loop
44425>>>>
44425>>>
44425>>>    End_Procedure
44426>>>
44426>>>    Procedure ApiTableAttachALLToSql
44428>>>        Integer[] iTablesArray
44429>>>        Integer iSize iCount
44429>>>        Boolean bUseConnectionID bToANSI bRecnum bCopyData bOK bContinueOnError
44429>>>        String sDriverID
44429>>>
44429>>>        Get psDriverID to sDriverID
44430>>>        Get pbUseConnectionID to bUseConnectionID
44431>>>        Get pbToANSI          to bToANSI
44432>>>        Get pbRecnum          to bRecnum
44433>>>        Get pbCopyData        to bCopyData
44434>>>        If (ghoDbUpdateHandler > 0) Begin
44436>>>            Get pbContinueOnError to bContinueOnError
44437>>>        End
44437>>>>
44437>>>
44437>>>        Get _AllTablesToConvert to iTablesArray
44438>>>        Move (SizeOfArray(iTablesArray)) to iSize
44439>>>        Decrement iSize
44440>>>        For iCount from 0 to iSize
44446>>>>
44446>>>            Get ApiTableAttachToSQL iTablesArray[iCount] bUseConnectionID to bOK
44447>>>        Loop
44448>>>>
44448>>>
44448>>>    End_Procedure      
44449>>>    
44449>>>    // Subfunction to the ApiTableUpdate function (et al)
44449>>>    Function _UtilTableCheckChangeFilelistNames tAPITableNameInfo APITableNameInfoFrom Boolean bIsSQLTableTo Returns Boolean
44451>>>        Handle hTable 
44451>>>        String sRootNameTo sLogicalNameTo sDisplayNameTo sConnectionID
44451>>>        Boolean bIsSQLTableFrom bTableExists bSameTableNames bANSI bOK
44451>>>        
44451>>>        Get ApiTableFilelistNamesCompare True APITableNameInfoFrom to bSameTableNames
44452>>>        If (bSameTableNames = True) Begin
44454>>>            Function_Return True
44455>>>        End 
44455>>>>
44455>>>        
44455>>>        Move True to bOK
44456>>>        Move APITableNameInfoFrom.iTableNumber  to hTable  
44457>>>        Set Private.phCurrentTable              to hTable
44458>>>        Set_Attribute DF_FILE_ROOT_NAME         of hTable to APITableNameInfoFrom.sRootName
44461>>>        Set_Attribute DF_FILE_LOGICAL_NAME      of hTable to APITableNameInfoFrom.sLogicalName
44464>>>        Set_Attribute DF_FILE_DISPLAY_NAME      of hTable to APITableNameInfoFrom.sDisplayName
44467>>>        
44467>>>        If (APITableNameInfoFrom.bIsSQL = True) Begin
44469>>>            Get psConnectionID to sConnectionID
44470>>>            Get UtilTableExists hTable to bTableExists
44471>>>            If (bTableExists = True) Begin  
44473>>>                Get SqlUtilUpdateIntFile hTable to bOK
44474>>>            End
44474>>>>
44474>>>            Else Begin
44475>>>                Get pbToANSI to bANSI 
44476>>>                Get SqlUtilCreateIntFile hTable APITableNameInfoFrom.sDriverID sConnectionID bANSI False to bOK
44477>>>            End
44477>>>>
44477>>>        End
44477>>>>
44477>>>
44477>>>        Function_Return bOK
44478>>>    End_Function
44479>>>
44479>>>    Function ApiTableConvertToSql_Ex Handle hTable String sDriverID Boolean bUseConnectionID Boolean bToAnsi Boolean bRecnum Boolean bCopyData Returns Boolean
44481>>>        Handle hToTable hoLogFile
44481>>>        Boolean bOK bExists bOpened bMertechDriver bDAWDriver bContinueOnError bIsAlias
44481>>>        String sPhysicalName sRootName sLogicalName sDisplayName sConnectionID sConnectionString
44481>>>        String sANSI_OEM sSchema sBaseTableSpace sLongTableSpace sIndexTableSpace sDatabase sGUIDName sWarning
44481>>>        tSQLConnection SQLConnection
44481>>>        tSQLConnection SQLConnection
44481>>>        
44481>>>        Get UtilTableIsAlias hTable to bIsAlias
44482>>>        // If this is an Alias file there is nothing to convert to SQL.
44482>>>        // Instead we change the Filelist.cfg by adding the driver id to the rootname and create an .int file
44482>>>        If (bIsAlias = True) Begin
44484>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
44487>>>            If (sDriverID <> DATAFLEX_ID and not(sRootName contains ":")) Begin
44489>>>                Set_Attribute DF_FILE_ROOT_NAME of hTable to (sDriverID + ":" + sRootName)
44492>>>                Get psConnectionID to sConnectionID
44493>>>                Get SqlUtilCreateIntFile hTable sDriverID sConnectionID True False to bOK
44494>>>            End
44494>>>>
44494>>>            Function_Return True
44495>>>        End
44495>>>>
44495>>>
44495>>>        Set Private.phCurrentTable to hTable
44496>>>        Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
44499>>>        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
44502>>>        Get_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
44505>>>
44505>>>        If (ghoProgressBar <> 0) Begin
44507>>>            Send DoAdvance of ghoProgressBar
44508>>>            Set TableName_Text of ghoStatusPanel to ("Checking Table:" * "Number:" * String(hTable) * String(sLogicalName))
44509>>>        End
44509>>>>
44509>>>
44509>>>        // Marco Kuipers suggestion;
44509>>>        // If Filelist.cfg points to an embedded .dat table and the table already exists as
44509>>>        // an SQL table; rename the SQL table by adding a GUID at the end, then convert the
44509>>>        // table again.
44509>>>        Get UtilTableIsSQL hTable to bOK
44510>>>        If (bOK = False) Begin
44512>>>            Get SqlUtilCheckIfTableNameExists sLogicalName sDriverID to bExists
44513>>>            If (bExists = True) Begin
44515>>>                Get SQLUtilGUIDTempTableName sLogicalName to sGUIDName
44516>>>                Get SqlTableRename hTable sLogicalName sGUIDName to bOK
44517>>>                Get phoLogFile to hoLogFile
44518>>>                If (hoLogFile <> 0) Begin
44520>>>                    Move ("WARNING! Function: ApiTableConvertToSQL_Ex. The table" * sLogicalName * "pointed to an embedded table in Filelist.cfg that already existed as an SQL table! The existing SQL table was renamed to:" * String(sGUIDName) * "and then converted again.") to sWarning
44521>>>                    Send LogError sWarning False
44522>>>                End
44522>>>>
44522>>>                Else Begin
44523>>>                    Error DFERR_PROGRAM sWarning
44524>>>>
44524>>>                End
44524>>>>
44524>>>            End
44524>>>>
44524>>>        End
44524>>>>
44524>>>
44524>>>        // Does the rootname contain a driver?
44524>>>        If (sDriverID <> DATAFLEX_ID and (Uppercase(sRootName) contains sDriverID)) Begin
44526>>>            // Does the table already exist as an SQL table?
44526>>>            Get SqlUtilCheckIfTableHandleExists hTable sDriverID to bExists
44527>>>            // It can happen that the table is missing from Filelist.cfg but still
44527>>>            // exist on the SQL side, in case we want to search for the table by its name.
44527>>>            If (bExists = False) Begin
44529>>>                Get SqlUtilCheckIfTableNameExists sLogicalName sDriverID to bExists
44530>>>            End
44530>>>>
44530>>>            If (bExists = True) Begin
44532>>>                Set TableName_Text of ghoStatusPanel to ""
44533>>>                Function_Return False
44534>>>            End
44534>>>>
44534>>>        End
44534>>>>
44534>>>        Move (If(bToAnsi = True, CS_ANSI_Txt, CS_OEM_Txt)) to sANSI_OEM
44535>>>
44535>>>        Get IsDAWSQLDriver sDriverID to bDAWDriver
44536>>>        // Mertech drivers don't use Connection ID's; so if bUseConnectionID was
44536>>>        // passed as True, we adjust for that here.
44536>>>        Get IsMertechDriver sDriverID to bMertechDriver
44537>>>        If (bMertechDriver = True and bUseConnectionID = True) Begin
44539>>>            Move False to bUseConnectionID
44540>>>        End
44540>>>>
44540>>>
44540>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
44541>>>        Move SQLConnection.sSchema           to sSchema
44542>>>        If (sSchema = "") Begin
44544>>>            Get _SqlFindKeyWord CI_SQLDBO    to sSchema
44545>>>            Move (Lowercase(sSchema))        to sSchema
44546>>>        End
44546>>>>
44546>>>
44546>>>        If (sDriverID = ORAFLEX) Begin
44548>>>            Move SQLConnection.sUserID       to sSchema
44549>>>        End
44549>>>>
44549>>>
44549>>>        Move SQLConnection.sDatabase         to sDatabase
44550>>>        Move SQLConnection.sConnectionID     to sConnectionID
44551>>>        Move SQLConnection.sConnectionString to sConnectionString
44552>>>        If (sConnectionID = "" or sConnectionString = "") Begin
44554>>>            Error DFERR_PROGRAM ("The SQL connection info has NOT been setup. Could not convert table:" * String(hTable) * "to SQL")
44555>>>>
44555>>>            Function_Return False
44556>>>        End
44556>>>>
44556>>>
44556>>>        Get AutoConnectionIDLogin to bOK
44557>>>        Open hTable
44559>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
44562>>>        If (bOpened = False) Begin
44564>>>            Error DFERR_PROGRAM ("Could not open table number:" * String(hTable))
44565>>>>
44565>>>            Function_Return False
44566>>>        End
44566>>>>
44566>>>
44566>>>        If (ghoProgressBar <> 0) Begin
44568>>>            Send DoAdvance of ghoProgressBar
44569>>>            Set TableName_Text of ghoStatusPanel to ("Converting to SQL - Table:" * String(sLogicalName) * "Number:" * String(hTable))
44570>>>        End
44570>>>>
44570>>>
44570>>>        Move 0 to hToTable
44571>>>        Get _TableNameOnly sRootName                 to sRootName
44572>>>        Move (sRootName + ".int")                    to sPhysicalName
44573>>>
44573>>>        Case Begin
44573>>>            Case (sDriverID = MSSQLDRV_ID)
44575>>>                Case Break
44576>>>            Case (sDriverID = ODBC_DRV_ID)
44579>>>                Case Break
44580>>>            Case (sDriverID = DB2_DRV_ID)
44583>>>                Move SQLConnection.sBaseTableSpace  to sBaseTableSpace
44584>>>                Move SQLConnection.sLongTableSpace  to sLongTableSpace
44585>>>                Move SQLConnection.sIndexTableSpace to sIndexTableSpace
44586>>>                Case Break
44587>>>            Case (sDriverID = ORAFLEX)
44590>>>                Move SQLConnection.sBaseTableSpace  to sBaseTableSpace
44591>>>                Move SQLConnection.sIndexTableSpace to sIndexTableSpace
44592>>>                Case Break
44593>>>            Case (sDriverID = MDSMySQL)
44596>>>                Case Break
44597>>>            Case (sDriverID = MDSPgSQL)
44600>>>                Move SQLConnection.sBaseTableSpace  to sBaseTableSpace
44601>>>                Move SQLConnection.sIndexTableSpace to sIndexTableSpace
44602>>>                Case Break
44603>>>            Case (sDriverID = DATAFLEX_ID)
44606>>>                Case Break
44607>>>            Case Else
44607>>>                Error DFERR_PROGRAM "Wrong database driver passed to the 'ApiTableConvertToSQL_Ex' function."
44608>>>>
44608>>>                Case Break
44609>>>        Case End
44609>>>
44609>>>        Move False to Err
44610>>>
44610>>>        If (bIsAlias = False) Begin
44612>>>
44612>>>            If (bMertechDriver = True) Begin
44614>>>                // Note: This function also sets the Err flag.
44614>>>                Get _MertechApiTableConvertToSQL hTable sRootName sDatabase sDriverID sBaseTableSpace sIndexTableSpace bCopyData to bOK
44615>>>            End
44615>>>>
44615>>>
44615>>>            If (bMertechDriver = False) Begin
44617>>>                Structure_Start hToTable sDriverID
44618>>>                    Structure_Copy hTable to hToTable
44619>>>
44619>>>                    Set_Attribute DF_FILE_PHYSICAL_NAME of hToTable to sPhysicalName
44622>>>
44622>>>                    If (sDriverID <> DATAFLEX_ID) Begin
44624>>>                        If (bUseConnectionID = True) Begin
44626>>>                            Set_Attribute DF_FILE_LOGIN     of hToTable to (CS_DFCONNID + "=" + sConnectionID)
44629>>>                        End
44629>>>>
44629>>>                        Else Begin
44630>>>                            Set_Attribute DF_FILE_LOGIN     of hToTable to sConnectionString
44633>>>                        End
44633>>>>
44633>>>
44633>>>                        Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT   of hToTable to sANSI_OEM
44636>>>                        Set_Attribute DF_FILE_RECNUM_TABLE             of hToTable to bRecnum
44639>>>
44639>>>                        If (sSchema <> "") Begin
44641>>>                            Set_Attribute DF_FILE_OWNER                of hToTable to sSchema
44644>>>                        End
44644>>>>
44644>>>
44644>>>                        If (sDriverID = DB2_DRV_ID) Begin
44646>>>                            If (sLongTableSpace <> "") Begin
44648>>>                                Set_Attribute DF_FILE_LONG_TABLESPACE  of hToTable to sLongTableSpace
44651>>>                            End
44651>>>>
44651>>>                            If (sBaseTableSpace <> "") Begin
44653>>>                                Set_Attribute DF_FILE_TABLE_TABLESPACE of hToTable to sBaseTableSpace
44656>>>                            End
44656>>>>
44656>>>                            If (sIndexTableSpace <> "") Begin
44658>>>                                Set_Attribute DF_FILE_INDEX_TABLESPACE of hToTable to sIndexTableSpace
44661>>>                            End
44661>>>>
44661>>>                        End
44661>>>>
44661>>>                    End
44661>>>>
44661>>>
44661>>>                    Set Action_Text of ghoStatusPanel to "Restructures table..."
44662>>>                Structure_End hToTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44664>>>                Set Action_Text of ghoStatusPanel to ""
44665>>>            End
44665>>>>
44665>>>
44665>>>            Move (not(Err)) to bOK
44666>>>            If (bOK = True and bCopyData = True and bMertechDriver = False) Begin
44668>>>                If (bIsAlias = False) Begin
44670>>>                    Get ApiTableCopyData hTable sPhysicalName sRootName sDriverID to bOK
44671>>>                    If (ghoDbUpdateHandler > 0) Begin
44673>>>                        Get pbContinueOnError to bContinueOnError
44674>>>                    End
44674>>>>
44674>>>                    // If the data copy failed we will keep the newly created SQL table but
44674>>>                    // rename it by adding a GUID at the end of the table name
44674>>>                    // - or as much as "fit" because different SQL back-ends have
44674>>>                    // different rules how long a table name can be.
44674>>>                    // The new table will probably contain data but something went
44674>>>                    // wrong while converting the data from embedded to SQL.
44674>>>                    If (bOK = False and bContinueOnError = False) Begin
44676>>>                        Get SQLUtilGUIDTempTableName sLogicalName to sGUIDName
44677>>>                        Get SqlTableRename hTable sLogicalName sGUIDName to bOK
44678>>>                        Error DFERR_PROGRAM ("Copying of data failed. The SQL table:" * sLogicalName * "was renamed to:" * String(sGUIDName))
44679>>>>
44679>>>                    End
44679>>>>
44679>>>                End
44679>>>>
44679>>>            End
44679>>>>
44679>>>        End
44679>>>>
44679>>>
44679>>>        If (bMertechDriver = True) Begin
44681>>>            Open hTable
44683>>>        End
44683>>>>
44683>>>
44683>>>        // This must be after copying data...
44683>>>        If (Err = False) Begin
44685>>>            Set_Attribute DF_FILE_ROOT_NAME of hTable to (sDriverID + ":" + sRootName)
44688>>>            // We also adjust the display name by prefixing it by the schema name;
44688>>>            If (not(Lowercase(sDisplayName) contains Lowercase(sSchema + "."))) Begin
44690>>>                // The max length for the display_name is 31 characters...
44690>>>                If (Length(sSchema + "." + sDisplayName) < 31) Begin
44692>>>                    Set_Attribute DF_FILE_DISPLAY_NAME of hTable to (Lowercase(sSchema) + "." + sDisplayName)
44695>>>                End
44695>>>>
44695>>>            End
44695>>>>
44695>>>        End
44695>>>>
44695>>>
44695>>>        Close hTable
44696>>>        Move (not(Err)) to bOK
44697>>>        Function_Return (bOK = True)
44698>>>    End_Function
44699>>>
44699>>>    // Calls a driver function directly to copy data from one table to another (table structures needs to be the same).
44699>>>    // It will first drop all indicies, copy the data and then recreate indicies.
44699>>>    // An error log file with the sRootname + ".err" will be created in the Data folder.
44699>>>    Function ApiTableCopyData Integer hFromTable String sPhysicalName String sRootName String sDriverID Returns Boolean
44701>>>        Boolean bOpened bOK
44701>>>        Integer hToTable iIndex iRetval iVoid iOrgFreq
44701>>>        String sErrorFile sEmpty sPath
44701>>>
44701>>>        Get_Attribute DF_FILE_NEXT_EMPTY of 0 to hToTable
44704>>>        Get AutoConnectionIDLogin to bOK
44705>>>        If (sDriverID = DATAFLEX_ID) Begin
44707>>>            Send IncreaseSortBufferSize
44708>>>//            Send SetAllIndexesToBatch hToTable
44708>>>        End
44708>>>>
44708>>>
44708>>>        Move False to Err
44709>>>        Open sPhysicalName as hToTable
44711>>>        Get_Attribute DF_FILE_OPENED of hToTable to bOpened
44714>>>        If (bOpened = False) Begin
44716>>>            Function_Return False
44717>>>        End
44717>>>>
44717>>>
44717>>>        If (ghoStatusPanel <> 0) Begin
44719>>>            Set TableName_Text of ghoStatusPanel to ("Copying Data for Table:" * sRootName * "Number:" * String(hFromTable))
44720>>>            Set piMinimum of ghoProgressBar to 0 
44721>>>            Set piMaximum of ghoProgressBar to 100 // 100%
44722>>>        End
44722>>>>
44722>>>
44722>>>        Move "" to sEmpty
44723>>>        Move False to Err
44724>>>        Move True to bOK
44725>>>        Set Private.phCurrentTable to hToTable
44726>>>
44726>>>        // No need to get the record identifier
44726>>>        Set_Attribute DF_FILE_GET_RID_AFTER_CREATE of hToTable to False        
44729>>>        Get_Attribute DF_RUNTIME_PROGRESS_FREQUENCY to iOrgFreq
44732>>>        If (sDriverID <> DATAFLEX_ID) Begin
44734>>>            // Remove all indices to speed up copying of data:
44734>>>            Call_Driver hToTable sDriverID Function CLI_DROPINDICES Callback ghoDbUpdateHandler Passing sEmpty sEmpty iVoid Result iRetval
44739>>>            If (iRetval <> 0) Begin
44741>>>                Error DFERR_PROGRAM ("Failed dropping indices for table Number:" * String(hToTable) * "Name:" * String(sRootName))
44742>>>>
44742>>>                Function_Return False
44743>>>            End
44743>>>>
44743>>>        End
44743>>>>
44743>>>
44743>>>        Move (sRootName + ".err") to sErrorFile
44744>>>        Move 0 to iIndex
44745>>>        Move False to Err
44746>>>        
44746>>>        If (sDriverID = MSSQLDRV_ID) Begin
44748>>>            Set_Attribute DF_RUNTIME_PROGRESS_FREQUENCY to 10
44751>>>            Call_Driver hToTable sDriverID Function CLI_BCP CallBack ghoDbUpdateHandler Passing iIndex sEmpty hFromTable Result iRetval
44756>>>            If (iRetval <> 0) Begin
44758>>>                Error DFERR_PROGRAM ("Failed copying data for table Number:" * String(hToTable) * "Name:" * String(sRootName))
44759>>>>
44759>>>                Function_Return False
44760>>>            End
44760>>>>
44760>>>        End 
44760>>>>
44760>>>        Else Begin
44761>>>            Copy_Records hFromTable to hToTable using 0 Callback ghoDbUpdateHandler
44764>>>        End
44764>>>>
44764>>>
44764>>>        If (Err = False) Begin
44766>>>            Get psHome of (phoWorkspace(ghoApplication)) to sPath
44767>>>            Get vDeleteFile (sPath + sErrorFile) to iRetval
44768>>>        End
44768>>>>
44768>>>
44768>>>        If (sDriverID <> DATAFLEX_ID) Begin
44770>>>            // Recreate indices:
44770>>>            Call_Driver hToTable sDriverID Function CLI_CREATEINDICES Callback ghoDbUpdateHandler Passing sEmpty sEmpty iVoid Result iRetval
44775>>>            If (iRetval <> 0) Begin
44777>>>                Error DFERR_PROGRAM ("Failed creating indices for table Number:" * String(hToTable) * "Name:" * String(sRootName))
44778>>>>
44778>>>                Function_Return False
44779>>>            End
44779>>>>
44779>>>        End
44779>>>>
44779>>>
44779>>>        Close hToTable
44780>>>        Set_Attribute DF_RUNTIME_PROGRESS_FREQUENCY to iOrgFreq
44783>>>
44783>>>        If (bOK = True) Begin
44785>>>            Move (not(Err)) to bOK
44786>>>        End
44786>>>>
44786>>>
44786>>>        If (ghoStatusPanel <> 0) Begin
44788>>>            Set TableName_Text of ghoStatusPanel to ""
44789>>>            Set Message_Text   of ghoStatusPanel to ""
44790>>>            Set Action_Text    of ghoStatusPanel to ""
44791>>>        End
44791>>>>
44791>>>
44791>>>        Function_Return (bOK = True)
44792>>>    End_Function
44793>>>
44793>>>    // The bANSI parameter's default value = True, meaning a table in ANSI format will be created.
44793>>>    // i.e. DF_FILE_TABLE_CHARACTER_FORMAT {"OEM"|"ANSI"}
44793>>>    Function ApiTableCreate Handle hTable String sRootName String sDisplayName String sLogicalName Boolean bUseConnectionID Boolean bANSI Boolean bRecnum tAPIColumn[] aColumnIn Returns Boolean
44795>>>        Handle hFile
44795>>>        String sConnectionID sPhysicalFile sANSI_OEM sVal sSchema sOriginalDriverID sDriverID sTableName
44795>>>        Integer iColumn iIdentityType iDataType iDbType iCount iSize
44795>>>        Boolean bOk bExists bSqlDriver bMertechDriver bDeleteDummy bExistsInFilelist bSysFile
44795>>>        tSQLConnection SQLConnection
44795>>>        tSQLConnection SQLConnection
44795>>>        tAPIColumn[] aColumns
44795>>>        tAPIColumn[] aColumns
44796>>>        tColumnType ColumnType
44796>>>        tColumnType ColumnType
44796>>>
44796>>>        // First check if the passed filenumber already exists; in case we do nothing
44796>>>        Get UtilTableExists hTable to bOk
44797>>>        If (bOk = True) Begin
44799>>>            Function_Return False
44800>>>        End
44800>>>>
44800>>>
44800>>>        Set Private.phCurrentTable to hTable
44801>>>        Move sLogicalName to sTableName
44802>>>        If (ghoProgressBar <> 0) Begin
44804>>>            Send DoAdvance of ghoProgressBar
44805>>>            Set TableName_Text of ghoStatusPanel to ("Creating Table:" * String(sTableName) * "Number:" * String(hTable) * String(sLogicalName))
44806>>>        End
44806>>>>
44806>>>
44806>>>        Get UtilTableLogicalNameIsInUse sTableName to bExistsInFilelist
44807>>>        Get psDriverID to sDriverID
44808>>>        Get IsSQLDriver sDriverID to bSqlDriver
44809>>>        Get piDbType to iDbType
44810>>>
44810>>>        // If no columns passed in, we need to create a "dummy" column
44810>>>        Move False to bDeleteDummy
44811>>>        If (Num_Arguments = 8) Begin
44813>>>            Move aColumnIn to aColumns
44814>>>        End
44814>>>>
44814>>>        If ((SizeOfArray(aColumns)) = 0) Begin
44816>>>            Get UtilDFDataTypeToSqlTypeMapping sDriverID iDbType DF_BCD to ColumnType
44817>>>            Move ColumnType.iSQLType to iDataType
44818>>>            If (bRecnum = False) Begin
44820>>>                Move C_tAPIColumn_Identity to iIdentityType
44821>>>            End
44821>>>>
44821>>>            Else Begin
44822>>>                Move C_tAPIColumn_None     to iIdentityType
44823>>>            End
44823>>>>
44823>>>            Get _AppendAPIColumn aColumns "temp" iDataType 10 0 iIdentityType to aColumns
44824>>>            Move True to bDeleteDummy
44825>>>        End
44825>>>>
44825>>>
44825>>>        // If columns have been passed as an array we need to check if an identity column
44825>>>        // has been specified (aColumns[iCounter].iOptions = C_tAPIColumn_Identity), and
44825>>>        // if so auto-set the bRecnum to FALSE. This is because else there would be
44825>>>        // two identity columns and SQL doesn't like that and throws an error.
44825>>>        If (bRecnum = True and (SizeOfArray(aColumns)) <> 0) Begin
44827>>>            Move (SizeOfArray(aColumns)) to iSize
44828>>>            Decrement iSize
44829>>>            for iCount from 0 to iSize
44835>>>>
44835>>>                If (aColumns[iCount].iOptions = C_tAPIColumn_Identity) Begin
44837>>>                    Move False to bRecnum
44838>>>                    Move iSize to iCount
44839>>>                End
44839>>>>
44839>>>            Loop
44840>>>>
44840>>>        End
44840>>>>
44840>>>
44840>>>        // If this is a SQL based driver we also check if the table exists
44840>>>        // in the SQL back end; in case we do nothing.
44840>>>        If (bSqlDriver = True) Begin
44842>>>            // Get all connection properties
44842>>>            Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
44843>>>            Move SQLConnection.sSchema to sSchema
44844>>>            If (sSchema = "") Begin
44846>>>                Get _SqlFindKeyWord CI_SQLDBO to sSchema
44847>>>            End
44847>>>>
44847>>>
44847>>>            Get SqlUtilCheckIfTableHandleExists hTable sDriverID to bExists
44848>>>            // It can happen that the table is missing from Filelist.cfg but still
44848>>>            // exist on the SQL side, in case we want to search for the table by its name.
44848>>>            If (bExists = False) Begin
44850>>>                Get SqlUtilCheckIfTableNameExists sTableName sDriverID to bExists
44851>>>            End
44851>>>>
44851>>>            // If the table exists on the SQL back-end but not in Filelist.cfg,
44851>>>            // we will just add it to Filelist.cfg
44851>>>            If (bExists = True) Begin
44853>>>                If (bExistsInFilelist = False) Begin
44855>>>                    If (sDriverID <> DATAFLEX_ID and not(Uppercase(sRootName) contains sDriverID)) Begin
44857>>>                        Move (sDriverID + ":" + sRootName) to sRootName
44858>>>                    End
44858>>>>
44858>>>                    Set_Attribute DF_FILE_ROOT_NAME     of hTable to sRootName
44861>>>                    Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalName
44864>>>                    Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayName
44867>>>                    Move False to bSysFile
44868>>>                    Get SqlUtilCreateIntFile hTable sDriverID SQLConnection.sConnectionID bANSI bSysFile to bOK
44869>>>                End
44869>>>>
44869>>>                Function_Return False
44870>>>            End
44870>>>>
44870>>>        End
44870>>>>
44870>>>
44870>>>        Move CS_ANSI_Txt to sANSI_OEM
44871>>>        If (num_arguments > 6) Begin
44873>>>            If (bANSI = False) Begin
44875>>>                Move CS_OEM_Txt to sANSI_OEM
44876>>>            End
44876>>>>
44876>>>        End
44876>>>>
44876>>>
44876>>>        // Mertech drivers don't use connection id's, so if the passed bUseConnectionID = True that
44876>>>        // is a programmer's error and we auto-correct for it here.
44876>>>        // This is also a bit messy. If a Mertech driver is used and we want to create a new table,
44876>>>        // we first need to create it as embedded (DataFlex) and then convert it to SQL (!)
44876>>>        // So we set the driver ID temporarily to "DataFlex" to get the table created as embedded and later
44876>>>        // set it back and use a Mertech function to convert it to SQL.
44876>>>        Get IsMertechDriver sDriverID to bMertechDriver
44877>>>        If (bMertechDriver = True) Begin
44879>>>            If (bUseConnectionID = True) Begin
44881>>>                Move False to bUseConnectionID
44882>>>            End
44882>>>>
44882>>>            Move sDriverID to sOriginalDriverID
44883>>>            Move DATAFLEX_ID to sDriverID
44884>>>        End
44884>>>>
44884>>>
44884>>>        Move False to Err
44885>>>        If (sDriverID = DATAFLEX_ID) Begin
44887>>>            Move sRootName to sPhysicalFile
44888>>>        End
44888>>>>
44888>>>
44888>>>        If (sDriverID <> DATAFLEX_ID) Begin
44890>>>            Move SQLConnection.sConnectionID to sConnectionID
44891>>>
44891>>>            // If DAW driver and we should use a connection id we need to
44891>>>            // check if the connection ID exists; else we create it before attempting creating the table
44891>>>            If (bMertechDriver = False and bUseConnectionID = True) Begin
44893>>>                Get IsConnectionID sConnectionID sDriverID to bExists
44894>>>                If (bExists = False) Begin
44896>>>                    Get UtilCreateConnectionID sConnectionID to bOk
44897>>>                    If (bOk = False) Begin
44899>>>                        Error DFERR_PROGRAM ("The Connection ID:" * sConnectionID * "could not be created and therefor the table can't be created.")
44900>>>>
44900>>>                        Function_Return False
44901>>>                    End
44901>>>>
44901>>>                End
44901>>>>
44901>>>            End
44901>>>>
44901>>>
44901>>>            If (sDriverID <> DATAFLEX_ID and (Uppercase(sRootName) contains sDriverID)) Begin
44903>>>                Move (sTableName + ".int") to sPhysicalFile
44904>>>            End
44904>>>>
44904>>>            Else Begin
44905>>>                Move (sRootName + ".int") to sPhysicalFile
44906>>>            End
44906>>>>
44906>>>            Move (Uppercase(sDisplayName)) to sVal
44907>>>            If (not(sVal contains (sSchema + "."))) Begin
44909>>>                Move (Lowercase(sSchema) + "." + sTableName) to sDisplayName
44910>>>            End
44910>>>>
44910>>>        End
44910>>>>
44910>>>        Move False to Err
44911>>>        Move 0 to hFile
44912>>>
44912>>>        Structure_Start hFile sDriverID
44913>>>            If (sDriverID <> DATAFLEX_ID) Begin
44915>>>                If (bUseConnectionID = True) Begin
44917>>>                    Set_Attribute DF_FILE_LOGIN                of hFile to (CS_DFCONNID + "=" + sConnectionID)
44920>>>                End
44920>>>>
44920>>>                Else Begin
44921>>>                    Set_Attribute DF_FILE_LOGIN                of hFile to SQLConnection.sConnectionString
44924>>>                End
44924>>>>
44924>>>                Set_Attribute DF_FILE_TABLE_NAME               of hFile to sTableName
44927>>>                Set_Attribute DF_FILE_USE_DUMMY_ZERO_DATE      of hFile to True
44930>>>                Set_Attribute DF_FILE_TABLE_CHARACTER_FORMAT   of hFile to sANSI_OEM
44933>>>                Set_Attribute DF_FILE_RECNUM_TABLE             of hFile to bRecnum
44936>>>
44936>>>                If (sSchema <> "") Begin
44938>>>                    Set_Attribute DF_FILE_OWNER                of hFile to sSchema
44941>>>                End
44941>>>>
44941>>>
44941>>>                If (sDriverID = DB2_DRV_ID) Begin
44943>>>                    If (SQLConnection.sLongTableSpace <> "") Begin
44945>>>                        Set_Attribute DF_FILE_LONG_TABLESPACE  of hFile to SQLConnection.sLongTableSpace
44948>>>                    End
44948>>>>
44948>>>                End
44948>>>>
44948>>>                If (sDriverID = DB2_DRV_ID or sDriverID = ORAFLEX or sDriverID = MDSPgSQL) Begin
44950>>>                    If (SQLConnection.sBaseTableSpace <> "") Begin
44952>>>                        Set_Attribute DF_FILE_TABLE_TABLESPACE of hFile to SQLConnection.sBaseTableSpace
44955>>>                    End
44955>>>>
44955>>>                    If (SQLConnection.sIndexTableSpace <> "") Begin
44957>>>                        Set_Attribute DF_FILE_INDEX_TABLESPACE of hFile to SQLConnection.sIndexTableSpace
44960>>>                    End
44960>>>>
44960>>>                End
44960>>>>
44960>>>            End
44960>>>>
44960>>>
44960>>>            Set_Attribute DF_FILE_PHYSICAL_NAME of hFile to sPhysicalFile
44963>>>            Get ApiColumnsAddToTable hFile aColumns True to bOk
44964>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
44965>>>        Structure_End hFile DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
44967>>>        Set Action_Text of ghoStatusPanel to ""
44968>>>
44968>>>        // If Mertech driver we convert the newly created embedded table (DataFlex) to SQL
44968>>>        If (bMertechDriver = True) Begin
44970>>>            Move sOriginalDriverID to sDriverID
44971>>>            If (not(sVal contains (sSchema + "."))) Begin
44973>>>                Move (Lowercase(sSchema) + "." + sTableName) to sDisplayName
44974>>>            End
44974>>>>
44974>>>            // Note: This function also sets the Err flag.
44974>>>            Get _MertechApiTableConvertToSQL hTable sRootName SQLConnection.sDatabase sDriverID SQLConnection.sBaseTableSpace SQLConnection.sIndexTableSpace False to bOK
44975>>>        End
44975>>>>
44975>>>
44975>>>        Move (not(Err)) to bOK
44976>>>        If (bOk = True) Begin
44978>>>            If (sDriverID <> DATAFLEX_ID and not(Uppercase(sRootName) contains sDriverID)) Begin
44980>>>                Move (sDriverID + ":" + sRootName) to sRootName
44981>>>            End
44981>>>>
44981>>>            Set_Attribute DF_FILE_ROOT_NAME     of hTable to sRootName
44984>>>            Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalName
44987>>>            Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayName
44990>>>
44990>>>            // Lastly we remove the temporary column we created above, if all went well.
44990>>>            If (bDeleteDummy) Begin
44992>>>                Get ApiColumnRemove hTable "temp" to bOk
44993>>>            End
44993>>>>
44993>>>        End
44993>>>>
44993>>>
44993>>>        Close hTable
44994>>>        Function_Return (bOK = True)
44995>>>    End_Function
44996>>>
44996>>>    Function ApiTableCreateAlias String sFileName String sDisplayName String sAliasName Integer iFilelistSlot Returns Boolean
44998>>>        Move False to Err
44999>>>        Set_Attribute DF_FILE_ROOT_NAME     of iFilelistSlot to sFileName
45002>>>        Set_Attribute DF_FILE_DISPLAY_NAME  of iFilelistSlot to sDisplayName
45005>>>        Set_Attribute DF_FILE_LOGICAL_NAME  of iFilelistSlot to sAliasName
45008>>>
45008>>>        Function_Return (Err = False)
45009>>>    End_Function
45010>>>
45010>>>    // ToDo: Needs to be revised
45010>>>    Procedure ApiTableCreateFromDEF String sPath String sFileName String sTableName String sDisplayName Integer iFilelistSlot
45012>>>        Handle hTable
45012>>>        String sDEFName sDataPath
45012>>>        Boolean bExists
45012>>>
45012>>>        // Do nothing if MSSQL Driver.
45012>>>//        Get IsMSSQLDriver to bExists
45012>>>//        If (bExists = True) Begin
45012>>>//            Procedure_Return
45012>>>//        End
45012>>>
45012>>>        Get psDataPathFirstPart to sDataPath
45013>>>        Get vFilePathExists (sDataPath + sFileName + ".dat") to bExists
45014>>>        If (bExists = True) Begin
45016>>>            // We also needs to check if it is an Alias file, in case the sFileName.dat exists, but it may
45016>>>            // still be missing from the filelist and needs to be added.
45016>>>            Get UtilTableNumberIsInUse iFilelistSlot to bExists
45017>>>            If (bExists = True) Begin
45019>>>                Procedure_Return
45020>>>            End
45020>>>>
45020>>>            // Do _not_ use the DEF file if an alias, it will overwrite the base table data.
45020>>>            Else Begin
45021>>>                Set_Attribute DF_FILE_ROOT_NAME    of iFilelistSlot to sFileName
45024>>>                Set_Attribute DF_FILE_LOGICAL_NAME of iFilelistSlot to sTableName
45027>>>                Set_Attribute DF_FILE_DISPLAY_NAME of iFilelistSlot to sDisplayName
45030>>>                Procedure_Return
45031>>>            End
45031>>>>
45031>>>        End
45031>>>>
45031>>>
45031>>>        Move (sPath + sFileName + ".def") to sDEFName
45032>>>        Move 0 to hTable
45033>>>        Move False to Err
45034>>>
45034>>>        Structure_Start hTable DATAFLEX_ID
45035>>>            Load_Def sDEFName Onto hTable
45036>>>            Set_Attribute DF_FILE_PHYSICAL_NAME of hTable to sFileName
45039>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45040>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45042>>>        Set Action_Text of ghoStatusPanel to ""
45043>>>
45043>>>        Move iFilelistSlot to hTable
45044>>>        Set_Attribute DF_FILE_ROOT_NAME    of hTable to sFileName
45047>>>        Set_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
45050>>>        Set_Attribute DF_FILE_DISPLAY_NAME of hTable to sDisplayName
45053>>>
45053>>>    End_Procedure
45054>>>
45054>>>    Function ApiTableMoveToFileSlot Integer iFromFileSlot Integer iToFileSlot String sDriverID Returns Boolean
45056>>>        Boolean bTmp bErr bOK
45056>>>        String sTableName sDisplayName sFileName
45056>>>
45056>>>        // We preserve the value of the Err flag, by saving its current state and resetting it before end of function.
45056>>>        Move Err to bTmp
45057>>>        Move False to Err
45058>>>
45058>>>        Get AutoConnectionIDLogin to bOK
45059>>>        // First get the info for the current filelist slot:
45059>>>        Open iFromFileSlot
45061>>>        Get_Attribute DF_FILE_OPENED of iFromFileSlot to bOK
45064>>>        If (bOK = True) Begin
45066>>>            Get_Attribute DF_FILE_ROOT_NAME    of iFromFileSlot to sFileName
45069>>>            Get_Attribute DF_FILE_LOGICAL_NAME of iFromFileSlot to sTableName
45072>>>            Get_Attribute DF_FILE_DISPLAY_NAME of iFromFileSlot to sDisplayName
45075>>>
45075>>>            //...then move it.
45075>>>            Set_Attribute DF_FILE_ROOT_NAME    of iToFileSlot to sFileName
45078>>>            Set_Attribute DF_FILE_LOGICAL_NAME of iToFileSlot to sTableName
45081>>>            Set_Attribute DF_FILE_DISPLAY_NAME of iToFileSlot to sDisplayName
45084>>>
45084>>>            //...and finally remove the old filelist values.
45084>>>            Set_Attribute DF_FILE_ROOT_NAME    of iFromFileSlot to ""
45087>>>            Set_Attribute DF_FILE_LOGICAL_NAME of iFromFileSlot to ""
45090>>>            Set_Attribute DF_FILE_DISPLAY_NAME of iFromFileSlot to ""
45093>>>        End
45093>>>>
45093>>>        Close iFromFileSlot
45094>>>
45094>>>        Move Err to bErr
45095>>>        Move bTmp to Err
45096>>>        Function_Return (bErr = False)
45097>>>    End_Function
45098>>>
45098>>>    Function ApiTableRelate Handle hTableFrom Handle hTableTo Integer iColumnFrom Integer iColumnTo Returns Boolean
45100>>>        Handle hTable
45100>>>        Boolean bOK
45100>>>        String sDriverID
45100>>>
45100>>>        Get AutoConnectionIDLogin to bOK
45101>>>        Move False to Err
45102>>>        Open hTableFrom Mode DF_EXCLUSIVE
45104>>>        If (hTableTo > 0) Begin
45106>>>            Open hTableTo
45108>>>        End
45108>>>>
45108>>>        Move hTableFrom to hTable
45109>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
45112>>>        Set Private.phCurrentTable to hTable
45113>>>
45113>>>        Structure_Start hTable sDriverID            
45114>>>            Set_Attribute DF_FIELD_RELATED_FILE of hTable iColumnFrom to hTableTo
45117>>>            If (iColumnTo <> 0) Begin
45119>>>                Set_Attribute DF_FIELD_RELATED_FIELD of hTable iColumnFrom to iColumnTo
45122>>>            End
45122>>>>
45122>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45123>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45125>>>        Set Action_Text of ghoStatusPanel to ""
45126>>>
45126>>>        If (hTableTo > 0) Begin
45128>>>            Close hTableTo
45129>>>        End
45129>>>>
45129>>>
45129>>>        Function_Return (Err = False)
45130>>>    End_Function
45131>>>
45131>>>    // Removes the passed table name completely from disk, filelist (& Sql Server if an Sql-driver)
45131>>>    Function ApiTableRemove Handle hTable Returns Boolean
45133>>>        String sTableName sDriverID
45133>>>        Boolean bOk
45133>>>        String sDataPath
45133>>>
45133>>>        Get AutoConnectionIDLogin to bOK
45134>>>        Move False to Err
45135>>>        Get psDriverID to sDriverID
45136>>>        Get UtilTableHandleToString hTable sDriverID to sTableName
45137>>>        If (sTableName = "") Begin
45139>>>            Function_Return False
45140>>>        End
45140>>>>
45140>>>
45140>>>        Set Private.phCurrentTable to hTable
45141>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_DELETE_FILE
45142>>>        Delete_db sTableName
45143>>>        Send Trap_Error of Error_Object_Id DFERR_CANT_DELETE_FILE
45144>>>
45144>>>        If (sDriverID <> DATAFLEX_ID) Begin
45146>>>            Get SqlTableRemoveByTableName sDriverID sTableName to bOk
45147>>>            Get psDataPathFirstPart to sDataPath
45148>>>            Get vDeleteFile (sDataPath + sTableName + ".int") to bOk
45149>>>        End
45149>>>>
45149>>>        // Also remove table from filelist.cfg in case the physical file didn't exist.
45149>>>        If (hTable <> 0) Begin
45151>>>            Set_Attribute DF_FILE_ROOT_NAME     of hTable to ""
45154>>>            Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to ""
45157>>>            Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to ""
45160>>>        End
45160>>>>
45160>>>
45160>>>        Close hTable
45161>>>        Function_Return (hTable <> 0)
45162>>>    End_Function
45163>>>
45163>>>    Function ApiTableRemoveRelation Handle hTableTo Integer iColumn Returns Boolean
45165>>>        Handle hTable
45165>>>        Boolean bOK
45165>>>
45165>>>        Get AutoConnectionIDLogin to bOK
45166>>>        Move False to Err
45167>>>        Open hTableTo Mode DF_EXCLUSIVE
45169>>>        Move hTableTo to hTable
45170>>>
45170>>>        Structure_Start hTable
45171>>>            Set_Attribute DF_FIELD_RELATED_FILE of hTable iColumn to 0
45174>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45175>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45177>>>        Set Action_Text of ghoStatusPanel to ""
45178>>>
45178>>>        Close hTableTo
45179>>>        Function_Return (Err = False)
45180>>>    End_Function
45181>>>
45181>>>    Function ApiTableRename Integer hTable String sRootName String sDisplayName String sLogicalName Returns Boolean
45183>>>        String sPhysicalName sRootNameTo sLogicalNameTo sDataPath sDriverID sSchema sPhysicalNameTo
45183>>>        Boolean bOK bExists bOpened     
45183>>>        tAPITableNameInfo APITableNameInfo
45183>>>        tAPITableNameInfo APITableNameInfo
45183>>>        
45183>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
45186>>>        If (bOpened = False) Begin
45188>>>            Get OpenTableExclusive hTable to bOpened
45189>>>            If (bOpened = False) Begin
45191>>>                Send UserError DFERR_PROGRAM ("Could not open table number:" * String(hTable) * "Table could not be updated.")
45192>>>                Function_Return False
45193>>>            End
45193>>>>
45193>>>        End
45193>>>>
45193>>>
45193>>>        Set Private.phCurrentTable to hTable
45194>>>        Move hTable         to APITableNameInfo.iTableNumber
45195>>>        Move sRootName      to APITableNameInfo.sRootName
45196>>>        Move sLogicalName   to APITableNameInfo.sLogicalName
45197>>>        Move sDisplayName   to APITableNameInfo.sDisplayName
45198>>>        Get ApiTableFilelistNamesCompare True APITableNameInfo to bExists
45199>>>        If (bExists = True) Begin
45201>>>            Function_Return True
45202>>>        End
45202>>>>
45202>>>        
45202>>>        Set Private.phCurrentTable to hTable
45203>>>        Move False to Err  
45204>>>        Get psDataPathFirstPart to sDataPath
45205>>>        Get_Attribute DF_FILE_PHYSICAL_NAME of hTable to sPhysicalName
45208>>>        Get_Attribute DF_FILE_ROOT_NAME     of hTable to sRootNameTo
45211>>>        Get_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalNameTo
45214>>>
45214>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
45217>>>        Close hTable
45218>>>        If (sDriverID = DATAFLEX_ID) Begin
45220>>>            Get vFilePathExists (sDataPath + sRootNameTo + ".dat") to bExists
45221>>>            If (bExists = True) Begin
45223>>>                If (Uppercase(sRootName) <> Uppercase(sRootNameTo)) Begin
45225>>>                    Copy_db (sDataPath + sRootNameTo) to (sDataPath + sRootName)
45228>>>                    // We need a short break here before attempting to delete the physical old files or Windows
45228>>>                    // might report "File in use..." and the deletion will fail.
45228>>>                    Sleep 2
45229>>>                    Get vDeleteFile (sDataPath + sRootNameTo + ".*") to bOK
45230>>>                End
45230>>>>
45230>>>            End
45230>>>>
45230>>>        End
45230>>>>
45230>>>
45230>>>        If (sDriverID <> DATAFLEX_ID) Begin           
45232>>>            If (not(sPhysicalName contains ".")) Begin
45234>>>                Move (sPhysicalName + String(".int")) to sPhysicalName
45235>>>            End
45235>>>>
45235>>>            
45235>>>            // Change the table name in the .int file to the new table new:
45235>>>            Get UtilChangeSourceCodeLine (sDataPath + sPhysicalName) (CS_DATABASE_NAME * String(sLogicalNameTo)) (CS_DATABASE_NAME * String(sLogicalName)) False to bOK
45236>>>            If (bOK = False) Begin
45238>>>                Function_Return False
45239>>>            End
45239>>>>
45239>>>            
45239>>>            // Change table name at the SQL side:
45239>>>            Get psSchema to sSchema
45240>>>            Get SqlTableRename hTable sLogicalNameTo sLogicalName to bOK 
45241>>>            
45241>>>            Get _TableNameOnly sRootName to sPhysicalNameTo
45242>>>            // Remove cache file and Rename the physical file names:
45242>>>            Get vDeleteFile (sDataPath + sPhysicalNameTo + ".cch")                                  to bOK 
45243>>>            Get vRenameFile (sDataPath + sPhysicalName)            (sDataPath + sRootName + ".int") to bOK
45244>>>            Get vRenameFile (sDataPath + sPhysicalNameTo + ".tag") (sDataPath + sRootName + ".tag") to bOK
45245>>>            Move (sDriverID + ":" + sRootName) to sRootName         
45246>>>            If (not(sDisplayName contains ".")) Begin
45248>>>                Move (sSchema + "." + sDisplayName) to sDisplayName
45249>>>            End
45249>>>>
45249>>>        End
45249>>>>
45249>>>
45249>>>        Set_Attribute DF_FILE_ROOT_NAME     of hTable to sRootName
45252>>>        Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayName
45255>>>        Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalName
45258>>>
45258>>>        Function_Return (Err = False)
45259>>>    End_Function
45260>>>
45260>>>    Function ApiTableRenameAlias Integer hTable String sDisplayName String sLogicalName Returns Boolean
45262>>>        Move False to Err
45263>>>        Set Private.phCurrentTable to hTable
45264>>>        Set_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayName
45267>>>        Set_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalName
45270>>>
45270>>>        Function_Return (Err = False)
45271>>>    End_Function
45272>>>
45272>>>    // Compares the RootName, LogicalName & DisplayName and returns True if they are equal.
45272>>>    // Note that it first removes any driver prefixes in the rootname.
45272>>>    Function ApiTableFilelistNamesCompare Boolean bCompareFilelistUppercase tAPITableNameInfo APITableInfo Returns Boolean
45274>>>        String sRootNameFrom sRootNameTo sDisplayNameTo sLogicalNameTo
45274>>>        Handle hTable
45274>>>        Boolean bIsSame
45274>>>
45274>>>        Move APITableInfo.iTableNumber      to hTable
45275>>>        Get _TableNameOnly APITableInfo.sRootName     to sRootNameFrom
45276>>>        Get_Attribute DF_FILE_ROOT_NAME     of hTable to sRootNameTo
45279>>>        Get _TableNoPrefix sRootNameTo                to sRootNameTo
45280>>>        Get_Attribute DF_FILE_LOGICAL_NAME  of hTable to sLogicalNameTo
45283>>>        Get_Attribute DF_FILE_DISPLAY_NAME  of hTable to sDisplayNameTo
45286>>>        Get _TableNoPrefix sDisplayNameTo             to sDisplayNameTo
45287>>>
45287>>>        If (bCompareFilelistUppercase = True) Begin
45289>>>            Move (Uppercase(sRootNameFrom) = Uppercase(sRootNameTo) and Uppercase(APITableInfo.sLogicalName) = Uppercase(sLogicalNameTo) and ;                  Uppercase(APITableInfo.sDisplayName) = Uppercase(sDisplayNameTo)) to bIsSame
45290>>>        End
45290>>>>
45290>>>        Else Begin
45291>>>            Move (sRootNameFrom = sRootNameTo and APITableInfo.sLogicalName = sLogicalNameTo and APITableInfo.sDisplayName = sDisplayNameTo) to bIsSame
45292>>>        End
45292>>>>
45292>>>
45292>>>        Function_Return bIsSame
45293>>>    End_Function
45294>>>    
45294>>>    // Note: This table update function does _not_ convert an embedded table to SQL. Use function ApiTableConvertToSQL first for that.
45294>>>    Function ApiTableUpdate tAPITableNameInfo APITableNameInfoFrom tAPIColumn[] aColumnsFrom tAPIIndex[] aIndexesFrom tAPIRelation[] aRelationsFrom Returns Boolean
45296>>>        Handle hFile hTable
45296>>>        String sTableName sLogicalName sDisplayName
45296>>>        String sConnectionID sVal sSchema sOriginalDriverID sDriverIDFrom sDriverIDTo sRootName
45296>>>        Integer iColumn iDbType
45296>>>        Boolean bOk bExists bMertechDriver bExistsInFilelist bOpened bApiTableUpdateAuto
45296>>>        Boolean bUseConnectionID bToANSI bRecnum bCopyData bCompareDate_DateTime bCompareIndexAscending bCompareIndexUppercase bTableExists
45296>>>        Boolean bIsSame bSameTableNames bFilelistError bIsAliasFrom bIsAliasTo bIsSQLTableFrom bIsSQLTableTo
45296>>>        tSQLConnection SQLConnection
45296>>>        tSQLConnection SQLConnection
45296>>>        tAPITable      APITableFrom APITableTo
45296>>>        tAPITable      APITableFrom APITableTo
45296>>>        tColumnType    ColumnType
45296>>>        tColumnType    ColumnType
45296>>>        tAPIColumnCompare[]   aAPIColumnCompare
45296>>>        tAPIColumnCompare[]   aAPIColumnCompare
45297>>>        tAPIIndexCompare[]    aAPIIndexCompare
45297>>>        tAPIIndexCompare[]    aAPIIndexCompare
45298>>>        tAPIRelationCompare[] aAPIRelationCompare
45298>>>        tAPIRelationCompare[] aAPIRelationCompare
45299>>>
45299>>>        // We don't allow update of the framework's DbVersion table.
45299>>>        If (Lowercase(sTableName) = "dbversion") Begin
45301>>>            Function_Return False
45302>>>        End
45302>>>>
45302>>>        
45302>>>        Move APITableNameInfoFrom.sDriverID     to sDriverIDFrom
45303>>>        Get piDbType                            to iDbType
45304>>>        Get pbRecnum                            to bRecnum
45305>>>        Get pbToANSI                            to bToANSI
45306>>>        Get pbCopyData                          to bCopyData
45307>>>        Get pbApiTableUpdateAuto                to bApiTableUpdateAuto
45308>>>        Get pbCompareDate_DateTime              to bCompareDate_DateTime
45309>>>        Get pbCompareIndexAscending             to bCompareIndexAscending
45310>>>        Get pbCompareIndexUppercase             to bCompareIndexUppercase   
45311>>>        Get IsMertechDriver sDriverIDFrom       to bMertechDriver
45312>>>        Get pbUseConnectionID                   to bUseConnectionID
45313>>>        If (bMertechDriver = True and bUseConnectionID = True) Begin
45315>>>            Move False                          to bUseConnectionID
45316>>>        End
45316>>>>
45316>>>
45316>>>        Move APITableNameInfoFrom.iTableNumber  to hTable
45317>>>        Set Private.phCurrentTable              to hTable
45318>>>        Get UtilTableExists  hTable             to bTableExists     
45319>>>        
45319>>>        If (ghoProgressBar <> 0) Begin
45321>>>            Send DoAdvance of ghoProgressBar
45322>>>            Set TableName_Text of ghoStatusPanel to ("Checking Table:" * "Number:" * String(hTable) * String(APITableNameInfoFrom.sLogicalName))
45323>>>        End
45323>>>>
45323>>>
45323>>>        Move APITableNameInfoFrom.bIsAlias      to bIsAliasFrom
45324>>>        Move APITableNameInfoFrom.bIsSQL        to bIsSQLTableFrom
45325>>>        Get UtilDriverFromTableNumber hTable    to sDriverIDTo
45326>>>        Get UtilTableIsSQL   hTable             to bIsSQLTableTo
45327>>>        Move True                               to APITableFrom.bFromTable
45328>>>        Move hTable                             to APITableFrom.hTable
45329>>>        Move APITableNameInfoFrom               to APITableFrom.ApiTableInfo
45330>>>        Move aColumnsFrom                       to APITableFrom.aApiColumns
45331>>>        Move aIndexesFrom                       to APITableFrom.aApiIndexes
45332>>>        Move aRelationsFrom                     to APITableFrom.aApiRelations
45333>>>        
45333>>>        If (bTableExists = True) Begin
45335>>>            Get OpenTableExclusive hTable to bOpened
45336>>>            If (bOpened = False) Begin
45338>>>                Send UserError DFERR_PROGRAM ("Could not open table number:" * String(hTable) * "Table could not be updated.")
45339>>>                Function_Return False
45340>>>            End
45340>>>>
45340>>>            Get UtilTableStructFill hTable False                                                        to APITableTo
45341>>>            Get UtilColumnCombineFromAndToArrays APITableFrom.aApiColumns     APITableTo.aApiColumns    to aAPIColumnCompare
45342>>>            Get UtilIndexCombineFromAndToArrays  APITableFrom.aApiIndexes     APITableTo.aApiIndexes    to aAPIIndexCompare
45343>>>            Get UtilRelationCombineFromAndToArrays APITableFrom.aApiRelations APITableTo.aApiRelations  to aAPIRelationCompare
45344>>>        End
45344>>>>
45344>>>        
45344>>>        Move False to Err
45345>>>        Case Begin
45345>>>            // Alias table:
45345>>>            Case (bIsAliasFrom = True)
45347>>>                Get _UtilTableCheckChangeFilelistNames APITableNameInfoFrom to bOk
45348>>>                Case Break
45349>>>            
45349>>>            // New Table:
45349>>>            Case (bTableExists = False)
45352>>>                Get ApiTableCreate      hTable APITableNameInfoFrom.sRootName APITableNameInfoFrom.sDisplayName APITableNameInfoFrom.sLogicalName bUseConnectionID bToANSI bRecnum aColumnsFrom to bOk
45353>>>                Get UtilIndexesUpdate   hTable bIsSQLTableFrom bIsSQLTableTo APITableFrom.aApiIndexes APITableTo.aApiIndexes bCompareIndexUppercase bCompareIndexAscending  to bOk
45354>>>                Get UtilRelationsUpdate hTable APITableFrom.aApiRelations APITableTo.aApiRelations to bOk
45355>>>                Case Break
45356>>>    
45356>>>            // Update table:    
45356>>>            Case (bTableExists = True)
45359>>>                Get UtilTableCompare APITableFrom APITableTo False (&bFilelistError) to bIsSame
45360>>>                If (bIsSame = True) Begin
45362>>>                    Case Break
45363>>>                End
45363>>>>
45363>>>                If (bFilelistError = True) Begin
45365>>>                    Get ApiTableRename hTable APITableNameInfoFrom.sRootName APITableNameInfoFrom.sDisplayName APITableNameInfoFrom.sLogicalName to bOk
45366>>>                    If (bOk = False) Begin
45368>>>                        Case Break
45369>>>                    End
45369>>>>
45369>>>                End
45369>>>>
45369>>>
45369>>>                If (ghoProgressBar <> 0) Begin
45371>>>                    Send DoAdvance of ghoProgressBar
45372>>>                    Set TableName_Text of ghoStatusPanel to ("Updating Table:" * "Number:" * String(hTable) * String(APITableNameInfoFrom.sLogicalName))
45373>>>                End
45373>>>>
45373>>>        
45373>>>                // Columns:            
45373>>>                Move True to bOk
45374>>>                Get UtilColumnsCompare sDriverIDFrom sDriverIDTo bIsSQLTableFrom bIsSQLTableTo aAPIColumnCompare bCompareDate_DateTime to bIsSame
45375>>>                If (bIsSame = False) Begin
45377>>>                    Get ApiColumnsUpdate sDriverIDFrom hTable bIsSQLTableFrom APITableFrom.aApiColumns APITableTo.aApiColumns bCompareDate_DateTime to bOk
45378>>>                End
45378>>>>
45378>>>                If (bOk = False) Begin
45380>>>                    Case Break
45381>>>                End
45381>>>>
45381>>>
45381>>>                // Indexes:
45381>>>                Get UtilIndexesCompare bIsSQLTableFrom bIsSQLTableTo aAPIIndexCompare bCompareIndexUppercase bCompareIndexAscending to bIsSame
45382>>>                If (bIsSame = False) Begin
45384>>>                    Get UtilIndexesUpdate hTable bIsSQLTableFrom bIsSQLTableTo APITableFrom.aApiIndexes APITableTo.aApiIndexes bCompareIndexUppercase bCompareIndexAscending  to bOk
45385>>>                End
45385>>>>
45385>>>                
45385>>>                // Relations:
45385>>>                Get UtilRelationsCompare hTable aAPIRelationCompare to bIsSame
45386>>>                If (bIsSame = False) Begin
45388>>>                    Get UtilRelationsUpdate hTable APITableFrom.aApiRelations APITableTo.aApiRelations to bOk
45389>>>                    If (bOk = False) Begin
45391>>>                        Case Break
45392>>>                    End
45392>>>>
45392>>>                End                                                               
45392>>>>
45392>>>                
45392>>>                // Filelist Names:
45392>>>                Get _UtilTableCheckChangeFilelistNames APITableNameInfoFrom to bOk
45393>>>                Case Break
45394>>>
45394>>>            Case Else
45394>>>                Error DFERR_PROGRAM "Unknown Case structure exit in Function ApiTableUpdate"
45395>>>>
45395>>>                Move False to bOk
45396>>>        Case End                     
45396>>>
45396>>>        Close hTable
45397>>>        Set TableName_Text of ghoStatusPanel to ""
45398>>>
45398>>>        Function_Return (bOK = True)
45399>>>    End_Function
45400>>>    
45400>>>    // Replaces all date values with CS_DUFLowestAllowedDateValue for all tables in Filelist.cfg,
45400>>>    // _except_ those tables that has been excluded with the "ApiTableDateCorrectionAddException" message.
45400>>>    // If the passed bAllowZeroDates = True, date columns that are = 0 will not be changed.               
45400>>>    // This is for prepairing embedded tables (*.dat) before an SQL conversion.
45400>>>    //
45400>>>    // The root of the problem is the following:
45400>>>    // The data type Date in SQL has a range of accepted values from 01-01-0001 through 12-31-9999
45400>>>    // while the data type DateTime has a range of accepted values from 01-01-1753 through 12-31-9999
45400>>>    // So if you happen to have a Date from before 1753, or an empty / NULL value - this will be outside 
45400>>>    // the range that DateTime can handle and if you then try to change a Date column to a DateTime,
45400>>>    // an SQL error will be thrown;
45400>>>    // "The conversion of a date data type to a datetime data type resulted in an out-of-range value".
45400>>>    Function ApiTableFixAllDateBogusValues Boolean bFixZeroDates Boolean bResetIndexesToOnLine Returns Boolean
45402>>>        Boolean bOK bIsAlias bIsSQL
45402>>>        Integer iCount iSize iDateSize iItems
45402>>>        Handle hTable                        
45402>>>        String sLogicalName
45402>>>        Integer[] aTablesToCheck aDateFields
45404>>>        
45404>>>        Get _AllTablesDateCorrections to aTablesToCheck
45405>>>        Move (SizeOfArray(aTablesToCheck)) to iSize
45406>>>        Set pbVisible    of ghoProgressBarOverall to True
45407>>>        Set piPosition   of ghoProgressBarOverall to 0
45408>>>        Set piMaximum    of ghoProgressBarOverall to iSize
45409>>>        Set piAdvanceBy  of ghoProgressBarOverall to 1
45410>>>
45410>>>        Move True to bOK
45411>>>        Decrement iSize
45412>>>        for iCount from 0 to iSize
45418>>>>
45418>>>            Move aTablesToCheck[iCount] to hTable 
45419>>>            Set piPosition of ghoProgressBarOverall to iCount
45420>>>            Get UtilTableIsAlias hTable to bIsAlias
45421>>>            Get UtilTableIsSql   hTable to bIsSQL
45422>>>            
45422>>>            Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
45425>>>            Set TableName_Text of ghoStatusPanel to ("Processing Table Number:" * String(hTable) * "Name:" * String(sLogicalName))
45426>>>            Set Message_Text of ghoStatusPanel to "Fixing bogus date values..."
45427>>>
45427>>>            If (bIsAlias = False and bIsSQL = False) Begin
45429>>>                Get UtilCheckForDateFields hTable to aDateFields
45430>>>                Move (SizeOfArray(aDateFields)) to iDateSize
45431>>>                If (iDateSize > 0) Begin
45433>>>                    Get UtilTableCorrectBogusDateValues hTable aDateFields bFixZeroDates bResetIndexesToOnLine to bOK
45434>>>                    Close hTable                                     
45435>>>                End
45435>>>>
45435>>>            End  
45435>>>>
45435>>>        Loop
45436>>>>
45436>>>        
45436>>>        Close DF_ALL
45437>>>        Function_Return bOK
45438>>>    End_Function
45439>>>    
45439>>>    // Returns all fields of type Date or DateTime in an integer array with the field numbers.
45439>>>    Function UtilCheckForDateFields Handle hTable Returns Integer[]
45441>>>        Integer[] aDateFields aDateFieldsEmpty
45443>>>        Integer iField iSize iCount iType
45443>>>        Boolean bOpen
45443>>>        
45443>>>        Open hTable
45445>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
45448>>>        If (bOpen = False) Begin  
45450>>>            Error ("Table could not be opened." * String(hTable))
45451>>>>
45451>>>            Function_Return aDateFieldsEmpty
45452>>>        End                                 
45452>>>>
45452>>>        
45452>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iSize
45455>>>        for iCount from 1 to iSize
45461>>>>
45461>>>            Get_Attribute DF_FIELD_TYPE of hTable iCount to iType
45464>>>            If (iType = DF_DATE or iType = DF_DATETIME) Begin
45466>>>                Move iCount to aDateFields[SizeOfArray(aDateFields)]
45467>>>            End
45467>>>>
45467>>>        Loop
45468>>>>
45468>>>        
45468>>>        Function_Return aDateFields
45469>>>    End_Function         
45470>>>        
45470>>>    // Loops through all records for the passed hTable, and checks that all Date values
45470>>>    // for the passed aDateFields array are OK. Else the Data value is set to CS_DUFLowestAllowedDateValue
45470>>>    // and the record is saved  
45470>>>    // If the passed bAllowZeroDates = True, date columns that are = 0 will not be changed. 
45470>>>    // Note: It first sets all indexes to BATCH and reset them at the end.
45470>>>    Function UtilTableCorrectBogusDateValues Handle hTable Integer[] aDateFields Boolean bFixZeroDates Boolean bResetIndexesToOnLine Returns Boolean
45472>>>        Integer iSize iCount iField iRecord iRetval iTotalRecords iDateFormat
45472>>>        String sValue    
45472>>>        Boolean bCancel bFound bOK bChange bOpened bSaveChanges
45472>>>        Date dDate dDateMin 
45472>>>        Integer[] iaChangeField
45473>>>        
45473>>>        // The CS_DUFLowestAllowedDateValue is defined as "01/01/1753", so we first set the 
45473>>>        // date format to "USA" = "MM/DD/YYYY"
45473>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
45476>>>        Set_Attribute DF_DATE_FORMAT to DF_DATE_USA
45479>>>        
45479>>>        Send SetAllIndexesToBatch hTable True
45480>>>        Open hTable                               
45482>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
45485>>>        If (bOpened = False) Begin
45487>>>            Function_Return False
45488>>>        End                      
45488>>>>
45488>>>        
45488>>>        Set Private.phCurrentTable to hTable
45489>>>        Move 0 to iRecord
45490>>>        Move (SizeOfArray(aDateFields)) to iSize
45491>>>        Decrement iSize
45492>>>        
45492>>>        Get_Attribute DF_FILE_RECORDS_USED of hTable to iTotalRecords
45495>>>        Set piPosition   of ghoProgressBar to 0
45496>>>        Set piAdvanceBy  of ghoProgressBar to 100
45497>>>        Set piMaximum    of ghoProgressBar to iTotalRecords
45498>>>        Move CS_DUFLowestAllowedDateValue  to dDateMin
45499>>>        Move False to Err
45500>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
45501>>>        
45501>>>        Clear hTable     
45502>>>        Repeat
45502>>>>
45502>>>            Vfind hTable 0 GT
45504>>>            Move Found to bFound
45505>>>            If (bFound = True) Begin    
45507>>>                Move False to bSaveChanges   
45508>>>                Move (ResizeArray(iaChangeField, 0)) to iaChangeField 
45509>>>                Move (SizeOfArray(aDateFields)) to iSize
45510>>>                Decrement iSize
45511>>>                for iCount from 0 to iSize   
45517>>>>
45517>>>                    Move aDateFields[iCount] to iField
45518>>>                    Get_Field_Value hTable iField to dDate
45521>>>                    If (bFixZeroDates = True) Begin
45523>>>                        Move (dDate = 0 or dDate < dDateMin) to bChange
45524>>>                    End 
45524>>>>
45524>>>                    Else Begin
45525>>>                        Move (dDate <> 0 and dDate < dDateMin) to bChange
45526>>>                    End
45526>>>>
45526>>>                    If (bChange = True) Begin      
45528>>>                        Move iField to iaChangeField[SizeOfArray(iaChangeField)]            
45529>>>                    End
45529>>>>
45529>>>                Loop       
45530>>>>
45530>>>                
45530>>>                // Only change Date fields that needs to be changed.
45530>>>                If (SizeOfArray(iaChangeField)) Begin
45532>>>                    Reread hTable 
45536>>>                        Move (SizeOfArray(iaChangeField)) to iSize
45537>>>                        Decrement iSize      
45538>>>                        for iCount from 0 to iSize
45544>>>>
45544>>>                            Move iaChangeField[iCount] to iField
45545>>>                            Set Private.piCurrentField to iField
45546>>>                            Set_Field_Value hTable iField to dDateMin  
45549>>>                        Loop
45550>>>>
45550>>>                        Move False to Err
45551>>>                        SaveRecord hTable
45552>>>                    Unlock
45553>>>>
45553>>>                End
45553>>>>
45553>>>                
45553>>>                Increment iRecord
45554>>>                // Increment the StatusPanel counter and check the
45554>>>                // cancel status every 100 records rather than every
45554>>>                // record, it's way faster.
45554>>>                If (Mod(iRecord, 100) = 0) Begin
45556>>>                    Send DoAdvance of ghoProgressBar
45557>>>                    Set Action_Text of ghoStatusPanel to ("Record:" * String(iRecord))
45558>>>                    Get Check_StatusPanel of ghoStatusPanel to bCancel
45559>>>                End 
45559>>>>
45559>>>            End
45559>>>>
45559>>>        Until (bFound = False)
45561>>>                
45561>>>        Set_Attribute DF_DATE_FORMAT to iDateFormat   
45564>>>        If (bResetIndexesToOnLine = True) Begin
45566>>>            Send SetAllIndexesToBatch hTable False
45567>>>        End
45567>>>>
45567>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
45568>>>        
45568>>>        Function_Return (Err = False)
45569>>>    End_Function 
45570>>>        
45570>>>
45570>>>    // * Dummy function for the Studio's Code Explorer *
45570>>>    Function API_COLUMN_FUNCTIONS Returns Boolean
45572>>>        Function_Return False
45573>>>    End_Function
45574>>>
45574>>>    // Adds a column name to the passed table number.
45574>>>    Function ApiColumnAdd Handle hTable String sFieldName Integer iType Integer iLength Integer iPrec Boolean bInitVal String sColVal Returns Boolean
45576>>>        Integer iColumn iCount iFile iPrecision
45576>>>        Boolean bExists bOK bInitializeValue bRetval
45576>>>        String sDdSrcPath sTableName sColumnValue
45576>>>
45576>>>        Get UtilColumnExists hTable sFieldName to bExists
45577>>>        Move False to Err
45578>>>        If (bExists = True) Begin
45580>>>            Function_Return False
45581>>>        End
45581>>>>
45581>>>        If (num_arguments > 4) Begin
45583>>>            Move iPrec to iPrecision
45584>>>        End
45584>>>>
45584>>>        If (num_arguments > 6) Begin
45586>>>            Move bInitVal to bInitializeValue
45587>>>            Move sColVal  to sColumnValue
45588>>>        End
45588>>>>
45588>>>        If (iType < -1490) Begin
45590>>>            Move (iType + 1500) to iType
45591>>>        End
45591>>>>
45591>>>
45591>>>        Get AutoConnectionIDLogin to bOK
45592>>>        Move False to Err
45593>>>        // Structure_start will change the value of hTable...
45593>>>        Move hTable to iFile
45594>>>        Open iFile Mode DF_EXCLUSIVE
45596>>>
45596>>>        Set Private.phCurrentTable to hTable
45597>>>        Structure_Start iFile
45598>>>            Move 0 to iColumn
45599>>>            Set Private.piCurrentField to iColumn
45600>>>            Create_Field hTable At iColumn
45601>>>            Set_Attribute DF_FIELD_NAME      of iFile iColumn to sFieldName
45604>>>            Set_Attribute DF_FIELD_TYPE      of iFile iColumn to iType
45607>>>            Set_Attribute DF_FIELD_LENGTH    of iFile iColumn to (iLength + iPrecision)
45610>>>            Set_Attribute DF_FIELD_PRECISION of iFile iColumn to iPrecision
45613>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45614>>>        Structure_End iFile DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45616>>>        Set Action_Text of ghoStatusPanel to ""
45617>>>
45617>>>        // If in development environment; create .fd file:
45617>>>        Open hTable
45619>>>        Get psDdSrcPath of (phoWorkspace(ghoApplication)) to sDDSrcPath
45620>>>        Get CountOfPaths of (phoWorkspace(ghoApplication)) sDDSrcPath to iCount
45621>>>        If (iCount > 1) Begin
45623>>>            Get PathAtIndex of (phoWorkspace(ghoApplication)) sDDSrcPath 1 to sDDSrcPath
45624>>>        End
45624>>>>
45624>>>        Get vFolderExists sDDSrcPath to bExists
45625>>>        If (bExists = True) Begin
45627>>>            Get vFolderFormat sDDSrcPath to sDDSrcPath
45628>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sTableName
45631>>>            Get _TableNameOnly sTableName to sTableName
45632>>>            Output_Aux_File DF_AUX_FILE_FD for hTable to (sDDSrcPath + sTableName + ".fd")
45634>>>        End
45634>>>>
45634>>>
45634>>>        // Check for a default value
45634>>>        If (bInitializeValue = True and sColumnValue <> "" and Err = False) Begin
45636>>>            Get ApiColumnUpdateValue hTable sFieldName sColumnValue to bRetval
45637>>>        End
45637>>>>
45637>>>        Close hTable
45638>>>
45638>>>        Function_Return (Err = False)
45639>>>    End_Function
45640>>>
45640>>>    // Adds a column name to the passed table number.
45640>>>    Function ApiColumnInsert Handle hTable Integer iColumn String sFieldName Integer iType Integer iLength Integer iPrec Boolean bIsSQLType Returns Boolean
45642>>>        Integer iCount iFile iPrecision iNumberOfFields
45642>>>        Boolean bExists bOK bInitializeValue bRetval bIsDateType
45642>>>        String sDdSrcPath sTableName sColumnValue
45642>>>
45642>>>        Get UtilColumnExists hTable sFieldName to bExists
45643>>>        Move False to Err
45644>>>        If (bExists = True) Begin
45646>>>            Function_Return False
45647>>>        End
45647>>>>
45647>>>        If (num_arguments > 4) Begin
45649>>>            Move iPrec to iPrecision
45650>>>        End
45650>>>>
45650>>>        If (iType < -1490) Begin
45652>>>            Move (iType + 1500) to iType
45653>>>        End
45653>>>>
45653>>>
45653>>>        Get AutoConnectionIDLogin to bOK
45654>>>        Move False to Err
45655>>>        // Structure_start will change the value of hTable...
45655>>>        Move hTable to iFile
45656>>>        Get OpenTableExclusive iFile to bOK
45657>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iNumberOfFields
45660>>>        
45660>>>        // If the passed column number is higher than the current number of fields
45660>>>        // in the table, this means we should _not_ insert a field but rather add
45660>>>        // a new field to the end:
45660>>>        If (iColumn > iNumberOfFields) Begin
45662>>>            Move 0 to iColumn
45663>>>        End
45663>>>>
45663>>>
45663>>>        Set Private.phCurrentTable to hTable
45664>>>        Set Private.piCurrentField to iColumn
45665>>>
45665>>>        Structure_Start iFile
45666>>>            Create_Field iFile At iColumn
45667>>>            Set_Attribute DF_FIELD_NAME            of iFile iColumn to sFieldName
45670>>>            If (bIsSQLType = False) Begin
45672>>>                Set_Attribute DF_FIELD_TYPE        of iFile iColumn to iType
45675>>>            End 
45675>>>>
45675>>>            Else Begin
45676>>>                Set_Attribute DF_FIELD_NATIVE_TYPE of iFile iColumn to iType
45679>>>            End
45679>>>>
45679>>>            Get UtilColumnIsDateType iType False to bIsDateType
45680>>>            If (bIsDateType = False) Begin
45682>>>                Set_Attribute DF_FIELD_LENGTH       of iFile iColumn to (iLength + iPrecision)
45685>>>                Set_Attribute DF_FIELD_PRECISION    of iFile iColumn to iPrecision
45688>>>            End
45688>>>>
45688>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45689>>>        Structure_End iFile DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45691>>>
45691>>>        Set Action_Text of ghoStatusPanel to ""
45692>>>        // If in development environment; create .fd file:
45692>>>        Open hTable
45694>>>        Get psDdSrcPath of (phoWorkspace(ghoApplication)) to sDDSrcPath
45695>>>        Get CountOfPaths of (phoWorkspace(ghoApplication)) sDDSrcPath to iCount
45696>>>        If (iCount > 1) Begin
45698>>>            Get PathAtIndex of (phoWorkspace(ghoApplication)) sDDSrcPath 1 to sDDSrcPath
45699>>>        End
45699>>>>
45699>>>        Get vFolderExists sDDSrcPath to bExists
45700>>>        If (bExists = True) Begin
45702>>>            Get vFolderFormat sDDSrcPath to sDDSrcPath
45703>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sTableName
45706>>>            Get _TableNameOnly sTableName to sTableName
45707>>>            Output_Aux_File DF_AUX_FILE_FD for hTable to (sDDSrcPath + sTableName + ".fd")
45709>>>        End
45709>>>>
45709>>>
45709>>>        // Check for a default value
45709>>>        Close hTable
45710>>>
45710>>>        Function_Return (Err = False)
45711>>>    End_Function
45712>>>
45712>>>//    Function ApiColumnAddMultiple Handle hTable tAPIColumn[] aColumns Returns Boolean
45712>>>//        Integer iColumn iCount iFile
45712>>>//        Boolean bExists bOK
45712>>>//        String sDdSrcPath sTableName
45712>>>//
45712>>>//        Get AutoConnectionIDLogin to bOK
45712>>>//        Move False to Err
45712>>>//
45712>>>//        // Structure_start will change the value of hTable...
45712>>>//        Move hTable to iFile
45712>>>//        Open iFile Mode DF_EXCLUSIVE
45712>>>//
45712>>>//        Structure_Start iFile
45712>>>//            Send ApiColumnsAddToTable iFile aColumns False
45712>>>//        Structure_End iFile DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45712>>>//
45712>>>//        // If in development environment; create .fd file:
45712>>>//        Open hTable
45712>>>//        Get psDdSrcPath of (phoWorkspace(ghoApplication)) to sDDSrcPath
45712>>>//        Get CountOfPaths of (phoWorkspace(ghoApplication)) sDDSrcPath to iCount
45712>>>//        If (iCount > 1) Begin
45712>>>//            Get PathAtIndex of (phoWorkspace(ghoApplication)) sDDSrcPath 1 to sDDSrcPath
45712>>>//        End
45712>>>//        Get vFolderExists sDDSrcPath to bExists
45712>>>//        If (bExists = True) Begin
45712>>>//            Get vFolderFormat sDDSrcPath to sDDSrcPath
45712>>>//            Get_Attribute DF_FILE_ROOT_NAME of hTable to sTableName
45712>>>//            Get _TableNameOnly sTableName to sTableName
45712>>>//            Output_Aux_File DF_AUX_FILE_FD for hTable to (sDDSrcPath + sTableName + ".fd")
45712>>>//        End
45712>>>//        Close hTable
45712>>>//
45712>>>//        Function_Return (Err = False)
45712>>>//    End_Function
45712>>>
45712>>>    // To update all records for a table column with a fixed value.
45712>>>    Function ApiColumnUpdateValue Handle hTable String sFieldName String sColumnValue Returns Boolean
45714>>>        Integer iRecs iCurrErr iField iRecord
45714>>>        Boolean bRetval bOpen
45714>>>
45714>>>        Move 0 to iRecs
45715>>>        Move False to bRetval
45716>>>        Move Err to iCurrErr
45717>>>        Move False to Err
45718>>>
45718>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
45721>>>        If (bOpen = False) Begin
45723>>>            Open hTable
45725>>>            Get_Attribute DF_FILE_OPENED of hTable to bOpen
45728>>>            If (bOpen = False) Begin
45730>>>                Function_Return bRetval
45731>>>            End
45731>>>>
45731>>>        End
45731>>>>
45731>>>
45731>>>        Field_Map hTable sFieldName to iField
45733>>>        If (iField <> 0) Begin
45735>>>            Set Private.phCurrentTable to hTable
45736>>>            Set Private.piCurrentField to iField
45737>>>            Clear hTable
45738>>>            Repeat
45738>>>>
45738>>>                Vfind hTable 0 GT
45740>>>                If (Found) Begin
45742>>>                    If (ghoStatusPanel <> 0) Begin
45744>>>                        Get_Field_Value hTable 0 to iRecord
45747>>>                        Send Update_StatusPanel of ghoStatusPanel (CS_UpdateVersion * String(iRecord))
45748>>>                    End
45748>>>>
45748>>>                    Reread hTable
45752>>>                        Set_Field_Value hTable iField to sColumnValue
45755>>>                        SaveRecord hTable
45756>>>                    Unlock
45757>>>>
45757>>>                End
45757>>>>
45757>>>           Until (not(Found))
45759>>>        End
45759>>>>
45759>>>
45759>>>        Move (Err = False) to bRetval
45760>>>        Move iCurrErr to Err
45761>>>
45761>>>        Function_Return bRetval
45762>>>    End_Function
45763>>>    
45763>>>    // Note: This can only be used from within a Structure_Start/End construct.
45763>>>    Function ApiColumnsAddToTable Handle hTable tAPIColumn[] aColumns Boolean bCreating Returns Boolean
45765>>>        Integer iCount iSize iColumn iType iDataFlexType iIndex iDbType
45765>>>        Boolean bFieldExists bNativeType bIsSQLDriver bIsDAWSqlDriver bIsSqlTable bRecnumTable bIsOpen bIsDateType
45765>>>        String sFieldName sDriverID sTableName sDefaultValue
45765>>>
45765>>>//        Set Private.phCurrentTable to hTable
45765>>>        Get psDriverID to sDriverID
45766>>>        Get piDbType to iDbType
45767>>>        Get UtilTableHandleToString hTable to sTableName
45768>>>        Get IsSQLDriver    sDriverID to bIsSQLDriver
45769>>>        Get IsDAWSQLDriver sDriverID to bIsDAWSqlDriver
45770>>>        Get UtilTableIsSQL hTable to bIsSqlTable
45771>>>        If (bIsSqlTable = False and bCreating = True and bIsSQLDriver = True) Begin
45773>>>            Move True to bIsSqlTable
45774>>>        End
45774>>>>
45774>>>        Move False to bIsOpen
45775>>>        If (hTable > 0) Begin
45777>>>            Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
45780>>>        End
45780>>>>
45780>>>        If (bIsOpen = True) Begin
45782>>>            Get_Attribute DF_FILE_RECNUM_TABLE of hTable to bRecnumTable
45785>>>        End
45785>>>>
45785>>>        Else Begin        
45786>>>            Get pbRecnum to bRecnumTable
45787>>>        End
45787>>>>
45787>>>        
45787>>>        Move False to Err
45788>>>        Move (SizeOfArray(aColumns)) to iSize
45789>>>        Decrement iSize
45790>>>        for iCount from 0 to iSize
45796>>>>
45796>>>            Move aColumns[iCount].sFieldName to sFieldName
45797>>>            If (hTable > 0) Begin
45799>>>                Set Error_Report_Mode to DUF_ERROR_NO_REPORT
45800>>>                Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
45801>>>                Get_Attribute DF_FIELD_NAME of hTable iColumn to sFieldName
45804>>>                Move (Trim(sFieldName) <> "") to bFieldExists
45805>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
45806>>>                Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
45807>>>            End
45807>>>>
45807>>>            Else Begin
45808>>>                Move False to bFieldExists
45809>>>            End
45809>>>>
45809>>>
45809>>>            If (bFieldExists = False) Begin
45811>>>                Move 0 to iColumn
45812>>>                Create_Field hTable At iColumn
45813>>>            End
45813>>>>
45813>>>            Else Begin
45814>>>                Move iCount to iColumn
45815>>>            End
45815>>>>
45815>>>
45815>>>            Set Private.piCurrentField to iColumn
45816>>>
45816>>>            Move                                        iColumn to aColumns[iCount].iFieldNumber
45817>>>            Set_Attribute DF_FIELD_NAME       of hTable iColumn to aColumns[iCount].sFieldName
45820>>>
45820>>>            Move aColumns[iCount].iType to iType
45821>>>            Move (not(iType < -1490)) to bNativeType
45822>>>            If (iType < -1490) Begin
45824>>>                Move (iType + 1500) to iType
45825>>>            End
45825>>>>
45825>>>
45825>>>            If (bIsSqlTable = True) Begin
45827>>>                If (aColumns[iCount].bIsSQLType = True) Begin
45829>>>                    Get UtilSQLColumnTypeToDataFlexType sDriverID iDbType iType aColumns[iCount].iLength to iDataFlexType
45830>>>                    Set_Attribute DF_FIELD_TYPE          of hTable iColumn to iDataFlexType
45833>>>                    Set_Attribute DF_FIELD_NATIVE_TYPE   of hTable iColumn to iType  
45836>>>                    Set_Attribute DF_FIELD_NULL_ALLOWED  of hTable iColumn to aColumns[iCount].bAllowNULL
45839>>>                    
45839>>>                    Move aColumns[iCount].sDefaultValue                    to sDefaultValue
45840>>>                    If (iDataFlexType = DF_BCD and Left(sDefaultValue, 1 <> "[")) Begin
45842>>>                        Move ("[" + String(sDefaultValue) + "]") to sDefaultValue
45843>>>                    End
45843>>>>
45843>>>                    Set_Attribute DF_FIELD_DEFAULT_VALUE of hTable iColumn to sDefaultValue 
45846>>>                
45846>>>                End
45846>>>>
45846>>>                Else Begin
45847>>>                    Set_Attribute DF_FIELD_TYPE        of hTable iColumn to iType
45850>>>                End
45850>>>>
45850>>>            End
45850>>>>
45850>>>            Else Begin
45851>>>                If (bCreating = False) Begin
45853>>>                    Get UtilSQLColumnTypeToDataFlexType sDriverID iDbType iType aColumns[iCount].iLength to iType
45854>>>                End
45854>>>>
45854>>>                Set_Attribute DF_FIELD_TYPE of hTable iColumn to iType
45857>>>            End
45857>>>>
45857>>>            
45857>>>            Get UtilColumnIsDateType iType bIsSqlTable to bIsDateType
45858>>>            If (bIsDateType = False) Begin
45860>>>                Set_Attribute DF_FIELD_LENGTH     of hTable iColumn to aColumns[iCount].iLength
45863>>>                Set_Attribute DF_FIELD_PRECISION  of hTable iColumn to aColumns[iCount].iPrecision
45866>>>            End
45866>>>>
45866>>>
45866>>>            If (aColumns[iCount].iOptions iand C_tAPIColumn_Identity) Begin
45868>>>                Move 0 to iIndex
45869>>>                Create_Index hTable at iIndex
45870>>>                Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to 1
45873>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD   of hTable iIndex 1 to iColumn
45876>>>                Set_Attribute DF_FILE_PRIMARY_INDEX    of hTable iIndex to 1
45879>>>
45879>>>                // If we have an identity table - we must create a primary_key table.
45879>>>                If (bIsSqlTable = True) Begin
45881>>>                    Set_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable iIndex to True
45884>>>                    Set_Attribute DF_FIELD_IS_IDENTITY of hTable iColumn to True
45887>>>                End
45887>>>>
45887>>>            End
45887>>>>
45887>>>        Loop             
45888>>>>
45888>>>        
45888>>>        Function_Return (Err = False)
45889>>>    End_Function
45890>>>
45890>>>    // Changes a field type, length and precision for the passed table number and field name
45890>>>    Function ApiColumnChange Handle hTable String sFieldNameFrom Integer iTypeFrom Integer iLengthFrom Integer iPrec Returns Boolean
45892>>>        Integer iColumn iPrecFrom iTypeTo iLengthTo iPrecTo
45892>>>        Boolean bOK bIsSqlTable
45892>>>        String sFieldNameTo
45892>>>
45892>>>        If (num_arguments > 4) Begin
45894>>>            Move iPrec to iPrecFrom
45895>>>        End
45895>>>>
45895>>>        If (iTypeFrom < -1490) Begin
45897>>>            Move (iTypeFrom + 1500) to iTypeFrom
45898>>>        End
45898>>>>
45898>>>
45898>>>        Get AutoConnectionIDLogin to bOK
45899>>>        Move False to Err
45900>>>        Get OpenTableExclusive hTable to bOK
45901>>>        If (bOK = False) Begin
45903>>>            Function_Return False
45904>>>        End
45904>>>>
45904>>>
45904>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
45905>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
45906>>>        Field_Map hTable sFieldNameFrom to iColumn
45908>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
45909>>>        Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
45910>>>        If (Err = True) Begin
45912>>>            Function_Return False
45913>>>        End
45913>>>>
45913>>>
45913>>>        Get_Attribute DF_FIELD_NAME                  of hTable iColumn to sFieldNameTo
45916>>>        Get UtilTableIsSQL hTable to bIsSqlTable
45917>>>        If (bIsSqlTable = False) Begin
45919>>>            Get_Attribute DF_FIELD_TYPE              of hTable iColumn to iTypeTo
45922>>>        End
45922>>>>
45922>>>        Else Begin
45923>>>            Get_Attribute DF_FIELD_NATIVE_TYPE       of hTable iColumn to iTypeTo
45926>>>        End
45926>>>>
45926>>>        // Let the driver decide the other values;
45926>>>        Get_Attribute DF_FIELD_LENGTH                of hTable iColumn to iLengthTo
45929>>>        Get_Attribute DF_FIELD_PRECISION             of hTable iColumn to iPrecTo
45932>>>
45932>>>        If (sFieldNameFrom = sFieldNameTo and iTypeFrom = iTypeTo and iLengthFrom = iLengthTo and iPrecFrom = iPrecTo) Begin
45934>>>            Function_Return False
45935>>>        End
45935>>>>
45935>>>
45935>>>        Set Private.phCurrentTable to hTable
45936>>>        Set Private.piCurrentField to iColumn
45937>>>
45937>>>        Structure_Start hTable
45938>>>            Set_Attribute DF_FIELD_NAME              of hTable iColumn to sFieldNameFrom
45941>>>            If (bIsSqlTable = False) Begin
45943>>>                Set_Attribute DF_FIELD_TYPE          of hTable iColumn to iTypeFrom
45946>>>            End
45946>>>>
45946>>>            Else Begin
45947>>>                Set_Attribute DF_FIELD_TYPE          of hTable iColumn to iTypeFrom
45950>>>                Set_Attribute DF_FIELD_NATIVE_TYPE   of hTable iColumn to iTypeFrom
45953>>>            End
45953>>>>
45953>>>            Set_Attribute DF_FIELD_LENGTH            of hTable iColumn to iLengthFrom
45956>>>            Set_Attribute DF_FIELD_PRECISION         of hTable iColumn to iPrecFrom
45959>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
45960>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
45962>>>
45962>>>        Set Action_Text of ghoStatusPanel to ""
45963>>>        Function_Return (Err = False)
45964>>>    End_Function
45965>>>
45965>>>    // Changes a field type, length and precision for the passed table number and field name
45965>>>    Function ApiColumnChangeByColumnNumber String sDriverIDFrom Handle hTable Boolean bIsSQLTableFrom Boolean bIsSQLTableTo String sFieldNameFrom Integer iColumn Integer iTypeFrom Integer iLengthFrom Integer iPrec Integer iOpt Returns Boolean
45967>>>        Integer iPrecFrom iTypeTo iLengthTo iPrecTo iDbType iOptionFrom iOptionTo iDataFlexType iIndex
45967>>>        Boolean bOK bCompareDate_DateTime bSkip bRecnumTable bIsSameDataType
45967>>>        String sFieldNameTo sDriverIDTo
45967>>>        tColumnType ColumnType
45967>>>        tColumnType ColumnType
45967>>>        
45967>>>        Get pbCompareDate_DateTime to bCompareDate_DateTime
45968>>>        Get piDbType to iDbType
45969>>>        If (num_arguments > 4) Begin
45971>>>            Move iPrec to iPrecFrom
45972>>>            Move iOpt  to iOptionFrom
45973>>>        End
45973>>>>
45973>>>        If (iTypeFrom < -1490) Begin
45975>>>            Move (iTypeFrom + 1500) to iTypeFrom
45976>>>        End
45976>>>>
45976>>>
45976>>>        Get AutoConnectionIDLogin to bOK
45977>>>        Move False to Err   
45978>>>        Close hTable
45979>>>        Get OpenTableExclusive hTable to bOK
45980>>>        If (bOK = False) Begin
45982>>>            Function_Return False
45983>>>        End 
45983>>>>
45983>>>
45983>>>        Get_Attribute DF_FILE_DRIVER                of hTable         to sDriverIDTo
45986>>>        Get_Attribute DF_FILE_RECNUM_TABLE          of hTable         to bRecnumTable
45989>>>        Get UtilSQLColumnTypeToDataFlexType sDriverIDTo iDbType iTypeTo iLengthTo to iDataFlexType
45990>>>        Get_Attribute DF_FIELD_NAME                 of hTable iColumn to sFieldNameTo 
45993>>>
45993>>>        If (bIsSQLTableTo = True) Begin
45995>>>            Get_Attribute DF_FIELD_NATIVE_TYPE      of hTable iColumn to iTypeTo
45998>>>        End
45998>>>>
45998>>>        Else Begin
45999>>>            Get_Attribute DF_FIELD_TYPE             of hTable iColumn to iTypeTo
46002>>>        End
46002>>>>
46002>>>
46002>>>        Get_Attribute DF_FIELD_LENGTH               of hTable iColumn to iLengthTo
46005>>>        Get_Attribute DF_FIELD_PRECISION            of hTable iColumn to iPrecTo
46008>>>            Get_Attribute DF_FIELD_IS_IDENTITY      of hTable iColumn to iOptionTo 
46011>>>        // If one of the two tables are SQL and the other Embedded we need to "translate"
46011>>>        // data types between Embedded and SQL, else we can't compare the data types.
46011>>>        If (bIsSQLTableFrom = True and bIsSQLTableTo = False) Begin
46013>>>            Get UtilSQLColumnTypeToDataFlexType sDriverIDFrom iDbType iTypeFrom iLengthFrom to iTypeFrom
46014>>>        End
46014>>>>
46014>>>        Else If (bIsSQLTableFrom = False and bIsSQLTableTo = True) Begin
46017>>>            Get UtilSQLColumnTypeToDataFlexType sDriverIDTo   iDbType iTypeTo   iLengthTo   to iTypeTo
46018>>>        End
46018>>>>
46018>>>        Move (iTypeFrom = iTypeTo) to bIsSameDataType
46019>>>
46019>>>        If (bCompareDate_DateTime = False) Begin
46021>>>            Move ((iTypeFrom = SQL_TYPE_DATE or iTypeFrom = SQL_TYPE_TIME or iTypeFrom = SQL_TYPE_TIMESTAMP) and (iTypeTo = SQL_TYPE_DATE or iTypeTo = SQL_TYPE_TIME or iTypeTo = SQL_TYPE_TIMESTAMP)) to bSkip
46022>>>            If (bSkip = True) Begin
46024>>>                If (sFieldNameFrom = sFieldNameTo and iLengthFrom = iLengthTo and iPrecFrom = iPrecTo and iOptionFrom = iOptionTo) Begin
46026>>>                    Function_Return True
46027>>>                End
46027>>>>
46027>>>            End
46027>>>>
46027>>>        End
46027>>>>
46027>>>        Else If (sFieldNameFrom = sFieldNameTo and iTypeFrom = iTypeTo and iLengthFrom = iLengthTo and iPrecFrom = iPrecTo and iOptionFrom = iOptionTo) Begin
46030>>>            Function_Return True
46031>>>        End
46031>>>>
46031>>>
46031>>>        Set Private.phCurrentTable to hTable
46032>>>        Set Private.piCurrentField to iColumn
46033>>>       
46033>>>        Structure_Start hTable                                               
46034>>>            If (sFieldNameFrom <> sFieldNameTo) Begin
46036>>>                Set_Attribute DF_FIELD_NAME             of hTable iColumn to sFieldNameFrom
46039>>>            End
46039>>>>
46039>>>            
46039>>>            If (bIsSameDataType = False) Begin
46041>>>                Set_Attribute DF_FIELD_TYPE             of hTable iColumn to iDataFlexType
46044>>>                If (bIsSQLTableTo = True) Begin
46046>>>                    Set_Attribute DF_FIELD_NATIVE_TYPE  of hTable iColumn to iTypeFrom
46049>>>                End
46049>>>>
46049>>>            End                                         
46049>>>>
46049>>>            
46049>>>            If (iLengthFrom <> iLengthTo) Begin
46051>>>                Set_Attribute DF_FIELD_LENGTH           of hTable iColumn to iLengthFrom
46054>>>            End
46054>>>>
46054>>>            If (iPrecFrom <> iPrecTo) Begin
46056>>>                Set_Attribute DF_FIELD_PRECISION        of hTable iColumn to iPrecFrom
46059>>>            End
46059>>>>
46059>>>
46059>>>            If (bIsSQLTableTo = True and iOptionFrom =  C_tAPIColumn_Identity and iOptionTo <> C_tAPIColumn_Identity) Begin
46061>>>                // Can't set a recnum table to "DF_FIELD_IS_IDENTITY"
46061>>>                If (bRecnumTable = True) Begin
46063>>>                    Set_Attribute DF_FILE_RECNUM_TABLE  of hTable to False
46066>>>                End
46066>>>>
46066>>>
46066>>>                // We might need to create an index here.
46066>>>                // To be able to set the DF_FIELD_IS_IDENTITY the index must already exist, but it might not at this stage.
46066>>>                // This should probably fix that problem and if an adjustment is needed, it will get done with the normal
46066>>>                // index update checking logic.
46066>>>                Get_Attribute DF_FIELD_INDEX               of hTable iColumn to iIndex
46069>>>                If (iIndex = 0 and Uppercase(sFieldNameTo) <> "RECNUM") Begin
46071>>>                    Create_Index hTable At iIndex
46072>>>                    Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex   to 1
46075>>>                End
46075>>>>
46075>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD       of hTable iIndex 1 to iColumn
46078>>>                Set_Attribute DF_FILE_PRIMARY_INDEX        of hTable          to iIndex
46081>>>                    Set_Attribute DF_FIELD_IS_IDENTITY     of hTable iColumn  to True
46084>>>                If (bIsSQLTableTo = True) Begin
46086>>>                    Set_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable iIndex   to True
46089>>>                End
46089>>>>
46089>>>            End
46089>>>>
46089>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46090>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46092>>>
46092>>>        Set Action_Text of ghoStatusPanel to ""
46093>>>        Function_Return (Err = False)
46094>>>    End_Function
46095>>>
46095>>>    Function ApiColumnChangeMainIndex Handle hTable Integer iIndex Integer iColumn Returns Boolean
46097>>>        Boolean bOK
46097>>>
46097>>>        Get AutoConnectionIDLogin to bOK
46098>>>        Move False to Err
46099>>>        Get OpenTableExclusive hTable to bOK
46100>>>        If (bOK = False) Begin
46102>>>            Function_Return False
46103>>>        End
46103>>>>
46103>>>
46103>>>        Structure_Start hTable
46104>>>            Set_Attribute DF_FIELD_INDEX of hTable iColumn to iIndex
46107>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46108>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46110>>>
46110>>>        Set Action_Text of ghoStatusPanel to ""
46111>>>        Function_Return (Err = False)
46112>>>    End_Function
46113>>>
46113>>>    // To move an existing field to another position in a table.
46113>>>    Function ApiColumnMove Handle hTable Integer iOld Integer iNew Boolean bIsSQLType Returns Boolean
46115>>>        String sColumn sDriverID
46115>>>        Integer iType iSQLType iLength iPrecision iDbType
46115>>>        Boolean bOK bIsDate
46115>>>        
46115>>>        Close hTable
46116>>>        Get AutoConnectionIDLogin to bOK
46117>>>        Get OpenTableExclusive hTable to bOK
46118>>>        If (bOK = False) Begin
46120>>>            Function_Return False
46121>>>        End
46121>>>>
46121>>>        
46121>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
46124>>>        If (sDriverID = DFBTRDRV_ID) Begin
46126>>>            Error DFERR_PROGRAM "Function 'ColumnMove' is not supported for the Pervasive database."
46127>>>>
46127>>>            Function_Return False
46128>>>        End
46128>>>>
46128>>>        
46128>>>        Get_Attribute DF_FIELD_NAME of hTable iOld to sColumn
46131>>>        Get_Attribute DF_FIELD_TYPE of hTable iOld to iType
46134>>>
46134>>>        Set Private.phCurrentTable to hTable
46135>>>        Set Private.piCurrentField to iOld
46136>>>
46136>>>        Get UtilColumnIsDateType iType bIsSQLType to bIsDate
46137>>>        If (bIsDate = False) Begin
46139>>>            Get_Attribute DF_FIELD_LENGTH    of hTable iOld to iLength
46142>>>            Get_Attribute DF_FIELD_PRECISION of hTable iOld to iPrecision
46145>>>        End  
46145>>>>
46145>>>        Else Begin
46146>>>            Move 6 to iLength 
46147>>>            Move 0 to iPrecision
46148>>>        End
46148>>>>
46148>>>
46148>>>        Move False to Err
46149>>>
46149>>>        Structure_Start hTable
46150>>>            Delete_Field hTable iOld
46151>>>            Create_Field hTable At iNew
46152>>>            Set_Attribute DF_FIELD_NAME of hTable iNew to sColumn 
46155>>>            
46155>>>            If (bIsSQLType = False) Begin
46157>>>                Set_Attribute DF_FIELD_TYPE        of hTable iNew to iType
46160>>>            End 
46160>>>>
46160>>>            Else Begin
46161>>>                Set_Attribute DF_FIELD_TYPE        of hTable iNew to iType
46164>>>//                Set_Attribute DF_FIELD_NATIVE_TYPE of hTable iNew to iSQLType  
46164>>>            End
46164>>>>
46164>>>            
46164>>>            If (bIsDate = False) Begin
46166>>>                Set_Attribute DF_FIELD_LENGTH    of hTable iNew to iLength
46169>>>                Set_Attribute DF_FIELD_PRECISION of hTable iNew to iPrecision
46172>>>            End
46172>>>>
46172>>>
46172>>>            Set_Attribute DF_FIELD_OLD_NUMBER of hTable iNew to iOld
46175>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46176>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46178>>>
46178>>>        Set Action_Text of ghoStatusPanel to ""
46179>>>        Function_Return (Err = False)
46180>>>    End_Function
46181>>>
46181>>>    // Deletes a column name for the passed table number (and column number).
46181>>>    Function ApiColumnRemove Handle hTable String sFieldName Returns Boolean
46183>>>        Integer iColumn
46183>>>        Boolean bOK
46183>>>
46183>>>        Get AutoConnectionIDLogin to bOK
46184>>>        Move False to Err
46185>>>        Close hTable
46186>>>        Get OpenTableExclusive hTable to bOK
46187>>>        If (bOK = False) Begin
46189>>>            Function_Return False
46190>>>        End
46190>>>>
46190>>>
46190>>>        If (not(Err)) Begin 
46192>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46193>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46194>>>            Field_Map hTable sFieldName to iColumn
46196>>>            Set Error_Report_Mode to DUF_ERROR_REPORT
46197>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46198>>>            If (Err = True) Begin
46200>>>                Function_Return False
46201>>>            End
46201>>>>
46201>>>            Move False to Err
46202>>>
46202>>>            Set Private.phCurrentTable to hTable
46203>>>            Set Private.piCurrentField to iColumn
46204>>>        
46204>>>            Structure_Start hTable
46205>>>                Delete_Field hTable iColumn
46206>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
46207>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46209>>>            Set Action_Text of ghoStatusPanel to ""
46210>>>        End
46210>>>>
46210>>>        Else Begin
46211>>>            Error DFERR_PROGRAM ("The table number:" * String(hTable) * "could not be opened exclusiv. This indicates the table is in use!")
46212>>>>
46212>>>        End
46212>>>>
46212>>>
46212>>>        Function_Return (Err = False)
46213>>>    End_Function
46214>>>
46214>>>    // Renames a field for the passed table number & old field name & new field name
46214>>>    // Returns True if no errors occured.
46214>>>    // Sample usage:
46214>>>    //   Get ColumnRename Quote.File_Number "ID#" "ID" to bOK
46214>>>    Function ApiColumnRename Integer hTable String sOldFieldName String sNewFieldName Returns Boolean
46216>>>        Integer iField
46216>>>        Boolean bOK bExists bIsOpen
46216>>>
46216>>>        Get UtilColumnExists hTable sNewFieldName to bExists
46217>>>        If (bExists = True) Begin
46219>>>            Function_Return False
46220>>>        End
46220>>>>
46220>>>        
46220>>>        // Note: The Field_Map command does _not_ work if the table has been
46220>>>        //       opened exclusively, so we first open it in normal mode.
46220>>>        Close hTable
46221>>>        Open hTable                
46223>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
46226>>>        If (bIsOpen = False) Begin
46228>>>            Function_Return False
46229>>>        End
46229>>>>
46229>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46230>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46231>>>        Field_Map hTable sOldFieldName to iField   
46233>>>        Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46234>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46235>>>        
46235>>>        Get AutoConnectionIDLogin to bOK
46236>>>        Get OpenTableExclusive hTable to bOK
46237>>>        If (bOK = False) Begin
46239>>>            Function_Return False
46240>>>        End
46240>>>>
46240>>>
46240>>>        Move False to Err
46241>>>        Send Ignore_Error of Error_Object_Id DFERR_DUPLICATE_FIELDNAME
46242>>>        Set Private.phCurrentTable to hTable
46243>>>        Set Private.piCurrentField to iField
46244>>>
46244>>>        If (iField > 0) Begin
46246>>>            Structure_Start hTable
46247>>>                Set_Attribute DF_FIELD_NAME of hTable iField to sNewFieldName
46250>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
46251>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46253>>>        End
46253>>>>
46253>>>        Else Begin
46254>>>            Move 0 to LastErr
46255>>>            Move False to Err
46256>>>        End
46256>>>>
46256>>>
46256>>>        Set Action_Text of ghoStatusPanel to ""
46257>>>        Send Trap_Error of Error_Object_Id DFERR_DUPLICATE_FIELDNAME
46258>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46259>>>
46259>>>        Function_Return (Err = False)
46260>>>    End_Function  
46261>>>    
46261>>>    Function UtilColumnsCheckForInserts Handle hTable tAPIColumnCompare[] aAPIColumnCompare Returns tAPIColumnCompare[] 
46263>>>        tAPIColumnCompare[] aAPIColumnsToInsert
46263>>>        tAPIColumnCompare[] aAPIColumnsToInsert
46264>>>        Integer iSize iCount iItem iFieldTo iNumberOfFieldsTo
46264>>>        Boolean bRenameField bExists
46264>>>        
46264>>>        Open hTable
46266>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46267>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46268>>>        Move (SizeOfArray(aAPIColumnCompare)) to iSize       
46269>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumberOfFieldsTo  
46272>>>        Move (iSize min iNumberOfFieldsTo) to iSize
46273>>>        Decrement iSize
46274>>>        for iCount from 0 to iSize    
46280>>>>
46280>>>            If (Uppercase(aAPIColumnCompare[iCount].sFieldNameFrom) <> Uppercase(aAPIColumnCompare[iCount].sFieldNameTo)) Begin
46282>>>                Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46283>>>                Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46284>>>
46284>>>                Field_Map hTable aAPIColumnCompare[iCount].sFieldNameFrom to iFieldTo
46286>>>                If (iFieldTo = 0) Begin 
46288>>>                    Get UtilColumnShouldBeRenamed aAPIColumnCompare[iCount] to bRenameField
46289>>>                    Get UtilColumnExistsWithOtherNumber aAPIColumnCompare iCount to bExists
46290>>>                    If (bRenameField = False and bExists = False) Begin
46292>>>                        Move aAPIColumnCompare[iCount].iFieldNumber     to aAPIColumnsToInsert[iItem].iFieldNumber 
46293>>>                        Move aAPIColumnCompare[iCount].sFieldNameFrom   to aAPIColumnsToInsert[iItem].sFieldNameFrom
46294>>>                        Move aAPIColumnCompare[iCount].iTypeFrom        to aAPIColumnsToInsert[iItem].iTypeFrom 
46295>>>                        Move aAPIColumnCompare[iCount].sTypeFrom        to aAPIColumnsToInsert[iItem].sTypeFrom
46296>>>                        Move aAPIColumnCompare[iCount].iLengthFrom      to aAPIColumnsToInsert[iItem].iLengthFrom
46297>>>                        Move aAPIColumnCompare[iCount].iPrecisionFrom   to aAPIColumnsToInsert[iItem].iPrecisionFrom
46298>>>                        Move aAPIColumnCompare[iCount].bIsSQLTypeFrom   to aAPIColumnsToInsert[iItem].bIsSQLTypeFrom
46299>>>                        Move aAPIColumnCompare[iCount].bIsSQLTypeTo     to aAPIColumnsToInsert[iItem].bIsSQLTypeTo
46300>>>                        Move True                                       to aAPIColumnsToInsert[iItem].bExistsFrom
46301>>>                        Move False                                      to aAPIColumnsToInsert[iItem].bExistsTo
46302>>>                        Increment iItem
46303>>>                    End
46303>>>>
46303>>>                End
46303>>>>
46303>>>            End
46303>>>>
46303>>>        Loop
46304>>>>
46304>>>        
46304>>>        Move False to Err
46305>>>        Move 0 to LastErr
46306>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46307>>>        Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46308>>>        Function_Return aAPIColumnsToInsert
46309>>>    End_Function   
46310>>>    
46310>>>    Function UtilColumnsInsert Handle hTable tAPIColumnCompare[] aAPIColumnsToInsert Returns Boolean
46312>>>        Integer iSize iCount
46312>>>        Boolean bOK                             
46312>>>        tAPIColumn[] aColumnsTo 
46312>>>        tAPIColumn[] aColumnsTo 
46313>>>        tAPIColumnCompare[] aAPIColumnCompare
46313>>>        tAPIColumnCompare[] aAPIColumnCompare
46314>>>
46314>>>        Move (SizeOfArray(aAPIColumnsToInsert)) to iSize
46315>>>        If (iSize = 0) Begin
46317>>>            Function_Return True
46318>>>        End                     
46318>>>>
46318>>>        
46318>>>        Move False to Err
46319>>>        Decrement iSize
46320>>>        for iCount from 0 to iSize
46326>>>>
46326>>>            Get ApiColumnInsert hTable aAPIColumnsToInsert[iCount].iFieldNumber aAPIColumnsToInsert[iCount].sFieldNameFrom aAPIColumnsToInsert[iCount].iTypeFrom aAPIColumnsToInsert[iCount].iLengthFrom aAPIColumnsToInsert[iCount].iPrecisionFrom aAPIColumnsToInsert[iCount].bIsSQLTypeFrom to bOK
46327>>>        Loop
46328>>>>
46328>>>        
46328>>>        Function_Return bOK
46329>>>    End_Function
46330>>>    
46330>>>    // Returns a struct array with fields that has the same names but different field numbers.
46330>>>    Function UtilColumnsCheckForMoves Handle hTable tAPIColumnCompare[] aAPIColumnCompare Returns tAPIColumnCompare[] 
46332>>>        tAPIColumnCompare[] aAPIColumnsToMove
46332>>>        tAPIColumnCompare[] aAPIColumnsToMove
46333>>>        Integer iSize iCount iItem iFieldTo
46333>>>        
46333>>>        Open hTable
46335>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46336>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46337>>>
46337>>>        Move (SizeOfArray(aAPIColumnCompare)) to iSize       
46338>>>        Decrement iSize
46339>>>        for iCount from 0 to iSize    
46345>>>>
46345>>>            If (Uppercase(aAPIColumnCompare[iCount].sFieldNameFrom) <> Uppercase(aAPIColumnCompare[iCount].sFieldNameTo)) Begin
46347>>>                Field_Map hTable aAPIColumnCompare[iCount].sFieldNameFrom to iFieldTo
46349>>>                If (iFieldTo > 0) Begin
46351>>>                    Move aAPIColumnCompare[iCount].iFieldNumber to aAPIColumnsToMove[iItem].iFieldNumber 
46352>>>                    Move iFieldTo                               to aAPIColumnsToMove[iItem].iFieldNumberTo 
46353>>>                    Increment iItem
46354>>>                End
46354>>>>
46354>>>            End
46354>>>>
46354>>>        Loop
46355>>>>
46355>>>        
46355>>>        Move False to Err
46356>>>        Move 0 to LastErr
46357>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46358>>>        Send Trap_Error of Error_Object_Id DFERR_CANT_FIND_FIELD
46359>>>        Function_Return aAPIColumnsToMove
46360>>>    End_Function   
46361>>>    
46361>>>    Function UtilColumnsMove Handle hTable tAPIColumnCompare[] aAPIColumnsToMove Returns Boolean
46363>>>        Integer iSize iCount
46363>>>        Boolean bOK                             
46363>>>        tAPIColumn[] aColumnsTo 
46363>>>        tAPIColumn[] aColumnsTo 
46364>>>        tAPIColumnCompare[] aAPIColumnCompare
46364>>>        tAPIColumnCompare[] aAPIColumnCompare
46365>>>
46365>>>        Move (SizeOfArray(aAPIColumnsToMove)) to iSize
46366>>>        If (iSize = 0) Begin
46368>>>            Function_Return True
46369>>>        End                     
46369>>>>
46369>>>        
46369>>>        Move False to Err
46370>>>        Decrement iSize
46371>>>        for iCount from 0 to iSize
46377>>>>
46377>>>            Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46378>>>            If (aAPIColumnsToMove[iCount].bExistsFrom = True and aAPIColumnsToMove[iCount].bExistsTo = True) Begin
46380>>>                Get ApiColumnMove hTable aAPIColumnsToMove[iCount].iFieldNumberTo aAPIColumnsToMove[iCount].iFieldNumber aAPIColumnsToMove[iCount].bIsSQLTypeFrom to bOK
46381>>>            End
46381>>>>
46381>>>        Loop
46382>>>>
46382>>>        
46382>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46383>>>        Function_Return bOK
46384>>>    End_Function
46385>>>
46385>>>    // Checks if the "FROM" and "TO" database field is the same _except_ for the field name.
46385>>>    // We then assume this field should be renamed.
46385>>>//    Function UtilColumCheckRename Handle hTable tAPIColumnCompare aAPIColumnCompare Returns Boolean
46385>>>//        Boolean bDifferentFieldNames bShouldBeRenamed        
46385>>>//        
46385>>>//        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46385>>>//        Move (Uppercase(aAPIColumnCompare.sFieldNameFrom) <> Uppercase(aAPIColumnCompare.sFieldNameTo)) to bDifferentFieldNames
46385>>>//        
46385>>>//        If (bDifferentFieldNames = True) Begin
46385>>>//            Move (aAPIColumnCompare.iFieldNumber = aAPIColumnCompare.iFieldNumberTo) to bShouldBeRenamed
46385>>>//            If (bShouldBeRenamed = False) Begin
46385>>>//                Set Error_Report_Mode to DUF_ERROR_REPORT
46385>>>//                Function_Return False
46385>>>//            End
46385>>>//        
46385>>>//            Move (aAPIColumnCompare.iTypeFrom = aAPIColumnCompare.iTypeTo) to bShouldBeRenamed
46385>>>//            If (bShouldBeRenamed = False) Begin
46385>>>//                Set Error_Report_Mode to DUF_ERROR_REPORT
46385>>>//                Function_Return False
46385>>>//            End
46385>>>//        
46385>>>//            Move (aAPIColumnCompare.iLengthFrom = aAPIColumnCompare.iLengthTo) to bShouldBeRenamed
46385>>>//            If (bShouldBeRenamed = False) Begin
46385>>>//                Set Error_Report_Mode to DUF_ERROR_REPORT
46385>>>//                Function_Return False
46385>>>//            End
46385>>>//        
46385>>>//            Move (aAPIColumnCompare.iPrecisionFrom = aAPIColumnCompare.iPrecisionTo) to bShouldBeRenamed
46385>>>//            If (bShouldBeRenamed = False) Begin
46385>>>//                Set Error_Report_Mode to DUF_ERROR_REPORT
46385>>>//                Function_Return False
46385>>>//            End
46385>>>//        End
46385>>>//    
46385>>>//        Set Error_Report_Mode to DUF_ERROR_REPORT
46385>>>//        Function_Return True
46385>>>//    End_Function                   
46385>>>    
46385>>>    // Takes a tAPIColumnCompare struct as parameter and returns True if;
46385>>>    // - Field Numbers, Data Types, Lengths and Precisions are all equal.
46385>>>    // - The "FROM" field name is <> "TO" field name
46385>>>    // - The "FROM" field name also exists in the "TO" table; or the "TO" is part
46385>>>    //   of the "FROM" field name. E.g. "FROM" = LATEST_REPL_COST_DATE, "TO" = Latest_Repl_Cos would results in a TRUE.
46385>>>    Function UtilColumnShouldBeRenamed tAPIColumnCompare aAPIColumnCompare Returns Boolean
46387>>>        Boolean bExists bShouldRename
46387>>>        String sFieldNameFrom sFieldNameTo
46387>>>        
46387>>>        Move (Uppercase(aAPIColumnCompare.sFieldNameFrom)) to sFieldNameFrom
46388>>>        Move (Uppercase(aAPIColumnCompare.sFieldNameTo))   to sFieldNameTo  
46389>>>        If (sFieldNameFrom = sFieldNameTo) Begin
46391>>>            Function_Return False
46392>>>        End
46392>>>>
46392>>>        
46392>>>        Move (aAPIColumnCompare.bExistsFrom    = aAPIColumnCompare.bExistsTo      and ;              aAPIColumnCompare.iFieldNumber   = aAPIColumnCompare.iFieldNumberTo and ;              aAPIColumnCompare.iTypeFrom      = aAPIColumnCompare.iTypeTo        and ;              aAPIColumnCompare.iLengthFrom    = aAPIColumnCompare.iLengthTo      and ;              aAPIColumnCompare.iPrecisionFrom = aAPIColumnCompare.iPrecisionTo   and ;              aAPIColumnCompare.iOptionsFrom   = aAPIColumnCompare.iOptionsTo) to bShouldRename
46393>>>        If (bShouldRename = False) Begin
46395>>>            Function_Return False
46396>>>        End                      
46396>>>>
46396>>>        
46396>>>        If (sFieldNameFrom contains sFieldNameTo) Begin
46398>>>            Function_Return True
46399>>>        End
46399>>>>
46399>>>        
46399>>>        Function_Return bShouldRename
46400>>>    End_Function
46401>>>    
46401>>>    Function UtilColumnExistsWithOtherNumber tAPIColumnCompare[] aAPIColumnCompare Integer iColumn Returns Boolean
46403>>>        Boolean bExists
46403>>>        Integer iCount iSize
46403>>>        String sFieldNameFrom
46403>>>        
46403>>>        Move (Uppercase(aAPIColumnCompare[iColumn].sFieldNameFrom)) to sFieldNameFrom
46404>>>        
46404>>>        Move (SizeOfArray(aAPIColumnCompare)) to iSize
46405>>>        Decrement iSize
46406>>>        for iCount from 0 to iSize
46412>>>>
46412>>>            // We're only interested in fields other than the passed field/column number:
46412>>>            If ((iCount +1) <> iColumn) Begin
46414>>>                If (Uppercase(aAPIColumnCompare[iCount].sFieldNameTo) = sFieldNameFrom) Begin
46416>>>                    Move True to bExists 
46417>>>                End  
46417>>>>
46417>>>                Else If (sFieldNameFrom contains Uppercase(aAPIColumnCompare[iCount].sFieldNameTo)) Begin
46420>>>                    Move True to bExists 
46421>>>                End
46421>>>>
46421>>>            End
46421>>>>
46421>>>        Loop
46422>>>>
46422>>>        
46422>>>        Function_Return bExists 
46423>>>    End_Function
46424>>>    
46424>>>    Function UtilColumnsCheckForRenames Handle hTable tAPIColumnCompare[] aAPIColumnCompare Returns tAPIColumnCompare[] 
46426>>>        tAPIColumnCompare[] aAPIColumnsToRename
46426>>>        tAPIColumnCompare[] aAPIColumnsToRename
46427>>>        Integer iSize iCount iItem iFieldTo iNumberOfFieldsTo
46427>>>        Boolean bRenameField
46427>>>        
46427>>>        Open hTable
46429>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumberOfFieldsTo
46432>>>        Move 0 to iItem
46433>>>        Move (SizeOfArray(aAPIColumnCompare)) to iSize                    
46434>>>        Move (iSize min iNumberOfFieldsTo)    to iSize
46435>>>        Decrement iSize
46436>>>        for iCount from 0 to iSize    
46442>>>>
46442>>>            If (Uppercase(aAPIColumnCompare[iCount].sFieldNameFrom) <> Uppercase(aAPIColumnCompare[iCount].sFieldNameTo)) Begin
46444>>>                Get UtilColumnShouldBeRenamed aAPIColumnCompare[iCount] to bRenameField
46445>>>                If (bRenameField = True) Begin
46447>>>                    Move aAPIColumnCompare[iCount].iFieldNumber     to aAPIColumnsToRename[iItem].iFieldNumber 
46448>>>                    Move iFieldTo                                   to aAPIColumnsToRename[iItem].iFieldNumberTo 
46449>>>                    Move aAPIColumnCompare[iCount].sFieldNameFrom   to aAPIColumnsToRename[iItem].sFieldNameFrom
46450>>>                    Move aAPIColumnCompare[iCount].sFieldNameTo     to aAPIColumnsToRename[iItem].sFieldNameTo
46451>>>                    Increment iItem
46452>>>                End
46452>>>>
46452>>>            End
46452>>>>
46452>>>        Loop
46453>>>>
46453>>>        
46453>>>        Move False to Err
46454>>>        Move 0 to LastErr
46455>>>        Function_Return aAPIColumnsToRename
46456>>>    End_Function   
46457>>>    
46457>>>    Function UtilColumnsRename Handle hTable tAPIColumnCompare[] aAPIColumnsToRename Returns Boolean
46459>>>        Integer iSize iCount
46459>>>        Boolean bOK                             
46459>>>        tAPIColumn[] aColumnsTo 
46459>>>        tAPIColumn[] aColumnsTo 
46460>>>        tAPIColumnCompare[] aAPIColumnCompare
46460>>>        tAPIColumnCompare[] aAPIColumnCompare
46461>>>
46461>>>        Move (SizeOfArray(aAPIColumnsToRename)) to iSize
46462>>>        If (iSize = 0) Begin
46464>>>            Function_Return True
46465>>>        End                     
46465>>>>
46465>>>        
46465>>>        Move False to Err
46466>>>        Decrement iSize
46467>>>        For iCount from 0 to iSize
46473>>>>
46473>>>            Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46474>>>            Get ApiColumnRename hTable aAPIColumnsToRename[iCount].sFieldNameTo aAPIColumnsToRename[iCount].sFieldNameFrom to bOK 
46475>>>        Loop
46476>>>>
46476>>>        
46476>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46477>>>        Function_Return bOK
46478>>>    End_Function
46479>>>
46479>>>    Function UtilColumnIsDateType Integer iType Boolean bIsSQLTableTo Returns Boolean
46481>>>        Boolean bDateType
46481>>>        
46481>>>        If (bIsSQLTableTo = True) Begin
46483>>>            Move (iType = SQL_TYPE_DATE or iType = SQL_TYPE_TIMESTAMP or iType = SQL_TYPE_TIMESTAMP2) to bDateType
46484>>>        End 
46484>>>>
46484>>>        Else Begin
46485>>>            Move (iType = DF_DATE or iType = DF_DATETIME) to bDateType
46486>>>        End
46486>>>>
46486>>>    
46486>>>        Function_Return bDateType
46487>>>    End_Function
46488>>>    
46488>>>    Function ApiColumnsUpdate String sDriverIDFrom Handle hTable Boolean bIsSQLTableFrom tAPIColumn[] aColumnsFrom tAPIColumn[] aColumnsTo Boolean bCompareDate_DateTime Returns Boolean
46490>>>        Integer iCount iSize iColumn iTypeFrom iTypeTo iDataFlexType iIndex iLengthFrom iLengthTo iPrecisionFrom iPrecisionTo iOptionFrom iOptionTo iDbType
46490>>>        Handle hFile
46490>>>        Boolean bFieldExistsFrom bFieldExistsTo bShouldMove bIsSQLDriver bIsSame bOK bSkip
46490>>>        Boolean bRecnum bIsSQLTableTo bOpened bRecnumTable bIsOpen bSkipTypeChange bIsDateType
46490>>>        String sFieldNameFrom sFieldNameTo sDriverIDTo sDefaultValue
46490>>>        tAPIColumnCompare[] aAPIColumnCompare aApiInsertColumns aAPIMoveColumns aAPIRenameColumns
46490>>>        tAPIColumnCompare[] aAPIColumnCompare aApiInsertColumns aAPIMoveColumns aAPIRenameColumns
46494>>>        tColumnType ColumnType
46494>>>        tColumnType ColumnType
46494>>>
46494>>>        Move False to Err
46495>>>        Close hTable
46496>>>        Get OpenTableExclusive hTable to bIsOpen
46497>>>        If (bIsOpen = False) Begin
46499>>>            Error DFERR_PROGRAM ("Function 'ApiColumnsUpdate'. Can't open table number:" * String(hTable))
46500>>>>
46500>>>            Function_Return False
46501>>>        End
46501>>>>
46501>>>
46501>>>        Get piDbType to iDbType
46502>>>        Get_Attribute DF_FILE_RECNUM_TABLE of hTable to bRecnumTable
46505>>>        Get IsSQLDriver sDriverIDFrom to bIsSQLDriver
46506>>>        Get UtilTableIsSQL hTable     to bIsSQLTableTo
46507>>>        If (bIsSQLTableTo = False) Begin
46509>>>            Move DATAFLEX_ID to sDriverIDTo
46510>>>        End
46510>>>>
46510>>>        Else Begin          
46511>>>            Get_Attribute DF_FILE_DRIVER of hTable to sDriverIDTo
46514>>>        End
46514>>>>
46514>>>        
46514>>>        Get UtilColumnCombineFromAndToArrays aColumnsFrom aColumnsTo to aAPIColumnCompare
46515>>>        
46515>>>        // Before we start to change the table we need to do three things;
46515>>>        // 1) Insert any new fields
46515>>>        Get UtilColumnsCheckForInserts hTable aAPIColumnCompare to aApiInsertColumns
46516>>>        If (SizeOfArray(aApiInsertColumns)) Begin
46518>>>            Get UtilColumnsInsert hTable aApiInsertColumns to bOK
46519>>>            If (bOK = False) Begin
46521>>>                Function_Return False
46522>>>            End                  
46522>>>>
46522>>>            // Update info with changes made.
46522>>>            Get UtilColumnsStructFill hTable to aColumnsTo
46523>>>            Get UtilColumnCombineFromAndToArrays aColumnsFrom aColumnsTo to aAPIColumnCompare
46524>>>        End
46524>>>>
46524>>>        
46524>>>        // 2) Rename fields
46524>>>        Get UtilColumnsCheckForRenames hTable aAPIColumnCompare to aAPIRenameColumns
46525>>>        If (SizeOfArray(aAPIRenameColumns)) Begin
46527>>>            Get UtilColumnsRename hTable aAPIRenameColumns to bOK
46528>>>            If (bOK = False) Begin
46530>>>                Function_Return False
46531>>>            End
46531>>>>
46531>>>            Get UtilColumnsStructFill hTable to aColumnsTo
46532>>>            Get UtilColumnCombineFromAndToArrays aColumnsFrom aColumnsTo to aAPIColumnCompare
46533>>>        End
46533>>>>
46533>>>
46533>>>        // 3) Move fields with same names
46533>>>        Get UtilColumnsCheckForMoves hTable aAPIColumnCompare to aAPIMoveColumns
46534>>>        If (SizeOfArray(aAPIMoveColumns)) Begin
46536>>>            Get UtilColumnsMove hTable aAPIMoveColumns to bOK
46537>>>            If (bOK = False) Begin
46539>>>                Function_Return False
46540>>>            End
46540>>>>
46540>>>            Get UtilColumnsStructFill hTable to aColumnsTo
46541>>>            Get UtilColumnCombineFromAndToArrays aColumnsFrom aColumnsTo to aAPIColumnCompare
46542>>>        End
46542>>>>
46542>>>        
46542>>>        // If any of the fields were changed by "Insert", "Rename" or "Move", we need to compare the fields again: 
46542>>>        If (SizeOfArray(aApiInsertColumns) or SizeOfArray(aAPIRenameColumns) or SizeOfArray(aAPIMoveColumns)) Begin
46544>>>            Get UtilColumnsCompare sDriverIDFrom sDriverIDTo bIsSQLTableFrom bIsSQLTableTo aAPIColumnCompare bCompareDate_DateTime to bIsSame
46545>>>            If (bIsSame = True) Begin
46547>>>                Function_Return True
46548>>>            End
46548>>>>
46548>>>        End
46548>>>>
46548>>>        
46548>>>        // We can now continue to make standard field changes:
46548>>>        Get OpenTableExclusive hTable to bIsOpen
46549>>>        Set Private.phCurrentTable to hTable
46550>>>        Move hTable to hFile
46551>>>        Structure_Start hFile sDriverIDTo
46552>>>
46552>>>            Move (SizeOfArray(aAPIColumnCompare)) to iSize
46553>>>            Decrement iSize
46554>>>            For iCount from 0 to iSize
46560>>>>
46560>>>                Send DoAdvance of ghoProgressBar
46561>>>                                
46561>>>                Move aAPIColumnCompare[iCount].bExistsFrom          to bFieldExistsFrom
46562>>>                If (bFieldExistsFrom = True) Begin
46564>>>                    Move aAPIColumnCompare[iCount].bExistsTo        to bFieldExistsTo
46565>>>                    Move aAPIColumnCompare[iCount].sFieldNameFrom   to sFieldNameFrom
46566>>>                    Move aAPIColumnCompare[iCount].iFieldNumber     to iColumn              
46567>>>                    Set Private.piCurrentField                      to iColumn
46568>>>                    Move aAPIColumnCompare[iCount].iLengthFrom      to iLengthFrom                                   
46569>>>                    Move aAPIColumnCompare[iCount].iPrecisionFrom   to iPrecisionFrom
46570>>>                    Move aAPIColumnCompare[iCount].iOptionsFrom     to iOptionFrom
46571>>>                    
46571>>>                    Move aAPIColumnCompare[iCount].iTypeFrom        to iTypeFrom
46572>>>//                    Get UtilDFDataTypeToSqlTypeMapping sDriverIDFrom iDbType iTypeFrom to ColumnType
46572>>>//                    Move ColumnType.iDataFlexType                   to iDataFlexType
46572>>>                    Get UtilSQLColumnTypeToDataFlexType sDriverIDFrom iDbType iTypeFrom iLengthFrom to iDataFlexType
46573>>>                    If (iTypeFrom < -1490) Begin
46575>>>                        Move (iTypeFrom + 1500)                     to iTypeFrom
46576>>>                    End
46576>>>>
46576>>>    
46576>>>                    // If one of the two tables are SQL and the other Embedded we need to "translate"
46576>>>                    // data types between Embedded and SQL, else we can't compare the data types.
46576>>>                    If (bIsSQLTableFrom = True and bIsSQLTableTo = False) Begin
46578>>>                        Get UtilSQLColumnTypeToDataFlexType sDriverIDFrom iDbType iTypeFrom iLengthFrom to iTypeFrom
46579>>>                    End
46579>>>>
46579>>>                    Else If (bIsSQLTableFrom = False and bIsSQLTableTo = True) Begin
46582>>>                        Get UtilSqlColumnTypeToDataFlexType sDriverIDTo   iDbType iTypeTo   iLengthTo   to iTypeTo
46583>>>                    End
46583>>>>
46583>>>                    
46583>>>                    Move aAPIColumnCompare[iCount].sFieldNameTo to sFieldNameTo
46584>>>                    Move aAPIColumnCompare[iCount].iLengthTo    to iLengthTo
46585>>>                    Move aAPIColumnCompare[iCount].iPrecisionTo to iPrecisionTo
46586>>>                    Move aAPIColumnCompare[iCount].iOptionsTo   to iOptionTo
46587>>>                    Move aAPIColumnCompare[iCount].iTypeTo      to iTypeTo
46588>>>                    
46588>>>                    Move False to bSkipTypeChange
46589>>>                    If (bCompareDate_DateTime = False) Begin
46591>>>                        Move ((iTypeFrom = SQL_TYPE_DATE or iTypeFrom = SQL_TYPE_TIME or iTypeFrom = SQL_TYPE_TIMESTAMP) and (iTypeTo = SQL_TYPE_DATE or iTypeTo = SQL_TYPE_TIME or iTypeTo = SQL_TYPE_TIMESTAMP)) to bSkipTypeChange
46592>>>                    End
46592>>>>
46592>>>                    
46592>>>                    If (bFieldExistsTo = False) Begin 
46594>>>                        Move 0 to iColumn
46595>>>                        Create_Field hFile At iColumn
46596>>>                        Set Private.piCurrentField to iColumn
46597>>>                    End
46597>>>>
46597>>>                    
46597>>>                    If (sFieldNameFrom <> sFieldNameTo) Begin
46599>>>                        Set_Attribute DF_FIELD_NAME of hFile iColumn to sFieldNameFrom
46602>>>                    End                   
46602>>>>
46602>>>                    
46602>>>                    If (bIsSQLTableFrom = True and aAPIColumnCompare[iCount].iOptionsFrom <> C_tAPIColumn_Identity) Begin
46604>>>                        Set_Attribute DF_FIELD_NULL_ALLOWED  of hFile iColumn to aAPIColumnCompare[iCount].bAllowNULLFrom
46607>>>                        Move aAPIColumnCompare[iCount].sDefaultValueFrom to sDefaultValue
46608>>>                        If (iDataFlexType = DF_BCD and Left(sDefaultValue, 1 <> "[")) Begin
46610>>>                            Move ("[" + String(sDefaultValue) + "]") to sDefaultValue
46611>>>                        End
46611>>>>
46611>>>                        Set_Attribute DF_FIELD_DEFAULT_VALUE of hFile iColumn to sDefaultValue
46614>>>                    End
46614>>>>
46614>>>                    
46614>>>                    If (bSkipTypeChange = False) Begin
46616>>>                        If (iTypeFrom <> iTypeTo) Begin 
46618>>>                            If (bIsSQLTableTo = True) Begin
46620>>>                                Set_Attribute DF_FIELD_NATIVE_TYPE   of hFile iColumn to iTypeFrom
46623>>>                            End
46623>>>>
46623>>>                            Else Begin
46624>>>                                Set_Attribute DF_FIELD_TYPE          of hFile iColumn to iDataFlexType
46627>>>                            End
46627>>>>
46627>>>                        End
46627>>>>
46627>>>                    End
46627>>>>
46627>>>                    
46627>>>                    Get UtilColumnIsDateType iTypeFrom bIsSQLTableTo to bIsDateType   
46628>>>                    // We can't set the length or precision for Date type columns (they are fixed).
46628>>>                    If (bIsDateType = False) Begin
46630>>>                        If (iLengthFrom <> iLengthTo) Begin
46632>>>                            Set_Attribute DF_FIELD_LENGTH of hFile iColumn to iLengthFrom
46635>>>                        End
46635>>>>
46635>>>                        If (iPrecisionFrom <> iPrecisionTo) Begin
46637>>>                            Set_Attribute DF_FIELD_PRECISION of hFile iColumn to iPrecisionFrom
46640>>>                        End
46640>>>>
46640>>>                    End
46640>>>>
46640>>>    
46640>>>                    If (bIsSQLTableTo = True and iOptionFrom =  C_tAPIColumn_Identity and iOptionTo <> C_tAPIColumn_Identity) Begin
46642>>>                        // Can't set a recnum table to "DF_FIELD_IS_IDENTITY"
46642>>>                        If (bRecnumTable = True) Begin
46644>>>                            Set_Attribute DF_FILE_RECNUM_TABLE of hTable to False
46647>>>                        End
46647>>>>
46647>>>    
46647>>>                        // We might need to create an index here.
46647>>>                        // To be able to set the DF_FIELD_IS_IDENTITY the index must already exist, but it might not at this stage.
46647>>>                        // This should probably fix that problem and if an adjustment is needed, it will get done with the normal
46647>>>                        // index update checking logic.
46647>>>                        Get_Attribute DF_FIELD_INDEX           of hFile iColumn to iIndex
46650>>>                        If (iIndex = 0 and Uppercase(sFieldNameTo) <> "RECNUM") Begin
46652>>>                            Create_Index hFile at iIndex
46653>>>                            Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hFile iIndex to 1
46656>>>                        End
46656>>>>
46656>>>
46656>>>                        Set_Attribute DF_INDEX_SEGMENT_FIELD   of hFile iIndex 1 to iColumn
46659>>>                        Set_Attribute DF_FILE_PRIMARY_INDEX    of hFile          to iIndex
46662>>>                            // Note: The order of these two are crucial!
46662>>>                            Set_Attribute DF_INDEX_SQL_PRIMARY_KEY of hFile iIndex to True
46665>>>                            Set_Attribute DF_FIELD_IS_IDENTITY of hFile iColumn    to True
46668>>>                    End
46668>>>>
46668>>>                End
46668>>>>
46668>>>            Loop 
46669>>>>
46669>>>        
46669>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46670>>>        Structure_End hFile DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46672>>>
46672>>>        Set Action_Text of ghoStatusPanel to ""
46673>>>        Function_Return (Err = False)
46674>>>    End_Function
46675>>>
46675>>>    // * Dummy function for the Studio's Code Explorer *
46675>>>    Function API_INDEX_FUNCTIONS Returns Boolean
46677>>>        Function_Return False
46678>>>    End_Function
46679>>>
46679>>>    // Get ApiIndexCreate Customers.File_Number 1 2 0 1 -1 -1 -1 -1 -1 -1 -1 -1 to bOK
46679>>>    // Note: the "-1" can be left out as this function is overloaded to make it easier to call.
46679>>>    // Note: This doesn't set Descending attributes - Use function IndexChangeDirection to do that.
46679>>>    Function ApiIndexCreate Handle hTable Integer iIndex Integer iSegments Integer iSgmnt1 Integer iSgmnt2 Integer iSgmnt3 Integer iSgmnt4 Integer iSgmnt5 Integer iSgmnt6 Integer iSgmnt7 Integer iSgmnt8 Integer iSgmnt9 Integer iSgmnt10 Returns Boolean
46681>>>        Integer iTableNo iSegment1 iSegment2 iSegment3 iSegment4 iSegment5 iSegment6 iSegment7 iSegment8 iSegment9 iSegment10
46681>>>        String sDriverID
46681>>>        Boolean bOK
46681>>>
46681>>>        Get AutoConnectionIDLogin to bOK
46682>>>        Move -1 to iSegment1
46683>>>        Move -1 to iSegment2
46684>>>        Move -1 to iSegment3
46685>>>        Move -1 to iSegment4
46686>>>        Move -1 to iSegment5
46687>>>        Move -1 to iSegment6
46688>>>        Move -1 to iSegment7
46689>>>        Move -1 to iSegment8
46690>>>        Move -1 to iSegment9
46691>>>        Move -1 to iSegment10
46692>>>
46692>>>        If (num_arguments > 3) Begin
46694>>>            Move iSgmnt1 to iSegment1
46695>>>        End
46695>>>>
46695>>>        If (num_arguments > 4) Begin
46697>>>            Move iSgmnt2 to iSegment2
46698>>>        End
46698>>>>
46698>>>        If (num_arguments > 5) Begin
46700>>>            Move iSgmnt3 to iSegment3
46701>>>        End
46701>>>>
46701>>>        If (num_arguments > 6) Begin
46703>>>            Move iSgmnt4 to iSegment4
46704>>>        End
46704>>>>
46704>>>        If (num_arguments > 7) Begin
46706>>>            Move iSgmnt5 to iSegment5
46707>>>        End
46707>>>>
46707>>>        If (num_arguments > 8) Begin
46709>>>            Move iSgmnt6 to iSegment6
46710>>>        End
46710>>>>
46710>>>        If (num_arguments > 9) Begin
46712>>>            Move iSgmnt7 to iSegment7
46713>>>        End
46713>>>>
46713>>>        If (num_arguments > 10) Begin
46715>>>            Move iSgmnt8 to iSegment8
46716>>>        End
46716>>>>
46716>>>        If (num_arguments > 11) Begin
46718>>>            Move iSgmnt9 to iSegment9
46719>>>        End
46719>>>>
46719>>>        If (num_arguments > 12) Begin
46721>>>            Move iSgmnt10 to iSegment10
46722>>>        End
46722>>>>
46722>>>
46722>>>        Move False to Err
46723>>>        Move hTable to iTableNo
46724>>>        Get OpenTableExclusive hTable to bOK
46725>>>        If (bOK = False) Begin
46727>>>            Function_Return False
46728>>>        End
46728>>>>
46728>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
46731>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46732>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_PARAMETER
46733>>>        Send Ignore_Error of Error_Object_Id DFERR_NON_FATAL_RESTRUCTURE_ERROR
46734>>>
46734>>>        // We start by deleting the index
46734>>>        Structure_Start hTable sDriverID
46735>>>            Delete_Index iTableNo iIndex
46736>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46737>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46739>>>
46739>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46740>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_PARAMETER
46741>>>        Send Trap_Error of Error_Object_Id DFERR_NON_FATAL_RESTRUCTURE_ERROR
46742>>>        Set Action_Text of ghoStatusPanel to ""
46743>>>        Move False to Err 
46744>>>        Move 0 to LastErr
46745>>>        Move iTableNo to hTable
46746>>>        Get OpenTableExclusive hTable to bOK
46747>>>        If (bOK = False) Begin
46749>>>            Function_Return False
46750>>>        End
46750>>>>
46750>>>
46750>>>        Send Ignore_Error of Error_Object_Id CLIERR_GENERAL_ERROR
46751>>>        Structure_Start hTable sDriverID
46752>>>            Create_Index hTable At iIndex
46753>>>            Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iSegments
46756>>>
46756>>>            If (iSgmnt1 <> -1) Begin
46758>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 1 to iSegment1
46761>>>            End
46761>>>>
46761>>>            If (iSegment2 <> -1) Begin
46763>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 2 to iSegment2
46766>>>            End
46766>>>>
46766>>>            If (iSegment3 <> -1) Begin
46768>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 3 to iSegment3
46771>>>            End
46771>>>>
46771>>>            If (iSegment4 <> -1) Begin
46773>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 4 to iSegment4
46776>>>            End
46776>>>>
46776>>>            If (iSegment5 <> -1) Begin
46778>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 5 to iSegment5
46781>>>            End
46781>>>>
46781>>>            If (iSegment6 <> -1) Begin
46783>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 6 to iSegment6
46786>>>            End
46786>>>>
46786>>>            If (iSegment7 <> -1) Begin
46788>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 7 to iSegment7
46791>>>            End
46791>>>>
46791>>>            If (iSegment8 <> -1) Begin
46793>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 8 to iSegment8
46796>>>            End
46796>>>>
46796>>>            If (iSegment9 <> -1) Begin
46798>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 9 to iSegment9
46801>>>            End
46801>>>>
46801>>>            If (iSegment10 <> -1) Begin
46803>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable iIndex 10 to iSegment10
46806>>>            End
46806>>>>
46806>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46807>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46809>>>
46809>>>        Set Action_Text of ghoStatusPanel to ""
46810>>>        Send Trap_Error of Error_Object_Id CLIERR_GENERAL_ERROR
46811>>>
46811>>>        Function_Return (Err = False)
46812>>>    End_Function
46813>>>
46813>>>    Function APIIndexCreateByFieldNames Handle hTable tAPIIndex APIIndex tAPIIndex[] APIIndexTo tAPIIndexSegment[] aIndexSegments Returns Boolean
46815>>>        String[] aFields
46816>>>        Integer iCount iSegmentsFrom iFieldFrom iFieldTo iSegmentsTo iSQLIndexType iLastIndex iTableNo iSQLIndexTo
46816>>>        String sDriverID sSQLIndexName sTableName
46816>>>        Boolean bOK bIsSQLTable bIsOpen bIsSQLPrimaryKey bIsSQLClustered bIsSQLTemporaryIndex bExists
46816>>>
46816>>>        Move (SizeOfArray(aIndexSegments)) to iSegmentsFrom
46817>>>        If (iSegmentsFrom = 0) Begin
46819>>>            Function_Return False
46820>>>        End
46820>>>>
46820>>>
46820>>>        Get AutoConnectionIDLogin to bOK
46821>>>        Move False to Err
46822>>>        Get OpenTableExclusive hTable to bIsOpen
46823>>>        If (bIsOpen = False) Begin
46825>>>            Function_Return False
46826>>>        End
46826>>>>
46826>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
46829>>>        Get UtilTableIsSql hTable to bIsSQLTable   
46830>>>        
46830>>>        Move 0     to iSegmentsTo    
46831>>>        Move 0     to iSQLIndexType 
46832>>>        Move ""    to sSQLIndexName
46833>>>        Move False to bIsSQLTemporaryIndex 
46834>>>        Move False to bIsSQLPrimaryKey
46835>>>        Move False to bIsSQLClustered
46836>>>        
46836>>>//        Get_Attribute DF_FILE_LAST_INDEX_NUMBER of hTable                               to iLastIndex
46836>>>//        If (APIIndex.iIndexNumber <= iLastIndex) Begin
46836>>>//            Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable APIIndex.iIndexNumber      to iSegmentsTo
46836>>>//            If (bIsSQLTable = True) Begin
46836>>>//                Get_Attribute DF_INDEX_NAME of hTable APIIndex.iIndexNumber             to sSQLIndexName
46836>>>//                #IF (Required_RT_Version > 17)                                    
46836>>>//                Get_Attribute DF_INDEX_SQL_TYPE of hTable APIIndex.iIndexNumber         to iSQLIndexType
46836>>>//                Move (iSQLIndexType = DF_INDEX_TEMPORARY)                               to bIsSQLTemporaryIndex
46836>>>//                Get_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable APIIndex.iIndexNumber  to bIsSQLPrimaryKey
46836>>>//                Get_Attribute DF_INDEX_CLUSTERED       of hTable APIIndex.iIndexNumber  to bIsSQLClustered
46836>>>//                #ENDIF
46836>>>//            End
46836>>>//        End
46836>>>        
46836>>>        Move hTable to iTableNo 
46837>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable APIIndex.iIndexNumber to bExists
46840>>>        If (bExists = True) Begin
46842>>>            Get_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable APIIndex.iIndexNumber to bIsSQLPrimaryKey
46845>>>            If (bIsSQLPrimaryKey = False) Begin
46847>>>                // We start by deleting the index, if it exists
46847>>>                Structure_Start iTableNo sDriverID
46848>>>                    Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46849>>>                    Send Ignore_Error of Error_Object_Id DFERR_BAD_PARAMETER
46850>>>                    Delete_Index iTableNo APIIndex.iIndexNumber
46851>>>                    Set Error_Report_Mode to DUF_ERROR_REPORT
46852>>>                    Send Trap_Error of Error_Object_Id DFERR_BAD_PARAMETER
46853>>>                    Set Action_Text of ghoStatusPanel to "Restructures table..."
46854>>>                Structure_End iTableNo DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46856>>>                Set Action_Text of ghoStatusPanel to ""
46857>>>                
46857>>>                Get OpenTableExclusive hTable to bOK
46858>>>                If (bOK = False) Begin
46860>>>                    Function_Return False
46861>>>                End
46861>>>>
46861>>>            End
46861>>>>
46861>>>        End
46861>>>>
46861>>>        
46861>>>        Move hTable to iTableNo
46862>>>        Move False to Err
46863>>>        Move 0 to LastErr 
46864>>>
46864>>>        // Note: If the SQL index type = DF_INDEX_TEMPORARY, we _must_ set the DF_INDEX_SQL_TYPE 
46864>>>        //       _outside_ the Structure_Start/End construct.
46864>>>//        Move False to bIsSQLTemporaryIndex
46864>>>//        #IF (Required_RT_Version > 17)                                    
46864>>>//            If (bIsSQLTemporaryIndex = True and APIIndex.iIndexNumber <= iLastIndex) Begin
46864>>>//                If (APIIndex.iSQLIndexType <> iSQLIndexType) Begin
46864>>>//                    Set_Attribute DF_INDEX_SQL_TYPE of hTable APIIndex.iIndexNumber to APIIndex.iSQLIndexType // (DF_INDEX_SQL_TYPE = DF_INDEX_SERVER, DF_INDEX_CLIENT, DF_INDEX_SERVER_ONLY or DF_INDEX_TEMPORARY)
46864>>>//                End
46864>>>//            End
46864>>>//        #ENDIF
46864>>>        
46864>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
46865>>>        Structure_Start hTable sDriverID
46866>>>            If (bIsSQLPrimaryKey = False) Begin
46868>>>                Create_Index hTable At APIIndex.iIndexNumber
46869>>>            End
46869>>>>
46869>>>
46869>>>//            If (bIsSQLTable = True) Begin                                                         
46869>>>//                // In case the SQL Index name already exists for another index number; we temporarily rename that index name;
46869>>>//                Get UtilIndexSQLIndexNameExists iTableNo APIIndex.iIndexNumber APIIndex.sSQLIndexName APIIndexTo to iSQLIndexTo
46869>>>//                If (iSQLIndexTo > 0) Begin   
46869>>>//                    Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
46869>>>//                    Set_Attribute DF_INDEX_NAME of hTable iSQLIndexTo to (sTableName + String("001") + String(iSQLIndexTo))
46869>>>//                End
46869>>>//                Set_Attribute DF_INDEX_NAME of hTable APIIndex.iIndexNumber to APIIndex.sSQLIndexName
46869>>>//            End
46869>>>            
46869>>>            If (bIsSQLTable = True) Begin // (DF_INDEX_SQL_TYPE = DF_INDEX_SERVER, DF_INDEX_CLIENT, DF_INDEX_SERVER_ONLY or DF_INDEX_TEMPORARY)
46871>>>                Set_Attribute DF_INDEX_SQL_TYPE        of hTable APIIndex.iIndexNumber to APIIndex.iSQLIndexType 
46874>>>                Set_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable APIIndex.iIndexNumber to APIIndex.bIsSQLPrimaryKey
46877>>>                Set_Attribute DF_INDEX_CLUSTERED       of hTable APIIndex.iIndexNumber to APIIndex.bIsSQLClustered
46880>>>            End
46880>>>>
46880>>>                
46880>>>                If (iSegmentsFrom <> iSegmentsTo) Begin
46882>>>                    Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable APIIndex.iIndexNumber to iSegmentsFrom
46885>>>            End
46885>>>>
46885>>>            
46885>>>            for iCount from 0 to (iSegmentsFrom -1)
46891>>>>
46891>>>                Move aIndexSegments[iCount].iFieldNumber to iFieldFrom   
46892>>>                If (iFieldFrom <> -1 ) Begin
46894>>>                        Set_Attribute DF_INDEX_SEGMENT_FIELD of hTable APIIndex.iIndexNumber (iCount +1) to iFieldFrom
46897>>>                End
46897>>>>
46897>>>            Loop                         
46898>>>>
46898>>>                
46898>>>            // If more segments existed; remove them
46898>>>//            If (iSegmentsTo > iSegmentsFrom) Begin
46898>>>//                for iCount from iSegmentsFrom to iSegmentsTo
46898>>>//                          Get ApiIndexDeleteSegment hTable APIIndex.iIndexNumber iCount to bOK
46898>>>//                Loop
46898>>>//                  Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable APIIndex.iIndexNumber to iSegmentsFrom
46898>>>//            End
46898>>>                
46898>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
46899>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
46901>>>
46901>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
46902>>>        Set Action_Text of ghoStatusPanel to ""
46903>>>        
46903>>>        Function_Return (Err = False)
46904>>>    End_Function 
46905>>>    
46905>>>    // Checks if an SQL Index name for the "FROM" database already exists in the TO database,
46905>>>    // but with another Index number. We can then not rename the SQL index name for the TO database table.
46905>>>    Function UtilIndexSQLIndexNameExists Handle hTable Integer iIndexNumberFrom String sSQLIndexNameFrom tAPIIndex[] APIIndexTo Returns Integer
46907>>>        Integer iSize iCount iIndexNumberTo
46907>>>        String sSQLIndexNameTo
46907>>>        Integer iRetVal
46907>>>        
46907>>>        Move 0 to iRetVal     
46908>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndexNumberFrom to iRetVal
46911>>>        If (iRetVal = 0) Begin
46913>>>            Function_Return 0
46914>>>        End
46914>>>>
46914>>>        Move (SizeOfArray(APIIndexTo)) to iSize
46915>>>        Decrement iSize
46916>>>        for iCount from 0 to iSize
46922>>>>
46922>>>            If (Uppercase(sSQLIndexNameFrom) = Uppercase(APIIndexTo[iCount].sSQLIndexName)) Begin
46924>>>                If (iIndexNumberFrom <> APIIndexTo[iCount].iIndexNumber) Begin
46926>>>                    Move APIIndexTo[iCount].iIndexNumber to iRetVal
46927>>>                End
46927>>>>
46927>>>            End
46927>>>>
46927>>>        Loop
46928>>>>
46928>>>        
46928>>>        Function_Return iRetVal
46929>>>    End_Function   
46930>>>    
46930>>>    Function ApiIndexDeleteSegment Handle hTable Integer iIndex Integer iSegment Returns Boolean
46932>>>        Integer iNumSegments iCurSegment iSegmentCase iSegmentDirection iSegmentColumn
46932>>>    
46932>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
46935>>>        If (iSegment = iNumSegments) Begin
46937>>>//            Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
46937>>>        End
46937>>>>
46937>>>    
46937>>>        Else If (iSegment > 0 and iSegment < iNumSegments) Begin
46940>>>            for iCurSegment from iSegment to (iNumSegments - 1)
46946>>>>
46946>>>                //*** Move index segment attributes
46946>>>                Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex (iCurSegment + 1) to iSegmentCase
46949>>>                Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex (iCurSegment + 1) to iSegmentDirection
46952>>>                Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex (iCurSegment + 1) to iSegmentColumn
46955>>>    
46955>>>                Set_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iCurSegment to iSegmentCase
46958>>>                Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iCurSegment to iSegmentDirection
46961>>>                Set_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iCurSegment to iSegmentColumn
46964>>>            Loop
46965>>>>
46965>>>    
46965>>>            Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
46968>>>        End
46968>>>>
46968>>>    
46968>>>    End_Procedure
46969>>>
46969>>>    Function APIIndexRemoveAllIndexes Handle hTable tAPIIndex[] APIIndex Returns Boolean
46971>>>        String[] aFields
46972>>>        Integer iCount iSize iIndex 
46972>>>        String sDriverID
46972>>>        Boolean bOK bIsSQLTable bIsOpen bIsSQLPrimaryKey
46972>>>
46972>>>        Move (SizeOfArray(APIIndex)) to iSize
46973>>>        If (iSize = 0) Begin
46975>>>            Function_Return True
46976>>>        End
46976>>>>
46976>>>
46976>>>        Get AutoConnectionIDLogin to bOK
46977>>>        Move False to Err
46978>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
46981>>>        If (bIsOpen = False) Begin
46983>>>            Get OpenTableExclusive hTable to bIsOpen
46984>>>            If (bIsOpen = False) Begin
46986>>>                Function_Return False
46987>>>            End
46987>>>>
46987>>>        End    
46987>>>>
46987>>>        
46987>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
46990>>>        Get UtilTableIsSql hTable to bIsSQLTable
46991>>>
46991>>>        Move False to Err
46992>>>        Move 0 to LastErr             
46993>>>        Decrement iSize
46994>>>
46994>>>        Structure_Start hTable sDriverID
46995>>>            for iCount from 0 to iSize
47001>>>>
47001>>>//                Move False to bIsSQLPrimaryKey
47001>>>//                #IF ((Required_RT_Version * 10 + Required_RT_Revision) > 180)   // DF 18.1 and up
47001>>>//                    Set Error_Report_Mode to DUF_ERROR_NO_REPORT
47001>>>//                    Get_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable APIIndex[iCount].iIndexNumber to bIsSQLPrimaryKey
47001>>>//                    Set Error_Report_Mode to DUF_ERROR_REPORT
47001>>>//                #ENDIF
47001>>>                // We can't delete if this is a primary key index:
47001>>>//                If (bIsSQLPrimaryKey = False) Begin
47001>>>                    Move APIIndex[iCount].iIndexNumber to iIndex
47002>>>                    Delete_Index hTable iIndex
47003>>>//                    Set Error_Report_Mode to DUF_ERROR_REPORT
47003>>>//                End
47003>>>            Loop
47004>>>>
47004>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
47005>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47007>>>//        Move False to Err
47007>>>        Move 0 to LastErr
47008>>>
47008>>>        Set Action_Text of ghoStatusPanel to ""
47009>>>        Function_Return (Err = False)
47010>>>    End_Function
47011>>>
47011>>>    Function ApiIndexChangeDirection Handle hTable Integer iIndex Integer iSegment Integer iDirection Returns Boolean
47013>>>        Boolean bOK
47013>>>
47013>>>        Get AutoConnectionIDLogin to bOK
47014>>>        Move False to Err
47015>>>        Get OpenTableExclusive hTable to bOK
47016>>>        If (bOK = False) Begin
47018>>>            Function_Return False
47019>>>        End
47019>>>>
47019>>>        Structure_Start hTable
47020>>>            Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iSegment to iDirection
47023>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
47024>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47026>>>
47026>>>        Set Action_Text of ghoStatusPanel to ""
47027>>>        Function_Return (Err = False)
47028>>>    End_Function
47029>>>
47029>>>    Function ApiIndexChangeUppercase Handle hTable Integer iIndex Integer iSegment Boolean bUppercase Returns Boolean
47031>>>        Integer iCase
47031>>>        Boolean bOK
47031>>>
47031>>>        If (bUppercase = True) Begin
47033>>>            Move DF_CASE_IGNORED to iCase
47034>>>        End
47034>>>>
47034>>>        Else Begin
47035>>>            Move DF_CASE_USED to iCase
47036>>>        End
47036>>>>
47036>>>
47036>>>        Get AutoConnectionIDLogin to bOK
47037>>>        Move False to Err
47038>>>        Get OpenTableExclusive hTable to bOK
47039>>>        If (bOK = False) Begin
47041>>>            Function_Return False
47042>>>        End
47042>>>>
47042>>>        Structure_Start hTable
47043>>>            Set_Attribute DF_INDEX_SEGMENT_CASE of hTable iIndex iSegment to iCase
47046>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
47047>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47049>>>
47049>>>        Set Action_Text of ghoStatusPanel to ""
47050>>>        Function_Return (Err = False)
47051>>>    End_Function
47052>>>
47052>>>    // To delete an index
47052>>>    Function ApiIndexRemove Handle hTable Integer iIndex Returns Boolean
47054>>>        Integer iTableNo iNumSegments
47054>>>        String sDriverID
47054>>>        Boolean bOK
47054>>>
47054>>>        Get AutoConnectionIDLogin to bOK
47055>>>        Move False to Err
47056>>>        Move hTable to iTableNo
47057>>>        Get OpenTableExclusive hTable to bOK
47058>>>        If (bOK = False) Begin
47060>>>            Function_Return False
47061>>>        End
47061>>>>
47061>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
47064>>>
47064>>>        // Check to see if the index exists or not...
47064>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47067>>>        If (iNumSegments = 0) Begin
47069>>>            Function_Return False
47070>>>        End
47070>>>>
47070>>>
47070>>>        Structure_Start hTable sDriverID
47071>>>            Send Ignore_Error of Error_Object_Id DFERR_BAD_PARAMETER
47072>>>            Delete_Index iTableNo iIndex
47073>>>            Send Trap_Error of Error_Object_Id DFERR_BAD_PARAMETER
47074>>>            Set Action_Text of ghoStatusPanel to "Restructures table..."
47075>>>        Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47077>>>
47077>>>        Set Action_Text of ghoStatusPanel to ""
47078>>>        Function_Return (Err = False)
47079>>>    End_Function
47080>>>
47080>>>    // Delete an Index Segment
47080>>>    Function ApiIndexRemoveSegment Handle hTable Integer iIndex Integer iSegment Returns Boolean
47082>>>        Boolean bOK bSQLDriver bIndexTemporary
47082>>>        Integer iNumSegments iCurSegment iSegmentCase iSegmentDirection iSegmentColumn
47082>>>        Integer iIndexType
47082>>>        String sDriverID
47082>>>
47082>>>        Get AutoConnectionIDLogin to bOK
47083>>>        Move False to Err
47084>>>
47084>>>        Get OpenTableExclusive hTable to bOK
47085>>>        If (bOK = False) Begin
47087>>>            Function_Return False
47088>>>        End
47088>>>>
47088>>>
47088>>>        // Check to see if the index exists or not...
47088>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47091>>>        If (iNumSegments = 0) Begin
47093>>>            Function_Return False
47094>>>        End
47094>>>>
47094>>>
47094>>>        Move False to bIndexTemporary
47095>>>        Get psDriverID to sDriverID
47096>>>        Get IsSQLDriver sDriverID to bSQLDriver
47097>>>        If (bSQLDriver) Begin
47099>>>           Get_Attribute DF_INDEX_TYPE of hTable iIndex to iIndexType
47102>>>                Get_Attribute DF_INDEX_TYPE to iIndexType
47105>>>                Move True to bIndexTemporary
47106>>>        End
47106>>>>
47106>>>
47106>>>        // If SQL and Temporary Index must not use Structure_Start/Structure_End
47106>>>        If (bSQLDriver = True and bIndexTemporary = True) Begin
47108>>>            Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47111>>>            If (iSegment = iNumSegments) Begin
47113>>>                Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
47116>>>            End
47116>>>>
47116>>>            Else If (iSegment > 0 and iSegment < iNumSegments) Begin
47119>>>                For iCurSegment from iSegment to (iNumSegments - 1)
47125>>>>
47125>>>                    //*** Move index segment attributes
47125>>>                    Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex (iCurSegment + 1) to iSegmentCase
47128>>>                    Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex (iCurSegment + 1) to iSegmentDirection
47131>>>                    Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex (iCurSegment + 1) to iSegmentColumn
47134>>>                    Set_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iCurSegment       to iSegmentCase
47137>>>                    Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iCurSegment       to iSegmentDirection
47140>>>                    Set_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iCurSegment       to iSegmentColumn
47143>>>                Loop
47144>>>>
47144>>>                Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
47147>>>            End
47147>>>>
47147>>>        End
47147>>>>
47147>>>
47147>>>        Else Begin
47148>>>           Structure_Start hTable
47149>>>               Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47152>>>               If (iSegment = iNumSegments) Begin
47154>>>                   Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
47157>>>               End
47157>>>>
47157>>>               Else If (iSegment > 0 and iSegment < iNumSegments) Begin
47160>>>                   for iCurSegment from iSegment to (iNumSegments - 1)
47166>>>>
47166>>>                       //*** Move index segment attributes
47166>>>                       Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex (iCurSegment + 1) to iSegmentCase
47169>>>                       Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex (iCurSegment + 1) to iSegmentDirection
47172>>>                       Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex (iCurSegment + 1) to iSegmentColumn
47175>>>                       Set_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iCurSegment       to iSegmentCase
47178>>>                       Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iCurSegment       to iSegmentDirection
47181>>>                       Set_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iCurSegment       to iSegmentColumn
47184>>>                   Loop
47185>>>>
47185>>>                   Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments - 1)
47188>>>               End
47188>>>>
47188>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
47189>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47191>>>            Set Action_Text of ghoStatusPanel to ""
47192>>>        End
47192>>>>
47192>>>
47192>>>        Function_Return (Err = False)
47193>>>    End_Function
47194>>>
47194>>>    // Add/Insert an Index Segment
47194>>>    Function ApiIndexInsertSegment Handle hTable Integer iIndex Integer iSegment Integer iSegmentColumn Integer iSegmentCase Integer iSegmentDirection Returns Boolean
47196>>>        Boolean bOK bSQLDriver bIndexTemporary
47196>>>        Integer iNumSegments iCurSegment iCurSegmentColumn iCurSegmentCase iCurSegmentDirection
47196>>>        Integer iIndexType
47196>>>        String sDriverId
47196>>>
47196>>>        Get AutoConnectionIDLogin to bOK
47197>>>        Move False to Err
47198>>>
47198>>>        Get OpenTableExclusive hTable to bOK
47199>>>        If (bOK = False) Begin
47201>>>            Function_Return False
47202>>>        End
47202>>>>
47202>>>
47202>>>        Move False to bIndexTemporary
47203>>>        // Check to see if the index exists or not...
47203>>>        Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47206>>>        If (iNumSegments = 0) Begin
47208>>>            Function_Return False
47209>>>        End
47209>>>>
47209>>>
47209>>>        Get psDriverID to sDriverID
47210>>>        Get IsSQLDriver sDriverID to bSQLDriver
47211>>>        If (bSQLDriver) Begin
47213>>>           Get_Attribute DF_INDEX_TYPE of hTable iIndex to iIndexType
47216>>>                Get_Attribute DF_INDEX_TYPE to iIndexType
47219>>>                Move True to bIndexTemporary
47220>>>        End
47220>>>>
47220>>>
47220>>>        // If SQL and Temporary Index must not use Structure_Start/Structure_End
47220>>>        If (bSQLDriver = True and bIndexTemporary = True) Begin
47222>>>           Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47225>>>
47225>>>           If (iSegment > iNumSegments) Begin
47227>>>               Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments + 1)
47230>>>               Move (iNumSegments + 1) to iCurSegment
47231>>>           End
47231>>>>
47231>>>           Else If (iSegment > 0 and iSegment <= iNumSegments) Begin
47234>>>               Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments + 1)
47237>>>               Move iNumSegments to iCurSegment
47238>>>
47238>>>               While (iCurSegment > iSegment)
47242>>>                   //*** Move index segment attributes
47242>>>                   Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex (iCurSegment - 1) to iCurSegmentCase
47245>>>                   Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex (iCurSegment - 1) to iCurSegmentDirection
47248>>>                   Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex (iCurSegment - 1) to iSegmentColumn
47251>>>                   Set_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iCurSegment       to iCurSegmentCase
47254>>>                   Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iCurSegment       to iCurSegmentDirection
47257>>>                   Set_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iCurSegment       to iCurSegmentColumn
47260>>>                   Decrement iCurSegment
47261>>>               End
47262>>>>
47262>>>
47262>>>               //*** Now set new segment attributes
47262>>>               Set_Attribute DF_INDEX_SEGMENT_CASE          of hTable iIndex iCurSegment       to iSegmentCase
47265>>>               Set_Attribute DF_INDEX_SEGMENT_DIRECTION     of hTable iIndex iCurSegment       to iSegmentDirection
47268>>>               Set_Attribute DF_INDEX_SEGMENT_FIELD         of hTable iIndex iCurSegment       to iSegment
47271>>>           End
47271>>>>
47271>>>        End
47271>>>>
47271>>>
47271>>>        Else Begin
47272>>>           Structure_Start hTable
47273>>>              Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
47276>>>
47276>>>              If (iSegment > iNumSegments) Begin
47278>>>                  Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments + 1)
47281>>>                  Move (iNumSegments + 1) to iCurSegment
47282>>>              End
47282>>>>
47282>>>              Else If (iSegment > 0 and iSegment <= iNumSegments) Begin
47285>>>                  Set_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to (iNumSegments + 1)
47288>>>                  Move iNumSegments to iCurSegment
47289>>>
47289>>>                  While (iCurSegment > iSegment)
47293>>>                      //*** Move index segment attributes
47293>>>                      Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex (iCurSegment - 1) to iSegmentCase
47296>>>                      Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex (iCurSegment - 1) to iSegmentDirection
47299>>>                      Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex (iCurSegment - 1) to iSegmentColumn
47302>>>                      Set_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iCurSegment       to iSegmentCase
47305>>>                      Set_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iCurSegment       to iSegmentDirection
47308>>>                      Set_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iCurSegment       to iSegmentColumn
47311>>>                      Decrement iCurSegment
47312>>>                  End
47313>>>>
47313>>>
47313>>>                  //*** Now set new segment attributes
47313>>>                  Set_Attribute DF_INDEX_SEGMENT_CASE          of hTable iIndex iCurSegment       to iSegmentCase
47316>>>                  Set_Attribute DF_INDEX_SEGMENT_DIRECTION     of hTable iIndex iCurSegment       to iSegmentDirection
47319>>>                  Set_Attribute DF_INDEX_SEGMENT_FIELD         of hTable iIndex iCurSegment       to iSegment
47322>>>              End
47322>>>>
47322>>>              Set Action_Text of ghoStatusPanel to "Restructures table..."
47323>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
47325>>>            Set Action_Text of ghoStatusPanel to ""
47326>>>        End
47326>>>>
47326>>>
47326>>>        Function_Return (Err = False)
47327>>>    End_Function
47328>>>
47328>>>    Function API_TABLE_UTILITY_FUNCTIONS Returns Boolean
47330>>>        Function_Return False
47331>>>    End_Function
47332>>>
47332>>>    // Compares the RootName, LogicalName & DisplayName and returns True if they are equal.
47332>>>    // Note that it first removes any driver prefixes in the rootname.
47332>>>    Function UtilTableInfoCompare Boolean bCompareFilelistUppercase tAPITableNameInfoCompare APITableInfoCompare Returns Boolean
47334>>>        Boolean bIsSame
47334>>>        String sRootNameFrom sRootNameTo sLogicalNameFrom sLogicalNameTo sDisplayNameFrom sDisplayNameTo
47334>>>
47334>>>        Get _TableNoPrefix APITableInfoCompare.sRootNameFrom    to sRootNameFrom
47335>>>        Get _TableNoPrefix APITableInfoCompare.sRootNameTo      to sRootNameTo
47336>>>        Move APITableInfoCompare.sLogicalNameFrom               to sLogicalNameFrom
47337>>>        Move APITableInfoCompare.sLogicalNameTo                 to sLogicalNameTo
47338>>>        Get _TableNoPrefix APITableInfoCompare.sDisplayNameFrom to sDisplayNameFrom
47339>>>        Get _TableNoPrefix APITableInfoCompare.sDisplayNameTo   to sDisplayNameTo
47340>>>
47340>>>        If (bCompareFilelistUppercase = True) Begin
47342>>>            Move (Uppercase(sRootNameFrom) = Uppercase(sRootNameTo) and Uppercase(sLogicalNameFrom) = Uppercase(sLogicalNameTo)) to bIsSame
47343>>>        End
47343>>>>
47343>>>        Else Begin
47344>>>            Move (sRootNameFrom = sRootNameTo and sLogicalNameFrom = sLogicalNameTo and sDisplayNameFrom = sDisplayNameTo) to bIsSame
47345>>>        End  
47345>>>>
47345>>>        If (bIsSame = False) Begin
47347>>>            Function_Return False
47348>>>        End 
47348>>>>
47348>>>
47348>>>        Move (APITableInfoCompare.bIsAliasFrom = APITableInfoCompare.bIsAliasTo) to bIsSame
47349>>>        If (bIsSame = False) Begin
47351>>>            Function_Return False
47352>>>        End 
47352>>>>
47352>>>
47352>>>        Move (APITableInfoCompare.bIsSQLFrom = APITableInfoCompare.bIsSQLTo) to bIsSame
47353>>>        If (bIsSame = False) Begin
47355>>>            Function_Return False
47356>>>        End 
47356>>>>
47356>>>
47356>>>        Move (APITableInfoCompare.bIsSystemFileFrom = APITableInfoCompare.bIsSystemFileTo) to bIsSame
47357>>>        If (bIsSame = False) Begin
47359>>>            Function_Return False
47360>>>        End 
47360>>>>
47360>>>
47360>>>        Function_Return bIsSame
47361>>>    End_Function
47362>>>
47362>>>    Function UtilTableCompare tAPITable APITableFrom tAPITable APITableTo Boolean bCodeGenerateMode Boolean ByRef bFilelistError Returns Boolean
47364>>>        Handle hTableFrom hTableTo
47364>>>        Boolean bIsSame bIsSQLFrom bIsSQLTo
47364>>>        Boolean bCompareDate_DateTime bCompareIndexAscending bCompareIndexUppercase
47364>>>        String sRootName sDriverIDFrom sDriverIDTo
47364>>>        tAPIColumnCompare[]   aAPIColumnCompare
47364>>>        tAPIColumnCompare[]   aAPIColumnCompare
47365>>>        tAPIIndexCompare[]    aAPIIndexCompare
47365>>>        tAPIIndexCompare[]    aAPIIndexCompare
47366>>>        tAPIRelationCompare[] aAPIRelationCompare
47366>>>        tAPIRelationCompare[] aAPIRelationCompare
47367>>>
47367>>>        Move (IsSameStruct(APITableFrom, APITableTo)) to bIsSame
47368>>>        If (bIsSame = True) Begin
47370>>>            Function_Return True
47371>>>        End
47371>>>>
47371>>>
47371>>>        Move False to bFilelistError
47372>>>        Move True to bIsSame
47373>>>        Get pbCompareDate_DateTime  to bCompareDate_DateTime
47374>>>        Get pbCompareIndexAscending to bCompareIndexAscending
47375>>>        Get pbCompareIndexUppercase to bCompareIndexUppercase
47376>>>        Move APITableFrom.ApiTableInfo.iTableNumber to hTableFrom
47377>>>        Move APITableTo.ApiTableInfo.iTableNumber   to hTableTo
47378>>>
47378>>>        Move APITableFrom.ApiTableInfo.sRootName to sRootName
47379>>>        Get _TableNameOnly sRootName             to sRootName
47380>>>        Move sRootName to APITableTo.ApiTableInfo.sRootName
47381>>>
47381>>>        // First we need to check that the logical table names are the same (so the order of tables in the Filelist.cfg is the same).
47381>>>        // bCodeGenerateMode = True = Code Generation mode.
47381>>>        If (bCodeGenerateMode = True) Begin
47383>>>            // If table doesn't exist in the TO database we want to create 'ApiTableUpdate' code for it.
47383>>>            If (Trim(Uppercase(APITableTo.ApiTableInfo.sLogicalName)) = "") Begin
47385>>>                Function_Return False
47386>>>            End
47386>>>>
47386>>>            Move (Trim(Uppercase(APITableFrom.ApiTableInfo.sLogicalName)) = Trim(Uppercase(APITableTo.ApiTableInfo.sLogicalName))) to bIsSame
47387>>>            If (bIsSame = False) Begin
47389>>>                Send UserError ("Yikes! There is a serious problem with the Filelist.cfg slot number:" * String(hTableFrom) + ".\nThe FROM table logical name is:" * String(APITableFrom.ApiTableInfo.sLogicalName) * "\nwhile the TO table logical name is:" * String(APITableTo.ApiTableInfo.sLogicalName) * ".\nThis needs to be fixed before you can generate code for this table number.")
47390>>>                Move True to bFilelistError
47391>>>                Function_Return False
47392>>>            End
47392>>>>
47392>>>        End
47392>>>>
47392>>>
47392>>>        If (bCodeGenerateMode = False) Begin
47394>>>            // Then we want to create this table
47394>>>            If (Trim(Uppercase(APITableTo.ApiTableInfo.sLogicalName)) = "") Begin
47396>>>                Function_Return False
47397>>>            End
47397>>>>
47397>>>
47397>>>            Move (Trim(Uppercase(APITableFrom.ApiTableInfo.sLogicalName)) = Trim(Uppercase(APITableTo.ApiTableInfo.sLogicalName))) to bIsSame
47398>>>            If (bIsSame = False) Begin
47400>>>                Error DFERR_PROGRAM ("'UtilTableCompare function' problem in Filelist.cfg! Table No:" * String(hTableFrom) + ".\nThe FROM table logical name is:" * String(APITableFrom.ApiTableInfo.sLogicalName) * "\nwhile the TO table logical name is:" * String(APITableTo.ApiTableInfo.sLogicalName) * "No changes was made for this entry.")
47401>>>>
47401>>>                Move True to bFilelistError
47402>>>                Function_Return False
47403>>>            End
47403>>>>
47403>>>        End
47403>>>>
47403>>>
47403>>>        // Check columns:
47403>>>        Move APITableFrom.ApiTableInfo.iTableNumber to hTableFrom
47404>>>        Move APITableFrom.ApiTableInfo.bIsSQL       to bIsSQLFrom
47405>>>        Move APITableFrom.ApiTableInfo.sDriverID    to sDriverIDFrom
47406>>>        Move APITableTo.ApiTableInfo.iTableNumber   to hTableTo
47407>>>        Move APITableTo.ApiTableInfo.bIsSQL         to bIsSQLTo
47408>>>        Move APITableTo.ApiTableInfo.sDriverID      to sDriverIDTo
47409>>>        Get UtilColumnsStructFill hTableTo          to APITableTo.aApiColumns
47410>>>        Get UtilColumnCombineFromAndToArrays APITableFrom.aApiColumns APITableTo.aApiColumns to aAPIColumnCompare
47411>>>        Get UtilColumnsCompare sDriverIDFrom sDriverIDTo bIsSQLFrom bIsSQLTo aAPIColumnCompare bCompareDate_DateTime to bIsSame
47412>>>        If (bIsSame = False) Begin
47414>>>            Function_Return False
47415>>>        End
47415>>>>
47415>>>
47415>>>        // ...then check indexes:
47415>>>        Get UtilIndexesStructFill hTableFrom to APITableTo.aApiIndexes
47416>>>        Get UtilIndexCombineFromAndToArrays APITableFrom.aApiIndexes APITableTo.aApiIndexes to aAPIIndexCompare
47417>>>        Get UtilIndexesCompare bIsSQLFrom bIsSQLTo aAPIIndexCompare bCompareIndexUppercase bCompareIndexAscending to bIsSame
47418>>>        If (bIsSame = False) Begin
47420>>>            Function_Return False
47421>>>        End
47421>>>>
47421>>>
47421>>>        // ...and finally relationships:
47421>>>        Get UtilRelationsStructFill hTableFrom to APITableTo.aApiRelations
47422>>>        Get UtilRelationCombineFromAndToArrays APITableFrom.aApiRelations APITableTo.aApiRelations to aAPIRelationCompare
47423>>>        Move (IsSameArray(APITableFrom.aApiRelations, APITableTo.aApiRelations)) to bIsSame
47424>>>        Get UtilRelationsCompare hTableFrom aAPIRelationCompare to bIsSame
47425>>>
47425>>>        Function_Return (bIsSame = True)
47426>>>    End_Function
47427>>>
47427>>>    // Similar to UtilTableCompare, but takes a tAPITableCompare struct array and a tAPITableBooleans struct as params.
47427>>>    Function UtilTableCompare_Ex tAPITableCompare APITableCompare tAPITableBooleans CompareTableBooleans Boolean bCodeGenerateMode Boolean ByRef bFilelistError Returns Boolean
47429>>>        Handle hTable
47429>>>        Boolean bIsSame bIsSQLFrom bIsSQLTo
47429>>>        String sRootName sDriverIDFrom sDriverIDTo
47429>>>
47429>>>        If (APITableCompare.APITableNameInfoCompare.bExistsFrom = False and APITableCompare.APITableNameInfoCompare.bExistsTo = False) Begin
47431>>>            Move True to bFilelistError
47432>>>            Function_Return False
47433>>>        End
47433>>>>
47433>>>
47433>>>        Move APITableCompare.hTable to hTable
47434>>>        Move True  to bIsSame
47435>>>        Move False to bFilelistError
47436>>>
47436>>>        If (APITableCompare.bExistsFrom = True) Begin
47438>>>            Move APITableCompare.APITableNameInfoCompare.sRootNameFrom to sRootName
47439>>>        End
47439>>>>
47439>>>        Else Begin
47440>>>            Move APITableCompare.APITableNameInfoCompare.sRootNameTo   to sRootName
47441>>>        End
47441>>>>
47441>>>        Get _TableNameOnly sRootName                                   to sRootName
47442>>>
47442>>>        Move APITableCompare.APITableNameInfoCompare.sDriverIDFrom     to sDriverIDFrom
47443>>>        Move APITableCompare.APITableNameInfoCompare.sDriverIDTo       to sDriverIDTo
47444>>>        Move APITableCompare.APITableNameInfoCompare.bIsSQLFrom        to bIsSQLFrom
47445>>>        Move APITableCompare.APITableNameInfoCompare.bIsSQLTo          to bIsSQLTo
47446>>>
47446>>>        // First we need to check that the logical table names are the same (so the order of tables in the Filelist.cfg are the same).
47446>>>        // bCodeGenerateMode = True = Code Generation mode.
47446>>>        If (bCodeGenerateMode = True) Begin
47448>>>            // If table doesn't exist in the TO database we want to create 'ApiTableUpdate' code for it.
47448>>>            If (APITableCompare.bExistsTo = False) Begin
47450>>>                Function_Return False
47451>>>            End
47451>>>>
47451>>>            Move (Uppercase(APITableCompare.APITableNameInfoCompare.sLogicalNameFrom) = Uppercase(APITableCompare.APITableNameInfoCompare.sLogicalNameTo)) to bIsSame
47452>>>            If (bIsSame = False) Begin
47454>>>                Send UserError ("Yikes! There is a problem with the Filelist.cfg slot number:" * String(hTable) + ;                    ".\nThe FROM table logical name is:" * String(APITableCompare.APITableNameInfoCompare.sLogicalNameFrom) * "\nwhile the TO table logical name is:" * ;                    String(APITableCompare.APITableNameInfoCompare.sLogicalNameTo) * ".\nThis needs to be fixed before you can generate code for this table number.")
47455>>>                Move True to bFilelistError
47456>>>                Function_Return False
47457>>>            End
47457>>>>
47457>>>        End
47457>>>>
47457>>>
47457>>>        If (bCodeGenerateMode = False) Begin
47459>>>            If (APITableCompare.bExistsTo = False) Begin
47461>>>                // Then we might want to create this table
47461>>>                Function_Return False
47462>>>            End
47462>>>>
47462>>>
47462>>>            Move (APITableCompare.APITableNameInfoCompare.bIsAliasFrom = APITableCompare.APITableNameInfoCompare.bIsAliasTo) to bIsSame
47463>>>            If (bIsSame = False) Begin
47465>>>                Function_Return False
47466>>>            End 
47466>>>>
47466>>>    
47466>>>            Move (APITableCompare.APITableNameInfoCompare.bIsSQLFrom = APITableCompare.APITableNameInfoCompare.bIsSQLTo) to bIsSame
47467>>>            If (bIsSame = False) Begin
47469>>>                Function_Return False
47470>>>            End 
47470>>>>
47470>>>    
47470>>>            Move (APITableCompare.APITableNameInfoCompare.bIsSystemFileFrom = APITableCompare.APITableNameInfoCompare.bIsSystemFileTo) to bIsSame
47471>>>            If (bIsSame = False) Begin
47473>>>                Function_Return False
47474>>>            End 
47474>>>>
47474>>>
47474>>>            // Check table names et al.
47474>>>            Get UtilTableInfoCompare CompareTableBooleans.bCompareFilelistUppercase APITableCompare.APITableNameInfoCompare to bIsSame
47475>>>            If (bIsSame = False) Begin
47477>>>                Function_Return False
47478>>>            End
47478>>>>
47478>>>        End
47478>>>>
47478>>>
47478>>>        // Check Columns:
47478>>>        Get UtilColumnsCompare sDriverIDFrom sDriverIDTo bIsSQLFrom bIsSQLTo APITableCompare.aAPIColumnsCompare CompareTableBooleans.bCompareDate_DateTime to bIsSame
47479>>>        If (bIsSame = False) Begin
47481>>>            Function_Return False
47482>>>        End
47482>>>>
47482>>>
47482>>>        // ...then check Indexes:
47482>>>        Get UtilIndexesCompare bIsSQLFrom bIsSQLTo APITableCompare.aAPIIndexesCompare CompareTableBooleans.bCompareIndexUppercase CompareTableBooleans.bCompareIndexAscending to bIsSame
47483>>>        If (bIsSame = False) Begin
47485>>>            Function_Return False
47486>>>        End
47486>>>>
47486>>>
47486>>>        // ...and finally Relationships:
47486>>>        Get UtilRelationsCompare hTable APITableCompare.aAPIRelationsCompare to bIsSame
47487>>>
47487>>>        Function_Return (bIsSame = True)
47488>>>    End_Function
47489>>>
47489>>>    // To fill a complete Table array structure (tAPITable[]) with data.
47489>>>    // The data + filelist.cfg path, login et al must have been setup properly first.
47489>>>    // Pass a True as first parameter if the ghoStatusPanel is active and progress info should be shown.
47489>>>    // Pass a second True if this is a comparison and the text should either reflect "FROM" or "TO" database.
47489>>>    Function UtilTablesStructArrayFill Boolean bStatusPanel Boolean bCompareUtil Boolean bFromTables Returns tAPITable[]
47491>>>        tAPITableNameInfo ApiTableNameInfo
47491>>>        tAPITableNameInfo ApiTableNameInfo
47491>>>        tAPITable[]     aApiTables aApiTablesEmpty
47491>>>        tAPITable[]     aApiTables aApiTablesEmpty
47493>>>        tAPIColumn[]    aApiColumns
47493>>>        tAPIColumn[]    aApiColumns
47494>>>        tAPIIndex[]     aApiIndexes
47494>>>        tAPIIndex[]     aApiIndexes
47495>>>        tAPIRelation[]  aApiRelations
47495>>>        tAPIRelation[]  aApiRelations
47496>>>        Handle hTable
47496>>>        Integer iCount iPos
47496>>>        Boolean bIsAlias bUserCancel bIsSQL bIsOpen
47496>>>        String sLogicalName sMessageText
47496>>>
47496>>>        Move 0 to hTable
47497>>>        If (bFromTables = True) Begin
47499>>>            Move "Reading 'FROM' Table Structure:" to sMessageText
47500>>>            If (bCompareUtil = True) Begin
47502>>>                Move (sMessageText * "(1 of 3)") to sMessageText
47503>>>            End
47503>>>>
47503>>>        End
47503>>>>
47503>>>        Else Begin
47504>>>            Move "Reading 'TO' Table Structure:" to sMessageText
47505>>>            If (bCompareUtil = True) Begin
47507>>>                Move (sMessageText * "(2 of 3)") to sMessageText
47508>>>            End
47508>>>>
47508>>>        End
47508>>>>
47508>>>        Set Message_Text of ghoStatusPanel to sMessageText
47509>>>
47509>>>        Get UtilFilelistNoOfTables to iCount
47510>>>        Set piMaximum of ghoProgressBar to iCount
47511>>>        Move 0 to iCount
47512>>>
47512>>>        Repeat
47512>>>>
47512>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
47515>>>            If (hTable > 0 and hTable <> 50) Begin
47517>>>            
47517>>>                Open hTable
47519>>>                Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
47522>>>                If (bIsOpen = False) Begin
47524>>>                    Move True to aApiTablesEmpty[0].bError
47525>>>                    Move hTable to aApiTablesEmpty[0].ApiTableInfo.iTableNumber
47526>>>                    Function_Return aApiTablesEmpty
47527>>>                End
47527>>>>
47527>>>
47527>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName 
47530>>>                Set piPosition of ghoProgressBar to iCount
47531>>>                Send DoAdvance of ghoProgressBarOverall
47532>>>                Set Action_Text of ghoStatusPanel to ("Number:" * String(hTable) * String(sLogicalName))
47533>>>
47533>>>                Get UtilTableStructFill hTable bFromTables to aApiTables[iCount]
47534>>>//                // Table Name Info
47534>>>//                Get UtilTableNameInfoStructFill hTable to ApiTableNameInfo
47534>>>//                
47534>>>//                // Fill columns
47534>>>//                Get UtilColumnsStructFill hTable to aApiColumns
47534>>>//                If (aApiColumns[0].bCancel = True) Begin
47534>>>//                    Move True to aApiTablesEmpty[0].bError
47534>>>//                    Move hTable to aApiTablesEmpty[0].ApiTableInfo.iTableNumber
47534>>>//                    Function_Return aApiTablesEmpty
47534>>>//                End
47534>>>//
47534>>>//                // Fill indexes
47534>>>//                Get UtilIndexesStructFill hTable to aApiIndexes
47534>>>//                If (aApiIndexes[0].bCancel = True) Begin
47534>>>//                    Move True to aApiTablesEmpty[0].bError
47534>>>//                    Move hTable to aApiTablesEmpty[0].ApiTableInfo.iTableNumber
47534>>>//                    Function_Return aApiTablesEmpty
47534>>>//                End
47534>>>//
47534>>>//                // Fill relationships
47534>>>//                Get UtilRelationsStructFill hTable to aApiRelations
47534>>>//                If (aApiRelations[0].bCancel = True) Begin
47534>>>//                    Move True to aApiTablesEmpty[0].bError
47534>>>//                    Move hTable to aApiTablesEmpty[0].ApiTableInfo.iTableNumber
47534>>>//                    Function_Return aApiTablesEmpty
47534>>>//                End
47534>>>
47534>>>                Close hTable DF_PERMANENT
47536>>>
47536>>>//                Move hTable             to aApiTables[iCount].hTable
47536>>>//                Move bFromTables        to aApiTables[iCount].bFromTable
47536>>>//                Move (not(bFromTables)) to aApiTables[iCount].bToTable   
47536>>>//                Move ApiTableNameInfo   to aApiTables[iCount].ApiTableInfo
47536>>>//                Move aApiColumns        to aApiTables[iCount].aApiColumns
47536>>>//                Move aApiIndexes        to aApiTables[iCount].aApiIndexes
47536>>>//                Move aApiRelations      to aApiTables[iCount].aApiRelations
47536>>>                Increment iCount
47537>>>            End
47537>>>>
47537>>>
47537>>>            If (bStatusPanel = True) Begin
47539>>>                Get Check_StatusPanel of ghoStatusPanel to bUserCancel
47540>>>                If (bUserCancel = True) Begin
47542>>>                    Move True to aApiTablesEmpty[0].bCancel
47543>>>                    Function_Return aApiTablesEmpty
47544>>>                End
47544>>>>
47544>>>            End
47544>>>>
47544>>>
47544>>>        Until (hTable = 0)
47546>>>
47546>>>        Function_Return aApiTables
47547>>>    End_Function
47548>>>    
47548>>>    // Returns a 'single' table APITable struct.
47548>>>    Function UtilTableStructFill Handle hTable Boolean bFromTables Returns tAPITable
47550>>>        tAPITableNameInfo ApiTableNameInfo
47550>>>        tAPITableNameInfo ApiTableNameInfo
47550>>>        tAPITable         ApiTable ApiTableEmpty
47550>>>        tAPITable         ApiTable ApiTableEmpty
47550>>>        tAPIColumn[]     aApiColumns
47550>>>        tAPIColumn[]     aApiColumns
47551>>>        tAPIIndex[]      aApiIndexes
47551>>>        tAPIIndex[]      aApiIndexes
47552>>>        tAPIRelation[]   aApiRelations
47552>>>        tAPIRelation[]   aApiRelations
47553>>>        Integer iCount iPos
47553>>>        Boolean bIsAlias bUserCancel bIsSQL bIsOpen
47553>>>        String sLogicalName sRootName sDisplayName sTableName sDriverID sMessageText
47553>>>
47553>>>        Open hTable
47555>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
47558>>>        If (bIsOpen = False) Begin
47560>>>            Move True to ApiTableEmpty.bError
47561>>>            Move hTable to ApiTableEmpty.ApiTableInfo.iTableNumber
47562>>>            Function_Return ApiTableEmpty
47563>>>        End
47563>>>>
47563>>>        
47563>>>        // Fill Table Name Info
47563>>>        Get UtilTableNameInfoStructFill hTable to ApiTableNameInfo
47564>>>                
47564>>>        // Fill columns
47564>>>        Get UtilColumnsStructFill hTable to aApiColumns
47565>>>        If (SizeOfArray(aApiColumns)) Begin
47567>>>            If (aApiColumns[0].bCancel = True) Begin
47569>>>                Move True to ApiTableEmpty.bError
47570>>>                Move hTable to ApiTableEmpty.ApiTableInfo.iTableNumber
47571>>>                Function_Return ApiTableEmpty
47572>>>            End
47572>>>>
47572>>>        End
47572>>>>
47572>>>        
47572>>>        // Fill indexes
47572>>>        Get UtilIndexesStructFill hTable to aApiIndexes
47573>>>        If (SizeOfArray(aApiIndexes)) Begin
47575>>>            If (aApiIndexes[0].bCancel = True) Begin
47577>>>                Move True to ApiTableEmpty.bError
47578>>>                Move hTable to ApiTableEmpty.ApiTableInfo.iTableNumber
47579>>>                Function_Return ApiTableEmpty
47580>>>            End
47580>>>>
47580>>>        End
47580>>>>
47580>>>        
47580>>>
47580>>>        // Fill relationships
47580>>>        Get UtilRelationsStructFill hTable to aApiRelations
47581>>>        If (SizeOfArray(aApiRelations)) Begin
47583>>>            If (aApiRelations[0].bCancel = True) Begin
47585>>>                Move True to ApiTableEmpty.bError
47586>>>                Move hTable to ApiTableEmpty.ApiTableInfo.iTableNumber
47587>>>                Function_Return ApiTableEmpty
47588>>>            End
47588>>>>
47588>>>        End
47588>>>>
47588>>>        
47588>>>        Move hTable             to ApiTable.hTable
47589>>>        Move bFromTables        to ApiTable.bFromTable
47590>>>        Move (not(bFromTables)) to ApiTable.bToTable   
47591>>>
47591>>>        Move ApiTableNameInfo   to ApiTable.ApiTableInfo
47592>>>        Move aApiColumns        to ApiTable.aApiColumns
47593>>>        Move aApiIndexes        to ApiTable.aApiIndexes
47594>>>        Move aApiRelations      to ApiTable.aApiRelations
47595>>>
47595>>>        Function_Return ApiTable
47596>>>    End_Function
47597>>>
47597>>>
47597>>>    Function UtilTableNameInfoStructFill Handle hTable Returns tAPITableNameInfo
47599>>>        tAPITableNameInfo APITableNameInfo APITableNameInfoEmpty                                      
47599>>>        tAPITableNameInfo APITableNameInfo APITableNameInfoEmpty                                      
47599>>>        Boolean bIsOpen
47599>>>        
47599>>>        Open hTable
47601>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
47604>>>        If (bIsOpen = False) Begin
47606>>>            Move True   to APITableNameInfoEmpty.bError
47607>>>            Move hTable to APITableNameInfoEmpty.iTableNumber
47608>>>            Function_Return APITableNameInfoEmpty
47609>>>        End
47609>>>>
47609>>>
47609>>>        Move hTable                                  to APITableNameInfo.iTableNumber
47610>>>        Get_Attribute DF_FILE_ROOT_NAME    of hTable to APITableNameInfo.sRootName
47613>>>        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to APITableNameInfo.sLogicalName
47616>>>        Get_Attribute DF_FILE_DISPLAY_NAME of hTable to APITableNameInfo.sDisplayName
47619>>>        Get_Attribute DF_FILE_DRIVER       of hTable to APITableNameInfo.sDriverID
47622>>>        
47622>>>        Get UtilTableIsAlias                  hTable to APITableNameInfo.bIsAlias
47623>>>        Get UtilTableIsSQL                    hTable to APITableNameInfo.bIsSQL
47624>>>
47624>>>        Close hTable
47625>>>
47625>>>        Function_Return APITableNameInfo
47626>>>    End_Function 
47627>>>    
47627>>>    Function UtilFindTableArrayItem tAPITable[] ByRef aTableStructure String sLogicalTableName Returns Integer
47629>>>        Integer iSize iCount iTable iItem
47629>>>        tAPITableNameInfo ApiTableNameInfo
47629>>>        tAPITableNameInfo ApiTableNameInfo
47629>>>
47629>>>        Move -1 to iItem
47630>>>        Move (SizeOfArray(aTableStructure)) to iSize
47631>>>        Decrement iSize
47632>>>        for iCount from 0 to iSize
47638>>>>
47638>>>            Move aTableStructure[iCount].ApiTableInfo to ApiTableNameInfo
47639>>>            If (Uppercase(ApiTableNameInfo.sLogicalName) = Uppercase(sLogicalTableName)) Begin
47641>>>                Move iCount to iItem
47642>>>                Move iSize  to iCount // We're done.
47643>>>            End
47643>>>>
47643>>>        Loop
47644>>>>
47644>>>
47644>>>        Function_Return iItem
47645>>>    End_Function
47646>>>
47646>>>    Function UtilTableArrayCompare tAPITable APITableFrom tAPITable APITableTo Returns Integer
47648>>>        If (APITableFrom.hTable  > APITableTo.hTable) ;            Function_Return (GT)
47651>>>        If (APITableFrom.hTable  < APITableTo.hTable) ;            Function_Return (LT)
47654>>>
47654>>>        If (APITableFrom.bFromTable = True)  ;            Function_Return (LT)
47657>>>        If (APITableFrom.bFromTable = False) ;            Function_Return (GT)
47660>>>
47660>>>        Function_Return (EQ)
47661>>>    End_Function
47662>>>
47662>>>    Function UtilTableCombineFromAndToArrays tAPITable[] aAPITableFrom tAPITable[] aAPITableTo Returns tAPITableCompare[]
47664>>>        Integer iCount iSize iSizeFrom iSizeTo iItemFrom iItemTo iItem
47664>>>        Handle hTable
47664>>>        tAPITable[] aAPITableFromAndTo aAPITableEmpty
47664>>>        tAPITable[] aAPITableFromAndTo aAPITableEmpty
47666>>>        tAPITable   APITableFrom APITableTo
47666>>>        tAPITable   APITableFrom APITableTo
47666>>>        tAPITableNameInfoCompare APITableNameInfoCompare
47666>>>        tAPITableNameInfoCompare APITableNameInfoCompare
47666>>>        tAPITableCompare[]    aAPITableCompare // This is the result set for this function
47666>>>        tAPITableCompare[]    aAPITableCompare // This is the result set for this function
47667>>>        tAPIColumnCompare[]   aAPIColumnCompare
47667>>>        tAPIColumnCompare[]   aAPIColumnCompare
47668>>>        tAPIIndexCompare[]    aAPIIndexCompare
47668>>>        tAPIIndexCompare[]    aAPIIndexCompare
47669>>>        tAPIRelationCompare[] aAPIRelationCompare
47669>>>        tAPIRelationCompare[] aAPIRelationCompare
47670>>>        tAPITableNameInfo ApiTableInfoEmpty ApiTableInfoFrom ApiTableInfoTo
47670>>>        tAPITableNameInfo ApiTableInfoEmpty ApiTableInfoFrom ApiTableInfoTo
47670>>>        tAPIColumn[]   aApiColumnsEmpty aApiColumnsFrom aApiColumnsTo
47670>>>        tAPIColumn[]   aApiColumnsEmpty aApiColumnsFrom aApiColumnsTo
47673>>>        tAPIIndex[]    aApiIndexEmpty aApiIndexFrom aApiIndexTo
47673>>>        tAPIIndex[]    aApiIndexEmpty aApiIndexFrom aApiIndexTo
47676>>>        tAPIRelation[] aApiRelationEmpty aApiRelationFrom aApiRelationTo
47676>>>        tAPIRelation[] aApiRelationEmpty aApiRelationFrom aApiRelationTo
47679>>>
47679>>>        Move (SizeOfArray(aAPITableFrom)) to iSizeFrom
47680>>>        Move (SizeOfArray(aAPITableTo))   to iSizeTo
47681>>>        If (iSizeFrom = 0 and iSizeTo = 0) Begin
47683>>>            Function_Return aAPITableCompare
47684>>>        End
47684>>>>
47684>>>
47684>>>        Move (AppendArray(aAPITableFrom, aAPITableTo)) to aAPITableFromAndTo
47685>>>        Move (SortArray(aAPITableFromAndTo, Self, RefFunc(UtilTableArrayCompare))) to aAPITableFromAndTo
47686>>>
47686>>>        Move 0 to iItem
47687>>>        Move (SizeOfArray(aAPITableFromAndTo)) to iSize
47688>>>        Decrement iSize
47689>>>        for iCount from 0 to iSize
47695>>>>
47695>>>
47695>>>            Move iCount to iItemFrom
47696>>>            Move iCount to iItemTo
47697>>>            Move aAPITableEmpty to APITableFrom
47698>>>            Move aAPITableEmpty to APITableTo
47699>>>
47699>>>            If (aAPITableFromAndTo[iCount].bFromTable = True) Begin
47701>>>                Move aAPITableFromAndTo[iCount]     to APITableFrom
47702>>>            End
47702>>>>
47702>>>            If (aAPITableFromAndTo[iCount].bToTable = True) Begin
47704>>>                Move aAPITableFromAndTo[iCount]     to APITableTo
47705>>>            End
47705>>>>
47705>>>            If (aAPITableFromAndTo[iCount].hTable = aAPITableFromAndTo[iCount + 1].hTable) Begin
47707>>>                Move aAPITableFromAndTo[iCount]     to APITableFrom
47708>>>                Move (iCount + 1) to iItemTo
47709>>>                Move aAPITableFromAndTo[iItemTo]    to APITableTo
47710>>>            End
47710>>>>
47710>>>
47710>>>            Move APITableFrom.ApiTableInfo  to ApiTableInfoFrom
47711>>>            Move APITableFrom.aApiColumns   to aApiColumnsFrom
47712>>>            Move APITableFrom.aApiIndexes   to aApiIndexFrom
47713>>>            Move APITableFrom.aApiRelations to aApiRelationFrom
47714>>>
47714>>>            Move APITableTo.ApiTableInfo    to ApiTableInfoTo
47715>>>            Move APITableTo.aApiColumns     to aApiColumnsTo
47716>>>            Move APITableTo.aApiIndexes     to aApiIndexTo
47717>>>            Move APITableTo.aApiRelations   to aApiRelationTo
47718>>>
47718>>>            Move aAPITableFromAndTo[iCount].hTable to hTable
47719>>>
47719>>>            If (hTable > 0) Begin
47721>>>
47721>>>                // Table info:
47721>>>                Get UtilTableINFOCombineFromAndToArrays ApiTableInfoFrom ApiTableInfoTo to APITableNameInfoCompare
47722>>>                Move APITableNameInfoCompare.iTableNumber                               to aAPITableCompare[iItem].hTable
47723>>>                Move APITableNameInfoCompare.bExistsFrom                                to aAPITableCompare[iItem].bExistsFrom
47724>>>                Move APITableNameInfoCompare.bExistsTo                                  to aAPITableCompare[iItem].bExistsTo
47725>>>                Move APITableNameInfoCompare                                            to aAPITableCompare[iItem].APITableNameInfoCompare
47726>>>
47726>>>                // Column info:
47726>>>                Get UtilColumnCombineFromAndToArrays aApiColumnsFrom aApiColumnsTo      to aAPIColumnCompare
47727>>>                Move aAPIColumnCompare                                                  to aAPITableCompare[iItem].aAPIColumnsCompare
47728>>>
47728>>>                // Index info:
47728>>>                Get UtilIndexCombineFromAndToArrays aApiIndexFrom aApiIndexTo           to aAPIIndexCompare
47729>>>                Move aAPIIndexCompare                                                   to aAPITableCompare[iItem].aAPIIndexesCompare
47730>>>
47730>>>                // Relation info:
47730>>>                Get UtilRelationCombineFromAndToArrays aApiRelationFrom aApiRelationTo  to aAPIRelationCompare
47731>>>                Move aAPIRelationCompare                                                to aAPITableCompare[iItem].aAPIRelationsCompare
47732>>>
47732>>>                Move False                                                              to aAPITableCompare[iItem].bShouldChange
47733>>>                Move False                                                              to aAPITableCompare[iItem].bCancel
47734>>>                Move False                                                              to aAPITableCompare[iItem].bError
47735>>>                If (iItemTo > iItemFrom) Begin
47737>>>                    Increment iCount
47738>>>                End
47738>>>>
47738>>>                Increment iItem
47739>>>            End
47739>>>>
47739>>>
47739>>>        Loop
47740>>>>
47740>>>
47740>>>        Function_Return aAPITableCompare
47741>>>    End_Function
47742>>>
47742>>>    Function UtilTableInfoCombineFromAndToArrays tAPITableNameInfo APITableNameInfoFrom tAPITableNameInfo APITableNameInfoTo Returns tAPITableNameInfoCompare
47744>>>        tAPITableNameInfoCompare APITableNameInfoCompare
47744>>>        tAPITableNameInfoCompare APITableNameInfoCompare
47744>>>
47744>>>        // FROM database info:
47744>>>        If (APITableNameInfoFrom.iTableNumber > 0) Begin
47746>>>            Move APITableNameInfoFrom.iTableNumber  to APITableNameInfoCompare.iTableNumber
47747>>>            Move APITableNameInfoFrom.sRootName     to APITableNameInfoCompare.sRootNameFrom
47748>>>            Move APITableNameInfoFrom.sLogicalName  to APITableNameInfoCompare.sLogicalNameFrom
47749>>>            Move APITableNameInfoFrom.sDisplayName  to APITableNameInfoCompare.sDisplayNameFrom
47750>>>            Move APITableNameInfoFrom.sDriverID     to APITableNameInfoCompare.sDriverIDFrom
47751>>>            Move APITableNameInfoFrom.bIsAlias      to APITableNameInfoCompare.bIsAliasFrom
47752>>>            Move APITableNameInfoFrom.bIsSQL        to APITableNameInfoCompare.bIsSQLFrom
47753>>>            Move True                               to APITableNameInfoCompare.bExistsFrom
47754>>>        End
47754>>>>
47754>>>
47754>>>        // TO database info:
47754>>>        If (APITableNameInfoTo.iTableNumber > 0) Begin
47756>>>            Move APITableNameInfoTo.iTableNumber    to APITableNameInfoCompare.iTableNumber
47757>>>            Move APITableNameInfoTo.sRootName       to APITableNameInfoCompare.sRootNameTo
47758>>>            Move APITableNameInfoTo.sLogicalName    to APITableNameInfoCompare.sLogicalNameTo
47759>>>            Move APITableNameInfoTo.sDisplayName    to APITableNameInfoCompare.sDisplayNameTo
47760>>>            Move APITableNameInfoTo.sDriverID       to APITableNameInfoCompare.sDriverIDTo
47761>>>            Move APITableNameInfoTo.bIsAlias        to APITableNameInfoCompare.bIsAliasTo
47762>>>            Move APITableNameInfoTo.bIsSQL          to APITableNameInfoCompare.bIsSQLTo
47763>>>            Move True                               to APITableNameInfoCompare.bExistsTo
47764>>>        End
47764>>>>
47764>>>
47764>>>        Function_Return APITableNameInfoCompare
47765>>>    End_Function
47766>>>
47766>>>    // Note:
47766>>>    // The DF_FILE_TABLE_NAME attribute holds the name of the table at the back end. Depending on the back end, table
47766>>>    // names may be case sensitive, contain spaces or other special characters. This attribute is used to determine a table's
47766>>>    // back end name when using Embedded SQL. Since Embedded SQL works on the back end directly, the back end's name must be used.
47766>>>    // In most cases the back end name will be the same as the table name used in DataFlex.
47766>>>    // To do the opposite; To get the file handle from a table name string use the UtilTableNameToHandle function.
47766>>>    Function UtilTableHandleToString Handle hTable Returns String
47768>>>        String sTableName
47768>>>        Boolean bOpen bExists bOK
47768>>>
47768>>>        Get UtilTableNumberIsInUse hTable to bExists
47769>>>        If (bExists = False) Begin
47771>>>            Function_Return ""
47772>>>        End
47772>>>>
47772>>>
47772>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
47773>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
47776>>>        If (bOpen = False) Begin
47778>>>            Get AutoConnectionIDLogin to bOK
47779>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
47780>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_INTERMEDIATE_FILE
47781>>>            Send Ignore_Error of Error_Object_Id CLIERR_GENERAL_ERROR
47782>>>            Open hTable
47784>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
47785>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_INTERMEDIATE_FILE
47786>>>            Send Trap_Error of Error_Object_Id CLIERR_GENERAL_ERROR
47787>>>            Get_Attribute DF_FILE_OPENED of hTable to bOpen
47790>>>        End
47790>>>>
47790>>>        If (bOpen = True) Begin
47792>>>            Send Ignore_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
47793>>>            Get_Attribute DF_FILE_TABLE_NAME of hTable to sTableName
47796>>>            // If blank it is an embedded table:
47796>>>            If (sTableName = "") Begin
47798>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
47801>>>                Move 0 to LastErr
47802>>>                Move False to Err
47803>>>            End
47803>>>>
47803>>>            Send Trap_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
47804>>>        End
47804>>>>
47804>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
47805>>>
47805>>>        Function_Return sTableName
47806>>>    End_Function
47807>>>
47807>>>    // Returns the filenumber for the passed Table name from Filelist.cfg.
47807>>>    // Returns 0 if unsuccessful.
47807>>>    // To do the opposite; To get the string value from a table handle string use the UtilTableHandleToString function.
47807>>>    Function UtilTableNameToHandle String sTableName Returns Integer
47809>>>        String sValue sPrefixTableName sDriverID
47809>>>        Handle hTable hRetval
47809>>>
47809>>>        Get psDriverID to sDriverID
47810>>>        If (sDriverID <> DATAFLEX_ID and not(sTableName contains ":")) Begin
47812>>>            Move (sDriverID + ":" + sTableName) to sPrefixTableName
47813>>>        End
47813>>>>
47813>>>        Move 0 to hTable
47814>>>        Move 0 to hRetval
47815>>>        Repeat
47815>>>>
47815>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
47818>>>            If (hTable <> 0) Begin
47820>>>                Get_Attribute DF_FILE_ROOT_NAME of hTable to sValue
47823>>>                If (Uppercase(sValue) = Uppercase(sTableName) or Uppercase(sValue) = Uppercase(sPrefixTableName)) Begin
47825>>>                    Move hTable to hRetval
47826>>>                    Move 0 to hTable
47827>>>                End
47827>>>>
47827>>>            End
47827>>>>
47827>>>        Until (hTable = 0)
47829>>>
47829>>>        Function_Return hRetval
47830>>>    End_Function
47831>>>
47831>>>    // * Dummy function for the Studio's Code Explorer *
47831>>>    Function API_COLUMN_UTILITY_FUNCTIONS Returns Boolean
47833>>>        Function_Return False
47834>>>    End_Function
47835>>>
47835>>>    // Compare multiple columns. (For 'FROM' & 'TO' tables)
47835>>>    Function UtilColumnsCompare String sDriverIDFrom String sDriverIDTo Boolean bIsSQLFrom Boolean bIsSQLTo tAPIColumnCompare[] aAPIColumnCompare Boolean bCompareDate_DataTime Returns Boolean
47837>>>        Boolean bIsSame
47837>>>        Integer iCount iSize iColumn
47837>>>
47837>>>        Move True to bIsSame
47838>>>        Move (SizeOfArray(aAPIColumnCompare)) to iSize
47839>>>        Set piMaximum of ghoProgressBar  to iSize
47840>>>
47840>>>        Decrement iSize
47841>>>        for iCount from 0 to iSize
47847>>>>
47847>>>            Set piPosition of ghoProgressBar to iCount
47848>>>            Get UtilColumnCompare sDriverIDFrom sDriverIDTo bIsSQLFrom bIsSQLTo aAPIColumnCompare[iCount] bCompareDate_DataTime to bIsSame
47849>>>            If (bIsSame = False) Begin
47851>>>                Function_Return False
47852>>>            End
47852>>>>
47852>>>        Loop
47853>>>>
47853>>>
47853>>>        Function_Return (bIsSame = True)
47854>>>    End_Function
47855>>>
47855>>>    // Compares a single column (For 'FROM' & 'TO' tables)
47855>>>    Function UtilColumnCompare String sDriverIDFrom String sDriverIDTo Boolean bIsSQLFrom Boolean bIsSQLTo tAPIColumnCompare APIColumnCompare Boolean bCompareDate_DataTime Returns Boolean
47857>>>        Integer iFromType iToType iDbType
47857>>>        tColumnType ColumnType 
47857>>>        tColumnType ColumnType 
47857>>>        Boolean bIsDateTypeFrom bIsDateTypeTo
47857>>>        
47857>>>        If (APIColumnCompare.bCancelFrom = True or APIColumnCompare.bCancelTo = True) Begin
47859>>>            Function_Return False
47860>>>        End
47860>>>>
47860>>>        If (APIColumnCompare.bExistsFrom = False or APIColumnCompare.bExistsTo = False) Begin
47862>>>            Function_Return False
47863>>>        End
47863>>>>
47863>>>        If (Uppercase(APIColumnCompare.sFieldNameFrom) <> Uppercase(APIColumnCompare.sFieldNameTo)) Begin
47865>>>            Function_Return False
47866>>>        End  
47866>>>>
47866>>>        If (APIColumnCompare.bAllowNULLFrom <> APIColumnCompare.bAllowNULLTo) Begin
47868>>>            Function_Return False
47869>>>        End                      
47869>>>>
47869>>>        If (APIColumnCompare.sDefaultValueFrom <> APIColumnCompare.sDefaultValueTo) Begin
47871>>>            Function_Return False
47872>>>        End                      
47872>>>>
47872>>>
47872>>>        Get piDbType                       to iDbType
47873>>>        Move APIColumnCompare.iTypeFrom    to iFromType
47874>>>        Move APIColumnCompare.iTypeTo      to iToType 
47875>>>
47875>>>        // If one of the two tables are SQL and the other Embedded we need to "translate"
47875>>>        // data types between Embedded and SQL.
47875>>>        If (bIsSQLFrom = True and bIsSQLTo = False) Begin
47877>>>            Get UtilSQLColumnTypeToDataFlexType sDriverIDFrom iDbType iFromType APIColumnCompare.iLengthFrom to iFromType
47878>>>        End
47878>>>>
47878>>>        If (bIsSQLFrom = False and bIsSQLTo = True) Begin
47880>>>            Get UtilSQLColumnTypeToDataFlexType sDriverIDTo iDbType iToType APIColumnCompare.iLengthTo to iToType
47881>>>        End
47881>>>>
47881>>>
47881>>>        Get UtilColumnIsDateType iFromType bIsSQLFrom to bIsDateTypeFrom
47882>>>        Get UtilColumnIsDateType iToType   bIsSQLTo   to bIsDateTypeTo
47883>>>
47883>>>        // Make Date and DateTime comparison?
47883>>>        If (bCompareDate_DataTime = True) Begin
47885>>>            If (iFromType <> iToType) Begin
47887>>>                Function_Return False
47888>>>            End
47888>>>>
47888>>>        End
47888>>>>
47888>>>
47888>>>        // This is when not checking for Date/DateTime differences but all other other field types...
47888>>>        If (bCompareDate_DataTime = False and bIsDateTypeFrom = False) Begin
47890>>>            If (iFromType <> iToType) Begin
47892>>>                Function_Return False
47893>>>            End
47893>>>>
47893>>>        End
47893>>>>
47893>>>
47893>>>        // Only if the field is not a Date type (any of them) we compare length & precision.
47893>>>        If (bIsDateTypeFrom = False) Begin
47895>>>            If (APIColumnCompare.iLengthFrom <> APIColumnCompare.iLengthTo) Begin
47897>>>                Function_Return False
47898>>>            End
47898>>>>
47898>>>            If (APIColumnCompare.iPrecisionFrom <> APIColumnCompare.iPrecisionTo) Begin
47900>>>                Function_Return False
47901>>>            End
47901>>>>
47901>>>        End
47901>>>>
47901>>>
47901>>>        If (APIColumnCompare.iOptionsFrom <> APIColumnCompare.iOptionsTo) Begin
47903>>>            Function_Return False
47904>>>        End
47904>>>>
47904>>>
47904>>>        Function_Return True
47905>>>    End_Function
47906>>>
47906>>>    Function UtilColumnsStructFill Handle hTable Returns tAPIColumn[]
47908>>>        Integer iNumColumns iColumn iCount iOptions iDbType iType iLength iPrecision iCheckFieldNumber
47908>>>        Boolean bIdentityKey bDawSqlDriver bSqlDriver bIsOpen bExists bIsSqlTable bUserCancel bState
47908>>>        tAPIColumn[] APIColumns APIColumnsEmpty
47908>>>        tAPIColumn[] APIColumns APIColumnsEmpty
47910>>>        String sDriverID sFieldName sRootName sLogicalName sValue
47910>>>
47910>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
47911>>>        Get piDbType to iDbType
47912>>>        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
47915>>>        Get_Attribute DF_FILE_ROOT_NAME    of hTable to sRootName
47918>>>
47918>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
47921>>>        If (bIsOpen = False) Begin
47923>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
47924>>>            Open hTable
47926>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
47927>>>            Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
47930>>>            If (bIsOpen = False) Begin
47932>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
47933>>>                Move True to APIColumnsEmpty[0].bError
47934>>>                Function_Return APIColumnsEmpty
47935>>>            End
47935>>>>
47935>>>        End
47935>>>>
47935>>>
47935>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
47938>>>        Get IsSQLDriver    sDriverID to bSqlDriver
47939>>>        Get IsDAWSQLDriver sDriverID to bDawSqlDriver
47940>>>
47940>>>        Get UtilTableIsSQLByRootName sRootName to bIsSqlTable
47941>>>        If (bIsSqlTable = True) Begin
47943>>>            Get UtilTableExists hTable to bExists
47944>>>            If (bExists = False) Begin
47946>>>                Move True to APIColumnsEmpty[0].bError
47947>>>                Function_Return APIColumnsEmpty
47948>>>            End
47948>>>>
47948>>>        End
47948>>>>
47948>>>
47948>>>        Move 0 to iCount
47949>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumColumns
47952>>>        Set piMaximum of ghoProgressBar to iNumColumns
47953>>>
47953>>>        for iColumn from 1 to iNumColumns
47959>>>>
47959>>>            Move 0 to iOptions
47960>>>            Move False to bIdentityKey
47961>>>            Move False to Err
47962>>>            Move 0     to LastErr
47963>>>            Move bIsSqlTable to APIColumns[iCount].bIsSQLType
47964>>>            Set piPosition of ghoProgressBar to iColumn
47965>>>            If (bDawSqlDriver = True) Begin
47967>>>                Send Ignore_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
47968>>>                If (bIsSqlTable = True) Begin
47970>>>                    Get_Attribute DF_FIELD_NATIVE_TYPE      of hTable iColumn to iType
47973>>>                    Move iType                                                to APIColumns[iCount].iType
47974>>>                    Get_Attribute DF_FIELD_NATIVE_TYPE_NAME of hTable iColumn to APIColumns[iCount].sType
47977>>>                    Get_Attribute DF_FIELD_NULL_ALLOWED     of hTable iColumn to APIColumns[iCount].bAllowNULL
47980>>>                    Get_Attribute DF_FIELD_DEFAULT_VALUE    of hTable iColumn to APIColumns[iCount].sDefaultValue 
47983>>>                End
47983>>>>
47983>>>                Else Begin
47984>>>                    Get_Attribute DF_FIELD_TYPE             of hTable iColumn to APIColumns[iCount].iType
47987>>>                    Get UtilColumnTypeToString sDriverID iDbType APIColumns[iCount].iType to APIColumns[iCount].sType
47988>>>                End
47988>>>>
47988>>>
47988>>>                // If the array value is out of bounce it means that this column doesn't exist on the backend.
47988>>>                Get_Attribute DF_Field_Number of hTable iColumn to iCheckFieldNumber
47991>>>                Move (iCheckFieldNumber >= 0) to bExists
47992>>>                If (bExists = False) Begin
47994>>>                    Move 0 to APIColumns[iCount].iType
47995>>>                End
47995>>>>
47995>>>                If (bExists = True) Begin
47997>>>                    Get_Attribute DF_FIELD_IS_IDENTITY of hTable iColumn to bIdentityKey
48000>>>                End
48000>>>>
48000>>>                Send Trap_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
48001>>>                If (bIdentityKey = True) Begin
48003>>>                    Move C_tAPIColumn_Identity to APIColumns[iCount].iOptions
48004>>>                End
48004>>>>
48004>>>            End
48004>>>>
48004>>>            Else Begin
48005>>>                Move False to Err
48006>>>                Move 0     to LastErr
48007>>>                If (bIsSqlTable = True) Begin
48009>>>                    Get_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to APIColumns[iCount].iType
48012>>>                End
48012>>>>
48012>>>                Else Begin
48013>>>                    Get_Attribute DF_FIELD_TYPE        of hTable iColumn to APIColumns[iCount].iType
48016>>>                    Get UtilColumnTypeToString sDriverID iDbType APIColumns[iCount].iType to APIColumns[iCount].sType
48017>>>                End
48017>>>>
48017>>>                // If the array value is out of bounce it means that this column doesn't exist on the backend.
48017>>>                Move (LastErr <> DFERR_ARRAY_INDEX_OUT_OF_BOUNDS) to bExists
48018>>>                If (bExists = False) Begin
48020>>>                    Move 0 to APIColumns[iCount].iType
48021>>>                End
48021>>>>
48021>>>            End
48021>>>>
48021>>>
48021>>>            If (bExists = True) Begin
48023>>>                Move iColumn to APIColumns[iCount].iFieldNumber
48024>>>                Get_Attribute DF_FIELD_NAME        of hTable iColumn to APIColumns[iCount].sFieldName
48027>>>                // ToDo: Can't use native_size as it can get way to big and causes "out of memory" problems.
48027>>>//                If (bIsSqlTable = True) Begin
48027>>>//                    Get_Attribute DF_FIELD_NATIVE_SIZE of hTable iColumn to APIColumns[iCount].iLength
48027>>>//                    Get_Attribute DF_FIELD_PRECISION   of hTable iColumn to APIColumns[iCount].iPrecision
48027>>>//                End
48027>>>                Get_Attribute DF_FIELD_LENGTH      of hTable iColumn to APIColumns[iCount].iLength
48030>>>                Get_Attribute DF_FIELD_PRECISION   of hTable iColumn to APIColumns[iCount].iPrecision
48033>>>
48033>>>                // If the length was zero we might have an Overlap(!) field.
48033>>>                // We then need check the DF_FIELD_TYPE if it really is and reset data for this array item.
48033>>>                If (APIColumns[iCount].iLength = 0) Begin
48035>>>                    Get_Attribute DF_FIELD_TYPE    of hTable iColumn to iType
48038>>>                    If (iType = DF_OVERLAP) Begin
48040>>>                        Move 0 to APIColumns[iCount].iFieldNumber
48041>>>                        Move 0 to APIColumns[iCount].iLength
48042>>>                        Move 0 to APIColumns[iCount].iOptions
48043>>>                        Move 0 to APIColumns[iCount].iPrecision
48044>>>                        Move DF_OVERLAP to APIColumns[iCount].iType
48045>>>                        Move "" to APIColumns[iCount].sFieldName
48046>>>                        Decrement iCount
48047>>>                    End
48047>>>>
48047>>>                End
48047>>>>
48047>>>            End
48047>>>>
48047>>>            Get Check_StatusPanel of ghoStatusPanel to bUserCancel
48048>>>            If (bUserCancel = True) Begin
48050>>>                Move True to APIColumnsEmpty[0].bCancel
48051>>>                Function_Return APIColumnsEmpty
48052>>>            End
48052>>>>
48052>>>            Increment iCount
48053>>>        Loop
48054>>>>
48054>>>
48054>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48055>>>        Function_Return APIColumns
48056>>>    End_Function
48057>>>
48057>>>    // This will return a struct array with the combined data for the passed FROM and TO index arrays.
48057>>>    // The combined data will be sorted on the first struct member: iIndexNumber
48057>>>    // This is needed because index numbers can start at any number. The range for a particular table might also
48057>>>    // have "holes" in the series of index numbers.
48057>>>    Function UtilColumnCombineFromAndToArrays tAPIColumn[] APIColumnFrom tAPIColumn[] APIColumnTo Returns tAPIIndexCompare[]
48059>>>        tAPIColumnCompare[] aAPIColumnCompare
48059>>>        tAPIColumnCompare[] aAPIColumnCompare
48060>>>        tAPIColumnCompare   APIColumnCompare
48060>>>        tAPIColumnCompare   APIColumnCompare
48060>>>        Integer iSizeFrom iSizeTo iSize iCount iItem iColumnFrom iColumnTo
48060>>>
48060>>>        Move (SizeOfArray(APIColumnFrom)) to iSizeFrom
48061>>>        Decrement iSizeFrom
48062>>>        for iCount from 0 to iSizeFrom
48068>>>>
48068>>>            Move APIColumnFrom[iCount].iFieldNumber     to aAPIColumnCompare[iCount].iFieldNumber
48069>>>            Move APIColumnFrom[iCount].sFieldName       to aAPIColumnCompare[iCount].sFieldNameFrom
48070>>>            Move APIColumnFrom[iCount].iType            to aAPIColumnCompare[iCount].iTypeFrom
48071>>>            Move APIColumnFrom[iCount].sType            to aAPIColumnCompare[iCount].sTypeFrom
48072>>>            Move APIColumnFrom[iCount].iLength          to aAPIColumnCompare[iCount].iLengthFrom
48073>>>            Move APIColumnFrom[iCount].iPrecision       to aAPIColumnCompare[iCount].iPrecisionFrom
48074>>>            Move APIColumnFrom[iCount].iOptions         to aAPIColumnCompare[iCount].iOptionsFrom
48075>>>            Move APIColumnFrom[iCount].bIsSQLType       to aAPIColumnCompare[iCount].bIsSQLTypeFrom  
48076>>>            Move APIColumnFrom[iCount].bAllowNULL       to aAPIColumnCompare[iCount].bAllowNULLFrom
48077>>>            Move APIColumnFrom[iCount].sDefaultValue    to aAPIColumnCompare[iCount].sDefaultValueFrom
48078>>>            Move APIColumnFrom[iCount].bShouldChange    to aAPIColumnCompare[iCount].bShouldChangeFrom
48079>>>            Move APIColumnFrom[iCount].bCancel          to aAPIColumnCompare[iCount].bCancelFrom
48080>>>            Move APIColumnFrom[iCount].bError           to aAPIColumnCompare[iCount].bErrorFrom
48081>>>            Move True                                   to aAPIColumnCompare[iCount].bExistsFrom
48082>>>        Loop
48083>>>>
48083>>>
48083>>>        Move (SizeOfArray(APIColumnTo)) to iSizeTo
48084>>>        Decrement iSizeTo
48085>>>        for iCount from 0 to iSizeTo
48091>>>>
48091>>>            Move APIColumnTo[iCount].iFieldNumber       to APIColumnCompare.iFieldNumber
48092>>>            // Search if the field number already exists in the array; else add it.
48092>>>            Move (SearchArray(APIColumnCompare, aAPIColumnCompare)) to iItem
48093>>>            If (iItem = -1) Begin
48095>>>                Move (SizeOfArray(aAPIColumnCompare))   to iItem
48096>>>            End
48096>>>>
48096>>>
48096>>>            Move APIColumnCompare.iFieldNumber          to aAPIColumnCompare[iItem].iFieldNumber
48097>>>            Move APIColumnTo[iCount].iFieldNumber       to aAPIColumnCompare[iItem].iFieldNumberTo
48098>>>            Move APIColumnTo[iCount].sFieldName         to aAPIColumnCompare[iItem].sFieldNameTo
48099>>>            Move APIColumnTo[iCount].iType              to aAPIColumnCompare[iItem].iTypeTo
48100>>>            Move APIColumnTo[iCount].sType              to aAPIColumnCompare[iItem].sTypeTo
48101>>>            Move APIColumnTo[iCount].iLength            to aAPIColumnCompare[iItem].iLengthTo
48102>>>            Move APIColumnTo[iCount].iPrecision         to aAPIColumnCompare[iItem].iPrecisionTo
48103>>>            Move APIColumnTo[iCount].iOptions           to aAPIColumnCompare[iItem].iOptionsTo
48104>>>            Move APIColumnTo[iCount].bIsSQLType         to aAPIColumnCompare[iItem].bIsSQLTypeTo
48105>>>            Move APIColumnTo[iCount].bAllowNULL         to aAPIColumnCompare[iItem].bAllowNULLTo
48106>>>            Move APIColumnTo[iCount].sDefaultValue      to aAPIColumnCompare[iItem].sDefaultValueTo
48107>>>            Move APIColumnTo[iCount].bShouldChange      to aAPIColumnCompare[iItem].bShouldChangeTo
48108>>>            Move APIColumnTo[iCount].bCancel            to aAPIColumnCompare[iItem].bCancelTo
48109>>>            Move APIColumnTo[iCount].bError             to aAPIColumnCompare[iItem].bErrorTo
48110>>>            Move True                                   to aAPIColumnCompare[iItem].bExistsTo
48111>>>        Loop
48112>>>>
48112>>>
48112>>>        Move (SortArray(aAPIColumnCompare)) to aAPIColumnCompare
48113>>>
48113>>>        Function_Return aAPIColumnCompare
48114>>>    End_Function
48115>>>
48115>>>    // Checks if a field name exists in a table definition
48115>>>    // Returns True if it does
48115>>>    // Sample:
48115>>>    //   Get UtilColumnExists MyTable.File_Number "MyColumnName" to iExists
48115>>>    Function UtilColumnExists Handle hTable String sFieldName Returns Boolean
48117>>>        Integer iNumColumns iColumn
48117>>>        String sColumn
48117>>>        Boolean bExists bOK bOpen
48117>>>
48117>>>        Get AutoConnectionIDLogin to bOK
48118>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48119>>>        Open hTable
48121>>>        Send Trap_Error   of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48122>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
48125>>>        If (bOpen = False) Begin
48127>>>            Function_Return False
48128>>>        End
48128>>>>
48128>>>
48128>>>        Move False to bExists
48129>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumColumns
48132>>>        for iColumn from 1 to iNumColumns
48138>>>>
48138>>>            Get_Attribute DF_FIELD_NAME of hTable iColumn to sColumn
48141>>>            If (Uppercase(sFieldName) = Uppercase(sColumn)) Begin
48143>>>                Move iNumColumns to iColumn
48144>>>                Move True to bExists
48145>>>            End
48145>>>>
48145>>>        Loop
48146>>>>
48146>>>        Close hTable
48147>>>
48147>>>        Function_Return bExists
48148>>>    End_Function
48149>>>
48149>>>    // Returns the field/column number for the passed FieldName as an integer.
48149>>>    Function UtilColumnNameToColumnNumber Handle hTable String sFieldName Returns Integer
48151>>>        Integer iNumColumns iColumn iRetval
48151>>>        String sColumn
48151>>>        Boolean bOK bOpen
48151>>>
48151>>>        Get AutoConnectionIDLogin to bOK
48152>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48153>>>        Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48154>>>        Open hTable
48156>>>        Send Trap_Error   of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48157>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
48160>>>        If (bOpen = False) Begin
48162>>>            Set Error_Report_Mode to DUF_ERROR_REPORT
48163>>>            Function_Return False
48164>>>        End
48164>>>>
48164>>>
48164>>>        Move 0 to iColumn
48165>>>        Move 0 to iRetval
48166>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumColumns
48169>>>        for iColumn from 1 to iNumColumns
48175>>>>
48175>>>            Get_Attribute DF_FIELD_NAME of hTable iColumn to sColumn
48178>>>            If (Uppercase(sFieldName) = Uppercase(sColumn)) Begin
48180>>>                Move iColumn to iRetval
48181>>>                Move iNumColumns to iColumn
48182>>>            End
48182>>>>
48182>>>        Loop
48183>>>>
48183>>>        Close hTable
48184>>>
48184>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48185>>>        Function_Return iRetval
48186>>>    End_Function
48187>>>
48187>>>    // To convert between a data type string name and its integer constant declaration. E.g."VarChar" -> SQL_VarChar
48187>>>    // The reciprocal function is UtilColumnTypeToInteger.
48187>>>    Function UtilColumnTypeToInteger String sDriverID Integer iDbType String sDataType Returns Integer
48189>>>        tColumnType RetvalType
48189>>>        tColumnType RetvalType
48189>>>
48189>>>        Get _UtilColumnType sDriverID iDbType 0 sDataType False to RetvalType
48190>>>        Function_Return RetvalType.iSQLType
48191>>>    End_Function
48192>>>
48192>>>    // To convert between an integer data type constant and its string value. E.g. SQL_VarChar -> "VarChar".
48192>>>    // The reciprocal function is UtilColumnTypeToString.
48192>>>    Function UtilColumnTypeToString String sDriverID Integer iDbType Integer iDataType Returns String
48194>>>        tColumnType RetvalType
48194>>>        tColumnType RetvalType
48194>>>
48194>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
48195>>>        Function_Return RetvalType.sSQLType
48196>>>    End_Function
48197>>>
48197>>>    Function UtilColumnTypePrecision String sDriverID Integer iDbType Integer iDataType Returns String
48199>>>        tColumnType RetvalType
48199>>>        tColumnType RetvalType
48199>>>
48199>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
48200>>>        Function_Return RetvalType.sPrecision
48201>>>    End_Function
48202>>>
48202>>>    Function UtilColumnTypeFixed String sDriverID Integer iDbType Integer iDataType Returns Boolean
48204>>>        tColumnType RetvalType
48204>>>        tColumnType RetvalType
48204>>>
48204>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
48205>>>        Function_Return RetvalType.bCanEditSize
48206>>>    End_Function
48207>>>
48207>>>    Function UtilColumnTypePrecisionSize String sDriverID Integer iDbType Integer iDataType Returns Integer
48209>>>        tColumnType RetvalType
48209>>>        tColumnType RetvalType
48209>>>        String sValue
48209>>>        Integer iRetval iPos
48209>>>
48209>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
48210>>>        Move RetvalType.sPrecision to sValue
48211>>>        Move (Pos(".", sValue)) to iPos
48212>>>        If (iPos <> 0) Begin
48214>>>            Move (Left(sValue, (iPos -1))) to iRetval
48215>>>        End
48215>>>>
48215>>>        Else Begin
48216>>>            Move sValue to iRetval
48217>>>        End
48217>>>>
48217>>>        Function_Return iRetval
48218>>>    End_Function
48219>>>
48219>>>    Function UtilColumnTypePrecisionDec String sDriverID Integer iDbType Integer iDataType Returns Integer
48221>>>        tColumnType RetvalType
48221>>>        tColumnType RetvalType
48221>>>        String sValue
48221>>>        Integer iRetval iPos
48221>>>
48221>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
48222>>>        Move RetvalType.sPrecision to sValue
48223>>>        Move (Pos(".", sValue)) to iPos
48224>>>        If (iPos = 0) Begin
48226>>>            Function_Return 0
48227>>>        End
48227>>>>
48227>>>        Move (Mid(sValue, 99, (iPos + 1))) to iRetval
48228>>>
48228>>>        Function_Return iRetval
48229>>>    End_Function
48230>>>
48230>>>    // * Dummy function for the Studio's Code Explorer *
48230>>>    Function API_INDEX_UTILITY_FUNCTIONS Returns Boolean
48232>>>        Function_Return False
48233>>>    End_Function
48234>>>
48234>>>    // Compares multiple indexes for a 'FROM' and a 'TO' table.
48234>>>    Function UtilIndexesCompare Boolean bIsSQLTableFrom Boolean bIsSQLTableTo tAPIIndexCompare[] aAPIIndexCompare Boolean bCompareIndexUppercase Boolean bCompareIndexAscending Returns Boolean
48236>>>        Boolean bIsSame
48236>>>        Integer iCount iSize
48236>>>
48236>>>        Move True to bIsSame
48237>>>        Move (SizeOfArray(aAPIIndexCompare)) to iSize
48238>>>        Decrement iSize
48239>>>        For iCount from 0 to iSize
48245>>>>
48245>>>            Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48246>>>            Get UtilIndexCompare bIsSQLTableFrom bIsSQLTableTo aAPIIndexCompare[iCount] bCompareIndexUppercase bCompareIndexAscending to bIsSame
48247>>>            Set Error_Report_Mode to DUF_ERROR_REPORT
48248>>>            If (bIsSame = False) Begin
48250>>>                Function_Return False
48251>>>            End
48251>>>>
48251>>>        Loop
48252>>>>
48252>>>
48252>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48253>>>        Function_Return bIsSame
48254>>>    End_Function
48255>>>
48255>>>    // Compares a single index for a 'FROM' and a 'TO' table.
48255>>>    // ToDo: ReDo; remove table handles! And add bIsSQLtablefrom/to
48255>>>    Function UtilIndexCompare Boolean bIsSQLTableFrom Boolean bIsSQLTableTo tAPIIndexCompare APIIndexCompare Boolean bCompareIndexUppercase Boolean bCompareIndexAscending Returns Boolean
48257>>>        Boolean bIsSame
48257>>>        Integer iSegment
48257>>>
48257>>>        Move (APIIndexCompare.bExistsFrom = APIIndexCompare.bExistsTo) to bIsSame
48258>>>        If (bIsSame = False) Begin
48260>>>            Function_Return False
48261>>>        End
48261>>>>
48261>>>        Move (APIIndexCompare.iPrimaryIndexFrom = APIIndexCompare.iPrimaryIndexTo) to bIsSame
48262>>>        If (bIsSame = False) Begin
48264>>>            Function_Return False
48265>>>        End
48265>>>>
48265>>>
48265>>>        If (bIsSqlTableFrom = True and bIsSqlTableTo = True) Begin
48267>>>            // * We should probably not compare SQL index names?
48267>>>            // Move (Uppercase(aIndexFrom.sSQLIndexName) = Uppercase(aIndexTo.sSQLIndexName)) to bIsSame
48267>>>            // If (bIsSame = False) Begin   DF_INDEX_SERVER_ONLY
48267>>>            //     Function_Return False
48267>>>            // End
48267>>>            Move (APIIndexCompare.bIsSQLPrimaryKeyFrom = APIIndexCompare.bIsSQLPrimaryKeyTo) to bIsSame
48268>>>            If (bIsSame = False) Begin
48270>>>                Function_Return False
48271>>>            End
48271>>>>
48271>>>            Move (APIIndexCompare.bIsSQLClusteredFrom = APIIndexCompare.bIsSQLClusteredTo) to bIsSame
48272>>>            If (bIsSame = False) Begin
48274>>>                Function_Return False
48275>>>            End
48275>>>>
48275>>>            Move (APIIndexCompare.iSQLIndexTypeFrom = APIIndexCompare.iSQLIndexTypeTo) to bIsSame
48276>>>            If (bIsSame = False) Begin
48278>>>                Function_Return False
48279>>>            End
48279>>>>
48279>>>        End
48279>>>>
48279>>>
48279>>>        Get UtilIndexSegmentsCompare APIIndexCompare.IndexSegmentArrayFrom APIIndexCompare.IndexSegmentArrayTo bCompareIndexUppercase bCompareIndexAscending to iSegment
48280>>>        Move (iSegment = -1) to bIsSame
48281>>>
48281>>>        Function_Return (bIsSame = True)
48282>>>    End_Function
48283>>>
48283>>>    // Compares each segment for the passed index.
48283>>>    // Returns -1 if same; else returns the index segment that differs.
48283>>>    Function UtilIndexSegmentsCompare tAPIIndexSegment[] aIndexSegmentFrom tAPIIndexSegment[] aIndexSegmentTo Boolean bCompareIndexUppercase Boolean bCompareIndexAscending Returns Integer
48285>>>        Integer iNumSegmentsFrom iNumSegmentsTo iNumSegments iSegment
48285>>>        Boolean bIsSame
48285>>>
48285>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48286>>>        Move (SizeOfArray(aIndexSegmentFrom))      to iNumSegmentsFrom
48287>>>        Move (SizeOfArray(aIndexSegmentTo))        to iNumSegmentsTo
48288>>>        Move (iNumSegmentsFrom max iNumSegmentsTo) to iNumSegments
48289>>>
48289>>>        Decrement iNumSegments
48290>>>        for iSegment from 0 to iNumSegments
48296>>>>
48296>>>            Move False to bIsSame
48297>>>            If (iSegment <= iNumSegmentsFrom and iSegment <= iNumSegmentsTo) Begin
48299>>>                Get UtilIndexSegmentCompare aIndexSegmentFrom[iSegment] aIndexSegmentTo[iSegment] bCompareIndexUppercase bCompareIndexAscending to bIsSame
48300>>>            End
48300>>>>
48300>>>            If (bIsSame = False) Begin
48302>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
48303>>>                Function_Return iSegment
48304>>>            End
48304>>>>
48304>>>        Loop
48305>>>>
48305>>>
48305>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48306>>>        Function_Return -1 // This means bIsSame = True
48307>>>    End_Function
48308>>>
48308>>>    Function UtilIndexSegmentCompare tAPIIndexSegment aIndexSegmentFrom tAPIIndexSegment aIndexSegmentTo Boolean bCompareIndexUppercase Boolean bCompareIndexAscending Returns Integer
48310>>>        Boolean bIsSame
48310>>>
48310>>>        Move (aIndexSegmentFrom.iFieldNumber = aIndexSegmentTo.iFieldNumber) to bIsSame
48311>>>        If (bIsSame = False) Begin
48313>>>            Function_Return False
48314>>>        End
48314>>>>
48314>>>        If (bCompareIndexUppercase = True) Begin
48316>>>            Move (aIndexSegmentFrom.bUppercase = aIndexSegmentTo.bUppercase) to bIsSame
48317>>>            If (bIsSame = False) Begin
48319>>>                Function_Return False
48320>>>            End
48320>>>>
48320>>>        End
48320>>>>
48320>>>        If (bCompareIndexAscending = True) Begin
48322>>>            Move (aIndexSegmentFrom.bAscending = aIndexSegmentTo.bAscending) to bIsSame
48323>>>            If (bIsSame = False) Begin
48325>>>                Function_Return False
48326>>>            End
48326>>>>
48326>>>        End
48326>>>>
48326>>>
48326>>>        Function_Return True
48327>>>    End_Function
48328>>>
48328>>>    Function UtilIndexesUpdate Handle hTable Boolean bIsSQLTableFrom Boolean bIsSQLTableTo tAPIIndex[] aIndexesFrom tAPIIndex[] aIndexesTo Boolean bCompareIndexUppercase Boolean bCompareIndexAscending Returns Boolean
48330>>>        Boolean bIsSame bOK bExists
48330>>>        Integer iSize iSizeFrom iSizeTo iCount iIndexSegment               
48330>>>        tAPIIndexCompare[] aAPIIndexCompare
48330>>>        tAPIIndexCompare[] aAPIIndexCompare
48331>>>
48331>>>        Move (SizeOfArray(aIndexesFrom)) to iSize
48332>>>        If (iSize = 0) Begin
48334>>>            Function_Return True
48335>>>        End                     
48335>>>>
48335>>>        Move (SizeOfArray(aIndexesTo)) to iSizeTo  
48336>>>        Get UtilTableIsSql hTable to bIsSQLTableTo
48337>>>        Get UtilIndexCombineFromAndToArrays aIndexesFrom aIndexesTo to aAPIIndexCompare
48338>>>        
48338>>>        for iCount from 0 to (iSize - 1) 
48344>>>>
48344>>>            Get UtilIndexCompare bIsSQLTableFrom bIsSQLTableTo aAPIIndexCompare[iCount] bCompareIndexUppercase bCompareIndexAscending to bIsSame
48345>>>            If (bIsSame = False) Begin
48347>>>                Get APIIndexCreateByFieldNames hTable aIndexesFrom[iCount] aIndexesTo aIndexesFrom[iCount].IndexSegmentArray to bOK
48348>>>            End
48348>>>>
48348>>>        Loop  
48349>>>>
48349>>>        
48349>>>        // We probably should delete other indexes if they exists.
48349>>>        for iCount from (iSize +1) to iSizeTo
48355>>>>
48355>>>            Get ApiIndexRemove hTable iCount to bOK
48356>>>        Loop
48357>>>>
48357>>>
48357>>>        Function_Return bOK
48358>>>    End_Function
48359>>>
48359>>>//    Function UtilIsSameColumnDefinitions Handle hTable tAPIColumn[] aColumns Returns Boolean
48359>>>//        Boolean bEqual bIdentityKey bSqlDriver bDawSqlDriver bIsOpen
48359>>>//        Integer iCount iColumn iSize iOptions iLength iPrecision iType
48359>>>//        String sFieldName sDriverID
48359>>>//
48359>>>//        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48359>>>//        If (bIsOpen = False) Begin
48359>>>//            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48359>>>//            Open hTable
48359>>>//            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48359>>>//            Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48359>>>//            If (bIsOpen = False) Begin
48359>>>//                Function_Return False
48359>>>//            End
48359>>>//        End
48359>>>//
48359>>>//        Move True to bEqual
48359>>>//        Get psDriverID to sDriverID
48359>>>//        Get IsSQLDriver    sDriverID to bSqlDriver
48359>>>//        Get IsDAWSQLDriver sDriverID to bDawSqlDriver
48359>>>//        Move (SizeOfArray(aColumns)) to iSize
48359>>>//        Decrement iSize
48359>>>//
48359>>>//        For iCount from 0 to iSize
48359>>>//            Move 0 to iOptions
48359>>>//            Move False to bIdentityKey
48359>>>//            Move aColumns[iCount].sFieldName to sFieldName
48359>>>//
48359>>>//            // We need to use the column name - not the column integer as
48359>>>//            // the order does not need to be the same, and the logic should still work.
48359>>>//            Get UtilColumnNameToColumnNumber hTable sFieldName to iColumn
48359>>>//            If (iColumn > 0) Begin
48359>>>//                If (bDawSqlDriver = True) Begin
48359>>>//                    Send Ignore_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
48359>>>//                    Get_Attribute DF_FIELD_NATIVE_TYPE of hTable iColumn to iType
48359>>>//                    If (iType <> aColumns[iCount].iSQLType) Begin
48359>>>//                        Move False to bEqual
48359>>>//                    End
48359>>>//                    Get_Attribute DF_FIELD_IS_IDENTITY of hTable iColumn to bIdentityKey
48359>>>//                    If (bIdentityKey = True) Begin
48359>>>//                        Move C_tAPIColumn_Identity to iOptions
48359>>>//                    End
48359>>>//                    If (iOptions <> aColumns[iCount].iOptions) Begin
48359>>>//                        Move False to bEqual
48359>>>//                    End
48359>>>//                    Send Trap_Error of Error_Object_Id DFERR_UNSUPPORTED_ATTRIBUTE
48359>>>//                End
48359>>>//                Else Begin
48359>>>//                    Get_Attribute DF_FIELD_TYPE     of hTable iColumn to iType
48359>>>//                    If (iType <> aColumns[iCount].iSQLType) Begin
48359>>>//                        Move False to bEqual
48359>>>//                    End
48359>>>//                End
48359>>>//                Get_Attribute DF_FIELD_LENGTH       of hTable iColumn to iLength
48359>>>//                If (iLength <> aColumns[iCount].iLength) Begin
48359>>>//                    Move False to bEqual
48359>>>//                End
48359>>>//                Get_Attribute DF_FIELD_PRECISION    of hTable iColumn to iPrecision
48359>>>//                If (iPrecision <> aColumns[iCount].iPrecision) Begin
48359>>>//                    Move False to bEqual
48359>>>//                End
48359>>>//                If (bEqual = False) Begin
48359>>>//                    Function_Return False
48359>>>//                End
48359>>>//            End
48359>>>//
48359>>>//            Else Begin
48359>>>//                Function_Return False
48359>>>//            End
48359>>>//        Loop
48359>>>//
48359>>>//        Function_Return bEqual
48359>>>//    End_Function
48359>>>
48359>>>    Function UtilIndexesStructFill Handle hTable Returns tAPIIndex[]
48361>>>        tAPIIndex[] APIIndexes
48361>>>        tAPIIndex[] APIIndexes
48362>>>        Integer iCount iIndex iIndexes iSegment iSegmentCount iNumSegments iColumn
48362>>>        String sDriverID
48362>>>        Boolean bDAWSQLDriver bIsOpen bIsSQLTable bIsSQLPrimaryKey
48362>>>
48362>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48363>>>        Get psDriverID to sDriverID
48364>>>        Get IsDAWSQLDriver sDriverID to bDAWSQLDriver
48365>>>        Get UtilTableIsSQL hTable to bIsSQLTable
48366>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48369>>>        If (bIsOpen = False) Begin
48371>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48372>>>            Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48373>>>            Open hTable
48375>>>            Set Error_Report_Mode to DUF_ERROR_REPORT
48376>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48377>>>            Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48380>>>            If (bIsOpen = False) Begin
48382>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
48383>>>                Move True to APIIndexes[0].bError
48384>>>                Function_Return APIIndexes
48385>>>            End
48385>>>>
48385>>>        End
48385>>>>
48385>>>
48385>>>        Move 0 to iCount
48386>>>        Get_Attribute DF_FILE_LAST_INDEX_NUMBER of hTable to iIndexes
48389>>>        for iIndex from 1 to iIndexes
48395>>>>
48395>>>            // This is a test that the index exists as there might be "holes" aka the index
48395>>>            // numbers doesn't not need to be consequitive:
48395>>>            Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
48398>>>            If (iNumSegments > 0) Begin
48400>>>
48400>>>                Move iIndex                                                     to APIIndexes[iCount].iIndexNumber
48401>>>                Get_Attribute DF_FILE_PRIMARY_INDEX of hTable                   to APIIndexes[iCount].iPrimaryIndex
48404>>>                If (bIsSQLTable = True) Begin
48406>>>                    Get_Attribute DF_INDEX_NAME         of hTable iIndex        to APIIndexes[iCount].sSQLIndexName
48409>>>                        Get_Attribute DF_INDEX_SQL_PRIMARY_KEY of hTable iIndex to APIIndexes[iCount].bIsSQLPrimaryKey
48412>>>                        Get_Attribute DF_INDEX_CLUSTERED of hTable iIndex       to APIIndexes[iCount].bIsSQLClustered
48415>>>                        Get_Attribute DF_INDEX_SQL_TYPE of hTable iIndex        to APIIndexes[iCount].iSQLIndexType // (DF_INDEX_SQL_TYPE = DF_INDEX_SERVER, DF_INDEX_CLIENT, DF_INDEX_SERVER_ONLY or DF_INDEX_TEMPORARY)
48418>>>                End
48418>>>>
48418>>>
48418>>>                Move 0 to iSegmentCount
48419>>>                Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
48422>>>                For iSegment from 1 to iNumSegments
48428>>>>
48428>>>                    Get_Attribute DF_INDEX_SEGMENT_FIELD     of hTable iIndex iSegment to iColumn
48431>>>                    Move iColumn                                                       to APIIndexes[iCount].IndexSegmentArray[iSegmentCount].iFieldNumber
48432>>>                    Get_Attribute DF_FIELD_NAME              of hTable iColumn         to APIIndexes[iCount].IndexSegmentArray[iSegmentCount].sFieldName
48435>>>                    Get_Attribute DF_INDEX_SEGMENT_CASE      of hTable iIndex iSegment to APIIndexes[iCount].IndexSegmentArray[iSegmentCount].bUppercase
48438>>>                    Get_Attribute DF_INDEX_SEGMENT_DIRECTION of hTable iIndex iSegment to APIIndexes[iCount].IndexSegmentArray[iSegmentCount].bAscending
48441>>>                    Increment iSegmentCount
48442>>>                Loop
48443>>>>
48443>>>                Increment iCount
48444>>>            End
48444>>>>
48444>>>        Loop
48445>>>>
48445>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48446>>>
48446>>>        Function_Return APIIndexes
48447>>>    End_Function
48448>>>
48448>>>    // This will return a struct array with the combined data for the passed FROM and TO index arrays.
48448>>>    // The combined data will be sorted on the first struct member: iIndexNumber
48448>>>    // This is needed because index numbers can start at any number. The range for a particular table might also
48448>>>    // have "holes" in the series of index numbers.
48448>>>    Function UtilIndexCombineFromAndToArrays tAPIIndex[] APIIndexFrom tAPIIndex[] APIIndexTo Returns tAPIIndexCompare[]
48450>>>        tAPIIndexCompare[] aAPIIndexCompare
48450>>>        tAPIIndexCompare[] aAPIIndexCompare
48451>>>        tAPIIndexCompare   APIIndexCompare
48451>>>        tAPIIndexCompare   APIIndexCompare
48451>>>        Integer iSizeFrom iSizeTo iSize iCount iItem iIndexFrom iIndexTo
48451>>>
48451>>>        Move (SizeOfArray(APIIndexFrom)) to iSizeFrom
48452>>>        Move (SizeOfArray(APIIndexTo)) to iSizeTo
48453>>>        If (iSizeFrom = 0 and iSizeTo = 0) Begin
48455>>>            Function_Return aAPIIndexCompare
48456>>>        End
48456>>>>
48456>>>
48456>>>        Decrement iSizeFrom
48457>>>        for iCount from 0 to iSizeFrom
48463>>>>
48463>>>            Move APIIndexFrom[iCount].iIndexNumber      to aAPIIndexCompare[iCount].iIndexNumber
48464>>>            Move APIIndexFrom[iCount].iPrimaryIndex     to aAPIIndexCompare[iCount].iPrimaryIndexFrom
48465>>>            Move APIIndexFrom[iCount].sSQLIndexName     to aAPIIndexCompare[iCount].sSQLIndexNameFrom
48466>>>            Move APIIndexFrom[iCount].iSQLIndexType     to aAPIIndexCompare[iCount].iSQLIndexTypeFrom
48467>>>            Move APIIndexFrom[iCount].bIsSQLClustered   to aAPIIndexCompare[iCount].bIsSQLClusteredFrom
48468>>>            Move APIIndexFrom[iCount].bIsSQLPrimaryKey  to aAPIIndexCompare[iCount].bIsSQLPrimaryKeyFrom
48469>>>            Move APIIndexFrom[iCount].IndexSegmentArray to aAPIIndexCompare[iCount].IndexSegmentArrayFrom
48470>>>            Move APIIndexFrom[iCount].bShouldChange     to aAPIIndexCompare[iCount].bShouldChangeFrom
48471>>>            Move APIIndexFrom[iCount].bCancel           to aAPIIndexCompare[iCount].bCancelFrom
48472>>>            Move APIIndexFrom[iCount].bError            to aAPIIndexCompare[iCount].bErrorFrom
48473>>>            Move True                                   to aAPIIndexCompare[iCount].bExistsFrom
48474>>>        Loop
48475>>>>
48475>>>
48475>>>        Decrement iSizeTo
48476>>>        for iCount from 0 to iSizeTo
48482>>>>
48482>>>            Move APIIndexTo[iCount].iIndexNumber        to APIIndexCompare.iIndexNumber
48483>>>            // Search if the Index number already exists in the array; else add it.
48483>>>            Move (SearchArray(APIIndexCompare, aAPIIndexCompare)) to iItem
48484>>>            If (iItem = -1) Begin
48486>>>                Move (SizeOfArray(aAPIIndexCompare))    to iItem
48487>>>            End
48487>>>>
48487>>>
48487>>>            Move APIIndexCompare.iIndexNumber           to aAPIIndexCompare[iItem].iIndexNumber
48488>>>            Move APIIndexTo[iCount].iPrimaryIndex       to aAPIIndexCompare[iItem].iPrimaryIndexTo
48489>>>            Move APIIndexTo[iCount].sSQLIndexName       to aAPIIndexCompare[iItem].sSQLIndexNameTo
48490>>>            Move APIIndexTo[iCount].iSQLIndexType       to aAPIIndexCompare[iItem].iSQLIndexTypeTo
48491>>>            Move APIIndexTo[iCount].bIsSQLClustered     to aAPIIndexCompare[iItem].bIsSQLClusteredTo
48492>>>            Move APIIndexTo[iCount].bIsSQLPrimaryKey    to aAPIIndexCompare[iItem].bIsSQLPrimaryKeyTo
48493>>>            Move APIIndexTo[iCount].IndexSegmentArray   to aAPIIndexCompare[iItem].IndexSegmentArrayTo
48494>>>            Move APIIndexTo[iCount].bShouldChange       to aAPIIndexCompare[iItem].bShouldChangeTo
48495>>>            Move APIIndexTo[iCount].bCancel             to aAPIIndexCompare[iItem].bCancelTo
48496>>>            Move APIIndexTo[iCount].bError              to aAPIIndexCompare[iItem].bErrorTo
48497>>>            Move True                                   to aAPIIndexCompare[iItem].bExistsTo
48498>>>        Loop
48499>>>>
48499>>>
48499>>>        Move (SortArray(aAPIIndexCompare)) to aAPIIndexCompare
48500>>>
48500>>>        Function_Return aAPIIndexCompare
48501>>>    End_Function
48502>>>
48502>>>    // This is the same as the UtilIndexCompare function but it takes tAPIIndex structs as params.
48502>>>    Function UtilIndexTypeNumberCompare Handle hTable tAPIIndex aIndexFrom tAPIIndex aIndexTo Returns Boolean
48504>>>        Boolean bIsSame bDAWSQLDriver bIsSqlTable
48504>>>        String sDriverID
48504>>>        Integer iSegment
48504>>>        
48504>>>        Get psDriverID to sDriverID
48505>>>        Get IsDAWSQLDriver sDriverID to bDAWSQLDriver
48506>>>        Get IsSQLDriver sDriverID to bIsSqlTable
48507>>>        If (bIsSqlTable = True) Begin
48509>>>            Get UtilTableIsSQL hTable to bIsSqlTable
48510>>>        End
48510>>>>
48510>>>
48510>>>        Move (aIndexFrom.iIndexNumber = aIndexTo.iIndexNumber) to bIsSame
48511>>>        If (bIsSame = False) Begin
48513>>>            Function_Return False
48514>>>        End
48514>>>>
48514>>>
48514>>>        If (bDAWSQLDriver = True and bIsSqlTable = True) Begin
48516>>>            // Don't think we should do this. Or should we?
48516>>>            // Move (aIndexesFrom[iCount].sSQLIndexName = aIndexesTo[iCount].sSQLIndexName) to bIsSame
48516>>>
48516>>>            Move (aIndexFrom.iSQLIndexType = aIndexTo.iSQLIndexType) to bIsSame
48517>>>            If (bIsSame = False) Begin
48519>>>                Function_Return False
48520>>>            End    
48520>>>>
48520>>>            Move (aIndexFrom.iPrimaryIndex = aIndexTo.iPrimaryIndex) to bIsSame
48521>>>            If (bIsSame = False) Begin
48523>>>                Function_Return False
48524>>>            End
48524>>>>
48524>>>            Move (aIndexFrom.bIsSQLPrimaryKey = aIndexTo.bIsSQLPrimaryKey) to bIsSame
48525>>>            If (bIsSame = False) Begin
48527>>>                Function_Return False
48528>>>            End                      
48528>>>>
48528>>>            Move (aIndexFrom.bIsSQLClustered = aIndexTo.bIsSQLClustered) to bIsSame
48529>>>            If (bIsSame = False) Begin
48531>>>                Function_Return False
48532>>>            End                      
48532>>>>
48532>>>        End
48532>>>>
48532>>>        
48532>>>        Function_Return bIsSame
48533>>>    End_Function
48534>>>
48534>>>    // DF_INDEX_SQL_TYPE values
48534>>>    // Pass one of the DF_INDEX_XXX integer constants and the function
48534>>>    // returns a string with the name.
48534>>>    Function UtilIndexTypeToString Integer iIndexType Returns String
48536>>>        String sRetval
48536>>>        Case Begin
48536>>>            Case (iIndexType = DF_INDEX_CLIENT)
48538>>>                Move "DF_INDEX_CLIENT" to sRetval
48539>>>                Case Break
48540>>>            Case (iIndexType = DF_INDEX_SERVER)
48543>>>                Move "DF_INDEX_SERVER" to sRetval
48544>>>                Case Break
48545>>>            Case (iIndexType = DF_INDEX_SERVER_ONLY)
48548>>>                Move "DF_INDEX_SERVER_ONLY" to sRetval
48549>>>                Case Break
48550>>>            Case (iIndexType = DF_INDEX_TEMPORARY)
48553>>>                Move "DF_INDEX_TEMPORARY" to sRetval
48554>>>                Case Break
48555>>>            Case Else
48555>>>                Move "UNKNOWN INDEX TYPE" to sRetval
48556>>>        Case End
48556>>>        Function_Return sRetval
48557>>>    End_Function
48558>>>
48558>>>    // * Dummy function for the Studio's Code Explorer *
48558>>>    Function API_RELATION_UTILITY_FUNCTIONS Returns Boolean
48560>>>        Function_Return False
48561>>>    End_Function
48562>>>
48562>>>    // Compares multiple relationships for a 'FROM' and a 'TO' databases
48562>>>    Function UtilRelationsCompare Handle hTable tAPIRelationCompare[] aAPIRelationCompare Returns Boolean
48564>>>        Boolean bIsSame
48564>>>        Integer iSize iCount
48564>>>
48564>>>        Move True to bIsSame
48565>>>        Move (SizeOfArray(aAPIRelationCompare)) to iSize
48566>>>        Decrement iSize
48567>>>        For iCount from 0 to iSize
48573>>>>
48573>>>            Get UtilRelationCompare hTable aAPIRelationCompare[iCount] to bIsSame
48574>>>            If (bIsSame = False) Begin
48576>>>                Function_Return False
48577>>>            End
48577>>>>
48577>>>        Loop
48578>>>>
48578>>>
48578>>>        Function_Return bIsSame
48579>>>    End_Function
48580>>>
48580>>>    // Compares a single relationship for a 'FROM' and a 'TO' table
48580>>>    Function UtilRelationCompare Handle hTable tAPIRelationCompare APIRelationCompare Returns Boolean
48582>>>        Boolean bIsSame
48582>>>
48582>>>        Move True to bIsSame
48583>>>        If (APIRelationCompare.bExistsFrom <> APIRelationCompare.bExistsTo) Begin
48585>>>            Function_Return False
48586>>>        End
48586>>>>
48586>>>        If (APIRelationCompare.hTableFrom = 0 or APIRelationCompare.hTableTo = 0) Begin
48588>>>            Function_Return False
48589>>>        End
48589>>>>
48589>>>
48589>>>        // We could also compare field names, but I don't think that is necessary...
48589>>>
48589>>>        Function_Return bIsSame
48590>>>    End_Function
48591>>>
48591>>>    // This message is different from ApiTableCreate in that it will not do a function_return if the table
48591>>>    // already exists. 
48591>>>    Function UtilRelationsUpdate Handle hTable tAPIRelation[] aRelationsFrom tAPIRelation[] aRelationsTo Returns Boolean
48593>>>        Boolean bIsSame bOK
48593>>>        Integer iSizeTo iSize iCount iColumn
48593>>>        String sDriverID
48593>>>        
48593>>>        Move True to bOK                                                                                
48594>>>        Move (SizeOfArray(aRelationsTo))   to iSizeTo
48595>>>        If (iSizeTo > 0) Begin
48597>>>            Get AutoConnectionIDLogin to bOK
48598>>>            Move False to Err
48599>>>            Open hTable Mode DF_EXCLUSIVE
48601>>>            Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
48604>>>            Decrement iSizeTo
48605>>>
48605>>>            // We should probably not make any comparison between "FROM" and "TO" database; instead just create all "FROM" relations
48605>>>            // for the "TO" database. But start by deleting all current "TO" relations:
48605>>>            Structure_Start hTable sDriverID            
48606>>>                for iCount from 0 to iSizeTo                                                
48612>>>>
48612>>>                    Move aRelationsTo[iCount].iColumnFrom to iColumn
48613>>>                    Set_Attribute DF_FIELD_RELATED_FILE  of hTable iColumn to 0
48616>>>                    Set_Attribute DF_FIELD_RELATED_FIELD of hTable iColumn to 0
48619>>>                End
48620>>>>
48620>>>                Set Action_Text of ghoStatusPanel to "Restructures table..."
48621>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
48623>>>            Set Action_Text of ghoStatusPanel to ""
48624>>>        End
48624>>>>
48624>>>
48624>>>        Move (SizeOfArray(aRelationsFrom)) to iSize
48625>>>        Decrement iSize
48626>>>        for iCount from 0 to iSize
48632>>>>
48632>>>            Get ApiTableRelate aRelationsFrom[iCount].hTableFrom aRelationsFrom[iCount].hTableTo aRelationsFrom[iCount].iColumnFrom aRelationsFrom[iCount].iColumnTo aRelationsTo to bOK
48633>>>        Loop
48634>>>>
48634>>>
48634>>>        Function_Return bOK
48635>>>    End_Function
48636>>>
48636>>>    Function UtilRelationsStructFill Handle hTable Returns tAPIRelation[]
48638>>>        tAPIRelation[] APIRelations
48638>>>        tAPIRelation[] APIRelations
48639>>>        Integer iColumn iColumnTo iNumColumns iCount
48639>>>        Handle hParent
48639>>>        Boolean bIsOpen
48639>>>
48639>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
48640>>>        Move 0 to iCount
48641>>>        Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48644>>>        If (bIsOpen = False) Begin
48646>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48647>>>            Open hTable
48649>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
48650>>>            Get_Attribute DF_FILE_OPENED of hTable to bIsOpen
48653>>>            If (bIsOpen = False) Begin
48655>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
48656>>>                Move True to APIRelations[0].bError
48657>>>                Function_Return APIRelations
48658>>>            End
48658>>>>
48658>>>        End
48658>>>>
48658>>>
48658>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iNumColumns
48661>>>        For iColumn from 1 to iNumColumns
48667>>>>
48667>>>            Get_Attribute DF_FIELD_RELATED_FILE of hTable iColumn to hParent
48670>>>            If (hParent <> 0) Begin
48672>>>                Open hParent
48674>>>                Move hTable                                             to APIRelations[iCount].hTableFrom
48675>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable            to APIRelations[iCount].sLogicalNameFrom
48678>>>                Move iColumn                                            to APIRelations[iCount].iColumnFrom
48679>>>                Get_Attribute DF_FIELD_NAME of hTable iColumn           to APIRelations[iCount].sFieldNameFrom
48682>>>
48682>>>                Move hParent                                            to APIRelations[iCount].hTableTo
48683>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hParent           to APIRelations[iCount].sLogicalNameTo
48686>>>                Get_Attribute DF_FIELD_RELATED_FIELD of hTable iColumn  to iColumnTo
48689>>>                Move iColumnTo                                          to APIRelations[iCount].iColumnTo
48690>>>                Get_Attribute DF_FIELD_NAME of hParent iColumnTo        to APIRelations[iCount].sFieldNameTo
48693>>>                Move False                                              to APIRelations[iCount].bShouldChange
48694>>>                Move False                                              to APIRelations[iCount].bCancel
48695>>>                Move False                                              to APIRelations[iCount].bError
48696>>>                Close hParent
48697>>>                Increment iCount
48698>>>            End
48698>>>>
48698>>>        Loop
48699>>>>
48699>>>
48699>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
48700>>>        Function_Return APIRelations
48701>>>    End_Function
48702>>>
48702>>>    Function UtilRelationArrayCompare tAPIRelation RelationCurrent tAPIRelation RelationNew Returns Integer
48704>>>        If (RelationCurrent.hTableFrom  = RelationNew.hTableFrom and ;            RelationCurrent.iColumnFrom = RelationNew.iColumnFrom and ;            RelationCurrent.hTableTo    = RelationNew.hTableTo and ;            RelationCurrent.iColumnTo   = RelationNew.iColumnTo) Begin
48706>>>            Function_Return (EQ)
48707>>>        End
48707>>>>
48707>>>
48707>>>        Function_Return (GT)
48708>>>    End_Function
48709>>>
48709>>>    Function SearchRelationCompare tAPIRelationCompare RelationCompareCurrent tAPIRelationCompare RelationCompareNew Returns Integer
48711>>>        If (RelationCompareCurrent.hTableFrom  = RelationCompareNew.hTableFrom and ;            RelationCompareCurrent.iColumnFrom = RelationCompareNew.iColumnFrom and ;            RelationCompareCurrent.hTableTo    = RelationCompareNew.hTableTo and ;            RelationCompareCurrent.iColumnTo   = RelationCompareNew.iColumnTo) ;            Function_Return (EQ)
48714>>>
48714>>>        Function_Return (GT)
48715>>>    End_Function
48716>>>
48716>>>    // This will return a struct array with the combined data for the passed FROM and TO index arrays.
48716>>>    // The combined data will be sorted on the first 4 struct members: hTableFrom, iColumnFrom, hTableTo and iColumnTo
48716>>>    Function UtilRelationCombineFromAndToArrays tAPIRelation[] aAPIRelationFrom tAPIRelation[] aAPIRelationTo Returns tAPIIndexCompare[]
48718>>>        tAPIRelation[] aAPIRelationFromAndTo
48718>>>        tAPIRelation[] aAPIRelationFromAndTo
48719>>>        tAPIRelationCompare[] aAPIRelationCompare
48719>>>        tAPIRelationCompare[] aAPIRelationCompare
48720>>>        tAPIRelationCompare   APIRelationCompare
48720>>>        tAPIRelationCompare   APIRelationCompare
48720>>>        Integer iSizeFrom iSizeTo iSize iCount iItem
48720>>>
48720>>>        Move (SizeOfArray(aAPIRelationFrom)) to iSizeFrom
48721>>>        Move (SizeOfArray(aAPIRelationTo))   to iSizeTo
48722>>>        If (iSizeFrom = 0 and iSizeTo = 0) Begin
48724>>>            Function_Return aAPIRelationCompare
48725>>>        End
48725>>>>
48725>>>
48725>>>        Move (AppendArray(aAPIRelationFrom, aAPIRelationTo)) to aAPIRelationFromAndTo
48726>>>        Move (SortArray(aAPIRelationFromAndTo, Self, RefFunc(UtilRelationArrayCompare))) to aAPIRelationFromAndTo
48727>>>
48727>>>        Decrement iSizeFrom
48728>>>        for iCount from 0 to iSizeFrom
48734>>>>
48734>>>            Move aAPIRelationFrom[iCount].hTableFrom        to aAPIRelationCompare[iCount].hTableFrom
48735>>>            Move aAPIRelationFrom[iCount].iColumnFrom       to aAPIRelationCompare[iCount].iColumnFrom
48736>>>            Move aAPIRelationFrom[iCount].hTableTo          to aAPIRelationCompare[iCount].hTableTo
48737>>>            Move aAPIRelationFrom[iCount].iColumnTo         to aAPIRelationCompare[iCount].iColumnTo
48738>>>            Move aAPIRelationFrom[iCount].sLogicalNameFrom  to aAPIRelationCompare[iCount].sLogicalNameFrom_From
48739>>>            Move aAPIRelationFrom[iCount].sLogicalNameTo    to aAPIRelationCompare[iCount].sLogicalNameTo_From
48740>>>            Move aAPIRelationFrom[iCount].sFieldNameFrom    to aAPIRelationCompare[iCount].sFieldNameFrom_From
48741>>>            Move aAPIRelationFrom[iCount].sFieldNameTo      to aAPIRelationCompare[iCount].sFieldNameTo_From
48742>>>            Move aAPIRelationFrom[iCount].bShouldChange     to aAPIRelationCompare[iCount].bShouldChange_From
48743>>>            Move aAPIRelationFrom[iCount].bCancel           to aAPIRelationCompare[iCount].bCancel_From
48744>>>            Move aAPIRelationFrom[iCount].bError            to aAPIRelationCompare[iCount].bError_From
48745>>>            Move True                                       to aAPIRelationCompare[iCount].bExistsFrom
48746>>>        Loop
48747>>>>
48747>>>
48747>>>        Decrement iSizeTo
48748>>>        for iCount from 0 to iSizeTo
48754>>>>
48754>>>            Move aAPIRelationTo[iCount].hTableFrom          to APIRelationCompare.hTableFrom
48755>>>            Move aAPIRelationTo[iCount].iColumnFrom         to APIRelationCompare.iColumnFrom
48756>>>            Move aAPIRelationTo[iCount].hTableTo            to APIRelationCompare.hTableTo
48757>>>            Move aAPIRelationTo[iCount].iColumnTo           to APIRelationCompare.iColumnTo
48758>>>
48758>>>            // Search if the relation already exists in the array; else add it.
48758>>>            Move (SearchArray(APIRelationCompare, aAPIRelationCompare, Self, RefFunc(SearchRelationCompare))) to iItem
48759>>>            If (iItem = -1) Begin
48761>>>                Move (SizeOfArray(aAPIRelationCompare))     to iItem
48762>>>            End
48762>>>>
48762>>>
48762>>>            Move APIRelationCompare.hTableFrom              to aAPIRelationCompare[iItem].hTableFrom
48763>>>            Move APIRelationCompare.iColumnFrom             to aAPIRelationCompare[iItem].iColumnFrom
48764>>>            Move APIRelationCompare.hTableTo                to aAPIRelationCompare[iItem].hTableTo
48765>>>            Move APIRelationCompare.iColumnTo               to aAPIRelationCompare[iItem].iColumnTo
48766>>>            Move aAPIRelationTo[iCount].sLogicalNameFrom    to aAPIRelationCompare[iItem].sLogicalNameFrom_To
48767>>>            Move aAPIRelationTo[iCount].sLogicalNameTo      to aAPIRelationCompare[iItem].sLogicalNameTo_To
48768>>>            Move aAPIRelationTo[iCount].sFieldNameFrom      to aAPIRelationCompare[iItem].sFieldNameFrom_To
48769>>>            Move aAPIRelationTo[iCount].sFieldNameTo        to aAPIRelationCompare[iItem].sFieldNameTo_To
48770>>>            Move aAPIRelationTo[iCount].bShouldChange       to aAPIRelationCompare[iItem].bShouldChange_To
48771>>>            Move aAPIRelationTo[iCount].bCancel             to aAPIRelationCompare[iItem].bCancel_To
48772>>>            Move aAPIRelationTo[iCount].bError              to aAPIRelationCompare[iItem].bError_To
48773>>>            Move True                                       to aAPIRelationCompare[iItem].bExistsTo
48774>>>        Loop
48775>>>>
48775>>>
48775>>>        Move (SortArray(aAPIRelationCompare, Self, RefFunc(SearchRelationCompare))) to aAPIRelationCompare
48776>>>
48776>>>        Function_Return aAPIRelationCompare
48777>>>    End_Function
48778>>>
48778>>>    // * Dummy function for the Studio's Code Explorer *
48778>>>    Function CODEMAST_UTILITY_FUNCTIONS Returns Boolean
48780>>>        Function_Return False
48781>>>    End_Function
48782>>>
48782>>>    // To add a value to the CodeMast & CodeType tables. Pass; a) bCodeType if it is CodeType that should be updated.
48782>>>    // Else it is CodeMast. b) sTypeValue; either to be added If bCodeType = True, or it will be used to find the correct
48782>>>    // CodeType record. c) sValue1 and d) sValue2 is the CodeType Description & Comment, or CodeMast Type and Code values.
48782>>>    Function UtilCodeMasterAddValue Boolean bCodeType String sTypeValue String sValue2 String sValue3 Returns Boolean
48784>>>        Boolean bFound
48784>>>
48784>>>        Move False to Err
48785>>>        Open CodeMast
48787>>>        Open CodeType
48789>>>
48789>>>        If (bCodeType = True) Begin
48791>>>            Clear CodeType
48792>>>            Move sTypeValue to CODETYPE.Type
48793>>>            Find eq CODETYPE.Type
48794>>>>
48794>>>            Move (Found = True) to bFound
48795>>>            If (bFound = True) Begin
48797>>>                Reread CodeType
48801>>>            End
48801>>>>
48801>>>            If (bFound = False) Begin
48803>>>                Clear CodeType
48804>>>            End
48804>>>>
48804>>>                Move sTypeValue to CODETYPE.Type
48805>>>                Move sValue2    to CODETYPE.Description
48806>>>                Move sValue3    to CODETYPE.Comment
48807>>>                SaveRecord CODETYPE
48808>>>            If (bFound = True) Begin
48810>>>                Unlock
48811>>>>
48811>>>            End
48811>>>>
48811>>>        End
48811>>>>
48811>>>
48811>>>        If (bCodeType = False) Begin
48813>>>            Clear CODEMAST
48814>>>            Move sTypeValue to CODEMAST.Type
48815>>>            Move sValue2    to CODEMAST.Code
48816>>>            Find eq CODEMAST.Code
48817>>>>
48817>>>            Move (Found = True) to bFound
48818>>>            If (bFound = True) Begin
48820>>>                Reread CODEMAST
48824>>>            End
48824>>>>
48824>>>            If (bFound = False) Begin
48826>>>                Clear CODEMAST
48827>>>            End
48827>>>>
48827>>>                Move sTypeValue to CODEMAST.Type
48828>>>                Move sValue2    to CODEMAST.Code
48829>>>                Move sValue3    to CODEMAST.Description
48830>>>                SaveRecord CODEMAST
48831>>>            If (bFound = True) Begin
48833>>>            Unlock
48834>>>>
48834>>>            End
48834>>>>
48834>>>        End
48834>>>>
48834>>>
48834>>>        Close CodeMast
48835>>>        Close CodeType
48836>>>
48836>>>        Function_Return (Err = False)
48837>>>    End_Function
48838>>>
48838>>>    // Changes values in CodeType & CodeMast - From type value To type value. It first changes the type value in
48838>>>    // CodeType and then spins through all CodeMast records to change all related records.
48838>>>    Function UtilCodeMasterChangeValue String sFromValue String sToValue Returns Boolean
48840>>>        Boolean bFound
48840>>>
48840>>>        Move False to Err
48841>>>        Open CodeMast
48843>>>        Open CodeType
48845>>>
48845>>>        Clear CodeType
48846>>>        Move sFromValue to CODETYPE.Type
48847>>>        Find eq CODETYPE.Type
48848>>>>
48848>>>        If (Found = True) Begin
48850>>>            Reread CODETYPE
48854>>>                Move sToValue to CODETYPE.Type
48855>>>                SaveRecord CODETYPE
48856>>>            Unlock
48857>>>>
48857>>>        End
48857>>>>
48857>>>
48857>>>        Clear CODEMAST
48858>>>        Find gt CODEMAST by Recnum
48859>>>>
48859>>>        While (Found = True)
48863>>>            Move (Trim(Uppercase(CODEMAST.Type) = Trim(Uppercase(sFromValue)))) to bFound
48864>>>            If (bFound = True) Begin
48866>>>                Reread CODEMAST
48870>>>                    Move sToValue to CODEMAST.Type
48871>>>                    SaveRecord CODEMAST
48872>>>                Unlock
48873>>>>
48873>>>            End
48873>>>>
48873>>>            Find gt CODEMAST by Recnum
48874>>>>
48874>>>        Loop
48875>>>>
48875>>>
48875>>>        Close CodeMast
48876>>>        Close CodeType
48877>>>
48877>>>        Function_Return (Err = False)
48878>>>    End_Function
48879>>>
48879>>>    // Removes a value from CodeMast. Pass the sTypeValue and the sValue2 to remove.
48879>>>    Function UtilCodeMasterRemoveValue String sTypeValue String sValue2 Returns Boolean
48881>>>        Boolean bFound
48881>>>
48881>>>        Move False to Err
48882>>>        Open CodeMast
48884>>>
48884>>>        Clear CODEMAST
48885>>>        Move sTypeValue to CODEMAST.Type
48886>>>        Move sValue2    to CODEMAST.Code
48887>>>        Find eq CODEMAST.Code
48888>>>>
48888>>>        Move (Found = True) to bFound
48889>>>        If (bFound = True) Begin
48891>>>            Delete CODEMAST
48892>>>        End
48892>>>>
48892>>>
48892>>>        Close CodeMast
48893>>>
48893>>>        Function_Return (Err = False)
48894>>>    End_Function
48895>>>
48895>>>    Function UtilTableCreateCodeMastCodeTypeIntFiles String sDataPath Returns Boolean
48897>>>        Boolean bRecnum bToAnsi
48897>>>        Integer iCh
48897>>>        String sFileName sDriverID sConnectionID sSchemaName sANSI_OEM
48897>>>
48897>>>        If (Trim(sDataPath) = "") Begin
48899>>>            Function_Return False
48900>>>        End
48900>>>>
48900>>>
48900>>>        Move False to Err
48901>>>        Get psDriverID     to sDriverID
48902>>>        Get psConnectionID to sConnectionID
48903>>>        Get psSchema       to sSchemaName
48904>>>        Get True           to bRecnum
48905>>>        Get pbToANSI       to bToAnsi
48906>>>        Move CS_ANSI_Txt to sANSI_OEM
48907>>>        If (bToAnsi = False) Begin
48909>>>            Move CS_OEM_Txt to sANSI_OEM
48910>>>        End
48910>>>>
48910>>>
48910>>>        Get vFolderFormat sDataPath to sDataPath
48911>>>        Move "CodeMast.int"         to sFileName
48912>>>        Get Seq_Open_Output_Channel (sDataPath + sFileName) to iCh
48913>>>            Writeln channel iCh ("DRIVER_NAME" * sDriverID)
48916>>>            Writeln channel iCh ("SERVER_NAME DFCONNID=" + sConnectionID)
48919>>>            Writeln channel iCh ("DATABASE_NAME CODEMAST")
48922>>>            Writeln channel iCh ("SCHEMA_NAME" * sSchemaName)
48925>>>            Writeln channel iCh ("")
48928>>>            Writeln channel iCh ("RECNUM_TABLE YES")
48931>>>            Writeln channel iCh ("PRIMARY_INDEX 0")
48934>>>            Writeln channel iCh ("TABLE_CHARACTER_FORMAT" * sANSI_OEM)
48937>>>            Writeln channel iCh ("USE_DUMMY_ZERO_DATE YES")
48940>>>            Writeln channel iCh ("")
48943>>>            Writeln channel iCh ("INDEX_NUMBER 1")
48946>>>            Writeln channel iCh ("INDEX_NAME CODEMAST001_PK")
48949>>>            Writeln channel iCh ("")
48952>>>        Send Seq_Close_Channel iCh
48953>>>
48953>>>        Get vFolderFormat sDataPath to sDataPath
48954>>>        Move "CodeType.int"         to sFileName
48955>>>        Get Seq_Open_Output_Channel (sDataPath + sFileName) to iCh
48956>>>            Writeln channel iCh ("DRIVER_NAME" * sDriverID)
48959>>>            Writeln channel iCh ("SERVER_NAME DFCONNID=" + sConnectionID)
48962>>>            Writeln channel iCh ("DATABASE_NAME CODETYPE")
48965>>>            Writeln channel iCh ("SCHEMA_NAME" * sSchemaName)
48968>>>            Writeln channel iCh ("")
48971>>>            Writeln channel iCh ("RECNUM_TABLE YES")
48974>>>            Writeln channel iCh ("PRIMARY_INDEX 0")
48977>>>            Writeln channel iCh ("TABLE_CHARACTER_FORMAT" * sANSI_OEM)
48980>>>            Writeln channel iCh ("USE_DUMMY_ZERO_DATE YES")
48983>>>            Writeln channel iCh ("")
48986>>>            Writeln channel iCh ("INDEX_NUMBER 0")
48989>>>            Writeln channel iCh ("INDEX_NAME CODETYPE000")
48992>>>            Writeln channel iCh ("")
48995>>>            Writeln channel iCh ("INDEX_NUMBER 1")
48998>>>            Writeln channel iCh ("INDEX_NAME CODETYPE001_PK")
49001>>>            Writeln channel iCh ("")
49004>>>        Send Seq_Close_Channel iCh
49005>>>
49005>>>        Function_Return (Err = False)
49006>>>    End_Function
49007>>>
49007>>>    // * Dummy function for the Studio's Code Explorer *
49007>>>    Function OTHER_UTILITY_FUNCTIONS Returns Boolean
49009>>>        Function_Return False
49010>>>    End_Function
49011>>>
49011>>>    // Check if the file exists in the Data folder,
49011>>>    // else creates it from memory as it has been compiled into the program as a resource:
49011>>>    Function UtilCheckCreateIfFileExists String sFileName String sResourceName Boolean bDataFile Returns Boolean
49013>>>        String sPath sDataPath
49013>>>        Boolean bExists
49013>>>
49013>>>        Get psDataPathFirstPart to sPath
49014>>>        Move (sPath + sFileName) to sFileName
49015>>>        Get vFilePathExists sFileName to bExists
49016>>>
49016>>>        If (bExists = False) Begin
49018>>>            // Read from memory & create file on disk.
49018>>>            Send SqlUtilCreateFileFromMemory sResourceName sFileName
49019>>>            Get vFilePathExists sFileName to bExists
49020>>>        End
49020>>>>
49020>>>        Function_Return bExists
49021>>>    End_Function
49022>>>
49022>>>    Function UtilSqlColumnTypeToDataFlexType String sDriverID Integer iDbType Integer iDataType Integer iLength Returns Integer
49024>>>        tColumnType RetvalType
49024>>>        tColumnType RetvalType
49024>>>        Integer iRetval
49024>>>
49024>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
49025>>>        Move RetvalType.iDataFlexType to iRetval
49026>>>        If (RetvalType.iDataFlexType = DF_TEXT) Begin
49028>>>            If (iLength <= 255) Begin
49030>>>                Move DF_ASCII to iRetval
49031>>>            End
49031>>>>
49031>>>        End
49031>>>>
49031>>>        Function_Return iRetval
49032>>>    End_Function       
49033>>>    
49033>>>    Function UtilDataFlexDataTypeToString Integer iDataType Returns String
49035>>>        String sRetval 
49035>>>
49035>>>        Case Begin
49035>>>            Case (iDataType = DF_ASCII)
49037>>>                Move "DF_ASCII" to sRetval
49038>>>                Case Break
49039>>>            Case (iDataType = DF_BCD)
49042>>>                Move "DF_BCD" to sRetval
49043>>>                Case Break
49044>>>            Case (iDataType = DF_BINARY)
49047>>>                Move "DF_BINARY" to sRetval
49048>>>                Case Break
49049>>>            Case (iDataType = DF_DATE)
49052>>>                Move "DF_DATE" to sRetval
49053>>>                Case Break
49054>>>            Case (iDataType = DF_DATETIME)
49057>>>                Move "DF_DATETIME" to sRetval
49058>>>                Case Break
49059>>>            Case (iDataType = DF_TEXT)
49062>>>                Move "DF_TEXT" to sRetval
49063>>>                Case Break
49064>>>            Case Else
49064>>>                Move "" to sRetval
49065>>>        Case End
49065>>>
49065>>>        Function_Return sRetval
49066>>>    End_Function
49067>>>
49067>>>    // The default value used for a datatype as specified in the driver int file.
49067>>>    Function UtilDataTypeDefaultValue String sDriverID Integer iDbType Integer iDataType Returns String
49069>>>        String sRetval sServer
49069>>>        tColumnType RetvalType
49069>>>        tColumnType RetvalType
49069>>>        Integer iDriver iDataFlexType
49069>>>        Handle hDatabase
49069>>>
49069>>>        Get _UtilColumnType sDriverID iDbType iDataType "" True to RetvalType
49070>>>        Move RetvalType.iDataFlexType to iDataFlexType
49071>>>        Get DriverIndex sDriverID to iDriver
49072>>>        Get psServer to sServer
49073>>>        Get SqlUtilDatabaseHandle sDriverID sServer to hDatabase
49074>>>        If (hDatabase = 0) Begin
49076>>>            Function_Return ""
49077>>>        End
49077>>>>
49077>>>
49077>>>        Case Begin
49077>>>            Case (iDataFlexType = DF_ASCII)
49079>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_ASCII     of iDriver hDatabase to sRetval
49082>>>                Case Break
49083>>>            Case (iDataFlexType = DF_BCD)
49086>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_NUMERIC   of iDriver hDatabase to sRetval
49089>>>                Case Break
49090>>>            Case (iDataFlexType = DF_BINARY)
49093>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_BINARY    of iDriver hDatabase to sRetval
49096>>>                Case Break
49097>>>            Case (iDataFlexType = DF_DATE)
49100>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_DATE      of iDriver hDatabase to sRetval
49103>>>                Case Break
49104>>>            Case (iDataFlexType = DF_DATETIME)
49107>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_DATETIME  of iDriver hDatabase to sRetval
49110>>>                Case Break
49111>>>            Case (iDataFlexType = DF_TEXT)
49114>>>                Get_Attribute DF_DATABASE_DEFAULT_DEFAULT_TEXT      of iDriver hDatabase to sRetval
49117>>>                Case Break
49118>>>            Case Else
49118>>>                Move "" to sRetval
49119>>>        Case End
49119>>>
49119>>>        Function_Return sRetval
49120>>>    End_Function
49121>>>
49121>>>    Procedure Set Df_Database_Default_Default_Date_DUF String sDateValue
49123>>>        String sDriverID sServer
49123>>>        tColumnType RetvalType
49123>>>        tColumnType RetvalType
49123>>>        Integer iDbType iDriver
49123>>>        Handle hDatabase
49123>>>
49123>>>        Get psDriverID to sDriverID
49124>>>        Get piDbType   to iDbType
49125>>>        Get DriverIndex sDriverID to iDriver
49126>>>        Get psServer to sServer
49127>>>        Get SqlUtilDatabaseHandle sDriverID sServer to hDatabase
49128>>>        If (hDatabase = 0) Begin
49130>>>            Error DFERR_PROGRAM "Could not change the Default Date Value. Could not get a handle to the database."
49131>>>>
49131>>>            Procedure_Return
49132>>>        End
49132>>>>
49132>>>
49132>>>        Set_Attribute DF_DATABASE_DEFAULT_DEFAULT_DATE of iDriver hDatabase to sDateValue
49135>>>
49135>>>    End_Procedure
49136>>>
49136>>>    Procedure Set Df_Database_Default_Default_Datetime_DUF String sDateValue
49138>>>        String sDriverID sServer
49138>>>        tColumnType RetvalType
49138>>>        tColumnType RetvalType
49138>>>        Integer iDbType iDriver
49138>>>        Handle hDatabase
49138>>>
49138>>>        Get psDriverID to sDriverID
49139>>>        Get piDbType   to iDbType
49140>>>        Get DriverIndex sDriverID to iDriver
49141>>>        Get psServer to sServer
49142>>>        Get SqlUtilDatabaseHandle sDriverID sServer to hDatabase
49143>>>        If (hDatabase = 0) Begin
49145>>>            Error DFERR_PROGRAM "Could not change the Default DateTime Value. Could not get a handle to the database."
49146>>>>
49146>>>            Procedure_Return
49147>>>        End
49147>>>>
49147>>>
49147>>>        Set_Attribute DF_DATABASE_DEFAULT_DEFAULT_DATETIME of iDriver hDatabase to sDateValue
49150>>>
49150>>>    End_Procedure
49151>>>
49151>>>    // Returns a struct array with the default column types for the SQL back-end and how they
49151>>>    // are mapped to the standard DataFlex data types.
49151>>>    // The DataFlex data types are: "ASCII", "BINARY", "DATE", "DATETIME", "NUMERIC" and "TEXT".
49151>>>    Function UtilDefaultSqlTypeMappings String sDriverID Integer iDbType Returns tColumnType[]
49153>>>        tColumnType[] ColumnTypeArray EmptyArray
49153>>>        tColumnType[] ColumnTypeArray EmptyArray
49155>>>        String sDataType
49155>>>        Integer iDataType iDriverID iCount
49155>>>        Boolean bSQLDriver
49155>>>
49155>>>        Move 0 to iCount
49156>>>        Get DriverIndex sDriverID to iDriverID
49157>>>        Get IsSQLDriver sDriverID to bSQLDriver
49158>>>        If (bSQLDriver = False) Begin
49160>>>            Function_Return EmptyArray
49161>>>        End
49161>>>>
49161>>>
49161>>>        // DF_ASCII
49161>>>        If (sDriverID = ODBC_DRV_ID) Begin
49163>>>            Get_Attribute DF_DRIVER_MAP_DFASCII_TO_ODBCTYPE of iDriverID to sDataType
49166>>>        End
49166>>>>
49166>>>        Else Begin
49167>>>            Get_Attribute DF_DRIVER_MAP_DFASCII_TO_SQLTYPE  of iDriverID to sDataType
49170>>>        End
49170>>>>
49170>>>        Get UtilColumnTypeToInteger sDriverID iDbType sDataType to iDataType
49171>>>        Move DF_ASCII    to ColumnTypeArray[iCount].iDataFlexType
49172>>>        Move "ASCII"     to ColumnTypeArray[iCount].sDataFlexType
49173>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49174>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49175>>>        Increment iCount
49176>>>
49176>>>        // DF_BINARY
49176>>>        If (sDriverID = ODBC_DRV_ID) Begin
49178>>>            Get_Attribute DF_DRIVER_MAP_DFBINARY_TO_ODBCTYPE of iDriverID to sDataType
49181>>>        End
49181>>>>
49181>>>        Else Begin
49182>>>            Get_Attribute DF_DRIVER_MAP_DFBINARY_TO_SQLTYPE  of iDriverID to sDataType
49185>>>        End
49185>>>>
49185>>>        Get UtilColumnTypeToInteger sDriverID iDbType sDataType to iDataType
49186>>>        Move DF_BINARY   to ColumnTypeArray[iCount].iDataFlexType
49187>>>        Move "Binary"    to ColumnTypeArray[iCount].sDataFlexType
49188>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49189>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49190>>>        Increment iCount
49191>>>
49191>>>        // DF_DATE
49191>>>        If (sDriverID = ODBC_DRV_ID) Begin
49193>>>            Get_Attribute DF_DRIVER_MAP_DFDATE_TO_ODBCTYPE of iDriverID to sDataType
49196>>>        End
49196>>>>
49196>>>        Else Begin
49197>>>            Get_Attribute DF_DRIVER_MAP_DFDATE_TO_SQLTYPE  of iDriverID to sDataType
49200>>>        End
49200>>>>
49200>>>        Get UtilColumnTypeToInteger sDriverID iDbType sDataType to iDataType
49201>>>        Move DF_DATE     to ColumnTypeArray[iCount].iDataFlexType
49202>>>        Move "Date"      to ColumnTypeArray[iCount].sDataFlexType
49203>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49204>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49205>>>        Increment iCount
49206>>>
49206>>>        // DF_DATETIME
49206>>>        If (sDriverID = ODBC_DRV_ID) Begin
49208>>>            Get_Attribute DF_DRIVER_MAP_DFDATETIME_TO_ODBCTYPE of iDriverID to sDataType
49211>>>        End
49211>>>>
49211>>>        Else Begin
49212>>>            Get_Attribute DF_DRIVER_MAP_DFDATETIME_TO_SQLTYPE  of iDriverID to sDataType
49215>>>        End
49215>>>>
49215>>>        Get UtilColumnTypeToInteger sDriverID iDbType sDataType to iDataType
49216>>>        Move DF_DATETIME to ColumnTypeArray[iCount].iDataFlexType
49217>>>        Move "DateTime"  to ColumnTypeArray[iCount].sDataFlexType
49218>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49219>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49220>>>        Increment iCount
49221>>>
49221>>>        // DF_NUMERIC
49221>>>        // *** Why is there no DF_DRIVER_MAP available for BCD/Numeric??? ***
49221>>>        // DF_BCD can in SQL be either of "SmallInt", "Int", or "Numeric", but
49221>>>        // we make them here all "Numeric"...
49221>>>        Case Begin
49221>>>            Case (sDriverID = MSSQLDRV_ID)
49223>>>                Move SQL_NUMERIC to iDataType
49224>>>                Move "numeric"   to sDataType
49225>>>                Case Break
49226>>>            Case (sDriverID = DB2_DRV_ID)
49229>>>                Move SQL_NUMERIC to iDataType
49230>>>                Move "NUMERIC"   to sDataType
49231>>>                Case Break
49232>>>            Case (sDriverID = SQLFLEX)
49235>>>                Move eSQLServer_NUMERIC to iDataType
49236>>>                Move "numeric"   to sDataType
49237>>>                Case Break
49238>>>            Case (sDriverID = MDSMySQL)
49241>>>                Move eMySQL_DECIMAL to iDataType
49242>>>                Move "decimal"   to sDataType
49243>>>                Case Break
49244>>>            Case (sDriverID = ORAFLEX)
49247>>>                Move eOracle_NUMBER to iDataType
49248>>>                Move "NUMBER"   to sDataType
49249>>>                Case Break
49250>>>            Case (sDriverID = MDSPgSQL)
49253>>>                Move ePgSQL_FLOAT4 to iDataType
49254>>>                Move "decimal"   to sDataType
49255>>>                Case Break
49256>>>            Case Else
49256>>>                Move DF_BCD      to iDataType
49257>>>                Move "Numeric"   to sDataType
49258>>>        Case End
49258>>>        Move DF_BCD      to ColumnTypeArray[iCount].iDataFlexType
49259>>>        Move "Numeric"   to ColumnTypeArray[iCount].sDataFlexType
49260>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49261>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49262>>>        Increment iCount
49263>>>
49263>>>        // DF_TEXT
49263>>>        If (sDriverID = ODBC_DRV_ID) Begin
49265>>>            Get_Attribute DF_DRIVER_MAP_DFTEXT_TO_ODBCTYPE of iDriverID to sDataType
49268>>>        End
49268>>>>
49268>>>        Else Begin
49269>>>            Get_Attribute DF_DRIVER_MAP_DFTEXT_TO_SQLTYPE  of iDriverID to sDataType
49272>>>        End
49272>>>>
49272>>>        Get UtilColumnTypeToInteger sDriverID iDbType sDataType to iDataType
49273>>>        Move DF_TEXT     to ColumnTypeArray[iCount].iDataFlexType
49274>>>        Move "Text"      to ColumnTypeArray[iCount].sDataFlexType
49275>>>        Move sDataType   to ColumnTypeArray[iCount].sSQLType
49276>>>        Move iDataType   to ColumnTypeArray[iCount].iSQLType
49277>>>
49277>>>        Function_Return ColumnTypeArray
49278>>>    End_Function
49279>>>
49279>>>    Function UtilDFDataTypeToSqlTypeMapping String sDriverID Integer iDbType Integer iType Returns tColumnType
49281>>>        tColumnType[] ColumnTypeArray
49281>>>        tColumnType[] ColumnTypeArray
49282>>>        tColumnType   ColumnType
49282>>>        tColumnType   ColumnType
49282>>>        Integer iCount iSize
49282>>>
49282>>>        Get UtilDefaultSqlTypeMappings sDriverID iDbType iType to ColumnTypeArray
49283>>>        Move (SizeOfArray(ColumnTypeArray)) to iSize
49284>>>        Decrement iSize
49285>>>
49285>>>        for iCount from 0 to iSize
49291>>>>
49291>>>            If (iType = ColumnTypeArray[iCount].iDataFlexType) Begin
49293>>>                Move ColumnTypeArray[iCount].bCanEditSize   to ColumnType.bCanEditSize
49294>>>                Move ColumnTypeArray[iCount].iDataFlexType  to ColumnType.iDataFlexType
49295>>>                Move ColumnTypeArray[iCount].iSQLType       to ColumnType.iSQLType
49296>>>                Move ColumnTypeArray[iCount].sDataFlexType  to ColumnType.sDataFlexType
49297>>>                Move ColumnTypeArray[iCount].sPrecision     to ColumnType.sPrecision
49298>>>                Move ColumnTypeArray[iCount].sSQLType       to ColumnType.sSQLType
49299>>>                Move iSize to iCount
49300>>>            End
49300>>>>
49300>>>        Loop
49301>>>>
49301>>>
49301>>>        Function_Return ColumnType
49302>>>    End_Function
49303>>>
49303>>>    // Returns a struct with the default column types for the SQL back-end and how they
49303>>>    // are mapped to a DUF data type.
49303>>>    Function UtilDUFDataTypeToSqlTypeMapping String sDriverID Integer iDbType Integer iType Returns tColumnType
49305>>>        tColumnType ColumnType
49305>>>        tColumnType ColumnType
49305>>>        String sDataType
49305>>>        Integer iDriverID iCount
49305>>>
49305>>>        Move 0 to iCount
49306>>>        Get DriverIndex sDriverID to iDriverID
49307>>>
49307>>>        Case Begin
49307>>>            // DF_ASCII
49307>>>            Case (iType = DF_ASCII_DUF)
49309>>>                If (sDriverID = ODBC_DRV_ID) Begin
49311>>>                    Get_Attribute DF_DRIVER_MAP_DFASCII_TO_ODBCTYPE of iDriverID to sDataType
49314>>>                End
49314>>>>
49314>>>                Else Begin
49315>>>                    Get_Attribute DF_DRIVER_MAP_DFASCII_TO_SQLTYPE  of iDriverID to sDataType
49318>>>                End
49318>>>>
49318>>>                Move DF_ASCII    to ColumnType.iDataFlexType
49319>>>                Move "ASCII"     to ColumnType.sDataFlexType
49320>>>                Move sDataType   to ColumnType.sSQLType
49321>>>                Move DF_ASCII    to ColumnType.iSQLType
49322>>>                Move False       to ColumnType.bCanEditSize
49323>>>                Case Break
49324>>>
49324>>>            // DF_BINARY
49324>>>            Case (iType = DF_BINARY_DUF)
49327>>>                If (sDriverID = ODBC_DRV_ID) Begin
49329>>>                    Get_Attribute DF_DRIVER_MAP_DFBINARY_TO_ODBCTYPE of iDriverID to sDataType
49332>>>                End
49332>>>>
49332>>>                Else Begin
49333>>>                    Get_Attribute DF_DRIVER_MAP_DFBINARY_TO_SQLTYPE  of iDriverID to sDataType
49336>>>                End
49336>>>>
49336>>>                Move DF_BINARY   to ColumnType.iDataFlexType
49337>>>                Move "Binary"    to ColumnType.sDataFlexType
49338>>>                Move sDataType   to ColumnType.sSQLType
49339>>>                Move DF_BINARY   to ColumnType.iSQLType
49340>>>                Move False       to ColumnType.bCanEditSize
49341>>>                Case Break
49342>>>
49342>>>            // DF_DATE
49342>>>            Case (iType = DF_DATE_DUF)
49345>>>                If (sDriverID = ODBC_DRV_ID) Begin
49347>>>                    Get_Attribute DF_DRIVER_MAP_DFDATE_TO_ODBCTYPE of iDriverID to sDataType
49350>>>                End
49350>>>>
49350>>>                Else Begin
49351>>>                    Get_Attribute DF_DRIVER_MAP_DFDATE_TO_SQLTYPE  of iDriverID to sDataType
49354>>>                End
49354>>>>
49354>>>                Move DF_DATE     to ColumnType.iDataFlexType
49355>>>                Move "Date"      to ColumnType.sDataFlexType
49356>>>                Move sDataType   to ColumnType.sSQLType
49357>>>                Move DF_DATE     to ColumnType.iSQLType
49358>>>                Move True        to ColumnType.bCanEditSize
49359>>>                Case Break
49360>>>
49360>>>            // DF_DATETIME
49360>>>            Case (iType = DF_DATETIME_DUF)
49363>>>                If (sDriverID = ODBC_DRV_ID) Begin
49365>>>                    Get_Attribute DF_DRIVER_MAP_DFDATETIME_TO_ODBCTYPE of iDriverID to sDataType
49368>>>                End
49368>>>>
49368>>>                Else Begin
49369>>>                    Get_Attribute DF_DRIVER_MAP_DFDATETIME_TO_SQLTYPE  of iDriverID to sDataType
49372>>>                End
49372>>>>
49372>>>                Move DF_DATETIME to ColumnType.iDataFlexType
49373>>>                Move "DateTime"  to ColumnType.sDataFlexType
49374>>>                Move sDataType   to ColumnType.sSQLType
49375>>>                Move DF_DATETIME to ColumnType.iSQLType
49376>>>                Move True        to ColumnType.bCanEditSize
49377>>>                Case Break
49378>>>
49378>>>            // DF_NUMERIC
49378>>>            // *** Why is there no DF_DRIVER_MAP available for BCD/Numeric??? ***
49378>>>            // DF_BCD can in SQL be either of "SmallInt", "Int", or "Numeric", but
49378>>>            // we make them here all "Numeric"...
49378>>>            // If (sDriverID = ODBC_DRV_ID) Begin
49378>>>            //     Get_Attribute DF_DRIVER_MAP_DFDATE_TO_ODBCTYPE of iDriverID to sDataType
49378>>>            // End
49378>>>            // Else Begin
49378>>>            //     Get_Attribute DF_DRIVER_MAP_DFDATE_TO_SQLTYPE  of iDriverID to sDataType
49378>>>            // End
49378>>>            // ToDo: How should we find the best "Numeric" data type here?
49378>>>            Case (iType = DF_BCD_DUF)
49381>>>                Move DF_BCD      to ColumnType.iDataFlexType
49382>>>                Move "Numeric"   to ColumnType.sDataFlexType
49383>>>                Move "Numeric"   to ColumnType.sSQLType
49384>>>                Move SQL_NUMERIC to ColumnType.iSQLType
49385>>>                Move False       to ColumnType.bCanEditSize
49386>>>                Case Break
49387>>>
49387>>>            // DF_TEXT
49387>>>            Case (iType = DF_TEXT_DUF)
49390>>>                If (sDriverID = ODBC_DRV_ID) Begin
49392>>>                    Get_Attribute DF_DRIVER_MAP_DFTEXT_TO_ODBCTYPE of iDriverID to sDataType
49395>>>                End
49395>>>>
49395>>>                Else Begin
49396>>>                    Get_Attribute DF_DRIVER_MAP_DFTEXT_TO_SQLTYPE  of iDriverID to sDataType
49399>>>                End
49399>>>>
49399>>>                Move DF_TEXT     to ColumnType.iDataFlexType
49400>>>                Move "Text"      to ColumnType.sDataFlexType
49401>>>                Move sDataType   to ColumnType.sSQLType
49402>>>                Move DF_TEXT     to ColumnType.iSQLType
49403>>>                Move False       to ColumnType.bCanEditSize
49404>>>                Case Break
49405>>>
49405>>>            Case Else
49405>>>                Move -1999       to ColumnType.iDataFlexType
49406>>>                Move "Undefined" to ColumnType.sDataFlexType
49407>>>                Move "Undefined" to ColumnType.sSQLType
49408>>>                Move -1999       to ColumnType.iSQLType
49409>>>                Move True        to ColumnType.bCanEditSize
49410>>>
49410>>>        Case End
49410>>>
49410>>>        Function_Return ColumnType
49411>>>    End_Function
49412>>>
49412>>>    Function UtilDeleteCacheFile String sTableName Returns Boolean
49414>>>        String sDataPath sDriverID
49414>>>        Boolean bMertechDriver bOK
49414>>>        Integer iPos
49414>>>
49414>>>        If (sTableName contains ".") Begin
49416>>>            Move (Pos(".", sTableName)) to iPos
49417>>>            Move (Mid(sTableName, 999, (iPos +1))) to sTableName
49418>>>        End
49418>>>>
49418>>>
49418>>>        Get psDriverID to sDriverID
49419>>>        Get psDataPathFirstPart to sDataPath
49420>>>        Get IsMertechDriver sDriverID to bMertechDriver
49421>>>        // First delete the cache file:
49421>>>        If (bMertechDriver = False) Begin
49423>>>            Get vDeleteFile (sDataPath + sTableName + ".cch") to bOK
49424>>>        End
49424>>>>
49424>>>        Else Begin
49425>>>            Get _MertechDeleteTDFile sTableName to bOK
49426>>>        End
49426>>>>
49426>>>
49426>>>        Function_Return bOK
49427>>>    End_Function
49428>>>
49428>>>    // Changes source code files.
49428>>>    // Pass a file name with full path and a value to search for, together with the value
49428>>>    // to change to. Can e.g. be used for changing all .int files from using a fixed server name,
49428>>>    // to use a Connection ID.
49428>>>    // Sample: Get UtilChangeSourceCodeLine "C:\DataFlex 18.2 Examples\Order Entry\Data\Order.int" "SERVER_NAME SERVER=(local)\SQLEXPRESS1" "SERVER_NAME DFCONNID=ChinookDb"
49428>>>    // Pass "True" for the bShowResult if you want to see the result while it works. Showln will then be used for output
49428>>>    // Returns True if no errors occured.
49428>>>    Function UtilChangeSourceCodeLine String sFileName String sChangeFrom String sChangeTo Boolean bShowResult Returns Boolean
49430>>>        Integer iCh iRow iItems iCount
49430>>>        String sValue sRow
49430>>>        String[] sFileArray
49431>>>        Boolean bExists bIsActive
49431>>>
49431>>>        Move False to Err
49432>>>        Move 0 to iRow
49433>>>
49433>>>        If (ghoStatusPanel <> 0) Begin
49435>>>            Get Active_state of ghoStatusPanel to bIsActive
49436>>>        End
49436>>>>
49436>>>
49436>>>        Get vFilePathExists sFileName to bExists
49437>>>        If (bExists = False) Begin
49439>>>            If (bShowResult = True) Begin
49441>>>                If (bIsActive = True) Begin
49443>>>                    Send Update_StatusPanel of ghoStatusPanel ("File does not exist:" * String(sFileName))
49444>>>                End
49444>>>>
49444>>>                Else Begin
49445>>>                    Showln "File does not exist: " sFileName
49448>>>                End
49448>>>>
49448>>>            End
49448>>>>
49448>>>            Function_Return False
49449>>>        End
49449>>>>
49449>>>
49449>>>        Get Seq_Open_Input_Channel sFileName to iCh
49450>>>        If (iCh < 1) Begin
49452>>>            Function_Return False
49453>>>        End
49453>>>>
49453>>>
49453>>>        If (bShowResult = True) Begin
49455>>>            If (ghoStatusPanel <> 0) Begin
49457>>>                Get Active_state of ghoStatusPanel to bIsActive
49458>>>                If (bIsActive = True) Begin
49460>>>                    Set Message_Text of ghoStatusPanel to sFileName
49461>>>                    Send Update_StatusPanel of ghoStatusPanel ("sChangeFrom =" * String(sChangeFrom) * "sChangeTo =" * String(sChangeTo))
49462>>>                    Send DoAdvance of ghoProgressBar
49463>>>                End
49463>>>>
49463>>>            End
49463>>>>
49463>>>            Else Begin
49464>>>                Showln ""
49466>>>                Showln "sFileName = " sFileName
49469>>>                Showln "sChangeFrom = " sChangeFrom " sChangeTo = " sChangeTo
49474>>>            End
49474>>>>
49474>>>        End
49474>>>>
49474>>>
49474>>>        While (not(SeqEof))
49478>>>            Readln channel iCh sRow
49480>>>            If (Uppercase(sRow) contains Uppercase(sChangeFrom)) Begin
49482>>>//                If (bShowResult = True) Begin
49482>>>//                    If (bIsActive = True) Begin
49482>>>//                        Send Update_StatusPanel of ghoStatusPanel ("Changed from:" * String(sRow) * "to:" * String(sChangeTo))
49482>>>//                    End
49482>>>//                    Else Begin
49482>>>//                        Showln "Changed from: " sRow " to: " sChangeTo
49482>>>//                    End
49482>>>//                End
49482>>>                // Change the whole line to the new connection id:
49482>>>                Move sChangeTo to sRow
49483>>>                // Move (Replaces(sChangeFrom, sRow, sChangeTo)) to sValue
49483>>>            End
49483>>>>
49483>>>            Move sRow to sFileArray[iRow]
49484>>>            Increment iRow
49485>>>        End
49486>>>>
49486>>>        Send Seq_Close_Channel iCh
49487>>>
49487>>>        Sleep 1 // Wait for Windows to close the file
49488>>>
49488>>>        Get Seq_Open_Output_Channel sFileName to iCh
49489>>>        If (iCh < 1) Begin
49491>>>            Function_Return False
49492>>>        End
49492>>>>
49492>>>        Move (SizeOfArray(sFileArray)) to iItems
49493>>>        Decrement iItems
49494>>>
49494>>>        For iCount from 0 to iItems
49500>>>>
49500>>>            Move sFileArray[iCount] to sValue
49501>>>            Writeln channel iCh sValue
49504>>>        Loop
49505>>>>
49505>>>        Send Seq_Close_Channel iCh
49506>>>
49506>>>        Function_Return (Err = False)
49507>>>    End_Function
49508>>>
49508>>>    // This might be needed by API-methods when a connection id is to be used and
49508>>>    // the connection ID hasn't been established with the driver's CLI interface.
49508>>>    // NOTE: Only applicable for DAW drivers, as Mertech drivers doesn't use connection ID's.
49508>>>    Function UtilCreateConnectionID String sConnectionID Returns Boolean
49510>>>        String sConnectionString sDriverID
49510>>>        Boolean bOK bSilent bDawDriver
49510>>>        Handle hoCLI
49510>>>
49510>>>        Move False to bOK
49511>>>        Get psDriverID to sDriverID
49512>>>        Get IsDAWSQLDriver sDriverID to bDawDriver
49513>>>        If (bDawDriver = False) Begin
49515>>>            Error DFERR_PROGRAM "The UtilCreateConnectionID function is only available for DAW drivers. (Not Mertech)."
49516>>>>
49516>>>            Function_Return False
49517>>>        End
49517>>>>
49517>>>
49517>>>        Get psConnectionString to sConnectionString
49518>>>        Get pbSilentLogin      to bSilent
49519>>>
49519>>>        Get phoCLIHandler to hoCLI
49520>>>        If (hoCLI <> 0) Begin
49522>>>            Set psDriverID of hoCLI to sDriverID
49523>>>            Get CreateConnectionID of hoCLI sConnectionID sConnectionString bSilent to bOK
49524>>>        End
49524>>>>
49524>>>
49524>>>        Function_Return (bOK = False)
49525>>>    End_Function
49526>>>
49526>>>    // This message creates an error log in the "Home" folder named "SQLErrorLog.txt",
49526>>>    // and opens it in "notepad.exe".
49526>>>    // Note: This is _not_ used by the cDbUpdateHandler & cDbUpdateVersion classes!
49526>>>    //       Instead the cDbUpdateLogFile's WriteErrorLog & ShowErrorLog are used.
49526>>>    Procedure UtilShowErrorList
49528>>>        tSqlErrorArray aSqlErrorArray
49528>>>        tSqlErrorArray aSqlErrorArray
49528>>>        Integer iRows iCount iCh iErrorNum
49528>>>        String sPath sFileName sErrorTxt sStatement
49528>>>
49528>>>        Get psHome of (phoWorkspace(ghoApplication)) to sPath
49529>>>        Get vFolderFormat sPath to sPath
49530>>>        Move "SQLErrorLog.txt"  to sFileName
49531>>>        Get Seq_Open_Output_Channel (sPath + sFileName) to iCh
49532>>>            Get paSqlErrorArray to aSqlErrorArray
49533>>>            Move (SizeOfArray(aSqlErrorArray.sSqlErrorArray)) to iRows
49534>>>            If (iRows > 0) Begin
49536>>>                Decrement iRows
49537>>>                for iCount from 0 to iRows
49543>>>>
49543>>>                    Move aSqlErrorArray.sSqlErrorArray[iCount]      to sErrorTxt
49544>>>                    Move aSqlErrorArray.sSqlStatementArray[iCount]  to sStatement
49545>>>                    Move aSqlErrorArray.iSqlErrorArray[iCount]      to iErrorNum
49546>>>                    Writeln channel iCh "Error No: " iErrorNum " Error Text: " sErrorTxt
49552>>>                    Writeln channel iCh "SQL Statement: " sStatement
49556>>>                Loop
49557>>>>
49557>>>            End
49557>>>>
49557>>>        Send Seq_Close_Channel iCh
49558>>>
49558>>>        If (iRows > 0) Begin
49560>>>            Runprogram Shell Background (sPath + sFileName)
49561>>>        End
49561>>>>
49561>>>    End_Procedure
49562>>>
49562>>>    // For this to be returning a True value, the table number needs to be in the Filelist.cfg,
49562>>>    // and the table needs to exist as an SQL table.
49562>>>    Function UtilTableIsSql Handle hTable Returns Boolean
49564>>>        String sRootName sDriverID
49564>>>        Boolean bIsSQL
49564>>>
49564>>>        Move False to bIsSQL
49565>>>        If (hTable > 0) Begin
49567>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
49570>>>            Move (sRootName contains ":") to bIsSQL
49571>>>            If (bIsSQL = True) Begin
49573>>>                Get psDriverID to sDriverID
49574>>>                Get _TableNameOnly sRootName to sRootName
49575>>>                Get SqlUtilCheckIfTableNameExists sRootName sDriverID to bIsSQL
49576>>>            End
49576>>>>
49576>>>        End
49576>>>>
49576>>>
49576>>>        Function_Return bIsSQL
49577>>>    End_Function
49578>>>
49578>>>    Function UtilTableIsSqlByRootName String sRootName Returns Boolean
49580>>>        Boolean bIsSQL
49580>>>        Move (sRootName contains ":") to bIsSQL
49581>>>        Function_Return bIsSQL
49582>>>    End_Function
49583>>>
49583>>>
49583>>>    // Returns True if the passed hTable (filelist slot number) is an Alias table.
49583>>>    // An Alias file/table is a filelist number that share the same Physical filename
49583>>>    // but the Logical name is different.
49583>>>    // Note: If the table cannot be opened; the table is not considered to be an Alias.
49583>>>//    Function UtilTableIsAlias Handle hTable Returns Boolean
49583>>>//        String sPhysicalName sPhysicalNameCompare
49583>>>//        Boolean bWasOpen bOpened bOK
49583>>>//        Integer iCount
49583>>>//
49583>>>//        Move 0 to iCount
49583>>>//        Get_Attribute DF_FILE_OPENED of hTable to bWasOpen
49583>>>//        If (bWasOpen = False) Begin
49583>>>//            Open hTable
49583>>>//            Get_Attribute DF_FILE_OPENED of hTable to bOpened
49583>>>//            If (bOpened = False) Begin
49583>>>//                Function_Return False
49583>>>//            End
49583>>>//        End
49583>>>//
49583>>>//        Get_Attribute DF_FILE_PHYSICAL_NAME of hTable to sPhysicalName
49583>>>//        Get _TableNameOnly sPhysicalName to sPhysicalName
49583>>>//        If (bWasOpen = False and bOpened = True) Begin
49583>>>//            Close hTable
49583>>>//        End
49583>>>//
49583>>>//        Move 0 to hTable
49583>>>//        Repeat
49583>>>//            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49583>>>//            If (hTable > 0 and hTable <> 50) Begin
49583>>>//                Open hTable
49583>>>//                Get_Attribute DF_FILE_OPENED of hTable to bOpened
49583>>>//                If (bOpened = True) Begin
49583>>>//                    Get_Attribute DF_FILE_PHYSICAL_NAME of hTable to sPhysicalNameCompare
49583>>>//                    Close hTable
49583>>>//                    Get _TableNameOnly sPhysicalNameCompare to sPhysicalNameCompare
49583>>>//                    If (Uppercase(sPhysicalName) = Uppercase(sPhysicalNameCompare)) Begin
49583>>>//                        Increment iCount
49583>>>//                    End
49583>>>//                End
49583>>>//            End
49583>>>//        Until (hTable = 0)
49583>>>//
49583>>>//        If (iCount > 1) Begin
49583>>>//            Function_Return True
49583>>>//        End
49583>>>//
49583>>>//        Function_Return False
49583>>>//    End_Function
49583>>>
49583>>>    Function UtilTableIsAlias Handle hTable Returns Boolean
49585>>>        String sPhysicalName sPhysicalNameCompare
49585>>>        Integer iCount iMaster iAlias iInTable
49585>>>
49585>>>        Get_Attribute DF_FILE_ROOT_NAME of hTable to sPhysicalName
49588>>>        Get _TableNameOnly sPhysicalName to sPhysicalName
49589>>>        Move hTable to iInTable
49590>>>        Move 0 to hTable
49591>>>        Move 0 to iCount
49592>>>
49592>>>        Repeat
49592>>>>
49592>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49595>>>            If (hTable > 0 and hTable <> 50) Begin
49597>>>                Get_Attribute DF_FILE_ROOT_NAME of hTable to sPhysicalNameCompare
49600>>>                Get _TableNameOnly sPhysicalNameCompare to sPhysicalNameCompare
49601>>>                If (Uppercase(sPhysicalName) = Uppercase(sPhysicalNameCompare)) Begin
49603>>>
49603>>>                    If (iCount = 0) Begin
49605>>>                        Move hTable to iMaster
49606>>>                    End
49606>>>>
49606>>>                    If (iCount > 0) Begin
49608>>>                        Move hTable to iAlias
49609>>>                    End
49609>>>>
49609>>>                    Increment iCount
49610>>>                End
49610>>>>
49610>>>            End
49610>>>>
49610>>>        Until (hTable = 0)
49612>>>
49612>>>        If (iCount > 1) Begin
49614>>>            Function_Return (iInTable >= iAlias and iAlias > iMaster)
49615>>>        End
49615>>>>
49615>>>
49615>>>        Function_Return False
49616>>>    End_Function
49617>>>
49617>>>//    Function UtilTableIsAliasFdFile Handle hTable Returns Boolean
49617>>>//        String sDDSrcPath sDataPath sLogicalName
49617>>>//        Boolean bOK bExists
49617>>>//
49617>>>//        Get psDataPath  of (phoWorkspace(ghoApplication)) to sDataPath
49617>>>//        If (Right(sDataPath, 1) = "\") Begin
49617>>>//            Move (Left(sDataPath, (Length(sDataPath) -1))) to sDataPath
49617>>>//        End
49617>>>//        Move (StringFromRightOfChar(sDataPath, "\")) to sDDSrcPath
49617>>>//        Move (Replace(sDDSrcPath, sDataPath, ""))    to sDDSrcPath
49617>>>//        Move (sDDSrcPath + "DDSrc")                  to sDDSrcPath
49617>>>//        Get vFolderFormat sDDSrcPath                 to sDDSrcPath
49617>>>//
49617>>>//        Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sLogicalName
49617>>>//        Get vFilePathExists (sDDSrcPath + sLogicalName + ".fd") to bExists
49617>>>//
49617>>>//        Function_Return bExists
49617>>>//    End_Function
49617>>>
49617>>>    // To Open a table with any driver.
49617>>>    // Note: If the driver is <> DATAFLEX_ID  - login credentials are used; it is then assumed
49617>>>    //       that the proper login properties has been setup properly with the cSQLConnections object.
49617>>>    //
49617>>>    // If the open command fails the Err flag will be reset to false, at the end of the function!
49617>>>    // The found flag is still used to indicate if the open was successful or not. The function
49617>>>    // returns a True if successful (table could be opened).
49617>>>    //
49617>>>    // Using the "Open As" syntax with drivers means that we don't need to rely on .int file settings.
49617>>>    // This is good because with DFConnectionID's those credentials doesn't need to be available in
49617>>>    // the .int file (and probably aren't). As long as the login properties of this object have been
49617>>>    // set properly we can open the table.
49617>>>    //
49617>>>    // DAW Driver Syntax:
49617>>>    //  <CKId>:<Schema>#<Table>@<ConnectString>|<Filename>.int
49617>>>    //  Now the @<ConnectString> can be followed by a pipe character '|' followed by the name of the INT file.
49617>>>    //  Doing so, the driver will apply the information from the .INT file to the passed direct Open String.
49617>>>    //  Note that when an INT file has been passed, it will skip the keyword DRIVER_NAME, SERVER_NAME,
49617>>>    //  DATABASE_NAME and SCHEMA_NAME from the INT file because those are supposed to be supplied in the String already.
49617>>>    //  Open mode; iMode = DF_SHARE or DF_EXCLUSIVE.
49617>>>    //
49617>>>    // DAW Driver Sample:
49617>>>    //   Open "MSSQLDRV:dbo#MyFile@SERVER=(local)\SQLEXPRESS;Trusted_Connection=yes;DATABASE=OrderEntry|options|intfile=MyFile.int"
49617>>>    //
49617>>>    // Mertech Driver Samples:
49617>>>    //   SQLFlex:   Open "sql_drv:\\<serverName>\<database>*<owner>*<tableName>=<numberFieds>" as table
49617>>>    //   MySQLFlex: Open "mdsmysql:\\<serverName>\<database>*<tableName>=<numberFieds>" as table
49617>>>    //   PgFlex:    Open "mdspgsql:\\<serverName>\<database>*<schema>*<tableName>=<numberFieds>" as table
49617>>>    //   ORAFlex:   Open "ora_drv:\\<serverName>\<owner>*<tableName>=<numberFieds>" as table
49617>>>    Function UtilTableOpen Integer hTable String sTableName Integer iMode Returns Boolean
49619>>>        String sDriverID sConnection sSchema sExt sTableNameShort sTableNameOrg
49619>>>        Boolean bOpen bMertechDriver bOK
49619>>>        tSQLConnection SQLConnection
49619>>>        tSQLConnection SQLConnection
49619>>>
49619>>>        Move sTableName to sTableNameOrg
49620>>>        If (hTable > 0) Begin
49622>>>            Send Ignore_Error of Error_Object_Id 20529
49623>>>            Send Ignore_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
49624>>>            Send Ignore_Error of Error_Object_Id CLIERR_CONNECTIONIDNOTFOUND
49625>>>            Open hTable
49627>>>            Send Trap_Error of Error_Object_Id 20529
49628>>>            Send Trap_Error of Error_Object_Id DFERR_CANT_OPEN_DATA_FILE
49629>>>            Send Trap_Error of Error_Object_Id CLIERR_CONNECTIONIDNOTFOUND
49630>>>            Get_Attribute DF_FILE_OPENED of hTable to bOpen
49633>>>            If (bOpen = True) Begin
49635>>>                Function_Return True
49636>>>            End
49636>>>>
49636>>>        End
49636>>>>
49636>>>
49636>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
49637>>>        Move SQLConnection.sDriverID to sDriverID
49638>>>        Get IsMertechDriver sDriverID to bMertechDriver
49639>>>        Move SQLConnection.sConnectionString to sConnection
49640>>>        Move SQLConnection.sSchema to sSchema
49641>>>        If (sSchema = "") Begin
49643>>>            Get _SqlFindKeyWord CI_SQLDBO to sSchema
49644>>>        End
49644>>>>
49644>>>
49644>>>        // We need to remove the ".int" part of the table name because
49644>>>        // the table name after the "#" in the connection syntax below wants the
49644>>>        // "bare" table name without any extension.
49644>>>        If (sDriverID <> DATAFLEX_ID) Begin
49646>>>            If (Lowercase(sTableName) contains ".int") Begin
49648>>>                Get ParseFileExtension sTableName to sExt
49649>>>                Move (Replace(("." + sExt), sTableName, "")) to sTableNameShort
49650>>>            End
49650>>>>
49650>>>            Else Begin
49651>>>                Move sTableName to sTableNameShort
49652>>>                Move (Append(sTableName, ".int")) to sTableName
49653>>>            End
49653>>>>
49653>>>            If (bMertechDriver = False) Begin
49655>>>                Move (sDriverID + ":" + sSchema + "#" + sTableNameShort + "@" + sConnection + "|options|intfile=" + sTableName) to sConnection
49656>>>                Move sConnection to sTableName
49657>>>            End
49657>>>>
49657>>>        End
49657>>>>
49657>>>
49657>>>        Send Ignore_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
49658>>>        Send Ignore_Error of Error_Info_Object DFERR_FILE_ACCESS_VIOLATION
49659>>>        If (hTable = 0) Begin
49661>>>            Get NextFreeFilelistSlot to hTable
49662>>>        End
49662>>>>
49662>>>
49662>>>        Case Begin
49662>>>            Case (sDriverID = MSSQLDRV_ID)
49664>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49664>>>                If (iMode <> DF_EXCLUSIVE) Begin
49666>>>                    Open sTableName as hTable
49668>>>                End
49668>>>>
49668>>>                Else Begin
49669>>>                    Get OpenTableExclusive hTable to bOK
49670>>>                    If (bOK = False) Begin
49672>>>                        Function_Return False
49673>>>                    End
49673>>>>
49673>>>                End
49673>>>>
49673>>>                Case Break
49674>>>
49674>>>            Case (sDriverID = DB2_DRV_ID)
49677>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49677>>>                If (iMode <> DF_EXCLUSIVE) Begin
49679>>>                    Open sTableName as hTable
49681>>>                End
49681>>>>
49681>>>                Else Begin
49682>>>                    Get OpenTableExclusive hTable to bOK
49683>>>                    If (bOK = False) Begin
49685>>>                        Function_Return False
49686>>>                    End
49686>>>>
49686>>>                End
49686>>>>
49686>>>                Case Break
49687>>>
49687>>>            Case (sDriverID = ODBC_DRV_ID)
49690>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49690>>>                If (iMode <> DF_EXCLUSIVE) Begin
49692>>>                    Open sTableName as hTable
49694>>>                End
49694>>>>
49694>>>                Else Begin
49695>>>                    Get OpenTableExclusive hTable to bOK
49696>>>                    If (bOK = False) Begin
49698>>>                        Function_Return False
49699>>>                    End
49699>>>>
49699>>>                End
49699>>>>
49699>>>                Case Break
49700>>>
49700>>>            Case (sDriverID = SQLFLEX)
49703>>>                // ToDo: What is the <owner>? Same as Schema?
49703>>>                // SQLFlex:   Open "sql_drv:\\<serverName>\<database>*<owner>*<tableName>=<numberFieds>" as table
49703>>>                Move (SQLFLEX + ":\\" + SQLConnection.sServer + "\" + SQLConnection.sDatabase + SQLConnection.sSchema + "*" + sTableNameOrg) to sTableName
49704>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49704>>>                If (iMode <> DF_EXCLUSIVE) Begin
49706>>>                    Open sTableName as hTable
49708>>>                End
49708>>>>
49708>>>                Else Begin
49709>>>                    Get OpenTableExclusive hTable to bOK
49710>>>                    If (bOK = False) Begin
49712>>>                        Function_Return False
49713>>>                    End
49713>>>>
49713>>>                End
49713>>>>
49713>>>                Case Break
49714>>>
49714>>>            Case (sDriverID = MDSMySQL)
49717>>>                // MySQLFlex: Open "mdsmysql:\\<serverName>\<database>*<tableName>=<numberFieds>" as table
49717>>>                Move (MDSMySQL + ":\\" + SQLConnection.sServer + "\" + SQLConnection.sDatabase + "*" + sTableNameOrg) to sTableName
49718>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49718>>>                If (iMode <> DF_EXCLUSIVE) Begin
49720>>>                    Open sTableName as hTable
49722>>>                End
49722>>>>
49722>>>                Else Begin
49723>>>                    Get OpenTableExclusive hTable to bOK
49724>>>                    If (bOK = False) Begin
49726>>>                        Function_Return False
49727>>>                    End
49727>>>>
49727>>>                End
49727>>>>
49727>>>                Case Break
49728>>>
49728>>>            Case (sDriverID = MDSPgSQL)
49731>>>                // PgFlex: Open "mdspgsql:\\<serverName>\<database>*<schema>*<tableName>=<numberFieds>" as table
49731>>>                Move (MDSPgSQL + ":\\" + SQLConnection.sServer + "\" + SQLConnection.sDatabase + "*" + SQLConnection.sSchema + "*" + sTableNameOrg) to sTableName
49732>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49732>>>                If (iMode <> DF_EXCLUSIVE) Begin
49734>>>                    Open sTableName as hTable
49736>>>                End
49736>>>>
49736>>>                Else Begin
49737>>>                    Get OpenTableExclusive hTable to bOK
49738>>>                    If (bOK = False) Begin
49740>>>                        Function_Return False
49741>>>                    End
49741>>>>
49741>>>                End
49741>>>>
49741>>>                Case Break
49742>>>
49742>>>            Case (sDriverID = ORAFLEX)
49745>>>                // ToDo: What is the <owner>? Same as Schema?
49745>>>                // ORAFlex: Open "ora_drv:\\<serverName>\<owner>*<tableName>=<numberFieds>" as table
49745>>>                Move (ORAFLEX + ":\\" + SQLConnection.sServer + "\" + SQLConnection.sSchema + "*" + sTableName) to sTableName
49746>>>                // If not df_exclusive mode, we use the "Open As" syntax.
49746>>>                If (iMode <> DF_EXCLUSIVE) Begin
49748>>>                    Open sTableName as hTable
49750>>>                End
49750>>>>
49750>>>                Else Begin
49751>>>                    Get OpenTableExclusive hTable to bOK
49752>>>                    If (bOK = False) Begin
49754>>>                        Function_Return False
49755>>>                    End
49755>>>>
49755>>>                End
49755>>>>
49755>>>                Case Break
49756>>>
49756>>>            Case (sDriverID = DATAFLEX_ID)
49759>>>                If (sTableName <> "" and iMode <> DF_EXCLUSIVE) Begin
49761>>>                    Open sTableName as hTable
49763>>>                End
49763>>>>
49763>>>                Else If (iMode = DF_EXCLUSIVE) Begin
49766>>>                    Get OpenTableExclusive hTable to bOK
49767>>>                    If (bOK = False) Begin
49769>>>                        Function_Return False
49770>>>                    End
49770>>>>
49770>>>                End
49770>>>>
49770>>>                Else Begin
49771>>>                    Open hTable
49773>>>                End
49773>>>>
49773>>>                Case Break
49774>>>
49774>>>            // ToDo: Logic needs to be expanded for Mertech drivers!
49774>>>
49774>>>            Case Else
49774>>>                Error DFERR_PROGRAM ("Invalid driver:" * sDriverID)
49775>>>>
49775>>>        Case End
49775>>>
49775>>>        Send Trap_Error of Error_Object_Id CLIERR_LOGIN_UNSUCCESSFUL
49776>>>        Send Trap_Error of Error_Info_Object DFERR_FILE_ACCESS_VIOLATION
49777>>>        If (LastErr = CLIERR_LOGIN_UNSUCCESSFUL) Begin
49779>>>            Move False to Found
49780>>>        End
49780>>>>
49780>>>        // If open failed, the Err is set to true,
49780>>>        // but we don't want that because it could end our loop.
49780>>>        Move False to Err
49781>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
49784>>>
49784>>>        Function_Return bOpen
49785>>>    End_Function
49786>>>
49786>>>    // Checks that the passed hTable number both exists in Filelist.cfg and
49786>>>    // that the embedded .dat file exists on disk _or_ that the SQL table exists
49786>>>    // if it is an SQL table
49786>>>    Function UtilTableExists Handle hTable Returns Boolean
49788>>>        Boolean bExists bIsSQLTable
49788>>>        String sDataPath sRootName
49788>>>
49788>>>        Get UtilTableNumberIsInUse hTable to bExists
49789>>>        If (bExists = False) Begin
49791>>>            Function_Return False
49792>>>        End
49792>>>>
49792>>>
49792>>>        Move False to bIsSQLTable
49793>>>        If (hTable > 0) Begin
49795>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
49798>>>            Move (sRootName contains ":") to bIsSQLTable
49799>>>        End
49799>>>>
49799>>>        If (bIsSQLTable = True) Begin
49801>>>            Get UtilTableIsSQL hTable to bExists
49802>>>            Function_Return bExists
49803>>>        End
49803>>>>
49803>>>        Else Begin
49804>>>            Get psDataPath of (phoWorkspace(ghoApplication)) to sDataPath
49805>>>            Get vFolderFormat sDataPath to sDataPath
49806>>>            Get vFilePathExists (sDataPath + sRootName + ".dat") to bExists
49807>>>        End
49807>>>>
49807>>>
49807>>>        Function_Return bExists
49808>>>    End_Function
49809>>>
49809>>>    // Pass a table handle
49809>>>    // Returns True if the table exists in filelist.cfg.
49809>>>    Function UtilTableNumberIsInUse Handle hCheckTable Returns Boolean
49811>>>        Handle hTable
49811>>>        Boolean bFound
49811>>>
49811>>>        Move False to bFound
49812>>>        Move 0 to hTable
49813>>>        Repeat
49813>>>>
49813>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49816>>>            If (hTable > 0) Begin
49818>>>                If (hTable = hCheckTable) Begin
49820>>>                    Move True to bFound
49821>>>                End
49821>>>>
49821>>>            End
49821>>>>
49821>>>            If (bFound = True) ;                Break
49824>>>        Until (hTable = 0)
49826>>>
49826>>>        Function_Return (bFound = True)
49827>>>    End_Function
49828>>>
49828>>>    Function UtilDriverFromTableNumber Handle hTable Returns String
49830>>>        Boolean bOK bExists                              
49830>>>        String sDriverID
49830>>>        
49830>>>        Get UtilTableExists hTable to bExists
49831>>>        If (bExists = False) Begin
49833>>>            Function_Return ""
49834>>>        End
49834>>>>
49834>>>        Get OpenTableExclusive hTable to bOK
49835>>>        If (bOK = False) Begin
49837>>>            Function_Return ""
49838>>>        End 
49838>>>>
49838>>>        Get_Attribute DF_FILE_DRIVER of hTable to sDriverID
49841>>>        
49841>>>        Function_Return sDriverID
49842>>>    End_Function        
49843>>>    
49843>>>    // Number of tables in Filelist.cfg. Returns integger
49843>>>    Function UtilFilelistNoOfTables Returns Integer
49845>>>        Handle hTable
49845>>>        Integer iRetval
49845>>>
49845>>>        Move 0 to hTable
49846>>>        Move 0 to iRetval
49847>>>
49847>>>        Repeat
49847>>>>
49847>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49850>>>            If (hTable > 0) Begin
49852>>>                Increment iRetval
49853>>>            End
49853>>>>
49853>>>        Until (hTable = 0)
49855>>>
49855>>>        Function_Return iRetval
49856>>>    End_Function
49857>>>
49857>>>    Function UtilFilelistIsDataFlexTablesOnly Returns Boolean
49859>>>        String sRootName
49859>>>        Boolean bIsSQL
49859>>>        Handle hTable
49859>>>
49859>>>        Move False to bIsSQL
49860>>>        Move 0 to hTable
49861>>>        Repeat
49861>>>>
49861>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49864>>>            If (hTable > 0) Begin
49866>>>                Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
49869>>>                Move (sRootName contains ":") to bIsSQL
49870>>>                If (bIsSQL = True) Begin
49872>>>                    Move 0 to hTable
49873>>>                End
49873>>>>
49873>>>            End
49873>>>>
49873>>>        Until (hTable = 0)
49875>>>
49875>>>        Function_Return (bIsSQL = False)
49876>>>    End_Function
49877>>>
49877>>>    // Pass a table's logical name
49877>>>    // Returns True if the table exists in filelist.cfg.
49877>>>    Function UtilTableLogicalNameIsInUse String sCheckTable Returns Boolean
49879>>>        Handle hTable
49879>>>        Boolean bFound
49879>>>        String sCompareTable
49879>>>
49879>>>        Move False to bFound
49880>>>        Move 0 to hTable
49881>>>        Repeat
49881>>>>
49881>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
49884>>>            If (hTable > 0) Begin
49886>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sCompareTable
49889>>>                If (Uppercase(sCompareTable) = Uppercase(sCheckTable)) Begin
49891>>>                    Move True to bFound
49892>>>                End
49892>>>>
49892>>>            End
49892>>>>
49892>>>            If (bFound = True) ;                Break
49895>>>        Until (hTable = 0)
49897>>>
49897>>>        Function_Return (bFound = True)
49898>>>    End_Function
49899>>>
49899>>>    // * Dummy function for the Studio's Code Explorer *
49899>>>    Function UTIL_ENUMERATION_FUNCTIONS Returns Boolean
49901>>>        Function_Return False
49902>>>    End_Function
49903>>>
49903>>>    Function UtilEnumerateOverlapFields Integer hTable Integer iField Returns String[]
49905>>>        String  sRetval
49905>>>        String[] sOverlapFieldsArray
49906>>>        Integer iType iColumn iColumns
49906>>>        Boolean bOpen bOverlap
49906>>>
49906>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpen
49909>>>        If (bOpen = False) Begin
49911>>>            Open hTable
49913>>>        End
49913>>>>
49913>>>
49913>>>        Move "" to sRetval
49914>>>
49914>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hTable to iColumns
49917>>>
49917>>>        for iColumn from 0 to iColumns
49923>>>>
49923>>>            Get_Attribute DF_FIELD_TYPE of hTable iColumn to iType
49926>>>            If (iField <> iColumn and iType <> DF_OVERLAP) Begin
49928>>>                Get_Attribute DF_FIELD_OVERLAP of hTable iField iColumn to bOverlap
49931>>>                If (bOverlap) Begin
49933>>>                    If (sRetval <> "") Begin
49935>>>                        Append sRetval ","
49936>>>                    End
49936>>>>
49936>>>                    Append sRetval iColumn
49937>>>                End
49937>>>>
49937>>>            End
49937>>>>
49937>>>        Loop
49938>>>>
49938>>>
49938>>>        If (bOpen = False) Begin
49940>>>            Close hTable
49941>>>        End
49941>>>>
49941>>>
49941>>>        Get StrSplitToArray sRetval "," to sOverlapFieldsArray
49942>>>
49942>>>        Function_Return sOverlapFieldsArray
49943>>>    End_Function
49944>>>
49944>>>    // Returns a struct array with all data types for the passed driver & dbtype.
49944>>>    Function UtilEnumerateColumnTypes String sDriverID Integer iDbType Returns tColumnType[]
49946>>>        tColumnType[] ColumnType
49946>>>        tColumnType[] ColumnType
49947>>>
49947>>>        Case Begin
49947>>>            Case (iDbType = EN_dbTypeDataFlex)
49949>>>                Get _UtilEnumerateDataFlexTypes to ColumnType
49950>>>                Case Break
49951>>>
49951>>>            Case (iDbType = EN_DbTypeDB2)
49954>>>                Get _UtilEnumerateDB2Types to ColumnType
49955>>>                Case Break
49956>>>
49956>>>            Case (iDbType = EN_DbTypeMSSQL)
49959>>>                Get _UtilEnumerateMSSQLTypes sDriverID to ColumnType
49960>>>                Case Break
49961>>>
49961>>>            Case (sDriverID = MDSMySQL)
49964>>>                Get _UtilEnumerateMySQLTypes to ColumnType
49965>>>                Case Break
49966>>>
49966>>>            Case (sDriverID = ORAFLEX)
49969>>>                Get _UtilEnumerateOracleTypes to ColumnType
49970>>>                Case Break
49971>>>
49971>>>            Case (sDriverID = MDSPgSQL)
49974>>>                Get _UtilEnumeratePostgreSQLTypes to ColumnType
49975>>>                Case Break
49976>>>        Case End
49976>>>
49976>>>        Function_Return ColumnType
49977>>>    End_Function
49978>>>
49978>>>    Function UtilEnumerateMSSQLODBCDrivers Returns String
49980>>>        Handle hoRegistry hoODBCDriverNames
49980>>>        Boolean bExists bKeyOpened
49980>>>        String sKey
49980>>>        String[] sDrivers
49981>>>        Integer iDriverNames iDriverName
49981>>>
49981>>>        Get Create (RefClass (cRegistry)) to hoRegistry
49982>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
49983>>>        Set pfAccessRights of hoRegistry to Key_Read
49984>>>        Move "SOFTWARE\ODBC\ODBCINST.INI\ODBC Drivers" to sKey
49985>>>        Get KeyExists of hoRegistry sKey to bExists
49986>>>        If (bExists) Begin
49988>>>            Get OpenKey of hoRegistry sKey to bKeyOpened
49989>>>            If (bKeyOpened) Begin
49991>>>                Get Create (RefClass (Array)) to hoODBCDriverNames
49992>>>                Get GetValues of hoRegistry hoODBCDriverNames to iDriverNames
49993>>>                If (iDriverNames > 0) Begin
49995>>>                    Move (ResizeArray (sDrivers, iDriverNames)) to sDrivers
49996>>>                    Decrement iDriverNames
49997>>>                    for iDriverName from 0 to iDriverNames
50003>>>>
50003>>>                        Get Value of hoODBCDriverNames iDriverName to sDrivers[iDriverName]
50004>>>                      Loop
50005>>>>
50005>>>                End
50005>>>>
50005>>>                Send CloseKey of hoRegistry
50006>>>            End
50006>>>>
50006>>>        End
50006>>>>
50006>>>        Send Destroy of hoRegistry
50007>>>
50007>>>        Function_Return sDrivers
50008>>>    End_Function
50009>>>
50009>>>    // DataFlex Embedded Database Data Types:
50009>>>    // Helper function for UtilEnumerateColumnTypes
50009>>>    Function _UtilEnumerateDataFlexTypes Returns tColumnType[]
50011>>>        tColumnType[] ColumnType
50011>>>        tColumnType[] ColumnType
50012>>>        Integer i
50012>>>
50012>>>        Move DF_ASCII           to ColumnType[i].iSQLType
50013>>>        Move "ASCII"            to ColumnType[i].sSQLType
50014>>>        Move DF_ASCII           to ColumnType[i].iDataFlexType
50015>>>        Move "ASCII"            to ColumnType[i].sDataFlexType
50016>>>        Move "254"              to ColumnType[i].sPrecision
50017>>>        Increment i
50018>>>
50018>>>        Move DF_BCD             to ColumnType[i].iSQLType
50019>>>        Move "Numeric"          to ColumnType[i].sSQLType
50020>>>        Move DF_BCD             to ColumnType[i].iDataFlexType
50021>>>        Move "Numeric"          to ColumnType[i].sDataFlexType
50022>>>        Move "14.8"             to ColumnType[i].sPrecision
50023>>>        Increment i
50024>>>
50024>>>        Move DF_DATE            to ColumnType[i].iSQLType
50025>>>        Move "Date"             to ColumnType[i].sSQLType
50026>>>        Move DF_DATE            to ColumnType[i].iDataFlexType
50027>>>        Move "Date"             to ColumnType[i].sDataFlexType
50028>>>        Move "6.0"              to ColumnType[i].sPrecision
50029>>>        Move True               to ColumnType[i].bCanEditSize
50030>>>        Increment i
50031>>>
50031>>>        Move DF_TEXT            to ColumnType[i].iSQLType
50032>>>        Move "Text"             to ColumnType[i].sSQLType
50033>>>        Move DF_TEXT            to ColumnType[i].iDataFlexType
50034>>>        Move "Text"             to ColumnType[i].sDataFlexType
50035>>>        Move "16384"            to ColumnType[i].sPrecision
50036>>>        Increment i
50037>>>
50037>>>        Move DF_BINARY          to ColumnType[i].iSQLType
50038>>>        Move "Binary"           to ColumnType[i].sSQLType
50039>>>        Move DF_BINARY          to ColumnType[i].iDataFlexType
50040>>>        Move "Binary"           to ColumnType[i].sDataFlexType
50041>>>        Move "16384"            to ColumnType[i].sPrecision
50042>>>        Increment i
50043>>>
50043>>>        Move DF_DATETIME        to ColumnType[i].iSQLType
50044>>>        Move "DateTime"         to ColumnType[i].sSQLType
50045>>>        Move DF_DATETIME        to ColumnType[i].iDataFlexType
50046>>>        Move "DateTime"         to ColumnType[i].sDataFlexType
50047>>>        Move "23"               to ColumnType[i].sPrecision
50048>>>        Move True               to ColumnType[i].bCanEditSize
50049>>>        Increment i
50050>>>
50050>>>        Move DF_OVERLAP         to ColumnType[i].iSQLType
50051>>>        Move "Overlap"          to ColumnType[i].sSQLType
50052>>>        Move DF_OVERLAP         to ColumnType[i].iDataFlexType
50053>>>        Move "Overlap"          to ColumnType[i].sDataFlexType
50054>>>        Move "0.0"              to ColumnType[i].sPrecision
50055>>>
50055>>>        Function_Return ColumnType
50056>>>    End_Function
50057>>>
50057>>>    Function _UtilEnumerateDB2Types Returns tColumnType[]
50059>>>        tColumnType[] aColumnType
50059>>>        tColumnType[] aColumnType
50060>>>        Integer i
50060>>>
Including file: DB2_DRV_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\DB2_DRV_DriverDef.inc)
50060>>>>// Generated By The Database Update Framework
50060>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\Bin\DB2_DRV_DriverDef.xml
50060>>>>// Driver COLUMN DATA TYPES
50060>>>>//
50060>>>>// Created: 2018-03-14 23:46:34.033
50060>>>>
50060>>>>            Move "bigint"                                to aColumnType[i].sSQLType
50061>>>>            Move -5                                      to aColumnType[i].iSQLType
50062>>>>            Move True                                    to aColumnType[i].bCanEditSize
50063>>>>            Move True                                    to aColumnType[i].bNativeDataType
50064>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50065>>>>            Move 1                                       to aColumnType[i].iMinSize
50066>>>>            Move 14                                      to aColumnType[i].nMaxSize
50067>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50068>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50069>>>>            Move 14                                      to aColumnType[i].sPrecision
50070>>>>            Increment i
50071>>>>
50071>>>>            Move "blob"                                  to aColumnType[i].sSQLType
50072>>>>            Move -98                                     to aColumnType[i].iSQLType
50073>>>>            Move True                                    to aColumnType[i].bCanEditSize
50074>>>>            Move True                                    to aColumnType[i].bNativeDataType
50075>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50076>>>>            Move 1                                       to aColumnType[i].iMinSize
50077>>>>            Move 2147483647                              to aColumnType[i].nMaxSize
50078>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50079>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50080>>>>            Move 2147483647                              to aColumnType[i].sPrecision
50081>>>>            Increment i
50082>>>>
50082>>>>            Move "char"                                  to aColumnType[i].sSQLType
50083>>>>            Move 1                                       to aColumnType[i].iSQLType
50084>>>>            Move True                                    to aColumnType[i].bCanEditSize
50085>>>>            Move True                                    to aColumnType[i].bNativeDataType
50086>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50087>>>>            Move 1                                       to aColumnType[i].iMinSize
50088>>>>            Move 254                                     to aColumnType[i].nMaxSize
50089>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50090>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50091>>>>            Move 254                                     to aColumnType[i].sPrecision
50092>>>>            Increment i
50093>>>>
50093>>>>            Move "char for bit data"                     to aColumnType[i].sSQLType
50094>>>>            Move -2                                      to aColumnType[i].iSQLType
50095>>>>            Move True                                    to aColumnType[i].bCanEditSize
50096>>>>            Move True                                    to aColumnType[i].bNativeDataType
50097>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50098>>>>            Move 1                                       to aColumnType[i].iMinSize
50099>>>>            Move 254                                     to aColumnType[i].nMaxSize
50100>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50101>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50102>>>>            Move 254                                     to aColumnType[i].sPrecision
50103>>>>            Increment i
50104>>>>
50104>>>>            Move "clob"                                  to aColumnType[i].sSQLType
50105>>>>            Move -99                                     to aColumnType[i].iSQLType
50106>>>>            Move True                                    to aColumnType[i].bCanEditSize
50107>>>>            Move True                                    to aColumnType[i].bNativeDataType
50108>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50109>>>>            Move 1                                       to aColumnType[i].iMinSize
50110>>>>            Move 2147483647                              to aColumnType[i].nMaxSize
50111>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50112>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50113>>>>            Move 2147483647                              to aColumnType[i].sPrecision
50114>>>>            Increment i
50115>>>>
50115>>>>            Move "date"                                  to aColumnType[i].sSQLType
50116>>>>            Move 91                                      to aColumnType[i].iSQLType
50117>>>>            Move False                                   to aColumnType[i].bCanEditSize
50118>>>>            Move True                                    to aColumnType[i].bNativeDataType
50119>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50120>>>>            Move 0                                       to aColumnType[i].iMinSize
50121>>>>            Move 0                                       to aColumnType[i].nMaxSize
50122>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50123>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50124>>>>            Move 1                                       to aColumnType[i].sPrecision
50125>>>>            Increment i
50126>>>>
50126>>>>            Move "dbclob"                                to aColumnType[i].sSQLType
50127>>>>            Move -350                                    to aColumnType[i].iSQLType
50128>>>>            Move True                                    to aColumnType[i].bCanEditSize
50129>>>>            Move True                                    to aColumnType[i].bNativeDataType
50130>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50131>>>>            Move 1                                       to aColumnType[i].iMinSize
50132>>>>            Move 1073741823                              to aColumnType[i].nMaxSize
50133>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50134>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50135>>>>            Move 1073741823                              to aColumnType[i].sPrecision
50136>>>>            Increment i
50137>>>>
50137>>>>            Move "decimal"                               to aColumnType[i].sSQLType
50138>>>>            Move 3                                       to aColumnType[i].iSQLType
50139>>>>            Move True                                    to aColumnType[i].bCanEditSize
50140>>>>            Move True                                    to aColumnType[i].bNativeDataType
50141>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50142>>>>            Move 1                                       to aColumnType[i].iMinSize
50143>>>>            Move 14                                      to aColumnType[i].nMaxSize
50144>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50145>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50146>>>>            Move 14                                      to aColumnType[i].sPrecision
50147>>>>            Increment i
50148>>>>
50148>>>>            Move "double"                                to aColumnType[i].sSQLType
50149>>>>            Move 8                                       to aColumnType[i].iSQLType
50150>>>>            Move True                                    to aColumnType[i].bCanEditSize
50151>>>>            Move True                                    to aColumnType[i].bNativeDataType
50152>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50153>>>>            Move 1                                       to aColumnType[i].iMinSize
50154>>>>            Move 14                                      to aColumnType[i].nMaxSize
50155>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50156>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50157>>>>            Move 14                                      to aColumnType[i].sPrecision
50158>>>>            Increment i
50159>>>>
50159>>>>            Move "graphic"                               to aColumnType[i].sSQLType
50160>>>>            Move -95                                     to aColumnType[i].iSQLType
50161>>>>            Move True                                    to aColumnType[i].bCanEditSize
50162>>>>            Move True                                    to aColumnType[i].bNativeDataType
50163>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50164>>>>            Move 1                                       to aColumnType[i].iMinSize
50165>>>>            Move 127                                     to aColumnType[i].nMaxSize
50166>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50167>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50168>>>>            Move 127                                     to aColumnType[i].sPrecision
50169>>>>            Increment i
50170>>>>
50170>>>>            Move "integer"                               to aColumnType[i].sSQLType
50171>>>>            Move 4                                       to aColumnType[i].iSQLType
50172>>>>            Move True                                    to aColumnType[i].bCanEditSize
50173>>>>            Move True                                    to aColumnType[i].bNativeDataType
50174>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50175>>>>            Move 1                                       to aColumnType[i].iMinSize
50176>>>>            Move 14                                      to aColumnType[i].nMaxSize
50177>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50178>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50179>>>>            Move 14                                      to aColumnType[i].sPrecision
50180>>>>            Increment i
50181>>>>
50181>>>>            Move "long varchar"                          to aColumnType[i].sSQLType
50182>>>>            Move -1                                      to aColumnType[i].iSQLType
50183>>>>            Move True                                    to aColumnType[i].bCanEditSize
50184>>>>            Move True                                    to aColumnType[i].bNativeDataType
50185>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50186>>>>            Move 1                                       to aColumnType[i].iMinSize
50187>>>>            Move 32000                                   to aColumnType[i].nMaxSize
50188>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50189>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50190>>>>            Move 32000                                   to aColumnType[i].sPrecision
50191>>>>            Increment i
50192>>>>
50192>>>>            Move "long varchar for bit data"             to aColumnType[i].sSQLType
50193>>>>            Move -4                                      to aColumnType[i].iSQLType
50194>>>>            Move True                                    to aColumnType[i].bCanEditSize
50195>>>>            Move True                                    to aColumnType[i].bNativeDataType
50196>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50197>>>>            Move 1                                       to aColumnType[i].iMinSize
50198>>>>            Move 32700                                   to aColumnType[i].nMaxSize
50199>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50200>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50201>>>>            Move 32700                                   to aColumnType[i].sPrecision
50202>>>>            Increment i
50203>>>>
50203>>>>            Move "long vargraphic"                       to aColumnType[i].sSQLType
50204>>>>            Move -97                                     to aColumnType[i].iSQLType
50205>>>>            Move True                                    to aColumnType[i].bCanEditSize
50206>>>>            Move True                                    to aColumnType[i].bNativeDataType
50207>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50208>>>>            Move 1                                       to aColumnType[i].iMinSize
50209>>>>            Move 16350                                   to aColumnType[i].nMaxSize
50210>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50211>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50212>>>>            Move 16350                                   to aColumnType[i].sPrecision
50213>>>>            Increment i
50214>>>>
50214>>>>            Move "real"                                  to aColumnType[i].sSQLType
50215>>>>            Move 7                                       to aColumnType[i].iSQLType
50216>>>>            Move True                                    to aColumnType[i].bCanEditSize
50217>>>>            Move True                                    to aColumnType[i].bNativeDataType
50218>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50219>>>>            Move 1                                       to aColumnType[i].iMinSize
50220>>>>            Move 14                                      to aColumnType[i].nMaxSize
50221>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50222>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50223>>>>            Move 14                                      to aColumnType[i].sPrecision
50224>>>>            Increment i
50225>>>>
50225>>>>            Move "smallint"                              to aColumnType[i].sSQLType
50226>>>>            Move 5                                       to aColumnType[i].iSQLType
50227>>>>            Move True                                    to aColumnType[i].bCanEditSize
50228>>>>            Move True                                    to aColumnType[i].bNativeDataType
50229>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50230>>>>            Move 1                                       to aColumnType[i].iMinSize
50231>>>>            Move 14                                      to aColumnType[i].nMaxSize
50232>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50233>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50234>>>>            Move 14                                      to aColumnType[i].sPrecision
50235>>>>            Increment i
50236>>>>
50236>>>>            Move "time"                                  to aColumnType[i].sSQLType
50237>>>>            Move 92                                      to aColumnType[i].iSQLType
50238>>>>            Move False                                   to aColumnType[i].bCanEditSize
50239>>>>            Move True                                    to aColumnType[i].bNativeDataType
50240>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50241>>>>            Move 0                                       to aColumnType[i].iMinSize
50242>>>>            Move 0                                       to aColumnType[i].nMaxSize
50243>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50244>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50245>>>>            Move 1                                       to aColumnType[i].sPrecision
50246>>>>            Increment i
50247>>>>
50247>>>>            Move "timestamp"                             to aColumnType[i].sSQLType
50248>>>>            Move 93                                      to aColumnType[i].iSQLType
50249>>>>            Move False                                   to aColumnType[i].bCanEditSize
50250>>>>            Move True                                    to aColumnType[i].bNativeDataType
50251>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50252>>>>            Move 0                                       to aColumnType[i].iMinSize
50253>>>>            Move 0                                       to aColumnType[i].nMaxSize
50254>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50255>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50256>>>>            Move 1                                       to aColumnType[i].sPrecision
50257>>>>            Increment i
50258>>>>
50258>>>>            Move "varchar"                               to aColumnType[i].sSQLType
50259>>>>            Move 12                                      to aColumnType[i].iSQLType
50260>>>>            Move True                                    to aColumnType[i].bCanEditSize
50261>>>>            Move True                                    to aColumnType[i].bNativeDataType
50262>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50263>>>>            Move 1                                       to aColumnType[i].iMinSize
50264>>>>            Move 32672                                   to aColumnType[i].nMaxSize
50265>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50266>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50267>>>>            Move 32672                                   to aColumnType[i].sPrecision
50268>>>>            Increment i
50269>>>>
50269>>>>            Move "varchar for bit data"                  to aColumnType[i].sSQLType
50270>>>>            Move -3                                      to aColumnType[i].iSQLType
50271>>>>            Move True                                    to aColumnType[i].bCanEditSize
50272>>>>            Move True                                    to aColumnType[i].bNativeDataType
50273>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50274>>>>            Move 1                                       to aColumnType[i].iMinSize
50275>>>>            Move 32672                                   to aColumnType[i].nMaxSize
50276>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50277>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50278>>>>            Move 32672                                   to aColumnType[i].sPrecision
50279>>>>            Increment i
50280>>>>
50280>>>>            Move "vargraphic"                            to aColumnType[i].sSQLType
50281>>>>            Move -96                                     to aColumnType[i].iSQLType
50282>>>>            Move True                                    to aColumnType[i].bCanEditSize
50283>>>>            Move True                                    to aColumnType[i].bNativeDataType
50284>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50285>>>>            Move 1                                       to aColumnType[i].iMinSize
50286>>>>            Move 16336                                   to aColumnType[i].nMaxSize
50287>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50288>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50289>>>>            Move 16336                                   to aColumnType[i].sPrecision
50290>>>>            Increment i
50291>>>>
50291>>>>            Move "xml"                                   to aColumnType[i].sSQLType
50292>>>>            Move -370                                    to aColumnType[i].iSQLType
50293>>>>            Move True                                    to aColumnType[i].bCanEditSize
50294>>>>            Move True                                    to aColumnType[i].bNativeDataType
50295>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50296>>>>            Move 1                                       to aColumnType[i].iMinSize
50297>>>>            Move 2147483647                              to aColumnType[i].nMaxSize
50298>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50299>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50300>>>>            Move 2147483647                              to aColumnType[i].sPrecision
50301>>>>            Increment i
50302>>>>
50302>>>>
50302>>>//        Move SQL_DBCLOB         to ColumnType[i].iSQLType
50302>>>//        Move "DBCLOB"           to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "Text"             to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_BIGINT         to ColumnType[i].iSQLType
50302>>>//        Move "BIGINT"           to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.0"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_BLOB           to ColumnType[i].iSQLType
50302>>>//        Move "BLOB"             to ColumnType[i].sSQLType
50302>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
50302>>>//        Move "BINARY"           to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_CHAR           to ColumnType[i].iSQLType
50302>>>//        Move "CHAR"             to ColumnType[i].sSQLType
50302>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
50302>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
50302>>>//        Move "254"              to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        // ToDo: We need to change the sType when using this!
50302>>>//        Move SQL_CHARBIT            to ColumnType[i].iSQLType
50302>>>//        Move "CHAR FOR BIT DATA"    to ColumnType[i].sSQLType
50302>>>//        Move DF_BINARY              to ColumnType[i].iDataFlexType
50302>>>//        Move "Binary"               to ColumnType[i].sDataFlexType
50302>>>//        Move "254"                  to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_DATE           to ColumnType[i].iSQLType
50302>>>//        Move "DATE"             to ColumnType[i].sSQLType
50302>>>//        Move DF_DATE            to ColumnType[i].iDataFlexType
50302>>>//        Move "Date"             to ColumnType[i].sDataFlexType
50302>>>//        Move "6.0"              to ColumnType[i].sPrecision
50302>>>//        Move True               to ColumnType[i].bCanEditSize
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_CLOB           to ColumnType[i].iSQLType
50302>>>//        Move "CLOB"             to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "Text"             to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_DECIMAL        to ColumnType[i].iSQLType
50302>>>//        Move "DECIMAL"          to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.8"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_DOUBLE         to ColumnType[i].iSQLType
50302>>>//        Move "DOUBLE"           to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.8"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_FLOAT          to ColumnType[i].iSQLType
50302>>>//        Move "FLOAT"            to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.8"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_GRAPHIC        to ColumnType[i].iSQLType
50302>>>//        Move "GRAPHIC"          to ColumnType[i].sSQLType
50302>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
50302>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
50302>>>//        Move "255"              to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_INTEGER        to ColumnType[i].iSQLType
50302>>>//        Move "INTEGER"          to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "9.0"              to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_LONGVARCHAR    to ColumnType[i].iSQLType
50302>>>//        Move "LONG VARCHAR"     to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "32000"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_LONGVARCHARBIT to ColumnType[i].iSQLType
50302>>>//        Move "LONG VARCHAR BIT" to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "32000"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_LONGVARGRAPHIC to ColumnType[i].iSQLType
50302>>>//        Move "LONG VARGRAPHIC"  to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "32000"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_NUMERIC        to ColumnType[i].iSQLType
50302>>>//        Move "NUMERIC"          to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.8"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_REAL           to ColumnType[i].iSQLType
50302>>>//        Move "REAL"             to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
50302>>>//        Move "14.8"             to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_SMALLINT       to ColumnType[i].iSQLType
50302>>>//        Move "SMALLINT"         to ColumnType[i].sSQLType
50302>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
50302>>>//        Move "NUMERIC"          to ColumnType[i].sDataFlexType
50302>>>//        Move "5.0"              to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_TIME           to ColumnType[i].iSQLType
50302>>>//        Move "TIME"             to ColumnType[i].sSQLType
50302>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
50302>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
50302>>>//        Move "19.0"             to ColumnType[i].sPrecision
50302>>>//        Move True               to ColumnType[i].bCanEditSize
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_TIMESTAMP      to ColumnType[i].iSQLType
50302>>>//        Move "TIMESTAMP"        to ColumnType[i].sSQLType
50302>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
50302>>>//        Move "DATETIME"         to ColumnType[i].sDataFlexType
50302>>>//        Move "23.6"             to ColumnType[i].sPrecision
50302>>>//        Move True               to ColumnType[i].bCanEditSize
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_VARCHAR        to ColumnType[i].iSQLType
50302>>>//        Move "VARCHAR"          to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        // ToDo: We need to change the sType when using this!
50302>>>//        Move SQL_VARCHARBIT         to ColumnType[i].iSQLType
50302>>>//        Move "VARCHAR FOR BIT DATA" to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT                to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"                 to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"                to ColumnType[i].sPrecision
50302>>>//        Increment i
50302>>>//
50302>>>//        Move SQL_VARGRAPHIC     to ColumnType[i].iSQLType
50302>>>//        Move "VARGRAPHIC"       to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>//
50302>>>//        Move SQL_XML            to ColumnType[i].iSQLType
50302>>>//        Move "XML"              to ColumnType[i].sSQLType
50302>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
50302>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
50302>>>//        Move "16384"            to ColumnType[i].sPrecision
50302>>>
50302>>>        Function_Return aColumnType
50303>>>    End_Function
50304>>>
50304>>>    // Microsoft SQL Server Database Data Types:
50304>>>    // Helper function for UtilEnumerateColumnTypes
50304>>>    Function _UtilEnumerateMSSQLTypes String sDriverID Returns tColumnType[]
50306>>>        tColumnType[] aColumnType
50306>>>        tColumnType[] aColumnType
50307>>>        Integer i
50307>>>
50307>>>        If (sDriverID = MSSQLDRV_ID) Begin
Including file: MSSQLDRV_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\MSSQLDRV_DriverDef.inc)
50309>>>>// Generated By The Database Update Framework
50309>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\bin\MSSQLDRV_DriverDef.xml
50309>>>>// Driver COLUMN DATA TYPES
50309>>>>//
50309>>>>// Created: 2018-03-15 00:00:57.024
50309>>>>
50309>>>>            Move "bigint"                                to aColumnType[i].sSQLType
50310>>>>            Move -5                                      to aColumnType[i].iSQLType
50311>>>>            Move True                                    to aColumnType[i].bCanEditSize
50312>>>>            Move True                                    to aColumnType[i].bNativeDataType
50313>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50314>>>>            Move 1                                       to aColumnType[i].iMinSize
50315>>>>            Move 14                                      to aColumnType[i].nMaxSize
50316>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50317>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50318>>>>            Move 14                                      to aColumnType[i].sPrecision
50319>>>>            Increment i
50320>>>>
50320>>>>            Move "binary"                                to aColumnType[i].sSQLType
50321>>>>            Move -2                                      to aColumnType[i].iSQLType
50322>>>>            Move True                                    to aColumnType[i].bCanEditSize
50323>>>>            Move True                                    to aColumnType[i].bNativeDataType
50324>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50325>>>>            Move 1                                       to aColumnType[i].iMinSize
50326>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50327>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50328>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50329>>>>            Move 8000                                    to aColumnType[i].sPrecision
50330>>>>            Increment i
50331>>>>
50331>>>>            Move "bit"                                   to aColumnType[i].sSQLType
50332>>>>            Move -7                                      to aColumnType[i].iSQLType
50333>>>>            Move False                                   to aColumnType[i].bCanEditSize
50334>>>>            Move True                                    to aColumnType[i].bNativeDataType
50335>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50336>>>>            Move 0                                       to aColumnType[i].iMinSize
50337>>>>            Move 0                                       to aColumnType[i].nMaxSize
50338>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50339>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50340>>>>            Move 1                                       to aColumnType[i].sPrecision
50341>>>>            Increment i
50342>>>>
50342>>>>            Move "char"                                  to aColumnType[i].sSQLType
50343>>>>            Move 1                                       to aColumnType[i].iSQLType
50344>>>>            Move True                                    to aColumnType[i].bCanEditSize
50345>>>>            Move True                                    to aColumnType[i].bNativeDataType
50346>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50347>>>>            Move 1                                       to aColumnType[i].iMinSize
50348>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50349>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50350>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50351>>>>            Move 8000                                    to aColumnType[i].sPrecision
50352>>>>            Increment i
50353>>>>
50353>>>>            Move "date"                                  to aColumnType[i].sSQLType
50354>>>>            Move 91                                      to aColumnType[i].iSQLType
50355>>>>            Move False                                   to aColumnType[i].bCanEditSize
50356>>>>            Move True                                    to aColumnType[i].bNativeDataType
50357>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50358>>>>            Move 0                                       to aColumnType[i].iMinSize
50359>>>>            Move 0                                       to aColumnType[i].nMaxSize
50360>>>>            Move "DF_DATE"                               to aColumnType[i].sDataFlexType
50361>>>>            Move DF_DATE                                 to aColumnType[i].iDataFlexType
50362>>>>            Move 6                                       to aColumnType[i].sPrecision
50363>>>>            Increment i
50364>>>>
50364>>>>            Move "datetime"                              to aColumnType[i].sSQLType
50365>>>>            Move 93                                      to aColumnType[i].iSQLType
50366>>>>            Move False                                   to aColumnType[i].bCanEditSize
50367>>>>            Move True                                    to aColumnType[i].bNativeDataType
50368>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50369>>>>            Move -1                                      to aColumnType[i].iMinSize
50370>>>>            Move -1                                      to aColumnType[i].nMaxSize
50371>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
50372>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
50373>>>>            Move 23                                      to aColumnType[i].sPrecision
50374>>>>            Increment i
50375>>>>
50375>>>>            Move "datetime2"                             to aColumnType[i].sSQLType
50376>>>>            Move -200                                    to aColumnType[i].iSQLType
50377>>>>            Move True                                    to aColumnType[i].bCanEditSize
50378>>>>            Move True                                    to aColumnType[i].bNativeDataType
50379>>>>            Move 23                                      to aColumnType[i].iDefaultSize
50380>>>>            Move 23                                      to aColumnType[i].iMinSize
50381>>>>            Move 23                                      to aColumnType[i].nMaxSize
50382>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
50383>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
50384>>>>            Move 23                                      to aColumnType[i].sPrecision
50385>>>>            Increment i
50386>>>>
50386>>>>            Move "datetimeoffset"                        to aColumnType[i].sSQLType
50387>>>>            Move -155                                    to aColumnType[i].iSQLType
50388>>>>            Move True                                    to aColumnType[i].bCanEditSize
50389>>>>            Move True                                    to aColumnType[i].bNativeDataType
50390>>>>            Move 34                                      to aColumnType[i].iDefaultSize
50391>>>>            Move 34                                      to aColumnType[i].iMinSize
50392>>>>            Move 34                                      to aColumnType[i].nMaxSize
50393>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
50394>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
50395>>>>            Move 34                                      to aColumnType[i].sPrecision
50396>>>>            Increment i
50397>>>>
50397>>>>            Move "decimal"                               to aColumnType[i].sSQLType
50398>>>>            Move 3                                       to aColumnType[i].iSQLType
50399>>>>            Move True                                    to aColumnType[i].bCanEditSize
50400>>>>            Move True                                    to aColumnType[i].bNativeDataType
50401>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50402>>>>            Move 1                                       to aColumnType[i].iMinSize
50403>>>>            Move 14                                      to aColumnType[i].nMaxSize
50404>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50405>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50406>>>>            Move 14                                      to aColumnType[i].sPrecision
50407>>>>            Increment i
50408>>>>
50408>>>>            Move "float"                                 to aColumnType[i].sSQLType
50409>>>>            Move 6                                       to aColumnType[i].iSQLType
50410>>>>            Move True                                    to aColumnType[i].bCanEditSize
50411>>>>            Move True                                    to aColumnType[i].bNativeDataType
50412>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50413>>>>            Move 1                                       to aColumnType[i].iMinSize
50414>>>>            Move 14                                      to aColumnType[i].nMaxSize
50415>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50416>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50417>>>>            Move 14                                      to aColumnType[i].sPrecision
50418>>>>            Increment i
50419>>>>
50419>>>>            Move "image"                                 to aColumnType[i].sSQLType
50420>>>>            Move -4                                      to aColumnType[i].iSQLType
50421>>>>            Move True                                    to aColumnType[i].bCanEditSize
50422>>>>            Move True                                    to aColumnType[i].bNativeDataType
50423>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50424>>>>            Move 1                                       to aColumnType[i].iMinSize
50425>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50426>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50427>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50428>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50429>>>>            Increment i
50430>>>>
50430>>>>            Move "int"                                   to aColumnType[i].sSQLType
50431>>>>            Move 4                                       to aColumnType[i].iSQLType
50432>>>>            Move True                                    to aColumnType[i].bCanEditSize
50433>>>>            Move True                                    to aColumnType[i].bNativeDataType
50434>>>>            Move 10                                      to aColumnType[i].iDefaultSize
50435>>>>            Move 1                                       to aColumnType[i].iMinSize
50436>>>>            Move 10                                      to aColumnType[i].nMaxSize
50437>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50438>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50439>>>>            Move 10                                      to aColumnType[i].sPrecision
50440>>>>            Increment i
50441>>>>
50441>>>>            Move "money"                                 to aColumnType[i].sSQLType
50442>>>>            Move -204                                    to aColumnType[i].iSQLType
50443>>>>            Move False                                   to aColumnType[i].bCanEditSize
50444>>>>            Move True                                    to aColumnType[i].bNativeDataType
50445>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50446>>>>            Move 0                                       to aColumnType[i].iMinSize
50447>>>>            Move 0                                       to aColumnType[i].nMaxSize
50448>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50449>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50450>>>>            Move 1                                       to aColumnType[i].sPrecision
50451>>>>            Increment i
50452>>>>
50452>>>>            Move "nchar"                                 to aColumnType[i].sSQLType
50453>>>>            Move -8                                      to aColumnType[i].iSQLType
50454>>>>            Move True                                    to aColumnType[i].bCanEditSize
50455>>>>            Move True                                    to aColumnType[i].bNativeDataType
50456>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50457>>>>            Move 1                                       to aColumnType[i].iMinSize
50458>>>>            Move 4000                                    to aColumnType[i].nMaxSize
50459>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50460>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50461>>>>            Move 4000                                    to aColumnType[i].sPrecision
50462>>>>            Increment i
50463>>>>
50463>>>>            Move "ntext"                                 to aColumnType[i].sSQLType
50464>>>>            Move -10                                     to aColumnType[i].iSQLType
50465>>>>            Move True                                    to aColumnType[i].bCanEditSize
50466>>>>            Move True                                    to aColumnType[i].bNativeDataType
50467>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50468>>>>            Move 1                                       to aColumnType[i].iMinSize
50469>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50470>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50471>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50472>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50473>>>>            Increment i
50474>>>>
50474>>>>            Move "numeric"                               to aColumnType[i].sSQLType
50475>>>>            Move 2                                       to aColumnType[i].iSQLType
50476>>>>            Move True                                    to aColumnType[i].bCanEditSize
50477>>>>            Move True                                    to aColumnType[i].bNativeDataType
50478>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50479>>>>            Move 1                                       to aColumnType[i].iMinSize
50480>>>>            Move 14                                      to aColumnType[i].nMaxSize
50481>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50482>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50483>>>>            Move 14                                      to aColumnType[i].sPrecision
50484>>>>            Increment i
50485>>>>
50485>>>>            Move "nvarchar"                              to aColumnType[i].sSQLType
50486>>>>            Move -9                                      to aColumnType[i].iSQLType
50487>>>>            Move True                                    to aColumnType[i].bCanEditSize
50488>>>>            Move True                                    to aColumnType[i].bNativeDataType
50489>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50490>>>>            Move 1                                       to aColumnType[i].iMinSize
50491>>>>            Move 4000                                    to aColumnType[i].nMaxSize
50492>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50493>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50494>>>>            Move 4000                                    to aColumnType[i].sPrecision
50495>>>>            Increment i
50496>>>>
50496>>>>            Move "nvarchar(max)"                         to aColumnType[i].sSQLType
50497>>>>            Move -202                                    to aColumnType[i].iSQLType
50498>>>>            Move True                                    to aColumnType[i].bCanEditSize
50499>>>>            Move True                                    to aColumnType[i].bNativeDataType
50500>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50501>>>>            Move 1                                       to aColumnType[i].iMinSize
50502>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50503>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50504>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50505>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50506>>>>            Increment i
50507>>>>
50507>>>>            Move "real"                                  to aColumnType[i].sSQLType
50508>>>>            Move 7                                       to aColumnType[i].iSQLType
50509>>>>            Move True                                    to aColumnType[i].bCanEditSize
50510>>>>            Move True                                    to aColumnType[i].bNativeDataType
50511>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50512>>>>            Move 1                                       to aColumnType[i].iMinSize
50513>>>>            Move 14                                      to aColumnType[i].nMaxSize
50514>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50515>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50516>>>>            Move 14                                      to aColumnType[i].sPrecision
50517>>>>            Increment i
50518>>>>
50518>>>>            Move "smalldatetime"                         to aColumnType[i].sSQLType
50519>>>>            Move -206                                    to aColumnType[i].iSQLType
50520>>>>            Move False                                   to aColumnType[i].bCanEditSize
50521>>>>            Move True                                    to aColumnType[i].bNativeDataType
50522>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50523>>>>            Move 0                                       to aColumnType[i].iMinSize
50524>>>>            Move 0                                       to aColumnType[i].nMaxSize
50525>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
50526>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
50527>>>>            Move 1                                       to aColumnType[i].sPrecision
50528>>>>            Increment i
50529>>>>
50529>>>>            Move "smallint"                              to aColumnType[i].sSQLType
50530>>>>            Move 5                                       to aColumnType[i].iSQLType
50531>>>>            Move True                                    to aColumnType[i].bCanEditSize
50532>>>>            Move True                                    to aColumnType[i].bNativeDataType
50533>>>>            Move 5                                       to aColumnType[i].iDefaultSize
50534>>>>            Move 1                                       to aColumnType[i].iMinSize
50535>>>>            Move 5                                       to aColumnType[i].nMaxSize
50536>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50537>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50538>>>>            Move 5                                       to aColumnType[i].sPrecision
50539>>>>            Increment i
50540>>>>
50540>>>>            Move "smallmoney"                            to aColumnType[i].sSQLType
50541>>>>            Move -205                                    to aColumnType[i].iSQLType
50542>>>>            Move False                                   to aColumnType[i].bCanEditSize
50543>>>>            Move True                                    to aColumnType[i].bNativeDataType
50544>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50545>>>>            Move 0                                       to aColumnType[i].iMinSize
50546>>>>            Move 0                                       to aColumnType[i].nMaxSize
50547>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50548>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50549>>>>            Move 1                                       to aColumnType[i].sPrecision
50550>>>>            Increment i
50551>>>>
50551>>>>            Move "text"                                  to aColumnType[i].sSQLType
50552>>>>            Move -1                                      to aColumnType[i].iSQLType
50553>>>>            Move True                                    to aColumnType[i].bCanEditSize
50554>>>>            Move True                                    to aColumnType[i].bNativeDataType
50555>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50556>>>>            Move 1                                       to aColumnType[i].iMinSize
50557>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50558>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50559>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50560>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50561>>>>            Increment i
50562>>>>
50562>>>>            Move "time"                                  to aColumnType[i].sSQLType
50563>>>>            Move -154                                    to aColumnType[i].iSQLType
50564>>>>            Move True                                    to aColumnType[i].bCanEditSize
50565>>>>            Move True                                    to aColumnType[i].bNativeDataType
50566>>>>            Move 10                                      to aColumnType[i].iDefaultSize
50567>>>>            Move 10                                      to aColumnType[i].iMinSize
50568>>>>            Move 19                                      to aColumnType[i].nMaxSize
50569>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50570>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50571>>>>            Move 19                                      to aColumnType[i].sPrecision
50572>>>>            Increment i
50573>>>>
50573>>>>            Move "tinyint"                               to aColumnType[i].sSQLType
50574>>>>            Move -6                                      to aColumnType[i].iSQLType
50575>>>>            Move True                                    to aColumnType[i].bCanEditSize
50576>>>>            Move True                                    to aColumnType[i].bNativeDataType
50577>>>>            Move 3                                       to aColumnType[i].iDefaultSize
50578>>>>            Move 1                                       to aColumnType[i].iMinSize
50579>>>>            Move 3                                       to aColumnType[i].nMaxSize
50580>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50581>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50582>>>>            Move 3                                       to aColumnType[i].sPrecision
50583>>>>            Increment i
50584>>>>
50584>>>>            Move "uniqueidentifier"                      to aColumnType[i].sSQLType
50585>>>>            Move -11                                     to aColumnType[i].iSQLType
50586>>>>            Move False                                   to aColumnType[i].bCanEditSize
50587>>>>            Move True                                    to aColumnType[i].bNativeDataType
50588>>>>            Move 0                                       to aColumnType[i].iDefaultSize
50589>>>>            Move 0                                       to aColumnType[i].iMinSize
50590>>>>            Move 0                                       to aColumnType[i].nMaxSize
50591>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50592>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50593>>>>            Move 1                                       to aColumnType[i].sPrecision
50594>>>>            Increment i
50595>>>>
50595>>>>            Move "varbinary"                             to aColumnType[i].sSQLType
50596>>>>            Move -3                                      to aColumnType[i].iSQLType
50597>>>>            Move True                                    to aColumnType[i].bCanEditSize
50598>>>>            Move True                                    to aColumnType[i].bNativeDataType
50599>>>>            Move 8000                                    to aColumnType[i].iDefaultSize
50600>>>>            Move 1                                       to aColumnType[i].iMinSize
50601>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50602>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50603>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50604>>>>            Move 8000                                    to aColumnType[i].sPrecision
50605>>>>            Increment i
50606>>>>
50606>>>>            Move "varbinary(max)"                        to aColumnType[i].sSQLType
50607>>>>            Move -203                                    to aColumnType[i].iSQLType
50608>>>>            Move True                                    to aColumnType[i].bCanEditSize
50609>>>>            Move True                                    to aColumnType[i].bNativeDataType
50610>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50611>>>>            Move 1                                       to aColumnType[i].iMinSize
50612>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50613>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50614>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50615>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50616>>>>            Increment i
50617>>>>
50617>>>>            Move "varchar"                               to aColumnType[i].sSQLType
50618>>>>            Move 12                                      to aColumnType[i].iSQLType
50619>>>>            Move True                                    to aColumnType[i].bCanEditSize
50620>>>>            Move True                                    to aColumnType[i].bNativeDataType
50621>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50622>>>>            Move 1                                       to aColumnType[i].iMinSize
50623>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50624>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50625>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50626>>>>            Move 8000                                    to aColumnType[i].sPrecision
50627>>>>            Increment i
50628>>>>
50628>>>>            Move "varchar(max)"                          to aColumnType[i].sSQLType
50629>>>>            Move -201                                    to aColumnType[i].iSQLType
50630>>>>            Move True                                    to aColumnType[i].bCanEditSize
50631>>>>            Move True                                    to aColumnType[i].bNativeDataType
50632>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50633>>>>            Move 1                                       to aColumnType[i].iMinSize
50634>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50635>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50636>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50637>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50638>>>>            Increment i
50639>>>>
50639>>>>            Move "xml"                                   to aColumnType[i].sSQLType
50640>>>>            Move -152                                    to aColumnType[i].iSQLType
50641>>>>            Move True                                    to aColumnType[i].bCanEditSize
50642>>>>            Move True                                    to aColumnType[i].bNativeDataType
50643>>>>            Move 16383                                   to aColumnType[i].iDefaultSize
50644>>>>            Move 1                                       to aColumnType[i].iMinSize
50645>>>>            Move 2000000000                              to aColumnType[i].nMaxSize
50646>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50647>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50648>>>>            Move 2000000000                              to aColumnType[i].sPrecision
50649>>>>            Increment i
50650>>>>
50650>>>>
50650>>>            
50650>>>//            Move SQL_BIGINT         to ColumnType[i].iSQLType
50650>>>//            Move "bigint"           to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "14.0"             to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_BINARY         to ColumnType[i].iSQLType
50650>>>//            Move "binary"           to ColumnType[i].sSQLType
50650>>>//            Move DF_BINARY          to ColumnType[i].iDataFlexType
50650>>>//            Move "Binary"           to ColumnType[i].sDataFlexType
50650>>>//            Move "8000"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_BIT            to ColumnType[i].iSQLType
50650>>>//            Move "bit"              to ColumnType[i].sSQLType
50650>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
50650>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
50650>>>//            Move "1.0"              to ColumnType[i].sPrecision // In SQL allows "1, 0, or NULL"
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_CHAR           to ColumnType[i].iSQLType
50650>>>//            Move "char"             to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "8000"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_DATE           to ColumnType[i].iSQLType
50650>>>//            Move "date"             to ColumnType[i].sSQLType
50650>>>//            Move DF_DATE            to ColumnType[i].iDataFlexType
50650>>>//            Move "Date"             to ColumnType[i].sDataFlexType
50650>>>//            Move "6.0"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_DATETIME       to ColumnType[i].iSQLType
50650>>>//            Move "datetime"         to ColumnType[i].sSQLType
50650>>>//            Move DF_DATETIME        to ColumnType[i].iDataFlexType
50650>>>//            Move "DateTime"         to ColumnType[i].sDataFlexType
50650>>>//            Move "23.3"             to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_TIMESTAMP2 to ColumnType[i].iSQLType
50650>>>//            Move "datetime2"         to ColumnType[i].sSQLType
50650>>>//            Move DF_DATETIME         to ColumnType[i].iDataFlexType
50650>>>//            Move "DateTime"          to ColumnType[i].sDataFlexType
50650>>>//            Move "23.6"              to ColumnType[i].sPrecision
50650>>>//            Move True                to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_SS_TIMESTAMPOFFSET to ColumnType[i].iSQLType
50650>>>//            Move "datetimeoffset"       to ColumnType[i].sSQLType
50650>>>//            Move DF_DATETIME            to ColumnType[i].iDataFlexType
50650>>>//            Move "DateTime"             to ColumnType[i].sDataFlexType
50650>>>//            Move "34.0"                 to ColumnType[i].sPrecision
50650>>>//            Move True                   to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_DECIMAL        to ColumnType[i].iSQLType
50650>>>//            Move "decimal"          to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "14.8"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_FLOAT          to ColumnType[i].iSQLType
50650>>>//            Move "float"            to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "14.8"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_INTEGER        to ColumnType[i].iSQLType
50650>>>//            Move "int"              to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "8.0"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_MONEY     to ColumnType[i].iSQLType
50650>>>//            Move "money"            to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "15.4"             to ColumnType[i].sPrecision // Studio 18.0 (!)
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_WCHAR          to ColumnType[i].iSQLType
50650>>>//            Move "nchar"            to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "4000"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_WLONGVARCHAR   to ColumnType[i].iSQLType
50650>>>//            Move "ntext"            to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_NUMERIC        to ColumnType[i].iSQLType
50650>>>//            Move "numeric"          to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
50650>>>//            Move "14.8"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_WVARCHAR       to ColumnType[i].iSQLType
50650>>>//            Move "nvarchar"         to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "Text"             to ColumnType[i].sDataFlexType
50650>>>//            Move "4000"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_VARCHARMAX     to ColumnType[i].iSQLType
50650>>>//            Move "nvarchar(max)"    to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_REAL           to ColumnType[i].iSQLType
50650>>>//            Move "real"             to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "NUMERIC"          to ColumnType[i].sDataFlexType
50650>>>//            Move "14.8"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_SMALLDATETIME to ColumnType[i].iSQLType
50650>>>//            Move "smalldatetime"        to ColumnType[i].sSQLType
50650>>>//            Move DF_DATETIME            to ColumnType[i].iDataFlexType
50650>>>//            Move "DATETIME"             to ColumnType[i].sDataFlexType
50650>>>//            Move "23.0"                 to ColumnType[i].sPrecision
50650>>>//            Move True                   to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_SMALLINT       to ColumnType[i].iSQLType
50650>>>//            Move "smallint"         to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "NUMERIC"          to ColumnType[i].sDataFlexType
50650>>>//            Move "4.0"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_SMALLMONEY to ColumnType[i].iSQLType
50650>>>//            Move "smallmoney"        to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD              to ColumnType[i].iDataFlexType
50650>>>//            Move "NUMERIC"           to ColumnType[i].sDataFlexType
50650>>>//            Move "10.0"              to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TEXT           to ColumnType[i].iSQLType
50650>>>//            Move "text"             to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "8000"             to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TIME           to ColumnType[i].iSQLType
50650>>>//            Move "time"             to ColumnType[i].sSQLType
50650>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
50650>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
50650>>>//            Move "19.0"             to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TINYINT        to ColumnType[i].iSQLType
50650>>>//            Move "tinyint"          to ColumnType[i].sSQLType
50650>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
50650>>>//            Move "NUMERIC"          to ColumnType[i].sDataFlexType
50650>>>//            Move "2.0"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_GUID           to ColumnType[i].iSQLType
50650>>>//            Move "uniqueidentifier" to ColumnType[i].sSQLType
50650>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
50650>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
50650>>>//            Move "36"               to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_VARBINARY      to ColumnType[i].iSQLType
50650>>>//            Move "varbinary"        to ColumnType[i].sSQLType
50650>>>//            Move DF_BINARY          to ColumnType[i].iDataFlexType
50650>>>//            Move "BINARY"           to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_LONGVARBINARY  to ColumnType[i].iSQLType
50650>>>//            Move "varbinary(max)"   to ColumnType[i].sSQLType
50650>>>//            Move DF_BINARY          to ColumnType[i].iDataFlexType
50650>>>//            Move "BINARY"           to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_VARCHAR        to ColumnType[i].iSQLType
50650>>>//            Move "varchar"          to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType // ToDo: Under 255 = ASCII type! How to deal with this?
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "8000"             to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_LONGVARCHAR    to ColumnType[i].iSQLType
50650>>>//            Move "varchar(max)"     to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_SS_XML         to ColumnType[i].iSQLType
50650>>>//            Move "xml"              to ColumnType[i].sSQLType
50650>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
50650>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
50650>>>//            Move "16384"            to ColumnType[i].sPrecision
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_DATE      to ColumnType[i].iSQLType
50650>>>//            Move "DATE"             to ColumnType[i].sSQLType
50650>>>//            Move DF_DATE            to ColumnType[i].iDataFlexType
50650>>>//            Move "date"             to ColumnType[i].sDataFlexType
50650>>>//            Move "6.0"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_TIME      to ColumnType[i].iSQLType
50650>>>//            Move "time"             to ColumnType[i].sSQLType
50650>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
50650>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
50650>>>//            Move "8.7"              to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>//
50650>>>//            Move SQL_TYPE_TIMESTAMP to ColumnType[i].iSQLType
50650>>>//            Move "datetime"         to ColumnType[i].sSQLType
50650>>>//            Move DF_DATETIME        to ColumnType[i].iDataFlexType
50650>>>//            Move "DateTime"         to ColumnType[i].sDataFlexType
50650>>>//            Move "23.6"             to ColumnType[i].sPrecision
50650>>>//            Move True               to ColumnType[i].bCanEditSize
50650>>>//            Increment i
50650>>>
50650>>>        End
50650>>>>
50650>>>
50650>>>        // Mertech SQLFlex driver
50650>>>        If (sDriverID = SQLFLEX) Begin
50652>>>
Including file: sql_drv_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\sql_drv_DriverDef.inc)
50652>>>>// Generated By The Database Update Framework
50652>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\Bin\sql_drv_DriverDef.xml
50652>>>>// Driver COLUMN DATA TYPES
50652>>>>//
50652>>>>// Created: 2018-03-14 23:47:46.885
50652>>>>
50652>>>>            Move "bigint"                                to aColumnType[i].sSQLType
50653>>>>            Move -5                                      to aColumnType[i].iSQLType
50654>>>>            Move True                                    to aColumnType[i].bCanEditSize
50655>>>>            Move True                                    to aColumnType[i].bNativeDataType
50656>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50657>>>>            Move 1                                       to aColumnType[i].iMinSize
50658>>>>            Move 14                                      to aColumnType[i].nMaxSize
50659>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50660>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50661>>>>            Move 14                                      to aColumnType[i].sPrecision
50662>>>>            Increment i
50663>>>>
50663>>>>            Move "binary"                                to aColumnType[i].sSQLType
50664>>>>            Move -2                                      to aColumnType[i].iSQLType
50665>>>>            Move True                                    to aColumnType[i].bCanEditSize
50666>>>>            Move True                                    to aColumnType[i].bNativeDataType
50667>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50668>>>>            Move 1                                       to aColumnType[i].iMinSize
50669>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50670>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50671>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50672>>>>            Move 8000                                    to aColumnType[i].sPrecision
50673>>>>            Increment i
50674>>>>
50674>>>>            Move "bit"                                   to aColumnType[i].sSQLType
50675>>>>            Move -7                                      to aColumnType[i].iSQLType
50676>>>>            Move False                                   to aColumnType[i].bCanEditSize
50677>>>>            Move True                                    to aColumnType[i].bNativeDataType
50678>>>>            Move 1                                       to aColumnType[i].iDefaultSize
50679>>>>            Move -1                                      to aColumnType[i].iMinSize
50680>>>>            Move -1                                      to aColumnType[i].nMaxSize
50681>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50682>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50683>>>>            Move -1                                      to aColumnType[i].sPrecision
50684>>>>            Increment i
50685>>>>
50685>>>>            Move "char"                                  to aColumnType[i].sSQLType
50686>>>>            Move 1                                       to aColumnType[i].iSQLType
50687>>>>            Move True                                    to aColumnType[i].bCanEditSize
50688>>>>            Move True                                    to aColumnType[i].bNativeDataType
50689>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50690>>>>            Move 1                                       to aColumnType[i].iMinSize
50691>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50692>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50693>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50694>>>>            Move 8000                                    to aColumnType[i].sPrecision
50695>>>>            Increment i
50696>>>>
50696>>>>            Move "date"                                  to aColumnType[i].sSQLType
50697>>>>            Move 40                                      to aColumnType[i].iSQLType
50698>>>>            Move False                                   to aColumnType[i].bCanEditSize
50699>>>>            Move True                                    to aColumnType[i].bNativeDataType
50700>>>>            Move 12                                      to aColumnType[i].iDefaultSize
50701>>>>            Move -1                                      to aColumnType[i].iMinSize
50702>>>>            Move -1                                      to aColumnType[i].nMaxSize
50703>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50704>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50705>>>>            Move -1                                      to aColumnType[i].sPrecision
50706>>>>            Increment i
50707>>>>
50707>>>>            Move "datetime"                              to aColumnType[i].sSQLType
50708>>>>            Move 11                                      to aColumnType[i].iSQLType
50709>>>>            Move True                                    to aColumnType[i].bCanEditSize
50710>>>>            Move True                                    to aColumnType[i].bNativeDataType
50711>>>>            Move 6                                       to aColumnType[i].iDefaultSize
50712>>>>            Move 6                                       to aColumnType[i].iMinSize
50713>>>>            Move 23                                      to aColumnType[i].nMaxSize
50714>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50715>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50716>>>>            Move 23                                      to aColumnType[i].sPrecision
50717>>>>            Increment i
50718>>>>
50718>>>>            Move "datetime2"                             to aColumnType[i].sSQLType
50719>>>>            Move 42                                      to aColumnType[i].iSQLType
50720>>>>            Move True                                    to aColumnType[i].bCanEditSize
50721>>>>            Move True                                    to aColumnType[i].bNativeDataType
50722>>>>            Move 6                                       to aColumnType[i].iDefaultSize
50723>>>>            Move 6                                       to aColumnType[i].iMinSize
50724>>>>            Move 23                                      to aColumnType[i].nMaxSize
50725>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50726>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50727>>>>            Move 23                                      to aColumnType[i].sPrecision
50728>>>>            Increment i
50729>>>>
50729>>>>            Move "datetimeoffset"                        to aColumnType[i].sSQLType
50730>>>>            Move 43                                      to aColumnType[i].iSQLType
50731>>>>            Move True                                    to aColumnType[i].bCanEditSize
50732>>>>            Move True                                    to aColumnType[i].bNativeDataType
50733>>>>            Move 12                                      to aColumnType[i].iDefaultSize
50734>>>>            Move 12                                      to aColumnType[i].iMinSize
50735>>>>            Move 23                                      to aColumnType[i].nMaxSize
50736>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50737>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50738>>>>            Move 23                                      to aColumnType[i].sPrecision
50739>>>>            Increment i
50740>>>>
50740>>>>            Move "decimal"                               to aColumnType[i].sSQLType
50741>>>>            Move 3                                       to aColumnType[i].iSQLType
50742>>>>            Move True                                    to aColumnType[i].bCanEditSize
50743>>>>            Move True                                    to aColumnType[i].bNativeDataType
50744>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50745>>>>            Move 1                                       to aColumnType[i].iMinSize
50746>>>>            Move 14                                      to aColumnType[i].nMaxSize
50747>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50748>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50749>>>>            Move 14                                      to aColumnType[i].sPrecision
50750>>>>            Increment i
50751>>>>
50751>>>>            Move "float"                                 to aColumnType[i].sSQLType
50752>>>>            Move 6                                       to aColumnType[i].iSQLType
50753>>>>            Move True                                    to aColumnType[i].bCanEditSize
50754>>>>            Move True                                    to aColumnType[i].bNativeDataType
50755>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50756>>>>            Move 1                                       to aColumnType[i].iMinSize
50757>>>>            Move 14                                      to aColumnType[i].nMaxSize
50758>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50759>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50760>>>>            Move 14                                      to aColumnType[i].sPrecision
50761>>>>            Increment i
50762>>>>
50762>>>>            Move "geography"                             to aColumnType[i].sSQLType
50763>>>>            Move 130                                     to aColumnType[i].iSQLType
50764>>>>            Move False                                   to aColumnType[i].bCanEditSize
50765>>>>            Move True                                    to aColumnType[i].bNativeDataType
50766>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50767>>>>            Move -1                                      to aColumnType[i].iMinSize
50768>>>>            Move -1                                      to aColumnType[i].nMaxSize
50769>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50770>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50771>>>>            Move -1                                      to aColumnType[i].sPrecision
50772>>>>            Increment i
50773>>>>
50773>>>>            Move "geometry"                              to aColumnType[i].sSQLType
50774>>>>            Move 129                                     to aColumnType[i].iSQLType
50775>>>>            Move False                                   to aColumnType[i].bCanEditSize
50776>>>>            Move True                                    to aColumnType[i].bNativeDataType
50777>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50778>>>>            Move -1                                      to aColumnType[i].iMinSize
50779>>>>            Move -1                                      to aColumnType[i].nMaxSize
50780>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50781>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50782>>>>            Move -1                                      to aColumnType[i].sPrecision
50783>>>>            Increment i
50784>>>>
50784>>>>            Move "hierarchyid"                           to aColumnType[i].sSQLType
50785>>>>            Move 128                                     to aColumnType[i].iSQLType
50786>>>>            Move False                                   to aColumnType[i].bCanEditSize
50787>>>>            Move True                                    to aColumnType[i].bNativeDataType
50788>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50789>>>>            Move -1                                      to aColumnType[i].iMinSize
50790>>>>            Move -1                                      to aColumnType[i].nMaxSize
50791>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50792>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50793>>>>            Move -1                                      to aColumnType[i].sPrecision
50794>>>>            Increment i
50795>>>>
50795>>>>            Move "image"                                 to aColumnType[i].sSQLType
50796>>>>            Move -4                                      to aColumnType[i].iSQLType
50797>>>>            Move True                                    to aColumnType[i].bCanEditSize
50798>>>>            Move True                                    to aColumnType[i].bNativeDataType
50799>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50800>>>>            Move 1                                       to aColumnType[i].iMinSize
50801>>>>            Move 16384                                   to aColumnType[i].nMaxSize
50802>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50803>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50804>>>>            Move 16384                                   to aColumnType[i].sPrecision
50805>>>>            Increment i
50806>>>>
50806>>>>            Move "int"                                   to aColumnType[i].sSQLType
50807>>>>            Move 4                                       to aColumnType[i].iSQLType
50808>>>>            Move True                                    to aColumnType[i].bCanEditSize
50809>>>>            Move True                                    to aColumnType[i].bNativeDataType
50810>>>>            Move 11                                      to aColumnType[i].iDefaultSize
50811>>>>            Move 1                                       to aColumnType[i].iMinSize
50812>>>>            Move 11                                      to aColumnType[i].nMaxSize
50813>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50814>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50815>>>>            Move 11                                      to aColumnType[i].sPrecision
50816>>>>            Increment i
50817>>>>
50817>>>>            Move "nchar"                                 to aColumnType[i].sSQLType
50818>>>>            Move -8                                      to aColumnType[i].iSQLType
50819>>>>            Move True                                    to aColumnType[i].bCanEditSize
50820>>>>            Move True                                    to aColumnType[i].bNativeDataType
50821>>>>            Move -1                                      to aColumnType[i].iDefaultSize
50822>>>>            Move 1                                       to aColumnType[i].iMinSize
50823>>>>            Move 4000                                    to aColumnType[i].nMaxSize
50824>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50825>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50826>>>>            Move 4000                                    to aColumnType[i].sPrecision
50827>>>>            Increment i
50828>>>>
50828>>>>            Move "ntext"                                 to aColumnType[i].sSQLType
50829>>>>            Move -10                                     to aColumnType[i].iSQLType
50830>>>>            Move True                                    to aColumnType[i].bCanEditSize
50831>>>>            Move True                                    to aColumnType[i].bNativeDataType
50832>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50833>>>>            Move 1                                       to aColumnType[i].iMinSize
50834>>>>            Move 16384                                   to aColumnType[i].nMaxSize
50835>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50836>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50837>>>>            Move 16384                                   to aColumnType[i].sPrecision
50838>>>>            Increment i
50839>>>>
50839>>>>            Move "numeric"                               to aColumnType[i].sSQLType
50840>>>>            Move 2                                       to aColumnType[i].iSQLType
50841>>>>            Move True                                    to aColumnType[i].bCanEditSize
50842>>>>            Move True                                    to aColumnType[i].bNativeDataType
50843>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50844>>>>            Move 1                                       to aColumnType[i].iMinSize
50845>>>>            Move 14                                      to aColumnType[i].nMaxSize
50846>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50847>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50848>>>>            Move 14                                      to aColumnType[i].sPrecision
50849>>>>            Increment i
50850>>>>
50850>>>>            Move "nvarchar"                              to aColumnType[i].sSQLType
50851>>>>            Move -9                                      to aColumnType[i].iSQLType
50852>>>>            Move True                                    to aColumnType[i].bCanEditSize
50853>>>>            Move True                                    to aColumnType[i].bNativeDataType
50854>>>>            Move 1                                       to aColumnType[i].iDefaultSize
50855>>>>            Move 1                                       to aColumnType[i].iMinSize
50856>>>>            Move 4000                                    to aColumnType[i].nMaxSize
50857>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50858>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50859>>>>            Move 4000                                    to aColumnType[i].sPrecision
50860>>>>            Increment i
50861>>>>
50861>>>>            Move "nvarchar(max)"                         to aColumnType[i].sSQLType
50862>>>>            Move -100                                    to aColumnType[i].iSQLType
50863>>>>            Move True                                    to aColumnType[i].bCanEditSize
50864>>>>            Move True                                    to aColumnType[i].bNativeDataType
50865>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50866>>>>            Move 1                                       to aColumnType[i].iMinSize
50867>>>>            Move 16384                                   to aColumnType[i].nMaxSize
50868>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50869>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50870>>>>            Move 16384                                   to aColumnType[i].sPrecision
50871>>>>            Increment i
50872>>>>
50872>>>>            Move "real"                                  to aColumnType[i].sSQLType
50873>>>>            Move 7                                       to aColumnType[i].iSQLType
50874>>>>            Move True                                    to aColumnType[i].bCanEditSize
50875>>>>            Move True                                    to aColumnType[i].bNativeDataType
50876>>>>            Move 14                                      to aColumnType[i].iDefaultSize
50877>>>>            Move 1                                       to aColumnType[i].iMinSize
50878>>>>            Move 14                                      to aColumnType[i].nMaxSize
50879>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50880>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50881>>>>            Move 14                                      to aColumnType[i].sPrecision
50882>>>>            Increment i
50883>>>>
50883>>>>            Move "smalldatetime"                         to aColumnType[i].sSQLType
50884>>>>            Move 58                                      to aColumnType[i].iSQLType
50885>>>>            Move True                                    to aColumnType[i].bCanEditSize
50886>>>>            Move True                                    to aColumnType[i].bNativeDataType
50887>>>>            Move 12                                      to aColumnType[i].iDefaultSize
50888>>>>            Move 12                                      to aColumnType[i].iMinSize
50889>>>>            Move 23                                      to aColumnType[i].nMaxSize
50890>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50891>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50892>>>>            Move 23                                      to aColumnType[i].sPrecision
50893>>>>            Increment i
50894>>>>
50894>>>>            Move "smallint"                              to aColumnType[i].sSQLType
50895>>>>            Move 5                                       to aColumnType[i].iSQLType
50896>>>>            Move True                                    to aColumnType[i].bCanEditSize
50897>>>>            Move True                                    to aColumnType[i].bNativeDataType
50898>>>>            Move 6                                       to aColumnType[i].iDefaultSize
50899>>>>            Move -1                                      to aColumnType[i].iMinSize
50900>>>>            Move 6                                       to aColumnType[i].nMaxSize
50901>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50902>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50903>>>>            Move 6                                       to aColumnType[i].sPrecision
50904>>>>            Increment i
50905>>>>
50905>>>>            Move "sql_variant"                           to aColumnType[i].sSQLType
50906>>>>            Move -150                                    to aColumnType[i].iSQLType
50907>>>>            Move False                                   to aColumnType[i].bCanEditSize
50908>>>>            Move True                                    to aColumnType[i].bNativeDataType
50909>>>>            Move 8016                                    to aColumnType[i].iDefaultSize
50910>>>>            Move -1                                      to aColumnType[i].iMinSize
50911>>>>            Move -1                                      to aColumnType[i].nMaxSize
50912>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50913>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50914>>>>            Move -1                                      to aColumnType[i].sPrecision
50915>>>>            Increment i
50916>>>>
50916>>>>            Move "text"                                  to aColumnType[i].sSQLType
50917>>>>            Move -1                                      to aColumnType[i].iSQLType
50918>>>>            Move True                                    to aColumnType[i].bCanEditSize
50919>>>>            Move True                                    to aColumnType[i].bNativeDataType
50920>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50921>>>>            Move 1                                       to aColumnType[i].iMinSize
50922>>>>            Move 16384                                   to aColumnType[i].nMaxSize
50923>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
50924>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
50925>>>>            Move 16384                                   to aColumnType[i].sPrecision
50926>>>>            Increment i
50927>>>>
50927>>>>            Move "time"                                  to aColumnType[i].sSQLType
50928>>>>            Move 41                                      to aColumnType[i].iSQLType
50929>>>>            Move True                                    to aColumnType[i].bCanEditSize
50930>>>>            Move True                                    to aColumnType[i].bNativeDataType
50931>>>>            Move 8                                       to aColumnType[i].iDefaultSize
50932>>>>            Move 8                                       to aColumnType[i].iMinSize
50933>>>>            Move 16                                      to aColumnType[i].nMaxSize
50934>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50935>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50936>>>>            Move 16                                      to aColumnType[i].sPrecision
50937>>>>            Increment i
50938>>>>
50938>>>>            Move "timestamp"                             to aColumnType[i].sSQLType
50939>>>>            Move 93                                      to aColumnType[i].iSQLType
50940>>>>            Move False                                   to aColumnType[i].bCanEditSize
50941>>>>            Move True                                    to aColumnType[i].bNativeDataType
50942>>>>            Move 8                                       to aColumnType[i].iDefaultSize
50943>>>>            Move -1                                      to aColumnType[i].iMinSize
50944>>>>            Move -1                                      to aColumnType[i].nMaxSize
50945>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
50946>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
50947>>>>            Move -1                                      to aColumnType[i].sPrecision
50948>>>>            Increment i
50949>>>>
50949>>>>            Move "tinyint"                               to aColumnType[i].sSQLType
50950>>>>            Move -6                                      to aColumnType[i].iSQLType
50951>>>>            Move True                                    to aColumnType[i].bCanEditSize
50952>>>>            Move True                                    to aColumnType[i].bNativeDataType
50953>>>>            Move 3                                       to aColumnType[i].iDefaultSize
50954>>>>            Move -1                                      to aColumnType[i].iMinSize
50955>>>>            Move 3                                       to aColumnType[i].nMaxSize
50956>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
50957>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
50958>>>>            Move 3                                       to aColumnType[i].sPrecision
50959>>>>            Increment i
50960>>>>
50960>>>>            Move "uniqueidentifier"                      to aColumnType[i].sSQLType
50961>>>>            Move -11                                     to aColumnType[i].iSQLType
50962>>>>            Move False                                   to aColumnType[i].bCanEditSize
50963>>>>            Move True                                    to aColumnType[i].bNativeDataType
50964>>>>            Move 38                                      to aColumnType[i].iDefaultSize
50965>>>>            Move -1                                      to aColumnType[i].iMinSize
50966>>>>            Move -1                                      to aColumnType[i].nMaxSize
50967>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50968>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50969>>>>            Move -1                                      to aColumnType[i].sPrecision
50970>>>>            Increment i
50971>>>>
50971>>>>            Move "varbinary"                             to aColumnType[i].sSQLType
50972>>>>            Move -3                                      to aColumnType[i].iSQLType
50973>>>>            Move True                                    to aColumnType[i].bCanEditSize
50974>>>>            Move True                                    to aColumnType[i].bNativeDataType
50975>>>>            Move 8000                                    to aColumnType[i].iDefaultSize
50976>>>>            Move 1                                       to aColumnType[i].iMinSize
50977>>>>            Move 8000                                    to aColumnType[i].nMaxSize
50978>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
50979>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
50980>>>>            Move 8000                                    to aColumnType[i].sPrecision
50981>>>>            Increment i
50982>>>>
50982>>>>            Move "varbinary(max)"                        to aColumnType[i].sSQLType
50983>>>>            Move -98                                     to aColumnType[i].iSQLType
50984>>>>            Move True                                    to aColumnType[i].bCanEditSize
50985>>>>            Move True                                    to aColumnType[i].bNativeDataType
50986>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
50987>>>>            Move 1                                       to aColumnType[i].iMinSize
50988>>>>            Move 16384                                   to aColumnType[i].nMaxSize
50989>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
50990>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
50991>>>>            Move 16384                                   to aColumnType[i].sPrecision
50992>>>>            Increment i
50993>>>>
50993>>>>            Move "varchar"                               to aColumnType[i].sSQLType
50994>>>>            Move 12                                      to aColumnType[i].iSQLType
50995>>>>            Move True                                    to aColumnType[i].bCanEditSize
50996>>>>            Move True                                    to aColumnType[i].bNativeDataType
50997>>>>            Move 1                                       to aColumnType[i].iDefaultSize
50998>>>>            Move 1                                       to aColumnType[i].iMinSize
50999>>>>            Move 8000                                    to aColumnType[i].nMaxSize
51000>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51001>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51002>>>>            Move 8000                                    to aColumnType[i].sPrecision
51003>>>>            Increment i
51004>>>>
51004>>>>            Move "varchar(max)"                          to aColumnType[i].sSQLType
51005>>>>            Move -99                                     to aColumnType[i].iSQLType
51006>>>>            Move True                                    to aColumnType[i].bCanEditSize
51007>>>>            Move True                                    to aColumnType[i].bNativeDataType
51008>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51009>>>>            Move 1                                       to aColumnType[i].iMinSize
51010>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51011>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51012>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51013>>>>            Move 16384                                   to aColumnType[i].sPrecision
51014>>>>            Increment i
51015>>>>
51015>>>>            Move "xml"                                   to aColumnType[i].sSQLType
51016>>>>            Move -370                                    to aColumnType[i].iSQLType
51017>>>>            Move True                                    to aColumnType[i].bCanEditSize
51018>>>>            Move True                                    to aColumnType[i].bNativeDataType
51019>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51020>>>>            Move 1                                       to aColumnType[i].iMinSize
51021>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51022>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51023>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51024>>>>            Move 16384                                   to aColumnType[i].sPrecision
51025>>>>            Increment i
51026>>>>
51026>>>>
51026>>>            
51026>>>//            Move eSQLServer_BIGINT  to ColumnType[i].iSQLType
51026>>>//            Move "BigInt"           to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.0"             to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_BINARY  to ColumnType[i].iSQLType
51026>>>//            Move "Binary"           to ColumnType[i].sSQLType
51026>>>//            Move DF_BINARY          to ColumnType[i].iDataFlexType
51026>>>//            Move "Binary"           to ColumnType[i].sDataFlexType
51026>>>//            Move "8000"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_BIT     to ColumnType[i].iSQLType
51026>>>//            Move "Bit"              to ColumnType[i].sSQLType
51026>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
51026>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
51026>>>//            Move "1.0"              to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize // In SQL allows 1, 0, or "NULL"
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_CHAR    to ColumnType[i].iSQLType
51026>>>//            Move "Char"             to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
51026>>>//            Move "Text"             to ColumnType[i].sDataFlexType
51026>>>//            Move "8000"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DATE    to ColumnType[i].iSQLType
51026>>>//            Move "Date"             to ColumnType[i].sSQLType
51026>>>//            Move DF_DATE            to ColumnType[i].iDataFlexType
51026>>>//            Move "Date"             to ColumnType[i].sDataFlexType
51026>>>//            Move "6.0"              to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DATETIME    to ColumnType[i].iSQLType
51026>>>//            Move "DateTime"             to ColumnType[i].sSQLType
51026>>>//            Move DF_DATETIME            to ColumnType[i].iDataFlexType
51026>>>//            Move "DateTime"             to ColumnType[i].sDataFlexType
51026>>>//            Move "23.3"                 to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DATETIME2   to ColumnType[i].iSQLType
51026>>>//            Move "DateTime2"            to ColumnType[i].sSQLType
51026>>>//            Move DF_DATETIME            to ColumnType[i].iDataFlexType
51026>>>//            Move "DateTime"             to ColumnType[i].sDataFlexType
51026>>>//            Move "23.6"                 to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DATETIMEOFFSET  to ColumnType[i].iSQLType
51026>>>//            Move "DateTimeOffest"           to ColumnType[i].sSQLType
51026>>>//            Move DF_DATETIME                to ColumnType[i].iDataFlexType
51026>>>//            Move "DateTime"                 to ColumnType[i].sDataFlexType
51026>>>//            Move "23.0"                     to ColumnType[i].sPrecision
51026>>>//            Move True                       to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DECIMAL to ColumnType[i].iSQLType
51026>>>//            Move "Decimal"          to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.8"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_DOUBLE  to ColumnType[i].iSQLType
51026>>>//            Move "Double"           to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.8"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_FLOAT   to ColumnType[i].iSQLType
51026>>>//            Move "Float"            to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.8"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_INT     to ColumnType[i].iSQLType
51026>>>//            Move "Int"              to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "11.0"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_NCHAR   to ColumnType[i].iSQLType
51026>>>//            Move "Nchar"            to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
51026>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
51026>>>//            Move "4000"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_NTEXT   to ColumnType[i].iSQLType
51026>>>//            Move "Ntext"            to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
51026>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
51026>>>//            Move "16384"            to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_NUMERIC to ColumnType[i].iSQLType
51026>>>//            Move "Numeric"          to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.8"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_NVARCHAR    to ColumnType[i].iSQLType
51026>>>//            Move "NvarChar"             to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT                to ColumnType[i].iDataFlexType
51026>>>//            Move "Text"                 to ColumnType[i].sDataFlexType
51026>>>//            Move "4000"                 to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_NVARCHARMAX to ColumnType[i].iSQLType
51026>>>//            Move "NvarCharMax"          to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT                to ColumnType[i].iDataFlexType
51026>>>//            Move "Text"                 to ColumnType[i].sDataFlexType
51026>>>//            Move "16384"                to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_REAL    to ColumnType[i].iSQLType
51026>>>//            Move "Real"             to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "NUMERIC"          to ColumnType[i].sDataFlexType
51026>>>//            Move "14.8"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_SMALLDATETIME   to ColumnType[i].iSQLType
51026>>>//            Move "SmallDateTime"            to ColumnType[i].sSQLType
51026>>>//            Move DF_DATETIME                to ColumnType[i].iDataFlexType
51026>>>//            Move "DATETIME"                 to ColumnType[i].sDataFlexType
51026>>>//            Move "23.0"                     to ColumnType[i].sPrecision
51026>>>//            Move True                       to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_SMALLINT    to ColumnType[i].iSQLType
51026>>>//            Move "SmallInt"             to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD                 to ColumnType[i].iDataFlexType
51026>>>//            Move "NUMERIC"              to ColumnType[i].sDataFlexType
51026>>>//            Move "6.0"                  to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_TEXT    to ColumnType[i].iSQLType
51026>>>//            Move "Text"             to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
51026>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
51026>>>//            Move "8000"             to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_TIME    to ColumnType[i].iSQLType
51026>>>//            Move "Time"             to ColumnType[i].sSQLType
51026>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
51026>>>//            Move "Date"             to ColumnType[i].sDataFlexType
51026>>>//            Move "16.0"             to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_TIMESTAMP   to ColumnType[i].iSQLType
51026>>>//            Move "TimeStamp"            to ColumnType[i].sSQLType
51026>>>//            Move DF_ASCII               to ColumnType[i].iDataFlexType
51026>>>//            Move "DateTime"             to ColumnType[i].sDataFlexType
51026>>>//            Move "8.0"                  to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_TINYINT to ColumnType[i].iSQLType
51026>>>//            Move "TinyInt"          to ColumnType[i].sSQLType
51026>>>//            Move DF_BCD             to ColumnType[i].iDataFlexType
51026>>>//            Move "Numeric"          to ColumnType[i].sDataFlexType
51026>>>//            Move "3.0"              to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_GUID    to ColumnType[i].iSQLType
51026>>>//            Move "UniqueIdentifier" to ColumnType[i].sSQLType
51026>>>//            Move DF_ASCII           to ColumnType[i].iDataFlexType
51026>>>//            Move "ASCII"            to ColumnType[i].sDataFlexType
51026>>>//            Move "38"               to ColumnType[i].sPrecision
51026>>>//            Move True               to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_VARBINARY   to ColumnType[i].iSQLType
51026>>>//            Move "VarBinary"            to ColumnType[i].sSQLType
51026>>>//            Move DF_BINARY              to ColumnType[i].iDataFlexType
51026>>>//            Move "BINARY"               to ColumnType[i].sDataFlexType
51026>>>//            Move "8000"                 to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_VARBINARYMAX to ColumnType[i].iSQLType
51026>>>//            Move "VarBinary(Max)"        to ColumnType[i].sSQLType
51026>>>//            Move DF_BINARY               to ColumnType[i].iDataFlexType
51026>>>//            Move "BINARY"                to ColumnType[i].sDataFlexType
51026>>>//            Move "16384"                 to ColumnType[i].sPrecision
51026>>>//            Move True                    to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_VARCHAR to ColumnType[i].iSQLType
51026>>>//            Move "VarChar"          to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType // ToDo: Under 255 = ASCII type! How to deal with this?
51026>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
51026>>>//            Move "8000"             to ColumnType[i].sPrecision
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_VARCHARMAX  to ColumnType[i].iSQLType
51026>>>//            Move "VarChar(Max)"         to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT                to ColumnType[i].iDataFlexType
51026>>>//            Move "TEXT"                 to ColumnType[i].sDataFlexType
51026>>>//            Move "16384"                to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_SQLVARIANT  to ColumnType[i].iSQLType
51026>>>//            Move "SQL_Variant"          to ColumnType[i].sSQLType
51026>>>//            Move DF_BINARY              to ColumnType[i].iDataFlexType
51026>>>//            Move "Binary"               to ColumnType[i].sDataFlexType
51026>>>//            Move "8016"                 to ColumnType[i].sPrecision
51026>>>//            Move True                   to ColumnType[i].bCanEditSize
51026>>>//            Increment i
51026>>>//
51026>>>//            Move eSQLServer_XML     to ColumnType[i].iSQLType
51026>>>//            Move "XML"              to ColumnType[i].sSQLType
51026>>>//            Move DF_TEXT            to ColumnType[i].iDataFlexType
51026>>>//            Move "TEXT"             to ColumnType[i].sDataFlexType
51026>>>//            Move "16384"            to ColumnType[i].sPrecision
51026>>>        End
51026>>>>
51026>>>
51026>>>        Function_Return aColumnType
51027>>>    End_Function
51028>>>
51028>>>    // MySQL Data Types
51028>>>    Function _UtilEnumerateMySQLTypes Returns tColumnType[]
51030>>>        tColumnType[] aColumnType
51030>>>        tColumnType[] aColumnType
51031>>>        Integer i
51031>>>        
Including file: mdsmysql_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\mdsmysql_DriverDef.inc)
51031>>>>// Generated By The Database Update Framework
51031>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\Bin\mdsmysql_DriverDef.xml
51031>>>>// Driver COLUMN DATA TYPES
51031>>>>//
51031>>>>// Created: 2018-03-14 23:46:49.593
51031>>>>
51031>>>>            Move "bigint"                                to aColumnType[i].sSQLType
51032>>>>            Move 8                                       to aColumnType[i].iSQLType
51033>>>>            Move True                                    to aColumnType[i].bCanEditSize
51034>>>>            Move True                                    to aColumnType[i].bNativeDataType
51035>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51036>>>>            Move 1                                       to aColumnType[i].iMinSize
51037>>>>            Move 14                                      to aColumnType[i].nMaxSize
51038>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51039>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51040>>>>            Move 14                                      to aColumnType[i].sPrecision
51041>>>>            Increment i
51042>>>>
51042>>>>            Move "bit"                                   to aColumnType[i].sSQLType
51043>>>>            Move 16                                      to aColumnType[i].iSQLType
51044>>>>            Move True                                    to aColumnType[i].bCanEditSize
51045>>>>            Move True                                    to aColumnType[i].bNativeDataType
51046>>>>            Move -1                                      to aColumnType[i].iDefaultSize
51047>>>>            Move -1                                      to aColumnType[i].iMinSize
51048>>>>            Move 64                                      to aColumnType[i].nMaxSize
51049>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51050>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51051>>>>            Move 64                                      to aColumnType[i].sPrecision
51052>>>>            Increment i
51053>>>>
51053>>>>            Move "blob"                                  to aColumnType[i].sSQLType
51054>>>>            Move 252                                     to aColumnType[i].iSQLType
51055>>>>            Move True                                    to aColumnType[i].bCanEditSize
51056>>>>            Move True                                    to aColumnType[i].bNativeDataType
51057>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51058>>>>            Move 1                                       to aColumnType[i].iMinSize
51059>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51060>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51061>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51062>>>>            Move 16384                                   to aColumnType[i].sPrecision
51063>>>>            Increment i
51064>>>>
51064>>>>            Move "char"                                  to aColumnType[i].sSQLType
51065>>>>            Move 254                                     to aColumnType[i].iSQLType
51066>>>>            Move True                                    to aColumnType[i].bCanEditSize
51067>>>>            Move True                                    to aColumnType[i].bNativeDataType
51068>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51069>>>>            Move 1                                       to aColumnType[i].iMinSize
51070>>>>            Move 255                                     to aColumnType[i].nMaxSize
51071>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51072>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51073>>>>            Move 255                                     to aColumnType[i].sPrecision
51074>>>>            Increment i
51075>>>>
51075>>>>            Move "date"                                  to aColumnType[i].sSQLType
51076>>>>            Move 10                                      to aColumnType[i].iSQLType
51077>>>>            Move False                                   to aColumnType[i].bCanEditSize
51078>>>>            Move True                                    to aColumnType[i].bNativeDataType
51079>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51080>>>>            Move -1                                      to aColumnType[i].iMinSize
51081>>>>            Move -1                                      to aColumnType[i].nMaxSize
51082>>>>            Move "DF_DATE"                               to aColumnType[i].sDataFlexType
51083>>>>            Move DF_DATE                                 to aColumnType[i].iDataFlexType
51084>>>>            Move 6                                       to aColumnType[i].sPrecision
51085>>>>            Increment i
51086>>>>
51086>>>>            Move "datetime"                              to aColumnType[i].sSQLType
51087>>>>            Move 12                                      to aColumnType[i].iSQLType
51088>>>>            Move True                                    to aColumnType[i].bCanEditSize
51089>>>>            Move True                                    to aColumnType[i].bNativeDataType
51090>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51091>>>>            Move 6                                       to aColumnType[i].iMinSize
51092>>>>            Move 23                                      to aColumnType[i].nMaxSize
51093>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51094>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51095>>>>            Move 23                                      to aColumnType[i].sPrecision
51096>>>>            Increment i
51097>>>>
51097>>>>            Move "decimal"                               to aColumnType[i].sSQLType
51098>>>>            Move 246                                     to aColumnType[i].iSQLType
51099>>>>            Move True                                    to aColumnType[i].bCanEditSize
51100>>>>            Move True                                    to aColumnType[i].bNativeDataType
51101>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51102>>>>            Move -1                                      to aColumnType[i].iMinSize
51103>>>>            Move 14                                      to aColumnType[i].nMaxSize
51104>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51105>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51106>>>>            Move 14                                      to aColumnType[i].sPrecision
51107>>>>            Increment i
51108>>>>
51108>>>>            Move "decimal-MySQL4"                        to aColumnType[i].sSQLType
51109>>>>            Move 0                                       to aColumnType[i].iSQLType
51110>>>>            Move True                                    to aColumnType[i].bCanEditSize
51111>>>>            Move True                                    to aColumnType[i].bNativeDataType
51112>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51113>>>>            Move -1                                      to aColumnType[i].iMinSize
51114>>>>            Move 14                                      to aColumnType[i].nMaxSize
51115>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51116>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51117>>>>            Move 14                                      to aColumnType[i].sPrecision
51118>>>>            Increment i
51119>>>>
51119>>>>            Move "double"                                to aColumnType[i].sSQLType
51120>>>>            Move 5                                       to aColumnType[i].iSQLType
51121>>>>            Move True                                    to aColumnType[i].bCanEditSize
51122>>>>            Move True                                    to aColumnType[i].bNativeDataType
51123>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51124>>>>            Move -1                                      to aColumnType[i].iMinSize
51125>>>>            Move 14                                      to aColumnType[i].nMaxSize
51126>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51127>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51128>>>>            Move 14                                      to aColumnType[i].sPrecision
51129>>>>            Increment i
51130>>>>
51130>>>>            Move "enum"                                  to aColumnType[i].sSQLType
51131>>>>            Move 247                                     to aColumnType[i].iSQLType
51132>>>>            Move True                                    to aColumnType[i].bCanEditSize
51133>>>>            Move True                                    to aColumnType[i].bNativeDataType
51134>>>>            Move -1                                      to aColumnType[i].iDefaultSize
51135>>>>            Move -1                                      to aColumnType[i].iMinSize
51136>>>>            Move 255                                     to aColumnType[i].nMaxSize
51137>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51138>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51139>>>>            Move 255                                     to aColumnType[i].sPrecision
51140>>>>            Increment i
51141>>>>
51141>>>>            Move "float"                                 to aColumnType[i].sSQLType
51142>>>>            Move 4                                       to aColumnType[i].iSQLType
51143>>>>            Move True                                    to aColumnType[i].bCanEditSize
51144>>>>            Move True                                    to aColumnType[i].bNativeDataType
51145>>>>            Move 4                                       to aColumnType[i].iDefaultSize
51146>>>>            Move -1                                      to aColumnType[i].iMinSize
51147>>>>            Move 14                                      to aColumnType[i].nMaxSize
51148>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51149>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51150>>>>            Move 14                                      to aColumnType[i].sPrecision
51151>>>>            Increment i
51152>>>>
51152>>>>            Move "int"                                   to aColumnType[i].sSQLType
51153>>>>            Move 3                                       to aColumnType[i].iSQLType
51154>>>>            Move True                                    to aColumnType[i].bCanEditSize
51155>>>>            Move True                                    to aColumnType[i].bNativeDataType
51156>>>>            Move 10                                      to aColumnType[i].iDefaultSize
51157>>>>            Move -1                                      to aColumnType[i].iMinSize
51158>>>>            Move 11                                      to aColumnType[i].nMaxSize
51159>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51160>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51161>>>>            Move 11                                      to aColumnType[i].sPrecision
51162>>>>            Increment i
51163>>>>
51163>>>>            Move "longblob"                              to aColumnType[i].sSQLType
51164>>>>            Move 251                                     to aColumnType[i].iSQLType
51165>>>>            Move True                                    to aColumnType[i].bCanEditSize
51166>>>>            Move True                                    to aColumnType[i].bNativeDataType
51167>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51168>>>>            Move 1                                       to aColumnType[i].iMinSize
51169>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51170>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51171>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51172>>>>            Move 16384                                   to aColumnType[i].sPrecision
51173>>>>            Increment i
51174>>>>
51174>>>>            Move "longtext"                              to aColumnType[i].sSQLType
51175>>>>            Move -251                                    to aColumnType[i].iSQLType
51176>>>>            Move True                                    to aColumnType[i].bCanEditSize
51177>>>>            Move True                                    to aColumnType[i].bNativeDataType
51178>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51179>>>>            Move 1                                       to aColumnType[i].iMinSize
51180>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51181>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
51182>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
51183>>>>            Move 16384                                   to aColumnType[i].sPrecision
51184>>>>            Increment i
51185>>>>
51185>>>>            Move "mediumblob"                            to aColumnType[i].sSQLType
51186>>>>            Move 250                                     to aColumnType[i].iSQLType
51187>>>>            Move True                                    to aColumnType[i].bCanEditSize
51188>>>>            Move True                                    to aColumnType[i].bNativeDataType
51189>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51190>>>>            Move 1                                       to aColumnType[i].iMinSize
51191>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51192>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51193>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51194>>>>            Move 16384                                   to aColumnType[i].sPrecision
51195>>>>            Increment i
51196>>>>
51196>>>>            Move "mediumint"                             to aColumnType[i].sSQLType
51197>>>>            Move 9                                       to aColumnType[i].iSQLType
51198>>>>            Move True                                    to aColumnType[i].bCanEditSize
51199>>>>            Move True                                    to aColumnType[i].bNativeDataType
51200>>>>            Move 8                                       to aColumnType[i].iDefaultSize
51201>>>>            Move 1                                       to aColumnType[i].iMinSize
51202>>>>            Move 9                                       to aColumnType[i].nMaxSize
51203>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51204>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51205>>>>            Move 9                                       to aColumnType[i].sPrecision
51206>>>>            Increment i
51207>>>>
51207>>>>            Move "mediumtext"                            to aColumnType[i].sSQLType
51208>>>>            Move -250                                    to aColumnType[i].iSQLType
51209>>>>            Move True                                    to aColumnType[i].bCanEditSize
51210>>>>            Move True                                    to aColumnType[i].bNativeDataType
51211>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51212>>>>            Move 1                                       to aColumnType[i].iMinSize
51213>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51214>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
51215>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
51216>>>>            Move 16384                                   to aColumnType[i].sPrecision
51217>>>>            Increment i
51218>>>>
51218>>>>            Move "set"                                   to aColumnType[i].sSQLType
51219>>>>            Move 248                                     to aColumnType[i].iSQLType
51220>>>>            Move True                                    to aColumnType[i].bCanEditSize
51221>>>>            Move True                                    to aColumnType[i].bNativeDataType
51222>>>>            Move -1                                      to aColumnType[i].iDefaultSize
51223>>>>            Move -1                                      to aColumnType[i].iMinSize
51224>>>>            Move 255                                     to aColumnType[i].nMaxSize
51225>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51226>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51227>>>>            Move 255                                     to aColumnType[i].sPrecision
51228>>>>            Increment i
51229>>>>
51229>>>>            Move "smallint"                              to aColumnType[i].sSQLType
51230>>>>            Move 2                                       to aColumnType[i].iSQLType
51231>>>>            Move True                                    to aColumnType[i].bCanEditSize
51232>>>>            Move True                                    to aColumnType[i].bNativeDataType
51233>>>>            Move 5                                       to aColumnType[i].iDefaultSize
51234>>>>            Move 1                                       to aColumnType[i].iMinSize
51235>>>>            Move 6                                       to aColumnType[i].nMaxSize
51236>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51237>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51238>>>>            Move 6                                       to aColumnType[i].sPrecision
51239>>>>            Increment i
51240>>>>
51240>>>>            Move "text"                                  to aColumnType[i].sSQLType
51241>>>>            Move -252                                    to aColumnType[i].iSQLType
51242>>>>            Move True                                    to aColumnType[i].bCanEditSize
51243>>>>            Move True                                    to aColumnType[i].bNativeDataType
51244>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51245>>>>            Move 1                                       to aColumnType[i].iMinSize
51246>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51247>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
51248>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
51249>>>>            Move 16384                                   to aColumnType[i].sPrecision
51250>>>>            Increment i
51251>>>>
51251>>>>            Move "time"                                  to aColumnType[i].sSQLType
51252>>>>            Move 11                                      to aColumnType[i].iSQLType
51253>>>>            Move False                                   to aColumnType[i].bCanEditSize
51254>>>>            Move True                                    to aColumnType[i].bNativeDataType
51255>>>>            Move 10                                      to aColumnType[i].iDefaultSize
51256>>>>            Move -1                                      to aColumnType[i].iMinSize
51257>>>>            Move -1                                      to aColumnType[i].nMaxSize
51258>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51259>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51260>>>>            Move -1                                      to aColumnType[i].sPrecision
51261>>>>            Increment i
51262>>>>
51262>>>>            Move "timestamp"                             to aColumnType[i].sSQLType
51263>>>>            Move 7                                       to aColumnType[i].iSQLType
51264>>>>            Move True                                    to aColumnType[i].bCanEditSize
51265>>>>            Move True                                    to aColumnType[i].bNativeDataType
51266>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51267>>>>            Move 6                                       to aColumnType[i].iMinSize
51268>>>>            Move 23                                      to aColumnType[i].nMaxSize
51269>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51270>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51271>>>>            Move 23                                      to aColumnType[i].sPrecision
51272>>>>            Increment i
51273>>>>
51273>>>>            Move "tinyblob"                              to aColumnType[i].sSQLType
51274>>>>            Move 249                                     to aColumnType[i].iSQLType
51275>>>>            Move True                                    to aColumnType[i].bCanEditSize
51276>>>>            Move True                                    to aColumnType[i].bNativeDataType
51277>>>>            Move 255                                     to aColumnType[i].iDefaultSize
51278>>>>            Move 1                                       to aColumnType[i].iMinSize
51279>>>>            Move 255                                     to aColumnType[i].nMaxSize
51280>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51281>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51282>>>>            Move 255                                     to aColumnType[i].sPrecision
51283>>>>            Increment i
51284>>>>
51284>>>>            Move "tinyint"                               to aColumnType[i].sSQLType
51285>>>>            Move 1                                       to aColumnType[i].iSQLType
51286>>>>            Move True                                    to aColumnType[i].bCanEditSize
51287>>>>            Move True                                    to aColumnType[i].bNativeDataType
51288>>>>            Move 4                                       to aColumnType[i].iDefaultSize
51289>>>>            Move 1                                       to aColumnType[i].iMinSize
51290>>>>            Move 4                                       to aColumnType[i].nMaxSize
51291>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51292>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51293>>>>            Move 4                                       to aColumnType[i].sPrecision
51294>>>>            Increment i
51295>>>>
51295>>>>            Move "tinytext"                              to aColumnType[i].sSQLType
51296>>>>            Move -249                                    to aColumnType[i].iSQLType
51297>>>>            Move True                                    to aColumnType[i].bCanEditSize
51298>>>>            Move True                                    to aColumnType[i].bNativeDataType
51299>>>>            Move 255                                     to aColumnType[i].iDefaultSize
51300>>>>            Move 1                                       to aColumnType[i].iMinSize
51301>>>>            Move 255                                     to aColumnType[i].nMaxSize
51302>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51303>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51304>>>>            Move 255                                     to aColumnType[i].sPrecision
51305>>>>            Increment i
51306>>>>
51306>>>>            Move "varchar"                               to aColumnType[i].sSQLType
51307>>>>            Move 253                                     to aColumnType[i].iSQLType
51308>>>>            Move True                                    to aColumnType[i].bCanEditSize
51309>>>>            Move True                                    to aColumnType[i].bNativeDataType
51310>>>>            Move -1                                      to aColumnType[i].iDefaultSize
51311>>>>            Move -1                                      to aColumnType[i].iMinSize
51312>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51313>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51314>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51315>>>>            Move 16384                                   to aColumnType[i].sPrecision
51316>>>>            Increment i
51317>>>>
51317>>>>            Move "year"                                  to aColumnType[i].sSQLType
51318>>>>            Move 13                                      to aColumnType[i].iSQLType
51319>>>>            Move False                                   to aColumnType[i].bCanEditSize
51320>>>>            Move True                                    to aColumnType[i].bNativeDataType
51321>>>>            Move 4                                       to aColumnType[i].iDefaultSize
51322>>>>            Move -1                                      to aColumnType[i].iMinSize
51323>>>>            Move -1                                      to aColumnType[i].nMaxSize
51324>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51325>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51326>>>>            Move -1                                      to aColumnType[i].sPrecision
51327>>>>            Increment i
51328>>>>
51328>>>>
51328>>>        
51328>>>//        Move eMySQL_LONGLONG    to ColumnType[i].iSQLType
51328>>>//        Move "bigint"           to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "14.0"             to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_BIT         to ColumnType[i].iSQLType
51328>>>//        Move "bit"              to ColumnType[i].sSQLType
51328>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51328>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51328>>>//        Move "4.0"              to ColumnType[i].sPrecision // In SQL allows "1, 0, or NULL"
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_BLOB        to ColumnType[i].iSQLType
51328>>>//        Move "blob"             to ColumnType[i].sSQLType
51328>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51328>>>//        Move "BINARY"           to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_STRING      to ColumnType[i].iSQLType
51328>>>//        Move "char"             to ColumnType[i].sSQLType
51328>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51328>>>//        Move "TEXT"             to ColumnType[i].sDataFlexType
51328>>>//        Move "254"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_DATE        to ColumnType[i].iSQLType
51328>>>//        Move "date"             to ColumnType[i].sSQLType
51328>>>//        Move DF_DATE            to ColumnType[i].iDataFlexType
51328>>>//        Move "Date"             to ColumnType[i].sDataFlexType
51328>>>//        Move "6.0"              to ColumnType[i].sPrecision
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_DATETIME    to ColumnType[i].iSQLType
51328>>>//        Move "datetime"         to ColumnType[i].sSQLType
51328>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
51328>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51328>>>//        Move "23.0"             to ColumnType[i].sPrecision
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_DECIMAL     to ColumnType[i].iSQLType
51328>>>//        Move "decimal"          to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "14.8"             to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_DOUBLE      to ColumnType[i].iSQLType
51328>>>//        Move "double"           to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "14.8"             to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_ENUM        to ColumnType[i].iSQLType
51328>>>//        Move "enum"             to ColumnType[i].sSQLType
51328>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51328>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51328>>>//        Move "254"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_FLOAT       to ColumnType[i].iSQLType
51328>>>//        Move "float"            to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "14.8"             to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_INT24       to ColumnType[i].iSQLType
51328>>>//        Move "int"              to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "NUMERIC"          to ColumnType[i].sDataFlexType
51328>>>//        Move "11.0"             to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_LONG_BLOB   to ColumnType[i].iSQLType
51328>>>//        Move "longblob"         to ColumnType[i].sSQLType
51328>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51328>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_LONG_TEXT   to ColumnType[i].iSQLType
51328>>>//        Move "longtext"         to ColumnType[i].sSQLType
51328>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51328>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_MEDIUM_BLOB to ColumnType[i].iSQLType
51328>>>//        Move "mediumblob"       to ColumnType[i].sSQLType
51328>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51328>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_INT24       to ColumnType[i].iSQLType
51328>>>//        Move "mediumint"        to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "9.0"              to ColumnType[i].sPrecision
51328>>>//
51328>>>//        Move eMySQL_MEDIUM_TEXT to ColumnType[i].iSQLType
51328>>>//        Move "mediumtext"       to ColumnType[i].sSQLType
51328>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51328>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_SET         to ColumnType[i].iSQLType
51328>>>//        Move "set"              to ColumnType[i].sSQLType
51328>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51328>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51328>>>//        Move "254"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_SHORT       to ColumnType[i].iSQLType
51328>>>//        Move "smallint"         to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "6.0"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TEXT        to ColumnType[i].iSQLType
51328>>>//        Move "text"             to ColumnType[i].sSQLType
51328>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51328>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TIME        to ColumnType[i].iSQLType
51328>>>//        Move "time"             to ColumnType[i].sSQLType
51328>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51328>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51328>>>//        Move "10.0"             to ColumnType[i].sPrecision
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TIMESTAMP   to ColumnType[i].iSQLType
51328>>>//        Move "timestamp"        to ColumnType[i].sSQLType
51328>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
51328>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51328>>>//        Move "23.0"             to ColumnType[i].sPrecision
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TINY_BLOB   to ColumnType[i].iSQLType
51328>>>//        Move "tinyblob"         to ColumnType[i].sSQLType
51328>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51328>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51328>>>//        Move "254"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TINY        to ColumnType[i].iSQLType
51328>>>//        Move "tinyint"          to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51328>>>//        Move "4.0"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_TINY_TEXT   to ColumnType[i].iSQLType
51328>>>//        Move "tinytext"         to ColumnType[i].sSQLType
51328>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51328>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51328>>>//        Move "254"              to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_VAR_STRING  to ColumnType[i].iSQLType
51328>>>//        Move "varchar"          to ColumnType[i].sSQLType
51328>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51328>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51328>>>//        Move "16384"            to ColumnType[i].sPrecision
51328>>>//        Increment i
51328>>>//
51328>>>//        Move eMySQL_YEAR        to ColumnType[i].iSQLType
51328>>>//        Move "year"             to ColumnType[i].sSQLType
51328>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51328>>>//        Move "NUMERIC"          to ColumnType[i].sDataFlexType
51328>>>//        Move "4.0"              to ColumnType[i].sPrecision
51328>>>//        Move True               to ColumnType[i].bCanEditSize
51328>>>//        Increment i
51328>>>
51328>>>        Function_Return aColumnType
51329>>>    End_Function
51330>>>
51330>>>    // Oracle Data Types
51330>>>    Function _UtilEnumerateOracleTypes Returns tColumnType[]
51332>>>        tColumnType[] aColumnType
51332>>>        tColumnType[] aColumnType
51333>>>        Integer i
51333>>>        
Including file: ora_drv_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\ora_drv_DriverDef.inc)
51333>>>>// Generated By The Database Update Framework
51333>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\Bin\ora_drv_DriverDef.xml
51333>>>>// Driver COLUMN DATA TYPES
51333>>>>//
51333>>>>// Created: 2018-03-14 23:47:34.82
51333>>>>
51333>>>>            Move "blob"                                  to aColumnType[i].sSQLType
51334>>>>            Move 113                                     to aColumnType[i].iSQLType
51335>>>>            Move True                                    to aColumnType[i].bCanEditSize
51336>>>>            Move True                                    to aColumnType[i].bNativeDataType
51337>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51338>>>>            Move 1                                       to aColumnType[i].iMinSize
51339>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51340>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51341>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51342>>>>            Move 16384                                   to aColumnType[i].sPrecision
51343>>>>            Increment i
51344>>>>
51344>>>>            Move "char"                                  to aColumnType[i].sSQLType
51345>>>>            Move 96                                      to aColumnType[i].iSQLType
51346>>>>            Move True                                    to aColumnType[i].bCanEditSize
51347>>>>            Move True                                    to aColumnType[i].bNativeDataType
51348>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51349>>>>            Move 1                                       to aColumnType[i].iMinSize
51350>>>>            Move 2000                                    to aColumnType[i].nMaxSize
51351>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51352>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51353>>>>            Move 2000                                    to aColumnType[i].sPrecision
51354>>>>            Increment i
51355>>>>
51355>>>>            Move "clob"                                  to aColumnType[i].sSQLType
51356>>>>            Move 112                                     to aColumnType[i].iSQLType
51357>>>>            Move True                                    to aColumnType[i].bCanEditSize
51358>>>>            Move True                                    to aColumnType[i].bNativeDataType
51359>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51360>>>>            Move 1                                       to aColumnType[i].iMinSize
51361>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51362>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
51363>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
51364>>>>            Move 16384                                   to aColumnType[i].sPrecision
51365>>>>            Increment i
51366>>>>
51366>>>>            Move "date"                                  to aColumnType[i].sSQLType
51367>>>>            Move 12                                      to aColumnType[i].iSQLType
51368>>>>            Move True                                    to aColumnType[i].bCanEditSize
51369>>>>            Move True                                    to aColumnType[i].bNativeDataType
51370>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51371>>>>            Move 6                                       to aColumnType[i].iMinSize
51372>>>>            Move 23                                      to aColumnType[i].nMaxSize
51373>>>>            Move "DF_DATE"                               to aColumnType[i].sDataFlexType
51374>>>>            Move DF_DATE                                 to aColumnType[i].iDataFlexType
51375>>>>            Move 6                                       to aColumnType[i].sPrecision
51376>>>>            Increment i
51377>>>>
51377>>>>            Move "float"                                 to aColumnType[i].sSQLType
51378>>>>            Move 4                                       to aColumnType[i].iSQLType
51379>>>>            Move True                                    to aColumnType[i].bCanEditSize
51380>>>>            Move True                                    to aColumnType[i].bNativeDataType
51381>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51382>>>>            Move 1                                       to aColumnType[i].iMinSize
51383>>>>            Move 14                                      to aColumnType[i].nMaxSize
51384>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51385>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51386>>>>            Move 14                                      to aColumnType[i].sPrecision
51387>>>>            Increment i
51388>>>>
51388>>>>            Move "int"                                   to aColumnType[i].sSQLType
51389>>>>            Move 3                                       to aColumnType[i].iSQLType
51390>>>>            Move True                                    to aColumnType[i].bCanEditSize
51391>>>>            Move True                                    to aColumnType[i].bNativeDataType
51392>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51393>>>>            Move 1                                       to aColumnType[i].iMinSize
51394>>>>            Move 14                                      to aColumnType[i].nMaxSize
51395>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51396>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51397>>>>            Move 14                                      to aColumnType[i].sPrecision
51398>>>>            Increment i
51399>>>>
51399>>>>            Move "intervalds"                            to aColumnType[i].sSQLType
51400>>>>            Move 190                                     to aColumnType[i].iSQLType
51401>>>>            Move False                                   to aColumnType[i].bCanEditSize
51402>>>>            Move True                                    to aColumnType[i].bNativeDataType
51403>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51404>>>>            Move -1                                      to aColumnType[i].iMinSize
51405>>>>            Move -1                                      to aColumnType[i].nMaxSize
51406>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51407>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51408>>>>            Move -1                                      to aColumnType[i].sPrecision
51409>>>>            Increment i
51410>>>>
51410>>>>            Move "intervalym"                            to aColumnType[i].sSQLType
51411>>>>            Move 189                                     to aColumnType[i].iSQLType
51412>>>>            Move False                                   to aColumnType[i].bCanEditSize
51413>>>>            Move True                                    to aColumnType[i].bNativeDataType
51414>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51415>>>>            Move -1                                      to aColumnType[i].iMinSize
51416>>>>            Move -1                                      to aColumnType[i].nMaxSize
51417>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51418>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51419>>>>            Move -1                                      to aColumnType[i].sPrecision
51420>>>>            Increment i
51421>>>>
51421>>>>            Move "long"                                  to aColumnType[i].sSQLType
51422>>>>            Move 8                                       to aColumnType[i].iSQLType
51423>>>>            Move True                                    to aColumnType[i].bCanEditSize
51424>>>>            Move True                                    to aColumnType[i].bNativeDataType
51425>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51426>>>>            Move 1                                       to aColumnType[i].iMinSize
51427>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51428>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51429>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51430>>>>            Move 16384                                   to aColumnType[i].sPrecision
51431>>>>            Increment i
51432>>>>
51432>>>>            Move "longraw"                               to aColumnType[i].sSQLType
51433>>>>            Move 24                                      to aColumnType[i].iSQLType
51434>>>>            Move True                                    to aColumnType[i].bCanEditSize
51435>>>>            Move True                                    to aColumnType[i].bNativeDataType
51436>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51437>>>>            Move 1                                       to aColumnType[i].iMinSize
51438>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51439>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51440>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51441>>>>            Move 16384                                   to aColumnType[i].sPrecision
51442>>>>            Increment i
51443>>>>
51443>>>>            Move "nchar"                                 to aColumnType[i].sSQLType
51444>>>>            Move 286                                     to aColumnType[i].iSQLType
51445>>>>            Move True                                    to aColumnType[i].bCanEditSize
51446>>>>            Move True                                    to aColumnType[i].bNativeDataType
51447>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51448>>>>            Move 1                                       to aColumnType[i].iMinSize
51449>>>>            Move 2000                                    to aColumnType[i].nMaxSize
51450>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51451>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51452>>>>            Move 2000                                    to aColumnType[i].sPrecision
51453>>>>            Increment i
51454>>>>
51454>>>>            Move "nclob"                                 to aColumnType[i].sSQLType
51455>>>>            Move 288                                     to aColumnType[i].iSQLType
51456>>>>            Move True                                    to aColumnType[i].bCanEditSize
51457>>>>            Move True                                    to aColumnType[i].bNativeDataType
51458>>>>            Move 16384                                   to aColumnType[i].iDefaultSize
51459>>>>            Move 1                                       to aColumnType[i].iMinSize
51460>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51461>>>>            Move "DF_TEXT"                               to aColumnType[i].sDataFlexType
51462>>>>            Move DF_TEXT                                 to aColumnType[i].iDataFlexType
51463>>>>            Move 16384                                   to aColumnType[i].sPrecision
51464>>>>            Increment i
51465>>>>
51465>>>>            Move "number"                                to aColumnType[i].sSQLType
51466>>>>            Move 2                                       to aColumnType[i].iSQLType
51467>>>>            Move True                                    to aColumnType[i].bCanEditSize
51468>>>>            Move True                                    to aColumnType[i].bNativeDataType
51469>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51470>>>>            Move 1                                       to aColumnType[i].iMinSize
51471>>>>            Move 14                                      to aColumnType[i].nMaxSize
51472>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51473>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51474>>>>            Move 14                                      to aColumnType[i].sPrecision
51475>>>>            Increment i
51476>>>>
51476>>>>            Move "nvarchar2"                             to aColumnType[i].sSQLType
51477>>>>            Move 287                                     to aColumnType[i].iSQLType
51478>>>>            Move True                                    to aColumnType[i].bCanEditSize
51479>>>>            Move True                                    to aColumnType[i].bNativeDataType
51480>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51481>>>>            Move 1                                       to aColumnType[i].iMinSize
51482>>>>            Move 4000                                    to aColumnType[i].nMaxSize
51483>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51484>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51485>>>>            Move 4000                                    to aColumnType[i].sPrecision
51486>>>>            Increment i
51487>>>>
51487>>>>            Move "raw"                                   to aColumnType[i].sSQLType
51488>>>>            Move 23                                      to aColumnType[i].iSQLType
51489>>>>            Move True                                    to aColumnType[i].bCanEditSize
51490>>>>            Move True                                    to aColumnType[i].bNativeDataType
51491>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51492>>>>            Move 1                                       to aColumnType[i].iMinSize
51493>>>>            Move 2000                                    to aColumnType[i].nMaxSize
51494>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51495>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51496>>>>            Move 2000                                    to aColumnType[i].sPrecision
51497>>>>            Increment i
51498>>>>
51498>>>>            Move "timestamp"                             to aColumnType[i].sSQLType
51499>>>>            Move 187                                     to aColumnType[i].iSQLType
51500>>>>            Move False                                   to aColumnType[i].bCanEditSize
51501>>>>            Move True                                    to aColumnType[i].bNativeDataType
51502>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51503>>>>            Move -1                                      to aColumnType[i].iMinSize
51504>>>>            Move -1                                      to aColumnType[i].nMaxSize
51505>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51506>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51507>>>>            Move -1                                      to aColumnType[i].sPrecision
51508>>>>            Increment i
51509>>>>
51509>>>>            Move "timestampltz"                          to aColumnType[i].sSQLType
51510>>>>            Move 232                                     to aColumnType[i].iSQLType
51511>>>>            Move False                                   to aColumnType[i].bCanEditSize
51512>>>>            Move True                                    to aColumnType[i].bNativeDataType
51513>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51514>>>>            Move -1                                      to aColumnType[i].iMinSize
51515>>>>            Move -1                                      to aColumnType[i].nMaxSize
51516>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51517>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51518>>>>            Move -1                                      to aColumnType[i].sPrecision
51519>>>>            Increment i
51520>>>>
51520>>>>            Move "timestamptz"                           to aColumnType[i].sSQLType
51521>>>>            Move 188                                     to aColumnType[i].iSQLType
51522>>>>            Move False                                   to aColumnType[i].bCanEditSize
51523>>>>            Move True                                    to aColumnType[i].bNativeDataType
51524>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51525>>>>            Move -1                                      to aColumnType[i].iMinSize
51526>>>>            Move -1                                      to aColumnType[i].nMaxSize
51527>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51528>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51529>>>>            Move -1                                      to aColumnType[i].sPrecision
51530>>>>            Increment i
51531>>>>
51531>>>>            Move "varchar2"                              to aColumnType[i].sSQLType
51532>>>>            Move 1                                       to aColumnType[i].iSQLType
51533>>>>            Move True                                    to aColumnType[i].bCanEditSize
51534>>>>            Move True                                    to aColumnType[i].bNativeDataType
51535>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51536>>>>            Move 1                                       to aColumnType[i].iMinSize
51537>>>>            Move 4000                                    to aColumnType[i].nMaxSize
51538>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51539>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51540>>>>            Move 4000                                    to aColumnType[i].sPrecision
51541>>>>            Increment i
51542>>>>
51542>>>>
51542>>>        
51542>>>//        Move eOracle_BLOB       to ColumnType[i].iSQLType
51542>>>//        Move "BLOB"             to ColumnType[i].sSQLType
51542>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51542>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_CHAR       to ColumnType[i].iSQLType
51542>>>//        Move "CHAR"             to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "2000"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_CLOB       to ColumnType[i].iSQLType
51542>>>//        Move "CLOB"             to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_DATE       to ColumnType[i].iSQLType
51542>>>//        Move "DATE"             to ColumnType[i].sSQLType
51542>>>//        Move DF_Date            to ColumnType[i].iDataFlexType
51542>>>//        Move "Date"             to ColumnType[i].sDataFlexType
51542>>>//        Move "6.0"              to ColumnType[i].sPrecision
51542>>>//        Move True               to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_FLOAT      to ColumnType[i].iSQLType
51542>>>//        Move "FLOAT"            to ColumnType[i].sSQLType
51542>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51542>>>//        Move "Number"           to ColumnType[i].sDataFlexType
51542>>>//        Move "14.8"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_INT        to ColumnType[i].iSQLType
51542>>>//        Move "INT"              to ColumnType[i].sSQLType
51542>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51542>>>//        Move "Number"           to ColumnType[i].sDataFlexType
51542>>>//        Move "14.0"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_INTERVALDS to ColumnType[i].iSQLType
51542>>>//        Move "INTERVALDAYTOSEC" to ColumnType[i].sSQLType
51542>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
51542>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51542>>>//        Move "23.0"             to ColumnType[i].sPrecision
51542>>>//        Move True               to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_INTERVALYM  to ColumnType[i].iSQLType
51542>>>//        Move "INTERVALYEARTOMON" to ColumnType[i].sSQLType
51542>>>//        Move DF_DATETIME         to ColumnType[i].iDataFlexType
51542>>>//        Move "DateTime"          to ColumnType[i].sDataFlexType
51542>>>//        Move "23.0"              to ColumnType[i].sPrecision
51542>>>//        Move True                to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_RAW        to ColumnType[i].iSQLType
51542>>>//        Move "LONG"             to ColumnType[i].sSQLType
51542>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51542>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_LONGRAW    to ColumnType[i].iSQLType
51542>>>//        Move "LONG RAW"         to ColumnType[i].sSQLType
51542>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51542>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_NCHAR      to ColumnType[i].iSQLType
51542>>>//        Move "NCHAR"            to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "2000"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_NCLOB      to ColumnType[i].iSQLType
51542>>>//        Move "NCLOB"            to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_NUMBER     to ColumnType[i].iSQLType
51542>>>//        Move "NUMBER"           to ColumnType[i].sSQLType
51542>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51542>>>//        Move "Number"           to ColumnType[i].sDataFlexType
51542>>>//        Move "14.8"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_NVARCHAR2  to ColumnType[i].iSQLType
51542>>>//        Move "NVARCHAR2"        to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "4000"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_RAW        to ColumnType[i].iSQLType
51542>>>//        Move "RAW"              to ColumnType[i].sSQLType
51542>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51542>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51542>>>//        Move "2000"             to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_ROWID      to ColumnType[i].iSQLType
51542>>>//        Move "ROWID"            to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_TIMESTAMP  to ColumnType[i].iSQLType
51542>>>//        Move "TimeStamp"        to ColumnType[i].sSQLType
51542>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
51542>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51542>>>//        Move "11.0"             to ColumnType[i].sPrecision
51542>>>//        Move True               to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_TIMESTAMPLTZ   to ColumnType[i].iSQLType
51542>>>//        Move "TIMESTAMPLOCALTZ"     to ColumnType[i].sSQLType
51542>>>//        Move DF_DATETIME            to ColumnType[i].iDataFlexType
51542>>>//        Move "DateTime"             to ColumnType[i].sDataFlexType
51542>>>//        Move "13.0"                 to ColumnType[i].sPrecision
51542>>>//        Move True                   to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_TIMESTAMPTZ    to ColumnType[i].iSQLType
51542>>>//        Move "TIMEZONETIMEZONE"     to ColumnType[i].sSQLType
51542>>>//        Move DF_DATETIME            to ColumnType[i].iDataFlexType
51542>>>//        Move "DateTime"             to ColumnType[i].sDataFlexType
51542>>>//        Move "11.0"                 to ColumnType[i].sPrecision
51542>>>//        Move True                   to ColumnType[i].bCanEditSize
51542>>>//        Increment i
51542>>>//
51542>>>//        Move eOracle_VARCHAR2   to ColumnType[i].iSQLType
51542>>>//        Move "VARCHAR"          to ColumnType[i].sSQLType
51542>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51542>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51542>>>//        Move "16384"            to ColumnType[i].sPrecision
51542>>>
51542>>>        Function_Return aColumnType
51543>>>    End_Function
51544>>>
51544>>>    // PostgreSQL Data Types
51544>>>    Function _UtilEnumeratePostgreSQLTypes Returns tColumnType[]
51546>>>        tColumnType[] aColumnType
51546>>>        tColumnType[] aColumnType
51547>>>        Integer i
51547>>>        
Including file: mdspgsql_DriverDef.inc    (C:\Projects\DF18\DbUpdateFramework\AppSrc\mdspgsql_DriverDef.inc)
51547>>>>// Generated By The Database Update Framework
51547>>>>// Driver XML File: C:\Program Files (x86)\DataFlex 19.0\Bin\mdspgsql_DriverDef.xml
51547>>>>// Driver COLUMN DATA TYPES
51547>>>>//
51547>>>>// Created: 2018-03-14 23:47:02.984
51547>>>>
51547>>>>            Move "bigint"                                to aColumnType[i].sSQLType
51548>>>>            Move 20                                      to aColumnType[i].iSQLType
51549>>>>            Move True                                    to aColumnType[i].bCanEditSize
51550>>>>            Move True                                    to aColumnType[i].bNativeDataType
51551>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51552>>>>            Move 1                                       to aColumnType[i].iMinSize
51553>>>>            Move 14                                      to aColumnType[i].nMaxSize
51554>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51555>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51556>>>>            Move 14                                      to aColumnType[i].sPrecision
51557>>>>            Increment i
51558>>>>
51558>>>>            Move "bit"                                   to aColumnType[i].sSQLType
51559>>>>            Move 1560                                    to aColumnType[i].iSQLType
51560>>>>            Move True                                    to aColumnType[i].bCanEditSize
51561>>>>            Move True                                    to aColumnType[i].bNativeDataType
51562>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51563>>>>            Move 1                                       to aColumnType[i].iMinSize
51564>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51565>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51566>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51567>>>>            Move 16384                                   to aColumnType[i].sPrecision
51568>>>>            Increment i
51569>>>>
51569>>>>            Move "boolean"                               to aColumnType[i].sSQLType
51570>>>>            Move 16                                      to aColumnType[i].iSQLType
51571>>>>            Move False                                   to aColumnType[i].bCanEditSize
51572>>>>            Move True                                    to aColumnType[i].bNativeDataType
51573>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51574>>>>            Move -1                                      to aColumnType[i].iMinSize
51575>>>>            Move -1                                      to aColumnType[i].nMaxSize
51576>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51577>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51578>>>>            Move -1                                      to aColumnType[i].sPrecision
51579>>>>            Increment i
51580>>>>
51580>>>>            Move "bytea"                                 to aColumnType[i].sSQLType
51581>>>>            Move 17                                      to aColumnType[i].iSQLType
51582>>>>            Move True                                    to aColumnType[i].bCanEditSize
51583>>>>            Move True                                    to aColumnType[i].bNativeDataType
51584>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51585>>>>            Move 1                                       to aColumnType[i].iMinSize
51586>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51587>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51588>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51589>>>>            Move 16384                                   to aColumnType[i].sPrecision
51590>>>>            Increment i
51591>>>>
51591>>>>            Move "char"                                  to aColumnType[i].sSQLType
51592>>>>            Move 18                                      to aColumnType[i].iSQLType
51593>>>>            Move True                                    to aColumnType[i].bCanEditSize
51594>>>>            Move True                                    to aColumnType[i].bNativeDataType
51595>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51596>>>>            Move 1                                       to aColumnType[i].iMinSize
51597>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51598>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51599>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51600>>>>            Move 16384                                   to aColumnType[i].sPrecision
51601>>>>            Increment i
51602>>>>
51602>>>>            Move "citext"                                to aColumnType[i].sSQLType
51603>>>>            Move -25                                     to aColumnType[i].iSQLType
51604>>>>            Move True                                    to aColumnType[i].bCanEditSize
51605>>>>            Move True                                    to aColumnType[i].bNativeDataType
51606>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51607>>>>            Move 1                                       to aColumnType[i].iMinSize
51608>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51609>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51610>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51611>>>>            Move 16384                                   to aColumnType[i].sPrecision
51612>>>>            Increment i
51613>>>>
51613>>>>            Move "date"                                  to aColumnType[i].sSQLType
51614>>>>            Move 1082                                    to aColumnType[i].iSQLType
51615>>>>            Move False                                   to aColumnType[i].bCanEditSize
51616>>>>            Move True                                    to aColumnType[i].bNativeDataType
51617>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51618>>>>            Move -1                                      to aColumnType[i].iMinSize
51619>>>>            Move -1                                      to aColumnType[i].nMaxSize
51620>>>>            Move "DF_DATE"                               to aColumnType[i].sDataFlexType
51621>>>>            Move DF_DATE                                 to aColumnType[i].iDataFlexType
51622>>>>            Move 6                                       to aColumnType[i].sPrecision
51623>>>>            Increment i
51624>>>>
51624>>>>            Move "double"                                to aColumnType[i].sSQLType
51625>>>>            Move 701                                     to aColumnType[i].iSQLType
51626>>>>            Move True                                    to aColumnType[i].bCanEditSize
51627>>>>            Move True                                    to aColumnType[i].bNativeDataType
51628>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51629>>>>            Move 1                                       to aColumnType[i].iMinSize
51630>>>>            Move 14                                      to aColumnType[i].nMaxSize
51631>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51632>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51633>>>>            Move 14                                      to aColumnType[i].sPrecision
51634>>>>            Increment i
51635>>>>
51635>>>>            Move "integer"                               to aColumnType[i].sSQLType
51636>>>>            Move 23                                      to aColumnType[i].iSQLType
51637>>>>            Move True                                    to aColumnType[i].bCanEditSize
51638>>>>            Move True                                    to aColumnType[i].bNativeDataType
51639>>>>            Move 11                                      to aColumnType[i].iDefaultSize
51640>>>>            Move 1                                       to aColumnType[i].iMinSize
51641>>>>            Move 11                                      to aColumnType[i].nMaxSize
51642>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51643>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51644>>>>            Move 11                                      to aColumnType[i].sPrecision
51645>>>>            Increment i
51646>>>>
51646>>>>            Move "money"                                 to aColumnType[i].sSQLType
51647>>>>            Move 790                                     to aColumnType[i].iSQLType
51648>>>>            Move True                                    to aColumnType[i].bCanEditSize
51649>>>>            Move True                                    to aColumnType[i].bNativeDataType
51650>>>>            Move 30                                      to aColumnType[i].iDefaultSize
51651>>>>            Move 1                                       to aColumnType[i].iMinSize
51652>>>>            Move 30                                      to aColumnType[i].nMaxSize
51653>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51654>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51655>>>>            Move 30                                      to aColumnType[i].sPrecision
51656>>>>            Increment i
51657>>>>
51657>>>>            Move "numeric"                               to aColumnType[i].sSQLType
51658>>>>            Move 1700                                    to aColumnType[i].iSQLType
51659>>>>            Move True                                    to aColumnType[i].bCanEditSize
51660>>>>            Move True                                    to aColumnType[i].bNativeDataType
51661>>>>            Move 14                                      to aColumnType[i].iDefaultSize
51662>>>>            Move 1                                       to aColumnType[i].iMinSize
51663>>>>            Move 14                                      to aColumnType[i].nMaxSize
51664>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51665>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51666>>>>            Move 14                                      to aColumnType[i].sPrecision
51667>>>>            Increment i
51668>>>>
51668>>>>            Move "oid"                                   to aColumnType[i].sSQLType
51669>>>>            Move 26                                      to aColumnType[i].iSQLType
51670>>>>            Move False                                   to aColumnType[i].bCanEditSize
51671>>>>            Move True                                    to aColumnType[i].bNativeDataType
51672>>>>            Move 20                                      to aColumnType[i].iDefaultSize
51673>>>>            Move -1                                      to aColumnType[i].iMinSize
51674>>>>            Move -1                                      to aColumnType[i].nMaxSize
51675>>>>            Move "DF_BINARY"                             to aColumnType[i].sDataFlexType
51676>>>>            Move DF_BINARY                               to aColumnType[i].iDataFlexType
51677>>>>            Move -1                                      to aColumnType[i].sPrecision
51678>>>>            Increment i
51679>>>>
51679>>>>            Move "real"                                  to aColumnType[i].sSQLType
51680>>>>            Move 700                                     to aColumnType[i].iSQLType
51681>>>>            Move True                                    to aColumnType[i].bCanEditSize
51682>>>>            Move True                                    to aColumnType[i].bNativeDataType
51683>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51684>>>>            Move 1                                       to aColumnType[i].iMinSize
51685>>>>            Move 6                                       to aColumnType[i].nMaxSize
51686>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51687>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51688>>>>            Move 6                                       to aColumnType[i].sPrecision
51689>>>>            Increment i
51690>>>>
51690>>>>            Move "regproc"                               to aColumnType[i].sSQLType
51691>>>>            Move 24                                      to aColumnType[i].iSQLType
51692>>>>            Move False                                   to aColumnType[i].bCanEditSize
51693>>>>            Move True                                    to aColumnType[i].bNativeDataType
51694>>>>            Move 64                                      to aColumnType[i].iDefaultSize
51695>>>>            Move -1                                      to aColumnType[i].iMinSize
51696>>>>            Move -1                                      to aColumnType[i].nMaxSize
51697>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51698>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51699>>>>            Move -1                                      to aColumnType[i].sPrecision
51700>>>>            Increment i
51701>>>>
51701>>>>            Move "smallint"                              to aColumnType[i].sSQLType
51702>>>>            Move 21                                      to aColumnType[i].iSQLType
51703>>>>            Move True                                    to aColumnType[i].bCanEditSize
51704>>>>            Move True                                    to aColumnType[i].bNativeDataType
51705>>>>            Move 6                                       to aColumnType[i].iDefaultSize
51706>>>>            Move 1                                       to aColumnType[i].iMinSize
51707>>>>            Move 6                                       to aColumnType[i].nMaxSize
51708>>>>            Move "DF_BCD"                                to aColumnType[i].sDataFlexType
51709>>>>            Move DF_BCD                                  to aColumnType[i].iDataFlexType
51710>>>>            Move 6                                       to aColumnType[i].sPrecision
51711>>>>            Increment i
51712>>>>
51712>>>>            Move "text"                                  to aColumnType[i].sSQLType
51713>>>>            Move 25                                      to aColumnType[i].iSQLType
51714>>>>            Move True                                    to aColumnType[i].bCanEditSize
51715>>>>            Move True                                    to aColumnType[i].bNativeDataType
51716>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51717>>>>            Move 1                                       to aColumnType[i].iMinSize
51718>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51719>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51720>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51721>>>>            Move 16384                                   to aColumnType[i].sPrecision
51722>>>>            Increment i
51723>>>>
51723>>>>            Move "time"                                  to aColumnType[i].sSQLType
51724>>>>            Move 1083                                    to aColumnType[i].iSQLType
51725>>>>            Move True                                    to aColumnType[i].bCanEditSize
51726>>>>            Move True                                    to aColumnType[i].bNativeDataType
51727>>>>            Move 8                                       to aColumnType[i].iDefaultSize
51728>>>>            Move 8                                       to aColumnType[i].iMinSize
51729>>>>            Move 15                                      to aColumnType[i].nMaxSize
51730>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51731>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51732>>>>            Move 15                                      to aColumnType[i].sPrecision
51733>>>>            Increment i
51734>>>>
51734>>>>            Move "timestamp"                             to aColumnType[i].sSQLType
51735>>>>            Move 1114                                    to aColumnType[i].iSQLType
51736>>>>            Move False                                   to aColumnType[i].bCanEditSize
51737>>>>            Move True                                    to aColumnType[i].bNativeDataType
51738>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51739>>>>            Move -1                                      to aColumnType[i].iMinSize
51740>>>>            Move -1                                      to aColumnType[i].nMaxSize
51741>>>>            Move "DF_DATETIME"                           to aColumnType[i].sDataFlexType
51742>>>>            Move DF_DATETIME                             to aColumnType[i].iDataFlexType
51743>>>>            Move -1                                      to aColumnType[i].sPrecision
51744>>>>            Increment i
51745>>>>
51745>>>>            Move "timestamptz"                           to aColumnType[i].sSQLType
51746>>>>            Move 1184                                    to aColumnType[i].iSQLType
51747>>>>            Move False                                   to aColumnType[i].bCanEditSize
51748>>>>            Move True                                    to aColumnType[i].bNativeDataType
51749>>>>            Move 23                                      to aColumnType[i].iDefaultSize
51750>>>>            Move -1                                      to aColumnType[i].iMinSize
51751>>>>            Move -1                                      to aColumnType[i].nMaxSize
51752>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51753>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51754>>>>            Move -1                                      to aColumnType[i].sPrecision
51755>>>>            Increment i
51756>>>>
51756>>>>            Move "uuid"                                  to aColumnType[i].sSQLType
51757>>>>            Move 2950                                    to aColumnType[i].iSQLType
51758>>>>            Move False                                   to aColumnType[i].bCanEditSize
51759>>>>            Move True                                    to aColumnType[i].bNativeDataType
51760>>>>            Move 40                                      to aColumnType[i].iDefaultSize
51761>>>>            Move -1                                      to aColumnType[i].iMinSize
51762>>>>            Move -1                                      to aColumnType[i].nMaxSize
51763>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51764>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51765>>>>            Move -1                                      to aColumnType[i].sPrecision
51766>>>>            Increment i
51767>>>>
51767>>>>            Move "varbit"                                to aColumnType[i].sSQLType
51768>>>>            Move 1562                                    to aColumnType[i].iSQLType
51769>>>>            Move True                                    to aColumnType[i].bCanEditSize
51770>>>>            Move True                                    to aColumnType[i].bNativeDataType
51771>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51772>>>>            Move 1                                       to aColumnType[i].iMinSize
51773>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51774>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51775>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51776>>>>            Move 16384                                   to aColumnType[i].sPrecision
51777>>>>            Increment i
51778>>>>
51778>>>>            Move "varchar"                               to aColumnType[i].sSQLType
51779>>>>            Move 1043                                    to aColumnType[i].iSQLType
51780>>>>            Move True                                    to aColumnType[i].bCanEditSize
51781>>>>            Move True                                    to aColumnType[i].bNativeDataType
51782>>>>            Move 1                                       to aColumnType[i].iDefaultSize
51783>>>>            Move 1                                       to aColumnType[i].iMinSize
51784>>>>            Move 16384                                   to aColumnType[i].nMaxSize
51785>>>>            Move "DF_ASCII"                              to aColumnType[i].sDataFlexType
51786>>>>            Move DF_ASCII                                to aColumnType[i].iDataFlexType
51787>>>>            Move 16384                                   to aColumnType[i].sPrecision
51788>>>>            Increment i
51789>>>>
51789>>>>
51789>>>        
51789>>>//        Move ePgSQL_INT8        to ColumnType[i].iSQLType
51789>>>//        Move "bigint"           to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51789>>>//        Move "14.0"             to ColumnType[i].sPrecision
51789>>>//        Move True               to ColumnType[i].bCanEditSize
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_BIT         to ColumnType[i].iSQLType
51789>>>//        Move "bit"              to ColumnType[i].sSQLType
51789>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51789>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51789>>>//        Move "16384"            to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_BOOL        to ColumnType[i].iSQLType
51789>>>//        Move "boolean"          to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "1"                to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_BYTEA       to ColumnType[i].iSQLType
51789>>>//        Move "bytea"            to ColumnType[i].sSQLType
51789>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51789>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51789>>>//        Move "16384"            to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_CHAR        to ColumnType[i].iSQLType
51789>>>//        Move "char"             to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "2000"             to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_CITEXT      to ColumnType[i].iSQLType
51789>>>//        Move "citext"           to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "254"              to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_DATE        to ColumnType[i].iSQLType
51789>>>//        Move "date"             to ColumnType[i].sSQLType
51789>>>//        Move DF_DATE            to ColumnType[i].iDataFlexType
51789>>>//        Move "Date"             to ColumnType[i].sDataFlexType
51789>>>//        Move "6.0"              to ColumnType[i].sPrecision
51789>>>//        Move True               to ColumnType[i].bCanEditSize
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_FLOAT4      to ColumnType[i].iSQLType
51789>>>//        Move "decimal"          to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Decimal"          to ColumnType[i].sDataFlexType
51789>>>//        Move "14.8"             to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_FLOAT8      to ColumnType[i].iSQLType
51789>>>//        Move "double"           to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "22"               to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_INT4        to ColumnType[i].iSQLType
51789>>>//        Move "integer"          to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51789>>>//        Move "8.0"              to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_MONEY       to ColumnType[i].iSQLType
51789>>>//        Move "money"            to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51789>>>//        Move "8.0"              to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_OID         to ColumnType[i].iSQLType
51789>>>//        Move "oid"              to ColumnType[i].sSQLType
51789>>>//        Move DF_BINARY          to ColumnType[i].iDataFlexType
51789>>>//        Move "Binary"           to ColumnType[i].sDataFlexType
51789>>>//        Move "16384"            to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_FLOAT4      to ColumnType[i].iSQLType
51789>>>//        Move "real"             to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Real"             to ColumnType[i].sDataFlexType
51789>>>//        Move "6.6"              to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_REGPROC     to ColumnType[i].iSQLType
51789>>>//        Move "regproc"          to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "64"               to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_INT2        to ColumnType[i].iSQLType
51789>>>//        Move "smallint"         to ColumnType[i].sSQLType
51789>>>//        Move DF_BCD             to ColumnType[i].iDataFlexType
51789>>>//        Move "Numeric"          to ColumnType[i].sDataFlexType
51789>>>//        Move "6.0"              to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_TEXT        to ColumnType[i].iSQLType
51789>>>//        Move "text"             to ColumnType[i].sSQLType
51789>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51789>>>//        Move "Text"             to ColumnType[i].sDataFlexType
51789>>>//        Move "16384"            to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_TIME        to ColumnType[i].iSQLType
51789>>>//        Move "time"             to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51789>>>//        Move "15.0"             to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_TIMESTAMP   to ColumnType[i].iSQLType
51789>>>//        Move "timestamp"        to ColumnType[i].sSQLType
51789>>>//        Move DF_DATETIME        to ColumnType[i].iDataFlexType
51789>>>//        Move "DateTime"         to ColumnType[i].sDataFlexType
51789>>>//        Move "23.0"             to ColumnType[i].sPrecision
51789>>>//        Move True               to ColumnType[i].bCanEditSize
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_UUID        to ColumnType[i].iSQLType
51789>>>//        Move "uuid"             to ColumnType[i].sSQLType
51789>>>//        Move DF_ASCII           to ColumnType[i].iDataFlexType
51789>>>//        Move "ASCII"            to ColumnType[i].sDataFlexType
51789>>>//        Move "40"               to ColumnType[i].sPrecision
51789>>>//        Move True               to ColumnType[i].bCanEditSize
51789>>>//        Increment i
51789>>>//
51789>>>//        Move ePgSQL_VARCHAR     to ColumnType[i].iSQLType
51789>>>//        Move "varchar"          to ColumnType[i].sSQLType
51789>>>//        Move DF_TEXT            to ColumnType[i].iDataFlexType
51789>>>//        Move "DF_TEXT"          to ColumnType[i].sDataFlexType
51789>>>//        Move "16384"            to ColumnType[i].sPrecision
51789>>>//        Increment i
51789>>>
51789>>>        Function_Return aColumnType
51790>>>    End_Function
51791>>>
51791>>>    // Internal usage. Use the UtilColumnTypeXXX functions instead.
51791>>>    Function _UtilColumnType String sDriverID Integer iDbType Integer iType String sType Boolean bIntegerInputType Returns tColumnType
51793>>>        Integer iValue iSize iCount iStart
51793>>>        tColumnType[] ColumnTypeArray
51793>>>        tColumnType[] ColumnTypeArray
51794>>>        tColumnType RetvalType
51794>>>        tColumnType RetvalType
51794>>>        String sValue
51794>>>        Boolean bFrameworkDataFlexType
51794>>>
51794>>>        Move "Undefined" to RetvalType.sSQLType
51795>>>        Move -1999       to RetvalType.iSQLType
51796>>>
51796>>>        Move 0 to iStart
51797>>>        Move (Uppercase(sType)) to sType
51798>>>        Move (iType <= -1490) to bFrameworkDataFlexType
51799>>>        If (bFrameworkDataFlexType = True) Begin
51801>>>            Get UtilDUFDataTypeToSqlTypeMapping sDriverID iDbType iType to RetvalType
51802>>>            Function_Return RetvalType
51803>>>        End
51803>>>>
51803>>>
51803>>>        Get UtilEnumerateColumnTypes sDriverID iDbType to ColumnTypeArray
51804>>>
51804>>>        Move (SizeOfArray(ColumnTypeArray)) to iSize
51805>>>        Decrement iSize
51806>>>
51806>>>        for iCount from iStart to iSize
51812>>>>
51812>>>            Move ColumnTypeArray[iCount].iSQLType to iValue
51813>>>            Move ColumnTypeArray[iCount].sSQLType to sValue
51814>>>            If (bIntegerInputType = True) Begin
51816>>>                If (iValue = iType) Begin
51818>>>                    Move ColumnTypeArray[iCount].sSQLType       to RetvalType.sSQLType
51819>>>                    Move iType                                  to RetvalType.iSQLType
51820>>>                    Move ColumnTypeArray[iCount].sDataFlexType  to RetvalType.sDataFlexType
51821>>>                    Move ColumnTypeArray[iCount].iDataFlexType  to RetvalType.iDataFlexType
51822>>>                    Move ColumnTypeArray[iCount].sPrecision     to RetvalType.sPrecision
51823>>>                    Move ColumnTypeArray[iCount].bCanEditSize   to RetvalType.bCanEditSize
51824>>>                    Move iSize to iCount // We're done!
51825>>>                End
51825>>>>
51825>>>            End
51825>>>>
51825>>>            Else Begin
51826>>>                Move (Uppercase(sValue)) to sValue
51827>>>                If (sValue = sType) Begin
51829>>>                    Move sType                                  to RetvalType.sSQLType
51830>>>                    Move ColumnTypeArray[iCount].iSQLType       to RetvalType.iSQLType
51831>>>                    Move ColumnTypeArray[iCount].sDataFlexType  to RetvalType.sDataFlexType
51832>>>                    Move ColumnTypeArray[iCount].iDataFlexType  to RetvalType.iDataFlexType
51833>>>                    Move ColumnTypeArray[iCount].sPrecision     to RetvalType.sPrecision
51834>>>                    Move ColumnTypeArray[iCount].bCanEditSize   to RetvalType.bCanEditSize
51835>>>                    Move iSize to iCount // We're done!
51836>>>                End
51836>>>>
51836>>>            End
51836>>>>
51836>>>        Loop
51837>>>>
51837>>>
51837>>>        // If no match was found it was probably because it was a DataFlex standard type that was passed.
51837>>>        // In which case we search for a match in DataFlex standard types:
51837>>>        If (RetvalType.sSQLType = "Undefined") Begin
51839>>>            Get _UtilEnumerateDataFlexTypes to ColumnTypeArray
51840>>>            Move (SizeOfArray(ColumnTypeArray)) to iSize
51841>>>            Decrement iSize
51842>>>
51842>>>            for iCount from iStart to iSize
51848>>>>
51848>>>                Move ColumnTypeArray[iCount].iSQLType to iValue
51849>>>                Move ColumnTypeArray[iCount].sSQLType to sValue
51850>>>                If (iValue = iType) Begin
51852>>>                    Move ColumnTypeArray[iCount].sSQLType       to RetvalType.sSQLType
51853>>>                    Move iType                                  to RetvalType.iSQLType
51854>>>                    Move ColumnTypeArray[iCount].sDataFlexType  to RetvalType.sDataFlexType
51855>>>                    Move ColumnTypeArray[iCount].iDataFlexType  to RetvalType.iDataFlexType
51856>>>                    Move ColumnTypeArray[iCount].sPrecision     to RetvalType.sPrecision
51857>>>                    Move ColumnTypeArray[iCount].bCanEditSize   to RetvalType.bCanEditSize
51858>>>                    Move iSize to iCount // We're done!
51859>>>                End
51859>>>>
51859>>>            Loop
51860>>>>
51860>>>        End
51860>>>>
51860>>>
51860>>>        Function_Return RetvalType
51861>>>    End_Function
51862>>>
51862>>>    Function _AllTablesToConvert Returns Integer[]
51864>>>        Integer[] aTableConvertExceptions iTablesArray
51866>>>        Handle hTable
51866>>>        Integer iIndex
51866>>>        String sTableName
51866>>>        Boolean bFlexErrs
51866>>>
51866>>>        // a) Get the exception table array the developer has specified
51866>>>        Get paTableConvertExceptions to aTableConvertExceptions
51867>>>
51867>>>        // b) Add CodeMast, CodeType & DbVersion to exceptions
51867>>>        Repeat
51867>>>>
51867>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
51870>>>            If (hTable <> 0) Begin
51872>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
51875>>>                Move (Uppercase(sTableName) = "FLEXERRS")  to bFlexErrs
51876>>>                If (bFlexErrs = False) Begin
51878>>>                    If (Uppercase(sTableName) = "CODEMAST" or Uppercase(sTableName) = "CODETYPE" or Uppercase(sTableName) = "DBVERSION") Begin
51880>>>                        Move (SearchArray(hTable, aTableConvertExceptions)) to iIndex
51881>>>                        If (iIndex = -1) Begin
51883>>>                            Move hTable to aTableConvertExceptions[SizeOfArray(aTableConvertExceptions)]
51884>>>                        End
51884>>>>
51884>>>                    End
51884>>>>
51884>>>                End
51884>>>>
51884>>>            End
51884>>>>
51884>>>        Until (hTable = 0)
51886>>>
51886>>>        Move 0 to hTable
51887>>>
51887>>>        // c) Spin through filelist.cfg and add all tables except those from the exception array, to the return array.
51887>>>        Repeat
51887>>>>
51887>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
51890>>>            If (hTable > 0) Begin
51892>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
51895>>>                Move (Uppercase(sTableName) = "FLEXERRS")  to bFlexErrs
51896>>>                If (bFlexErrs = False) Begin
51898>>>                    Move (SearchArray(hTable, aTableConvertExceptions)) to iIndex
51899>>>                    If (iIndex = -1) Begin
51901>>>                        Move hTable to iTablesArray[SizeOfArray(iTablesArray)]
51902>>>                    End
51902>>>>
51902>>>                End
51902>>>>
51902>>>            End
51902>>>>
51902>>>        Until (hTable = 0)
51904>>>
51904>>>        Function_Return iTablesArray
51905>>>    End_Function
51906>>>
51906>>>    Function _AllTablesDateCorrections Returns Integer[]
51908>>>        Integer[] aTableDateCorrectionExceptions iTablesArray
51910>>>        Handle hTable
51910>>>        Integer iIndex
51910>>>        String sTableName
51910>>>        Boolean bFlexErrs
51910>>>
51910>>>        Get paTableDateCorrectionExceptions to aTableDateCorrectionExceptions
51911>>>        Move 0 to hTable
51912>>>
51912>>>        // Spin through filelist.cfg and add all tables except those from the exception array, to the return array.
51912>>>        Repeat
51912>>>>
51912>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
51915>>>            If (hTable > 0) Begin
51917>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
51920>>>                Move (Uppercase(sTableName) = "FLEXERRS")  to bFlexErrs
51921>>>                If (bFlexErrs = False) Begin
51923>>>                    Move (SearchArray(hTable, aTableDateCorrectionExceptions)) to iIndex
51924>>>                    If (iIndex = -1) Begin
51926>>>                        Move hTable to iTablesArray[SizeOfArray(iTablesArray)]
51927>>>                    End
51927>>>>
51927>>>                End
51927>>>>
51927>>>            End
51927>>>>
51927>>>        Until (hTable = 0)
51929>>>
51929>>>        Function_Return iTablesArray
51930>>>    End_Function
51931>>>
51931>>>    Function _AppendAPIColumn tAPIColumn[] aCurrent String sFieldName Integer iType Integer iLength Integer iPrecision Integer iOptions Returns tAPIColumn[]
51933>>>        tAPIColumn NewAPIColumn
51933>>>        tAPIColumn NewAPIColumn
51933>>>
51933>>>        Move sFieldName to NewAPIColumn.sFieldName
51934>>>        Move iType      to NewAPIColumn.iType
51935>>>        Move iLength    to NewAPIColumn.iLength
51936>>>        Move iPrecision to NewAPIColumn.iPrecision
51937>>>        Move iOptions   to NewAPIColumn.iOptions
51938>>>
51938>>>        Move NewAPIColumn to aCurrent[SizeOfArray(aCurrent)]
51939>>>
51939>>>        Function_Return aCurrent
51940>>>    End_Function
51941>>>
51941>>>    Function _UtilIndexAppendSegmentFieldNames tAPIIndexSegment[] APIIndexSegment Returns String
51943>>>        String sRetval sFieldName
51943>>>        Integer iCount iSize
51943>>>
51943>>>        Move (SizeOfArray(APIIndexSegment)) to iSize
51944>>>        Decrement iSize
51945>>>        for iCount from 0 to iSize
51951>>>>
51951>>>            Move APIIndexSegment[iCount].sFieldName to sFieldName
51952>>>            Move (sRetval * (String(sFieldName))) to sRetval
51953>>>        Loop
51954>>>>
51954>>>        Move (Trim(sRetval)) to sRetval
51955>>>
51955>>>        Function_Return sRetval
51956>>>    End_Function
51957>>>
51957>>>    // *** Miscellaneous other functions ***
51957>>>    // Some of which can be used by both "Sqlxxx" and "Apixxx" functions.
51957>>>    //
51957>>>
51957>>>    // Callback functionality used when e.g. calling driver functions directly.
51957>>>    Function Callback String sCallback_Text Integer iCallback_Type Returns Integer
51959>>>        Integer iPerc
51959>>>        Number nReady nTotal
51959>>>
51959>>>        Send DoAdvance of ghoProgressBar
51960>>>
51960>>>        If (sCallback_Text contains "Copy records") Begin
51962>>>            Move CS_SQLCopyingData to sCallback_Text
51963>>>        End
51963>>>>
51963>>>        If (sCallback_Text contains "Dropping index" or sCallback_Text contains "Temporary delete of all indices of table") Begin
51965>>>            Move (Replace("Dropping index", sCallback_Text, CS_SQLDeletingIndex)) to sCallback_Text
51966>>>            Move (Replace("Temporary delete of all indices of table", sCallback_Text, CS_SQLDeletingIndex)) to sCallback_Text
51967>>>        End
51967>>>>
51967>>>        If (sCallback_Text contains "Creating index") Begin
51969>>>            Move (Replace("Creating index", sCallback_Text, CS_SQLCreatingIndex)) to sCallback_Text
51970>>>        End
51970>>>>
51970>>>
51970>>>        Case Begin
51970>>>            Case (iCallback_Type = DF_Message_Text)
51972>>>//                Set Message_Text of ghoStatusPanel to sCallback_Text
51972>>>                Set Action_Text  of ghoStatusPanel to ""
51973>>>                Case Break
51974>>>            Case (iCallback_Type = DF_Message_Heading_1)
51977>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
51978>>>                Set Action_Text  of ghoStatusPanel to ""
51979>>>                Case Break
51980>>>            Case (iCallback_Type = DF_Message_Heading_2)
51983>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
51984>>>                Set Action_Text  of ghoStatusPanel to ""
51985>>>                Case Break
51986>>>            Case (iCallback_Type = DF_Message_Heading_3)
51989>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
51990>>>                Set Action_Text  of ghoStatusPanel to ""
51991>>>                Case Break
51992>>>            Case (iCallback_Type = DF_Message_Heading_4)
51995>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
51996>>>                Set Action_Text  of ghoStatusPanel to ""
51997>>>                Case Break
51998>>>            Case (iCallback_Type = DF_Message_Heading_5)
52001>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
52002>>>                Set Action_Text  of ghoStatusPanel to ""
52003>>>                Case Break
52004>>>            Case (iCallback_Type = DF_Message_Warning)
52007>>>                Send None
52008>>>                Case Break
52009>>>            Case (iCallback_Type = DF_Message_Progress_Title)
52012>>>                Set Message_Text of ghoStatusPanel to sCallback_Text
52013>>>                Set Action_Text  of ghoStatusPanel to ""
52014>>>                Case Break
52015>>>            Case (iCallback_Type = DF_Message_Progress_Value)
52018>>>                //*** Interpret numbers
52018>>>                Move (Left(sCallback_Text, (Pos(",", sCallback_Text) - 1)))                       to nReady
52019>>>                Move (Right(sCallback_Text, (Length(sCallback_Text) - Pos(",", sCallback_Text)))) to nTotal
52020>>>                Move ((nReady / nTotal) * 100)                                                    to iPerc
52021>>>                Set Action_Text of ghoStatusPanel to (String(iPerc) * String("% Done (Total Number of Records:") * String(nTotal) + ")")
52022>>>                Case Break
52023>>>            Case Else
52023>>>                Set Message_Text to ""
52024>>>                Set Action_Text  to ""
52025>>>        Case End
52025>>>
52025>>>        Send ProcessEvents of ghoStatusPanel
52026>>>        Function_Return False
52027>>>    End_Function
52028>>>
52028>>>    Procedure IncreaseSortBufferSize
52030>>>        String sNull
52030>>>        Integer iSortBufferSize
52030>>>        Boolean bBufferSet
52030>>>
52030>>>        Move "" to sNull
52031>>>        Move (1024 * 128) to iSortBufferSize
52032>>>        Call_Driver 0 DATAFLEX_ID Function FLEX_SET_MAX_SORT_BUFFER Callback ghoDbUpdateHandler Passing sNull sNull iSortBufferSize Result bBufferSet
52037>>>
52037>>>    End_Procedure
52038>>>
52038>>>    Procedure SetAllIndexesToBatch Handle hTable Boolean bSetToBatch
52040>>>        Integer iLastIndex iIndex iNumSegments
52040>>>        Boolean bOK    
52040>>>        String sDriverID
52040>>>
52040>>>        If (hTable > 0) Begin
52042>>>            Get UtilDriverFromTableNumber hTable to sDriverID
52043>>>            Close hTable
52044>>>            Get OpenTableExclusive hTable to bOK
52045>>>            If (bOK = False) Begin
52047>>>                Function_Return False
52048>>>            End
52048>>>>
52048>>>            Get_Attribute DF_FILE_LAST_INDEX_NUMBER of hTable to iLastIndex   
52051>>>            Structure_Start hTable sDriverID
52052>>>                for iIndex from 1 to iLastIndex
52058>>>>
52058>>>                    Get_Attribute DF_INDEX_NUMBER_SEGMENTS of hTable iIndex to iNumSegments
52061>>>                    If (iNumSegments > 0) Begin                     
52063>>>                        If (bSetToBatch = True) Begin
52065>>>                            Set_Attribute DF_INDEX_TYPE of hTable iIndex to DF_INDEX_TYPE_BATCH
52068>>>                        End                 
52068>>>>
52068>>>                        Else Begin
52069>>>                            Set_Attribute DF_INDEX_TYPE of hTable iIndex to DF_INDEX_TYPE_ONLINE
52072>>>                        End
52072>>>>
52072>>>                    End
52072>>>>
52072>>>                Loop
52073>>>>
52073>>>            Structure_End hTable DF_STRUCTEND_OPT_NONE "." ghoDbUpdateHandler
52075>>>        End
52075>>>>
52075>>>    End_Procedure
52076>>>
52076>>>    Function NextFreeFilelistSlot Returns Handle
52078>>>        Handle hTable
52078>>>
52078>>>        Move 0 to hTable
52079>>>        Get_Attribute DF_FILE_NEXT_EMPTY of hTable to hTable
52082>>>
52082>>>        Function_Return hTable
52083>>>    End_Function
52084>>>
52084>>>    // For debugging purposes. To print Sql statements as they are build...
52084>>>    Procedure DebugPrint String sStmt String sFileName
52086>>>        Integer iCh
52086>>>        Get Seq_Append_Output_Channel sFileName to iCh
52087>>>            Write channel iCh sStmt
52089>>>        Send Seq_Close_Channel iCh
52090>>>    End_Procedure
52091>>>
52091>>>    // Returns the integer number for the passed Driver ID that is
52091>>>    // needed by some database API calls.
52091>>>    Function DriverIndex String sDriverID Returns Integer
52093>>>        String  sCurrentDriver
52093>>>        Integer iNumberOfDrivers iDriver iCount
52093>>>
52093>>>        Move 0 to iDriver
52094>>>
52094>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
52097>>>        for iCount from 1 to iNumberOfDrivers
52103>>>>
52103>>>
52103>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
52106>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriverID) ) Begin
52108>>>                Move iCount to iDriver
52109>>>            End
52109>>>>
52109>>>        Loop
52110>>>>
52110>>>
52110>>>        // In case it was not found, it wasn't loaded so we do that now.
52110>>>        If (iDriver = 0) Begin
52112>>>            Move False to Err
52113>>>            Load_Driver sDriverID
52114>>>            If (Err = False) Begin
52116>>>                Move 1 to iDriver
52117>>>            End
52117>>>>
52117>>>        End
52117>>>>
52117>>>
52117>>>        Function_Return iDriver
52118>>>    End_Function
52119>>>
52119>>>    // Returns TRUE if table is opened exclusive, otherwise FALSE
52119>>>    // Note: If run from the Studio, CodeMast & CodeType _is_ open by the Studio,
52119>>>    //       so in that case we "cheat" and report those tables were opened OK.
52119>>>    Function OpenTableExclusive Handle hTable Returns Boolean
52121>>>        Integer iMode
52121>>>        Boolean bOpened
52121>>>        String sTableName
52121>>>
52121>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
52122>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
52125>>>        If (bOpened) Begin
52127>>>            If (IsDebuggerPresent()) Begin
52129>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
52132>>>                If (Uppercase(sTableName) = "CODEMAST" or Uppercase(sTableName) = "CODETYPE") Begin
52134>>>                    Set Error_Report_Mode to DUF_ERROR_REPORT
52135>>>                    Function_Return True
52136>>>                End
52136>>>>
52136>>>            End
52136>>>>
52136>>>            Get_Attribute DF_FILE_OPEN_MODE of hTable to iMode
52139>>>            If (iMode=DF_EXCLUSIVE) Begin
52141>>>                    Set Error_Report_Mode to DUF_ERROR_REPORT
52142>>>                Function_Return True
52143>>>            End
52143>>>>
52143>>>            Close hTable
52144>>>        End
52144>>>>
52144>>>        Else Begin
52145>>>            Open hTable
52147>>>            Get_Attribute DF_FILE_OPENED of hTable to bOpened
52150>>>            If (bOpened and IsDebuggerPresent()) Begin
52152>>>                Get_Attribute DF_FILE_LOGICAL_NAME of hTable to sTableName
52155>>>                If (Uppercase(sTableName) = "CODEMAST" or Uppercase(sTableName) = "CODETYPE") Begin
52157>>>                    Set Error_Report_Mode to DUF_ERROR_REPORT
52158>>>                    Function_Return True
52159>>>                End
52159>>>>
52159>>>            End
52159>>>>
52159>>>
52159>>>        End
52159>>>>
52159>>>        
52159>>>        Close hTable
52160>>>        Open hTable Mode DF_EXCLUSIVE
52162>>>        Get_Attribute DF_FILE_OPENED of hTable to bOpened
52165>>>
52165>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
52166>>>        Function_Return bOpened
52167>>>    End_Function
52168>>>
52168>>>    Function AutoConnectionIDLogin Returns Boolean
52170>>>        String sConnectionID sConnectionString sDriverID
52170>>>        Boolean bExists bOK bSQLDriver
52170>>>        Handle hoCLI hoDriver
52170>>>        Integer iRetval
52170>>>        tSQLConnection SQLConnection
52170>>>        tSQLConnection SQLConnection
52170>>>
52170>>>        Get psDriverID to sDriverID
52171>>>        Get IsSQLDriver sDriverID to bSQLDriver
52172>>>        If (bSQLDriver = False) Begin
52174>>>            Function_Return True
52175>>>        End
52175>>>>
52175>>>
52175>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
52176>>>        Move SQLConnection.sDriverID                  to sDriverID
52177>>>        Move SQLConnection.sConnectionString          to sConnectionString
52178>>>        Get IsDAWSQLDriver sDriverID to bOK
52179>>>        If (bOK = True) Begin
52181>>>//            Get SQLLogin of ghoSQLConnectionHandler SQLConnection to bOK
52181>>>        End
52181>>>>
52181>>>        If (bOK = False) Begin
52183>>>            Get _MertechSQLManagerHandle to hoCLI
52184>>>            Get Create (RefClass(cDbUpdateDatabaseDriver)) to hoDriver
52185>>>            Set psDriverID of hoDriver to SQLConnection.sDriverID
52186>>>            If (SQLConnection.sDriverID <> DATAFLEX_ID) Begin
52188>>>                Get DbLogin  of hoDriver sConnectionString SQLConnection.sServer SQLConnection.sDatabase SQLConnection.bTrusted SQLConnection.sUserID SQLConnection.sPassword to bOK
52189>>>                Send Destroy of hoDriver
52190>>>            End
52190>>>>
52190>>>            Function_Return False
52191>>>        End
52191>>>>
52191>>>
52191>>>        Move SQLConnection.sConnectionID to sConnectionID
52192>>>
52192>>>        Get IsConnectionID sConnectionID sDriverID to bExists
52193>>>        If (bExists = False) Begin
52195>>>            // We always start by deleting the current connection - if any - because the
52195>>>            // login details my have changed.
52195>>>            Get phoCLIHandler to hoCLI
52196>>>            Set psDriverID    of hoCLI to sDriverID
52197>>>            Get DeleteConnectionID of hoCLI sConnectionID -1 to iRetval
52198>>>            Get UtilCreateConnectionID sConnectionID to bOk
52199>>>            If (bOk = False) Begin
52201>>>                Error DFERR_PROGRAM ("The Connection ID:" * sConnectionID * "could not be created and therefor the table can't be changed.")
52202>>>>
52202>>>                Function_Return False
52203>>>            End
52203>>>>
52203>>>            Move bOK to bExists
52204>>>        End
52204>>>>
52204>>>
52204>>>        Function_Return (bExists = True)
52205>>>    End_Function
52206>>>
52206>>>    // Scans to see if all tables can be opened exclusivly. I.e. that nobody else is running the application.
52206>>>    // Returns: False if nobody else is running
52206>>>    //          True if at least one table is open by another process (e.g. another user is running the application)
52206>>>    // N.B! Only works for Embedded DataFlex Tables! It will _not_ work for Sql tables because; these
52206>>>    //      tables are not locked as DataFlex tables are.
52206>>>    Function IsDatabaseInUse Returns Boolean
52208>>>        Handle  hTable
52208>>>        String  sRootName
52208>>>        Boolean bOpen bErr bAlias bOK bIsSQLTable bFlexErrs
52208>>>        Integer iCount iTables
52208>>>        
52208>>>        Move 0 to iTables
52209>>>        Set Action_Text of ghoStatusPanel to "Database in use check..."
52210>>>        Get AutoConnectionIDLogin to bOK
52211>>>        Get UtilFilelistNoOfTables to iTables
52212>>>        Set piPosition   of ghoProgressBar to 0
52213>>>        Set piAdvanceBy  of ghoProgressBar to 1      
52214>>>        Set piMaximum    of ghoProgressBar to iTables
52215>>>        Move 0 to hTable
52216>>>        Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
52219>>>        Move False to bErr
52220>>>        Send Ignore_Error of Error_Object_Id DFERR_FILE_ACCESS_VIOLATION
52221>>>
52221>>>        Repeat
52221>>>>
52221>>>            Set piPosition of ghoProgressBar to iCount
52222>>>            Increment iCount
52223>>>            Get_Attribute DF_FILE_ROOT_NAME of hTable to sRootName
52226>>>            Move (Uppercase(sRootName) = "FLEXERRS")  to bFlexErrs
52227>>>
52227>>>            // This test is only applicable for DataFlex embedded tables; so skip test if driver based table.
52227>>>            Get UtilTableIsSQLByRootName sRootName to bIsSQLTable
52228>>>            Move False to bOpen
52229>>>
52229>>>            // Don't bother about FlexErrs (Normally table 50)
52229>>>            If (bIsSQLTable = False and hTable <> 0 and bFlexErrs = False) Begin
52231>>>                Set Error_Report_Mode to DUF_ERROR_NO_REPORT
52232>>>                Open hTable
52234>>>                Get_Attribute DF_FILE_OPENED of hTable to bOpen
52237>>>                Set Error_Report_Mode to DUF_ERROR_REPORT
52238>>>                If (bOpen = True) Begin
52240>>>                    // We cannot open an Alias file exclusive as it will generate an error (4177 - "File in use")
52240>>>                    Get UtilTableIsAlias hTable to bAlias
52241>>>                    If (bAlias = False) Begin
52243>>>                        Close hTable
52244>>>                        Get OpenTableExclusive hTable to bOpen
52245>>>                        If (bOpen = False) Begin
52247>>>                            Move True to bErr
52248>>>                        End
52248>>>>
52248>>>                    End
52248>>>>
52248>>>                End
52248>>>>
52248>>>                Close hTable
52249>>>            End
52249>>>>
52249>>>            Get_Attribute DF_FILE_NEXT_USED of hTable to hTable
52252>>>            If (bErr = True ) ;                Break
52255>>>        Until (not(hTable))
52257>>>
52257>>>        Set Action_Text of ghoStatusPanel to ""
52258>>>        Send Trap_Error of Error_Object_Id DFERR_FILE_ACCESS_VIOLATION
52259>>>        Move False to Err
52260>>>
52260>>>        Function_Return bErr
52261>>>    End_Function
52262>>>
52262>>>    // Checks if the passed connection id exists in the CLI interface.
52262>>>    // This might be needed by API-methods when a connection id is to be used and
52262>>>    // the connection id hasn't been established with the driver's CLI interface.
52262>>>    // NOTE: Only applicable for DAW drivers.
52262>>>    Function IsConnectionID String sConnectionID String sDriverID Returns Boolean
52264>>>        String sID sConnString
52264>>>        Integer iDriver iNumConn iCount
52264>>>        Handle hoCLI
52264>>>        Boolean bOK
52264>>>
52264>>>        Get IsDAWSQLDriver sDriverID to bOK
52265>>>        If (bOK = False) Begin
52267>>>            Error DFERR_PROGRAM "Connection ID's can only be used with DAW drivers (not Mertech)."
52268>>>>
52268>>>            Function_Return False
52269>>>        End
52269>>>>
52269>>>
52269>>>        Move False to bOK
52270>>>        Get phoCLIHandler to hoCLI
52271>>>        If (hoCLI <> 0) Begin
52273>>>            Set psDriverID of hoCLI to sDriverID
52274>>>            Get DriverIndex of hoCLI sDriverID to iDriver
52275>>>
52275>>>            // If driver not loaded; load it.
52275>>>            If (iDriver = 0) Begin
52277>>>                Load_Driver sDriverID
52278>>>                Get DriverIndex sDriverID to iDriver
52279>>>            End
52279>>>>
52279>>>            If (iDriver <> 0) Begin
52281>>>                Get_Attribute DF_DRIVER_NUMBER_CONNECTION_IDS of iDriver to iNumConn
52284>>>                Decrement iNumConn
52285>>>                for iCount from 0 to iNumConn
52291>>>>
52291>>>                    Get_Attribute DF_DRIVER_CONNECTION_ID_STRING of iDriver iCount to sConnString
52294>>>                    Get_Attribute DF_DRIVER_CONNECTION_ID of iDriver iCount to sID
52297>>>                    If (sID = sConnectionID) Begin
52299>>>                        Move True to bOK
52300>>>                    End
52300>>>>
52300>>>                Loop
52301>>>>
52301>>>            End
52301>>>>
52301>>>        End
52301>>>>
52301>>>
52301>>>        Function_Return bOK
52302>>>    End_Function
52303>>>
52303>>>    Function IsDAWSQLDriver String sDriverID Returns Boolean
52305>>>        Boolean bOK
52305>>>        Move (sDriverID = MSSQLDRV_ID or sDriverID = DB2_DRV_ID or sDriverID = ODBC_DRV_ID) to bOK
52306>>>        Function_Return bOK
52307>>>    End_Function
52308>>>
52308>>>    Function IsMertechDriver String sDriverID Returns Boolean
52310>>>        Boolean bOK
52310>>>        Move False to bOK
52311>>>        Move (sDriverID = SQLFLEX or sDriverID = ORAFLEX or sDriverID = MDSPgSQL or sDriverID = MDSMySQL) to bOK
52312>>>        Function_Return bOK
52313>>>    End_Function
52314>>>
52314>>>    Function IsMSSQLDriver Returns Boolean
52316>>>        Integer iDriverIndex
52316>>>
52316>>>        Get DriverIndex MSSQLDRV_ID to iDriverIndex
52317>>>
52317>>>        Function_Return (iDriverIndex <> 0)
52318>>>    End_Function
52319>>>
52319>>>    // Similar to _SqlCheckCurrentDriver but generates no error and it doesn't
52319>>>    // attempt to load the driver.
52319>>>    // Returns true if the passed driver is SQL based.
52319>>>    Function IsSQLDriver String sDriverID Returns Boolean
52321>>>        Boolean bOK
52321>>>
52321>>>        Get IsDAWSQLDriver sDriverID to bOK
52322>>>
52322>>>        If (bOK = False) Begin
52324>>>            Get IsMertechDriver sDriverID to bOK
52325>>>        End
52325>>>>
52325>>>
52325>>>        Function_Return bOK
52326>>>    End_Function
52327>>>
52327>>>    // *** Error Handler ***
52327>>>    //
52327>>>    // Note: If the cDbUpdateHandler & cDbUpdateVersion classes are used this error handler is _not_
52327>>>    //       used. Instead the Error_Report in the cDbUpdateHandler i used.
52327>>>    Procedure Error_Report Integer iErrorNumber Integer iErrorLine String sErrorText
52329>>>        Integer iSize iErrorMode
52329>>>        tSqlErrorArray aSqlErrorArray
52329>>>        tSqlErrorArray aSqlErrorArray
52329>>>
52329>>>        If (pbProcessingError(Self)) Begin
52331>>>            Procedure_Return
52332>>>        End
52332>>>>
52332>>>
52332>>>        Get Error_Report_Mode to iErrorMode
52333>>>        If (iErrorMode = DUF_ERROR_NO_REPORT) Begin
52335>>>            Procedure_Return
52336>>>        End
52336>>>>
52336>>>
52336>>>        Set pbProcessingError to True
52337>>>        Set pbSqlError to True
52338>>>        Get paSqlErrorArray      to aSqlErrorArray
52339>>>        Move (SizeOfArray(aSqlErrorArray.sSqlErrorArray)) to iSize
52340>>>        Move sErrorText          to aSqlErrorArray.sSqlErrorArray[iSize]
52341>>>        Get psSQLStatementString to aSqlErrorArray.sSqlStatementArray[iSize]
52342>>>        Move iErrorNumber        to aSqlErrorArray.iSqlErrorArray[iSize]
52343>>>        Set paSqlErrorArray      to aSqlErrorArray
52344>>>        Set pbProcessingError to False
52345>>>    End_Procedure
52346>>>
52346>>>    // *** Miscellanous Helper Functions ***
52346>>>    //
52346>>>    // Helper function. Takes a DF_FILE_XXXX_NAME value as parameter and
52346>>>    // returns the table name only; stripped of any path or filename extension.
52346>>>    Function _TableNameOnly String sName Returns String
52348>>>        String sPath sExt
52348>>>
52348>>>        Get ParseFolderName sName to sPath
52349>>>        If (sPath <> "") Begin
52351>>>            Move (Replace(sPath, sName, "")) to sName
52352>>>        End
52352>>>>
52352>>>        Get ParseFileExtension sName to sExt
52353>>>        If (sExt <> "") Begin
52355>>>            Move (Replace(("." + sExt), sName, "")) to sName
52356>>>        End
52356>>>>
52356>>>
52356>>>        Function_Return sName
52357>>>    End_Function
52358>>>
52358>>>    // Removes any prefix to a table name.
52358>>>    // Example mssqldrv:mytable returns mytable
52358>>>    //         dbo.mytable returns mytable
52358>>>    Function _TableNoPrefix String sName Returns String
52360>>>        Integer iPos
52360>>>
52360>>>        Move (Pos(":", sName)) to iPos
52361>>>        If (iPos <> 0) Begin
52363>>>            Move (Mid(sName, 999, (iPos + 1))) to sName
52364>>>        End
52364>>>>
52364>>>        Move (Pos(".", sName)) to iPos
52365>>>        If (iPos <> 0) Begin
52367>>>            Move (Mid(sName, 999, (iPos + 1))) to sName
52368>>>        End
52368>>>>
52368>>>
52368>>>        Function_Return sName
52369>>>    End_Function
52370>>>
52370>>>    // Returns the first datapath found in the psDataPath property.
52370>>>    // The returned path always ends with a "\"
52370>>>    Function psDataPathFirstPart Returns String
52372>>>        String sDataPath
52372>>>        Integer iCount
52372>>>
52372>>>        Get psDataPath of (phoWorkspace(ghoApplication)) to sDataPath
52373>>>        Get CountOfPaths of (phoWorkspace(ghoApplication)) sDataPath to iCount
52374>>>        If (iCount > 1) Begin
52376>>>            Get PathAtIndex of (phoWorkspace(ghoApplication)) sDataPath 1 to sDataPath
52377>>>        End
52377>>>>
52377>>>        If (sDataPath <> "") Begin
52379>>>            Get vFolderFormat sDataPath to sDataPath
52380>>>        End
52380>>>>
52380>>>
52380>>>        Function_Return sDataPath
52381>>>    End_Function
52382>>>
52382>>>    Function psLogTextFileWithPath Returns String
52384>>>        String sFileName 
52384>>>        Handle hoLogFile
52384>>>        Get phoLogFile to hoLogFile
52385>>>        Get psLogTextFileWithPath of hoLogFile to sFileName
52386>>>        Function_Return sFileName
52387>>>    End_Function                     
52388>>>    
52388>>>    // *** Property Messages ***
52388>>>    //
52388>>>    // These "properties" are settings for the cSQLConnectionHandler class, but have been
52388>>>    // "duplicated" here so connection properties can be relayed to the ghoSQLConnectionHandler object
52388>>>    //
52388>>>
52388>>>    Function pSQLConnection Returns tSQLConnection
52390>>>        tSQLConnection SQLConnection
52390>>>        tSQLConnection SQLConnection
52390>>>        If (ghoSQLConnectionHandler = 0) Begin
52392>>>            // Note: No point in translating as the programmer will see this immediately after compiling the program...
52392>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52393>>>>
52393>>>            Function_Return
52394>>>        End
52394>>>>
52394>>>        Get pSQLConnection of ghoSQLConnectionHandler to SQLConnection
52395>>>        Function_Return SQLConnection
52396>>>    End_Function
52397>>>
52397>>>    // * Dummy function for the Studio's Code Explorer *
52397>>>    Function OTHER_CLASS_PROPERTIES Returns Boolean
52399>>>        Function_Return False
52400>>>    End_Function
52401>>>
52401>>>    Procedure Set psServer String sValue
52403>>>        If (ghoSQLConnectionHandler = 0) Begin
52405>>>            // Note: No point in translating as the programmer will see this immediately after compiling the program...
52405>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52406>>>>
52406>>>            Procedure_Return
52407>>>        End
52407>>>>
52407>>>        Set psServer of ghoSQLConnectionHandler to sValue
52408>>>    End_Procedure
52409>>>
52409>>>    Function psServer Returns String
52411>>>        String sValue
52411>>>        If (ghoSQLConnectionHandler = 0) Begin
52413>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52414>>>>
52414>>>            Function_Return
52415>>>        End
52415>>>>
52415>>>        Get psServer of ghoSQLConnectionHandler to sValue
52416>>>        Function_Return sValue
52417>>>    End_Function
52418>>>
52418>>>    Procedure Set psDatabase String sValue
52420>>>        If (ghoSQLConnectionHandler = 0) Begin
52422>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52423>>>>
52423>>>            Procedure_Return
52424>>>        End
52424>>>>
52424>>>        Set psDatabase of ghoSQLConnectionHandler to sValue
52425>>>    End_Procedure
52426>>>
52426>>>    Function psDatabase Returns String
52428>>>        String sValue
52428>>>        If (ghoSQLConnectionHandler = 0) Begin
52430>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52431>>>>
52431>>>            Function_Return
52432>>>        End
52432>>>>
52432>>>        Get psDatabase of ghoSQLConnectionHandler to sValue
52433>>>        Function_Return sValue
52434>>>    End_Function
52435>>>
52435>>>    Procedure Set psUserID String sValue
52437>>>        If (ghoSQLConnectionHandler = 0) Begin
52439>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52440>>>>
52440>>>            Function_Return
52441>>>        End
52441>>>>
52441>>>        Set psUserID of ghoSQLConnectionHandler to sValue
52442>>>    End_Procedure
52443>>>
52443>>>    Function psUserID Returns String
52445>>>        String sValue
52445>>>        If (ghoSQLConnectionHandler = 0) Begin
52447>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52448>>>>
52448>>>            Function_Return
52449>>>        End
52449>>>>
52449>>>        Get psUserID of ghoSQLConnectionHandler to sValue
52450>>>        Function_Return sValue
52451>>>    End_Function
52452>>>
52452>>>    Procedure Set psPassword String sValue
52454>>>        If (ghoSQLConnectionHandler = 0) Begin
52456>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52457>>>>
52457>>>            Procedure_Return
52458>>>        End
52458>>>>
52458>>>        Set psPassword of ghoSQLConnectionHandler to sValue
52459>>>    End_Procedure
52460>>>
52460>>>    Function psPassword Returns String
52462>>>        String sValue
52462>>>        If (ghoSQLConnectionHandler = 0) Begin
52464>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52465>>>>
52465>>>            Function_Return
52466>>>        End
52466>>>>
52466>>>        Get psPassword of ghoSQLConnectionHandler to sValue
52467>>>        Function_Return sValue
52468>>>    End_Function
52469>>>
52469>>>    Procedure Set pbTrusted Boolean bValue
52471>>>        If (ghoSQLConnectionHandler = 0) Begin
52473>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52474>>>>
52474>>>            Procedure_Return
52475>>>        End
52475>>>>
52475>>>        Set pbTrusted of ghoSQLConnectionHandler to bValue
52476>>>    End_Procedure
52477>>>
52477>>>    Function pbTrusted Returns Boolean
52479>>>        Boolean bValue
52479>>>        If (ghoSQLConnectionHandler = 0) Begin
52481>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52482>>>>
52482>>>            Function_Return
52483>>>        End
52483>>>>
52483>>>        Get pbTrusted of ghoSQLConnectionHandler to bValue
52484>>>        Function_Return bValue
52485>>>    End_Function
52486>>>
52486>>>    Procedure Set pbSilentLogin Boolean bValue
52488>>>        If (ghoSQLConnectionHandler = 0) Begin
52490>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52491>>>>
52491>>>            Procedure_Return
52492>>>        End
52492>>>>
52492>>>        Set pbSilentLogin of ghoSQLConnectionHandler to bValue
52493>>>    End_Procedure
52494>>>
52494>>>    Function pbSilentLogin Returns Boolean
52496>>>        Boolean bValue
52496>>>        If (ghoSQLConnectionHandler = 0) Begin
52498>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52499>>>>
52499>>>            Function_Return
52500>>>        End
52500>>>>
52500>>>        Get pbSilentLogin of ghoSQLConnectionHandler to bValue
52501>>>        Function_Return bValue
52502>>>    End_Function
52503>>>
52503>>>    Procedure Set psConnectionID String sValue
52505>>>        If (ghoSQLConnectionHandler = 0) Begin
52507>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52508>>>>
52508>>>            Procedure_Return
52509>>>        End
52509>>>>
52509>>>        Set psConnectionID of ghoSQLConnectionHandler to sValue
52510>>>    End_Procedure
52511>>>
52511>>>    Function psConnectionID Returns String
52513>>>        String sValue
52513>>>        If (ghoSQLConnectionHandler = 0) Begin
52515>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52516>>>>
52516>>>            Function_Return
52517>>>        End
52517>>>>
52517>>>        Get psConnectionID of ghoSQLConnectionHandler to sValue
52518>>>        Function_Return sValue
52519>>>    End_Function
52520>>>
52520>>>    Procedure Set psConnectionString String sValue
52522>>>        If (ghoSQLConnectionHandler = 0) Begin
52524>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52525>>>>
52525>>>            Procedure_Return
52526>>>        End
52526>>>>
52526>>>        Set psConnectionString of ghoSQLConnectionHandler to sValue
52527>>>    End_Procedure
52528>>>
52528>>>    Function psConnectionString Returns String
52530>>>        String sValue
52530>>>        If (ghoSQLConnectionHandler = 0) Begin
52532>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52533>>>>
52533>>>            Function_Return
52534>>>        End
52534>>>>
52534>>>        Get psConnectionString of ghoSQLConnectionHandler to sValue
52535>>>        Function_Return sValue
52536>>>    End_Function
52537>>>
52537>>>    // The normal connection string looks something like this;
52537>>>    // SERVER=.\SQLEXPRESS; DATABASE=OrderEntry; TRUSTED_CONNECTION=Yes; ,0
52537>>>    // ...and the full connection string looks like this;
52537>>>    // DFConnectionId OrderEntry, SERVER=.\SQLEXPRESS; DATABASE=OrderEntry; TRUSTED_CONNECTION=Yes; ,0
52537>>>    Function psFullConnectionString Returns String
52539>>>        String sConnectionID sConnectionString
52539>>>        If (ghoSQLConnectionHandler = 0) Begin
52541>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52542>>>>
52542>>>            Function_Return
52543>>>        End
52543>>>>
52543>>>        Get psConnectionID     of ghoSQLConnectionHandler to sConnectionID
52544>>>        Move (Trim(sConnectionID)) to sConnectionID
52545>>>        Get psConnectionString of ghoSQLConnectionHandler to sConnectionString
52546>>>        Function_Return (CS_SQLConnectionIDText * sConnectionID + "," * String(sConnectionString))
52547>>>    End_Function
52548>>>
52548>>>    Function piConnectionOptions Returns Integer
52550>>>        Integer iValue
52550>>>        If (ghoSQLConnectionHandler = 0) Begin
52552>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52553>>>>
52553>>>            Function_Return
52554>>>        End
52554>>>>
52554>>>        Get piConnectionOptions of ghoSQLConnectionHandler to iValue
52555>>>        Function_Return iValue
52556>>>    End_Function
52557>>>
52557>>>    Procedure Set psSchema String sValue
52559>>>        tSQLConnection SQLConnection
52559>>>        tSQLConnection SQLConnection
52559>>>        If (ghoSQLConnectionHandler = 0) Begin
52561>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52562>>>>
52562>>>            Procedure_Return
52563>>>        End
52563>>>>
52563>>>        Set psSchema of ghoSQLConnectionHandler to sValue
52564>>>    End_Procedure
52565>>>
52565>>>    Function psSchema Returns String
52567>>>        String sRetval
52567>>>        If (ghoSQLConnectionHandler = 0) Begin
52569>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52570>>>>
52570>>>            Function_Return
52571>>>        End
52571>>>>
52571>>>        Get psSchema of ghoSQLConnectionHandler to sRetval
52572>>>        Function_Return sRetval
52573>>>    End_Function
52574>>>
52574>>>    Procedure Set psBaseTableSpace String sValue
52576>>>        If (ghoSQLConnectionHandler = 0) Begin
52578>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52579>>>>
52579>>>            Procedure_Return
52580>>>        End
52580>>>>
52580>>>        Set psBaseTableSpace of ghoSQLConnectionHandler to sValue
52581>>>    End_Procedure
52582>>>
52582>>>    Function psBaseTableSpace Returns String
52584>>>        String sRetval
52584>>>        If (ghoSQLConnectionHandler = 0) Begin
52586>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52587>>>>
52587>>>            Function_Return
52588>>>        End
52588>>>>
52588>>>        Get psBaseTableSpace of ghoSQLConnectionHandler to sRetval
52589>>>        Function_Return sRetval
52590>>>    End_Function
52591>>>
52591>>>    Procedure Set psLongTableSpace String sValue
52593>>>        If (ghoSQLConnectionHandler = 0) Begin
52595>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52596>>>>
52596>>>            Procedure_Return
52597>>>        End
52597>>>>
52597>>>        Set psLongTableSpace of ghoSQLConnectionHandler to sValue
52598>>>    End_Procedure
52599>>>
52599>>>    Function psLongTableSpace Returns String
52601>>>        String sRetval
52601>>>        If (ghoSQLConnectionHandler = 0) Begin
52603>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52604>>>>
52604>>>            Function_Return
52605>>>        End
52605>>>>
52605>>>        Get psLongTableSpace of ghoSQLConnectionHandler to sRetval
52606>>>        Function_Return sRetval
52607>>>    End_Function
52608>>>
52608>>>    Procedure Set psIndexTableSpace String sValue
52610>>>        If (ghoSQLConnectionHandler = 0) Begin
52612>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52613>>>>
52613>>>            Procedure_Return
52614>>>        End
52614>>>>
52614>>>        Set psIndexTableSpace of ghoSQLConnectionHandler to sValue
52615>>>    End_Procedure
52616>>>
52616>>>    Function psIndexTableSpace Returns String
52618>>>        String sRetval
52618>>>        If (ghoSQLConnectionHandler = 0) Begin
52620>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52621>>>>
52621>>>            Function_Return
52622>>>        End
52622>>>>
52622>>>        Get psIndexTableSpace of ghoSQLConnectionHandler to sRetval
52623>>>        Function_Return sRetval
52624>>>    End_Function
52625>>>
52625>>>    Procedure Set pbUseConnectionID Boolean bState
52627>>>        If (ghoSQLConnectionHandler = 0) Begin
52629>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52630>>>>
52630>>>            Procedure_Return
52631>>>        End
52631>>>>
52631>>>        Set pbUseConnectionID of ghoSQLConnectionHandler to bState
52632>>>    End_Procedure
52633>>>
52633>>>    Function pbUseConnectionID Returns Boolean
52635>>>        Boolean bState
52635>>>        If (ghoSQLConnectionHandler = 0) Begin
52637>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52638>>>>
52638>>>            Function_Return
52639>>>        End
52639>>>>
52639>>>        Get pbUseConnectionID of ghoSQLConnectionHandler to bState
52640>>>        Function_Return bState
52641>>>    End_Function
52642>>>
52642>>>    Procedure Set pbToANSI Boolean bState
52644>>>        If (ghoSQLConnectionHandler = 0) Begin
52646>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52647>>>>
52647>>>            Procedure_Return
52648>>>        End
52648>>>>
52648>>>        Set pbToANSI of ghoSQLConnectionHandler to bState
52649>>>    End_Procedure
52650>>>
52650>>>    Function pbToANSI Returns Boolean
52652>>>        Boolean bState
52652>>>        If (ghoSQLConnectionHandler = 0) Begin
52654>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52655>>>>
52655>>>            Function_Return
52656>>>        End
52656>>>>
52656>>>        Get pbToANSI of ghoSQLConnectionHandler to bState
52657>>>        Function_Return bState
52658>>>    End_Function
52659>>>
52659>>>    Procedure Set pbRecnum Boolean bState
52661>>>        If (ghoSQLConnectionHandler = 0) Begin
52663>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52664>>>>
52664>>>            Procedure_Return
52665>>>        End
52665>>>>
52665>>>        Set pbRecnum of ghoSQLConnectionHandler to bState
52666>>>    End_Procedure
52667>>>
52667>>>    Function pbRecnum Returns Boolean
52669>>>        Boolean bState
52669>>>        If (ghoSQLConnectionHandler = 0) Begin
52671>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52672>>>>
52672>>>            Function_Return
52673>>>        End
52673>>>>
52673>>>        Get pbRecnum of ghoSQLConnectionHandler to bState
52674>>>        Function_Return bState
52675>>>    End_Function
52676>>>
52676>>>    Procedure Set pbCopyData Boolean bState
52678>>>        If (ghoSQLConnectionHandler = 0) Begin
52680>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52681>>>>
52681>>>            Procedure_Return
52682>>>        End
52682>>>>
52682>>>        Set pbCopyData of ghoSQLConnectionHandler to bState
52683>>>    End_Procedure
52684>>>
52684>>>    Function pbCopyData Returns Boolean
52686>>>        Boolean bState
52686>>>        If (ghoSQLConnectionHandler = 0) Begin
52688>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52689>>>>
52689>>>            Function_Return
52690>>>        End
52690>>>>
52690>>>        Get pbCopyData of ghoSQLConnectionHandler to bState
52691>>>        Function_Return bState
52692>>>    End_Function
52693>>>
52693>>>    Procedure Set pbApiTableUpdateAuto Boolean bState
52695>>>        If (ghoSQLConnectionHandler = 0) Begin
52697>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52698>>>>
52698>>>            Procedure_Return
52699>>>        End
52699>>>>
52699>>>        Set pbApiTableUpdateAuto of ghoSQLConnectionHandler to bState
52700>>>    End_Procedure
52701>>>
52701>>>    Function pbApiTableUpdateAuto Returns Boolean
52703>>>        Boolean bState
52703>>>        If (ghoSQLConnectionHandler = 0) Begin
52705>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52706>>>>
52706>>>            Function_Return
52707>>>        End
52707>>>>
52707>>>        Get pbApiTableUpdateAuto of ghoSQLConnectionHandler to bState
52708>>>        Function_Return bState
52709>>>    End_Function
52710>>>
52710>>>    Procedure Set pbCompareDate_DateTime Boolean bState
52712>>>        If (ghoSQLConnectionHandler = 0) Begin
52714>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52715>>>>
52715>>>            Procedure_Return
52716>>>        End
52716>>>>
52716>>>        Set pbCompareDate_DateTime of ghoSQLConnectionHandler to bState
52717>>>    End_Procedure
52718>>>
52718>>>    Function pbCompareDate_DateTime Returns Boolean
52720>>>        Boolean bState
52720>>>        If (ghoSQLConnectionHandler = 0) Begin
52722>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52723>>>>
52723>>>            Function_Return
52724>>>        End
52724>>>>
52724>>>        Get pbCompareDate_DateTime of ghoSQLConnectionHandler to bState
52725>>>        Function_Return bState
52726>>>    End_Function
52727>>>
52727>>>    Procedure Set pbCompareIndexAscending Boolean bState
52729>>>        If (ghoSQLConnectionHandler = 0) Begin
52731>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52732>>>>
52732>>>            Procedure_Return
52733>>>        End
52733>>>>
52733>>>        Set pbCompareIndexAscending of ghoSQLConnectionHandler to bState
52734>>>    End_Procedure
52735>>>
52735>>>    Function pbCompareIndexAscending Returns Boolean
52737>>>        Boolean bState
52737>>>        If (ghoSQLConnectionHandler = 0) Begin
52739>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52740>>>>
52740>>>            Function_Return
52741>>>        End
52741>>>>
52741>>>        Get pbCompareIndexAscending of ghoSQLConnectionHandler to bState
52742>>>        Function_Return bState
52743>>>    End_Function
52744>>>
52744>>>    Procedure Set pbCompareIndexUppercase Boolean bState
52746>>>        If (ghoSQLConnectionHandler = 0) Begin
52748>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52749>>>>
52749>>>            Procedure_Return
52750>>>        End
52750>>>>
52750>>>        Set pbCompareIndexUppercase of ghoSQLConnectionHandler to bState
52751>>>    End_Procedure
52752>>>
52752>>>    Function pbCompareIndexUppercase Returns Boolean
52754>>>        Boolean bState
52754>>>        If (ghoSQLConnectionHandler = 0) Begin
52756>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO ConnectionID has been setup by the programmer."
52757>>>>
52757>>>            Function_Return
52758>>>        End
52758>>>>
52758>>>        Get pbCompareIndexUppercase of ghoSQLConnectionHandler to bState
52759>>>        Function_Return bState
52760>>>    End_Function
52761>>>
52761>>>    Procedure Set psDriverDefaultValueASCII String sValue
52763>>>        If (ghoSQLConnectionHandler = 0) Begin
52765>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52766>>>>
52766>>>            Procedure_Return
52767>>>        End
52767>>>>
52767>>>        Set psDriverDefaultValueASCII of ghoSQLConnectionHandler to sValue
52768>>>    End_Procedure
52769>>>
52769>>>    Function psDriverDefaultValueASCII Returns String
52771>>>        String sRetval
52771>>>        If (ghoSQLConnectionHandler = 0) Begin
52773>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52774>>>>
52774>>>            Function_Return
52775>>>        End
52775>>>>
52775>>>        Get psDriverDefaultValueASCII of ghoSQLConnectionHandler to sRetval
52776>>>        Function_Return sRetval
52777>>>    End_Function
52778>>>
52778>>>    Procedure Set psDriverDefaultValueBinary String sValue
52780>>>        If (ghoSQLConnectionHandler = 0) Begin
52782>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52783>>>>
52783>>>            Procedure_Return
52784>>>        End
52784>>>>
52784>>>        Set psDriverDefaultValueBinary of ghoSQLConnectionHandler to sValue
52785>>>    End_Procedure
52786>>>
52786>>>    Function psDriverDefaultValueBinary Returns String
52788>>>        String sRetval
52788>>>        If (ghoSQLConnectionHandler = 0) Begin
52790>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52791>>>>
52791>>>            Function_Return
52792>>>        End
52792>>>>
52792>>>        Get psDriverDefaultValueBinary of ghoSQLConnectionHandler to sRetval
52793>>>        Function_Return sRetval
52794>>>    End_Function
52795>>>
52795>>>    Procedure Set psDriverDefaultValueDate String sValue
52797>>>        If (ghoSQLConnectionHandler = 0) Begin
52799>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52800>>>>
52800>>>            Procedure_Return
52801>>>        End
52801>>>>
52801>>>        Set psDriverDefaultValueDate of ghoSQLConnectionHandler to sValue
52802>>>    End_Procedure
52803>>>
52803>>>    Function psDriverDefaultValueDate Returns String
52805>>>        String sRetval
52805>>>        If (ghoSQLConnectionHandler = 0) Begin
52807>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52808>>>>
52808>>>            Function_Return
52809>>>        End
52809>>>>
52809>>>        Get psDriverDefaultValueDate of ghoSQLConnectionHandler to sRetval
52810>>>        Function_Return sRetval
52811>>>    End_Function
52812>>>
52812>>>    Procedure Set psDriverDefaultValueDateTime String sValue
52814>>>        If (ghoSQLConnectionHandler = 0) Begin
52816>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52817>>>>
52817>>>            Procedure_Return
52818>>>        End
52818>>>>
52818>>>        Set psDriverDefaultValueDateTime of ghoSQLConnectionHandler to sValue
52819>>>    End_Procedure
52820>>>
52820>>>    Function psDriverDefaultValueDateTime Returns String
52822>>>        String sRetval
52822>>>        If (ghoSQLConnectionHandler = 0) Begin
52824>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52825>>>>
52825>>>            Function_Return
52826>>>        End
52826>>>>
52826>>>        Get psDriverDefaultValueDateTime of ghoSQLConnectionHandler to sRetval
52827>>>        Function_Return sRetval
52828>>>    End_Function
52829>>>
52829>>>    Procedure Set psDriverDefaultValueNumeric String sValue
52831>>>        If (ghoSQLConnectionHandler = 0) Begin
52833>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52834>>>>
52834>>>            Procedure_Return
52835>>>        End
52835>>>>
52835>>>        Set psDriverDefaultValueNumeric of ghoSQLConnectionHandler to sValue
52836>>>    End_Procedure
52837>>>
52837>>>    Function psDriverDefaultValueNumeric Returns String
52839>>>        String sRetval
52839>>>        If (ghoSQLConnectionHandler = 0) Begin
52841>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52842>>>>
52842>>>            Function_Return
52843>>>        End
52843>>>>
52843>>>        Get psDriverDefaultValueNumeric of ghoSQLConnectionHandler to sRetval
52844>>>        Function_Return sRetval
52845>>>    End_Function
52846>>>
52846>>>    Procedure Set psDriverDefaultValueText String sValue
52848>>>        If (ghoSQLConnectionHandler = 0) Begin
52850>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52851>>>>
52851>>>            Procedure_Return
52852>>>        End
52852>>>>
52852>>>        Set psDriverDefaultValueText of ghoSQLConnectionHandler to sValue
52853>>>    End_Procedure
52854>>>
52854>>>    Function psDriverDefaultValueText Returns String
52856>>>        String sRetval
52856>>>        If (ghoSQLConnectionHandler = 0) Begin
52858>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52859>>>>
52859>>>            Function_Return
52860>>>        End
52860>>>>
52860>>>        Get psDriverDefaultValueText of ghoSQLConnectionHandler to sRetval
52861>>>        Function_Return sRetval
52862>>>    End_Function
52863>>>
52863>>>    Procedure Set pbDriverDefaultNullableASCII Boolean bState
52865>>>        If (ghoSQLConnectionHandler = 0) Begin
52867>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52868>>>>
52868>>>            Procedure_Return
52869>>>        End
52869>>>>
52869>>>        Set pbDriverDefaultNullableASCII of ghoSQLConnectionHandler to bState
52870>>>    End_Procedure
52871>>>
52871>>>    Function pbDriverDefaultNullableASCII Returns Boolean
52873>>>        Boolean bState
52873>>>        If (ghoSQLConnectionHandler = 0) Begin
52875>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52876>>>>
52876>>>            Function_Return
52877>>>        End
52877>>>>
52877>>>        Get pbDriverDefaultNullableASCII of ghoSQLConnectionHandler to bState
52878>>>        Function_Return bState
52879>>>    End_Function
52880>>>
52880>>>    Procedure Set pbDriverDefaultNullableBinary Boolean bState
52882>>>        If (ghoSQLConnectionHandler = 0) Begin
52884>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52885>>>>
52885>>>            Procedure_Return
52886>>>        End
52886>>>>
52886>>>        Set pbDriverDefaultNullableBinary of ghoSQLConnectionHandler to bState
52887>>>    End_Procedure
52888>>>
52888>>>    Function pbDriverDefaultNullableBinary Returns Boolean
52890>>>        Boolean bState
52890>>>        If (ghoSQLConnectionHandler = 0) Begin
52892>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52893>>>>
52893>>>            Function_Return
52894>>>        End
52894>>>>
52894>>>        Get pbDriverDefaultNullableBinary of ghoSQLConnectionHandler to bState
52895>>>        Function_Return bState
52896>>>    End_Function
52897>>>
52897>>>    Procedure Set pbDriverDefaultNullableDate Boolean bState
52899>>>        If (ghoSQLConnectionHandler = 0) Begin
52901>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52902>>>>
52902>>>            Procedure_Return
52903>>>        End
52903>>>>
52903>>>        Set pbDriverDefaultNullableDate of ghoSQLConnectionHandler to bState
52904>>>    End_Procedure
52905>>>
52905>>>    Function pbDriverDefaultNullableDate Returns Boolean
52907>>>        Boolean bState
52907>>>        If (ghoSQLConnectionHandler = 0) Begin
52909>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52910>>>>
52910>>>            Function_Return
52911>>>        End
52911>>>>
52911>>>        Get pbDriverDefaultNullableDate of ghoSQLConnectionHandler to bState
52912>>>        Function_Return bState
52913>>>    End_Function
52914>>>
52914>>>    Procedure Set pbDriverDefaultNullableDateTime Boolean bState
52916>>>        If (ghoSQLConnectionHandler = 0) Begin
52918>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52919>>>>
52919>>>            Procedure_Return
52920>>>        End
52920>>>>
52920>>>        Set pbDriverDefaultNullableDateTime of ghoSQLConnectionHandler to bState
52921>>>    End_Procedure
52922>>>
52922>>>    Function pbDriverDefaultNullableDateTime Returns Boolean
52924>>>        Boolean bState
52924>>>        If (ghoSQLConnectionHandler = 0) Begin
52926>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52927>>>>
52927>>>            Function_Return
52928>>>        End
52928>>>>
52928>>>        Get pbDriverDefaultNullableDateTime of ghoSQLConnectionHandler to bState
52929>>>        Function_Return bState
52930>>>    End_Function
52931>>>
52931>>>    Procedure Set pbDriverDefaultNullableNumeric Boolean bState
52933>>>        If (ghoSQLConnectionHandler = 0) Begin
52935>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52936>>>>
52936>>>            Procedure_Return
52937>>>        End
52937>>>>
52937>>>        Set pbDriverDefaultNullableNumeric of ghoSQLConnectionHandler to bState
52938>>>    End_Procedure
52939>>>
52939>>>    Function pbDriverDefaultNullableNumeric Returns Boolean
52941>>>        Boolean bState
52941>>>        If (ghoSQLConnectionHandler = 0) Begin
52943>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52944>>>>
52944>>>            Function_Return
52945>>>        End
52945>>>>
52945>>>        Get pbDriverDefaultNullableNumeric of ghoSQLConnectionHandler to bState
52946>>>        Function_Return bState
52947>>>    End_Function
52948>>>
52948>>>    Procedure Set pbDriverDefaultNullableText Boolean bState
52950>>>        If (ghoSQLConnectionHandler = 0) Begin
52952>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52953>>>>
52953>>>            Procedure_Return
52954>>>        End
52954>>>>
52954>>>        Set pbDriverDefaultNullableText of ghoSQLConnectionHandler to bState
52955>>>    End_Procedure
52956>>>
52956>>>    Function pbDriverDefaultNullableText Returns Boolean
52958>>>        Boolean bState
52958>>>        If (ghoSQLConnectionHandler = 0) Begin
52960>>>            Error DFERR_PROGRAM "ghoSQLConnectionHandler = 0! This indicates that NO SQL connection has been setup by the programmer."
52961>>>>
52961>>>            Function_Return
52962>>>        End
52962>>>>
52962>>>        Get pbDriverDefaultNullableText of ghoSQLConnectionHandler to bState
52963>>>        Function_Return bState
52964>>>    End_Function
52965>>>
52965>>>    // Note: If the psDriverID + other connection properties are to be changed,
52965>>>    //       the psDriverID *must* be the first property that gets changed!
52965>>>    //       Otherwise errors might be raised by the driver when e.g. the format
52965>>>    //       for a connection string has the wrong format for that driver.
52965>>>    Procedure Set psDriverID String sValue
52967>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
52968>>>        Delegate Set psDriverID to sValue
52970>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
52971>>>        Set psDriverID of ghoSQLConnectionHandler to sValue
52972>>>    End_Procedure
52973>>>
52973>>>    Function psDriverID Returns String
52975>>>        String sDriverID
52975>>>
52975>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
52976>>>        // This should get it from the parent object (when using the cDbUpdateHandler class)
52976>>>        Delegate Get psDriverID to sDriverID
52978>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
52979>>>        Move False to Err
52980>>>
52980>>>        // ...and in case it didn't use property of this class. Then the library is
52980>>>        // probably used as "utilites" from a special made program and
52980>>>        // the ghoSQLConnectionHandler must have been setup
52980>>>        If (sDriverID = "") Begin
52982>>>            Get psDriverID of ghoSQLConnectionHandler to sDriverID
52983>>>        End
52983>>>>
52983>>>        Function_Return sDriverID
52984>>>    End_Function
52985>>>
52985>>>    Procedure Set piDbType Integer iValue
52987>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
52988>>>        Delegate Set piDbType to iValue
52990>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
52991>>>        Set piDbType of ghoSQLConnectionHandler to iValue
52992>>>    End_Procedure
52993>>>
52993>>>    Function piDbType Returns String
52995>>>        Integer iRetval
52995>>>
52995>>>//        Move False to Err
52995>>>//        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
52995>>>        // This should get it from the parent object (when using the cDbUpdateHandler class)
52995>>>//        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
52995>>>//        Delegate Get piDbType to iRetval
52995>>>//        Set Error_Report_Mode to DUF_ERROR_REPORT
52995>>>//        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
52995>>>
52995>>>        // ...and in case it didn't use property of this class. Then the library is
52995>>>        // probably used as "utilites" from a special made program and
52995>>>        // the ghoSQLConnectionHandler must have been setup
52995>>>//        If (Err = True) Begin
52995>>>            Get piDbType of ghoSQLConnectionHandler to iRetval
52996>>>//        End
52996>>>
52996>>>//        Move False to Err
52996>>>        Function_Return iRetval
52997>>>    End_Function
52998>>>
52998>>>    Function phoLogFile Returns Handle
53000>>>        Handle hoLogFile
53000>>>
53000>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
53001>>>        Delegate Get phoLogFile to hoLogFile
53003>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
53004>>>
53004>>>        Function_Return hoLogFile
53005>>>    End_Function
53006>>>
53006>>>    Function pnCurrentVersionUpdate Returns Number
53008>>>        Number nCurrentVersionUpdate
53008>>>
53008>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
53009>>>        Delegate Get pnCurrentVersionUpdate to nCurrentVersionUpdate
53011>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
53012>>>
53012>>>        Function_Return nCurrentVersionUpdate
53013>>>    End_Function
53014>>>
53014>>>    Procedure LogError String sText Boolean bError
53016>>>        Handle hoLogFile
53016>>>        Number nCurrentVersionUpdate
53016>>>
53016>>>        Get phoLogFile to hoLogFile
53017>>>        If (hoLogFile = 0) Begin
53019>>>            Procedure_Return
53020>>>        End
53020>>>>
53020>>>        Get pnCurrentVersionUpdate to nCurrentVersionUpdate
53021>>>
53021>>>        Set Error_Report_Mode to DUF_ERROR_NO_REPORT
53022>>>        Send LogError of hoLogFile nCurrentVersionUpdate 0 sText 0 bError
53023>>>        Set Error_Report_Mode to DUF_ERROR_REPORT
53024>>>    End_Procedure
53025>>>
53025>>>    Function pbContinueOnError Returns Boolean
53027>>>        Boolean bContinueOnError
53027>>>        If (ghoDbUpdateHandler > 0) Begin
53029>>>            Get pbContinueOnError of ghoDbUpdateHandler to bContinueOnError
53030>>>        End
53030>>>>
53030>>>        Function_Return bContinueOnError
53031>>>    End_Function
53032>>>
53032>>>    Function psCollation Returns String
53034>>>        String sCollation
53034>>>        If (ghoDbUpdateHandler > 0) Begin
53036>>>            Get psCollation of ghoDbUpdateHandler to sCollation
53037>>>        End
53037>>>>
53037>>>        Function_Return sCollation
53038>>>    End_Function
53039>>>
53039>>>
53039>>>    Function StrToFieldNumber Integer iFile String sField Returns Integer
53041>>>        Integer iMax iPos
53041>>>        String sName
53041>>>
53041>>>        Move (Lowercase(sField)) to sField
53042>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iMax
53045>>>        for iPos from 0 to iMax
53051>>>>
53051>>>            Get_Attribute DF_FIELD_NAME of iFile iPos to sName
53054>>>            Move (Lowercase(sName)) to sName
53055>>>            If (sName = sField) Begin
53057>>>                Function_Return iPos
53058>>>            End
53058>>>>
53058>>>        Loop
53059>>>>
53059>>>        Function_Return -1
53060>>>    End_Function
53061>>>
53061>>>
53061>>>    // * Dummy function for the Studio's Code Explorer *
53061>>>    Function PRIVATE_SUB_FUNCTIONS Returns Boolean
53063>>>        Function_Return False
53064>>>    End_Function
53065>>>
53065>>>    // When dropping columns on some SQL back-ends they doesn't reclaim the space taken up by the columns dropped.
53065>>>    // For data types that are stored inline in the rows (int for example) it may even take up space on
53065>>>    // the new rows added after the alter statement. to get around this you need to create a clustered
53065>>>    // index on the table _or_ rebuild the clustered Index if it already has one. Rebuilding the index
53065>>>    // can be done with a REBUILD command after modifying the table. But be warned this can be slow on very big tables.
53065>>>    //   ALTER TABLE MyTable
53065>>>    //       REBUILD
53065>>>    Function _SqlUtilRemoveTableColumnMSSQL String sTableName String sColumnName Returns Boolean
53067>>>        Boolean bOK
53067>>>
53067>>>        If (Trim(sTableName) = "" or Trim(sColumnName) = "") Begin
53069>>>            Function_Return False
53070>>>        End
53070>>>>
53070>>>
53070>>>        SQLIncludeScriptFile ..\Scripts\DropConstraintAndColumnNameMSSQL.sql as DropConstraintAndColumnNameMSSQL.sql
53070>>>        Get _SqlUtilRemoveTableColumnByScript "DropConstraintAndColumnNameMSSQL.sql" sTableName sColumnName to bOK
53071>>>
53071>>>        Function_Return (bOK = True)
53072>>>    End_Function
53073>>>
53073>>>
53073>>>    // *** Helper functions with compiled sql script code ***
53073>>>    //
53073>>>    // When dropping columns SQL Sever does not reclaim the space taken up by the columns dropped.
53073>>>    // For data types that are stored inline in the rows (int for example) it may even take up space on
53073>>>    // the new rows added after the alter statement. To get around this you need to create a clustered
53073>>>    // index on the table or rebuild the clustered Index if it already has one. Rebuilding the index
53073>>>    // can be done with a REBUILD command after modifying the table. But be warned this can be slow on very big tables.
53073>>>    //   ALTER TABLE MyTable
53073>>>    //       REBUILD
53073>>>    Function _SqlUtilRemoveTableColumnByScript String sMemScriptFile String sTableName String sColumnName Returns Boolean
53075>>>        tSQLScriptArray SQLScriptArray
53075>>>        tSQLScriptArray SQLScriptArray
53075>>>        String sDriverID
53075>>>        Boolean bOK
53075>>>        Integer iSize iCount
53075>>>
53075>>>        If (Trim(sTableName) = "" or Trim(sColumnName) = "") Begin
53077>>>            Function_Return False
53078>>>        End
53078>>>>
53078>>>
53078>>>        Get psDriverID to sDriverID
53079>>>        Get SqlUtilReadResource sMemScriptFile to SQLScriptArray
53080>>>        If (SQLScriptArray.bError = True) Begin
53082>>>            Function_Return False
53083>>>        End
53083>>>>
53083>>>
53083>>>        Move (SizeOfArray(SQLScriptArray.sSQLScriptArray)) to iSize
53084>>>        Decrement iSize
53085>>>
53085>>>        for iCount from 0 to iSize
53091>>>>
53091>>>            If (SQLScriptArray.sSQLScriptArray[iCount] contains "TABLE_NAME_XXX") Begin
53093>>>                Move (Replaces("TABLE_NAME_XXX",  SQLScriptArray.sSQLScriptArray[iCount], String(sTableName))) to SQLScriptArray.sSQLScriptArray[iCount]
53094>>>            End
53094>>>>
53094>>>            If (SQLScriptArray.sSQLScriptArray[iCount] contains "COLUMN_NAME_XXX") Begin
53096>>>                Move (Replaces("COLUMN_NAME_XXX", SQLScriptArray.sSQLScriptArray[iCount], String(sColumnName))) to SQLScriptArray.sSQLScriptArray[iCount]
53097>>>            End
53097>>>>
53097>>>        Loop
53098>>>>
53098>>>
53098>>>        Get SqlUtilExecuteEmbeddedScript SQLScriptArray sDriverID False "" to bOK
53099>>>
53099>>>        Function_Return (bOK = True)
53100>>>    End_Function
53101>>>
53101>>>    // *** Helper functions for Mertech Drivers ***
53101>>>    // Created to not clutter up the standard function code with lots of #IFDEF's
53101>>>    // and commands that the Studio editor knows nothing about.
53101>>>    Function _MertechDeleteTDFile String sTableName Returns Integer
53103>>>        Integer iRetval
53103>>>        String sPath
53103>>>
53103>>>        If (sPath = "" or sTableName = "") Begin
53105>>>            Function_Return 0
53106>>>        End
53106>>>>
53106>>>
53106>>>        Get vFolderFormat sPath to sPath
53107>>>        Get vDeleteFile (sPath + String(sTableName) + ".td") to iRetval
53108>>>        Function_Return iRetval
53109>>>    End_Function
53110>>>
53110>>>    Function _MertechSqlUtilCreateIntFile Handle hTable String sDataPath String sPhysicalFileName Returns Boolean
53112>>>        Move False to Err
53113>>>        Function_Return (Err = False)
53114>>>    End_Function
53115>>>
53115>>>    Function _MertechEnumerateSQLFlexServers Returns String[]
53117>>>        Integer iNumItems iCount
53117>>>        String[] sReturnArray
53118>>>        String sServer
53118>>>
53118>>>
53118>>>        Function_Return sReturnArray
53119>>>    End_Function
53120>>>
53120>>>    Function _MertechEnumerateORAFLEXServers Returns String[]
53122>>>        String[] sReturnArray
53123>>>        String sServer
53123>>>
53123>>>
53123>>>        Function_Return sReturnArray
53124>>>    End_Function
53125>>>
53125>>>    Function _MertechSQLConnect String sDriverID String sServer String sUserID String sPassword Returns Handle
53127>>>        Handle hoSQLHandler hoSQLConnect
53127>>>
53127>>>        Move 0 to hoSQLConnect
53128>>>
53128>>>        Function_Return hoSQLConnect
53129>>>    End_Function
53130>>>
53130>>>    // Returns the handle of the Mertech SQL handler.
53130>>>    // It also ensures that the correct Server & Database attributes are set both for
53130>>>    // embedded SQL calls and "normal" database commands like e.g. "Open".
53130>>>    Function _MertechSQLManagerHandle Returns Handle
53132>>>        Handle hoSQLHandler
53132>>>        String sDriverID sServer sDatabase
53132>>>
53132>>>        Move 0 to hoSQLHandler
53133>>>        Get psDriverID to sDriverID
53134>>>        Get psServer   to sServer
53135>>>        Get psDatabase to sDatabase
53136>>>
53136>>>        Function_Return hoSQLHandler
53137>>>    End_Function
53138>>>
53138>>>    // For Mertech drivers we cannot use Structure_Start/End. Instead we must use
53138>>>    // macro-commands <sigh!>
53138>>>    // Note: The function sets the Err flag.
53138>>>    Function _MertechApiTableConvertToSQL Handle hTable String sRootName String sDatabase String sDriverID String sBaseTableSpace String sIndexTableSpace Boolean bCopyData Returns Boolean
53140>>>        Move False to Err
53141>>>
53141>>>
53141>>>        Function_Return (Err = False)
53142>>>    End_Function
53143>>>
53143>>>End_Class
53144>Use cHeaderGroup.pkg
Including file: cHeaderGroup.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cHeaderGroup.pkg)
53144>>>Use Windows.pkg
53144>>>
53144>>>Use cCommandLinkButton.pkg
Including file: cCommandLinkButton.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\cCommandLinkButton.pkg)
53144>>>>>// cCommandLinkButton class
53144>>>>>
53144>>>>>// This requires version 6 of common controls (vista or windows server 2008). If used with
53144>>>>>// older versions you will just get a regular great big button.
53144>>>>> 
53144>>>>>Use Windows.pkg
53144>>>>>Use CharTranslate.pkg
Including file: CharTranslate.pkg    (C:\Program Files (x86)\DataFlex 19.0\Pkg\CharTranslate.pkg)
53144>>>>>>>//*************************************************************************
53144>>>>>>>//*
53144>>>>>>>//*  Copyright (c) 2001 Data Access Corporation, Miami Florida,
53144>>>>>>>//*  All rights reserved.
53144>>>>>>>//*  DataFlex is a registered trademark of Data Access Corporation.
53144>>>>>>>//*
53144>>>>>>>//*************************************************************************
53144>>>>>>>//*
53144>>>>>>>//*  Module Name:
53144>>>>>>>//*      CharTranslate.pkg
53144>>>>>>>//*
53144>>>>>>>//*  Creator:
53144>>>>>>>//*      SF
53144>>>>>>>//*
53144>>>>>>>//*
53144>>>>>>>//*  Purpose:
53144>>>>>>>//*      Various global functions to translate OEM to UTF.
53144>>>>>>>//*
53144>>>>>>>//*************************************************************************
53144>>>>>>>
53144>>>>>>>Use VdfBase.pkg
53144>>>>>>>
53144>>>>>>>
53144>>>>>>>External_Function32 MultiByteToWideChar "MultiByteToWideChar" kernel32.dll;    DWord dwCodePage;    DWord dwFlags;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pWideStr;    Integer cchWideChar;    Returns Integer
53145>>>>>>>
53145>>>>>>>External_Function32 WideCharToMultiByte "WideCharToMultiByte" kernel32.dll;    DWord dwCodePage;    DWord dwFlags;    Pointer pWideStr;    Integer cchWideChar;    Pointer pMultiByteStr;    Integer cbMultiByte;    Pointer pDefaultChar;    Pointer pUsedDefaultChar;    Returns Integer
53146>>>>>>>
53146>>>>>>>//dwCodePage = Multi Byte Code Page to convert from
53146>>>>>>>//pMultiBuf  = Pointer to Multi Byte string
53146>>>>>>>//iLen       = Length in bytes of Multi Byte string
53146>>>>>>>//ppWideBuf  = Contents of ppWideBuf contains a pointer to the destination buffer on return
53146>>>>>>>Function MultiToWideBuffer Global DWord dwCodePage Address pMultiBuf Integer iLen Address ppWideBuf Returns Integer
53148>>>>>>>    Integer iWideSize
53148>>>>>>>    Integer iVoid
53148>>>>>>>    Address pWideBuf
53148>>>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,0,0)) to iWideSize
53149>>>>>>>    If (iWideSize=0);        Function_Return 0
53152>>>>>>>    Move (Alloc((iWideSize+1)*2)) to pWideBuf
53153>>>>>>>    If (pWideBuf=0);        Function_Return 0
53156>>>>>>>    Move (MultiByteToWideChar(dwCodePage,0,pMultiBuf,iLen,pWideBuf,iWideSize)) to iWideSize
53157>>>>>>>    If (iWideSize=0) ;        Move (Free(pWideBuf)) to iVoid
53160>>>>>>>    Else Begin
53161>>>>>>>        Move (StoreW(pWideBuf,(iWideSize*2),0)) to iVoid
53162>>>>>>>        Move (StoreDW(ppWideBuf,0,pWideBuf)) to iVoid
53163>>>>>>>    End
53163>>>>>>>>
53163>>>>>>>    Function_Return iWideSize
53164>>>>>>>End_Function
53165>>>>>>>
53165>>>>>>>//dwCodePage = Multi Byte Code Page to convert to
53165>>>>>>>//pWideBuf   = Pointer to Wide Character string
53165>>>>>>>//iLen       = Length in characters of Wide Character string
53165>>>>>>>//ppMultiBuf = Contents of ppMultiBuf contains a pointer to the destination buffer on return
53165>>>>>>>Function WideToMultiBuffer Global DWord dwCodePage Address pWideBuf Integer iLen Address ppMultiBuf Returns Integer
53167>>>>>>>    Integer iMultiSize
53167>>>>>>>    Address pMultiBuf
53167>>>>>>>    Integer iVoid
53167>>>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,0,0,0,0)) to iMultiSize
53168>>>>>>>    If (iMultiSize=0);        Function_Return 0
53171>>>>>>>    Move (Alloc(iMultiSize+1)) to pMultiBuf
53172>>>>>>>    If (pMultiBuf=0);        Function_Return 0
53175>>>>>>>    Move (WideCharToMultiByte(dwCodePage,0,pWideBuf,iLen,pMultiBuf,iMultiSize,0,0)) to iMultiSize
53176>>>>>>>    If (iMultiSize=0) ;        Move (Free(pMultiBuf)) to iVoid
53179>>>>>>>    Else Begin
53180>>>>>>>        Move (StoreC(pMultiBuf,iMultiSize,0)) to iVoid
53181>>>>>>>        Move (StoreDW(ppMultiBuf,0,pMultiBuf)) to iVoid
53182>>>>>>>    End
53182>>>>>>>>
53182>>>>>>>    Function_Return iMultiSize
53183>>>>>>>End_Function
53184>>>>>>>
53184>>>>>>>//Converts a UTF-8 string to OEM
53184>>>>>>>//pUtf8Buf   = Pointer to UTF-8 string
53184>>>>>>>//iLen       = Length of UTF-8 string in bytes
53184>>>>>>>//Returns pointer to OEM string, use free() to deallocate buffer when it's no longer needed
53184>>>>>>>Function Utf8ToOemBuffer Global Address pUtf8Buf Integer iLen Returns Address
53186>>>>>>>    Address pWideBuf
53186>>>>>>>    Address pOemBuf
53186>>>>>>>    Integer iWideBufLen
53186>>>>>>>    Integer iMultiBufLen
53186>>>>>>>    Integer iVoid
53186>>>>>>>    Move 0 to pWideBuf
53187>>>>>>>    Move 0 to pOemBuf
53188>>>>>>>    Move (MultiToWideBuffer(CP_UTF8,pUtf8Buf,iLen,AddressOf(pWideBuf))) to iWideBufLen
53189>>>>>>>    If (iWideBufLen=0);        Function_Return 0
53192>>>>>>>    Move (WideToMultiBuffer(CP_OEMCP,pWideBuf,iWideBufLen,AddressOf(pOemBuf))) to iMultiBufLen
53193>>>>>>>    Move (Free(pWideBuf)) to iVoid
53194>>>>>>>    Function_Return pOemBuf
53195>>>>>>>End_Function
53196>>>>>>>
53196>>>>>>>//Converts a OEM string to UTF-8
53196>>>>>>>//pOemBuf    = Pointer to OEM string
53196>>>>>>>//iLen       = Length of OEM string in bytes
53196>>>>>>>//Returns pointer to UTF-8 string, use free() to deallocate buffer when it's no longer needed
53196>>>>>>>Function OemToUtf8Buffer Global Address pOemBuf Integer iLen Returns Address
53198>>>>>>>    Address pWideBuf
53198>>>>>>>    Address pUtf8Buf
53198>>>>>>>    Integer iWideBufLen
53198>>>>>>>    Integer iMultiBufLen
53198>>>>>>>    Integer iVoid
53198>>>>>>>    Move 0 to pWideBuf
53199>>>>>>>    Move 0 to pUtf8Buf
53200>>>>>>>    Move (MultiToWideBuffer(CP_OEMCP,pOemBuf,iLen,AddressOf(pWideBuf))) to iWideBufLen
53201>>>>>>>    If (iWideBufLen=0);        Function_Return 0
53204>>>>>>>    Move (WideToMultiBuffer(CP_UTF8,pWideBuf,iWideBufLen,AddressOf(pUtf8Buf))) to iMultiBufLen
53205>>>>>>>    Move (Free(pWideBuf)) to iVoid
53206>>>>>>>    Function_Return pUtf8Buf
53207>>>>>>>End_Function
53208>>>>>>>
53208>>>>>>>
53208>>>>>>>//Converts a OEM string to UTF-16
53208>>>>>>>//pOemBuf    = Pointer to OEM string
53208>>>>>>>//iLen       = Length of OEM string in bytes
53208>>>>>>>//Returns pointer to UTF-16 string, use free() to deallocate buffer when it's no longer needed
53208>>>>>>>Function OemToUtf16Buffer Global Address pOemBuf Integer iLen Returns Address
53210>>>>>>>    Address pWideBuf
53210>>>>>>>    Integer iWideBufLen
53210>>>>>>>    Move 0 to pWideBuf
53211>>>>>>>    Move (MultiToWideBuffer(CP_OEMCP,pOemBuf,iLen,AddressOf(pWideBuf))) to iWideBufLen
53212>>>>>>>    If (iWideBufLen=0) Begin
53214>>>>>>>        Function_Return 0
53215>>>>>>>    End
53215>>>>>>>>
53215>>>>>>>    Function_Return pWideBuf
53216>>>>>>>End_Function
53217>>>>>>>
53217>>>>>>>//Converts a UTF-16 string to OEM
53217>>>>>>>//pWideBuf     = Pointer to UTF-16 string
53217>>>>>>>//iWideBufLen  = Length of UTF-16 in characters
53217>>>>>>>//Returns pointer to OEM string, use free() to deallocate buffer when it's no longer needed
53217>>>>>>>Function Utf16ToOemBuffer Global Address pWideBuf Integer iWideBufLen Returns Address
53219>>>>>>>    Address pOemBuf
53219>>>>>>>    Integer iMultiBufLen
53219>>>>>>>    Move 0 to pOemBuf
53220>>>>>>>    Move (WideToMultiBuffer(CP_OEMCP,pWideBuf,iWideBufLen,AddressOf(pOemBuf))) to iMultiBufLen
53221>>>>>>>    If (iMultiBufLen=0) Begin
53223>>>>>>>        Function_Return 0
53224>>>>>>>    End
53224>>>>>>>>
53224>>>>>>>    Function_Return pOemBuf
53225>>>>>>>End_Function
53226>>>>>>>
53226>>>>>
53226>>>>>Class cCommandLinkButton is a Button
53227>>>>>
53227>>>>>        Procedure Construct_Object
53229>>>>>            Forward Send Construct_Object
53231>>>>>            Property String psPrivateNote
53232>>>>>        End_Procedure
53233>>>>>        
53233>>>>>        Procedure Set psNote String sNote
53235>>>>>            Boolean bSupported
53235>>>>>            Set psPrivateNote to sNote
53236>>>>>            Get IsExControlSupported to bSupported
53237>>>>>            If bSupported Begin
53239>>>>>                Send SetWinNote
53240>>>>>            End
53240>>>>>>
53240>>>>>        End_Procedure
53241>>>>>        
53241>>>>>        Procedure SetWinNote
53243>>>>>            String sNote
53243>>>>>            Handle hWnd
53243>>>>>            Integer i
53243>>>>>            Address aVar
53243>>>>>            Get Form_Window_Handle 0 to hWnd
53244>>>>>            If hWnd Begin
53246>>>>>                Get psNote to sNote
53247>>>>>                Move (OemToUtf16Buffer(AddressOf(sNote),Length(sNote))) to aVar
53248>>>>>                Move (SendMessage(hwnd, BCM_SETNOTE, 0, aVar)) to i
53249>>>>>                Move (Free(aVar)) to i 
53250>>>>>            End
53250>>>>>>
53250>>>>>        End_Procedure
53251>>>>>        
53251>>>>>        
53251>>>>>        Function psNote Returns String
53253>>>>>            Function_Return (psPrivateNote(Self))
53254>>>>>        End_Function
53255>>>>>        
53255>>>>>
53255>>>>>        Procedure Page Integer iState
53257>>>>>            Integer i hWnd
53257>>>>>            Boolean bSupported
53257>>>>>            Get IsExControlSupported to bSupported
53258>>>>>            If (iState=1 and bSupported) Begin
53260>>>>>                Get form_style i to i
53261>>>>>                Set Form_Style 0 to (i ior (BS_COMMANDLINK + BS_FLAT))
53262>>>>>                Forward Send Page iState
53264>>>>>                Send SetWinNote
53265>>>>>            End
53265>>>>>>
53265>>>>>            Else Begin
53266>>>>>                Forward Send Page iState
53268>>>>>            End
53268>>>>>>
53268>>>>>        End_Procedure        
53269>>>>>
53269>>>>>End_Class
53270>>>Class cHeaderGroupImage is a cCommandLinkButton
53271>>>    Procedure Construct_Object
53273>>>        Forward Send Construct_Object
53275>>>            Set piImageSize to 24
53276>>>        Set Focus_Mode to NonFocusable
53277>>>    End_Procedure
53278>>>
53278>>>
53278>>>    Procedure OnClick
53280>>>        Broadcast Send Prompt of (Parent(Self))
53282>>>    End_Procedure
53283>>>
53283>>>    Procedure Set Bitmap String sBitmapName
53285>>>        Forward Set psImage to sBitmapName
53287>>>    End_Procedure
53288>>>
53288>>>    Procedure End_Construct_Object
53290>>>        Forward Send End_Construct_Object
53292>>>    End_Procedure
53293>>>
53293>>>End_Class
53294>>>
53294>>>// Intermediate class - don't use.
53294>>>Class _cHeaderGroup is a Container3d
53295>>>
53295>>>    Register_Object oInfo_tb
53295>>>
53295>>>    Procedure Construct_Object
53297>>>        Forward Send Construct_Object
53299>>>
53299>>>        Property String private.psImage
53300>>>        Property String private.psLabel
53301>>>    End_Procedure
53302>>>
53302>>>    Procedure Set psImage String sImage
53304>>>        Set private.psImage to sImage
53305>>>    End_Procedure
53306>>>
53306>>>    Function psImage Returns String
53308>>>        Function_Return (private.psImage(Self))
53309>>>    End_Function
53310>>>
53310>>>    Procedure Set psLabel String sLabel
53312>>>        Set private.psLabel to sLabel
53313>>>    End_Procedure
53314>>>
53314>>>    Function psLabel Returns String
53316>>>        Function_Return (private.psLabel(Self))
53317>>>    End_Function
53318>>>
53318>>>    // Don't display but allow to use old "Label" syntax to set the value of the oInfo_tb object (header text)
53318>>>    Procedure Set Label String sLabel
53320>>>        Set private.psLabel to sLabel
53321>>>        Set Label of oInfo_tb to sLabel
53322>>>    End_Procedure
53323>>>
53323>>>    Function Label Returns String
53325>>>        Function_Return (private.psLabel(Self))
53326>>>    End_Function
53327>>>
53327>>>End_Class
53328>>>
53328>>>Class cHeaderGroup is a _cHeaderGroup
53329>>>
53329>>>    Procedure Construct_Object
53331>>>        Forward Send Construct_Object
53333>>>
53333>>>        Set peAnchors to anTopLeftRight
53334>>>        //Set Color to clWhite
53334>>>        Set pbAcceptDropFiles to True
53335>>>        Set Border_Style to Border_Normal
53336>>>
53336>>>        Property Integer private.piColorOrg
53337>>>        Property Boolean private.pbIsHeaderGroup True // Don't touch!
53338>>>
53338>>>            Property Integer piBitmapColOffset 4
53339>>>            Property Integer piBitmapRowOffset 1
53340>>>
53340>>>        Property Boolean pbUseHotspotColor True
53341>>>        Property Integer piHeaderHotspotColor clAqua
53342>>>        Property String psLabel ""
53343>>>        Property Integer piLabelColor clBlack
53344>>>        Property Boolean pbLabelFontItalics False
53345>>>        Property Integer piLabelFontPointHeight False
53346>>>        Property Integer piLabelFontPointWeight fw_Bold
53347>>>        Property Integer piLabelColOffset 25
53348>>>        Property Integer piLabelRowOffset 3 //4
53349>>>
53349>>>    End_Procedure
53350>>>
53350>>>    Procedure End_Construct_Object
53352>>>
53352>>>        Object oImage_bmp is a cHeaderGroupImage
53354>>>            Set Location to (piBitmapRowOffset(Self)) (piBitmapColOffset(Self))
53355>>>                Set Size to 14 18
53356>>>            Set Bitmap to (private.psImage(Self))
53357>>>        End_Object
53358>>>
53358>>>        Object oInfo_tb is a TextBox
53360>>>            Set Auto_Size_State to False
53361>>>            Set Size to 10 150
53362>>>            Set Location to (piLabelRowOffset(Self)) (piLabelColOffset(Self))
53363>>>            Set FontWeight to (piLabelFontPointWeight(Self))
53364>>>            Set FontItalics to (pbLabelFontItalics(Self))
53365>>>            Set FontPointHeight to (piLabelFontPointHeight(Self))
53366>>>            Set Label to (psLabel(Self))
53367>>>            Set TextColor to (piLabelColor(Self))
53368>>>        End_Object
53369>>>
53369>>>        Forward Send End_Construct_Object
53371>>>    End_Procedure
53372>>>
53372>>>    Procedure OnEnterArea Handle hoFrom
53374>>>        Integer iColor
53374>>>        Forward Send OnEnterArea hoFrom
53376>>>        // ToDo: Not perfect, but works most of the time.
53376>>>        //       When navigating to i.e a popup we don't want
53376>>>        //       the coloring to appear. Else there will be 2
53376>>>        //       cHeaderGroup's with the highlight color...
53376>>>        // Is there a better way?
53376>>>        If (hoFrom <> Desktop and hoFrom < Parent(Self)) Begin
53378>>>            Procedure_Return
53379>>>        End
53379>>>>
53379>>>        If (pbUseHotspotColor(Self) = True) Begin
53381>>>            Get Color to iColor
53382>>>            Set private.piColorOrg to iColor
53383>>>            Get piHeaderHotspotColor to iColor
53384>>>            Set Color to iColor
53385>>>            Broadcast Recursive Set Color to iColor
53387>>>        End
53387>>>>
53387>>>    End_Procedure
53388>>>
53388>>>    Procedure OnExitArea Handle hoFrom
53390>>>        Integer iColor
53390>>>        Forward Send OnExitArea hoFrom
53392>>>        If (pbUseHotspotColor(Self) = True) Begin
53394>>>            Get private.piColorOrg to iColor
53395>>>            Set Color to iColor
53396>>>            Broadcast Recursive Set Color to iColor
53398>>>        End
53398>>>>
53398>>>    End_Procedure
53399>>>
53399>>>    // Public access message to change the group header text color at runtime.
53399>>>    Procedure Set Label_Color Integer iColor
53401>>>        Set TextColor of oInfo_tb to iColor
53402>>>    End_Procedure
53403>>>
53403>>>    Procedure NavigatePrevious
53405>>>        Integer iMulti ivoid
53405>>>        Handle hWnd
53405>>>
53405>>>        Move False to Err
53406>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
53407>>>        Get Select_Mode of (Focus(Self)) to iMulti
53408>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
53409>>>        If (Err) Begin
53411>>>            Procedure_Return
53412>>>        End
53412>>>>
53412>>>
53412>>>        If (iMulti = Multi_Select) Begin
53414>>>            Send Previous
53415>>>        End
53415>>>>
53415>>>        Else Begin
53416>>>            Get Form_Window_Handle of (Focus(Self)) to hWnd
53417>>>            Move (Sendmessage(hWnd,WM_KEYDOWN,Ascii(VK_LEFT),0)) to iVoid
53418>>>        End
53418>>>>
53418>>>    End_Procedure
53419>>>
53419>>>    Procedure NavigateNext
53421>>>        Integer iMulti ivoid
53421>>>        Handle hWnd
53421>>>
53421>>>        Move False to Err
53422>>>        Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
53423>>>        Get Select_Mode of (Focus(Self)) to iMulti
53424>>>        Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
53425>>>        If (Err) Begin
53427>>>            Procedure_Return
53428>>>        End
53428>>>>
53428>>>
53428>>>        If (iMulti = Multi_Select) Begin
53430>>>            Send Next
53431>>>        End
53431>>>>
53431>>>        Else Begin
53432>>>            Get Form_Window_Handle of (Focus(Self)) to hWnd
53433>>>            Move (Sendmessage(hWnd,WM_KEYDOWN,Ascii(VK_LEFT),0)) to iVoid
53434>>>        End
53434>>>>
53434>>>
53434>>>    End_Procedure
53435>>>
53435>>>    On_Key kLeftArrow  Send NavigatePrevious
53436>>>    On_Key kRightArrow Send NavigateNext
53437>>>End_Class
53438>>>
53438>>>// We don't want the broadcast of setting color to set the background
53438>>>// color for forms that are within a cHeaderGroup object.
53438>>>Procedure Set Color for Form Integer eColor
53440>>>    Boolean bIsHeaderGroup
53440>>>    Send Ignore_Error of Error_Object_Id DFERR_BAD_MESSAGE
53441>>>    Delegate Get private.pbIsHeaderGroup to bIsHeaderGroup
53443>>>    Send Trap_Error of Error_Object_Id DFERR_BAD_MESSAGE
53444>>>    If (bIsHeaderGroup = False) Begin
53446>>>        Forward Set Color to eColor
53448>>>    End
53448>>>>
53448>>>End_Procedure
53449>>>
53449>Use cSQLComboForm.pkg
Including file: cSQLComboForm.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\cSQLComboForm.pkg)
53449>>>Use Windows.pkg
53449>>>
53449>>>// Used by the "Page" message below to show
53449>>>// a rectangle around ComboForm and Checkbox objects.
53449>>>    Define WM_CHANGEUISTATE for |CI$0127
53449>>>    Define WM_UPDATEUISTATE for |CI$0128
53449>>>    Define WM_QUERYUISTATE  for |CI$0129
53449>>>    Define UIS_SET          for 1
53449>>>    Define UIS_CLEAR        for 2
53449>>>    Define UIS_INITIALIZE   for 3
53449>>>    Define UISF_HIDEFOCUS   for |CI$1
53449>>>    Define UISF_HIDEACCEL   for |CI$2
53449>>>    Define UISF_ACTIVE      for |CI$4
53449>>>
53449>>>Class cSQLComboForm is a ComboForm
53450>>>    Procedure Construct_Object
53452>>>        Forward Send Construct_Object
53454>>>
53454>>>        // This will shadow the label if the form itself has its Enabled_State=False
53454>>>        Property Boolean pbAutoShadowLabelObject True
53455>>>
53455>>>        // The piItem should be set to the object's corresponding tSQLConnection member (One based)
53455>>>        Property Integer piItem
53456>>>    End_Procedure
53457>>>
53457>>>    Procedure End_Construct_Object
53459>>>        Boolean bAutoShadowLabelObject
53459>>>        Get pbAutoShadowLabelObject to bAutoShadowLabelObject
53460>>>        If (bAutoShadowLabelObject = True) Begin
53462>>>            Set Private.Label_Shadow_Display_Mode to TBSHADOW_ON_LOCAL
53463>>>        End
53463>>>>
53463>>>        Forward Send End_Construct_Object
53465>>>    End_Procedure
53466>>>
53466>>>    Procedure DbTypeUpdate Integer iDbType String sDriverID
53468>>>    End_Procedure
53469>>>
53469>>>    Procedure ReadConnectionData String[] sConnectionData
53471>>>        Integer iItem
53471>>>        Get piItem to iItem
53472>>>        Set Value to sConnectionData[iItem]
53473>>>    End_Procedure
53474>>>
53474>>>    Procedure WriteConnectionData String[] ByRef sConnectionData
53476>>>        String sValue
53476>>>        Integer iItem
53476>>>        Get piItem to iItem
53477>>>        Get Value to sValue
53478>>>        Move sValue to sConnectionData[iItem]
53479>>>    End_Procedure
53480>>>
53480>>>    Procedure Set psToolTip String sToolTip
53482>>>        String sStatusHelp
53482>>>
53482>>>        Get Status_Help to sStatusHelp
53483>>>        If (sStatusHelp = "") Begin
53485>>>            Set Status_Help to sToolTip
53486>>>        End
53486>>>>
53486>>>
53486>>>        Forward Set psToolTip to sToolTip
53488>>>    End_Function
53489>>>
53489>>>    // Fix for a bug when using manifest files & running Vista and above.
53489>>>    // The bug being that the focus rectangle doesn't show.
53489>>>    Procedure Page Integer iPageObject
53491>>>        Handle hWnd
53491>>>        Integer iRet iState
53491>>>
53491>>>        Forward Send Page iPageObject
53493>>>
53493>>>        If (iPageObject) Begin
53495>>>            Get Window_Handle to hWnd
53496>>>            If (hWnd) Begin
53498>>>                Move (SendMessage(hWnd, WM_QUERYUISTATE, 0, 0)) to iRet
53499>>>                If (iRet iand UISF_HIDEFOCUS) Begin
53501>>>                    Move (UIS_CLEAR + (UISF_HIDEFOCUS * 65536)) to iState
53502>>>                    Move (SendMessage(hWnd, WM_UPDATEUISTATE, iState, 0)) to iRet
53503>>>                End
53503>>>>
53503>>>            End
53503>>>>
53503>>>        End
53503>>>>
53503>>>    End_Procedure
53504>>>
53504>>>End_Class
53505>Use ChilkatXML-9.5.0-win32.pkg
Including file: ChilkatXML-9.5.0-win32.pkg    (C:\Projects\DF18\DbUpdateFramework\AppSrc\ChilkatXML-9.5.0-win32.pkg)
53505>>>Use FlexCom20.pkg
53505>>>
53505>>>// CLSID: {2077C1B5-FBD0-40DF-B7AA-E07CBA589CB0}
53505>>>// IChilkatXml Interface v9.5.0
53505>>>Class cComIChilkatXml is a Mixin
53506>>>
53506>>>    Function ComGetImplAddrStr Returns String
53508>>>        Handle hDispatchDriver
53508>>>        String retVal
53508>>>        Get phDispatchDriver to hDispatchDriver
53509>>>        Get InvokeComMethod of hDispatchDriver 99 OLE_VT_BSTR to retVal
53510>>>        Function_Return retVal
53511>>>    End_Function
53512>>>
53512>>>    Function ComLastErrorHtml Returns String
53514>>>        Handle hDispatchDriver
53514>>>        String retVal
53514>>>        Get phDispatchDriver to hDispatchDriver
53515>>>        Get InvokeComMethod of hDispatchDriver 1 OLE_VT_BSTR to retVal
53516>>>        Function_Return retVal
53517>>>    End_Function
53518>>>
53518>>>    Function ComLastErrorText Returns String
53520>>>        Handle hDispatchDriver
53520>>>        String retVal
53520>>>        Get phDispatchDriver to hDispatchDriver
53521>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BSTR to retVal
53522>>>        Function_Return retVal
53523>>>    End_Function
53524>>>
53524>>>    Function ComLastErrorXml Returns String
53526>>>        Handle hDispatchDriver
53526>>>        String retVal
53526>>>        Get phDispatchDriver to hDispatchDriver
53527>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_BSTR to retVal
53528>>>        Function_Return retVal
53529>>>    End_Function
53530>>>
53530>>>    Function ComVersion Returns String
53532>>>        Handle hDispatchDriver
53532>>>        String retVal
53532>>>        Get phDispatchDriver to hDispatchDriver
53533>>>        Get InvokeComMethod of hDispatchDriver 4 OLE_VT_BSTR to retVal
53534>>>        Function_Return retVal
53535>>>    End_Function
53536>>>
53536>>>    Function ComDebugLogFilePath Returns String
53538>>>        Handle hDispatchDriver
53538>>>        String retVal
53538>>>        Get phDispatchDriver to hDispatchDriver
53539>>>        Get InvokeComMethod of hDispatchDriver 5 OLE_VT_BSTR to retVal
53540>>>        Function_Return retVal
53541>>>    End_Function
53542>>>
53542>>>    Procedure Set ComDebugLogFilePath String value
53544>>>        Handle hDispatchDriver
53544>>>        Get phDispatchDriver to hDispatchDriver
53545>>>        Send PrepareParams to hDispatchDriver 1
53546>>>        Set ComProperty of hDispatchDriver 5 OLE_VT_BSTR to value
53547>>>    End_Procedure
53548>>>
53548>>>    Function ComVerboseLogging Returns Integer
53550>>>        Handle hDispatchDriver
53550>>>        Integer retVal
53550>>>        Get phDispatchDriver to hDispatchDriver
53551>>>        Get InvokeComMethod of hDispatchDriver 6 OLE_VT_I4 to retVal
53552>>>        Function_Return retVal
53553>>>    End_Function
53554>>>
53554>>>    Procedure Set ComVerboseLogging Integer value
53556>>>        Handle hDispatchDriver
53556>>>        Get phDispatchDriver to hDispatchDriver
53557>>>        Send PrepareParams to hDispatchDriver 1
53558>>>        Set ComProperty of hDispatchDriver 6 OLE_VT_I4 to value
53559>>>    End_Procedure
53560>>>
53560>>>    Function ComLastMethodSuccess Returns Integer
53562>>>        Handle hDispatchDriver
53562>>>        Integer retVal
53562>>>        Get phDispatchDriver to hDispatchDriver
53563>>>        Get InvokeComMethod of hDispatchDriver 9 OLE_VT_I4 to retVal
53564>>>        Function_Return retVal
53565>>>    End_Function
53566>>>
53566>>>    Procedure Set ComLastMethodSuccess Integer value
53568>>>        Handle hDispatchDriver
53568>>>        Get phDispatchDriver to hDispatchDriver
53569>>>        Send PrepareParams to hDispatchDriver 1
53570>>>        Set ComProperty of hDispatchDriver 9 OLE_VT_I4 to value
53571>>>    End_Procedure
53572>>>
53572>>>    Function ComLastStringResult Returns String
53574>>>        Handle hDispatchDriver
53574>>>        String retVal
53574>>>        Get phDispatchDriver to hDispatchDriver
53575>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_BSTR to retVal
53576>>>        Function_Return retVal
53577>>>    End_Function
53578>>>
53578>>>    Function ComLastBinaryResult Returns Variant
53580>>>        Handle hDispatchDriver
53580>>>        Variant retVal
53580>>>        Get phDispatchDriver to hDispatchDriver
53581>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_VARIANT to retVal
53582>>>        Function_Return retVal
53583>>>    End_Function
53584>>>
53584>>>    Function ComLastStringResultLen Returns Integer
53586>>>        Handle hDispatchDriver
53586>>>        Integer retVal
53586>>>        Get phDispatchDriver to hDispatchDriver
53587>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_I4 to retVal
53588>>>        Function_Return retVal
53589>>>    End_Function
53590>>>
53590>>>    Function ComCdata Returns Integer
53592>>>        Handle hDispatchDriver
53592>>>        Integer retVal
53592>>>        Get phDispatchDriver to hDispatchDriver
53593>>>        Get InvokeComMethod of hDispatchDriver 100 OLE_VT_I4 to retVal
53594>>>        Function_Return retVal
53595>>>    End_Function
53596>>>
53596>>>    Procedure Set ComCdata Integer value
53598>>>        Handle hDispatchDriver
53598>>>        Get phDispatchDriver to hDispatchDriver
53599>>>        Send PrepareParams to hDispatchDriver 1
53600>>>        Set ComProperty of hDispatchDriver 100 OLE_VT_I4 to value
53601>>>    End_Procedure
53602>>>
53602>>>    Function ComContent Returns String
53604>>>        Handle hDispatchDriver
53604>>>        String retVal
53604>>>        Get phDispatchDriver to hDispatchDriver
53605>>>        Get InvokeComMethod of hDispatchDriver 101 OLE_VT_BSTR to retVal
53606>>>        Function_Return retVal
53607>>>    End_Function
53608>>>
53608>>>    Procedure Set ComContent String value
53610>>>        Handle hDispatchDriver
53610>>>        Get phDispatchDriver to hDispatchDriver
53611>>>        Send PrepareParams to hDispatchDriver 1
53612>>>        Set ComProperty of hDispatchDriver 101 OLE_VT_BSTR to value
53613>>>    End_Procedure
53614>>>
53614>>>    Function ComContentInt Returns Integer
53616>>>        Handle hDispatchDriver
53616>>>        Integer retVal
53616>>>        Get phDispatchDriver to hDispatchDriver
53617>>>        Get InvokeComMethod of hDispatchDriver 102 OLE_VT_I4 to retVal
53618>>>        Function_Return retVal
53619>>>    End_Function
53620>>>
53620>>>    Procedure Set ComContentInt Integer value
53622>>>        Handle hDispatchDriver
53622>>>        Get phDispatchDriver to hDispatchDriver
53623>>>        Send PrepareParams to hDispatchDriver 1
53624>>>        Set ComProperty of hDispatchDriver 102 OLE_VT_I4 to value
53625>>>    End_Procedure
53626>>>
53626>>>    Function ComDocType Returns String
53628>>>        Handle hDispatchDriver
53628>>>        String retVal
53628>>>        Get phDispatchDriver to hDispatchDriver
53629>>>        Get InvokeComMethod of hDispatchDriver 103 OLE_VT_BSTR to retVal
53630>>>        Function_Return retVal
53631>>>    End_Function
53632>>>
53632>>>    Procedure Set ComDocType String value
53634>>>        Handle hDispatchDriver
53634>>>        Get phDispatchDriver to hDispatchDriver
53635>>>        Send PrepareParams to hDispatchDriver 1
53636>>>        Set ComProperty of hDispatchDriver 103 OLE_VT_BSTR to value
53637>>>    End_Procedure
53638>>>
53638>>>    Function ComEmitXmlDecl Returns Integer
53640>>>        Handle hDispatchDriver
53640>>>        Integer retVal
53640>>>        Get phDispatchDriver to hDispatchDriver
53641>>>        Get InvokeComMethod of hDispatchDriver 104 OLE_VT_I4 to retVal
53642>>>        Function_Return retVal
53643>>>    End_Function
53644>>>
53644>>>    Procedure Set ComEmitXmlDecl Integer value
53646>>>        Handle hDispatchDriver
53646>>>        Get phDispatchDriver to hDispatchDriver
53647>>>        Send PrepareParams to hDispatchDriver 1
53648>>>        Set ComProperty of hDispatchDriver 104 OLE_VT_I4 to value
53649>>>    End_Procedure
53650>>>
53650>>>    Function ComEncoding Returns String
53652>>>        Handle hDispatchDriver
53652>>>        String retVal
53652>>>        Get phDispatchDriver to hDispatchDriver
53653>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_BSTR to retVal
53654>>>        Function_Return retVal
53655>>>    End_Function
53656>>>
53656>>>    Procedure Set ComEncoding String value
53658>>>        Handle hDispatchDriver
53658>>>        Get phDispatchDriver to hDispatchDriver
53659>>>        Send PrepareParams to hDispatchDriver 1
53660>>>        Set ComProperty of hDispatchDriver 105 OLE_VT_BSTR to value
53661>>>    End_Procedure
53662>>>
53662>>>    Function ComNumAttributes Returns Integer
53664>>>        Handle hDispatchDriver
53664>>>        Integer retVal
53664>>>        Get phDispatchDriver to hDispatchDriver
53665>>>        Get InvokeComMethod of hDispatchDriver 106 OLE_VT_I4 to retVal
53666>>>        Function_Return retVal
53667>>>    End_Function
53668>>>
53668>>>    Function ComNumChildren Returns Integer
53670>>>        Handle hDispatchDriver
53670>>>        Integer retVal
53670>>>        Get phDispatchDriver to hDispatchDriver
53671>>>        Get InvokeComMethod of hDispatchDriver 107 OLE_VT_I4 to retVal
53672>>>        Function_Return retVal
53673>>>    End_Function
53674>>>
53674>>>    Function ComSortCaseInsensitive Returns Integer
53676>>>        Handle hDispatchDriver
53676>>>        Integer retVal
53676>>>        Get phDispatchDriver to hDispatchDriver
53677>>>        Get InvokeComMethod of hDispatchDriver 108 OLE_VT_I4 to retVal
53678>>>        Function_Return retVal
53679>>>    End_Function
53680>>>
53680>>>    Procedure Set ComSortCaseInsensitive Integer value
53682>>>        Handle hDispatchDriver
53682>>>        Get phDispatchDriver to hDispatchDriver
53683>>>        Send PrepareParams to hDispatchDriver 1
53684>>>        Set ComProperty of hDispatchDriver 108 OLE_VT_I4 to value
53685>>>    End_Procedure
53686>>>
53686>>>    Function ComStandalone Returns Integer
53688>>>        Handle hDispatchDriver
53688>>>        Integer retVal
53688>>>        Get phDispatchDriver to hDispatchDriver
53689>>>        Get InvokeComMethod of hDispatchDriver 109 OLE_VT_I4 to retVal
53690>>>        Function_Return retVal
53691>>>    End_Function
53692>>>
53692>>>    Procedure Set ComStandalone Integer value
53694>>>        Handle hDispatchDriver
53694>>>        Get phDispatchDriver to hDispatchDriver
53695>>>        Send PrepareParams to hDispatchDriver 1
53696>>>        Set ComProperty of hDispatchDriver 109 OLE_VT_I4 to value
53697>>>    End_Procedure
53698>>>
53698>>>    Function ComTag Returns String
53700>>>        Handle hDispatchDriver
53700>>>        String retVal
53700>>>        Get phDispatchDriver to hDispatchDriver
53701>>>        Get InvokeComMethod of hDispatchDriver 110 OLE_VT_BSTR to retVal
53702>>>        Function_Return retVal
53703>>>    End_Function
53704>>>
53704>>>    Procedure Set ComTag String value
53706>>>        Handle hDispatchDriver
53706>>>        Get phDispatchDriver to hDispatchDriver
53707>>>        Send PrepareParams to hDispatchDriver 1
53708>>>        Set ComProperty of hDispatchDriver 110 OLE_VT_BSTR to value
53709>>>    End_Procedure
53710>>>
53710>>>    Function ComTreeId Returns Integer
53712>>>        Handle hDispatchDriver
53712>>>        Integer retVal
53712>>>        Get phDispatchDriver to hDispatchDriver
53713>>>        Get InvokeComMethod of hDispatchDriver 111 OLE_VT_I4 to retVal
53714>>>        Function_Return retVal
53715>>>    End_Function
53716>>>
53716>>>    Function ComAccumulateTagContent String llTag String llskipTags Returns String
53718>>>        Handle hDispatchDriver
53718>>>        String retVal
53718>>>        Get phDispatchDriver to hDispatchDriver
53719>>>        Send PrepareParams to hDispatchDriver 2
53720>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
53721>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llskipTags
53722>>>        Get InvokeComMethod of hDispatchDriver 112 OLE_VT_BSTR to retVal
53723>>>        Function_Return retVal
53724>>>    End_Function
53725>>>
53725>>>    Function ComAddAttribute String llname String llvalue Returns Integer
53727>>>        Handle hDispatchDriver
53727>>>        Integer retVal
53727>>>        Get phDispatchDriver to hDispatchDriver
53728>>>        Send PrepareParams to hDispatchDriver 2
53729>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53730>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvalue
53731>>>        Get InvokeComMethod of hDispatchDriver 113 OLE_VT_I4 to retVal
53732>>>        Function_Return retVal
53733>>>    End_Function
53734>>>
53734>>>    Function ComAddAttributeInt String llname Integer llvalue Returns Integer
53736>>>        Handle hDispatchDriver
53736>>>        Integer retVal
53736>>>        Get phDispatchDriver to hDispatchDriver
53737>>>        Send PrepareParams to hDispatchDriver 2
53738>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53739>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llvalue
53740>>>        Get InvokeComMethod of hDispatchDriver 114 OLE_VT_I4 to retVal
53741>>>        Function_Return retVal
53742>>>    End_Function
53743>>>
53743>>>    Function ComAddChildTree Variant lltree Returns Integer
53745>>>        Handle hDispatchDriver
53745>>>        Integer retVal
53745>>>        Get phDispatchDriver to hDispatchDriver
53746>>>        Send PrepareParams to hDispatchDriver 1
53747>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH lltree
53748>>>        Get InvokeComMethod of hDispatchDriver 115 OLE_VT_I4 to retVal
53749>>>        Function_Return retVal
53750>>>    End_Function
53751>>>
53751>>>    Procedure ComAddOrUpdateAttribute String llname String llvalue
53753>>>        Handle hDispatchDriver
53753>>>        Get phDispatchDriver to hDispatchDriver
53754>>>        Send PrepareParams to hDispatchDriver 2
53755>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53756>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvalue
53757>>>        Send InvokeComMethod to hDispatchDriver 116 OLE_VT_VOID
53758>>>    End_Procedure
53759>>>
53759>>>    Procedure ComAddOrUpdateAttributeI String llname Integer llvalue
53761>>>        Handle hDispatchDriver
53761>>>        Get phDispatchDriver to hDispatchDriver
53762>>>        Send PrepareParams to hDispatchDriver 2
53763>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53764>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llvalue
53765>>>        Send InvokeComMethod to hDispatchDriver 117 OLE_VT_VOID
53766>>>    End_Procedure
53767>>>
53767>>>    Procedure ComAddStyleSheet String llstyleSheet
53769>>>        Handle hDispatchDriver
53769>>>        Get phDispatchDriver to hDispatchDriver
53770>>>        Send PrepareParams to hDispatchDriver 1
53771>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstyleSheet
53772>>>        Send InvokeComMethod to hDispatchDriver 118 OLE_VT_VOID
53773>>>    End_Procedure
53774>>>
53774>>>    Procedure ComAddToAttribute String llname Integer llamount
53776>>>        Handle hDispatchDriver
53776>>>        Get phDispatchDriver to hDispatchDriver
53777>>>        Send PrepareParams to hDispatchDriver 2
53778>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53779>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llamount
53780>>>        Send InvokeComMethod to hDispatchDriver 119 OLE_VT_VOID
53781>>>    End_Procedure
53782>>>
53782>>>    Procedure ComAddToChildContent String llTag Integer llamount
53784>>>        Handle hDispatchDriver
53784>>>        Get phDispatchDriver to hDispatchDriver
53785>>>        Send PrepareParams to hDispatchDriver 2
53786>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
53787>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llamount
53788>>>        Send InvokeComMethod to hDispatchDriver 120 OLE_VT_VOID
53789>>>    End_Procedure
53790>>>
53790>>>    Procedure ComAddToContent Integer llamount
53792>>>        Handle hDispatchDriver
53792>>>        Get phDispatchDriver to hDispatchDriver
53793>>>        Send PrepareParams to hDispatchDriver 1
53794>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llamount
53795>>>        Send InvokeComMethod to hDispatchDriver 121 OLE_VT_VOID
53796>>>    End_Procedure
53797>>>
53797>>>    Function ComAppendToContent String llstr Returns Integer
53799>>>        Handle hDispatchDriver
53799>>>        Integer retVal
53799>>>        Get phDispatchDriver to hDispatchDriver
53800>>>        Send PrepareParams to hDispatchDriver 1
53801>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstr
53802>>>        Get InvokeComMethod of hDispatchDriver 122 OLE_VT_I4 to retVal
53803>>>        Function_Return retVal
53804>>>    End_Function
53805>>>
53805>>>    Function ComBEncodeContent String llcharset Variant llinData Returns Integer
53807>>>        Handle hDispatchDriver
53807>>>        Integer retVal
53807>>>        Get phDispatchDriver to hDispatchDriver
53808>>>        Send PrepareParams to hDispatchDriver 2
53809>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcharset
53810>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llinData
53811>>>        Get InvokeComMethod of hDispatchDriver 123 OLE_VT_I4 to retVal
53812>>>        Function_Return retVal
53813>>>    End_Function
53814>>>
53814>>>    Function ComChildContentMatches String lltagPath String llpattern Integer llcaseSensitive Returns Integer
53816>>>        Handle hDispatchDriver
53816>>>        Integer retVal
53816>>>        Get phDispatchDriver to hDispatchDriver
53817>>>        Send PrepareParams to hDispatchDriver 3
53818>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53819>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpattern
53820>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcaseSensitive
53821>>>        Get InvokeComMethod of hDispatchDriver 124 OLE_VT_I4 to retVal
53822>>>        Function_Return retVal
53823>>>    End_Function
53824>>>
53824>>>    Function ComChilkatPath String llpathCmd Returns String
53826>>>        Handle hDispatchDriver
53826>>>        String retVal
53826>>>        Get phDispatchDriver to hDispatchDriver
53827>>>        Send PrepareParams to hDispatchDriver 1
53828>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpathCmd
53829>>>        Get InvokeComMethod of hDispatchDriver 125 OLE_VT_BSTR to retVal
53830>>>        Function_Return retVal
53831>>>    End_Function
53832>>>
53832>>>    Procedure ComClear
53834>>>        Handle hDispatchDriver
53834>>>        Get phDispatchDriver to hDispatchDriver
53835>>>        Send InvokeComMethod to hDispatchDriver 126 OLE_VT_VOID
53836>>>    End_Procedure
53837>>>
53837>>>    Function ComContentMatches String llpattern Integer llcaseSensitive Returns Integer
53839>>>        Handle hDispatchDriver
53839>>>        Integer retVal
53839>>>        Get phDispatchDriver to hDispatchDriver
53840>>>        Send PrepareParams to hDispatchDriver 2
53841>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpattern
53842>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcaseSensitive
53843>>>        Get InvokeComMethod of hDispatchDriver 127 OLE_VT_I4 to retVal
53844>>>        Function_Return retVal
53845>>>    End_Function
53846>>>
53846>>>    Procedure ComCopy Variant llnode
53848>>>        Handle hDispatchDriver
53848>>>        Get phDispatchDriver to hDispatchDriver
53849>>>        Send PrepareParams to hDispatchDriver 1
53850>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llnode
53851>>>        Send InvokeComMethod to hDispatchDriver 128 OLE_VT_VOID
53852>>>    End_Procedure
53853>>>
53853>>>    Procedure ComCopyRef Variant llcopyFromNode
53855>>>        Handle hDispatchDriver
53855>>>        Get phDispatchDriver to hDispatchDriver
53856>>>        Send PrepareParams to hDispatchDriver 1
53857>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llcopyFromNode
53858>>>        Send InvokeComMethod to hDispatchDriver 129 OLE_VT_VOID
53859>>>    End_Procedure
53860>>>
53860>>>    Function ComDecodeContent Returns Variant
53862>>>        Handle hDispatchDriver
53862>>>        Variant retVal
53862>>>        Get phDispatchDriver to hDispatchDriver
53863>>>        Get InvokeComMethod of hDispatchDriver 130 OLE_VT_VARIANT to retVal
53864>>>        Function_Return retVal
53865>>>    End_Function
53866>>>
53866>>>    Function ComDecodeEntities String llstr Returns String
53868>>>        Handle hDispatchDriver
53868>>>        String retVal
53868>>>        Get phDispatchDriver to hDispatchDriver
53869>>>        Send PrepareParams to hDispatchDriver 1
53870>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstr
53871>>>        Get InvokeComMethod of hDispatchDriver 131 OLE_VT_BSTR to retVal
53872>>>        Function_Return retVal
53873>>>    End_Function
53874>>>
53874>>>    Function ComDecryptContent String llpassword Returns Integer
53876>>>        Handle hDispatchDriver
53876>>>        Integer retVal
53876>>>        Get phDispatchDriver to hDispatchDriver
53877>>>        Send PrepareParams to hDispatchDriver 1
53878>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
53879>>>        Get InvokeComMethod of hDispatchDriver 132 OLE_VT_I4 to retVal
53880>>>        Function_Return retVal
53881>>>    End_Function
53882>>>
53882>>>    Function ComEncryptContent String llpassword Returns Integer
53884>>>        Handle hDispatchDriver
53884>>>        Integer retVal
53884>>>        Get phDispatchDriver to hDispatchDriver
53885>>>        Send PrepareParams to hDispatchDriver 1
53886>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
53887>>>        Get InvokeComMethod of hDispatchDriver 133 OLE_VT_I4 to retVal
53888>>>        Function_Return retVal
53889>>>    End_Function
53890>>>
53890>>>    Function ComExtractChildByIndex Integer llindex Returns Variant
53892>>>        Handle hDispatchDriver
53892>>>        Variant retVal
53892>>>        Get phDispatchDriver to hDispatchDriver
53893>>>        Send PrepareParams to hDispatchDriver 1
53894>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
53895>>>        Get InvokeComMethod of hDispatchDriver 134 OLE_VT_DISPATCH to retVal
53896>>>        Function_Return retVal
53897>>>    End_Function
53898>>>
53898>>>    Function ComExtractChildByName String lltagPath String llattrName String llattrValue Returns Variant
53900>>>        Handle hDispatchDriver
53900>>>        Variant retVal
53900>>>        Get phDispatchDriver to hDispatchDriver
53901>>>        Send PrepareParams to hDispatchDriver 3
53902>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53903>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
53904>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrValue
53905>>>        Get InvokeComMethod of hDispatchDriver 135 OLE_VT_DISPATCH to retVal
53906>>>        Function_Return retVal
53907>>>    End_Function
53908>>>
53908>>>    Function ComFindChild String lltagPath Returns Variant
53910>>>        Handle hDispatchDriver
53910>>>        Variant retVal
53910>>>        Get phDispatchDriver to hDispatchDriver
53911>>>        Send PrepareParams to hDispatchDriver 1
53912>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53913>>>        Get InvokeComMethod of hDispatchDriver 136 OLE_VT_DISPATCH to retVal
53914>>>        Function_Return retVal
53915>>>    End_Function
53916>>>
53916>>>    Function ComFindChild2 String lltagPath Returns Integer
53918>>>        Handle hDispatchDriver
53918>>>        Integer retVal
53918>>>        Get phDispatchDriver to hDispatchDriver
53919>>>        Send PrepareParams to hDispatchDriver 1
53920>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53921>>>        Get InvokeComMethod of hDispatchDriver 137 OLE_VT_I4 to retVal
53922>>>        Function_Return retVal
53923>>>    End_Function
53924>>>
53924>>>    Function ComFindNextRecord String lltagPath String llcontentPattern Returns Variant
53926>>>        Handle hDispatchDriver
53926>>>        Variant retVal
53926>>>        Get phDispatchDriver to hDispatchDriver
53927>>>        Send PrepareParams to hDispatchDriver 2
53928>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53929>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcontentPattern
53930>>>        Get InvokeComMethod of hDispatchDriver 138 OLE_VT_DISPATCH to retVal
53931>>>        Function_Return retVal
53932>>>    End_Function
53933>>>
53933>>>    Function ComFindOrAddNewChild String lltagPath Returns Variant
53935>>>        Handle hDispatchDriver
53935>>>        Variant retVal
53935>>>        Get phDispatchDriver to hDispatchDriver
53936>>>        Send PrepareParams to hDispatchDriver 1
53937>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
53938>>>        Get InvokeComMethod of hDispatchDriver 139 OLE_VT_DISPATCH to retVal
53939>>>        Function_Return retVal
53940>>>    End_Function
53941>>>
53941>>>    Function ComFirstChild Returns Variant
53943>>>        Handle hDispatchDriver
53943>>>        Variant retVal
53943>>>        Get phDispatchDriver to hDispatchDriver
53944>>>        Get InvokeComMethod of hDispatchDriver 140 OLE_VT_DISPATCH to retVal
53945>>>        Function_Return retVal
53946>>>    End_Function
53947>>>
53947>>>    Function ComFirstChild2 Returns Integer
53949>>>        Handle hDispatchDriver
53949>>>        Integer retVal
53949>>>        Get phDispatchDriver to hDispatchDriver
53950>>>        Get InvokeComMethod of hDispatchDriver 141 OLE_VT_I4 to retVal
53951>>>        Function_Return retVal
53952>>>    End_Function
53953>>>
53953>>>    Function ComGetAttrValue String llname Returns String
53955>>>        Handle hDispatchDriver
53955>>>        String retVal
53955>>>        Get phDispatchDriver to hDispatchDriver
53956>>>        Send PrepareParams to hDispatchDriver 1
53957>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53958>>>        Get InvokeComMethod of hDispatchDriver 142 OLE_VT_BSTR to retVal
53959>>>        Function_Return retVal
53960>>>    End_Function
53961>>>
53961>>>    Function ComGetAttrValueInt String llname Returns Integer
53963>>>        Handle hDispatchDriver
53963>>>        Integer retVal
53963>>>        Get phDispatchDriver to hDispatchDriver
53964>>>        Send PrepareParams to hDispatchDriver 1
53965>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
53966>>>        Get InvokeComMethod of hDispatchDriver 143 OLE_VT_I4 to retVal
53967>>>        Function_Return retVal
53968>>>    End_Function
53969>>>
53969>>>    Function ComGetAttributeName Integer llindex Returns String
53971>>>        Handle hDispatchDriver
53971>>>        String retVal
53971>>>        Get phDispatchDriver to hDispatchDriver
53972>>>        Send PrepareParams to hDispatchDriver 1
53973>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
53974>>>        Get InvokeComMethod of hDispatchDriver 144 OLE_VT_BSTR to retVal
53975>>>        Function_Return retVal
53976>>>    End_Function
53977>>>
53977>>>    Function ComGetAttributeValue Integer llindex Returns String
53979>>>        Handle hDispatchDriver
53979>>>        String retVal
53979>>>        Get phDispatchDriver to hDispatchDriver
53980>>>        Send PrepareParams to hDispatchDriver 1
53981>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
53982>>>        Get InvokeComMethod of hDispatchDriver 145 OLE_VT_BSTR to retVal
53983>>>        Function_Return retVal
53984>>>    End_Function
53985>>>
53985>>>    Function ComGetAttributeValueInt Integer llindex Returns Integer
53987>>>        Handle hDispatchDriver
53987>>>        Integer retVal
53987>>>        Get phDispatchDriver to hDispatchDriver
53988>>>        Send PrepareParams to hDispatchDriver 1
53989>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
53990>>>        Get InvokeComMethod of hDispatchDriver 146 OLE_VT_I4 to retVal
53991>>>        Function_Return retVal
53992>>>    End_Function
53993>>>
53993>>>    Function ComGetBinaryContent Integer llunzipFlag Integer lldecryptFlag String llpassword Returns Variant
53995>>>        Handle hDispatchDriver
53995>>>        Variant retVal
53995>>>        Get phDispatchDriver to hDispatchDriver
53996>>>        Send PrepareParams to hDispatchDriver 3
53997>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llunzipFlag
53998>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldecryptFlag
53999>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
54000>>>        Get InvokeComMethod of hDispatchDriver 147 OLE_VT_VARIANT to retVal
54001>>>        Function_Return retVal
54002>>>    End_Function
54003>>>
54003>>>    Function ComGetChild Integer llindex Returns Variant
54005>>>        Handle hDispatchDriver
54005>>>        Variant retVal
54005>>>        Get phDispatchDriver to hDispatchDriver
54006>>>        Send PrepareParams to hDispatchDriver 1
54007>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54008>>>        Get InvokeComMethod of hDispatchDriver 148 OLE_VT_DISPATCH to retVal
54009>>>        Function_Return retVal
54010>>>    End_Function
54011>>>
54011>>>    Function ComGetChild2 Integer llindex Returns Integer
54013>>>        Handle hDispatchDriver
54013>>>        Integer retVal
54013>>>        Get phDispatchDriver to hDispatchDriver
54014>>>        Send PrepareParams to hDispatchDriver 1
54015>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54016>>>        Get InvokeComMethod of hDispatchDriver 149 OLE_VT_I4 to retVal
54017>>>        Function_Return retVal
54018>>>    End_Function
54019>>>
54019>>>    Function ComGetChildBoolValue String lltagPath Returns Integer
54021>>>        Handle hDispatchDriver
54021>>>        Integer retVal
54021>>>        Get phDispatchDriver to hDispatchDriver
54022>>>        Send PrepareParams to hDispatchDriver 1
54023>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54024>>>        Get InvokeComMethod of hDispatchDriver 150 OLE_VT_I4 to retVal
54025>>>        Function_Return retVal
54026>>>    End_Function
54027>>>
54027>>>    Function ComGetChildContent String lltagPath Returns String
54029>>>        Handle hDispatchDriver
54029>>>        String retVal
54029>>>        Get phDispatchDriver to hDispatchDriver
54030>>>        Send PrepareParams to hDispatchDriver 1
54031>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54032>>>        Get InvokeComMethod of hDispatchDriver 151 OLE_VT_BSTR to retVal
54033>>>        Function_Return retVal
54034>>>    End_Function
54035>>>
54035>>>    Function ComGetChildContentByIndex Integer llindex Returns String
54037>>>        Handle hDispatchDriver
54037>>>        String retVal
54037>>>        Get phDispatchDriver to hDispatchDriver
54038>>>        Send PrepareParams to hDispatchDriver 1
54039>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54040>>>        Get InvokeComMethod of hDispatchDriver 152 OLE_VT_BSTR to retVal
54041>>>        Function_Return retVal
54042>>>    End_Function
54043>>>
54043>>>    Function ComGetChildExact String llTag String llContent Returns Variant
54045>>>        Handle hDispatchDriver
54045>>>        Variant retVal
54045>>>        Get phDispatchDriver to hDispatchDriver
54046>>>        Send PrepareParams to hDispatchDriver 2
54047>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54048>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54049>>>        Get InvokeComMethod of hDispatchDriver 153 OLE_VT_DISPATCH to retVal
54050>>>        Function_Return retVal
54051>>>    End_Function
54052>>>
54052>>>    Function ComGetChildIntValue String lltagPath Returns Integer
54054>>>        Handle hDispatchDriver
54054>>>        Integer retVal
54054>>>        Get phDispatchDriver to hDispatchDriver
54055>>>        Send PrepareParams to hDispatchDriver 1
54056>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54057>>>        Get InvokeComMethod of hDispatchDriver 154 OLE_VT_I4 to retVal
54058>>>        Function_Return retVal
54059>>>    End_Function
54060>>>
54060>>>    Function ComGetChildTag Integer llindex Returns String
54062>>>        Handle hDispatchDriver
54062>>>        String retVal
54062>>>        Get phDispatchDriver to hDispatchDriver
54063>>>        Send PrepareParams to hDispatchDriver 1
54064>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54065>>>        Get InvokeComMethod of hDispatchDriver 155 OLE_VT_BSTR to retVal
54066>>>        Function_Return retVal
54067>>>    End_Function
54068>>>
54068>>>    Function ComGetChildTagByIndex Integer llindex Returns String
54070>>>        Handle hDispatchDriver
54070>>>        String retVal
54070>>>        Get phDispatchDriver to hDispatchDriver
54071>>>        Send PrepareParams to hDispatchDriver 1
54072>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54073>>>        Get InvokeComMethod of hDispatchDriver 156 OLE_VT_BSTR to retVal
54074>>>        Function_Return retVal
54075>>>    End_Function
54076>>>
54076>>>    Function ComGetChildWithAttr String lltagPath String llattrName String llattrValue Returns Variant
54078>>>        Handle hDispatchDriver
54078>>>        Variant retVal
54078>>>        Get phDispatchDriver to hDispatchDriver
54079>>>        Send PrepareParams to hDispatchDriver 3
54080>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54081>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54082>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrValue
54083>>>        Get InvokeComMethod of hDispatchDriver 157 OLE_VT_DISPATCH to retVal
54084>>>        Function_Return retVal
54085>>>    End_Function
54086>>>
54086>>>    Function ComGetChildWithContent String llContent Returns Variant
54088>>>        Handle hDispatchDriver
54088>>>        Variant retVal
54088>>>        Get phDispatchDriver to hDispatchDriver
54089>>>        Send PrepareParams to hDispatchDriver 1
54090>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54091>>>        Get InvokeComMethod of hDispatchDriver 158 OLE_VT_DISPATCH to retVal
54092>>>        Function_Return retVal
54093>>>    End_Function
54094>>>
54094>>>    Function ComGetChildWithTag String lltagPath Returns Variant
54096>>>        Handle hDispatchDriver
54096>>>        Variant retVal
54096>>>        Get phDispatchDriver to hDispatchDriver
54097>>>        Send PrepareParams to hDispatchDriver 1
54098>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54099>>>        Get InvokeComMethod of hDispatchDriver 159 OLE_VT_DISPATCH to retVal
54100>>>        Function_Return retVal
54101>>>    End_Function
54102>>>
54102>>>    Function ComGetNthChildWithTag String llTag Integer lln Returns Variant
54104>>>        Handle hDispatchDriver
54104>>>        Variant retVal
54104>>>        Get phDispatchDriver to hDispatchDriver
54105>>>        Send PrepareParams to hDispatchDriver 2
54106>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54107>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lln
54108>>>        Get InvokeComMethod of hDispatchDriver 160 OLE_VT_DISPATCH to retVal
54109>>>        Function_Return retVal
54110>>>    End_Function
54111>>>
54111>>>    Function ComGetNthChildWithTag2 String llTag Integer lln Returns Integer
54113>>>        Handle hDispatchDriver
54113>>>        Integer retVal
54113>>>        Get phDispatchDriver to hDispatchDriver
54114>>>        Send PrepareParams to hDispatchDriver 2
54115>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54116>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lln
54117>>>        Get InvokeComMethod of hDispatchDriver 161 OLE_VT_I4 to retVal
54118>>>        Function_Return retVal
54119>>>    End_Function
54120>>>
54120>>>    Function ComGetParent Returns Variant
54122>>>        Handle hDispatchDriver
54122>>>        Variant retVal
54122>>>        Get phDispatchDriver to hDispatchDriver
54123>>>        Get InvokeComMethod of hDispatchDriver 162 OLE_VT_DISPATCH to retVal
54124>>>        Function_Return retVal
54125>>>    End_Function
54126>>>
54126>>>    Function ComGetParent2 Returns Integer
54128>>>        Handle hDispatchDriver
54128>>>        Integer retVal
54128>>>        Get phDispatchDriver to hDispatchDriver
54129>>>        Get InvokeComMethod of hDispatchDriver 163 OLE_VT_I4 to retVal
54130>>>        Function_Return retVal
54131>>>    End_Function
54132>>>
54132>>>    Function ComGetRoot Returns Variant
54134>>>        Handle hDispatchDriver
54134>>>        Variant retVal
54134>>>        Get phDispatchDriver to hDispatchDriver
54135>>>        Get InvokeComMethod of hDispatchDriver 164 OLE_VT_DISPATCH to retVal
54136>>>        Function_Return retVal
54137>>>    End_Function
54138>>>
54138>>>    Procedure ComGetRoot2
54140>>>        Handle hDispatchDriver
54140>>>        Get phDispatchDriver to hDispatchDriver
54141>>>        Send InvokeComMethod to hDispatchDriver 165 OLE_VT_VOID
54142>>>    End_Procedure
54143>>>
54143>>>    Function ComGetSelf Returns Variant
54145>>>        Handle hDispatchDriver
54145>>>        Variant retVal
54145>>>        Get phDispatchDriver to hDispatchDriver
54146>>>        Get InvokeComMethod of hDispatchDriver 166 OLE_VT_DISPATCH to retVal
54147>>>        Function_Return retVal
54148>>>    End_Function
54149>>>
54149>>>    Function ComGetXml Returns String
54151>>>        Handle hDispatchDriver
54151>>>        String retVal
54151>>>        Get phDispatchDriver to hDispatchDriver
54152>>>        Get InvokeComMethod of hDispatchDriver 167 OLE_VT_BSTR to retVal
54153>>>        Function_Return retVal
54154>>>    End_Function
54155>>>
54155>>>    Function ComHasAttrWithValue String llname String llvalue Returns Integer
54157>>>        Handle hDispatchDriver
54157>>>        Integer retVal
54157>>>        Get phDispatchDriver to hDispatchDriver
54158>>>        Send PrepareParams to hDispatchDriver 2
54159>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
54160>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvalue
54161>>>        Get InvokeComMethod of hDispatchDriver 168 OLE_VT_I4 to retVal
54162>>>        Function_Return retVal
54163>>>    End_Function
54164>>>
54164>>>    Function ComHasAttribute String llname Returns Integer
54166>>>        Handle hDispatchDriver
54166>>>        Integer retVal
54166>>>        Get phDispatchDriver to hDispatchDriver
54167>>>        Send PrepareParams to hDispatchDriver 1
54168>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
54169>>>        Get InvokeComMethod of hDispatchDriver 169 OLE_VT_I4 to retVal
54170>>>        Function_Return retVal
54171>>>    End_Function
54172>>>
54172>>>    Function ComHasChildWithContent String llContent Returns Integer
54174>>>        Handle hDispatchDriver
54174>>>        Integer retVal
54174>>>        Get phDispatchDriver to hDispatchDriver
54175>>>        Send PrepareParams to hDispatchDriver 1
54176>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54177>>>        Get InvokeComMethod of hDispatchDriver 170 OLE_VT_I4 to retVal
54178>>>        Function_Return retVal
54179>>>    End_Function
54180>>>
54180>>>    Function ComHasChildWithTag String lltagPath Returns Integer
54182>>>        Handle hDispatchDriver
54182>>>        Integer retVal
54182>>>        Get phDispatchDriver to hDispatchDriver
54183>>>        Send PrepareParams to hDispatchDriver 1
54184>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54185>>>        Get InvokeComMethod of hDispatchDriver 171 OLE_VT_I4 to retVal
54186>>>        Function_Return retVal
54187>>>    End_Function
54188>>>
54188>>>    Function ComHasChildWithTagAndContent String lltagPath String llContent Returns Integer
54190>>>        Handle hDispatchDriver
54190>>>        Integer retVal
54190>>>        Get phDispatchDriver to hDispatchDriver
54191>>>        Send PrepareParams to hDispatchDriver 2
54192>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54193>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54194>>>        Get InvokeComMethod of hDispatchDriver 172 OLE_VT_I4 to retVal
54195>>>        Function_Return retVal
54196>>>    End_Function
54197>>>
54197>>>    Procedure ComInsertChildTreeAfter Integer llindex Variant lltree
54199>>>        Handle hDispatchDriver
54199>>>        Get phDispatchDriver to hDispatchDriver
54200>>>        Send PrepareParams to hDispatchDriver 2
54201>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54202>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH lltree
54203>>>        Send InvokeComMethod to hDispatchDriver 173 OLE_VT_VOID
54204>>>    End_Procedure
54205>>>
54205>>>    Procedure ComInsertChildTreeBefore Integer llindex Variant lltree
54207>>>        Handle hDispatchDriver
54207>>>        Get phDispatchDriver to hDispatchDriver
54208>>>        Send PrepareParams to hDispatchDriver 2
54209>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54210>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH lltree
54211>>>        Send InvokeComMethod to hDispatchDriver 174 OLE_VT_VOID
54212>>>    End_Procedure
54213>>>
54213>>>    Function ComLastChild Returns Variant
54215>>>        Handle hDispatchDriver
54215>>>        Variant retVal
54215>>>        Get phDispatchDriver to hDispatchDriver
54216>>>        Get InvokeComMethod of hDispatchDriver 175 OLE_VT_DISPATCH to retVal
54217>>>        Function_Return retVal
54218>>>    End_Function
54219>>>
54219>>>    Function ComLastChild2 Returns Integer
54221>>>        Handle hDispatchDriver
54221>>>        Integer retVal
54221>>>        Get phDispatchDriver to hDispatchDriver
54222>>>        Get InvokeComMethod of hDispatchDriver 176 OLE_VT_I4 to retVal
54223>>>        Function_Return retVal
54224>>>    End_Function
54225>>>
54225>>>    Function ComLoadXml String llxmlData Returns Integer
54227>>>        Handle hDispatchDriver
54227>>>        Integer retVal
54227>>>        Get phDispatchDriver to hDispatchDriver
54228>>>        Send PrepareParams to hDispatchDriver 1
54229>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llxmlData
54230>>>        Get InvokeComMethod of hDispatchDriver 177 OLE_VT_I4 to retVal
54231>>>        Function_Return retVal
54232>>>    End_Function
54233>>>
54233>>>    Function ComLoadXml2 String llxmlData Integer llautoTrim Returns Integer
54235>>>        Handle hDispatchDriver
54235>>>        Integer retVal
54235>>>        Get phDispatchDriver to hDispatchDriver
54236>>>        Send PrepareParams to hDispatchDriver 2
54237>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llxmlData
54238>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llautoTrim
54239>>>        Get InvokeComMethod of hDispatchDriver 178 OLE_VT_I4 to retVal
54240>>>        Function_Return retVal
54241>>>    End_Function
54242>>>
54242>>>    Function ComLoadXmlFile String llfilename Returns Integer
54244>>>        Handle hDispatchDriver
54244>>>        Integer retVal
54244>>>        Get phDispatchDriver to hDispatchDriver
54245>>>        Send PrepareParams to hDispatchDriver 1
54246>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llfilename
54247>>>        Get InvokeComMethod of hDispatchDriver 179 OLE_VT_I4 to retVal
54248>>>        Function_Return retVal
54249>>>    End_Function
54250>>>
54250>>>    Function ComLoadXmlFile2 String llfilename Integer llautoTrim Returns Integer
54252>>>        Handle hDispatchDriver
54252>>>        Integer retVal
54252>>>        Get phDispatchDriver to hDispatchDriver
54253>>>        Send PrepareParams to hDispatchDriver 2
54254>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llfilename
54255>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llautoTrim
54256>>>        Get InvokeComMethod of hDispatchDriver 180 OLE_VT_I4 to retVal
54257>>>        Function_Return retVal
54258>>>    End_Function
54259>>>
54259>>>    Function ComNewChild String lltagPath String llContent Returns Variant
54261>>>        Handle hDispatchDriver
54261>>>        Variant retVal
54261>>>        Get phDispatchDriver to hDispatchDriver
54262>>>        Send PrepareParams to hDispatchDriver 2
54263>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54264>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54265>>>        Get InvokeComMethod of hDispatchDriver 181 OLE_VT_DISPATCH to retVal
54266>>>        Function_Return retVal
54267>>>    End_Function
54268>>>
54268>>>    Procedure ComNewChild2 String lltagPath String llContent
54270>>>        Handle hDispatchDriver
54270>>>        Get phDispatchDriver to hDispatchDriver
54271>>>        Send PrepareParams to hDispatchDriver 2
54272>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54273>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54274>>>        Send InvokeComMethod to hDispatchDriver 182 OLE_VT_VOID
54275>>>    End_Procedure
54276>>>
54276>>>    Function ComNewChildAfter Integer llindex String llTag String llContent Returns Variant
54278>>>        Handle hDispatchDriver
54278>>>        Variant retVal
54278>>>        Get phDispatchDriver to hDispatchDriver
54279>>>        Send PrepareParams to hDispatchDriver 3
54280>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54281>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54282>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54283>>>        Get InvokeComMethod of hDispatchDriver 183 OLE_VT_DISPATCH to retVal
54284>>>        Function_Return retVal
54285>>>    End_Function
54286>>>
54286>>>    Function ComNewChildBefore Integer llindex String llTag String llContent Returns Variant
54288>>>        Handle hDispatchDriver
54288>>>        Variant retVal
54288>>>        Get phDispatchDriver to hDispatchDriver
54289>>>        Send PrepareParams to hDispatchDriver 3
54290>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54291>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54292>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54293>>>        Get InvokeComMethod of hDispatchDriver 184 OLE_VT_DISPATCH to retVal
54294>>>        Function_Return retVal
54295>>>    End_Function
54296>>>
54296>>>    Procedure ComNewChildInt2 String lltagPath Integer llvalue
54298>>>        Handle hDispatchDriver
54298>>>        Get phDispatchDriver to hDispatchDriver
54299>>>        Send PrepareParams to hDispatchDriver 2
54300>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54301>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llvalue
54302>>>        Send InvokeComMethod to hDispatchDriver 185 OLE_VT_VOID
54303>>>    End_Procedure
54304>>>
54304>>>    Function ComNextSibling Returns Variant
54306>>>        Handle hDispatchDriver
54306>>>        Variant retVal
54306>>>        Get phDispatchDriver to hDispatchDriver
54307>>>        Get InvokeComMethod of hDispatchDriver 186 OLE_VT_DISPATCH to retVal
54308>>>        Function_Return retVal
54309>>>    End_Function
54310>>>
54310>>>    Function ComNextSibling2 Returns Integer
54312>>>        Handle hDispatchDriver
54312>>>        Integer retVal
54312>>>        Get phDispatchDriver to hDispatchDriver
54313>>>        Get InvokeComMethod of hDispatchDriver 187 OLE_VT_I4 to retVal
54314>>>        Function_Return retVal
54315>>>    End_Function
54316>>>
54316>>>    Function ComNumChildrenHavingTag String llTag Returns Integer
54318>>>        Handle hDispatchDriver
54318>>>        Integer retVal
54318>>>        Get phDispatchDriver to hDispatchDriver
54319>>>        Send PrepareParams to hDispatchDriver 1
54320>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54321>>>        Get InvokeComMethod of hDispatchDriver 188 OLE_VT_I4 to retVal
54322>>>        Function_Return retVal
54323>>>    End_Function
54324>>>
54324>>>    Function ComPreviousSibling Returns Variant
54326>>>        Handle hDispatchDriver
54326>>>        Variant retVal
54326>>>        Get phDispatchDriver to hDispatchDriver
54327>>>        Get InvokeComMethod of hDispatchDriver 189 OLE_VT_DISPATCH to retVal
54328>>>        Function_Return retVal
54329>>>    End_Function
54330>>>
54330>>>    Function ComPreviousSibling2 Returns Integer
54332>>>        Handle hDispatchDriver
54332>>>        Integer retVal
54332>>>        Get phDispatchDriver to hDispatchDriver
54333>>>        Get InvokeComMethod of hDispatchDriver 190 OLE_VT_I4 to retVal
54334>>>        Function_Return retVal
54335>>>    End_Function
54336>>>
54336>>>    Function ComQEncodeContent String llcharset Variant llinData Returns Integer
54338>>>        Handle hDispatchDriver
54338>>>        Integer retVal
54338>>>        Get phDispatchDriver to hDispatchDriver
54339>>>        Send PrepareParams to hDispatchDriver 2
54340>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcharset
54341>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llinData
54342>>>        Get InvokeComMethod of hDispatchDriver 191 OLE_VT_I4 to retVal
54343>>>        Function_Return retVal
54344>>>    End_Function
54345>>>
54345>>>    Function ComRemoveAllAttributes Returns Integer
54347>>>        Handle hDispatchDriver
54347>>>        Integer retVal
54347>>>        Get phDispatchDriver to hDispatchDriver
54348>>>        Get InvokeComMethod of hDispatchDriver 192 OLE_VT_I4 to retVal
54349>>>        Function_Return retVal
54350>>>    End_Function
54351>>>
54351>>>    Procedure ComRemoveAllChildren
54353>>>        Handle hDispatchDriver
54353>>>        Get phDispatchDriver to hDispatchDriver
54354>>>        Send InvokeComMethod to hDispatchDriver 193 OLE_VT_VOID
54355>>>    End_Procedure
54356>>>
54356>>>    Function ComRemoveAttribute String llname Returns Integer
54358>>>        Handle hDispatchDriver
54358>>>        Integer retVal
54358>>>        Get phDispatchDriver to hDispatchDriver
54359>>>        Send PrepareParams to hDispatchDriver 1
54360>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llname
54361>>>        Get InvokeComMethod of hDispatchDriver 194 OLE_VT_I4 to retVal
54362>>>        Function_Return retVal
54363>>>    End_Function
54364>>>
54364>>>    Procedure ComRemoveChild String lltagPath
54366>>>        Handle hDispatchDriver
54366>>>        Get phDispatchDriver to hDispatchDriver
54367>>>        Send PrepareParams to hDispatchDriver 1
54368>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54369>>>        Send InvokeComMethod to hDispatchDriver 195 OLE_VT_VOID
54370>>>    End_Procedure
54371>>>
54371>>>    Procedure ComRemoveChildByIndex Integer llindex
54373>>>        Handle hDispatchDriver
54373>>>        Get phDispatchDriver to hDispatchDriver
54374>>>        Send PrepareParams to hDispatchDriver 1
54375>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llindex
54376>>>        Send InvokeComMethod to hDispatchDriver 196 OLE_VT_VOID
54377>>>    End_Procedure
54378>>>
54378>>>    Procedure ComRemoveChildWithContent String llContent
54380>>>        Handle hDispatchDriver
54380>>>        Get phDispatchDriver to hDispatchDriver
54381>>>        Send PrepareParams to hDispatchDriver 1
54382>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llContent
54383>>>        Send InvokeComMethod to hDispatchDriver 197 OLE_VT_VOID
54384>>>    End_Procedure
54385>>>
54385>>>    Procedure ComRemoveFromTree
54387>>>        Handle hDispatchDriver
54387>>>        Get phDispatchDriver to hDispatchDriver
54388>>>        Send InvokeComMethod to hDispatchDriver 198 OLE_VT_VOID
54389>>>    End_Procedure
54390>>>
54390>>>    Function ComSaveBinaryContent String llfilename Integer llunzipFlag Integer lldecryptFlag String llpassword Returns Integer
54392>>>        Handle hDispatchDriver
54392>>>        Integer retVal
54392>>>        Get phDispatchDriver to hDispatchDriver
54393>>>        Send PrepareParams to hDispatchDriver 4
54394>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llfilename
54395>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llunzipFlag
54396>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lldecryptFlag
54397>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
54398>>>        Get InvokeComMethod of hDispatchDriver 199 OLE_VT_I4 to retVal
54399>>>        Function_Return retVal
54400>>>    End_Function
54401>>>
54401>>>    Function ComSaveXml String llfilename Returns Integer
54403>>>        Handle hDispatchDriver
54403>>>        Integer retVal
54403>>>        Get phDispatchDriver to hDispatchDriver
54404>>>        Send PrepareParams to hDispatchDriver 1
54405>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llfilename
54406>>>        Get InvokeComMethod of hDispatchDriver 200 OLE_VT_I4 to retVal
54407>>>        Function_Return retVal
54408>>>    End_Function
54409>>>
54409>>>    Function ComSearchAllForContent Variant llafterPtr String llcontentPattern Returns Variant
54411>>>        Handle hDispatchDriver
54411>>>        Variant retVal
54411>>>        Get phDispatchDriver to hDispatchDriver
54412>>>        Send PrepareParams to hDispatchDriver 2
54413>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54414>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcontentPattern
54415>>>        Get InvokeComMethod of hDispatchDriver 201 OLE_VT_DISPATCH to retVal
54416>>>        Function_Return retVal
54417>>>    End_Function
54418>>>
54418>>>    Function ComSearchAllForContent2 Variant llafterPtr String llcontentPattern Returns Integer
54420>>>        Handle hDispatchDriver
54420>>>        Integer retVal
54420>>>        Get phDispatchDriver to hDispatchDriver
54421>>>        Send PrepareParams to hDispatchDriver 2
54422>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54423>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcontentPattern
54424>>>        Get InvokeComMethod of hDispatchDriver 202 OLE_VT_I4 to retVal
54425>>>        Function_Return retVal
54426>>>    End_Function
54427>>>
54427>>>    Function ComSearchForAttribute Variant llafterPtr String llTag String llattr String llvaluePattern Returns Variant
54429>>>        Handle hDispatchDriver
54429>>>        Variant retVal
54429>>>        Get phDispatchDriver to hDispatchDriver
54430>>>        Send PrepareParams to hDispatchDriver 4
54431>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54432>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54433>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattr
54434>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvaluePattern
54435>>>        Get InvokeComMethod of hDispatchDriver 203 OLE_VT_DISPATCH to retVal
54436>>>        Function_Return retVal
54437>>>    End_Function
54438>>>
54438>>>    Function ComSearchForAttribute2 Variant llafterPtr String llTag String llattr String llvaluePattern Returns Integer
54440>>>        Handle hDispatchDriver
54440>>>        Integer retVal
54440>>>        Get phDispatchDriver to hDispatchDriver
54441>>>        Send PrepareParams to hDispatchDriver 4
54442>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54443>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54444>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattr
54445>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvaluePattern
54446>>>        Get InvokeComMethod of hDispatchDriver 204 OLE_VT_I4 to retVal
54447>>>        Function_Return retVal
54448>>>    End_Function
54449>>>
54449>>>    Function ComSearchForContent Variant llafterPtr String llTag String llcontentPattern Returns Variant
54451>>>        Handle hDispatchDriver
54451>>>        Variant retVal
54451>>>        Get phDispatchDriver to hDispatchDriver
54452>>>        Send PrepareParams to hDispatchDriver 3
54453>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54454>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54455>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcontentPattern
54456>>>        Get InvokeComMethod of hDispatchDriver 205 OLE_VT_DISPATCH to retVal
54457>>>        Function_Return retVal
54458>>>    End_Function
54459>>>
54459>>>    Function ComSearchForContent2 Variant llafterPtr String llTag String llcontentPattern Returns Integer
54461>>>        Handle hDispatchDriver
54461>>>        Integer retVal
54461>>>        Get phDispatchDriver to hDispatchDriver
54462>>>        Send PrepareParams to hDispatchDriver 3
54463>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54464>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54465>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llcontentPattern
54466>>>        Get InvokeComMethod of hDispatchDriver 206 OLE_VT_I4 to retVal
54467>>>        Function_Return retVal
54468>>>    End_Function
54469>>>
54469>>>    Function ComSearchForTag Variant llafterPtr String llTag Returns Variant
54471>>>        Handle hDispatchDriver
54471>>>        Variant retVal
54471>>>        Get phDispatchDriver to hDispatchDriver
54472>>>        Send PrepareParams to hDispatchDriver 2
54473>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54474>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54475>>>        Get InvokeComMethod of hDispatchDriver 207 OLE_VT_DISPATCH to retVal
54476>>>        Function_Return retVal
54477>>>    End_Function
54478>>>
54478>>>    Function ComSearchForTag2 Variant llafterPtr String llTag Returns Integer
54480>>>        Handle hDispatchDriver
54480>>>        Integer retVal
54480>>>        Get phDispatchDriver to hDispatchDriver
54481>>>        Send PrepareParams to hDispatchDriver 2
54482>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llafterPtr
54483>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54484>>>        Get InvokeComMethod of hDispatchDriver 208 OLE_VT_I4 to retVal
54485>>>        Function_Return retVal
54486>>>    End_Function
54487>>>
54487>>>    Function ComSetBinaryContent Variant llinData Integer llzipFlag Integer llencryptFlag String llpassword Returns Integer
54489>>>        Handle hDispatchDriver
54489>>>        Integer retVal
54489>>>        Get phDispatchDriver to hDispatchDriver
54490>>>        Send PrepareParams to hDispatchDriver 4
54491>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llinData
54492>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llzipFlag
54493>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llencryptFlag
54494>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
54495>>>        Get InvokeComMethod of hDispatchDriver 209 OLE_VT_I4 to retVal
54496>>>        Function_Return retVal
54497>>>    End_Function
54498>>>
54498>>>    Function ComSetBinaryContentFromFile String llfilename Integer llzipFlag Integer llencryptFlag String llpassword Returns Integer
54500>>>        Handle hDispatchDriver
54500>>>        Integer retVal
54500>>>        Get phDispatchDriver to hDispatchDriver
54501>>>        Send PrepareParams to hDispatchDriver 4
54502>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llfilename
54503>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llzipFlag
54504>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llencryptFlag
54505>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llpassword
54506>>>        Get InvokeComMethod of hDispatchDriver 210 OLE_VT_I4 to retVal
54507>>>        Function_Return retVal
54508>>>    End_Function
54509>>>
54509>>>    Procedure ComSortByAttribute String llattrName Integer llascending
54511>>>        Handle hDispatchDriver
54511>>>        Get phDispatchDriver to hDispatchDriver
54512>>>        Send PrepareParams to hDispatchDriver 2
54513>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54514>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54515>>>        Send InvokeComMethod to hDispatchDriver 211 OLE_VT_VOID
54516>>>    End_Procedure
54517>>>
54517>>>    Procedure ComSortByAttributeInt String llattrName Integer llascending
54519>>>        Handle hDispatchDriver
54519>>>        Get phDispatchDriver to hDispatchDriver
54520>>>        Send PrepareParams to hDispatchDriver 2
54521>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54522>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54523>>>        Send InvokeComMethod to hDispatchDriver 212 OLE_VT_VOID
54524>>>    End_Procedure
54525>>>
54525>>>    Procedure ComSortByContent Integer llascending
54527>>>        Handle hDispatchDriver
54527>>>        Get phDispatchDriver to hDispatchDriver
54528>>>        Send PrepareParams to hDispatchDriver 1
54529>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54530>>>        Send InvokeComMethod to hDispatchDriver 213 OLE_VT_VOID
54531>>>    End_Procedure
54532>>>
54532>>>    Procedure ComSortByTag Integer llascending
54534>>>        Handle hDispatchDriver
54534>>>        Get phDispatchDriver to hDispatchDriver
54535>>>        Send PrepareParams to hDispatchDriver 1
54536>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54537>>>        Send InvokeComMethod to hDispatchDriver 214 OLE_VT_VOID
54538>>>    End_Procedure
54539>>>
54539>>>    Procedure ComSortRecordsByAttribute String llsortTag String llattrName Integer llascending
54541>>>        Handle hDispatchDriver
54541>>>        Get phDispatchDriver to hDispatchDriver
54542>>>        Send PrepareParams to hDispatchDriver 3
54543>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llsortTag
54544>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54545>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54546>>>        Send InvokeComMethod to hDispatchDriver 215 OLE_VT_VOID
54547>>>    End_Procedure
54548>>>
54548>>>    Procedure ComSortRecordsByContent String llsortTag Integer llascending
54550>>>        Handle hDispatchDriver
54550>>>        Get phDispatchDriver to hDispatchDriver
54551>>>        Send PrepareParams to hDispatchDriver 2
54552>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llsortTag
54553>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54554>>>        Send InvokeComMethod to hDispatchDriver 216 OLE_VT_VOID
54555>>>    End_Procedure
54556>>>
54556>>>    Procedure ComSortRecordsByContentInt String llsortTag Integer llascending
54558>>>        Handle hDispatchDriver
54558>>>        Get phDispatchDriver to hDispatchDriver
54559>>>        Send PrepareParams to hDispatchDriver 2
54560>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llsortTag
54561>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llascending
54562>>>        Send InvokeComMethod to hDispatchDriver 217 OLE_VT_VOID
54563>>>    End_Procedure
54564>>>
54564>>>    Function ComSwapNode Variant llnode Returns Integer
54566>>>        Handle hDispatchDriver
54566>>>        Integer retVal
54566>>>        Get phDispatchDriver to hDispatchDriver
54567>>>        Send PrepareParams to hDispatchDriver 1
54568>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llnode
54569>>>        Get InvokeComMethod of hDispatchDriver 218 OLE_VT_I4 to retVal
54570>>>        Function_Return retVal
54571>>>    End_Function
54572>>>
54572>>>    Function ComSwapTree Variant lltree Returns Integer
54574>>>        Handle hDispatchDriver
54574>>>        Integer retVal
54574>>>        Get phDispatchDriver to hDispatchDriver
54575>>>        Send PrepareParams to hDispatchDriver 1
54576>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH lltree
54577>>>        Get InvokeComMethod of hDispatchDriver 219 OLE_VT_I4 to retVal
54578>>>        Function_Return retVal
54579>>>    End_Function
54580>>>
54580>>>    Function ComTagContent String lltagName Returns String
54582>>>        Handle hDispatchDriver
54582>>>        String retVal
54582>>>        Get phDispatchDriver to hDispatchDriver
54583>>>        Send PrepareParams to hDispatchDriver 1
54584>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagName
54585>>>        Get InvokeComMethod of hDispatchDriver 220 OLE_VT_BSTR to retVal
54586>>>        Function_Return retVal
54587>>>    End_Function
54588>>>
54588>>>    Function ComTagEquals String llTag Returns Integer
54590>>>        Handle hDispatchDriver
54590>>>        Integer retVal
54590>>>        Get phDispatchDriver to hDispatchDriver
54591>>>        Send PrepareParams to hDispatchDriver 1
54592>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llTag
54593>>>        Get InvokeComMethod of hDispatchDriver 221 OLE_VT_I4 to retVal
54594>>>        Function_Return retVal
54595>>>    End_Function
54596>>>
54596>>>    Function ComUnzipContent Returns Integer
54598>>>        Handle hDispatchDriver
54598>>>        Integer retVal
54598>>>        Get phDispatchDriver to hDispatchDriver
54599>>>        Get InvokeComMethod of hDispatchDriver 222 OLE_VT_I4 to retVal
54600>>>        Function_Return retVal
54601>>>    End_Function
54602>>>
54602>>>    Function ComUnzipTree Returns Integer
54604>>>        Handle hDispatchDriver
54604>>>        Integer retVal
54604>>>        Get phDispatchDriver to hDispatchDriver
54605>>>        Get InvokeComMethod of hDispatchDriver 223 OLE_VT_I4 to retVal
54606>>>        Function_Return retVal
54607>>>    End_Function
54608>>>
54608>>>    Function ComUpdateAttribute String llattrName String llattrValue Returns Integer
54610>>>        Handle hDispatchDriver
54610>>>        Integer retVal
54610>>>        Get phDispatchDriver to hDispatchDriver
54611>>>        Send PrepareParams to hDispatchDriver 2
54612>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54613>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrValue
54614>>>        Get InvokeComMethod of hDispatchDriver 224 OLE_VT_I4 to retVal
54615>>>        Function_Return retVal
54616>>>    End_Function
54617>>>
54617>>>    Function ComUpdateAttributeInt String llattrName Integer llvalue Returns Integer
54619>>>        Handle hDispatchDriver
54619>>>        Integer retVal
54619>>>        Get phDispatchDriver to hDispatchDriver
54620>>>        Send PrepareParams to hDispatchDriver 2
54621>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54622>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llvalue
54623>>>        Get InvokeComMethod of hDispatchDriver 225 OLE_VT_I4 to retVal
54624>>>        Function_Return retVal
54625>>>    End_Function
54626>>>
54626>>>    Procedure ComUpdateChildContent String lltagPath String llvalue
54628>>>        Handle hDispatchDriver
54628>>>        Get phDispatchDriver to hDispatchDriver
54629>>>        Send PrepareParams to hDispatchDriver 2
54630>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54631>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvalue
54632>>>        Send InvokeComMethod to hDispatchDriver 226 OLE_VT_VOID
54633>>>    End_Procedure
54634>>>
54634>>>    Procedure ComUpdateChildContentInt String lltagPath Integer llvalue
54636>>>        Handle hDispatchDriver
54636>>>        Get phDispatchDriver to hDispatchDriver
54637>>>        Send PrepareParams to hDispatchDriver 2
54638>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54639>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llvalue
54640>>>        Send InvokeComMethod to hDispatchDriver 227 OLE_VT_VOID
54641>>>    End_Procedure
54642>>>
54642>>>    Function ComZipContent Returns Integer
54644>>>        Handle hDispatchDriver
54644>>>        Integer retVal
54644>>>        Get phDispatchDriver to hDispatchDriver
54645>>>        Get InvokeComMethod of hDispatchDriver 228 OLE_VT_I4 to retVal
54646>>>        Function_Return retVal
54647>>>    End_Function
54648>>>
54648>>>    Function ComZipTree Returns Integer
54650>>>        Handle hDispatchDriver
54650>>>        Integer retVal
54650>>>        Get phDispatchDriver to hDispatchDriver
54651>>>        Get InvokeComMethod of hDispatchDriver 229 OLE_VT_I4 to retVal
54652>>>        Function_Return retVal
54653>>>    End_Function
54654>>>
54654>>>    Function ComEmitBom Returns Integer
54656>>>        Handle hDispatchDriver
54656>>>        Integer retVal
54656>>>        Get phDispatchDriver to hDispatchDriver
54657>>>        Get InvokeComMethod of hDispatchDriver 237 OLE_VT_I4 to retVal
54658>>>        Function_Return retVal
54659>>>    End_Function
54660>>>
54660>>>    Procedure Set ComEmitBom Integer value
54662>>>        Handle hDispatchDriver
54662>>>        Get phDispatchDriver to hDispatchDriver
54663>>>        Send PrepareParams to hDispatchDriver 1
54664>>>        Set ComProperty of hDispatchDriver 237 OLE_VT_I4 to value
54665>>>    End_Procedure
54666>>>
54666>>>    Function ComLoadSb Variant llsb Integer llautoTrim Returns Integer
54668>>>        Handle hDispatchDriver
54668>>>        Integer retVal
54668>>>        Get phDispatchDriver to hDispatchDriver
54669>>>        Send PrepareParams to hDispatchDriver 2
54670>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llsb
54671>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llautoTrim
54672>>>        Get InvokeComMethod of hDispatchDriver 238 OLE_VT_I4 to retVal
54673>>>        Function_Return retVal
54674>>>    End_Function
54675>>>
54675>>>    Function ComGetXmlSb Variant llsb Returns Integer
54677>>>        Handle hDispatchDriver
54677>>>        Integer retVal
54677>>>        Get phDispatchDriver to hDispatchDriver
54678>>>        Send PrepareParams to hDispatchDriver 1
54679>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llsb
54680>>>        Get InvokeComMethod of hDispatchDriver 239 OLE_VT_I4 to retVal
54681>>>        Function_Return retVal
54682>>>    End_Function
54683>>>
54683>>>    Function ComI Returns Integer
54685>>>        Handle hDispatchDriver
54685>>>        Integer retVal
54685>>>        Get phDispatchDriver to hDispatchDriver
54686>>>        Get InvokeComMethod of hDispatchDriver 240 OLE_VT_I4 to retVal
54687>>>        Function_Return retVal
54688>>>    End_Function
54689>>>
54689>>>    Procedure Set ComI Integer value
54691>>>        Handle hDispatchDriver
54691>>>        Get phDispatchDriver to hDispatchDriver
54692>>>        Send PrepareParams to hDispatchDriver 1
54693>>>        Set ComProperty of hDispatchDriver 240 OLE_VT_I4 to value
54694>>>    End_Procedure
54695>>>
54695>>>    Function ComJ Returns Integer
54697>>>        Handle hDispatchDriver
54697>>>        Integer retVal
54697>>>        Get phDispatchDriver to hDispatchDriver
54698>>>        Get InvokeComMethod of hDispatchDriver 241 OLE_VT_I4 to retVal
54699>>>        Function_Return retVal
54700>>>    End_Function
54701>>>
54701>>>    Procedure Set ComJ Integer value
54703>>>        Handle hDispatchDriver
54703>>>        Get phDispatchDriver to hDispatchDriver
54704>>>        Send PrepareParams to hDispatchDriver 1
54705>>>        Set ComProperty of hDispatchDriver 241 OLE_VT_I4 to value
54706>>>    End_Procedure
54707>>>
54707>>>    Function ComK Returns Integer
54709>>>        Handle hDispatchDriver
54709>>>        Integer retVal
54709>>>        Get phDispatchDriver to hDispatchDriver
54710>>>        Get InvokeComMethod of hDispatchDriver 242 OLE_VT_I4 to retVal
54711>>>        Function_Return retVal
54712>>>    End_Function
54713>>>
54713>>>    Procedure Set ComK Integer value
54715>>>        Handle hDispatchDriver
54715>>>        Get phDispatchDriver to hDispatchDriver
54716>>>        Send PrepareParams to hDispatchDriver 1
54717>>>        Set ComProperty of hDispatchDriver 242 OLE_VT_I4 to value
54718>>>    End_Procedure
54719>>>
54719>>>    Function ComNumChildrenAt String lltagPath Returns Integer
54721>>>        Handle hDispatchDriver
54721>>>        Integer retVal
54721>>>        Get phDispatchDriver to hDispatchDriver
54722>>>        Send PrepareParams to hDispatchDriver 1
54723>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54724>>>        Get InvokeComMethod of hDispatchDriver 243 OLE_VT_I4 to retVal
54725>>>        Function_Return retVal
54726>>>    End_Function
54727>>>
54727>>>    Function ComUpdateAt String lltagPath Integer llautoCreate String llvalue Returns Integer
54729>>>        Handle hDispatchDriver
54729>>>        Integer retVal
54729>>>        Get phDispatchDriver to hDispatchDriver
54730>>>        Send PrepareParams to hDispatchDriver 3
54731>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54732>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llautoCreate
54733>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llvalue
54734>>>        Get InvokeComMethod of hDispatchDriver 244 OLE_VT_I4 to retVal
54735>>>        Function_Return retVal
54736>>>    End_Function
54737>>>
54737>>>    Function ComUpdateAttrAt String lltagPath Integer llautoCreate String llattrName String llattrValue Returns Integer
54739>>>        Handle hDispatchDriver
54739>>>        Integer retVal
54739>>>        Get phDispatchDriver to hDispatchDriver
54740>>>        Send PrepareParams to hDispatchDriver 4
54741>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR lltagPath
54742>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llautoCreate
54743>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrName
54744>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llattrValue
54745>>>        Get InvokeComMethod of hDispatchDriver 245 OLE_VT_I4 to retVal
54746>>>        Function_Return retVal
54747>>>    End_Function
54748>>>
54748>>>    Function ComEmitCompact Returns Integer
54750>>>        Handle hDispatchDriver
54750>>>        Integer retVal
54750>>>        Get phDispatchDriver to hDispatchDriver
54751>>>        Get InvokeComMethod of hDispatchDriver 246 OLE_VT_I4 to retVal
54752>>>        Function_Return retVal
54753>>>    End_Function
54754>>>
54754>>>    Procedure Set ComEmitCompact Integer value
54756>>>        Handle hDispatchDriver
54756>>>        Get phDispatchDriver to hDispatchDriver
54757>>>        Send PrepareParams to hDispatchDriver 1
54758>>>        Set ComProperty of hDispatchDriver 246 OLE_VT_I4 to value
54759>>>    End_Procedure
54760>>>End_Class
54761>>>
54761>>>// CoClass
54761>>>// ProgID: Chilkat_9_5_0.Xml.1
54761>>>// CLSID: {501B9600-382D-454D-AA0A-3BC22A87C485}
54761>>>// ChilkatXml Class 9.5.0
54761>>>Class cComChilkatXml is a cComActiveXControl
54762>>>    Import_Class_Protocol cComIChilkatXml
54763>>>
54763>>>    Procedure Construct_Object
54765>>>        Forward Send Construct_Object
54767>>>        Set psProgID to "{501B9600-382D-454D-AA0A-3BC22A87C485}"
54768>>>        Set peAutoCreate to acAutoCreate
54769>>>    End_Procedure
54770>>>End_Class
54771>//Use Case.Mac                    // Case macro
54771>
54771>Object oApplication is a cApplication
54773>    Set psCompany to "RDC Tools International"
54774>    Set psProduct to "Driver Info Import"
54775>    Set psVersion to "19.0"
54776>    Set psProgram to "Read DF Driver Def XML file"
54777>End_Object
54778>
54778>Object oMainPanel is a BasicPanel
54780>    Set Location to 55 173
54781>    Set Size to 180 394
54782>    Set piMinSize to 180 394
54783>    Set Border_Style to Border_Thick
54784>    Set Locate_Mode to Center_On_Screen
54785>    Set Label to "Read DF Driver Def XML file - Internal Usage Only!"
54786>    Set Maximize_Icon to False
54787>    Set peNeighborhood to nhPublic
54788>    
54788>    // Struct array to keep driver XML file Data Types read by the ReadXMLDriverData message.
54788>    // Then used by the WriteXMLDriverTypeData message to write them to file.
54788>    Property tColumnType[] paColumnType
54790>
54790>    Object oCommandBarSystem is a cCJCommandBarSystem
54792>        Set pbAutoResizeIcons to True
54793>        Move Self to ghoCommandBars
54794>    End_Object                  
54795>    
54795>    Object oDbUpdateFunctionLibrary is a cDbUpdateFunctionLibrary
54797>    End_Object
54798>
54798>    Object oReadXMLFile_grp is a cHeaderGroup
54800>        Set Size to 67 360
54801>        Set Location to 11 17
54802>        Set peAnchors to anTopLeftRight
54803>        Set psLabel to "Read Driver Def XML file" 
54804>        Set psImage to "ActionOpenBlack.ico"
54805>
54805>        Object oFileNameDialog is a OpenDialog
54807>            Set Dialog_Caption to "Select a Driver XML-file"
54808>            Set Filter_String to "XML Files (.xml)|*.xml|All files (*.*)|*.*"
54809>        End_Object
54810>
54810>        Object oDriverXMLFileName_fm is a Form
54812>            Set Size to 13 298
54813>            Set Location to 20 43
54814>//            Set Label to "XML Driver Filename to Read:"
54814>            Set Label_Justification_Mode to JMode_Top
54815>            Set Label_Col_Offset to 0
54816>            Set Prompt_Button_Mode to PB_PromptOn
54817>            Set peAnchors to anTopLeftRight
54818>            Set Label_Row_Offset to 1
54819>
54819>            Procedure Prompt
54822>                Boolean bOk
54822>                String sPath sDrive sFileName
54822>
54822>                Get Value to sFileName
54823>                Move (Trim (sFileName)) to sFileName
54824>                If (sFileName <> "") Begin
54826>                    Get Parse_Drive sFileName to sDrive
54827>                    Get Parse_Path  sFileName to sPath
54828>                End
54828>                If (sPath <> "") Begin
54830>                    Set Initial_Folder of oFileNameDialog to (sDrive - sPath)
54831>                End
54831>
54831>                Get Show_Dialog of oFileNameDialog to bOk
54832>                If (bOk) Begin
54834>                    Get File_Name of oFileNameDialog to sFileName
54835>                    Set Value to sFileName
54836>                End
54836>            End_Procedure 
54837>            
54837>            Procedure OnChange
54840>                String sValue
54840>                
54840>                Get Value to sValue
54841>                If (sValue <> "") Begin
54843>                    Set psOutputFileName of oOutputFilename_fm to sValue
54844>                    
54844>                End
54844>            End_Procedure
54845>
54845>            Procedure OnStartUp
54848>                String sBinPath sXMLFileName
54848>
54848>                Get DFBinPath of ghoApplication to sBinPath
54849>                Move "\MSSQLDRV_DriverDef.xml" to sXMLFileName
54850>                Set Value to (sBinPath + sXMLFileName) 
54851>                
54851>                Set Value of oDriverID_cf to "MSSQLDRV_ID"
54852>                Set Value of oDbType_cf   to "EN_dbTypeMSSQL"
54853>
54853>            End_Procedure
54854>
54854>        End_Object
54855>
54855>        Object oDbType_cf is a cSQLComboForm
54857>            Set Size to 11 100
54858>            Set Location to 45 43
54859>            Set Label_Col_Offset to 0
54860>            Set Label to "DbType:"
54861>            Set Label_Justification_Mode to JMode_Top
54862>            Set Label_Row_Offset to 1
54863>            Set Label to "Database Type"
54864>            Set Entry_State to False
54865>            Set Combo_Sort_State to False
54866>            Set piItem to 3
54867>
54867>            Procedure Combo_Fill_List
54870>                Send Combo_Add_Item CS_dbTypeMSSQL
54871>                Send Combo_Add_Item CS_dbTypeMySQL
54872>                Send Combo_Add_Item CS_dbTypeOracle
54873>                Send Combo_Add_Item CS_dbTypeDB2
54874>                Send Combo_Add_Item CS_dbTypePostgre
54875>            End_Procedure
54876>
54876>            Procedure OnChange
54879>                Integer iDbType
54879>    
54879>                Get SelectedDbType to iDbType
54880>                Send Refill_Comboform of oDriverID_cf iDbType
54881>            End_Procedure
54882>    
54882>            Function SelectedDbType Returns Integer
54885>                Integer iRetval
54885>                String sDbType
54885>    
54885>                Get Value to sDbType
54886>                Get SqlUtilDbTypeToInteger of ghoDbUpdateFunctionLibrary sDbType to iRetval
54887>    
54887>                Function_Return iRetval
54888>            End_Function
54889>
54889>        End_Object
54890>
54890>        Object oDriverID_cf is a cSQLComboForm
54892>            Set Size to 11 100
54893>            Set Location to 45 150
54894>            Set Label_Justification_Mode to JMode_Top
54895>            Set Label_Col_Offset to 0
54896>            Set Label_Row_Offset to 1
54897>            Set Label to "Driver ID:"
54898>            Set Entry_State to False
54899>            Set Combo_Sort_State to False
54900>            Set piItem to 4
54901>
54901>            Procedure Refill_Comboform Integer iDbType
54904>                String sValue
54904>                Send Combo_Delete_Data
54905>                Case Begin
54905>                    Case (iDbType = EN_dbTypeMSSQL)
54907>                        Send Combo_Add_Item MSSQLDRV_ID
54908>                        Send Combo_Add_Item SQLFLEX
54909>                        Move MSSQLDRV_ID to sValue
54910>                        Case Break
54911>                    Case (iDbType = EN_dbTypeMySQL)
54914>                        Send Combo_Add_Item ODBC_DRV_ID
54915>                        Send Combo_Add_Item MDSMySQL
54916>                        Move MDSMySQL to sValue
54917>                        Case Break
54918>                    Case (iDbType = EN_dbTypeOracle)
54921>                        Send Combo_Add_Item ODBC_DRV_ID
54922>                        Send Combo_Add_Item ORAFLEX
54923>                        Move ORAFLEX to sValue
54924>                        Case Break
54925>                    Case (iDbType = EN_dbTypeDB2)
54928>                        Send Combo_Add_Item DB2_DRV_ID
54929>                        Move DB2_DRV_ID to sValue
54930>                        Case Break
54931>                    Case (iDbType = EN_dbTypePostgre)
54934>                        Send Combo_Add_Item ODBC_DRV_ID
54935>                        Send Combo_Add_Item MDSPgSQL
54936>                        Move MDSPgSQL to sValue
54937>                        Case Break
54938>                    Case Else
54938>                        Send Combo_Add_Item DATAFLEX_ID
54939>                        Move DATAFLEX_ID to sValue
54940>                Case End
54940>                Set Value to sValue
54941>            End_Procedure
54942>
54942>            Procedure OnChange
54945>                String sDriverID
54945>                Integer iDbType iPos
54945>
54945>                Get Value to sDriverID
54946>                Move (Pos("-", sDriverID)) to iPos
54947>                Move (Left(sDriverID, (iPos - 2))) to sDriverID
54948>                If (sDriverID = "") Begin
54950>                    Move MSSQLDRV_ID to sDriverID
54951>                End
54951>                Get SelectedDbType of oDbType_cf to iDbType
54952>            End_Procedure 
54953>            
54953>        End_Object
54954>
54954>        Object oOpenInEditor_btn is a Button
54956>            Set Size to 12 77
54957>            Set Location to 45 265
54958>            Set Label to "View in Editor"
54959>            Set peAnchors to anBottomRight
54960>
54960>            Procedure OnClick
54963>                String sFileName             
54963>                Boolean bExists
54963>                
54963>                Get Value of oDriverXMLFileName_fm to sFileName
54964>                Get vFilePathExists sFileName to bExists
54965>                If (bExists = False) Begin
54967>                    Send Info_Box "File doesn't exist"
54968>                    Procedure_Return
54969>                End
54969>                Runprogram Shell Background sFileName
54970>            End_Procedure
54971>
54971>        End_Object
54972>         
54972>    End_Object
54973>
54973>    Object oWriteResult_grp is a cHeaderGroup
54975>        Set Size to 67 360
54976>        Set Location to 87 17
54977>        Set peAnchors to anTopLeftRight
54978>        Set psLabel to "Write Driver Data Types to Package Name:"
54979>        Set psImage to "ActionPrintBlack.ico"
54980>        
54980>        Object oOutputFilename_fm is a Form
54982>            Set Size to 13 298
54983>            Set Location to 20 43
54984>//            Set Label to "Output Package File Name:"
54984>            Set Label_Justification_Mode to JMode_Top
54985>            Set Label_Col_Offset to 0
54986>            Set Prompt_Button_Mode to PB_PromptOn
54987>            Set peAnchors to anTopLeftRight
54988>            Set Label_Row_Offset to 1
54989>
54989>            Procedure Prompt
54992>                String sFileName sPath sFileMask sRetval
54992>
54992>                Get Value to sFileName
54993>                Get ParseFolderName sFileName to sPath
54994>                Move "Include files (*.inc)|*.inc|Package files (*.pkg)|*.pkg" to sFileMask
54995>                Get vSelect_File sFileMask "Please enter a file name" sPath to sRetval
54996>                If (sRetval <> "") Begin
54998>                    Set Value to sRetval
54999>                End
54999>            End_Procedure
55000>
55000>            Procedure Set psOutputFileName String sXMLFileName
55003>                String sOutPutFileName sPath sExt
55003>                
55003>                Get psAppSrcPath of (phoWorkspace(ghoApplication)) to sPath
55004>                Get ParseFileName sXMLFileName to sOutPutFileName
55005>                Get ParseFileExtension sOutPutFileName to sExt
55006>                // We default to set the extension to an include file (.inc):
55006>                Move (Replace(sExt, sOutPutFileName, "inc")) to sOutPutFileName
55007>                Set Value to (sPath + "\" + sOutPutFileName)
55008>
55008>            End_Procedure
55009>
55009>        End_Object
55010>
55010>        Object oOpenInEditor_btn is a Button
55012>            Set Size to 12 77
55013>            Set Location to 45 265
55014>            Set Label to "View in Editor"
55015>            Set peAnchors to anBottomRight
55016>
55016>            Procedure OnClick
55019>                String sFileName             
55019>                Boolean bExists
55019>                
55019>                Get Value of oOutputFilename_fm to sFileName
55020>                Get vFilePathExists sFileName to bExists
55021>                If (bExists = False) Begin
55023>                    Send Info_Box "File doesn't exist"
55024>                    Procedure_Return
55025>                End
55025>                Runprogram Shell Background sFileName
55026>            End_Procedure
55027>        End_Object
55028>
55028>    End_Object
55029>
55029>    Object oReadButton is a Button
55031>        Set Size to 14 50
55032>        Set Location to 160 222
55033>        Set Label to "Read"
55034>        Set peAnchors to anBottomRight
55035>        Set Default_State to True
55036>
55036>        Procedure OnClick
55039>            String sFileName
55039>            Boolean bExists
55039>            
55039>            Get Value of oDriverXMLFileName_fm to sFileName
55040>            Get vFilePathExists sFileName to bExists
55041>            If (bExists = False) Begin
55043>                Procedure_Return
55044>            End
55044>
55044>            Send ReadXMLDriverData sFileName
55045>        End_Procedure
55046>
55046>    End_Object
55047>
55047>    Object oWriteButton is a Button
55049>        Set Size to 14 50
55050>        Set Location to 160 275
55051>        Set Label to "Write"
55052>        Set peAnchors to anBottomRight
55053>
55053>        Procedure OnClick
55056>            tColumnType[] aColumnType
55056>            tColumnType[] aColumnType
55057>            String sFileName sDriverXMLFile 
55057>            Boolean bExists          
55057>            
55057>            Get paColumnType to aColumnType
55058>            If (SizeOfArray(aColumnType) = 0) Begin
55060>                Send Info_Box "You need to read an XML driver file successfully first."
55061>                Procedure_Return
55062>            End
55062>            
55062>            Get Value of oDriverXMLFileName_fm to sDriverXMLFile
55063>            Get Value of oOutputFilename_fm to sFileName
55064>            If (sFileName = "") Begin
55066>                Send Info_Box "You need to specify an output file name first."
55067>                Procedure_Return
55068>            End
55068>            
55068>            Send WriteXMLDriverTypeData sFileName sDriverXMLFile aColumnType
55069>        End_Procedure
55070>
55070>    End_Object
55071>
55071>    Object oCloseButton is a Button
55073>        Set Size to 14 50
55074>        Set Location to 160 328
55075>        Set Label to "Exit"
55076>        Set peAnchors to anBottomRight
55077>
55077>        Procedure OnClick
55080>            Send Exit_Application
55081>        End_Procedure
55082>    End_Object
55083>
55083>    Procedure ReadXMLDriverData String sFileName
55086>        DateTime dtExecStart dtExecEnd
55086>        TimeSpan tsTotalTime
55086>        Handle hoXML hoRoot hoList hoBeginAfter hoName hoNextSibling
55086>        Integer iItems i iCount
55086>        Boolean bOK bExists
55086>        String  sNamespace sValue sError
55086>        Variant vRoot vChild vList vBeginAfter vName vNextSibling
55086>        tColumnType[] aColumnType
55086>        tColumnType[] aColumnType
55087>
55087>        Move (CurrentDateTime()) to dtExecStart
55088>        Set paColumnType to aColumnType
55089>
55089>        Get Create (RefClass(cComChilkatXml)) to hoXML
55090>        If (not(IsComObjectCreated(hoXml))) Begin
55092>            Send CreateComObject of hoXml
55093>        End
55093>
55093>        Get ComLoadXmlFile of hoXml sFileName to bOK
55094>        If (bOK <> True) Begin
55096>            Get ComLastErrorText of hoXML to sError
55097>            Send Info_Box ("Sorry, couldn't load the XML file. Error:\n" + sError)
55098>            Procedure_Return
55099>        End
55099>
55099>        Get ComGetSelf of hoXML to vBeginAfter
55100>        If (IsComObject(vBeginAfter)) Begin
55102>            Get Create (RefClass(cComChilkatXml)) to hoBeginAfter
55103>            Set pvComObject of hoBeginAfter to vBeginAfter
55104>        End
55104>
55104>        Get ComSearchForContent of hoXML vBeginAfter "name" "df_field_native_type" to vName
55105>        If (IsComObject(vName)) Begin
55107>            Get Create (RefClass(cComChilkatXml)) to hoName
55108>            Set pvComObject of hoName to vName
55109>        End
55109>        If (IsNullComObject(vName)) Begin
55111>            Send Info_Box 'The tag "df_field_native_type" not found. It is needed to enumerate data types.'
55112>            Procedure_Return
55113>        End
55113>        
55113>        // Get the parent object, from where we can continue searching:
55113>        Get ComGetParent of hoName to vRoot
55114>        If (IsComObject(vRoot)) Begin
55116>            Get Create (RefClass(cComChilkatXml)) to hoRoot
55117>            Set pvComObject of hoRoot to vRoot
55118>        End
55118>        
55118>        // Set baseline at parent level:
55118>        Get ComGetSelf of hoRoot to vBeginAfter
55119>        If (IsComObject(vBeginAfter)) Begin
55121>            Get Create (RefClass(cComChilkatXml)) to hoBeginAfter
55122>            Set pvComObject of hoBeginAfter to vBeginAfter
55123>        End
55123>
55123>        //  Navigate to the enumValues node:
55123>        Get ComSearchForTag of hoRoot vBeginAfter "enumValues" to vList
55124>        If (IsComObject(vList)) Begin
55126>            Get Create (RefClass(cComChilkatXml)) to hoList
55127>            Set pvComObject of hoList to vList
55128>        End
55128>        
55128>        // Set baseline at enum values start object:
55128>        Get ComGetSelf of hoList to vBeginAfter
55129>        If (IsComObject(vBeginAfter)) Begin
55131>            Get Create (RefClass(cComChilkatXml)) to hoBeginAfter
55132>            Set pvComObject of hoBeginAfter to vBeginAfter
55133>        End
55133>        
55133>        // Find the first "enumValue" enumeration:
55133>        Get ComNumChildren of hoList to iItems
55134>        Get ComSearchForTag2 of hoList vBeginAfter "enumValue" to bExists
55135>        If (bExists = False) Begin
55137>            Send Info_Box 'No "enumValue" found (!). Nothing to enumerate.'
55138>            Procedure_Return
55139>        End
55139>
55139>        Decrement iItems
55140>        For iCount from 0 to iItems
55146>            Send CollectDriverAttributes hoList
55147>
55147>            Get ComNextSibling of hoList to vNextSibling
55148>            If (IsComObject(vNextSibling)) Begin
55150>                Get Create (RefClass(cComChilkatXml)) to hoNextSibling
55151>                Set pvComObject of hoNextSibling to vNextSibling
55152>            End
55152>            Send Destroy of hoList
55153>            Move hoNextSibling to hoList
55154>        Loop
55155>
55155>        Send Destroy of hoRoot
55156>        Send Destroy of hoXML
55157>
55157>        Move (CurrentDateTime()) to dtExecEnd
55158>        Move (dtExecEnd - dtExecStart) to tsTotalTime
55159>        Send Info_Box ("Ready! Total Time:" * String(tsTotalTime))
55160>    End_Procedure
55161>
55161>    Procedure CollectDriverAttributes Handle hoDriverAttribute
55164>        tColumnType ColumnType
55164>        tColumnType ColumnType
55164>        tColumnType[] aColumnType
55164>        tColumnType[] aColumnType
55165>        Handle hoChild
55165>        Variant vChild
55165>
55165>        // If the value was a cDataSection it will be properly translated back
55165>        // to normal text for us.
55165>        Move True                                                   to ColumnType.bNativeDataType
55166>        Get ComGetChildContent of hoDriverAttribute "name"          to ColumnType.sSQLType
55167>        Get ComGetChildContent of hoDriverAttribute "id"            to ColumnType.iSQLType
55168>
55168>        Get ComGetChildWithTag of hoDriverAttribute "nativeTypeData" to vChild
55169>        If (IsComObject(vChild)) Begin
55171>            Get Create (RefClass(cComChilkatXml)) to hoChild
55172>            Set pvComObject of hoChild to vChild
55173>            Get ComGetChildContent of hoChild       "canEditSize"   to ColumnType.bCanEditSize
55174>            
55174>            // Some data types does not have a iDefaultSize, Min or Max size.
55174>            // Then denote "not defined" by a "-1":
55174>            Get ComGetChildContent of hoChild       "defaultSize"   to ColumnType.iDefaultSize
55175>            If (ColumnType.iDefaultSize = 0) Begin
55177>                Move    -1                                          to ColumnType.iDefaultSize
55178>            End
55178>            Get ComGetChildContent of hoChild       "minSize"       to ColumnType.iMinSize
55179>            If (ColumnType.iMinSize = 0) Begin
55181>                Move        -1                                      to ColumnType.iMinSize
55182>            End
55182>            Get ComGetChildContent of hoChild       "maxSize"       to ColumnType.nMaxSize
55183>            If (ColumnType.nMaxSize = 0) Begin
55185>                Move        -1                                      to ColumnType.nMaxSize
55186>            End
55186>            Send Destroy           of hoChild
55187>        End
55187>
55187>        Get paColumnType to aColumnType
55188>        Move ColumnType to aColumnType[SizeOfArray(aColumnType)]
55189>        // paColumnType is a Panel array struct property
55189>        Set paColumnType to aColumnType
55190>    End_Procedure  
55191>    
55191>    Function MakeStringLength String sValue Integer iReportColumnPos Returns String
55194>        Move (Pad(sValue, (Length(sValue) + (iReportColumnPos - Length(sValue))))) to sValue
55195>
55195>        Function_Return sValue
55196>    End_Function
55197>
55197>    Procedure WriteXMLDriverTypeData String sFileName String sDriverXMLFile tColumnType[] aColumnType
55200>        Integer iSize iCount iCh iDbType iDataFlexType
55200>        String sSpace sDriverID sDataFlexType sValue
55200>        DateTime dtExecStart dtExecEnd
55200>        
55200>        Get Seq_Open_Output_Channel sFileName to iCh
55201>        If (iCh = DF_SEQ_CHANNEL_ERROR) Begin
55203>            Send Info_Box "Could not get a free output channel number."
55204>            Procedure_Return
55205>        End                 
55205>        
55205>        Move (CurrentDateTime()) to dtExecStart
55206>        Get SelectedDbType of oDbType_cf   to iDbType
55207>        Get Value          of oDriverID_cf to sDriverID
55208>        Writeln channel iCh "/" "/ Generated By The Database Update Framework"
55212>        Writeln channel iCh "/" "/ Driver XML File: " sDriverXMLFile
55217>        Writeln channel iCh "/" "/ Driver COLUMN DATA TYPES"
55221>        Writeln channel iCh "/" "/"
55225>        Writeln channel iCh "/" "/ Created: " (String(dtExecStart))
55230>        Writeln channel iCh
55232>        Move "            " to sSpace
55233>        
55233>        Move (SizeOfArray(aColumnType)) to iSize
55234>        Decrement iSize
55235>        For iCount from 0 to iSize                    
55241>            Get UtilSqlColumnTypeToDataFlexType of ghoDbUpdateFunctionLibrary sDriverID iDbType aColumnType[iCount].iSQLType aColumnType[iCount].iDefaultSize to iDataFlexType 
55242>            Get UtilDataFlexDataTypeToString    of ghoDbUpdateFunctionLibrary iDataFlexType to sDataFlexType
55243>            
55243>            If (Lowercase(aColumnType[iCount].sSQLType) <> "unknown type") Begin
55245>                // sSQLType:
55245>                Move ('Move "' + String(aColumnType[iCount].sSQLType) + '"') to sValue
55246>                Get MakeStringLength sValue 45 to sValue
55247>                Writeln channel iCh sSpace sValue 'to aColumnType[i].sSQLType'                                     
55252>                // iSQLType:
55252>                Move ('Move' * String(aColumnType[iCount].iSQLType)) to sValue
55253>                Get MakeStringLength sValue 45 to sValue
55254>                Writeln channel iCh sSpace sValue 'to aColumnType[i].iSQLType'
55259>                // bCanEditSize:
55259>                Move ('Move' * (If(aColumnType[iCount].bCanEditSize = True, 'True', 'False'))) to sValue
55260>                Get MakeStringLength sValue 45 to sValue
55261>                Writeln channel iCh sSpace sValue 'to aColumnType[i].bCanEditSize'
55266>                // bNativeDataType:
55266>                Move ('Move' * (If(aColumnType[iCount].bNativeDataType = True, 'True', 'False'))) to sValue
55267>                Get MakeStringLength sValue 45 to sValue
55268>                Writeln channel iCh sSpace sValue 'to aColumnType[i].bNativeDataType' 
55273>                // iDefaultSize:
55273>                Move ('Move' * String(aColumnType[iCount].iDefaultSize)) to sValue 
55274>                Get MakeStringLength sValue 45 to sValue
55275>                Writeln channel iCh sSpace sValue 'to aColumnType[i].iDefaultSize'
55280>                // iMinSize:
55280>                Move ('Move' * String(aColumnType[iCount].iMinSize)) to sValue 
55281>                Get MakeStringLength sValue 45 to sValue
55282>                Writeln channel iCh sSpace sValue 'to aColumnType[i].iMinSize'
55287>                // iMaxSize:
55287>                Move ('Move' * String(aColumnType[iCount].nMaxSize)) to sValue 
55288>                Get MakeStringLength sValue 45 to sValue
55289>                Writeln channel iCh sSpace sValue 'to aColumnType[i].nMaxSize'
55294>                // sDataFlexType:
55294>                Move ('Move "' + String(sDataFlexType) + '"') to sValue    
55295>                Get MakeStringLength sValue 45 to sValue
55296>                Writeln channel iCh sSpace sValue 'to aColumnType[i].sDataFlexType'
55301>                // iDataFlexType:
55301>                Move ('Move' * String(sDataFlexType)) to sValue    
55302>                Get MakeStringLength sValue 45 to sValue
55303>                Writeln channel iCh sSpace sValue 'to aColumnType[i].iDataFlexType'
55308>                // sPrecision:
55308>                // ToDo: Should this be .DefaultSize or .nMaxSize? ...Or removed !
55308>                // Maybe change the struct?
55308>                If (iDataFlexType = DF_DATE) Begin
55310>                    Move  6 to aColumnType[iCount].nMaxSize
55311>                End
55311>                If (Lowercase(aColumnType[iCount].sSQLType) = "datetime" or Lowercase(aColumnType[iCount].sSQLType) = "datetime2") Begin
55313>                    Move 23 to aColumnType[iCount].nMaxSize
55314>                End                                           
55314>                If (aColumnType[iCount].nMaxSize = 0) Begin
55316>                    Move  1 to aColumnType[iCount].nMaxSize
55317>                End
55317>                Move ('Move' * String(aColumnType[iCount].nMaxSize)) to sValue 
55318>                Get MakeStringLength sValue 45 to sValue
55319>                Writeln channel iCh sSpace sValue 'to aColumnType[i].sPrecision'
55324>
55324>                Writeln channel iCh sSpace 'Increment i'
55328>                Writeln channel iCh
55330>            End
55330>        Loop
55331>
55331>        Send Seq_Close_Channel iCh
55332>        Send Info_Box "Ready!"    
55333>    End_Procedure
55334>    
55334>    Send OnStartUp of oDriverXMLFileName_fm
55335>    
55335>    On_Key Key_Ctrl+Key_R Send KeyAction of oReadButton
55336>    On_Key Key_Ctrl+Key_W Send KeyAction of oWriteButton
55337>End_Object
55338>
55338>Start_UI oMainPanel
55340>
Including Resources...
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 31193
Total Resources: 4
Total Commands : 55339
Total Windows  : 1
Total Pages    : 1
Static Data    : 439797
Message area   : 342621
Total Blocks   : 20485
