<!DOCTYPE html>

<html>
	
<head>
	<title>cDbUpdateLogFile</title>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Help for the DataFlex Database Update Framework" />
    <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253" />
	
	
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->

	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>

	

	<script type="text/javascript" src="js/chmRelative.js"></script>
	
	
</head>

<body>



	
	
	<div id="topic_content">
		
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Class: cDbUpdateLogFile</span></span></h1>
<p class="rvps13"><span class="rvts65">See Also: </span><a class="rvts57" href="Overview.htm">Overview of the DataFlex Database Update Framework</a></p>
<p class="rvps2"><a class="rvts57" href="PropertiesforcDbUpdateVersion.htm"><br/></a></p>
<p class="rvps2"><a class="rvts57" href="PropertiesforcDbUpdateLogFile.htm">Properties</a><span class="rvts65"> &nbsp;</span><span class="rvts56">Events</span><span class="rvts65"> &nbsp;</span><a class="rvts57" href="MethodsforcDbUpdateLogFile.htm">Methods</a></p>
<p class="rvps2"><span class="rvts69"><br/></span></p>
<p class="rvps2"><span class="rvts55">Hierarchy</span></p>
<p class="rvps13"><a class="rvts57" href="VdfClassRef.chm::/cObject.htm">cObject</a><br/><span class="rvts56">---</span><a class="rvts22" href="cDbUpdateHandler.htm">cDbUpdateHandler</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateVersion.htm">cDbUpdateVersion</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateFunctionLibrary.htm">cDbUpdateFunctionLibrary</a><br/><span class="rvts56">------</span><a class="rvts95" href="cDbUpdateLogFile.htm">cDbUpdateLogFile</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateUserCount.htm">cDbUpdateUserCount</a><br/><span class="rvts56">------</span><a class="rvts22" href="cSQLConnectionHandler.htm">cSQLConnectionHandler</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cSQLConnectionIniFile.htm">cSQLConnectionIniFile</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cDbUpdateDatabaseDriver.htm">cDbUpdateDatabaseDriver</a></p>
<p class="rvps13"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55">Library</span><span class="rvts58">: </span><span class="rvts65">Windows Application Class Library</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Package</span><span class="rvts58">: </span><span class="rvts65">cDbUpdateLogFile.pkg</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Description</span></p>
<p class="rvps12"><span class="rvts31">Child class to the</span><a class="rvts76" href="cDbUpdateHandler.htm"> </a><a class="rvts22" href="cDbUpdateHandler.htm">cDbUpdateHandler</a><span class="rvts31"> </span><a class="rvts20" href="cDbUpdateHandler.htm">class. </a><span class="rvts31">An instance of this class is automatically created by the c</span><span class="rvts11">DbUpdateHandler</span><span class="rvts37"> class.</span></p>
<p class="rvps12"><span class="rvts31">The </span><a class="rvts22" href="cDbUpdateLogFile.htm">cDbUpdateLogFile</a><span class="rvts31"> class controls how error and status messages are handled. While an update is taking place all error messages are redirected to the error handler in the cDbUpdateHandler container object. There all errors and status messages are saved to a struct array. After all updates have been done the CreateErrorLogFile message of this class is called, passing the struct array.</span></p>
<p class="rvps12"><span class="rvts31">The default is to write the data to the text log file "DbUpdateLog.txt". However, this logic was all placed in a class of its own so it should be easier for a developer to augment how and to where error and status messages should be saved and shown, as it is less likely that this class will change much. If the data instead should be saved to a data table just augment the CreateErrorLogFile message of this class.</span></p>
<p class="rvps12"><span class="rvts31"><br/></span></p>
<p class="rvps12"><span class="rvts31">See </span><a class="rvts22" href="cDbUpdateHandler.htm">cDbUpdateHandler</a><span class="rvts31"> for more info about the container object</span><span class="rvts65">.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Sample (Actual code)</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">Procedure CreateErrorLogFile tDbUpdateErrorArray aDbUpdateErrorArray</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; String sPath sFileName</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Integer iCount iSize iCh</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Boolean bExists</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; DateTime dtCurrentDateTime</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Get Seq_New_Channel to iCh</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; If (iCh = DF_SEQ_CHANNEL_NOT_AVAILABLE) Begin</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Procedure_Return</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; End &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Move (SizeOfArray(aDbUpdateErrorArray.iDbUpdateErrorArray)) to iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Decrement iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Get psDataPath of (phoWorkspace(ghoApplication)) to sPath</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Get vFolderFormat sPath to sPath</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Get psDbUpdateLogFile to sFileName</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Move (sPath + sFileName) to sFileName</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Move (CurrentDateTime()) to dtCurrentDateTime</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Append_Output channel iCh sFileName</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Writeln channel iCh ""</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Writeln channel iCh "Database Updated Date &amp; Time: " dtCurrentDateTime</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Writeln channel iCh "Error: " (Character(09)) " Error Text:"&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; For iCount from 0 to iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Writeln channel iCh aDbUpdateErrorArray.iDbUpdateErrorArray[iCount];</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Character(09)) aDbUpdateErrorArray.sDbUpdateErrorArray[iCount]</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Loop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Close_Output channel iCh</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Send Seq_Release_Channel iCh</span></p>
<p class="rvps11"><span class="rvts35">End_Procedure</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts11"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="cDbUpdateUserCount.htm">cDbUpdateUserCount</a></p>
<p></p>

	</div>
	
	
		<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.
			</div>
		</div>
	

	
	

	
</body>
	
</html>

