

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>How To Use It - Important!</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content="How to use the Database Update Framework,OnUpdate">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How To Use It - Important!">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="How To Use It - Important!" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="HowToUseItImportant"
		  data-hnd-context="79"
		  data-hnd-title="How To Use It - Important!"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">How to use the Database Update Framework</span></span></h1>
<p class="rvps2"><span class="rvts14">Be sure to first follow these instructions: &nbsp;</span><a class="rvts62" href="FirstTimeSetup.html">First Time Usage</a><span class="rvts14"> and </span><a class="rvts62" href="WorkspaceSetup.html">Workspace Setup</a><span class="rvts14">.</span></p>
<p class="rvps2"><span class="rvts14"><br/></span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts64">Note for DUF 2.0</span></p>
<p class="rvps2"><span class="rvts64">If your database already has been converted to SQL, please use the program "DUF Code Generator" to auto-generate DUF code from your development database. Read more about it in the help under "Tools" - "DUF Code Generator"</span></p>
<p class="rvps2"><span class="rvts64"><br/></span></p>
<p class="rvps2"><span class="rvts64"><br/></span></p>
<p class="rvps2"><span class="rvts64">Steps for making database updates:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">1.</span><span class="rvts11">Drag a </span><a class="rvts22" href="cDbUpdateHandler.html">cDbUpdateHandler</a><span class="rvts11"> object from the Studio's </span><span class="rvts43">Database Update Framework</span><span class="rvts11"> </span><a class="rvts22" href="Studio.chm::/ClassPalette_pnl.htm">Class Palette</a><span class="rvts11"> group, and drop it to the source code right after the cApplication object. Be sure to be in "source code mode" or the Studio's designer will complain that the object cannot be dropped on a non-data aware object.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">2.</span><span class="rvts11">By default the DbVersion.DatabaseVersion database table/field will be used to keep the current database version. This value will be updated by the cDbUpdateVersion class as soon as a successful </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts11"> update has finished. However, the table name can be changed to use one of your own, but is more work to do so.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">3.</span><span class="rvts11">Place </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts11"> objects within the cDbUpdateHandler container object, as siblings. Add one object for each database revision. You can drag </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts11"> objects from the </span><span class="rvts49">Database Update Framework</span><span class="rvts11"> class palette and drop them within the cDbUpdateHandler container object.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">4.</span><span class="rvts11">In each </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts11"> object set the database update version property </span><a class="rvts22" href="PropertiesforcDbUpdateVersion.html">pnVersionNumber</a><span class="rvts11"> to a consecutive number. Then use the </span><a class="rvts22" href="EventsforcDbUpdateVersion.html">OnUpdate</a><span class="rvts11"> event to put code to update the database, or enter a "Use" statement with a package filename that contains an </span><a class="rvts22" href="EventsforcDbUpdateVersion.html">OnUpdate</a><a class="rvts21" href="EventsforcDbUpdateVersion.html"> </a><a class="rvts20" href="EventsforcDbUpdateVersion.html">procedure</a><span class="rvts11">. </span><span class="rvts14">The </span><a class="rvts62" href="EventsforcDbUpdateVersion.html">OnUpdate</a><span class="rvts14"> event is automatically fired when the object is created</span><span class="rvts11">. The code can consist of structural database changes as well as code to change/update data, whatever is needed.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">5.</span><span class="rvts11">Compile and run your program.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts11">The cDbUpdateFunctionLibrary has been imported to the cDbUpdateHandler class and thus all of those functions can be used in both the cDbUpdateHandler and the cDbUpdateVersion objects without any need to create an object of the cDbUpdateFunctionLibrary class.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11">Functions are available for converting tables to SQL, create new SQL tables, connect to existing SQL tables, add/edit columns/fields and at the same time initialize the new column with a value, add/change indexes and much much more. These functions are "re-entrant" in their design, meaning that if it has been executed before, it will not be run again. So in short; functions first checks if it is OK to execute before attempting to make any changes.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Note</span></p>
<p class="rvps12"><span class="rvts53">If you are using DataFlex 19 or later and have placed a cConnection object inside the cApplication object, those "Managed Connection" settings will automatically be picked up by the framework. However, since there are additional properties that can be set by the SQLConnection tool it might still be a good idea to use it. An alternative is to set those properties in the cDbUpdateHandler object.</span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts55">Sample Code 1</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps12"><span class="rvts65">To convert the whole Order Entry Sample Application - including data - to an</span><span class="rvts66"> </span><span class="rvts67">IBM DB2 database</span><span class="rvts65"> you would add the following code.</span></p>
<p class="rvps12"><span class="rvts65">If you are using </span><span class="rvts67">Microsoft SQL Server</span><span class="rvts65"> </span><span class="rvts66">see Sample Code 2</span><span class="rvts65"> below.</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oApplication is a cApplication</span></p>
<p class="rvps11"><span class="rvts35">End_Object</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">// </span><span class="rvts63">These are needed to keep the compiler happy;</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Customer</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Invt</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrderDtl</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrderHea</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrdSys</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile SalesP</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Users</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Vendor</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts36">Object oDbUpdateHandler is an cDbUpdateHandler</span><span class="rvts35">&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts36">Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span></p>
<p class="rvps11"><span class="rvts36"></span><br/><span class="rvts35">&nbsp; &nbsp; Object oUpdateVersion1 is a cDbUpdateVersion</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pnVersionNumber to 1.0</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pbUseConnectionID to True</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pbCopyData to False</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pbRecnum to False</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pbToANSI to False</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set psDriverID to </span><span class="rvts36">DB2_DRV_ID</span><span class="rvts35"> // (The default driver is DATAFLEX_ID)</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts63">// DB2 specific settings;</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; // Note: These are only necessary to set if not specified if not set with the SQLConnections program.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set psBaseTableSpace &nbsp;to "USERSPACE1"</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set psIndexTableSpace to "USERSPACE1"</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set psLongTableSpace &nbsp;to "USERSPACE1"</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set psSchema &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to "TestSchema"</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Customer.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Invt.File_Number &nbsp; &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrderHea.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrderDtl.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrdSys.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL SalesP.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Users.File_Number &nbsp; &nbsp; &nbsp;to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Vendor.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts36">End_Object</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts39">Comments: </span><span class="rvts38">The above code would the first time it is run;</span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Check that nobody else is using the database</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Inform the user that the database needs to be updated (unless the pbSilentMode = True, which can be good if this is e.g. a webapp.)</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Lock the database so nobody else can start the program until it has finished the update(s).</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Close all open tables</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Convert all the sample tables to MS-SQL and populate each SQL table with data. See the </span><a class="rvts22" href="ApiTableConvertToSQL_Ex.html">ApiTableConvertToSQL_Ex</a><span class="rvts38"> function for parameters and usage.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Update the DbVersion.DatabaseVersion with the "1.0" value to notify the framework that this piece of code has been run successfully.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Show a log if any errors occurred during update.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Unlock database and continue running the program, now with MS-SQL data.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Re-open all tables that was open before the update(s) started (including setting Master/Alias table properties).</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 12pt; font-family: Symbola, 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">•</span><span class="rvts38">Continues to run the program.</span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts38">The assumption above is that a SQL database already exists and the database was specified with the SQLConnections tool - or if DataFlex 19 or later; a cConnection has been setup in the cApplication object . If the database doesn't exist yet you first need to create it with a "database management software" that is native to the database used. However, if you are using Microsoft SQL you can create the database with the framework. See "Sample Code 2".</span></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><a name="SampleCode2"></a><span class="rvts55">Sample Code 2</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">// </span><span class="rvts63">These are needed to keep the compiler happy;</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Customer</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Invt</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrderDtl</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrderHea</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile OrdSys</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile SalesP</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Users</span></p>
<p class="rvps11"><span class="rvts35">Declare_Datafile Vendor</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts63">// Optionally you may create an MS-SQL database, in case it doesn't exist yet:</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; // This option is only available for MS-SQL.</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; Procedure OnPreUpdate</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Get SqlDatabaseCreate MSSQLDRV_ID "OrderEntry" True True to bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; If (bOK = False) Begin</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Info_Box "Nope, that didn't work. Program will now exit."</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Exit_Application</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; End_Procedure</span><span class="rvts35"> &nbsp; &nbsp; &nbsp; &nbsp;</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Object oDbUpdateVersion1 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.0</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; // Add your code to the OnUpdate event</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Boolean bOK</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Customer.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Invt.File_Number &nbsp; &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrderHea.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrderDtl.File_Number &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL OrdSys.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL SalesP.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Users.File_Number &nbsp; &nbsp; &nbsp;to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL Vendor.File_Number &nbsp; &nbsp; to bOK</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">End_Procedure</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35">&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Object oDbUpdateVersion1.1 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.1</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Boolean bOK</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Get SQLColumnRename Customer.File_Number "Purchases" "YearlyPurchases" to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // The "1" parameter will initialize all current records with a 1 for the new field.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get SQLColumnAdd Customer.File_Number "IsPrinted" SQL_CHAR 4 0 True "1" to bOK</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">End_Procedure</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35"></span><br/><span class="rvts36">&nbsp; &nbsp; // ...or put your update code (Procedure OnUpdate) in a separate package:</span><br/><span class="rvts35">&nbsp;</span><span class="rvts36"> &nbsp; </span><span class="rvts35">Object oDbUpdateVersion1.3 is a cDbUpdateVersion</span><br/><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.3</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Use MyDbUpdateVersion1.3.pkg</span><br/><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; :</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">End_Object</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><a name="SampleCode2"></a><span class="rvts55">Sample Code 3</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Object oDbUpdateVersion1 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.0</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send ApiTableConvertAllAddException MyHistoryTable.File_Number</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // This will convert all tables in your Filelist.cfg to SQL, except for those</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // tables added with the ApiTableConvertAllAddException message:</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send ApiTableConvertALLToSQL</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">End_Procedure</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35">&nbsp;&nbsp;</span><br/><span class="rvts35">End_Object</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts11"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="cDbUpdateHandler.html">cDbUpdateHandler</a></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

