

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>cDbUpdateFunctionLibrary</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content=",,cDbUpdateFunctionLibrary">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="cDbUpdateFunctionLibrary">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="cDbUpdateFunctionLibrary" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="cDbUpdateFunctionLibrary"
		  data-hnd-context="9"
		  data-hnd-title="cDbUpdateFunctionLibrary"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Class: cDbUpdateFunctionLibrary</span></span></h1>
<p class="rvps13"><span class="rvts65">See Also: </span><a class="rvts57" href="Overview.html">Overview of the DataFlex Database Update Framework</a></p>
<p class="rvps2"><span class="rvts56"><br/></span></p>
<p class="rvps2"><a class="rvts22" href="SQLBasedMethods.html">Methods</a><span class="rvts21"> &nbsp;</span><a class="rvts22" href="FrameworkStructs.html">Data Types</a></p>
<p class="rvps2"><span class="rvts69"><br/></span></p>
<p class="rvps2"><span class="rvts55">Hierarchy</span></p>
<p class="rvps13"><a class="rvts57" href="VdfClassRef.chm::/cObject.htm">cObject</a><br/><span class="rvts56">---</span><a class="rvts22" href="cDbUpdateHandler.html">cDbUpdateHandler</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><br/><span class="rvts56">------</span><span class="rvts70">cDbUpdateFunctionLibrary</span><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateLogFile.html">cDbUpdateLogFile</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateUserCount.html">cDbUpdateUserCount</a><br/><span class="rvts56">------</span><a class="rvts22" href="cSQLConnectionHandler.html">cSQLConnectionHandler</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cSQLConnectionIniFile.html">cSQLConnectionIniFile</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cDbUpdateDatabaseDriver.html">cDbUpdateDatabaseDriver</a></p>
<p class="rvps13"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55">Library</span><span class="rvts58">: </span><span class="rvts65">Windows Application Class Library</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Package</span><span class="rvts58">: </span><span class="rvts65">cDbUpdateFunctionLibrary.pkg</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Description</span></p>
<p class="rvps12"><span class="rvts31"><br/></span></p>
<p class="rvps12"><span class="rvts31">A library with </span><span class="rvts11">methods</span><span class="rvts31"> to make structural changes to a database.</span></p>
<p class="rvps12"><span class="rvts65">It has high level functions built with the DataFlex database API, as well as specialized functions to make structural changes to SQL databases connected to by any of the DAW SQL drivers (MSSQLDRV, DB2_DRV &amp; ODBC_DRV) or any of the Mertech Inc. drivers (</span><span class="rvts11">SQL_DRV, ORA_DRV, MDSMYSQL or MDSPGSQL</span><span class="rvts65">).</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">The class only contains methods, i.e. functions and procedures. No properties or events.&nbsp;</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">Note that all messages of this class has been imported to the cDbUpdateHandler class. This makes it easy to use them in the </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts65"> </span><a class="rvts22" href="EventsforcDbUpdateVersion.html">OnUpdate</a><span class="rvts65"> event, without the need to instantiate this class. The messages are reach through delegation in cDbUpdateVersion objects. However, the class can also be used stand-alone. See the "DbUpdateFrameworkTests.src" program for examples.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts58">The functions are divided into three distinctive groups;&nbsp;</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "SQL" prefix are all Embedded SQL functions (ESQL) and cannot be used on embedded (DataFlex) tables.</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "API" prefix are all based on the DataFlex Structure_Start and Structure_End commands. Works fine on any table.</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "Util" prefix are all utility functions or helper functions when dealing with databases, but not necessary to make changes to the database; as the "SQL" and "API" prefix functions are.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">After the prefix the function names have keywords such as "Database", "Table", "Column" or "Index", followed by some descriptive wording on what it does. Examples; "SQLColumnRemove" or "APIColumnRename".</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Note</span></p>
<p class="rvps12"><span class="rvts31">If the class cDbUpdateFunctionLibrary is used </span><span class="rvts53">stand-alone and not from the cDbUpdateHandler or a cDbUpdateVersion object</span><span class="rvts31"> you can use the global object handler ghoDbUpdateFunctionLibrary to call any of its functions.</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Example</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps16"><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps16"><span class="rvts35">&nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnAdd MyTable.File_Number "MyNewColumnName" </span><span class="rvts43">SQL_VARCHAR</span><span class="rvts36"> 30 0 True "InitValue" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnRename MyTable.File_Number "OldColumnName" "NewColumnName" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnRemove SomeOtherdTable.File_Number "SomeColumnName" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get ApiTableChangeRelation MyTable.File_Number 27 2 2 to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get ApiIndexChangeDirection MyTable.File_Number 2 2 DF_DESCENDING to bOk</span></p>
<p class="rvps16"><span class="rvts35">End_Procedure</span></p>
<p class="rvps17"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Example</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps11"><span class="rvts74">Procedure OnClick</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts79">&nbsp; &nbsp; SQLIncludeScriptResource ..Scripts\CreateChinookDatabase.sql as CreateChinookDatabase.sql &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts79">&nbsp; &nbsp; Get SqlUtilExecuteResource of ghoDbUpdateFunctionLibrary "CreateChinookDatabase.sql" MSSQLDRV_ID True to bOK</span></p>
<p class="rvps11"><span class="rvts74">End_Procedure</span></p>
<p class="rvps13"><span class="rvts78"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts11"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="cDbUpdateLogFile.html">cDbUpdateLogFile</a></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

