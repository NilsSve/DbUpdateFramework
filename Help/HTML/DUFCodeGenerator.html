

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>DUF Code Generator</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content="DUF Code Generator,Code Generator,Compare Databases,psCollation,SqlDatabaseCollationChange,UtilMoveAllEmbeddedToBackupFolder">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="DUF Code Generator">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="DUF Code Generator" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="DUFCodeGenerator"
		  data-hnd-context="137"
		  data-hnd-title="DUF Code Generator"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">&nbsp;DUF Code Generator</span></span></h1>
<p class="rvps13"><span class="rvts65">See Also: </span><a class="rvts57" href="Overview.html">Overview of the DataFlex Database Update Framework</a></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><img width="600" height="504" alt="" style="padding : 1px; margin : 20px 20px;" src="lib/DUFCodeGenerator.png"></p>
<p class="rvps2"><span class="rvts65">The Code Generator is intended to be used after the initial first inclution of the framework. So if your program was using e.g. the DataFlex embedded database, you first need to create a cDbUpdateVersion object where tables are converted to SQL. For the next database revision you can use the Code Generator to make the customer database identical to the current development database.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts65">The Database Update Framework (DUF) Code Generator program is a tool that can create a snap-shot of the development database by generating database update code (DUF) to an cDbUpdteVersion object package (*.pkg file). This generated file should be compiled into your main program with a "Use" statement inside the cDbUpdateHandler object, as the last line. When run at customer site the logic will check if an update of the customer's database is needed and then automatically make necessary database changes.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Imortant: See also </span><a class="rvts44" href="Howtheautomaticupdateworks.html">How the automatic update works</a><span class="rvts58"> for an explanation on how the inner logic works for auto-generated packages, and potential pitfalls.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts65">As an option it can compare two databases and create a report with differences. See also: "How to use the tool - </span><a class="rvts109" href="DUFCodeGenerator.html#Compare_Databases">Compare Databases</a><span class="rvts65">" below.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts66">Note that you must have used the "DUF SQL Connections" tool to specify the SQL login details properly before any Filelist.cfg with SQL tables can be used/opened properly.</span></p>
<p class="rvps2"><span class="rvts66"><br/></span></p>
<p class="rvps27"><span class="rvts102">How to use the tool - Code Generator</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Select FROM Filelist.cfg</span></p>
<p class="rvps2"><span class="rvts65">Press F4 or click the [...] button on the end of the form, to select a Filelist.cfg from your development Data folder. The "Select Tables" grid will automatically be filled with all tables read from the selected Filelist.cfg.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Select Tables</span></p>
<p class="rvps2"><span class="rvts65">Right-click the grid and select "Select All" to select all tables from the Filelist.cfg. This is the recommended procedure, and it will generate DUF code for all tables. However, there might be occations where it is not suitable to select all tables and thus you are in control on what to select</span><span class="rvts66">.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Configure Code Generation</span></p>
<p class="rvps2"><span class="rvts65">It is recommended to leave all flags in the "Configure Code Generation" as they are.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Configure Generated File Name</span></p>
<p class="rvps2"><span class="rvts65">The next pnVersionNumber was read from the DbVersion table when the Filelist.cfg was selected. The DbVersion table was/should have been created by the Database Update Framework the first time it was added to your program and it was compiled &amp; run for the first time. The value was incremented to the next decimal value (+ .1). This version number is used to create the suggested file name for the DUF code to be created.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts65">Click the "Generate Code!" button and the file will get created for you. All you have to do now is to include the package into your main program.&nbsp;</span></p>
<p class="rvps2"><span class="rvts66">NOTE: After testing the newly created file, you might want to remark the line "Use</span><span class="rvts91">DUF_MultipleTablesXXX.pkg</span><span class="rvts66">" until release date to avoid including the file each time the program is compiled as the compile otherwise will take considerably more time.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts65">Example;</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps11"><span class="rvts74">Object oDbUpdateHandler is a cDbUpdateHandler</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Set piDbVersionFileNumber &nbsp;to 38</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Set piDbVersionFieldNumber to 1</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Set pbAutoCreateDbVersionTable to True</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Set pbCheckDataFlexUserCount to False</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Set psCollation to "Latin1_General_CS_AS"</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Procedure OnPreUpdate</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; String sDatabase sDriverID sCollation</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Set DF_DATABASE_DEFAULT_DEFAULT_DATE_DUF &nbsp; &nbsp; to CS_DUFLowestSQLDateValue</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Set DF_DATABASE_DEFAULT_DEFAULT_DATETIME_DUF to CS_DUFLowestSQLDateValue&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Get psDriverID &nbsp; &nbsp;to sDriverID</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Move "MyDatabase" to sDatabase &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Get SqlDatabaseCreate sDriverID sDatabase True True to bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; If (bOK = False) Begin</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Info_Box ("Something went wrong and the SQL database '" + sDatabase + "' could NOT be created.\n\n Is 'Microsoft SQL Server' installed properly, and is the SQLConnections.ini file pointing to 'master'?\n\nThe program will now exit.")</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Exit_Application</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Get psCollation to sCollation</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; If (sCollation &lt;&gt; "Latin1_General_CS_AS") Begin</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get SqlDatabaseCollationChange sDatabase 'Latin1_General_CS_AS' to bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Object oDbUpdateVersion1_0 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Set pnVersionNumber to 1.0</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Procedure OnUpdate &nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send ApiTableConvertALLToSql &nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // These tables are _not_ automatically converted to SQL by the&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ApiTableConvertALLToSql message, so lets convert them now.</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL &nbsp;38 to bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL 253 to bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL 254 to bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get UtilMoveAllEmbeddedToBackupFolder to bOK &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; End_Procedure &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; End_Object</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; Use DUF_MultipleTables1_1.pkg</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">End_Object &nbsp; &nbsp;</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Helper - Create local program button</span></p>
<p class="rvps2"><span class="rvts65">This button can be used to create a local help program that includes the generated package file. It is only intented to be used internally in development. The purpose is to propagate database changes between developers that has their own copy of the development database. So if programmer A has added or changed a table/field/index/relation, that particular table can be selected from the "Select Tables" grid. Then the "Generate Code!" and "Helper Create local program" buttons. Programmer A can then provide that code to programmer B, that only needs to compile &amp; run the program to automatically update his copy of the database with the changes made by programmer A.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts58">Folder - Open containing folder</span></p>
<p class="rvps2"><span class="rvts65">Opens Windows Exlorer and selects the newly created package file.</span></p>
<p class="rvps27"><span class="rvts102"><br/></span></p>
<p class="rvps27"><span class="rvts102"></span><br/><span class="rvts102">How to use the tool - </span><a name="Compare_Databases"></a><span class="rvts102">Compare Databases</span></p>
<p class="rvps27"><span class="rvts102"><br/></span></p>
<p class="rvps2"><span class="rvts65">The routine can compare two databases that are present on the same machine or network. It can compare a DataFlex embedded database to an SQL version, or any combination of these. In short the format of the two databases to compare doesn't matter. The routine was written to test the "Code Generator" logic, so while being correct the presented compare result might be slightly wrong at times and can't fully be trusted.</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts65">Just select the two Filelist.cfg files for the development and "customer" copy and click the "Compare Databases!" button.</span></p>
<p class="rvps2"><span class="rvts66">Note that you must have used the "DUF SQL Connections" tool to specify the SQL login details properly before any Filelist.cfg can be used properly.</span></p>
<p class="rvps2"><span class="rvts81"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts22"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="DbUpdateFrameworkTestProgram.html">DbUpdateFrameworkTests program</a></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

