

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>cDbUpdateHandler</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content=",container object,system table,,cDbUpdateHandler,OnPreUpdate">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="cDbUpdateHandler">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="cDbUpdateHandler" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="cDbUpdateHandler"
		  data-hnd-context="2"
		  data-hnd-title="cDbUpdateHandler"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Class: cDbUpdateHandler</span></span></h1>
<p class="rvps13"><span class="rvts65">See Also:</span><a class="rvts68" href="Overview.html"> </a><a class="rvts22" href="Overview.html">Overview of the DataFlex Database Update Framework</a></p>
<p class="rvps2"><a class="rvts57" href="PropertiesforcDbUpdateVersion.html"><br/></a></p>
<p class="rvps2"><a class="rvts22" href="PropertiesforcDbUpdateHandler.html">Properties</a><span class="rvts65"> &nbsp;</span><a class="rvts22" href="EventsforcDbUpdateHandler.html">Events</a><span class="rvts65"> &nbsp;</span><a class="rvts22" href="MethodsforcDbUpdateHandler.html">Methods</a></p>
<p class="rvps2"><span class="rvts69"><br/></span></p>
<p class="rvps2"><span class="rvts55">Hierarchy</span></p>
<p class="rvps13"><a class="rvts57" href="VdfClassRef.chm::/cObject.htm">cObject</a><br/><span class="rvts56">---</span><span class="rvts70">cDbUpdateHandler</span><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateFunctionLibrary.html">cDbUpdateFunctionLibrary</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateLogFile.html">cDbUpdateLogFile</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateUserCount.html">cDbUpdateUserCount</a><br/><span class="rvts56">------</span><a class="rvts22" href="cSQLConnectionHandler.html">cSQLConnectionHandler</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cSQLConnectionIniFile.html">cSQLConnectionIniFile</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cDbUpdateDatabaseDriver.html">cDbUpdateDatabaseDriver</a></p>
<p class="rvps13"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55">Library</span><span class="rvts58">: </span><span class="rvts65">Windows Application Class Library</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Package</span><span class="rvts58">: </span><span class="rvts65">cDbUpdateHandler.pkg</span></p>
<p class="rvps2"><span class="rvts66">Note: If using Mertech drivers, put the line "Define DUF_Use_Mertech_Drivers" above the "Use cDbUpdateVersion.pkg"</span></p>
<p class="rvps2"><span class="rvts66"><br/></span></p>
<p class="rvps2"><span class="rvts55">Description</span></p>
<p class="rvps12"><span class="rvts31">The cDbUpdateHandler is a container object that holds one or more </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts31"> objects. The object should contain a Set Data_File_Field setting that specifies the data table name and field/column name to save the database update version to. This value gets updated automatically by the child </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts31"> objects after each successful update has been run. See the </span><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a><span class="rvts31"> class for more info</span><span class="rvts65">.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">It also automatically instantiate all of the other classes of the framework. This means most of the properties of the other classes can be get/set directly in the cDbUpdateHandler object and it will "relay" that information to the correct object/class.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts67">It is highly recommended to put all database update code in your main program. The reason is that the framework automatically locks others out of the program while the framework is doing its job. But that checking can only be performed if the same (main) program is started by another user during an update. However, you can of course put all update code in a separate package that is used (included) in your main program, right after the cApplication object.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Sample Code 1</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts36">Object oDbUpdateHandler is an cDbUpdateHandler</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp;</span><span class="rvts36">Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span><br/><span class="rvts35">&nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Object oUpdateVersion1.1 is a cDbUpdateVersion</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pnVersionNumber to 1.1</span></p>
<p class="rvps11"><span class="rvts35"></span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Declare_DataFile MyTable // To satisfy the compiler.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Write your update code here:</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; End_Procedure</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; :</span><br/><span class="rvts35">&nbsp; &nbsp; End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Object oUpdateVersion1.2 is a cDbUpdateVersion</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pnVersionNumber to 1.2</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Use VersionUpdate2.pkg</span><br/><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; :</span><br/><span class="rvts35">&nbsp; &nbsp; End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts36">End_Object</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Sample Code 2</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler</span><br/><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts36">Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span></p>
<p class="rvps11"><span class="rvts36"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts63">// Optionally you can create an SQL database with this event:</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; Procedure OnPreUpdate</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Get SqlDatabaseCreate MSSQLDRV_ID "OrderEntry" True True to bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; If (bOK = False) Begin</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Info_Box "Nope, that didn't work. Program will now exit."</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Exit_Application</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; End_Procedure</span><span class="rvts35"> &nbsp; &nbsp; &nbsp; &nbsp;</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Object oDbUpdateVersion1.1 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.1</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; // Put your code in the OnUpdate event</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Declare_Datafile SalesP</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Declare_Datafile Customer</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Boolean bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get ApiTableConvertToSQL_Ex SalesP.File_Number MSSQLDRV_ID True True True True to bOK</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Get SQLColumnRename Customer.File_Number "Purchases" "YearlyPurchases" MSSQLDRV_ID to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get SQLColumnAdd Customer.File_Number "IsPrinted" DF_BCD_DUF 4 2 True "1" to bOK</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">End_Procedure</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">&nbsp;</span><span class="rvts36"> &nbsp; </span><span class="rvts35">Object oDbUpdateVersion1.2 is a cDbUpdateVersion</span><br/><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Set pnVersionNumber to 1.2</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; // ...or put your update code in a separate package:</span><br/><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts35">Use DbUpdateVersion2.pkg</span><br/><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; :</span><br/><span class="rvts36">&nbsp; &nbsp; </span><span class="rvts35">End_Object</span><br/><span class="rvts35">&nbsp;</span><br/><span class="rvts35">End_Object</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts11"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="cDbUpdateVersion.html">cDbUpdateVersion</a></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

