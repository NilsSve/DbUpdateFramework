

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>What's New in Version 2.1.3.0.0</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content="">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="What's New in Version 2.1.3.0.0">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="What's New in Version 2.1.3.0.0" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="WhatsNewinVersion21300"
		  data-hnd-context="138"
		  data-hnd-title="What's New in Version 2.1.3.0.0"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Version 2.1.3.0 (Released October 2019)</span></span></h1>
<p class="rvps2"><span class="rvts39">If you previously only have used DUF 1.0, it is imporant that you first read </span><a class="rvts47" href="NewFeatures.html">What's New in Version 2.0.0.00</a></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts38">It is crusial that both the DataAccess database driver and the database client version are of the right version(s) for your program to run successfully. A new message and a new event was introduced to automatically check both of these versions at program start up. The new event was created for the cDbUpdateHandler class (the outer DUF object). The event was named </span><span class="rvts45">OnCreate</span><span class="rvts38"> and the function name is </span><span class="rvts45">Function </span><a class="rvts46" href="UtilLowestAllowedMSSQLDRV_And_Cl.html">UtilLowestAllowedMSSQLDRV_And_ClientVersion</a></p>
<p class="rvps2"><span class="rvts38"><br/></span></p>
<p class="rvps2"><span class="rvts39">Note: It is important to understand that you should </span><span class="rvts45">never put any update code</span><span class="rvts39"> inside the new OnCreate event, as it will always be executed when the program is started.</span></p>
<p class="rvps2"><span class="rvts39"><br/></span></p>
<p class="rvps2"><span class="rvts38">Your code could look like this;</span></p>
<p class="rvps2"><span class="rvts37"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Set piDbVersionFileNumber to 117</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Set piDbVersionFieldNumber to 1</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Set pbAutoCreateDbVersionTable to True &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Set psCollation to "Latin1_General_CS_AS"&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Set pbEnableCancelButton to True</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts36">Procedure OnCreate</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; String sVersionInfo &nbsp;</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; &nbsp; &nbsp; Get UtilLowestAllowedMSSQLDRV_And_ClientVersion "6.3.0.13" 10 True True to sVersionInfo</span></p>
<p class="rvps11"><span class="rvts36">&nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts35"></span><br/><span class="rvts35">End_Object</span></p>
<p class="rvps2"><span class="rvts34"><br/></span></p>
<p class="rvps2"><span class="rvts12">A series of new functions were introduced to make the transformation from the DataFlex Embedded database (*.dat tables) to SQL. To make the transition smoother it is important that all *.dat tables first are repaired and reindexed. It is also important that *no* nul or zero date values exist in the *.dat tables as SQL doesn't like that at all and will break the copying of values over to SQL.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts12">To make it really easy a series of new "initializing" functions were combined into one; </span><span class="rvts13">Function </span><a class="rvts42" href="UtilPrepareDataFolderForSQLConve.html">UtilPrepareDataFolderForSQLConversion</a><span class="rvts12">.</span></p>
<p class="rvps2"><span class="rvts34"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler&nbsp;</span><br/><span class="rvts35">.</span></p>
<p class="rvps11"><span class="rvts35">.</span></p>
<p class="rvps11"><span class="rvts35">.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Object oDbUpateVersion1.1 is a cDbUpdateVersion</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Set pnVersionNumber to 1.1</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Procedure OnUpdate</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="rvts36">Get UtilPrepareDataFolderForSQLConversion True True True True True to bOK</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; End_Object</span></p>
<p class="rvps11"><span class="rvts35"></span><br/><span class="rvts35">End_Object</span></p>
<p class="rvps2"><span class="rvts34"><br/></span></p>
<p class="rvps2"><span class="rvts40">The </span><span class="rvts41">UtilPrepareDataFolderForSQLConversion </span><span class="rvts40">function is a combination of five other functions;</span></p>
<p class="rvps2"><span class="rvts40"><br/></span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">1.</span><span class="rvts38">UtilMoveMiscFilesToBackupFolder that moves a number of files from the Data folder to a sub backup folder.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">2.</span><span class="rvts38">UtilTableFixALLBogusFilelistEntries, removes any Filelist.cfg entries that doesn't have a corresponding .Dat or .Int file in the Data folder.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">3.</span><span class="rvts38">UtilTableConvertALLTablesFrom23Format converts any *.Dat table from 2.3 format to 3.0/4.0 that more modern DataFlex versions are using. This is essential for DataFlex to be able to repair &amp; reindex tables.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">4.</span><span class="rvts38">UtilTableRepairAndReindexALL - Repairs (and creates *.bad files) for all .Dat tables in Filelist.cfg and then reindex them.</span></p>
<p class="rvps2" style="text-indent: -24px; padding-left: 24px; margin-left: 0px;"><span style="font-size: 10pt; font-family: 'Arial', 'Helvetica', sans-serif; color: #000000; display: inline-block; text-indent: 0px; min-width: 24px;">5.</span><span class="rvts38">UtilTablesFixAllDateBogusValues - Checks all Filelist.cfg tables and all fields for Date values, and changes all date values lower than the predefined constant CS_DUFLowestAllowedDateValue (= "01/01/1753"). That constant can be changed if really needed.</span></p>
<p class="rvps2"><span class="rvts37"><br/></span></p>
<p class="rvps2"><span class="rvts11">As explained in "What's New in Version 2.0.0.00" you should use the new tool </span><a class="rvts44" href="DUFCodeGenerator.html">DUF Code Generator</a><span class="rvts11"> to auto-generate an "image" of your current/latest database version. Use the tool to generate a file name like e.g. "DUF_MultipleTables1_5.pkg" and Use it inside the cDbUpdateHandler object.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11">The main message that is used by the auto-generated code logic is </span><a class="rvts44" href="ApiTableUpdate.html">ApiTableUpdate</a><span class="rvts11">. New logic for the </span><span class="rvts43">ApiTableUpdate</span><span class="rvts11"> function works like this. If a "From" table (from e.g. DUF_MultiTables1_5.pkg) is an SQL database driver and the "To" database table is a *.dat table (on the machine it is running on), the logic will first check if the table already exists on the SQL back-end. And if so it will attach to the existing SQL table rather than trying to convert the .Dat table to SQL.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11">If the "To" table is a .Dat table and the "From" table is in the SQL, the .Dat table will be converted to SQL.</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

