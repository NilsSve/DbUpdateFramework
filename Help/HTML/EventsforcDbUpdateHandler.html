

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>Events for cDbUpdateHandler</title>
  <meta name="description" content="Help for the DataFlex Database Update Framework" /> 
  <meta name="keywords" content=",,OnPreUpdate,OnPostUpdate,OnErrorWriteHeader_DataTable,OnErrorWriteRow_DataTable,OnFindVersionRecord">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Events for cDbUpdateHandler">
  <meta name="twitter:description" content="Help for the DataFlex Database Update Framework">

  <!-- Open Graph data -->
  <meta property="og:title" content="Events for cDbUpdateHandler" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Help for the DataFlex Database Update Framework" />
  <meta property="og:site_name" content="The Database Update Framework" /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-default.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 400px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 400px} body.md-nav-expanded header { padding-left: 414px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>The Database Update Framework</h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="EventsforcDbUpdateHandler"
		  data-hnd-context="7"
		  data-hnd-title="Events for cDbUpdateHandler"
		>
            

            <a id="main-content"></a>

            

            <div class="main-content">
                
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Events for </span></span><span class="rvts0"><a class="rvts72" href="cDbUpdateHandler.html">cDbUpdateHandler</a></span></h1>
<div class="rvps2">
<table width="100%" border="0" style="border-width: 0px; border-spacing: 2px;">
 <tr valign="top">
  <td valign="middle" style="padding: 1px; background-color: #c0c0c0;">
   <p class="rvps3"><span class="rvts71">Name</span></p>
  </td>
  <td valign="middle" style="padding: 1px; background-color: #c0c0c0;">
   <p class="rvps3"><span class="rvts71">Description</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts56">OnPreUpdate</span></p>
  </td>
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts65">Event called before any update of the database is started. This is a programmer's hook event. Can be used to create an SQL database (not table).</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="padding: 1px;">
   <p class="rvps2"><span class="rvts56">OnPostUpdate</span></p>
  </td>
  <td valign="middle" style="padding: 1px;">
   <p class="rvps2"><span class="rvts65">Event that is called after all database updates have finished. This is a programmer's hook event.</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts56">OnFindVersionRecord</span></p>
  </td>
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts65">Hook message for custom DbVersion record find. The programmer can use this event for putting code that needs to be executed to find a *custom* DbVersion table record - aka when another table should be used in place of the standard DbVersion table. By default the DbVersion table is used but this can be customized by adding this line to the code;</span></p>
   <p class="rvps2"><span class="rvts65">"Define DUF_Use_Custom_DbVersion"</span></p>
   <p class="rvps2"><span class="rvts65">above the line;</span></p>
   <p class="rvps2"><span class="rvts65">"Use cDbUpdateHandler.pkg"</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="padding: 1px; background-color: #ffffff;">
   <p class="rvps2"><span class="rvts56">OnErrorWriteHeader_DataTable</span></p>
  </td>
  <td valign="middle" style="padding: 1px; background-color: #ffffff;">
   <p class="rvps2"><span class="rvts65">Hook event for writing header error text (pre-update) to a data table, instead of the default text-log file. Only called if the pbUseDataTable property = True. Don't forget to Open the table first (!) as all tables have been closed at this stage. The start date &amp; time is passed.</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts56">OnErrorWriteRow_DataTable</span></p>
  </td>
  <td valign="middle" style="padding: 1px; background-color: #e2e2e2;">
   <p class="rvps2"><span class="rvts65">Hook event to log errors to a database table. Only called if the pbUseDataTable = True. Don't forget to Open the table first (!) as all tables have been closed at this stage. If pbQuickWrite = True the passed DbUpdateErrorArray will contain just one row, as it is called for each error that occurred. Else it is called once at the end after all updates have run and contains all errors.</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts54"><br/></span></p>
<p class="rvps2"><span class="rvts55">Sample Code</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps11"><span class="rvts35">Object oDbUpdateHandler is an cDbUpdateHandler&nbsp;</span><br/><span class="rvts35">&nbsp; &nbsp; Set Data_File_Field to File_Field DbVersion.DatabaseVersion</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; </span><span class="rvts63">// You can create a database prior making any updates in case it doesn't exist:</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; // Note: This option is only available for MS-SQL.</span></p>
<p class="rvps11"><span class="rvts73">&nbsp; &nbsp; Procedure OnPreUpdate</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Get SqlDatabaseCreate MSSQLDRV_ID "OrderEntry" True True to bOK</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; If (bOK = False) Begin</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Info_Box "Nope, that didn't work. Program will now exit."</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Send Exit_Application</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; End_Procedure</span><span class="rvts35"> &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; // To find a database version record if the standard DbVersion table&nbsp;</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; // should *not* be used. You can here use your own table logic.</span></p>
<p class="rvps11"><span class="rvts73">&nbsp; &nbsp; Procedure OnFindVersionRecord</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Open MyTable</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Move xx to MyTable.Column1</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Move yy to MyTable.Column2</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; &nbsp; &nbsp; Find LE MyTable by Index.1</span></p>
<p class="rvps11"><span class="rvts63">&nbsp; &nbsp; End_Procedure</span><span class="rvts35"> &nbsp; &nbsp; &nbsp; &nbsp;</span><br/><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; // Called once when the update begins.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Procedure OnErrorWriteHeader_DataTable DateTime dtUpdateStart</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Open MyLogTable</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Move dtUpdateStart to MyLogTable.UpdateStart</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Saverecord MyLogTable</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; // Called once after all updates have finished if </span><span class="rvts65">pbQuickWrite=False. If pbQuickWrite=True it is called once for each error.</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Procedure OnErrorWriteRow_DataTable tDbUpdateError[] DbUpdateErrorArray</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Integer iSize iCount</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Open MyLogTable</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Move (SizeOfArray(DbUpdateErrorArray)) to iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Decrement iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; For iCount from 0 to iSize</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Clear MyLogTable</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Move DbUpdateErrorArray[iCount].iError to MyLogTable.ErrorNo</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Move DbUpdateErrorArray[iCount].sErrorText to MyLogTable.ErrorText</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SaveRecord MyLogTable</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; &nbsp; &nbsp; Loop</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; End_Procedure</span></p>
<p class="rvps11"><span class="rvts35"></span><br/><span class="rvts35">...</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p class="rvps11"><span class="rvts35">NOTE:</span></p>
<p class="rvps11"><span class="rvts35">Struct tDbUpdateError</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Number &nbsp;nUpdateVersion</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Integer iError</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; String &nbsp;sErrorText</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Integer iErrorLine</span></p>
<p class="rvps11"><span class="rvts35">&nbsp; &nbsp; Boolean bError</span></p>
<p class="rvps11"><span class="rvts35">End_Struct</span></p>
<p class="rvps11"><span class="rvts35"><br/></span></p>
<p></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 400px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

