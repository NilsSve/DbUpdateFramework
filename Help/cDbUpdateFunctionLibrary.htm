<!DOCTYPE html>

<html>
	
<head>
	<title>cDbUpdateFunctionLibrary</title>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Help for the DataFlex Database Update Framework" />
    <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253" />
	
	
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->

	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>

	

	<script type="text/javascript" src="js/chmRelative.js"></script>
	
	
</head>

<body>



	
	
	<div id="topic_content">
		
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">Class: cDbUpdateFunctionLibrary</span></span></h1>
<p class="rvps13"><span class="rvts65">See Also: </span><a class="rvts57" href="Overview.htm">Overview of the DataFlex Database Update Framework</a></p>
<p class="rvps2"><span class="rvts56"><br/></span></p>
<p class="rvps2"><a class="rvts22" href="SQLBasedMethods.htm">Methods</a><span class="rvts21"> &nbsp;</span><a class="rvts22" href="FrameworkStructs.htm">Data Types</a></p>
<p class="rvps2"><span class="rvts69"><br/></span></p>
<p class="rvps2"><span class="rvts55">Hierarchy</span></p>
<p class="rvps13"><a class="rvts57" href="VdfClassRef.chm::/cObject.htm">cObject</a><br/><span class="rvts56">---</span><a class="rvts22" href="cDbUpdateHandler.htm">cDbUpdateHandler</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateVersion.htm">cDbUpdateVersion</a><br/><span class="rvts56">------</span><span class="rvts70">cDbUpdateFunctionLibrary</span><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateLogFile.htm">cDbUpdateLogFile</a><br/><span class="rvts56">------</span><a class="rvts22" href="cDbUpdateUserCount.htm">cDbUpdateUserCount</a><br/><span class="rvts56">------</span><a class="rvts22" href="cSQLConnectionHandler.htm">cSQLConnectionHandler</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cSQLConnectionIniFile.htm">cSQLConnectionIniFile</a><br/><span class="rvts56">---------</span><a class="rvts22" href="cDbUpdateDatabaseDriver.htm">cDbUpdateDatabaseDriver</a></p>
<p class="rvps13"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts55">Library</span><span class="rvts58">: </span><span class="rvts65">Windows Application Class Library</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Package</span><span class="rvts58">: </span><span class="rvts65">cDbUpdateFunctionLibrary.pkg</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Description</span></p>
<p class="rvps12"><span class="rvts31"><br/></span></p>
<p class="rvps12"><span class="rvts31">A library with </span><span class="rvts11">methods</span><span class="rvts31"> to make structural changes to a database.</span></p>
<p class="rvps12"><span class="rvts65">It has high level functions built with the DataFlex database API, as well as specialized functions to make structural changes to SQL databases connected to by any of the DAW SQL drivers (MSSQLDRV, DB2_DRV &amp; ODBC_DRV) or any of the Mertech Inc. drivers (</span><span class="rvts11">SQL_DRV, ORA_DRV, MDSMYSQL or MDSPGSQL</span><span class="rvts65">).</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">The class only contains methods, i.e. functions and procedures. No properties or events.&nbsp;</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">Note that all messages of this class has been imported to the cDbUpdateHandler class. This makes it easy to use them in the </span><a class="rvts22" href="cDbUpdateVersion.htm">cDbUpdateVersion</a><span class="rvts65"> </span><a class="rvts22" href="EventsforcDbUpdateVersion.htm">OnUpdate</a><span class="rvts65"> event, without the need to instantiate this class. The messages are reach through delegation in cDbUpdateVersion objects. However, the class can also be used stand-alone. See the "DbUpdateFrameworkTests.src" program for examples.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts58">The functions are divided into three distinctive groups;&nbsp;</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "SQL" prefix are all Embedded SQL functions (ESQL) and cannot be used on embedded (DataFlex) tables.</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "API" prefix are all based on the DataFlex Structure_Start and Structure_End commands. Works fine on any table.</span></p>
<p class="rvps12"><span class="rvts65">- Functions with the "Util" prefix are all utility functions or helper functions when dealing with databases, but not necessary to make changes to the database; as the "SQL" and "API" prefix functions are.</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65">After the prefix the function names have keywords such as "Database", "Table", "Column" or "Index", followed by some descriptive wording on what it does. Examples; "SQLColumnRemove" or "APIColumnRename".</span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps12"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts55">Note</span></p>
<p class="rvps12"><span class="rvts31">If the class cDbUpdateFunctionLibrary is used </span><span class="rvts53">stand-alone and not from the cDbUpdateHandler or a cDbUpdateVersion object</span><span class="rvts31"> you can use the global object handler ghoDbUpdateFunctionLibrary to call any of its functions.</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Example</span></p>
<p class="rvps12"><span class="rvts58"><br/></span></p>
<p class="rvps16"><span class="rvts35">Procedure OnUpdate</span></p>
<p class="rvps16"><span class="rvts35">&nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnAdd MyTable.File_Number "MyNewColumnName" </span><span class="rvts43">SQL_VARCHAR</span><span class="rvts36"> 30 0 True "InitValue" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnRename MyTable.File_Number "OldColumnName" "NewColumnName" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get SQLColumnRemove SomeOtherdTable.File_Number "SomeColumnName" to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get ApiTableChangeRelation MyTable.File_Number 27 2 2 to bOK</span></p>
<p class="rvps16"><span class="rvts36">&nbsp; &nbsp; Get ApiIndexChangeDirection MyTable.File_Number 2 2 DF_DESCENDING to bOk</span></p>
<p class="rvps16"><span class="rvts35">End_Procedure</span></p>
<p class="rvps17"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts55">Example</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps11"><span class="rvts74">Procedure OnClick</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts79">&nbsp; &nbsp; SQLIncludeScriptResource ..Scripts\CreateChinookDatabase.sql as CreateChinookDatabase.sql &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts79">&nbsp; &nbsp; Get SqlUtilExecuteResource of ghoDbUpdateFunctionLibrary "CreateChinookDatabase.sql" MSSQLDRV_ID True to bOK</span></p>
<p class="rvps11"><span class="rvts74">End_Procedure</span></p>
<p class="rvps13"><span class="rvts78"><br/></span></p>
<p class="rvps2"><span class="rvts55">Next Topic</span></p>
<p class="rvps5"><span class="rvts11"><br/></span></p>
<p class="rvps5"><a class="rvts22" href="cDbUpdateLogFile.htm">cDbUpdateLogFile</a></p>
<p></p>

	</div>
	
	
		<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.
			</div>
		</div>
	

	
	

	
</body>
	
</html>

