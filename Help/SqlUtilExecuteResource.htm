<!DOCTYPE html>

<html>
	
<head>
	<title>SqlUtilExecuteResource</title>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Help for the DataFlex Database Update Framework" />
    <meta name="generator" content="HelpNDoc Professional Edition 7.1.0.253" />
	
	
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->

	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>

	

	<script type="text/javascript" src="js/chmRelative.js"></script>
	
	
</head>

<body>



	
	
	<div id="topic_content">
		
<p></p>
<h1 class="rvps7"><span class="rvts0"><span class="rvts23">SQLUtilExecuteResource - </span></span><span class="rvts0"><a class="rvts72" href="cDbUpdateFunctionLibrary.htm">cDbUpdateFunctionLibrary</a></span></h1>
<p class="rvps2"><span class="rvts65">Executes a SQL script - that has been compiled into the program - as embedded SQL (ESQL)</span><span class="rvts31">. Use it together with the </span><a class="rvts22" href="Commands.htm">SQLIncludeScriptFile</a><span class="rvts31"> command to compile the SQL script file to the program.</span><br/><span class="rvts65"></span><br/><span class="rvts81">Type</span><span class="rvts58">:</span><span class="rvts65"> </span><a class="rvts22" href="LanguageReference.chm::/Function_Command.htm">Function</a><br/><span class="rvts65"></span><br/><span class="rvts81">Parameters</span><span class="rvts58">:</span><span class="rvts65"> </span><a class="rvts22" href="LanguageGuide.chm::/String_Type.htm">String</a><span class="rvts65"> sMemFileName </span><a class="rvts22" href="LanguageGuide.chm::/String_Type.htm">String</a><span class="rvts65"> sDriverID </span><a class="rvts22" href="LanguageGuide.chm::/Boolean_Type.htm">Boolean</a><span class="rvts65"> bCreateScriptFile</span></p>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<div class="rvps12">
<table border="2" cellpadding="2" cellspacing="0" style="border-color: #808080; border-style: solid; background-color: #ffffe0; border-spacing: 0px; border-top: none; border-right: none;">
 <tr valign="top">
  <td valign="middle" style="border-width : 2px; border-color : #000080 #000080 #000080 #000080; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none; background-color: #c0c0c0;">
   <p class="rvps18"><span class="rvts71">Parameter</span></p>
  </td>
  <td valign="middle" style="border-width : 2px; border-color : #000080 #000080 #000080 #000080; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none; background-color: #c0c0c0;">
   <p class="rvps18"><span class="rvts71">Description</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">sMemFileName</span></p>
  </td>
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">The name of the resource name used with the </span><a class="rvts22" href="Commands.htm">SQLIncludeScriptFile</a><span class="rvts65"> command.</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">sDriverID</span></p>
  </td>
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">One of MSSQLDRV_ID, DB2_DRV_ID, ODBC_DRV_ID, ORAFLEX, SQLFLEX, MDSPgSQL or MDSMySQL</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">bCreateScriptFile</span></p>
  </td>
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">Boolean True/False. Indicates if the embedded SQL script file that was embedded as a resource to the program should be written to disk when executed. Good for debugging.</span></p>
  </td>
 </tr>
 <tr valign="top">
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">bShowProgress</span></p>
  </td>
  <td valign="middle" style="border-width : 2px; border-color : #000000 #000000 #000000 #000000; border-style: solid; padding: 1px 4px; border-bottom: none; border-left: none;">
   <p class="rvps5"><span class="rvts65">Optional. If the backup progress should be shown or not. If the ghoStatusPanel is active - the info will be shown there. Else Showln is used to display the progress percentage.</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts81"></span><br/><span class="rvts81">Syntax</span></p>
<p class="rvps2"><span class="rvts81"><br/></span></p>
<p class="rvps11"><span class="rvts35">Function SQLUtilExecuteResource String sMemFileName String sDriverID Boolean bCreateScriptFile Boolean bShowProgress</span></p>
<div class="rvps2">
<table border="0" cellpadding="3" cellspacing="2" style="border-width: 0px; background-color: #ffffe0; border-spacing: 2px;">
 <tr valign="top">
  <td width="49" valign="top" style="padding: 1px 5px; background-color: #ffffff;">
   <p class="rvps2"><span class="rvts65">Call:</span></p>
  </td>
  <td width="709" valign="middle" style="padding: 1px 5px;">
   <p class="rvps2"><span class="rvts35">Get SQLUtilExecuteResource sMemoryResourceName sSQLDriverID False False to bOK</span></p>
  </td>
 </tr>
</table>
</div>
<p class="rvps2"><span class="rvts65"><br/></span></p>
<p class="rvps2"><span class="rvts81"></span><br/><span class="rvts81">Description</span></p>
<p class="rvps13"><span class="rvts31">Executes the embedded SQL script file as a series of Embedded SQL statements. If the passed SQL script string is very large it will be send to the embedded SQL handler in chunks of (by default) 500 lines to speed up execution. If a 'GO' statement is encountered the statement string will be send immediately to the embedded SQL handler. First the SQL script file is "sanitized" or cleaned up by removing all comments and empty lines as the ESQL interface doesn't like them.</span></p>
<p class="rvps13"><span class="rvts31">ESQL (embedded SQL) statements should have "SET NOCOUNT ON" or you might experience strange results. The function will automatically adjust statements to have "NOCOUNT ON" in them before sending them to the SQL query handler.</span></p>
<p class="rvps2"><span class="rvts81">Note</span><span class="rvts58">: </span><span class="rvts65">The command </span><a class="rvts22" href="Commands.htm">SQLIncludeScriptFile</a><span class="rvts65"> can be used to embed a SQL script file into the program.</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps2"><span class="rvts82"></span><br/><span class="rvts82">Example</span></p>
<p class="rvps2"><span class="rvts55"><br/></span></p>
<p class="rvps11"><span class="rvts74">Procedure OnClick</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; String sInfoText&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Boolean bOK</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; TimeSpan tsTotalQueryTime</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Integer iRetval</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; // The default path for the resource command is the Data folder. So anything else needs a path.</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; // Note: The file name and the resource name (the 'as' part) needs to be exactly the same.</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; // It is advised that you create a "Scripts" folder parallel to AppSrc, Programs etc to</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; // store all SQL Script files.</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; SQLIncludeScriptFile ..\Scripts\CreateOrderEntry.sql as CreateOrderEntry.sql</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Get YesNo_Box "This will create the [OrderEntry] database from the DataFlex ;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; samples for Microsoft SQL Server, complete with data. If it exists it will first ;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; be dropped, then re-created and populated with new data. Continue?" to iRetval</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; If (iRetval &lt;&gt; MBR_Yes) Begin</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Procedure_Return</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Send StartWorkingMessage "Executing SQL Script. Please wait..."</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; </span><span class="rvts79">Get SqlUtilExecuteResource of ghoDbUpdateFunctionLibrary "CreateOrderEntry.sql" MSSQLDRV_ID False to bOK</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Send StopWorkingMessage &nbsp; &nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; If (bOK = True) Begin</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Get ptsTotalQueryTime of ghoDbUpdateFunctionLibrary to tsTotalQueryTime</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Move ("Success! DataFlex Order Entry Sample Database was created as [OrderEntry]. Time elapsed:" * ;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; String(tsTotalQueryTime)) to sInfoText</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; End&nbsp;</span></p>
<p class="rvps11"><span class="rvts74"><br/></span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Else Begin&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Send UtilShowErrorList of ghoDbUpdateFunctionLibrary</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; Move ("Nope, that didn't work. There was a problem running the script.\n\n" + "See Notepad for details...") to sInfoText</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; End</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
<p class="rvps11"><span class="rvts74">&nbsp; &nbsp; Send Info_Box sInfoText</span></p>
<p class="rvps11"><span class="rvts74">End_Procedure</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p></p>

	</div>
	
	
		<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2016-2020 RDC Tools International. All Rights Reserved. Portions Copyright Data Access Worldwide, Mertech Data Systems, Inc.
			</div>
		</div>
	

	
	

	
</body>
	
</html>

